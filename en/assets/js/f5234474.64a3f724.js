"use strict";(self.webpackChunkfullstack_dev_blog=self.webpackChunkfullstack_dev_blog||[]).push([["19409"],{77448:function(e,n,t){t.r(n),t.d(n,{metadata:()=>r,default:()=>m,frontMatter:()=>o,contentTitle:()=>c,toc:()=>u,assets:()=>d});var r=JSON.parse('{"id":"backend/database-orm/redis","title":"Redis\u7F13\u5B58\u6570\u636E\u5E93\u8BE6\u89E3","description":"\u6DF1\u5165\u7406\u89E3Redis\u6570\u636E\u7ED3\u6784\u3001\u6301\u4E45\u5316\u673A\u5236\u3001\u9AD8\u53EF\u7528\u67B6\u6784\u4E0E\u6027\u80FD\u4F18\u5316\u5B9E\u8DF5","source":"@site/docs/backend/database-orm/redis.mdx","sourceDirName":"backend/database-orm","slug":"/backend/database-orm/redis","permalink":"/en/docs/backend/database-orm/redis","draft":false,"unlisted":false,"editUrl":"https://github.com/MasterLiu93/blog-web/tree/main/docs/backend/database-orm/redis.mdx","tags":[{"inline":true,"label":"Redis","permalink":"/en/docs/tags/redis"},{"inline":true,"label":"\u7F13\u5B58","permalink":"/en/docs/tags/\u7F13\u5B58"},{"inline":true,"label":"\u6570\u636E\u5E93","permalink":"/en/docs/tags/\u6570\u636E\u5E93"},{"inline":true,"label":"\u5185\u5B58\u5B58\u50A8","permalink":"/en/docs/tags/\u5185\u5B58\u5B58\u50A8"},{"inline":true,"label":"\u9AD8\u53EF\u7528","permalink":"/en/docs/tags/\u9AD8\u53EF\u7528"},{"inline":true,"label":"\u6027\u80FD\u4F18\u5316","permalink":"/en/docs/tags/\u6027\u80FD\u4F18\u5316"}],"version":"current","lastUpdatedBy":"Laby","lastUpdatedAt":1754870400000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Redis\u7F13\u5B58\u6570\u636E\u5E93\u8BE6\u89E3","description":"\u6DF1\u5165\u7406\u89E3Redis\u6570\u636E\u7ED3\u6784\u3001\u6301\u4E45\u5316\u673A\u5236\u3001\u9AD8\u53EF\u7528\u67B6\u6784\u4E0E\u6027\u80FD\u4F18\u5316\u5B9E\u8DF5","authors":["Laby"],"tags":["Redis","\u7F13\u5B58","\u6570\u636E\u5E93","\u5185\u5B58\u5B58\u50A8","\u9AD8\u53EF\u7528","\u6027\u80FD\u4F18\u5316"],"last_update":{"date":"2025-08-11T00:00:00.000Z","author":"Laby"}},"sidebar":"tutorialSidebar","previous":{"title":"PostgreSQL\u8BE6\u89E3","permalink":"/en/docs/backend/database-orm/postgresql"},"next":{"title":"\u670D\u52A1\u6CE8\u518C\u4E0E\u53D1\u73B0\u8BE6\u89E3","permalink":"/en/docs/backend/microservices/service-discovery"}}'),i=t(74848),s=t(28453),l=t(78010),a=t(57250);t(25591);let o={sidebar_position:4,title:"Redis\u7F13\u5B58\u6570\u636E\u5E93\u8BE6\u89E3",description:"\u6DF1\u5165\u7406\u89E3Redis\u6570\u636E\u7ED3\u6784\u3001\u6301\u4E45\u5316\u673A\u5236\u3001\u9AD8\u53EF\u7528\u67B6\u6784\u4E0E\u6027\u80FD\u4F18\u5316\u5B9E\u8DF5",authors:["Laby"],tags:["Redis","\u7F13\u5B58","\u6570\u636E\u5E93","\u5185\u5B58\u5B58\u50A8","\u9AD8\u53EF\u7528","\u6027\u80FD\u4F18\u5316"],last_update:{date:new Date("2025-08-11T00:00:00.000Z"),author:"Laby"}},c="Redis\u7F13\u5B58\u6570\u636E\u5E93\u8BE6\u89E3",d={},u=[{value:"1. Redis\u57FA\u7840\u67B6\u6784\u4E0E\u7279\u6027",id:"1-redis\u57FA\u7840\u67B6\u6784\u4E0E\u7279\u6027",level:2},{value:"1.1 Redis\u6838\u5FC3\u7279\u6027",id:"11-redis\u6838\u5FC3\u7279\u6027",level:3},{value:"1.2 Redis\u5E94\u7528\u573A\u666F\u5BF9\u6BD4",id:"12-redis\u5E94\u7528\u573A\u666F\u5BF9\u6BD4",level:3},{value:"2. Redis\u6570\u636E\u7ED3\u6784\u6DF1\u5EA6\u89E3\u6790",id:"2-redis\u6570\u636E\u7ED3\u6784\u6DF1\u5EA6\u89E3\u6790",level:2},{value:"2.1 String\uFF08\u5B57\u7B26\u4E32\uFF09- \u6700\u57FA\u7840\u7684\u6570\u636E\u7C7B\u578B",id:"21-string\u5B57\u7B26\u4E32--\u6700\u57FA\u7840\u7684\u6570\u636E\u7C7B\u578B",level:3},{value:"String\u5E94\u7528\u5B9E\u8DF5",id:"string\u5E94\u7528\u5B9E\u8DF5",level:4},{value:"2.2 Hash\uFF08\u54C8\u5E0C\uFF09- \u5BF9\u8C61\u5B58\u50A8\u7684\u6700\u4F73\u9009\u62E9",id:"22-hash\u54C8\u5E0C--\u5BF9\u8C61\u5B58\u50A8\u7684\u6700\u4F73\u9009\u62E9",level:3},{value:"Hash vs String \u6027\u80FD\u5BF9\u6BD4",id:"hash-vs-string-\u6027\u80FD\u5BF9\u6BD4",level:4},{value:"2.3 List\uFF08\u5217\u8868\uFF09- \u6709\u5E8F\u6570\u636E\u7684\u7406\u60F3\u9009\u62E9",id:"23-list\u5217\u8868--\u6709\u5E8F\u6570\u636E\u7684\u7406\u60F3\u9009\u62E9",level:3},{value:"2.4 Set\uFF08\u96C6\u5408\uFF09- \u53BB\u91CD\u548C\u96C6\u5408\u8FD0\u7B97",id:"24-set\u96C6\u5408--\u53BB\u91CD\u548C\u96C6\u5408\u8FD0\u7B97",level:3},{value:"2.5 Sorted Set\uFF08\u6709\u5E8F\u96C6\u5408\uFF09- \u6392\u5E8F\u548C\u6392\u540D",id:"25-sorted-set\u6709\u5E8F\u96C6\u5408--\u6392\u5E8F\u548C\u6392\u540D",level:3},{value:"2.6 Stream\uFF08\u6D41\uFF09- \u73B0\u4EE3\u6D88\u606F\u961F\u5217\u89E3\u51B3\u65B9\u6848",id:"26-stream\u6D41--\u73B0\u4EE3\u6D88\u606F\u961F\u5217\u89E3\u51B3\u65B9\u6848",level:3},{value:"Stream vs \u4F20\u7EDF\u6D88\u606F\u961F\u5217\u5BF9\u6BD4",id:"stream-vs-\u4F20\u7EDF\u6D88\u606F\u961F\u5217\u5BF9\u6BD4",level:4},{value:"3. Redis\u6301\u4E45\u5316\u673A\u5236\u8BE6\u89E3",id:"3-redis\u6301\u4E45\u5316\u673A\u5236\u8BE6\u89E3",level:2},{value:"3.1 RDB\u6301\u4E45\u5316 - \u5FEB\u7167\u5907\u4EFD",id:"31-rdb\u6301\u4E45\u5316---\u5FEB\u7167\u5907\u4EFD",level:3},{value:"3.2 AOF\u6301\u4E45\u5316 - \u64CD\u4F5C\u65E5\u5FD7",id:"32-aof\u6301\u4E45\u5316---\u64CD\u4F5C\u65E5\u5FD7",level:3},{value:"3.3 \u6DF7\u5408\u6301\u4E45\u5316 - \u6700\u4F73\u5B9E\u8DF5",id:"33-\u6DF7\u5408\u6301\u4E45\u5316---\u6700\u4F73\u5B9E\u8DF5",level:3},{value:"4. Redis\u9AD8\u53EF\u7528\u67B6\u6784\u8BBE\u8BA1",id:"4-redis\u9AD8\u53EF\u7528\u67B6\u6784\u8BBE\u8BA1",level:2},{value:"4.1 \u4E3B\u4ECE\u590D\u5236 - \u8BFB\u5199\u5206\u79BB\u57FA\u7840",id:"41-\u4E3B\u4ECE\u590D\u5236---\u8BFB\u5199\u5206\u79BB\u57FA\u7840",level:3},{value:"4.2 \u54E8\u5175\u6A21\u5F0F - \u81EA\u52A8\u6545\u969C\u8F6C\u79FB",id:"42-\u54E8\u5175\u6A21\u5F0F---\u81EA\u52A8\u6545\u969C\u8F6C\u79FB",level:3},{value:"4.3 \u96C6\u7FA4\u6A21\u5F0F - \u6C34\u5E73\u6269\u5C55\u65B9\u6848",id:"43-\u96C6\u7FA4\u6A21\u5F0F---\u6C34\u5E73\u6269\u5C55\u65B9\u6848",level:3},{value:"4.4 \u9AD8\u53EF\u7528\u65B9\u6848\u5BF9\u6BD4\u4E0E\u9009\u62E9",id:"44-\u9AD8\u53EF\u7528\u65B9\u6848\u5BF9\u6BD4\u4E0E\u9009\u62E9",level:3},{value:"5. Redis\u6027\u80FD\u4F18\u5316\u5B9E\u6218",id:"5-redis\u6027\u80FD\u4F18\u5316\u5B9E\u6218",level:2},{value:"5.1 \u5185\u5B58\u4F18\u5316\u7B56\u7565",id:"51-\u5185\u5B58\u4F18\u5316\u7B56\u7565",level:3},{value:"5.2 \u7F51\u7EDC\u4E0E\u8FDE\u63A5\u4F18\u5316",id:"52-\u7F51\u7EDC\u4E0E\u8FDE\u63A5\u4F18\u5316",level:3},{value:"5.3 \u6301\u4E45\u5316\u6027\u80FD\u4F18\u5316",id:"53-\u6301\u4E45\u5316\u6027\u80FD\u4F18\u5316",level:3},{value:"6. Redis\u5B9E\u6218\u5E94\u7528\u573A\u666F",id:"6-redis\u5B9E\u6218\u5E94\u7528\u573A\u666F",level:2},{value:"6.1 \u7F13\u5B58\u7CFB\u7EDF\u8BBE\u8BA1",id:"61-\u7F13\u5B58\u7CFB\u7EDF\u8BBE\u8BA1",level:3},{value:"6.2 \u5206\u5E03\u5F0F\u9501\u5B9E\u73B0",id:"62-\u5206\u5E03\u5F0F\u9501\u5B9E\u73B0",level:3},{value:"6.3 \u9650\u6D41\u5668\u5B9E\u73B0",id:"63-\u9650\u6D41\u5668\u5B9E\u73B0",level:3},{value:"6.4 \u6392\u884C\u699C\u7CFB\u7EDF",id:"64-\u6392\u884C\u699C\u7CFB\u7EDF",level:3},{value:"7. Redis\u9762\u8BD5\u9898\u7CBE\u9009",id:"7-redis\u9762\u8BD5\u9898\u7CBE\u9009",level:2},{value:"7.1 \u57FA\u7840\u6982\u5FF5\u9898",id:"71-\u57FA\u7840\u6982\u5FF5\u9898",level:3},{value:"7.2 \u67B6\u6784\u8BBE\u8BA1\u9898",id:"72-\u67B6\u6784\u8BBE\u8BA1\u9898",level:3},{value:"7.3 \u6027\u80FD\u4F18\u5316\u9898",id:"73-\u6027\u80FD\u4F18\u5316\u9898",level:3},{value:"7.4 \u5B9E\u6218\u5E94\u7528\u9898",id:"74-\u5B9E\u6218\u5E94\u7528\u9898",level:3}];function g(e){let n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"redis\u7F13\u5B58\u6570\u636E\u5E93\u8BE6\u89E3",children:"Redis\u7F13\u5B58\u6570\u636E\u5E93\u8BE6\u89E3"})}),"\n",(0,i.jsx)(n.p,{children:"Redis\uFF08Remote Dictionary Server\uFF09\u662F\u4E00\u4E2A\u5F00\u6E90\u7684\u5185\u5B58\u6570\u636E\u7ED3\u6784\u5B58\u50A8\u7CFB\u7EDF\uFF0C\u53EF\u4EE5\u7528\u4F5C\u6570\u636E\u5E93\u3001\u7F13\u5B58\u548C\u6D88\u606F\u4E2D\u95F4\u4EF6\u3002\u5B83\u652F\u6301\u591A\u79CD\u6570\u636E\u7ED3\u6784\uFF0C\u5177\u6709\u9AD8\u6027\u80FD\u3001\u9AD8\u53EF\u7528\u6027\u548C\u4E30\u5BCC\u7684\u529F\u80FD\u7279\u6027\uFF0C\u662F\u73B0\u4EE3Web\u5E94\u7528\u67B6\u6784\u4E2D\u4E0D\u53EF\u6216\u7F3A\u7684\u7EC4\u4EF6\u3002"}),"\n",(0,i.jsxs)(n.admonition,{title:"\u6838\u5FC3\u4EF7\u503C",type:"tip",children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Redis = \u9AD8\u6027\u80FD\u5185\u5B58\u5B58\u50A8 + \u4E30\u5BCC\u6570\u636E\u7ED3\u6784 + \u6301\u4E45\u5316\u673A\u5236 + \u9AD8\u53EF\u7528\u67B6\u6784"})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u{1F680} ",(0,i.jsx)(n.strong,{children:"\u6781\u81F4\u6027\u80FD"}),"\uFF1A\u57FA\u4E8E\u5185\u5B58\u64CD\u4F5C\uFF0C\u5355\u7EBF\u7A0B\u6A21\u578B\uFF0CQPS\u53EF\u8FBE10\u4E07+"]}),"\n",(0,i.jsxs)(n.li,{children:["\u{1F3AF} ",(0,i.jsx)(n.strong,{children:"\u6570\u636E\u7ED3\u6784\u4E30\u5BCC"}),"\uFF1AString\u3001Hash\u3001List\u3001Set\u3001Sorted Set\u3001Stream\u7B49"]}),"\n",(0,i.jsxs)(n.li,{children:["\u{1F4BE} ",(0,i.jsx)(n.strong,{children:"\u6301\u4E45\u5316\u4FDD\u969C"}),"\uFF1ARDB\u5FEB\u7167 + AOF\u65E5\u5FD7 + \u6DF7\u5408\u6301\u4E45\u5316"]}),"\n",(0,i.jsxs)(n.li,{children:["\u{1F504} ",(0,i.jsx)(n.strong,{children:"\u9AD8\u53EF\u7528\u67B6\u6784"}),"\uFF1A\u4E3B\u4ECE\u590D\u5236 + \u54E8\u5175\u6A21\u5F0F + \u96C6\u7FA4\u5206\u7247"]}),"\n",(0,i.jsxs)(n.li,{children:["\u{1F6E0}\uFE0F ",(0,i.jsx)(n.strong,{children:"\u5E94\u7528\u573A\u666F\u5E7F\u6CDB"}),"\uFF1A\u7F13\u5B58\u3001\u4F1A\u8BDD\u3001\u6392\u884C\u699C\u3001\u5206\u5E03\u5F0F\u9501\u3001\u6D88\u606F\u961F\u5217"]}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"1-redis\u57FA\u7840\u67B6\u6784\u4E0E\u7279\u6027",children:"1. Redis\u57FA\u7840\u67B6\u6784\u4E0E\u7279\u6027"}),"\n",(0,i.jsx)(n.h3,{id:"11-redis\u6838\u5FC3\u7279\u6027",children:"1.1 Redis\u6838\u5FC3\u7279\u6027"}),"\n",(0,i.jsx)(n.p,{children:"Redis\u4F5C\u4E3A\u5185\u5B58\u6570\u636E\u5E93\uFF0C\u5177\u6709\u4EE5\u4E0B\u6838\u5FC3\u7279\u6027\uFF1A"}),"\n",(0,i.jsx)(n.mermaid,{value:"graph TB\n    A[Redis\u6838\u5FC3\u7279\u6027] --\x3e B[\u9AD8\u6027\u80FD]\n    A --\x3e C[\u6570\u636E\u7ED3\u6784\u4E30\u5BCC]\n    A --\x3e D[\u6301\u4E45\u5316\u673A\u5236]\n    A --\x3e E[\u9AD8\u53EF\u7528\u6027]\n    A --\x3e F[\u6269\u5C55\u6027\u5F3A]\n    \n    B --\x3e B1[\u5185\u5B58\u64CD\u4F5C]\n    B --\x3e B2[\u5355\u7EBF\u7A0B\u6A21\u578B]\n    B --\x3e B3[\u975E\u963B\u585EIO]\n    \n    C --\x3e C1[String\u5B57\u7B26\u4E32]\n    C --\x3e C2[Hash\u54C8\u5E0C]\n    C --\x3e C3[List\u5217\u8868]\n    C --\x3e C4[Set\u96C6\u5408]\n    C --\x3e C5[Sorted Set\u6709\u5E8F\u96C6\u5408]\n    C --\x3e C6[Stream\u6D41]\n    \n    D --\x3e D1[RDB\u5FEB\u7167]\n    D --\x3e D2[AOF\u65E5\u5FD7]\n    D --\x3e D3[\u6DF7\u5408\u6301\u4E45\u5316]\n    \n    E --\x3e E1[\u4E3B\u4ECE\u590D\u5236]\n    E --\x3e E2[\u54E8\u5175\u6A21\u5F0F]\n    E --\x3e E3[\u96C6\u7FA4\u6A21\u5F0F]\n    \n    F --\x3e F1[Lua\u811A\u672C]\n    F --\x3e F2[\u53D1\u5E03\u8BA2\u9605]\n    F --\x3e F3[\u4E8B\u52A1\u652F\u6301]"}),"\n",(0,i.jsx)(n.h3,{id:"12-redis\u5E94\u7528\u573A\u666F\u5BF9\u6BD4",children:"1.2 Redis\u5E94\u7528\u573A\u666F\u5BF9\u6BD4"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u5E94\u7528\u573A\u666F"}),(0,i.jsx)(n.th,{children:"\u6570\u636E\u7ED3\u6784"}),(0,i.jsx)(n.th,{children:"\u5178\u578B\u7528\u4F8B"}),(0,i.jsx)(n.th,{children:"\u6027\u80FD\u7279\u70B9"}),(0,i.jsx)(n.th,{children:"\u9002\u7528\u89C4\u6A21"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u7F13\u5B58\u7CFB\u7EDF"})}),(0,i.jsx)(n.td,{children:"String/Hash"}),(0,i.jsx)(n.td,{children:"\u7528\u6237\u4FE1\u606F\u3001\u5546\u54C1\u8BE6\u60C5\u3001\u9875\u9762\u7F13\u5B58"}),(0,i.jsx)(n.td,{children:"\u8BFB\u5199\u6781\u5FEB\uFF0C\u652F\u6301\u8FC7\u671F"}),(0,i.jsx)(n.td,{children:"\u4E2D\u5927\u578B\u5E94\u7528"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u4F1A\u8BDD\u5B58\u50A8"})}),(0,i.jsx)(n.td,{children:"String/Hash"}),(0,i.jsx)(n.td,{children:"\u7528\u6237\u767B\u5F55\u72B6\u6001\u3001\u8D2D\u7269\u8F66"}),(0,i.jsx)(n.td,{children:"\u9AD8\u5E76\u53D1\u8BFB\u5199"}),(0,i.jsx)(n.td,{children:"\u6240\u6709Web\u5E94\u7528"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u8BA1\u6570\u7EDF\u8BA1"})}),(0,i.jsx)(n.td,{children:"String/Hash"}),(0,i.jsx)(n.td,{children:"\u8BBF\u95EE\u91CF\u3001\u70B9\u8D5E\u6570\u3001\u5E93\u5B58"}),(0,i.jsx)(n.td,{children:"\u539F\u5B50\u64CD\u4F5C\uFF0C\u5B9E\u65F6\u6027\u5F3A"}),(0,i.jsx)(n.td,{children:"\u9AD8\u5E76\u53D1\u573A\u666F"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6392\u884C\u699C"})}),(0,i.jsx)(n.td,{children:"Sorted Set"}),(0,i.jsx)(n.td,{children:"\u6E38\u620F\u6392\u884C\u3001\u70ED\u641C\u699C\u3001\u8BC4\u5206\u7CFB\u7EDF"}),(0,i.jsx)(n.td,{children:"\u81EA\u52A8\u6392\u5E8F\uFF0C\u8303\u56F4\u67E5\u8BE2"}),(0,i.jsx)(n.td,{children:"\u5B9E\u65F6\u6392\u540D\u9700\u6C42"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6D88\u606F\u961F\u5217"})}),(0,i.jsx)(n.td,{children:"List/Stream"}),(0,i.jsx)(n.td,{children:"\u4EFB\u52A1\u961F\u5217\u3001\u4E8B\u4EF6\u901A\u77E5"}),(0,i.jsx)(n.td,{children:"\u963B\u585E\u64CD\u4F5C\uFF0C\u987A\u5E8F\u4FDD\u8BC1"}),(0,i.jsx)(n.td,{children:"\u5F02\u6B65\u5904\u7406\u573A\u666F"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u5206\u5E03\u5F0F\u9501"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"\u8D44\u6E90\u4E92\u65A5\u3001\u9632\u91CD\u590D\u63D0\u4EA4"}),(0,i.jsx)(n.td,{children:"\u539F\u5B50\u64CD\u4F5C\uFF0C\u8FC7\u671F\u673A\u5236"}),(0,i.jsx)(n.td,{children:"\u5206\u5E03\u5F0F\u7CFB\u7EDF"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u5730\u7406\u4F4D\u7F6E"})}),(0,i.jsx)(n.td,{children:"Geo"}),(0,i.jsx)(n.td,{children:"\u9644\u8FD1\u7684\u4EBA\u3001\u914D\u9001\u8303\u56F4"}),(0,i.jsx)(n.td,{children:"\u5730\u7406\u8BA1\u7B97\uFF0C\u8DDD\u79BB\u67E5\u8BE2"}),(0,i.jsx)(n.td,{children:"LBS\u5E94\u7528"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"2-redis\u6570\u636E\u7ED3\u6784\u6DF1\u5EA6\u89E3\u6790",children:"2. Redis\u6570\u636E\u7ED3\u6784\u6DF1\u5EA6\u89E3\u6790"}),"\n",(0,i.jsx)(n.h3,{id:"21-string\u5B57\u7B26\u4E32--\u6700\u57FA\u7840\u7684\u6570\u636E\u7C7B\u578B",children:"2.1 String\uFF08\u5B57\u7B26\u4E32\uFF09- \u6700\u57FA\u7840\u7684\u6570\u636E\u7C7B\u578B"}),"\n",(0,i.jsx)(n.p,{children:"String\u662FRedis\u6700\u57FA\u672C\u7684\u6570\u636E\u7C7B\u578B\uFF0C\u53EF\u4EE5\u5B58\u50A8\u5B57\u7B26\u4E32\u3001\u6574\u6570\u6216\u6D6E\u70B9\u6570\uFF0C\u662F\u5176\u4ED6\u6570\u636E\u7ED3\u6784\u7684\u57FA\u7840\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"basic",label:"\u57FA\u672C\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="String\u57FA\u672C\u64CD\u4F5C"',children:'# \u57FA\u672C\u8BBE\u7F6E\u548C\u83B7\u53D6\nSET user:1001 "John Doe"\nGET user:1001                    # \u8FD4\u56DE: "John Doe"\nGETSET user:1001 "Jane Doe"      # \u8BBE\u7F6E\u65B0\u503C\u5E76\u8FD4\u56DE\u65E7\u503C\nDEL user:1001                    # \u5220\u9664\u952E\nEXISTS user:1001                 # \u68C0\u67E5\u952E\u662F\u5426\u5B58\u5728\n\n# \u6279\u91CF\u64CD\u4F5C - \u63D0\u9AD8\u6027\u80FD\nMSET user:1001 "John" user:1002 "Jane" user:1003 "Bob"\nMGET user:1001 user:1002 user:1003\n# \u8FD4\u56DE: ["John", "Jane", "Bob"]\n\n# \u6761\u4EF6\u8BBE\u7F6E\nSET lock:resource1 "owner1" NX EX 30  # \u4E0D\u5B58\u5728\u65F6\u8BBE\u7F6E\uFF0C30\u79D2\u8FC7\u671F\nSET config:timeout "5000" XX          # \u5B58\u5728\u65F6\u624D\u8BBE\u7F6E\n'})})}),(0,i.jsx)(a.A,{value:"numeric",label:"\u6570\u503C\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u6570\u503C\u64CD\u4F5C"',children:'# \u8BA1\u6570\u5668\u64CD\u4F5C\nSET counter 0\nINCR counter                     # \u9012\u589E1\uFF0C\u8FD4\u56DE: 1\nINCRBY counter 5                 # \u9012\u589E5\uFF0C\u8FD4\u56DE: 6\nDECR counter                     # \u9012\u51CF1\uFF0C\u8FD4\u56DE: 5\nDECRBY counter 3                 # \u9012\u51CF3\uFF0C\u8FD4\u56DE: 2\n\n# \u6D6E\u70B9\u6570\u64CD\u4F5C\nSET price 99.99\nINCRBYFLOAT price 0.01           # \u8FD4\u56DE: "100"\nINCRBYFLOAT price -10.5          # \u8FD4\u56DE: "89.5"\n\n# \u5E94\u7528\u793A\u4F8B\uFF1A\u6587\u7AE0\u9605\u8BFB\u91CF\u7EDF\u8BA1\nINCR article:1001:views          # \u6BCF\u6B21\u8BBF\u95EE\u9012\u589E\nGET article:1001:views           # \u83B7\u53D6\u603B\u9605\u8BFB\u91CF\n'})})}),(0,i.jsx)(a.A,{value:"string-ops",label:"\u5B57\u7B26\u4E32\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u5B57\u7B26\u4E32\u64CD\u4F5C"',children:'# \u5B57\u7B26\u4E32\u62FC\u63A5\u548C\u622A\u53D6\nSET message "Hello"\nAPPEND message " World"          # \u8FD4\u56DE: 11 (\u65B0\u957F\u5EA6)\nGET message                      # \u8FD4\u56DE: "Hello World"\nSTRLEN message                   # \u8FD4\u56DE: 11\n\n# \u5B50\u5B57\u7B26\u4E32\u64CD\u4F5C\nGETRANGE message 0 4             # \u8FD4\u56DE: "Hello"\nSETRANGE message 6 "Redis"       # \u66FF\u6362\u90E8\u5206\u5B57\u7B26\u4E32\nGET message                      # \u8FD4\u56DE: "Hello Redis"\n\n# \u4F4D\u64CD\u4F5C - \u9002\u7528\u4E8E\u5E03\u5C14\u6807\u8BB0\nSETBIT user:1001:flags 0 1       # \u8BBE\u7F6E\u7B2C0\u4F4D\u4E3A1\nGETBIT user:1001:flags 0         # \u83B7\u53D6\u7B2C0\u4F4D\u7684\u503C\nBITCOUNT user:1001:flags         # \u7EDF\u8BA11\u7684\u4E2A\u6570\n'})})})]}),"\n",(0,i.jsx)(n.h4,{id:"string\u5E94\u7528\u5B9E\u8DF5",children:"String\u5E94\u7528\u5B9E\u8DF5"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="Java\u4E2D\u7684String\u64CD\u4F5C\u5B9E\u8DF5"',children:'@Service\npublic class RedisStringService {\n    \n    @Autowired\n    private RedisTemplate<String, String> redisTemplate;\n    \n    /**\n     * \u7F13\u5B58\u7528\u6237\u4FE1\u606F\n     */\n    public void cacheUserInfo(Long userId, User user) {\n        String key = "user:info:" + userId;\n        String userJson = JSON.toJSONString(user);\n        \n        // \u7F13\u5B581\u5C0F\u65F6\n        redisTemplate.opsForValue().set(key, userJson, 1, TimeUnit.HOURS);\n    }\n    \n    /**\n     * \u83B7\u53D6\u7528\u6237\u4FE1\u606F\n     */\n    public User getUserInfo(Long userId) {\n        String key = "user:info:" + userId;\n        String userJson = redisTemplate.opsForValue().get(key);\n        \n        return userJson != null ? JSON.parseObject(userJson, User.class) : null;\n    }\n    \n    /**\n     * \u6587\u7AE0\u9605\u8BFB\u91CF\u7EDF\u8BA1\n     */\n    public Long incrementArticleViews(Long articleId) {\n        String key = "article:views:" + articleId;\n        return redisTemplate.opsForValue().increment(key);\n    }\n    \n    /**\n     * \u5206\u5E03\u5F0F\u9501\u5B9E\u73B0\n     */\n    public boolean tryLock(String lockKey, String lockValue, long timeout) {\n        Boolean result = redisTemplate.opsForValue()\n            .setIfAbsent(lockKey, lockValue, timeout, TimeUnit.SECONDS);\n        return Boolean.TRUE.equals(result);\n    }\n    \n    /**\n     * \u9650\u6D41\u5668\u5B9E\u73B0 - \u6ED1\u52A8\u7A97\u53E3\n     */\n    public boolean isAllowed(String key, int maxRequests, int windowSeconds) {\n        String script = \n            "local current = redis.call(\'incr\', KEYS[1]) " +\n            "if tonumber(current) == 1 then " +\n            "    redis.call(\'expire\', KEYS[1], ARGV[1]) " +\n            "end " +\n            "return tonumber(current) <= tonumber(ARGV[2])";\n        \n        Long result = redisTemplate.execute(\n            new DefaultRedisScript<>(script, Long.class),\n            Collections.singletonList(key),\n            String.valueOf(windowSeconds),\n            String.valueOf(maxRequests)\n        );\n        \n        return Long.valueOf(1).equals(result);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"22-hash\u54C8\u5E0C--\u5BF9\u8C61\u5B58\u50A8\u7684\u6700\u4F73\u9009\u62E9",children:"2.2 Hash\uFF08\u54C8\u5E0C\uFF09- \u5BF9\u8C61\u5B58\u50A8\u7684\u6700\u4F73\u9009\u62E9"}),"\n",(0,i.jsx)(n.p,{children:"Hash\u662F\u4E00\u4E2A\u952E\u503C\u5BF9\u96C6\u5408\uFF0C\u7279\u522B\u9002\u5408\u5B58\u50A8\u5BF9\u8C61\u6570\u636E\uFF0C\u76F8\u6BD4String\u5B58\u50A8JSON\u6709\u66F4\u597D\u7684\u6027\u80FD\u548C\u7075\u6D3B\u6027\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"basic",label:"\u57FA\u672C\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Hash\u57FA\u672C\u64CD\u4F5C"',children:'# \u5355\u4E2A\u5B57\u6BB5\u64CD\u4F5C\nHSET user:1001 name "John Doe"\nHSET user:1001 age 25\nHSET user:1001 email "john@example.com"\n\nHGET user:1001 name              # \u8FD4\u56DE: "John Doe"\nHGETALL user:1001                # \u8FD4\u56DE\u6240\u6709\u5B57\u6BB5\u548C\u503C\nHDEL user:1001 age               # \u5220\u9664age\u5B57\u6BB5\nHEXISTS user:1001 name           # \u68C0\u67E5\u5B57\u6BB5\u662F\u5426\u5B58\u5728\n\n# \u6279\u91CF\u64CD\u4F5C\nHMSET user:1002 name "Jane" age 30 email "jane@example.com" city "Beijing"\nHMGET user:1002 name age email   # \u6279\u91CF\u83B7\u53D6\u6307\u5B9A\u5B57\u6BB5\n'})})}),(0,i.jsx)(a.A,{value:"advanced",label:"\u9AD8\u7EA7\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Hash\u9AD8\u7EA7\u64CD\u4F5C"',children:'# \u6570\u503C\u64CD\u4F5C\nHSET product:1001 price 99.99\nHSET product:1001 stock 100\nHINCRBY product:1001 stock -1    # \u5E93\u5B58\u51CF1\nHINCRBYFLOAT product:1001 price 0.01  # \u4EF7\u683C\u589E\u52A00.01\n\n# \u5B57\u6BB5\u4FE1\u606F\u83B7\u53D6\nHKEYS user:1001                  # \u83B7\u53D6\u6240\u6709\u5B57\u6BB5\u540D\nHVALS user:1001                  # \u83B7\u53D6\u6240\u6709\u5B57\u6BB5\u503C\nHLEN user:1001                   # \u83B7\u53D6\u5B57\u6BB5\u6570\u91CF\n\n# \u6761\u4EF6\u8BBE\u7F6E\nHSETNX user:1001 phone "1234567890"  # \u5B57\u6BB5\u4E0D\u5B58\u5728\u65F6\u624D\u8BBE\u7F6E\n'})})}),(0,i.jsx)(a.A,{value:"use-cases",label:"\u5E94\u7528\u573A\u666F",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Hash\u5178\u578B\u5E94\u7528\u573A\u666F"',children:'# 1. \u7528\u6237\u4FE1\u606F\u5B58\u50A8\nHMSET user:1001 \n    name "John Doe" \n    age 25 \n    email "john@example.com" \n    phone "1234567890"\n    created_at "2025-01-01"\n    last_login "2025-08-11"\n\n# 2. \u8D2D\u7269\u8F66\u5B9E\u73B0\nHSET cart:user:1001 product:1001 2    # \u5546\u54C11001\uFF0C\u6570\u91CF2\nHSET cart:user:1001 product:1002 1    # \u5546\u54C11002\uFF0C\u6570\u91CF1\nHINCRBY cart:user:1001 product:1001 1 # \u589E\u52A0\u5546\u54C11001\u6570\u91CF\nHGETALL cart:user:1001                # \u83B7\u53D6\u6574\u4E2A\u8D2D\u7269\u8F66\n\n# 3. \u5546\u54C1\u4FE1\u606F\u7F13\u5B58\nHMSET product:1001 \n    name "iPhone 15" \n    price 5999 \n    stock 100 \n    category "electronics"\n    brand "Apple"\n    \n# 4. \u914D\u7F6E\u4FE1\u606F\u7BA1\u7406\nHMSET config:app \n    name "MyApp" \n    version "1.0.0" \n    port 8080 \n    debug true\n    max_connections 1000\n'})})})]}),"\n",(0,i.jsx)(n.h4,{id:"hash-vs-string-\u6027\u80FD\u5BF9\u6BD4",children:"Hash vs String \u6027\u80FD\u5BF9\u6BD4"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u5BF9\u6BD4\u7EF4\u5EA6"}),(0,i.jsx)(n.th,{children:"Hash"}),(0,i.jsx)(n.th,{children:"String (JSON)"}),(0,i.jsx)(n.th,{children:"\u4F18\u52BF\u5206\u6790"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u5185\u5B58\u4F7F\u7528"})}),(0,i.jsx)(n.td,{children:"\u66F4\u8282\u7701"}),(0,i.jsx)(n.td,{children:"\u8F83\u591A"}),(0,i.jsx)(n.td,{children:"Hash\u907F\u514D\u4E86JSON\u5E8F\u5217\u5316\u5F00\u9500"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u90E8\u5206\u66F4\u65B0"})}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u9700\u8981\u5168\u91CF\u66F4\u65B0"}),(0,i.jsx)(n.td,{children:"Hash\u53EF\u4EE5\u53EA\u66F4\u65B0\u5355\u4E2A\u5B57\u6BB5"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u67E5\u8BE2\u6027\u80FD"})}),(0,i.jsx)(n.td,{children:"\u5355\u5B57\u6BB5\u5FEB"}),(0,i.jsx)(n.td,{children:"\u5168\u91CF\u89E3\u6790"}),(0,i.jsx)(n.td,{children:"Hash\u652F\u6301\u5B57\u6BB5\u7EA7\u522B\u7684\u64CD\u4F5C"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6570\u636E\u7C7B\u578B"})}),(0,i.jsx)(n.td,{children:"\u539F\u751F\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u5B57\u7B26\u4E32"}),(0,i.jsx)(n.td,{children:"Hash\u652F\u6301\u6570\u503C\u64CD\u4F5C"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u590D\u6742\u67E5\u8BE2"})}),(0,i.jsx)(n.td,{children:"\u6709\u9650"}),(0,i.jsx)(n.td,{children:"\u7075\u6D3B"}),(0,i.jsx)(n.td,{children:"JSON\u652F\u6301\u590D\u6742\u5D4C\u5957\u7ED3\u6784"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"23-list\u5217\u8868--\u6709\u5E8F\u6570\u636E\u7684\u7406\u60F3\u9009\u62E9",children:"2.3 List\uFF08\u5217\u8868\uFF09- \u6709\u5E8F\u6570\u636E\u7684\u7406\u60F3\u9009\u62E9"}),"\n",(0,i.jsx)(n.p,{children:"List\u662F\u4E00\u4E2A\u53CC\u5411\u94FE\u8868\uFF0C\u652F\u6301\u4ECE\u4E24\u7AEF\u6DFB\u52A0\u6216\u5220\u9664\u5143\u7D20\uFF0C\u9002\u5408\u5B9E\u73B0\u961F\u5217\u3001\u6808\u548C\u65F6\u95F4\u7EBF\u7B49\u573A\u666F\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"basic",label:"\u57FA\u672C\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="List\u57FA\u672C\u64CD\u4F5C"',children:'# \u6DFB\u52A0\u5143\u7D20\nLPUSH mylist "item1"             # \u5DE6\u7AEF\u6DFB\u52A0\nRPUSH mylist "item2" "item3"     # \u53F3\u7AEF\u6DFB\u52A0\u591A\u4E2A\u5143\u7D20\nLINSERT mylist BEFORE "item2" "new_item"  # \u5728\u6307\u5B9A\u5143\u7D20\u524D\u63D2\u5165\n\n# \u83B7\u53D6\u5143\u7D20\nLRANGE mylist 0 -1               # \u83B7\u53D6\u6240\u6709\u5143\u7D20\nLINDEX mylist 0                  # \u83B7\u53D6\u6307\u5B9A\u4F4D\u7F6E\u7684\u5143\u7D20\nLLEN mylist                      # \u83B7\u53D6\u5217\u8868\u957F\u5EA6\n\n# \u5220\u9664\u5143\u7D20\nLPOP mylist                      # \u5DE6\u7AEF\u5F39\u51FA\nRPOP mylist                      # \u53F3\u7AEF\u5F39\u51FA\nLREM mylist 1 "item1"            # \u5220\u9664\u6307\u5B9A\u6570\u91CF\u7684\u5143\u7D20\nLTRIM mylist 0 99                # \u4FDD\u7559\u6307\u5B9A\u8303\u56F4\u7684\u5143\u7D20\n'})})}),(0,i.jsx)(a.A,{value:"blocking",label:"\u963B\u585E\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="List\u963B\u585E\u64CD\u4F5C"',children:'# \u963B\u585E\u5F39\u51FA - \u5B9E\u73B0\u6D88\u606F\u961F\u5217\nBLPOP queue:tasks 10             # \u963B\u585E10\u79D2\u7B49\u5F85\u5DE6\u7AEF\u5F39\u51FA\nBRPOP queue:tasks 0              # \u65E0\u9650\u7B49\u5F85\u53F3\u7AEF\u5F39\u51FA\nBRPOPLPUSH source dest 5         # \u4ECEsource\u5F39\u51FA\u5E76\u63A8\u5165dest\n\n# \u751F\u4EA7\u8005-\u6D88\u8D39\u8005\u6A21\u5F0F\n# \u751F\u4EA7\u8005\nLPUSH queue:emails "email1@example.com"\nLPUSH queue:emails "email2@example.com"\n\n# \u6D88\u8D39\u8005\nBRPOP queue:emails 0             # \u963B\u585E\u7B49\u5F85\u90AE\u4EF6\u4EFB\u52A1\n'})})}),(0,i.jsx)(a.A,{value:"applications",label:"\u5E94\u7528\u573A\u666F",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="List\u5E94\u7528\u573A\u666F"',children:'# 1. \u6D88\u606F\u961F\u5217\u5B9E\u73B0\nLPUSH queue:notifications "user:1001:login"\nLPUSH queue:notifications "order:2001:created"\nBRPOP queue:notifications 0      # \u6D88\u8D39\u8005\u83B7\u53D6\u901A\u77E5\n\n# 2. \u7528\u6237\u52A8\u6001\u65F6\u95F4\u7EBF\nLPUSH user:1001:timeline "post:3001"\nLPUSH user:1001:timeline "post:3002"\nLRANGE user:1001:timeline 0 9    # \u83B7\u53D6\u6700\u65B010\u6761\u52A8\u6001\n\n# 3. \u6700\u8FD1\u8BBF\u95EE\u8BB0\u5F55\nLPUSH user:1001:recent_pages "page:home"\nLPUSH user:1001:recent_pages "page:product:1001"\nLTRIM user:1001:recent_pages 0 19  # \u53EA\u4FDD\u7559\u6700\u8FD120\u6761\u8BB0\u5F55\n\n# 4. \u4EFB\u52A1\u961F\u5217\nLPUSH tasks:high_priority "task:urgent:1001"\nLPUSH tasks:normal "task:normal:2001"\nBRPOP tasks:high_priority tasks:normal 0  # \u4F18\u5148\u5904\u7406\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"24-set\u96C6\u5408--\u53BB\u91CD\u548C\u96C6\u5408\u8FD0\u7B97",children:"2.4 Set\uFF08\u96C6\u5408\uFF09- \u53BB\u91CD\u548C\u96C6\u5408\u8FD0\u7B97"}),"\n",(0,i.jsx)(n.p,{children:"Set\u662F\u4E00\u4E2A\u65E0\u5E8F\u7684\u5B57\u7B26\u4E32\u96C6\u5408\uFF0C\u4E0D\u5141\u8BB8\u91CD\u590D\u5143\u7D20\uFF0C\u652F\u6301\u96C6\u5408\u95F4\u7684\u4EA4\u96C6\u3001\u5E76\u96C6\u3001\u5DEE\u96C6\u8FD0\u7B97\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"basic",label:"\u57FA\u672C\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Set\u57FA\u672C\u64CD\u4F5C"',children:'# \u6DFB\u52A0\u548C\u5220\u9664\nSADD myset "member1" "member2" "member3"\nSREM myset "member1"             # \u5220\u9664\u6210\u5458\nSMEMBERS myset                   # \u83B7\u53D6\u6240\u6709\u6210\u5458\nSCARD myset                      # \u83B7\u53D6\u6210\u5458\u6570\u91CF\nSISMEMBER myset "member2"        # \u68C0\u67E5\u6210\u5458\u662F\u5426\u5B58\u5728\n\n# \u968F\u673A\u64CD\u4F5C\nSRANDMEMBER myset 2              # \u968F\u673A\u83B7\u53D62\u4E2A\u6210\u5458\nSPOP myset                       # \u968F\u673A\u5F39\u51FA\u5E76\u5220\u9664\u4E00\u4E2A\u6210\u5458\n'})})}),(0,i.jsx)(a.A,{value:"set-ops",label:"\u96C6\u5408\u8FD0\u7B97",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Set\u96C6\u5408\u8FD0\u7B97"',children:'# \u521B\u5EFA\u6D4B\u8BD5\u96C6\u5408\nSADD set1 "a" "b" "c" "d"\nSADD set2 "b" "c" "e" "f"\nSADD set3 "c" "d" "g" "h"\n\n# \u4EA4\u96C6\u8FD0\u7B97\nSINTER set1 set2                 # \u8FD4\u56DE: ["b", "c"]\nSINTERSTORE result set1 set2     # \u4EA4\u96C6\u7ED3\u679C\u5B58\u50A8\u5230result\n\n# \u5E76\u96C6\u8FD0\u7B97\nSUNION set1 set2                 # \u8FD4\u56DE: ["a", "b", "c", "d", "e", "f"]\nSUNIONSTORE result set1 set2 set3\n\n# \u5DEE\u96C6\u8FD0\u7B97\nSDIFF set1 set2                  # \u8FD4\u56DE: ["a", "d"] (set1\u4E2D\u6709\u4F46set2\u4E2D\u6CA1\u6709)\nSDIFFSTORE result set1 set2\n'})})}),(0,i.jsx)(a.A,{value:"use-cases",label:"\u5E94\u7528\u573A\u666F",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Set\u5E94\u7528\u573A\u666F"',children:'# 1. \u7528\u6237\u6807\u7B7E\u7CFB\u7EDF\nSADD user:1001:tags "java" "redis" "mysql" "spring"\nSADD user:1002:tags "python" "redis" "mongodb" "django"\nSINTER user:1001:tags user:1002:tags  # \u5171\u540C\u6280\u80FD\u6807\u7B7E\n\n# 2. \u597D\u53CB\u5173\u7CFB\nSADD user:1001:friends "user:1002" "user:1003" "user:1004"\nSADD user:1002:friends "user:1001" "user:1005" "user:1006"\nSINTER user:1001:friends user:1002:friends  # \u5171\u540C\u597D\u53CB\n\n# 3. \u6587\u7AE0\u70B9\u8D5E\u7528\u6237\nSADD article:1001:likes "user:1001" "user:1002" "user:1003"\nSCARD article:1001:likes         # \u70B9\u8D5E\u603B\u6570\nSISMEMBER article:1001:likes "user:1001"  # \u68C0\u67E5\u7528\u6237\u662F\u5426\u70B9\u8D5E\n\n# 4. \u5728\u7EBF\u7528\u6237\u7EDF\u8BA1\nSADD online:users "user:1001" "user:1002"\nSCARD online:users               # \u5728\u7EBF\u7528\u6237\u6570\nSREM online:users "user:1001"    # \u7528\u6237\u4E0B\u7EBF\n\n# 5. \u62BD\u5956\u7CFB\u7EDF\nSADD lottery:participants "user:1001" "user:1002" "user:1003"\nSPOP lottery:participants        # \u968F\u673A\u62BD\u53D6\u83B7\u5956\u8005\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"25-sorted-set\u6709\u5E8F\u96C6\u5408--\u6392\u5E8F\u548C\u6392\u540D",children:"2.5 Sorted Set\uFF08\u6709\u5E8F\u96C6\u5408\uFF09- \u6392\u5E8F\u548C\u6392\u540D"}),"\n",(0,i.jsx)(n.p,{children:"Sorted Set\u662F\u4E00\u4E2A\u6709\u5E8F\u7684\u5B57\u7B26\u4E32\u96C6\u5408\uFF0C\u6BCF\u4E2A\u6210\u5458\u90FD\u6709\u4E00\u4E2A\u5206\u6570\uFF0C\u6309\u5206\u6570\u6392\u5E8F\uFF0C\u9002\u5408\u5B9E\u73B0\u6392\u884C\u699C\u3001\u4F18\u5148\u7EA7\u961F\u5217\u7B49\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"basic",label:"\u57FA\u672C\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Sorted Set\u57FA\u672C\u64CD\u4F5C"',children:'# \u6DFB\u52A0\u6210\u5458\nZADD leaderboard 1000 "player1"\nZADD leaderboard 1200 "player2" 800 "player3"\n\n# \u83B7\u53D6\u4FE1\u606F\nZSCORE leaderboard "player1"     # \u83B7\u53D6\u5206\u6570: 1000\nZRANK leaderboard "player1"      # \u83B7\u53D6\u6392\u540D(\u5347\u5E8F): 1\nZREVRANK leaderboard "player1"   # \u83B7\u53D6\u6392\u540D(\u964D\u5E8F): 1\nZCARD leaderboard                # \u83B7\u53D6\u6210\u5458\u603B\u6570\n\n# \u8303\u56F4\u67E5\u8BE2\nZRANGE leaderboard 0 -1          # \u83B7\u53D6\u6240\u6709\u6210\u5458(\u5347\u5E8F)\nZREVRANGE leaderboard 0 -1       # \u83B7\u53D6\u6240\u6709\u6210\u5458(\u964D\u5E8F)\nZRANGE leaderboard 0 -1 WITHSCORES  # \u5305\u542B\u5206\u6570\n'})})}),(0,i.jsx)(a.A,{value:"advanced",label:"\u9AD8\u7EA7\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Sorted Set\u9AD8\u7EA7\u64CD\u4F5C"',children:'# \u5206\u6570\u8303\u56F4\u67E5\u8BE2\nZRANGEBYSCORE leaderboard 800 1200        # \u5206\u6570\u5728800-1200\u4E4B\u95F4\nZREVRANGEBYSCORE leaderboard 1200 800     # \u964D\u5E8F\nZCOUNT leaderboard 800 1200               # \u7EDF\u8BA1\u8303\u56F4\u5185\u6210\u5458\u6570\n\n# \u5220\u9664\u64CD\u4F5C\nZREM leaderboard "player1"                # \u5220\u9664\u6210\u5458\nZREMRANGEBYRANK leaderboard 0 2           # \u5220\u9664\u6392\u540D\u524D3\u7684\u6210\u5458\nZREMRANGEBYSCORE leaderboard 0 500        # \u5220\u9664\u5206\u65700-500\u7684\u6210\u5458\n\n# \u5206\u6570\u64CD\u4F5C\nZINCRBY leaderboard 100 "player1"         # \u589E\u52A0\u5206\u6570\nZINCRBY leaderboard -50 "player2"         # \u51CF\u5C11\u5206\u6570\n\n# \u96C6\u5408\u8FD0\u7B97\nZUNIONSTORE result 2 set1 set2 WEIGHTS 1 2  # \u5E76\u96C6\uFF0Cset2\u6743\u91CD\u4E3A2\nZINTERSTORE result 2 set1 set2 AGGREGATE MAX # \u4EA4\u96C6\uFF0C\u53D6\u6700\u5927\u5206\u6570\n'})})}),(0,i.jsx)(a.A,{value:"use-cases",label:"\u5E94\u7528\u573A\u666F",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Sorted Set\u5E94\u7528\u573A\u666F"',children:'# 1. \u6E38\u620F\u6392\u884C\u699C\nZADD game:leaderboard 15000 "player:1001"\nZADD game:leaderboard 12000 "player:1002"\nZADD game:leaderboard 18000 "player:1003"\nZREVRANGE game:leaderboard 0 9 WITHSCORES  # \u83B7\u53D6\u524D10\u540D\n\n# 2. \u70ED\u641C\u6392\u884C\nZADD trending:topics 1500 "Redis\u6559\u7A0B"\nZADD trending:topics 1200 "Java\u9762\u8BD5"\nZADD trending:topics 1800 "Spring Boot"\nZREVRANGE trending:topics 0 4             # \u83B7\u53D6\u524D5\u4E2A\u70ED\u641C\n\n# 3. \u65F6\u95F4\u7EBF\u6392\u5E8F\nZADD user:1001:timeline 1640995200 "post:1001"\nZADD user:1001:timeline 1640995300 "post:1002"\nZREVRANGE user:1001:timeline 0 9          # \u83B7\u53D6\u6700\u65B010\u6761\u52A8\u6001\n\n# 4. \u4F18\u5148\u7EA7\u4EFB\u52A1\u961F\u5217\nZADD tasks:queue 1 "low_priority_task"\nZADD tasks:queue 5 "high_priority_task"\nZADD tasks:queue 3 "medium_priority_task"\nZREVRANGE tasks:queue 0 0                 # \u83B7\u53D6\u6700\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\n\n# 5. \u5546\u54C1\u9500\u91CF\u6392\u884C\nZADD products:sales 500 "product:1001"\nZADD products:sales 800 "product:1002"\nZINCRBY products:sales 1 "product:1001"   # \u9500\u91CF+1\nZREVRANGE products:sales 0 9 WITHSCORES   # \u9500\u91CF\u6392\u884C\u699C\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"26-stream\u6D41--\u73B0\u4EE3\u6D88\u606F\u961F\u5217\u89E3\u51B3\u65B9\u6848",children:"2.6 Stream\uFF08\u6D41\uFF09- \u73B0\u4EE3\u6D88\u606F\u961F\u5217\u89E3\u51B3\u65B9\u6848"}),"\n",(0,i.jsx)(n.p,{children:"Stream\u662FRedis 5.0\u5F15\u5165\u7684\u65B0\u6570\u636E\u7C7B\u578B\uFF0C\u4E13\u95E8\u7528\u4E8E\u6784\u5EFA\u6D88\u606F\u961F\u5217\u548C\u4E8B\u4EF6\u6D41\u5904\u7406\u7CFB\u7EDF\uFF0C\u652F\u6301\u6D88\u8D39\u8005\u7EC4\u3001\u6D88\u606F\u786E\u8BA4\u7B49\u9AD8\u7EA7\u7279\u6027\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"basic",label:"\u57FA\u672C\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Stream\u57FA\u672C\u64CD\u4F5C"',children:'# \u6DFB\u52A0\u6D88\u606F\nXADD user_events * user_id 1001 action "login" timestamp 1640995200\nXADD user_events * user_id 1002 action "logout" timestamp 1640995300\nXADD user_events 1640995400000-0 user_id 1003 action "purchase" amount 99.99\n\n# \u8BFB\u53D6\u6D88\u606F\nXREAD COUNT 10 STREAMS user_events 0      # \u4ECE\u5F00\u59CB\u8BFB\u53D610\u6761\u6D88\u606F\nXREAD BLOCK 5000 STREAMS user_events $    # \u963B\u585E5\u79D2\u7B49\u5F85\u65B0\u6D88\u606F\nXREAD STREAMS user_events order_events 0-0 0-0  # \u4ECE\u591A\u4E2A\u6D41\u8BFB\u53D6\n\n# \u8303\u56F4\u67E5\u8BE2\nXRANGE user_events - +                    # \u83B7\u53D6\u6240\u6709\u6D88\u606F\nXRANGE user_events 1640995200000 1640995400000  # \u65F6\u95F4\u8303\u56F4\u67E5\u8BE2\nXREVRANGE user_events + - COUNT 5         # \u53CD\u5411\u83B7\u53D6\u6700\u65B05\u6761\u6D88\u606F\n\n# \u6D41\u4FE1\u606F\nXLEN user_events                          # \u83B7\u53D6\u6D88\u606F\u6570\u91CF\nXINFO STREAM user_events                  # \u83B7\u53D6\u6D41\u8BE6\u7EC6\u4FE1\u606F\n'})})}),(0,i.jsx)(a.A,{value:"consumer-group",label:"\u6D88\u8D39\u8005\u7EC4",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Stream\u6D88\u8D39\u8005\u7EC4"',children:"# \u521B\u5EFA\u6D88\u8D39\u8005\u7EC4\nXGROUP CREATE user_events analytics_group $     # \u4ECE\u6700\u65B0\u6D88\u606F\u5F00\u59CB\nXGROUP CREATE user_events backup_group 0        # \u4ECE\u5934\u5F00\u59CB\u6D88\u8D39\n\n# \u6D88\u8D39\u8005\u8BFB\u53D6\u6D88\u606F\nXREADGROUP GROUP analytics_group consumer1 COUNT 1 STREAMS user_events >\nXREADGROUP GROUP analytics_group consumer2 COUNT 5 STREAMS user_events >\n\n# \u6D88\u606F\u786E\u8BA4\nXACK user_events analytics_group 1640995200000-0\n\n# \u67E5\u770B\u5F85\u786E\u8BA4\u6D88\u606F\nXPENDING user_events analytics_group              # \u67E5\u770B\u7EC4\u7684\u5F85\u786E\u8BA4\u6D88\u606F\nXPENDING user_events analytics_group - + 10 consumer1  # \u67E5\u770B\u7279\u5B9A\u6D88\u8D39\u8005\u7684\u5F85\u786E\u8BA4\u6D88\u606F\n\n# \u58F0\u660E\u6D88\u606F\u6240\u6709\u6743\uFF08\u5904\u7406\u6545\u969C\u6D88\u8D39\u8005\u7684\u6D88\u606F\uFF09\nXCLAIM user_events analytics_group consumer2 3600000 1640995200000-0\n\n# \u5220\u9664\u6D88\u606F\nXDEL user_events 1640995200000-0\nXTRIM user_events MAXLEN 1000              # \u4FDD\u7559\u6700\u65B01000\u6761\u6D88\u606F\n"})})}),(0,i.jsx)(a.A,{value:"use-cases",label:"\u5E94\u7528\u573A\u666F",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Stream\u5E94\u7528\u573A\u666F"',children:'# 1. \u7528\u6237\u884C\u4E3A\u4E8B\u4EF6\u6D41\nXADD user_behavior * user_id 1001 page "home" action "view" timestamp 1640995200\nXADD user_behavior * user_id 1001 page "product" action "click" product_id 2001\nXADD user_behavior * user_id 1001 action "purchase" order_id 3001 amount 299.99\n\n# \u6D88\u8D39\u8005\u7EC4\u5904\u7406\u4E0D\u540C\u4E1A\u52A1\nXGROUP CREATE user_behavior analytics_group $    # \u6570\u636E\u5206\u6790\u7EC4\nXGROUP CREATE user_behavior recommendation_group $  # \u63A8\u8350\u7CFB\u7EDF\u7EC4\n\n# 2. \u8BA2\u5355\u72B6\u6001\u53D8\u66F4\u6D41\nXADD order_events * order_id 1001 status "created" user_id 2001\nXADD order_events * order_id 1001 status "paid" payment_id 3001\nXADD order_events * order_id 1001 status "shipped" tracking_no "SF123456"\n\n# 3. \u7CFB\u7EDF\u65E5\u5FD7\u6D41\nXADD system_logs * level "ERROR" service "user-service" message "Database connection failed"\nXADD system_logs * level "INFO" service "order-service" message "Order processed successfully"\n\n# 4. \u5B9E\u65F6\u901A\u77E5\u6D41\nXADD notifications * user_id 1001 type "order_shipped" title "\u60A8\u7684\u8BA2\u5355\u5DF2\u53D1\u8D27"\nXADD notifications * user_id 1001 type "friend_request" from_user 2001\n'})})})]}),"\n",(0,i.jsx)(n.h4,{id:"stream-vs-\u4F20\u7EDF\u6D88\u606F\u961F\u5217\u5BF9\u6BD4",children:"Stream vs \u4F20\u7EDF\u6D88\u606F\u961F\u5217\u5BF9\u6BD4"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u7279\u6027"}),(0,i.jsx)(n.th,{children:"Redis Stream"}),(0,i.jsx)(n.th,{children:"RabbitMQ"}),(0,i.jsx)(n.th,{children:"Kafka"}),(0,i.jsx)(n.th,{children:"\u9002\u7528\u573A\u666F"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6D88\u606F\u6301\u4E45\u5316"})}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u6240\u6709\u573A\u666F"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6D88\u8D39\u8005\u7EC4"})}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u591A\u6D88\u8D39\u8005\u573A\u666F"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6D88\u606F\u786E\u8BA4"})}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u53EF\u9760\u6027\u8981\u6C42\u9AD8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6D88\u606F\u56DE\u6EAF"})}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u6709\u9650"}),(0,i.jsx)(n.td,{children:"\u652F\u6301"}),(0,i.jsx)(n.td,{children:"\u9700\u8981\u91CD\u65B0\u5904\u7406\u5386\u53F2\u6D88\u606F"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6027\u80FD"})}),(0,i.jsx)(n.td,{children:"\u6781\u9AD8"}),(0,i.jsx)(n.td,{children:"\u9AD8"}),(0,i.jsx)(n.td,{children:"\u6781\u9AD8"}),(0,i.jsx)(n.td,{children:"\u9AD8\u5E76\u53D1\u573A\u666F"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u8FD0\u7EF4\u590D\u6742\u5EA6"})}),(0,i.jsx)(n.td,{children:"\u4F4E"}),(0,i.jsx)(n.td,{children:"\u4E2D"}),(0,i.jsx)(n.td,{children:"\u9AD8"}),(0,i.jsx)(n.td,{children:"\u7B80\u5355\u90E8\u7F72\u9700\u6C42"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u751F\u6001\u7CFB\u7EDF"})}),(0,i.jsx)(n.td,{children:"Redis\u751F\u6001"}),(0,i.jsx)(n.td,{children:"\u4E30\u5BCC"}),(0,i.jsx)(n.td,{children:"\u4E30\u5BCC"}),(0,i.jsx)(n.td,{children:"\u5DF2\u6709Redis\u57FA\u7840\u8BBE\u65BD"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"3-redis\u6301\u4E45\u5316\u673A\u5236\u8BE6\u89E3",children:"3. Redis\u6301\u4E45\u5316\u673A\u5236\u8BE6\u89E3"}),"\n",(0,i.jsx)(n.p,{children:"Redis\u4F5C\u4E3A\u5185\u5B58\u6570\u636E\u5E93\uFF0C\u63D0\u4F9B\u4E86\u591A\u79CD\u6301\u4E45\u5316\u673A\u5236\u6765\u4FDD\u8BC1\u6570\u636E\u7684\u5B89\u5168\u6027\u548C\u53EF\u6062\u590D\u6027\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"31-rdb\u6301\u4E45\u5316---\u5FEB\u7167\u5907\u4EFD",children:"3.1 RDB\u6301\u4E45\u5316 - \u5FEB\u7167\u5907\u4EFD"}),"\n",(0,i.jsx)(n.p,{children:"RDB\uFF08Redis Database\uFF09\u901A\u8FC7\u521B\u5EFA\u6570\u636E\u5FEB\u7167\u6765\u5B9E\u73B0\u6301\u4E45\u5316\uFF0C\u662FRedis\u7684\u9ED8\u8BA4\u6301\u4E45\u5316\u65B9\u5F0F\u3002"}),"\n",(0,i.jsx)(n.mermaid,{value:"graph LR\n    A[\u5185\u5B58\u6570\u636E] --\x3e B[Fork\u5B50\u8FDB\u7A0B]\n    B --\x3e C[\u521B\u5EFARDB\u6587\u4EF6]\n    C --\x3e D[\u539F\u5B50\u66FF\u6362\u65E7\u6587\u4EF6]\n    D --\x3e E[\u6301\u4E45\u5316\u5B8C\u6210]\n    \n    F[\u89E6\u53D1\u6761\u4EF6] --\x3e F1[\u5B9A\u65F6\u89E6\u53D1]\n    F --\x3e F2[\u624B\u52A8\u89E6\u53D1]\n    F --\x3e F3[\u5173\u95ED\u89E6\u53D1]"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"config",label:"RDB\u914D\u7F6E",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="RDB\u914D\u7F6E\u8BE6\u89E3"',children:"# redis.conf \u914D\u7F6E\nsave 900 1          # 900\u79D2\u5185\u81F3\u5C111\u4E2Akey\u53D8\u5316\u65F6\u4FDD\u5B58\nsave 300 10         # 300\u79D2\u5185\u81F3\u5C1110\u4E2Akey\u53D8\u5316\u65F6\u4FDD\u5B58  \nsave 60 10000       # 60\u79D2\u5185\u81F3\u5C1110000\u4E2Akey\u53D8\u5316\u65F6\u4FDD\u5B58\n\n# \u5176\u4ED6RDB\u914D\u7F6E\nstop-writes-on-bgsave-error yes    # RDB\u4FDD\u5B58\u5931\u8D25\u65F6\u505C\u6B62\u5199\u5165\nrdbcompression yes                 # \u542F\u7528RDB\u6587\u4EF6\u538B\u7F29\nrdbchecksum yes                    # \u542F\u7528RDB\u6587\u4EF6\u6821\u9A8C\ndbfilename dump.rdb                # RDB\u6587\u4EF6\u540D\ndir /var/lib/redis                 # RDB\u6587\u4EF6\u4FDD\u5B58\u76EE\u5F55\n\n# \u624B\u52A8\u89E6\u53D1RDB\nSAVE                               # \u540C\u6B65\u4FDD\u5B58\uFF08\u963B\u585E\uFF09\nBGSAVE                            # \u5F02\u6B65\u4FDD\u5B58\uFF08\u975E\u963B\u585E\uFF09\nLASTSAVE                          # \u83B7\u53D6\u6700\u540E\u4FDD\u5B58\u65F6\u95F4\n"})})}),(0,i.jsx)(a.A,{value:"process",label:"RDB\u8FC7\u7A0B",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="RDB\u6301\u4E45\u5316\u8FC7\u7A0B"',children:"# 1. \u89E6\u53D1\u6761\u4EF6\u68C0\u67E5\n# - \u5B9A\u65F6\u68C0\u67E5save\u914D\u7F6E\u6761\u4EF6\n# - \u624B\u52A8\u6267\u884CSAVE/BGSAVE\u547D\u4EE4\n# - \u670D\u52A1\u5668\u5173\u95ED\u65F6\u81EA\u52A8\u4FDD\u5B58\n\n# 2. Fork\u5B50\u8FDB\u7A0B\uFF08BGSAVE\uFF09\n# - \u4E3B\u8FDB\u7A0Bfork\u51FA\u5B50\u8FDB\u7A0B\n# - \u5B50\u8FDB\u7A0B\u7EE7\u627F\u4E3B\u8FDB\u7A0B\u7684\u5185\u5B58\u5FEB\u7167\n# - \u4E3B\u8FDB\u7A0B\u7EE7\u7EED\u5904\u7406\u5BA2\u6237\u7AEF\u8BF7\u6C42\n\n# 3. \u5199\u5165RDB\u6587\u4EF6\n# - \u5B50\u8FDB\u7A0B\u5C06\u5185\u5B58\u6570\u636E\u5199\u5165\u4E34\u65F6RDB\u6587\u4EF6\n# - \u4F7F\u7528\u4E8C\u8FDB\u5236\u683C\u5F0F\uFF0C\u9AD8\u5EA6\u538B\u7F29\n# - \u5305\u542B\u6570\u636E\u5E93\u9009\u62E9\u3001\u952E\u503C\u5BF9\u3001\u8FC7\u671F\u65F6\u95F4\u7B49\u4FE1\u606F\n\n# 4. \u539F\u5B50\u66FF\u6362\n# - \u5199\u5165\u5B8C\u6210\u540E\uFF0C\u539F\u5B50\u6027\u5730\u66FF\u6362\u65E7RDB\u6587\u4EF6\n# - \u786E\u4FDDRDB\u6587\u4EF6\u7684\u5B8C\u6574\u6027\n\n# RDB\u6587\u4EF6\u7ED3\u6784\u793A\u4F8B\nREDIS0009       # Redis\u7248\u672C\u548CRDB\u7248\u672C\n$6              # \u6570\u636E\u5E93\u7F16\u53F7\nredis-ver$5     # Redis\u7248\u672C\u4FE1\u606F\nredis-bits$2    # \u67B6\u6784\u4FE1\u606F\nctime$10        # \u521B\u5EFA\u65F6\u95F4\nused-mem$8      # \u4F7F\u7528\u5185\u5B58\n...             # \u952E\u503C\u5BF9\u6570\u636E\n$FF             # \u7ED3\u675F\u6807\u8BB0\n$8              # \u6821\u9A8C\u548C\n"})})}),(0,i.jsx)(a.A,{value:"pros-cons",label:"\u4F18\u7F3A\u70B9\u5206\u6790",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="RDB\u4F18\u7F3A\u70B9\u5206\u6790"',children:"# \u2705 RDB\u4F18\u70B9\n# 1. \u6587\u4EF6\u7D27\u51D1\uFF1A\u9AD8\u5EA6\u538B\u7F29\u7684\u4E8C\u8FDB\u5236\u6587\u4EF6\uFF0C\u9002\u5408\u5907\u4EFD\u548C\u4F20\u8F93\n# 2. \u6062\u590D\u901F\u5EA6\u5FEB\uFF1A\u76F4\u63A5\u52A0\u8F7D\u5230\u5185\u5B58\uFF0C\u542F\u52A8\u901F\u5EA6\u5FEB\n# 3. \u6027\u80FD\u5F71\u54CD\u5C0F\uFF1A\u4F7F\u7528fork\u5B50\u8FDB\u7A0B\uFF0C\u5BF9\u4E3B\u8FDB\u7A0B\u5F71\u54CD\u6700\u5C0F\n# 4. \u9002\u5408\u707E\u5907\uFF1A\u53EF\u4EE5\u5B9A\u671F\u5907\u4EFD\u5230\u8FDC\u7A0B\u5B58\u50A8\n\n# \u274C RDB\u7F3A\u70B9  \n# 1. \u6570\u636E\u4E22\u5931\u98CE\u9669\uFF1A\u4E24\u6B21\u5FEB\u7167\u95F4\u7684\u6570\u636E\u53EF\u80FD\u4E22\u5931\n# 2. Fork\u5F00\u9500\uFF1A\u5927\u6570\u636E\u96C6\u65F6fork\u53EF\u80FD\u8017\u65F6\u8F83\u957F\n# 3. \u4E0D\u9002\u5408\u5B9E\u65F6\uFF1A\u65E0\u6CD5\u505A\u5230\u79D2\u7EA7\u7684\u6570\u636E\u6301\u4E45\u5316\n# 4. \u7248\u672C\u517C\u5BB9\u6027\uFF1A\u4E0D\u540CRedis\u7248\u672C\u7684RDB\u683C\u5F0F\u53EF\u80FD\u4E0D\u517C\u5BB9\n\n# \u9002\u7528\u573A\u666F\n# - \u5BF9\u6570\u636E\u4E22\u5931\u5BB9\u5FCD\u5EA6\u8F83\u9AD8\u7684\u573A\u666F\n# - \u9700\u8981\u5B9A\u671F\u5907\u4EFD\u7684\u573A\u666F  \n# - \u4E3B\u4ECE\u590D\u5236\u7684\u5168\u91CF\u540C\u6B65\n# - \u5FEB\u901F\u91CD\u542F\u6062\u590D\u7684\u573A\u666F\n"})})})]}),"\n",(0,i.jsx)(n.h3,{id:"32-aof\u6301\u4E45\u5316---\u64CD\u4F5C\u65E5\u5FD7",children:"3.2 AOF\u6301\u4E45\u5316 - \u64CD\u4F5C\u65E5\u5FD7"}),"\n",(0,i.jsx)(n.p,{children:"AOF\uFF08Append Only File\uFF09\u901A\u8FC7\u8BB0\u5F55\u6BCF\u4E2A\u5199\u64CD\u4F5C\u547D\u4EE4\u6765\u5B9E\u73B0\u6301\u4E45\u5316\uFF0C\u63D0\u4F9B\u66F4\u597D\u7684\u6570\u636E\u5B89\u5168\u6027\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"config",label:"AOF\u914D\u7F6E",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="AOF\u914D\u7F6E\u8BE6\u89E3"',children:'# redis.conf \u914D\u7F6E\nappendonly yes                          # \u542F\u7528AOF\u6301\u4E45\u5316\nappendfilename "appendonly.aof"         # AOF\u6587\u4EF6\u540D\nappendfsync everysec                    # \u540C\u6B65\u7B56\u7565\n\n# \u540C\u6B65\u7B56\u7565\u9009\u9879\n# appendfsync always      # \u6BCF\u4E2A\u5199\u547D\u4EE4\u90FD\u540C\u6B65\u5230\u78C1\u76D8\uFF08\u6700\u5B89\u5168\uFF0C\u6027\u80FD\u6700\u4F4E\uFF09\n# appendfsync everysec    # \u6BCF\u79D2\u540C\u6B65\u4E00\u6B21\uFF08\u5E73\u8861\u5B89\u5168\u6027\u548C\u6027\u80FD\uFF09\n# appendfsync no          # \u7531\u64CD\u4F5C\u7CFB\u7EDF\u51B3\u5B9A\u4F55\u65F6\u540C\u6B65\uFF08\u6027\u80FD\u6700\u9AD8\uFF0C\u5B89\u5168\u6027\u6700\u4F4E\uFF09\n\n# AOF\u91CD\u5199\u914D\u7F6E\nauto-aof-rewrite-percentage 100        # \u5F53AOF\u6587\u4EF6\u5927\u5C0F\u6BD4\u4E0A\u6B21\u91CD\u5199\u540E\u589E\u957F100%\u65F6\u89E6\u53D1\u91CD\u5199\nauto-aof-rewrite-min-size 64mb         # AOF\u6587\u4EF6\u6700\u5C0F64MB\u65F6\u624D\u8003\u8651\u91CD\u5199\naof-load-truncated yes                 # \u542F\u52A8\u65F6\u52A0\u8F7D\u88AB\u622A\u65AD\u7684AOF\u6587\u4EF6\naof-rewrite-incremental-fsync yes      # \u91CD\u5199\u65F6\u589E\u91CF\u540C\u6B65\n\n# \u624B\u52A8\u89E6\u53D1AOF\u91CD\u5199\nBGREWRITEAOF                           # \u540E\u53F0\u91CD\u5199AOF\u6587\u4EF6\n'})})}),(0,i.jsx)(a.A,{value:"rewrite",label:"AOF\u91CD\u5199",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="AOF\u91CD\u5199\u673A\u5236"',children:"# AOF\u91CD\u5199\u524D\u540E\u5BF9\u6BD4\n# \u539F\u59CBAOF\u6587\u4EF6\u5185\u5BB9\uFF1A\nSET counter 1\nINCR counter        # counter = 2\nINCR counter        # counter = 3  \nINCR counter        # counter = 4\nDEL counter\nSET counter 100\nEXPIRE counter 3600\n\n# \u91CD\u5199\u540EAOF\u6587\u4EF6\u5185\u5BB9\uFF1A\nSET counter 100\nEXPIRE counter 3600\n\n# AOF\u91CD\u5199\u8FC7\u7A0B\n# 1. Fork\u5B50\u8FDB\u7A0B\n#    - \u4E3B\u8FDB\u7A0B\u7EE7\u7EED\u5904\u7406\u5BA2\u6237\u7AEF\u8BF7\u6C42\n#    - \u5B50\u8FDB\u7A0B\u57FA\u4E8E\u5F53\u524D\u5185\u5B58\u72B6\u6001\u751F\u6210\u65B0AOF\u6587\u4EF6\n\n# 2. \u91CD\u5199\u7F13\u51B2\u533A\n#    - \u4E3B\u8FDB\u7A0B\u5C06\u91CD\u5199\u671F\u95F4\u7684\u65B0\u547D\u4EE4\u5199\u5165\u91CD\u5199\u7F13\u51B2\u533A\n#    - \u786E\u4FDD\u91CD\u5199\u8FC7\u7A0B\u4E2D\u7684\u6570\u636E\u4E0D\u4E22\u5931\n\n# 3. \u66FF\u6362AOF\u6587\u4EF6\n#    - \u5B50\u8FDB\u7A0B\u5B8C\u6210\u91CD\u5199\u540E\uFF0C\u4E3B\u8FDB\u7A0B\u5C06\u7F13\u51B2\u533A\u5185\u5BB9\u8FFD\u52A0\u5230\u65B0AOF\u6587\u4EF6\n#    - \u539F\u5B50\u6027\u5730\u66FF\u6362\u65E7AOF\u6587\u4EF6\n\n# 4. \u6E05\u7406\u5DE5\u4F5C\n#    - \u6E05\u7A7A\u91CD\u5199\u7F13\u51B2\u533A\n#    - \u66F4\u65B0AOF\u6587\u4EF6\u63CF\u8FF0\u7B26\n"})})}),(0,i.jsx)(a.A,{value:"format",label:"AOF\u683C\u5F0F",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="AOF\u6587\u4EF6\u683C\u5F0F"',children:'# AOF\u6587\u4EF6\u91C7\u7528Redis\u534F\u8BAE\u683C\u5F0F\n# \u793A\u4F8B\u547D\u4EE4\uFF1ASET mykey myvalue\n\n*3              # \u6570\u7EC4\u957F\u5EA6\u4E3A3\n$3              # \u7B2C\u4E00\u4E2A\u5143\u7D20\u957F\u5EA6\u4E3A3\nSET             # \u547D\u4EE4\u540D\n$5              # \u7B2C\u4E8C\u4E2A\u5143\u7D20\u957F\u5EA6\u4E3A5  \nmykey           # \u952E\u540D\n$7              # \u7B2C\u4E09\u4E2A\u5143\u7D20\u957F\u5EA6\u4E3A7\nmyvalue         # \u503C\n\n# \u590D\u6742\u547D\u4EE4\u793A\u4F8B\uFF1AHMSET user:1001 name "John" age 25\n*6              # \u6570\u7EC4\u957F\u5EA6\u4E3A6\n$5              # HMSET\nHMSET\n$9              # user:1001\nuser:1001  \n$4              # name\nname\n$4              # "John"\nJohn\n$3              # age  \nage\n$2              # 25\n25\n\n# AOF\u6587\u4EF6\u7279\u70B9\n# - \u7EAF\u6587\u672C\u683C\u5F0F\uFF0C\u53EF\u8BFB\u6027\u5F3A\n# - \u4E25\u683C\u6309\u7167Redis\u534F\u8BAE\u683C\u5F0F\n# - \u652F\u6301\u624B\u52A8\u7F16\u8F91\u548C\u4FEE\u590D\n# - \u6587\u4EF6\u5927\u5C0F\u901A\u5E38\u6BD4RDB\u5927\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"33-\u6DF7\u5408\u6301\u4E45\u5316---\u6700\u4F73\u5B9E\u8DF5",children:"3.3 \u6DF7\u5408\u6301\u4E45\u5316 - \u6700\u4F73\u5B9E\u8DF5"}),"\n",(0,i.jsx)(n.p,{children:"Redis 4.0\u5F15\u5165\u6DF7\u5408\u6301\u4E45\u5316\uFF0C\u7ED3\u5408RDB\u548CAOF\u7684\u4F18\u70B9\uFF0C\u662F\u76EE\u524D\u63A8\u8350\u7684\u6301\u4E45\u5316\u65B9\u6848\u3002"}),"\n",(0,i.jsx)(n.mermaid,{value:"graph TB\n    A[\u6DF7\u5408\u6301\u4E45\u5316] --\x3e B[AOF\u91CD\u5199\u65F6]\n    B --\x3e C[RDB\u683C\u5F0F\u5199\u5165\u57FA\u7840\u6570\u636E]\n    B --\x3e D[AOF\u683C\u5F0F\u8FFD\u52A0\u589E\u91CF\u6570\u636E]\n    \n    E[\u6062\u590D\u8FC7\u7A0B] --\x3e F[\u52A0\u8F7DRDB\u90E8\u5206]\n    F --\x3e G[\u91CD\u653EAOF\u90E8\u5206]\n    G --\x3e H[\u5B8C\u6574\u6062\u590D\u6570\u636E]"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"config",label:"\u6DF7\u5408\u6301\u4E45\u5316\u914D\u7F6E",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u6DF7\u5408\u6301\u4E45\u5316\u914D\u7F6E"',children:"# redis.conf \u914D\u7F6E\nappendonly yes                          # \u542F\u7528AOF\naof-use-rdb-preamble yes               # \u542F\u7528\u6DF7\u5408\u6301\u4E45\u5316\n\n# \u5DE5\u4F5C\u539F\u7406\n# 1. AOF\u91CD\u5199\u65F6\uFF0C\u5C06\u5F53\u524D\u6570\u636E\u5E93\u72B6\u6001\u4EE5RDB\u683C\u5F0F\u5199\u5165AOF\u6587\u4EF6\u5F00\u5934\n# 2. \u91CD\u5199\u540E\u7684\u65B0\u5199\u64CD\u4F5C\u4EE5AOF\u683C\u5F0F\u8FFD\u52A0\u5230\u6587\u4EF6\u672B\u5C3E\n# 3. \u6062\u590D\u65F6\u5148\u52A0\u8F7DRDB\u90E8\u5206\uFF0C\u518D\u91CD\u653EAOF\u90E8\u5206\n\n# \u6587\u4EF6\u7ED3\u6784\u793A\u4F8B\n# +-------+-------+-------+\n# |  RDB  |  AOF  |  AOF  |\n# | \u57FA\u7840  | \u589E\u91CF1 | \u589E\u91CF2 |\n# | \u6570\u636E  | \u6570\u636E  | \u6570\u636E  |\n# +-------+-------+-------+\n"})})}),(0,i.jsx)(a.A,{value:"comparison",label:"\u6301\u4E45\u5316\u65B9\u6848\u5BF9\u6BD4",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u6301\u4E45\u5316\u65B9\u6848\u5168\u9762\u5BF9\u6BD4"',children:"# \u{1F4CA} \u6027\u80FD\u5BF9\u6BD4\n# RDB\uFF1A        \u2B50\u2B50\u2B50\u2B50\u2B50 (\u6027\u80FD\u6700\u9AD8)\n# AOF\uFF1A        \u2B50\u2B50\u2B50 (\u4E2D\u7B49\u6027\u80FD)  \n# \u6DF7\u5408\u6301\u4E45\u5316\uFF1A   \u2B50\u2B50\u2B50\u2B50 (\u8F83\u9AD8\u6027\u80FD)\n\n# \u{1F6E1}\uFE0F \u6570\u636E\u5B89\u5168\u6027\u5BF9\u6BD4\n# RDB\uFF1A        \u2B50\u2B50 (\u53EF\u80FD\u4E22\u5931\u8F83\u591A\u6570\u636E)\n# AOF\uFF1A        \u2B50\u2B50\u2B50\u2B50\u2B50 (\u6570\u636E\u6700\u5B89\u5168)\n# \u6DF7\u5408\u6301\u4E45\u5316\uFF1A   \u2B50\u2B50\u2B50\u2B50 (\u8F83\u5B89\u5168)\n\n# \u{1F4BE} \u6587\u4EF6\u5927\u5C0F\u5BF9\u6BD4\n# RDB\uFF1A        \u2B50\u2B50\u2B50\u2B50\u2B50 (\u6587\u4EF6\u6700\u5C0F)\n# AOF\uFF1A        \u2B50\u2B50 (\u6587\u4EF6\u8F83\u5927)\n# \u6DF7\u5408\u6301\u4E45\u5316\uFF1A   \u2B50\u2B50\u2B50\u2B50 (\u6587\u4EF6\u9002\u4E2D)\n\n# \u26A1 \u6062\u590D\u901F\u5EA6\u5BF9\u6BD4  \n# RDB\uFF1A        \u2B50\u2B50\u2B50\u2B50\u2B50 (\u6062\u590D\u6700\u5FEB)\n# AOF\uFF1A        \u2B50\u2B50 (\u6062\u590D\u8F83\u6162)\n# \u6DF7\u5408\u6301\u4E45\u5316\uFF1A   \u2B50\u2B50\u2B50\u2B50 (\u6062\u590D\u8F83\u5FEB)\n"})})}),(0,i.jsx)(a.A,{value:"best-practices",label:"\u6700\u4F73\u5B9E\u8DF5",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u6301\u4E45\u5316\u6700\u4F73\u5B9E\u8DF5"',children:"# \u{1F3AF} \u63A8\u8350\u914D\u7F6E\u65B9\u6848\n\n# \u65B9\u6848\u4E00\uFF1A\u9AD8\u6027\u80FD\u573A\u666F\uFF08\u53EF\u5BB9\u5FCD\u5C11\u91CF\u6570\u636E\u4E22\u5931\uFF09\nsave 900 1\nsave 300 10  \nsave 60 10000\nappendonly no\n\n# \u65B9\u6848\u4E8C\uFF1A\u9AD8\u53EF\u9760\u6027\u573A\u666F\uFF08\u4E0D\u80FD\u5BB9\u5FCD\u6570\u636E\u4E22\u5931\uFF09\nappendonly yes\nappendfsync everysec\naof-use-rdb-preamble yes\n\n# \u65B9\u6848\u4E09\uFF1A\u5E73\u8861\u65B9\u6848\uFF08\u63A8\u8350\uFF09\nsave 900 1\nappendonly yes  \nappendfsync everysec\naof-use-rdb-preamble yes\nauto-aof-rewrite-percentage 100\nauto-aof-rewrite-min-size 64mb\n\n# \u{1F527} \u8FD0\u7EF4\u6700\u4F73\u5B9E\u8DF5\n# 1. \u5B9A\u671F\u5907\u4EFDRDB\u6587\u4EF6\u5230\u8FDC\u7A0B\u5B58\u50A8\n# 2. \u76D1\u63A7AOF\u6587\u4EF6\u5927\u5C0F\uFF0C\u53CA\u65F6\u89E6\u53D1\u91CD\u5199\n# 3. \u6D4B\u8BD5\u6062\u590D\u6D41\u7A0B\uFF0C\u786E\u4FDD\u5907\u4EFD\u53EF\u7528\n# 4. \u6839\u636E\u4E1A\u52A1\u7279\u70B9\u9009\u62E9\u5408\u9002\u7684\u6301\u4E45\u5316\u7B56\u7565\n# 5. \u5728\u4ECE\u8282\u70B9\u5173\u95ED\u6301\u4E45\u5316\uFF0C\u51CF\u5C11\u4E3B\u8282\u70B9\u538B\u529B\n\n# \u{1F4C8} \u6027\u80FD\u4F18\u5316\u5EFA\u8BAE\n# 1. \u5C06RDB\u548CAOF\u6587\u4EF6\u653E\u5728\u4E0D\u540C\u78C1\u76D8\u4E0A\n# 2. \u4F7F\u7528SSD\u5B58\u50A8\u63D0\u9AD8I/O\u6027\u80FD\n# 3. \u5408\u7406\u8BBE\u7F6EAOF\u91CD\u5199\u9608\u503C\n# 4. \u5728\u4E1A\u52A1\u4F4E\u5CF0\u671F\u6267\u884CBGSAVE\u548CBGREWRITEAOF\n# 5. \u76D1\u63A7fork\u64CD\u4F5C\u7684\u8017\u65F6\uFF0C\u907F\u514D\u963B\u585E\u4E3B\u8FDB\u7A0B\n"})})})]}),"\n",(0,i.jsx)(n.h2,{id:"4-redis\u9AD8\u53EF\u7528\u67B6\u6784\u8BBE\u8BA1",children:"4. Redis\u9AD8\u53EF\u7528\u67B6\u6784\u8BBE\u8BA1"}),"\n",(0,i.jsx)(n.p,{children:"Redis\u9AD8\u53EF\u7528\u67B6\u6784\u662F\u4FDD\u8BC1\u670D\u52A1\u7A33\u5B9A\u8FD0\u884C\u7684\u5173\u952E\uFF0C\u5305\u62EC\u4E3B\u4ECE\u590D\u5236\u3001\u54E8\u5175\u6A21\u5F0F\u548C\u96C6\u7FA4\u6A21\u5F0F\u4E09\u79CD\u4E3B\u8981\u65B9\u6848\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"41-\u4E3B\u4ECE\u590D\u5236---\u8BFB\u5199\u5206\u79BB\u57FA\u7840",children:"4.1 \u4E3B\u4ECE\u590D\u5236 - \u8BFB\u5199\u5206\u79BB\u57FA\u7840"}),"\n",(0,i.jsx)(n.p,{children:"\u4E3B\u4ECE\u590D\u5236\u662FRedis\u9AD8\u53EF\u7528\u7684\u57FA\u7840\uFF0C\u901A\u8FC7\u6570\u636E\u540C\u6B65\u5B9E\u73B0\u8BFB\u5199\u5206\u79BB\u548C\u6570\u636E\u5907\u4EFD\u3002"}),"\n",(0,i.jsx)(n.mermaid,{value:"graph TB\n    M[Master\u4E3B\u8282\u70B9] --\x3e S1[Slave\u4ECE\u8282\u70B91]\n    M --\x3e S2[Slave\u4ECE\u8282\u70B92]  \n    M --\x3e S3[Slave\u4ECE\u8282\u70B93]\n    \n    C1[\u5199\u5BA2\u6237\u7AEF] --\x3e M\n    C2[\u8BFB\u5BA2\u6237\u7AEF1] --\x3e S1\n    C3[\u8BFB\u5BA2\u6237\u7AEF2] --\x3e S2\n    C4[\u8BFB\u5BA2\u6237\u7AEF3] --\x3e S3\n    \n    M -.->|\u5168\u91CF\u540C\u6B65| S1\n    M -.->|\u589E\u91CF\u540C\u6B65| S2\n    M -.->|\u547D\u4EE4\u4F20\u64AD| S3"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"config",label:"\u4E3B\u4ECE\u914D\u7F6E",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u4E3B\u4ECE\u590D\u5236\u914D\u7F6E"',children:"# \u4E3B\u8282\u70B9\u914D\u7F6E (redis-master.conf)\nbind 0.0.0.0\nport 6379\ndaemonize yes\npidfile /var/run/redis_6379.pid\nlogfile /var/log/redis_6379.log\ndir /var/lib/redis\n\n# \u5B89\u5168\u914D\u7F6E\nrequirepass master_password\nmasterauth master_password\n\n# \u4ECE\u8282\u70B9\u914D\u7F6E (redis-slave.conf)  \nbind 0.0.0.0\nport 6380\ndaemonize yes\npidfile /var/run/redis_6380.pid\nlogfile /var/log/redis_6380.log\ndir /var/lib/redis\n\n# \u4E3B\u4ECE\u5173\u7CFB\u914D\u7F6E\nreplicaof 192.168.1.100 6379        # \u6307\u5B9A\u4E3B\u8282\u70B9\nmasterauth master_password           # \u4E3B\u8282\u70B9\u5BC6\u7801\nreplica-read-only yes                # \u4ECE\u8282\u70B9\u53EA\u8BFB\nreplica-serve-stale-data yes         # \u8FDE\u63A5\u65AD\u5F00\u65F6\u7EE7\u7EED\u670D\u52A1\n\n# \u52A8\u6001\u914D\u7F6E\u4E3B\u4ECE\u5173\u7CFB\nREPLICAOF 192.168.1.100 6379        # \u8BBE\u7F6E\u4E3A\u4ECE\u8282\u70B9\nREPLICAOF NO ONE                     # \u53D6\u6D88\u4ECE\u8282\u70B9\u8EAB\u4EFD\uFF0C\u5347\u7EA7\u4E3A\u4E3B\u8282\u70B9\n"})})}),(0,i.jsx)(a.A,{value:"sync-process",label:"\u540C\u6B65\u8FC7\u7A0B",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u4E3B\u4ECE\u540C\u6B65\u8BE6\u7EC6\u8FC7\u7A0B"',children:"# 1\uFE0F\u20E3 \u5EFA\u7ACB\u8FDE\u63A5\u9636\u6BB5\n# \u4ECE\u8282\u70B9 -> \u4E3B\u8282\u70B9: PING\n# \u4E3B\u8282\u70B9 -> \u4ECE\u8282\u70B9: PONG\n# \u4ECE\u8282\u70B9 -> \u4E3B\u8282\u70B9: AUTH <password>\n# \u4E3B\u8282\u70B9 -> \u4ECE\u8282\u70B9: OK\n\n# 2\uFE0F\u20E3 \u6570\u636E\u540C\u6B65\u9636\u6BB5\n# \u4ECE\u8282\u70B9 -> \u4E3B\u8282\u70B9: PSYNC <runid> <offset>\n# \n# \u60C5\u51B5A\uFF1A\u5168\u91CF\u540C\u6B65\n# \u4E3B\u8282\u70B9 -> \u4ECE\u8282\u70B9: FULLRESYNC <runid> <offset>\n# \u4E3B\u8282\u70B9\u6267\u884CBGSAVE\u751F\u6210RDB\u6587\u4EF6\n# \u4E3B\u8282\u70B9\u53D1\u9001RDB\u6587\u4EF6\u7ED9\u4ECE\u8282\u70B9\n# \u4ECE\u8282\u70B9\u6E05\u7A7A\u6570\u636E\u5E93\u5E76\u52A0\u8F7DRDB\u6587\u4EF6\n# \u4E3B\u8282\u70B9\u53D1\u9001\u540C\u6B65\u671F\u95F4\u7684\u5199\u547D\u4EE4\u7F13\u51B2\u533A\n#\n# \u60C5\u51B5B\uFF1A\u90E8\u5206\u540C\u6B65  \n# \u4E3B\u8282\u70B9 -> \u4ECE\u8282\u70B9: CONTINUE\n# \u4E3B\u8282\u70B9\u53D1\u9001\u590D\u5236\u79EF\u538B\u7F13\u51B2\u533A\u4E2D\u7684\u6570\u636E\n\n# 3\uFE0F\u20E3 \u547D\u4EE4\u4F20\u64AD\u9636\u6BB5\n# \u4E3B\u8282\u70B9\u63A5\u6536\u5199\u547D\u4EE4\u540E\uFF1A\n# 1. \u6267\u884C\u547D\u4EE4\n# 2. \u53D1\u9001\u547D\u4EE4\u7ED9\u6240\u6709\u4ECE\u8282\u70B9\n# 3. \u4ECE\u8282\u70B9\u6267\u884C\u547D\u4EE4\u4FDD\u6301\u6570\u636E\u4E00\u81F4\n\n# \u590D\u5236\u76F8\u5173\u547D\u4EE4\nINFO replication                     # \u67E5\u770B\u590D\u5236\u4FE1\u606F\nROLE                                # \u67E5\u770B\u8282\u70B9\u89D2\u8272\nREPLICAOF NO ONE                    # \u505C\u6B62\u590D\u5236\n"})})}),(0,i.jsx)(a.A,{value:"optimization",label:"\u590D\u5236\u4F18\u5316",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u4E3B\u4ECE\u590D\u5236\u4F18\u5316\u914D\u7F6E"',children:"# \u590D\u5236\u6027\u80FD\u4F18\u5316\nrepl-diskless-sync no               # \u662F\u5426\u542F\u7528\u65E0\u76D8\u590D\u5236\nrepl-diskless-sync-delay 5          # \u65E0\u76D8\u590D\u5236\u5EF6\u8FDF\u65F6\u95F4\nrepl-ping-replica-period 10         # \u4ECE\u8282\u70B9ping\u4E3B\u8282\u70B9\u95F4\u9694\nrepl-timeout 60                     # \u590D\u5236\u8D85\u65F6\u65F6\u95F4\n\n# \u590D\u5236\u79EF\u538B\u7F13\u51B2\u533A\u914D\u7F6E\nrepl-backlog-size 1mb               # \u79EF\u538B\u7F13\u51B2\u533A\u5927\u5C0F\nrepl-backlog-ttl 3600               # \u7F13\u51B2\u533A\u4FDD\u7559\u65F6\u95F4\n\n# \u4ECE\u8282\u70B9\u914D\u7F6E\u4F18\u5316\nreplica-priority 100                # \u4ECE\u8282\u70B9\u4F18\u5148\u7EA7\uFF08\u54E8\u5175\u9009\u4E3B\u65F6\u4F7F\u7528\uFF09\nreplica-announce-ip 192.168.1.101  # \u4ECE\u8282\u70B9\u516C\u544AIP\nreplica-announce-port 6380          # \u4ECE\u8282\u70B9\u516C\u544A\u7AEF\u53E3\n\n# \u6700\u5C0F\u4ECE\u8282\u70B9\u914D\u7F6E\uFF08\u9632\u6B62\u6570\u636E\u4E22\u5931\uFF09\nmin-replicas-to-write 1             # \u81F3\u5C111\u4E2A\u4ECE\u8282\u70B9\u624D\u5141\u8BB8\u5199\u5165\nmin-replicas-max-lag 10             # \u4ECE\u8282\u70B9\u6700\u5927\u5EF6\u8FDF10\u79D2\n\n# \u76D1\u63A7\u590D\u5236\u72B6\u6001\n# \u4E3B\u8282\u70B9\u76D1\u63A7\nredis-cli -p 6379 INFO replication\n# connected_slaves:2\n# slave0:ip=192.168.1.101,port=6380,state=online,offset=1234,lag=0\n# slave1:ip=192.168.1.102,port=6380,state=online,offset=1234,lag=1\n\n# \u4ECE\u8282\u70B9\u76D1\u63A7  \nredis-cli -p 6380 INFO replication\n# role:slave\n# master_host:192.168.1.100\n# master_port:6379\n# master_link_status:up\n# master_last_io_seconds_ago:0\n"})})})]}),"\n",(0,i.jsx)(n.h3,{id:"42-\u54E8\u5175\u6A21\u5F0F---\u81EA\u52A8\u6545\u969C\u8F6C\u79FB",children:"4.2 \u54E8\u5175\u6A21\u5F0F - \u81EA\u52A8\u6545\u969C\u8F6C\u79FB"}),"\n",(0,i.jsx)(n.p,{children:"Redis Sentinel\u662FRedis\u7684\u9AD8\u53EF\u7528\u89E3\u51B3\u65B9\u6848\uFF0C\u63D0\u4F9B\u76D1\u63A7\u3001\u901A\u77E5\u3001\u81EA\u52A8\u6545\u969C\u8F6C\u79FB\u548C\u914D\u7F6E\u63D0\u4F9B\u8005\u529F\u80FD\u3002"}),"\n",(0,i.jsx)(n.mermaid,{value:'graph TB\n    subgraph "\u54E8\u5175\u96C6\u7FA4"\n        S1[Sentinel 1<br/>26379]\n        S2[Sentinel 2<br/>26380] \n        S3[Sentinel 3<br/>26381]\n    end\n    \n    subgraph "Redis\u96C6\u7FA4"\n        M[Master<br/>6379]\n        R1[Replica 1<br/>6380]\n        R2[Replica 2<br/>6381]\n    end\n    \n    S1 -.->|\u76D1\u63A7| M\n    S1 -.->|\u76D1\u63A7| R1\n    S1 -.->|\u76D1\u63A7| R2\n    \n    S2 -.->|\u76D1\u63A7| M\n    S2 -.->|\u76D1\u63A7| R1\n    S2 -.->|\u76D1\u63A7| R2\n    \n    S3 -.->|\u76D1\u63A7| M\n    S3 -.->|\u76D1\u63A7| R1\n    S3 -.->|\u76D1\u63A7| R2\n    \n    M --\x3e R1\n    M --\x3e R2'}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"config",label:"\u54E8\u5175\u914D\u7F6E",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u54E8\u5175\u914D\u7F6E\u8BE6\u89E3"',children:"# sentinel.conf \u914D\u7F6E\u6587\u4EF6\nport 26379                                    # \u54E8\u5175\u7AEF\u53E3\ndaemonize yes                                # \u540E\u53F0\u8FD0\u884C\npidfile /var/run/redis-sentinel.pid         # PID\u6587\u4EF6\nlogfile /var/log/redis-sentinel.log         # \u65E5\u5FD7\u6587\u4EF6\ndir /var/lib/redis                          # \u5DE5\u4F5C\u76EE\u5F55\n\n# \u76D1\u63A7\u4E3B\u8282\u70B9\u914D\u7F6E\nsentinel monitor mymaster 192.168.1.100 6379 2\n# mymaster: \u4E3B\u8282\u70B9\u540D\u79F0\n# 192.168.1.100 6379: \u4E3B\u8282\u70B9\u5730\u5740\u548C\u7AEF\u53E3  \n# 2: \u5224\u65AD\u4E3B\u8282\u70B9\u4E0B\u7EBF\u9700\u8981\u7684\u54E8\u5175\u6570\u91CF\uFF08quorum\uFF09\n\n# \u8BA4\u8BC1\u914D\u7F6E\nsentinel auth-pass mymaster master_password\n\n# \u6545\u969C\u8F6C\u79FB\u914D\u7F6E\nsentinel down-after-milliseconds mymaster 5000    # 5\u79D2\u65E0\u54CD\u5E94\u5224\u5B9A\u4E0B\u7EBF\nsentinel failover-timeout mymaster 15000          # \u6545\u969C\u8F6C\u79FB\u8D85\u65F6\u65F6\u95F4\nsentinel parallel-syncs mymaster 1                # \u540C\u65F6\u540C\u6B65\u7684\u4ECE\u8282\u70B9\u6570\u91CF\n\n# \u901A\u77E5\u811A\u672C\u914D\u7F6E\nsentinel notification-script mymaster /opt/scripts/notify.sh\nsentinel client-reconfig-script mymaster /opt/scripts/reconfig.sh\n\n# \u542F\u52A8\u54E8\u5175\nredis-sentinel /etc/redis/sentinel.conf\n# \u6216\u8005\nredis-server /etc/redis/sentinel.conf --sentinel\n"})})}),(0,i.jsx)(a.A,{value:"failover",label:"\u6545\u969C\u8F6C\u79FB\u6D41\u7A0B",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u54E8\u5175\u6545\u969C\u8F6C\u79FB\u8BE6\u7EC6\u6D41\u7A0B"',children:"# 1\uFE0F\u20E3 \u4E3B\u89C2\u4E0B\u7EBF\uFF08Subjectively Down\uFF09\n# \u5355\u4E2A\u54E8\u5175\u68C0\u6D4B\u5230\u4E3B\u8282\u70B9\u65E0\u54CD\u5E94\u8D85\u8FC7down-after-milliseconds\n# \u6807\u8BB0\u4E3B\u8282\u70B9\u4E3A\u4E3B\u89C2\u4E0B\u7EBF\u72B6\u6001\uFF08SDOWN\uFF09\n\n# 2\uFE0F\u20E3 \u5BA2\u89C2\u4E0B\u7EBF\uFF08Objectively Down\uFF09  \n# \u54E8\u5175\u8BE2\u95EE\u5176\u4ED6\u54E8\u5175\u5BF9\u4E3B\u8282\u70B9\u7684\u72B6\u6001\u5224\u65AD\n# \u5F53\u8D85\u8FC7quorum\u6570\u91CF\u7684\u54E8\u5175\u8BA4\u4E3A\u4E3B\u8282\u70B9\u4E0B\u7EBF\u65F6\n# \u6807\u8BB0\u4E3B\u8282\u70B9\u4E3A\u5BA2\u89C2\u4E0B\u7EBF\u72B6\u6001\uFF08ODOWN\uFF09\n\n# 3\uFE0F\u20E3 \u9009\u4E3E\u9886\u5BFC\u8005\u54E8\u5175\n# \u54E8\u5175\u4E4B\u95F4\u8FDB\u884CRaft\u7B97\u6CD5\u9009\u4E3E\n# \u9009\u51FA\u8D1F\u8D23\u6545\u969C\u8F6C\u79FB\u7684\u9886\u5BFC\u8005\u54E8\u5175\n# \u9700\u8981\u83B7\u5F97\u8D85\u8FC7\u534A\u6570\u54E8\u5175\u7684\u6295\u7968\n\n# 4\uFE0F\u20E3 \u9009\u62E9\u65B0\u7684\u4E3B\u8282\u70B9\n# \u9886\u5BFC\u8005\u54E8\u5175\u4ECE\u4ECE\u8282\u70B9\u4E2D\u9009\u62E9\u65B0\u4E3B\u8282\u70B9\n# \u9009\u62E9\u89C4\u5219\uFF08\u6309\u4F18\u5148\u7EA7\uFF09\uFF1A\n# a) replica-priority\u6700\u5C0F\u7684\u4ECE\u8282\u70B9\n# b) \u590D\u5236\u504F\u79FB\u91CF\u6700\u5927\u7684\u4ECE\u8282\u70B9\uFF08\u6570\u636E\u6700\u65B0\uFF09\n# c) run_id\u6700\u5C0F\u7684\u4ECE\u8282\u70B9\n\n# 5\uFE0F\u20E3 \u6267\u884C\u6545\u969C\u8F6C\u79FB\n# \u5411\u9009\u4E2D\u7684\u4ECE\u8282\u70B9\u53D1\u9001REPLICAOF NO ONE\u547D\u4EE4\n# \u5411\u5176\u4ED6\u4ECE\u8282\u70B9\u53D1\u9001REPLICAOF <new_master_ip> <new_master_port>\n# \u66F4\u65B0\u54E8\u5175\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u4E3B\u8282\u70B9\u4FE1\u606F\n# \u901A\u8FC7\u53D1\u5E03\u8BA2\u9605\u901A\u77E5\u5BA2\u6237\u7AEF\u4E3B\u8282\u70B9\u53D8\u66F4\n\n# \u6545\u969C\u8F6C\u79FB\u76F8\u5173\u547D\u4EE4\nSENTINEL masters                              # \u67E5\u770B\u6240\u6709\u88AB\u76D1\u63A7\u7684\u4E3B\u8282\u70B9\nSENTINEL slaves mymaster                      # \u67E5\u770B\u6307\u5B9A\u4E3B\u8282\u70B9\u7684\u4ECE\u8282\u70B9\nSENTINEL sentinels mymaster                   # \u67E5\u770B\u76D1\u63A7\u6307\u5B9A\u4E3B\u8282\u70B9\u7684\u54E8\u5175\nSENTINEL get-master-addr-by-name mymaster     # \u83B7\u53D6\u4E3B\u8282\u70B9\u5730\u5740\nSENTINEL failover mymaster                    # \u624B\u52A8\u89E6\u53D1\u6545\u969C\u8F6C\u79FB\nSENTINEL reset mymaster                       # \u91CD\u7F6E\u6307\u5B9A\u4E3B\u8282\u70B9\u7684\u72B6\u6001\n"})})}),(0,i.jsx)(a.A,{value:"client",label:"\u5BA2\u6237\u7AEF\u8FDE\u63A5",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="Java\u5BA2\u6237\u7AEF\u54E8\u5175\u8FDE\u63A5"',children:'@Configuration\npublic class RedisConfig {\n    \n    @Bean\n    public LettuceConnectionFactory redisConnectionFactory() {\n        // \u54E8\u5175\u914D\u7F6E\n        RedisSentinelConfiguration sentinelConfig = \n            new RedisSentinelConfiguration()\n                .master("mymaster")  // \u4E3B\u8282\u70B9\u540D\u79F0\n                .sentinel("192.168.1.100", 26379)  // \u54E8\u51751\n                .sentinel("192.168.1.101", 26379)  // \u54E8\u51752  \n                .sentinel("192.168.1.102", 26379); // \u54E8\u51753\n        \n        // \u8BBE\u7F6E\u5BC6\u7801\n        sentinelConfig.setPassword("master_password");\n        \n        // \u8FDE\u63A5\u6C60\u914D\u7F6E\n        GenericObjectPoolConfig poolConfig = new GenericObjectPoolConfig();\n        poolConfig.setMaxTotal(50);\n        poolConfig.setMaxIdle(10);\n        poolConfig.setMinIdle(5);\n        poolConfig.setMaxWaitMillis(3000);\n        \n        LettucePoolingClientConfiguration clientConfig = \n            LettucePoolingClientConfiguration.builder()\n                .poolConfig(poolConfig)\n                .build();\n        \n        return new LettuceConnectionFactory(sentinelConfig, clientConfig);\n    }\n    \n    @Bean\n    public RedisTemplate<String, Object> redisTemplate(\n            LettuceConnectionFactory connectionFactory) {\n        RedisTemplate<String, Object> template = new RedisTemplate<>();\n        template.setConnectionFactory(connectionFactory);\n        \n        // \u5E8F\u5217\u5316\u914D\u7F6E\n        template.setKeySerializer(new StringRedisSerializer());\n        template.setValueSerializer(new GenericJackson2JsonRedisSerializer());\n        template.setHashKeySerializer(new StringRedisSerializer());\n        template.setHashValueSerializer(new GenericJackson2JsonRedisSerializer());\n        \n        return template;\n    }\n}\n\n// \u5BA2\u6237\u7AEF\u6545\u969C\u8F6C\u79FB\u5904\u7406\n@Component\npublic class RedisFailoverHandler implements MessageListener {\n    \n    private static final Logger logger = LoggerFactory.getLogger(RedisFailoverHandler.class);\n    \n    @Override\n    public void onMessage(Message message, byte[] pattern) {\n        String channel = new String(message.getChannel());\n        String msg = new String(message.getBody());\n        \n        if ("+switch-master".equals(channel)) {\n            logger.info("\u4E3B\u8282\u70B9\u5207\u6362\u901A\u77E5: {}", msg);\n            // \u5904\u7406\u4E3B\u8282\u70B9\u5207\u6362\u903B\u8F91\n            handleMasterSwitch(msg);\n        }\n    }\n    \n    private void handleMasterSwitch(String message) {\n        // \u89E3\u6790\u5207\u6362\u4FE1\u606F\uFF1Amymaster 192.168.1.100 6379 192.168.1.101 6380\n        String[] parts = message.split(" ");\n        String masterName = parts[0];\n        String oldMasterHost = parts[1];\n        int oldMasterPort = Integer.parseInt(parts[2]);\n        String newMasterHost = parts[3];\n        int newMasterPort = Integer.parseInt(parts[4]);\n        \n        logger.info("\u4E3B\u8282\u70B9\u4ECE {}:{} \u5207\u6362\u5230 {}:{}", \n            oldMasterHost, oldMasterPort, newMasterHost, newMasterPort);\n        \n        // \u66F4\u65B0\u5E94\u7528\u7A0B\u5E8F\u914D\u7F6E\u6216\u91CD\u65B0\u521D\u59CB\u5316\u8FDE\u63A5\u6C60\n        // \u5927\u591A\u6570Redis\u5BA2\u6237\u7AEF\u4F1A\u81EA\u52A8\u5904\u7406\u8FD9\u79CD\u5207\u6362\n    }\n}\n'})})}),(0,i.jsx)(a.A,{value:"monitoring",label:"\u76D1\u63A7\u8FD0\u7EF4",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u54E8\u5175\u76D1\u63A7\u4E0E\u8FD0\u7EF4"',children:"# \u54E8\u5175\u72B6\u6001\u76D1\u63A7\nredis-cli -p 26379 SENTINEL masters\n# name=mymaster,status=ok,address=192.168.1.100:6379,slaves=2,sentinels=3\n\nredis-cli -p 26379 SENTINEL slaves mymaster\n# \u663E\u793A\u6240\u6709\u4ECE\u8282\u70B9\u4FE1\u606F\n\nredis-cli -p 26379 SENTINEL sentinels mymaster  \n# \u663E\u793A\u6240\u6709\u54E8\u5175\u4FE1\u606F\n\n# \u54E8\u5175\u65E5\u5FD7\u5206\u6790\ntail -f /var/log/redis-sentinel.log\n# +monitor master mymaster 192.168.1.100 6379 quorum 2\n# +slave slave 192.168.1.101:6380 192.168.1.101 6380 @ mymaster 192.168.1.100 6379\n# +sdown master mymaster 192.168.1.100 6379\n# +odown master mymaster 192.168.1.100 6379 #quorum 2/2\n# +new-epoch 1\n# +try-failover master mymaster 192.168.1.100 6379\n# +vote-for-leader 192.168.1.100:26379 1\n# +elected-leader master mymaster 192.168.1.100 6379\n# +failover-state-select-slave master mymaster 192.168.1.100 6379\n# +selected-slave slave 192.168.1.101:6380 192.168.1.101 6380 @ mymaster 192.168.1.100 6379\n# +failover-state-send-slaveof-noone slave 192.168.1.101:6380 192.168.1.101 6380 @ mymaster 192.168.1.100 6379\n# +failover-state-wait-promotion slave 192.168.1.101:6380 192.168.1.101 6380 @ mymaster 192.168.1.100 6379\n# +promoted-slave slave 192.168.1.101:6380 192.168.1.101 6380 @ mymaster 192.168.1.100 6379\n# +failover-state-reconf-slaves master mymaster 192.168.1.100 6379\n# +slave-reconf-sent slave 192.168.1.102:6380 192.168.1.102 6380 @ mymaster 192.168.1.100 6379\n# +slave-reconf-inprog slave 192.168.1.102:6380 192.168.1.102 6380 @ mymaster 192.168.1.100 6379\n# +slave-reconf-done slave 192.168.1.102:6380 192.168.1.102 6380 @ mymaster 192.168.1.100 6379\n# +failover-end master mymaster 192.168.1.100 6379\n# +switch-master mymaster 192.168.1.100 6379 192.168.1.101 6380\n\n# \u6027\u80FD\u76D1\u63A7\u6307\u6807\n# 1. \u54E8\u5175\u54CD\u5E94\u65F6\u95F4\n# 2. \u6545\u969C\u8F6C\u79FB\u65F6\u95F4\n# 3. \u4E3B\u4ECE\u5EF6\u8FDF\n# 4. \u54E8\u5175\u4E4B\u95F4\u7684\u7F51\u7EDC\u5EF6\u8FDF\n# 5. \u8BEF\u5224\u7387\uFF08\u9891\u7E41\u6545\u969C\u8F6C\u79FB\uFF09\n\n# \u8FD0\u7EF4\u6700\u4F73\u5B9E\u8DF5\n# 1. \u90E8\u7F72\u5947\u6570\u4E2A\u54E8\u5175\u8282\u70B9\uFF08\u81F3\u5C113\u4E2A\uFF09\n# 2. \u54E8\u5175\u90E8\u7F72\u5728\u4E0D\u540C\u7684\u7269\u7406\u673A\u5668\u4E0A\n# 3. \u5408\u7406\u8BBE\u7F6Edown-after-milliseconds\uFF08\u907F\u514D\u7F51\u7EDC\u6296\u52A8\u8BEF\u5224\uFF09\n# 4. \u76D1\u63A7\u54E8\u5175\u65E5\u5FD7\uFF0C\u53CA\u65F6\u53D1\u73B0\u95EE\u9898\n# 5. \u5B9A\u671F\u6D4B\u8BD5\u6545\u969C\u8F6C\u79FB\u6D41\u7A0B\n# 6. \u5BA2\u6237\u7AEF\u8981\u652F\u6301\u54E8\u5175\u6A21\u5F0F\u7684\u81EA\u52A8\u5207\u6362\n"})})})]}),"\n",(0,i.jsx)(n.h3,{id:"43-\u96C6\u7FA4\u6A21\u5F0F---\u6C34\u5E73\u6269\u5C55\u65B9\u6848",children:"4.3 \u96C6\u7FA4\u6A21\u5F0F - \u6C34\u5E73\u6269\u5C55\u65B9\u6848"}),"\n",(0,i.jsx)(n.p,{children:"Redis Cluster\u662FRedis\u7684\u5206\u5E03\u5F0F\u89E3\u51B3\u65B9\u6848\uFF0C\u652F\u6301\u6570\u636E\u5206\u7247\u3001\u81EA\u52A8\u6545\u969C\u8F6C\u79FB\u548C\u6C34\u5E73\u6269\u5C55\u3002"}),"\n",(0,i.jsx)(n.mermaid,{value:'graph TB\n    subgraph "Redis\u96C6\u7FA4"\n        subgraph "\u8282\u70B91"\n            M1[Master 1<br/>7000<br/>Slots: 0-5460]\n            S1[Slave 1<br/>7003]\n        end\n        \n        subgraph "\u8282\u70B92"  \n            M2[Master 2<br/>7001<br/>Slots: 5461-10922]\n            S2[Slave 2<br/>7004]\n        end\n        \n        subgraph "\u8282\u70B93"\n            M3[Master 3<br/>7002<br/>Slots: 10923-16383]\n            S3[Slave 3<br/>7005]\n        end\n    end\n    \n    M1 --\x3e S1\n    M2 --\x3e S2  \n    M3 --\x3e S3\n    \n    M1 -.->|Gossip\u534F\u8BAE| M2\n    M2 -.->|Gossip\u534F\u8BAE| M3\n    M3 -.->|Gossip\u534F\u8BAE| M1\n    \n    C[Client] --\x3e M1\n    C --\x3e M2\n    C --\x3e M3'}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"setup",label:"\u96C6\u7FA4\u642D\u5EFA",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Redis\u96C6\u7FA4\u642D\u5EFA"',children:'# 1. \u8282\u70B9\u914D\u7F6E\u6587\u4EF6 (redis-7000.conf)\nport 7000\ncluster-enabled yes                    # \u542F\u7528\u96C6\u7FA4\u6A21\u5F0F\ncluster-config-file nodes-7000.conf   # \u96C6\u7FA4\u914D\u7F6E\u6587\u4EF6\ncluster-node-timeout 5000             # \u8282\u70B9\u8D85\u65F6\u65F6\u95F4\ncluster-announce-ip 192.168.1.100     # \u8282\u70B9\u516C\u544AIP\ncluster-announce-port 7000             # \u8282\u70B9\u516C\u544A\u7AEF\u53E3\ncluster-announce-bus-port 17000        # \u96C6\u7FA4\u603B\u7EBF\u7AEF\u53E3\n\n# \u6301\u4E45\u5316\u914D\u7F6E\nappendonly yes\nappendfilename "appendonly-7000.aof"\n\n# \u5176\u4ED6\u914D\u7F6E\ndaemonize yes\npidfile /var/run/redis_7000.pid\nlogfile /var/log/redis_7000.log\ndir /var/lib/redis/7000\n\n# 2. \u542F\u52A8\u6240\u6709\u8282\u70B9\nredis-server /etc/redis/redis-7000.conf\nredis-server /etc/redis/redis-7001.conf  \nredis-server /etc/redis/redis-7002.conf\nredis-server /etc/redis/redis-7003.conf\nredis-server /etc/redis/redis-7004.conf\nredis-server /etc/redis/redis-7005.conf\n\n# 3. \u521B\u5EFA\u96C6\u7FA4\nredis-cli --cluster create \\\n  192.168.1.100:7000 192.168.1.100:7001 192.168.1.100:7002 \\\n  192.168.1.100:7003 192.168.1.100:7004 192.168.1.100:7005 \\\n  --cluster-replicas 1\n\n# 4. \u9A8C\u8BC1\u96C6\u7FA4\u72B6\u6001\nredis-cli -c -p 7000 cluster nodes\nredis-cli -c -p 7000 cluster info\n'})})}),(0,i.jsx)(a.A,{value:"slots",label:"\u69FD\u4F4D\u5206\u914D",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Redis\u96C6\u7FA4\u69FD\u4F4D\u673A\u5236"',children:'# Redis\u96C6\u7FA4\u69FD\u4F4D\u6982\u5FF5\n# - \u96C6\u7FA4\u5171\u670916384\u4E2A\u69FD\u4F4D\uFF080-16383\uFF09\n# - \u6BCF\u4E2A\u4E3B\u8282\u70B9\u8D1F\u8D23\u4E00\u90E8\u5206\u69FD\u4F4D\n# - \u901A\u8FC7CRC16\u7B97\u6CD5\u8BA1\u7B97key\u6240\u5C5E\u69FD\u4F4D\uFF1AHASH_SLOT = CRC16(key) mod 16384\n\n# \u69FD\u4F4D\u5206\u914D\u793A\u4F8B\n# \u8282\u70B91\uFF1A0-5460     (5461\u4E2A\u69FD\u4F4D)\n# \u8282\u70B92\uFF1A5461-10922 (5462\u4E2A\u69FD\u4F4D)  \n# \u8282\u70B93\uFF1A10923-16383(5461\u4E2A\u69FD\u4F4D)\n\n# \u67E5\u770B\u69FD\u4F4D\u5206\u914D\nredis-cli -p 7000 cluster slots\n# 0-5460 192.168.1.100:7000 192.168.1.100:7003\n# 5461-10922 192.168.1.100:7001 192.168.1.100:7004\n# 10923-16383 192.168.1.100:7002 192.168.1.100:7005\n\n# \u8BA1\u7B97key\u7684\u69FD\u4F4D\nredis-cli -p 7000 cluster keyslot "user:1001"\n# (integer) 9189\n\n# \u67E5\u770B\u69FD\u4F4D\u4E2D\u7684key\u6570\u91CF\nredis-cli -p 7000 cluster countkeysinslot 9189\n# (integer) 1\n\n# \u83B7\u53D6\u69FD\u4F4D\u4E2D\u7684key\nredis-cli -p 7000 cluster getkeysinslot 9189 10\n# 1) "user:1001"\n\n# Hash Tag\u673A\u5236 - \u786E\u4FDD\u76F8\u5173key\u5728\u540C\u4E00\u69FD\u4F4D\nSET user:{1001}:profile "John Doe"\nSET user:{1001}:settings "theme:dark"\nSET user:{1001}:preferences "lang:en"\n# \u8FD9\u4E9Bkey\u90FD\u4F1A\u88AB\u5206\u914D\u5230\u540C\u4E00\u4E2A\u69FD\u4F4D\uFF0C\u56E0\u4E3A\u90FD\u5305\u542B{1001}\n\n# \u69FD\u4F4D\u8FC1\u79FB\uFF08\u5728\u7EBF\u6269\u5BB9/\u7F29\u5BB9\u65F6\u4F7F\u7528\uFF09\nredis-cli --cluster reshard 192.168.1.100:7000\n# \u4EA4\u4E92\u5F0F\u8FC1\u79FB\u69FD\u4F4D\u5230\u65B0\u8282\u70B9\n'})})}),(0,i.jsx)(a.A,{value:"operations",label:"\u96C6\u7FA4\u64CD\u4F5C",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Redis\u96C6\u7FA4\u5E38\u7528\u64CD\u4F5C"',children:'# \u96C6\u7FA4\u4FE1\u606F\u67E5\u770B\nredis-cli -c -p 7000 cluster info\n# cluster_state:ok\n# cluster_slots_assigned:16384\n# cluster_slots_ok:16384\n# cluster_slots_pfail:0\n# cluster_slots_fail:0\n# cluster_known_nodes:6\n# cluster_size:3\n\nredis-cli -c -p 7000 cluster nodes\n# \u663E\u793A\u6240\u6709\u8282\u70B9\u4FE1\u606F\uFF0C\u5305\u62ECID\u3001\u89D2\u8272\u3001\u72B6\u6001\u3001\u69FD\u4F4D\u7B49\n\n# \u6570\u636E\u64CD\u4F5C\uFF08\u5BA2\u6237\u7AEF\u91CD\u5B9A\u5411\uFF09\nredis-cli -c -p 7000\n127.0.0.1:7000> SET user:1001 "John"\n-> Redirected to slot [9189] located at 192.168.1.100:7001\nOK\n192.168.1.100:7001> GET user:1001\n"John"\n\n# \u6279\u91CF\u64CD\u4F5C\u9650\u5236\n# \u4E0D\u652F\u6301\u8DE8\u69FD\u4F4D\u7684\u591Akey\u64CD\u4F5C\nMSET user:1001 "John" user:1002 "Jane"  # \u53EF\u80FD\u5931\u8D25\n# (error) CROSSSLOT Keys in request don\'t hash to the same slot\n\n# \u4F7F\u7528Hash Tag\u89E3\u51B3\nMSET user:{group1}:1001 "John" user:{group1}:1002 "Jane"  # \u6210\u529F\n\n# \u8282\u70B9\u7BA1\u7406\nredis-cli --cluster add-node 192.168.1.100:7006 192.168.1.100:7000\n# \u6DFB\u52A0\u65B0\u8282\u70B9\u5230\u96C6\u7FA4\n\nredis-cli --cluster del-node 192.168.1.100:7000 <node-id>\n# \u4ECE\u96C6\u7FA4\u4E2D\u5220\u9664\u8282\u70B9\n\nredis-cli --cluster rebalance 192.168.1.100:7000\n# \u91CD\u65B0\u5E73\u8861\u69FD\u4F4D\u5206\u914D\n\n# \u6545\u969C\u8F6C\u79FB\nredis-cli -p 7003 cluster failover\n# \u624B\u52A8\u89E6\u53D1\u6545\u969C\u8F6C\u79FB\uFF0C\u5C06\u4ECE\u8282\u70B9\u63D0\u5347\u4E3A\u4E3B\u8282\u70B9\n\nredis-cli -p 7003 cluster failover force\n# \u5F3A\u5236\u6545\u969C\u8F6C\u79FB\uFF08\u5373\u4F7F\u4E3B\u8282\u70B9\u6B63\u5E38\uFF09\n'})})}),(0,i.jsx)(a.A,{value:"client-code",label:"\u5BA2\u6237\u7AEF\u4EE3\u7801",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="Java\u96C6\u7FA4\u5BA2\u6237\u7AEF"',children:'@Configuration\npublic class RedisClusterConfig {\n    \n    @Bean\n    public LettuceConnectionFactory redisConnectionFactory() {\n        // \u96C6\u7FA4\u8282\u70B9\u914D\u7F6E\n        List<RedisNode> nodes = Arrays.asList(\n            new RedisNode("192.168.1.100", 7000),\n            new RedisNode("192.168.1.100", 7001),\n            new RedisNode("192.168.1.100", 7002),\n            new RedisNode("192.168.1.100", 7003),\n            new RedisNode("192.168.1.100", 7004),\n            new RedisNode("192.168.1.100", 7005)\n        );\n        \n        RedisClusterConfiguration clusterConfig = \n            new RedisClusterConfiguration();\n        clusterConfig.setClusterNodes(nodes);\n        clusterConfig.setMaxRedirects(3);  // \u6700\u5927\u91CD\u5B9A\u5411\u6B21\u6570\n        \n        // \u8FDE\u63A5\u6C60\u914D\u7F6E\n        GenericObjectPoolConfig poolConfig = new GenericObjectPoolConfig();\n        poolConfig.setMaxTotal(100);\n        poolConfig.setMaxIdle(20);\n        poolConfig.setMinIdle(10);\n        poolConfig.setMaxWaitMillis(3000);\n        \n        LettucePoolingClientConfiguration clientConfig = \n            LettucePoolingClientConfiguration.builder()\n                .poolConfig(poolConfig)\n                .build();\n        \n        return new LettuceConnectionFactory(clusterConfig, clientConfig);\n    }\n    \n    @Bean\n    public RedisTemplate<String, Object> redisTemplate(\n            LettuceConnectionFactory connectionFactory) {\n        RedisTemplate<String, Object> template = new RedisTemplate<>();\n        template.setConnectionFactory(connectionFactory);\n        \n        // \u5E8F\u5217\u5316\u914D\u7F6E\n        template.setKeySerializer(new StringRedisSerializer());\n        template.setValueSerializer(new GenericJackson2JsonRedisSerializer());\n        template.setHashKeySerializer(new StringRedisSerializer());\n        template.setHashValueSerializer(new GenericJackson2JsonRedisSerializer());\n        \n        return template;\n    }\n}\n\n// \u96C6\u7FA4\u64CD\u4F5C\u670D\u52A1\n@Service\npublic class RedisClusterService {\n    \n    @Autowired\n    private RedisTemplate<String, Object> redisTemplate;\n    \n    /**\n     * \u6279\u91CF\u64CD\u4F5C - \u4F7F\u7528Hash Tag\u786E\u4FDDkey\u5728\u540C\u4E00\u69FD\u4F4D\n     */\n    public void batchOperationWithHashTag(String groupId, Map<String, Object> data) {\n        Map<String, Object> hashTaggedData = new HashMap<>();\n        \n        for (Map.Entry<String, Object> entry : data.entrySet()) {\n            String key = String.format("data:{%s}:%s", groupId, entry.getKey());\n            hashTaggedData.put(key, entry.getValue());\n        }\n        \n        redisTemplate.opsForValue().multiSet(hashTaggedData);\n    }\n    \n    /**\n     * \u5206\u5E03\u5F0F\u8BA1\u6570\u5668 - \u5229\u7528\u96C6\u7FA4\u7684\u5206\u7247\u7279\u6027\n     */\n    public Long distributedIncrement(String counterName, String shardKey) {\n        String key = String.format("counter:%s:{%s}", counterName, shardKey);\n        return redisTemplate.opsForValue().increment(key);\n    }\n    \n    /**\n     * \u96C6\u7FA4\u72B6\u6001\u76D1\u63A7\n     */\n    public Map<String, Object> getClusterInfo() {\n        return redisTemplate.execute((RedisCallback<Map<String, Object>>) connection -> {\n            if (connection instanceof JedisClusterConnection) {\n                JedisClusterConnection clusterConnection = (JedisClusterConnection) connection;\n                // \u83B7\u53D6\u96C6\u7FA4\u4FE1\u606F\u7684\u5177\u4F53\u5B9E\u73B0\n                Map<String, Object> info = new HashMap<>();\n                info.put("cluster_state", "ok");\n                info.put("cluster_size", 3);\n                return info;\n            }\n            return Collections.emptyMap();\n        });\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"44-\u9AD8\u53EF\u7528\u65B9\u6848\u5BF9\u6BD4\u4E0E\u9009\u62E9",children:"4.4 \u9AD8\u53EF\u7528\u65B9\u6848\u5BF9\u6BD4\u4E0E\u9009\u62E9"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u65B9\u6848"}),(0,i.jsx)(n.th,{children:"\u6570\u636E\u4E00\u81F4\u6027"}),(0,i.jsx)(n.th,{children:"\u53EF\u7528\u6027"}),(0,i.jsx)(n.th,{children:"\u6269\u5C55\u6027"}),(0,i.jsx)(n.th,{children:"\u590D\u6742\u5EA6"}),(0,i.jsx)(n.th,{children:"\u9002\u7528\u573A\u666F"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u4E3B\u4ECE\u590D\u5236"})}),(0,i.jsx)(n.td,{children:"\u6700\u7EC8\u4E00\u81F4"}),(0,i.jsx)(n.td,{children:"\u4E2D\u7B49"}),(0,i.jsx)(n.td,{children:"\u8BFB\u6269\u5C55"}),(0,i.jsx)(n.td,{children:"\u4F4E"}),(0,i.jsx)(n.td,{children:"\u8BFB\u591A\u5199\u5C11\uFF0C\u7B80\u5355\u67B6\u6784"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u54E8\u5175\u6A21\u5F0F"})}),(0,i.jsx)(n.td,{children:"\u6700\u7EC8\u4E00\u81F4"}),(0,i.jsx)(n.td,{children:"\u9AD8"}),(0,i.jsx)(n.td,{children:"\u8BFB\u6269\u5C55"}),(0,i.jsx)(n.td,{children:"\u4E2D\u7B49"}),(0,i.jsx)(n.td,{children:"\u9AD8\u53EF\u7528\u8981\u6C42\uFF0C\u81EA\u52A8\u6545\u969C\u8F6C\u79FB"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u96C6\u7FA4\u6A21\u5F0F"})}),(0,i.jsx)(n.td,{children:"\u6700\u7EC8\u4E00\u81F4"}),(0,i.jsx)(n.td,{children:"\u9AD8"}),(0,i.jsx)(n.td,{children:"\u8BFB\u5199\u6269\u5C55"}),(0,i.jsx)(n.td,{children:"\u9AD8"}),(0,i.jsx)(n.td,{children:"\u5927\u6570\u636E\u91CF\uFF0C\u9AD8\u5E76\u53D1\uFF0C\u6C34\u5E73\u6269\u5C55"})]})]})]}),"\n",(0,i.jsx)(n.mermaid,{value:"graph TD\n    A[\u9009\u62E9Redis\u9AD8\u53EF\u7528\u65B9\u6848] --\x3e B{\u6570\u636E\u91CF\u5927\u5C0F}\n    B --\x3e|\u5C0F\u4E8E100GB| C{\u53EF\u7528\u6027\u8981\u6C42}\n    B --\x3e|\u5927\u4E8E100GB| D[\u96C6\u7FA4\u6A21\u5F0F]\n    \n    C --\x3e|\u4E00\u822C| E[\u4E3B\u4ECE\u590D\u5236]\n    C --\x3e|\u9AD8| F[\u54E8\u5175\u6A21\u5F0F]\n    \n    D --\x3e G[3\u4E3B3\u4ECE\u8D77\u6B65]\n    E --\x3e H[1\u4E3B2\u4ECE\u914D\u7F6E]\n    F --\x3e I[1\u4E3B2\u4ECE+3\u54E8\u5175]\n    \n    G --\x3e J[\u652F\u6301\u6C34\u5E73\u6269\u5C55]\n    H --\x3e K[\u7B80\u5355\u6613\u7EF4\u62A4]\n    I --\x3e L[\u81EA\u52A8\u6545\u969C\u8F6C\u79FB]"}),"\n",(0,i.jsx)(n.h2,{id:"5-redis\u6027\u80FD\u4F18\u5316\u5B9E\u6218",children:"5. Redis\u6027\u80FD\u4F18\u5316\u5B9E\u6218"}),"\n",(0,i.jsx)(n.p,{children:"Redis\u6027\u80FD\u4F18\u5316\u662F\u4E00\u4E2A\u7CFB\u7EDF\u5DE5\u7A0B\uFF0C\u6D89\u53CA\u5185\u5B58\u3001\u7F51\u7EDC\u3001\u6301\u4E45\u5316\u3001\u6570\u636E\u7ED3\u6784\u7B49\u591A\u4E2A\u65B9\u9762\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"51-\u5185\u5B58\u4F18\u5316\u7B56\u7565",children:"5.1 \u5185\u5B58\u4F18\u5316\u7B56\u7565"}),"\n",(0,i.jsx)(n.p,{children:"\u5185\u5B58\u662FRedis\u6700\u5B9D\u8D35\u7684\u8D44\u6E90\uFF0C\u5408\u7406\u7684\u5185\u5B58\u4F7F\u7528\u7B56\u7565\u76F4\u63A5\u5F71\u54CD\u7CFB\u7EDF\u6027\u80FD\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"memory-config",label:"\u5185\u5B58\u914D\u7F6E",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Redis\u5185\u5B58\u914D\u7F6E\u4F18\u5316"',children:"# \u57FA\u7840\u5185\u5B58\u914D\u7F6E\nmaxmemory 8gb                           # \u8BBE\u7F6E\u6700\u5927\u5185\u5B58\u9650\u5236\nmaxmemory-policy allkeys-lru            # \u5185\u5B58\u6DD8\u6C70\u7B56\u7565\n\n# \u5185\u5B58\u6DD8\u6C70\u7B56\u7565\u8BE6\u89E3\n# noeviction\uFF1A\u4E0D\u6DD8\u6C70\uFF0C\u5185\u5B58\u6EE1\u65F6\u5199\u5165\u62A5\u9519\uFF08\u9ED8\u8BA4\uFF09\n# allkeys-lru\uFF1A\u4ECE\u6240\u6709key\u4E2D\u4F7F\u7528LRU\u7B97\u6CD5\u6DD8\u6C70\n# volatile-lru\uFF1A\u4ECE\u8BBE\u7F6E\u4E86\u8FC7\u671F\u65F6\u95F4\u7684key\u4E2D\u4F7F\u7528LRU\u7B97\u6CD5\u6DD8\u6C70\n# allkeys-random\uFF1A\u4ECE\u6240\u6709key\u4E2D\u968F\u673A\u6DD8\u6C70\n# volatile-random\uFF1A\u4ECE\u8BBE\u7F6E\u4E86\u8FC7\u671F\u65F6\u95F4\u7684key\u4E2D\u968F\u673A\u6DD8\u6C70\n# volatile-ttl\uFF1A\u6DD8\u6C70\u5373\u5C06\u8FC7\u671F\u7684key\n# allkeys-lfu\uFF1A\u4ECE\u6240\u6709key\u4E2D\u4F7F\u7528LFU\u7B97\u6CD5\u6DD8\u6C70\uFF08Redis 4.0+\uFF09\n# volatile-lfu\uFF1A\u4ECE\u8BBE\u7F6E\u4E86\u8FC7\u671F\u65F6\u95F4\u7684key\u4E2D\u4F7F\u7528LFU\u7B97\u6CD5\u6DD8\u6C70\uFF08Redis 4.0+\uFF09\n\n# LRU\u914D\u7F6E\u4F18\u5316\nmaxmemory-samples 5                     # LRU\u91C7\u6837\u6570\u91CF\uFF0C\u8D8A\u5927\u8D8A\u7CBE\u786E\u4F46\u6027\u80FD\u8D8A\u4F4E\n\n# \u5185\u5B58\u4F7F\u7528\u76D1\u63A7\nredis-cli INFO memory\n# used_memory:8589934592                # \u5DF2\u4F7F\u7528\u5185\u5B58\uFF08\u5B57\u8282\uFF09\n# used_memory_human:8.00G               # \u5DF2\u4F7F\u7528\u5185\u5B58\uFF08\u4EBA\u7C7B\u53EF\u8BFB\uFF09\n# used_memory_rss:9663676416            # \u7CFB\u7EDF\u5206\u914D\u5185\u5B58\n# used_memory_peak:8589934592           # \u5185\u5B58\u4F7F\u7528\u5CF0\u503C\n# used_memory_peak_human:8.00G          # \u5185\u5B58\u4F7F\u7528\u5CF0\u503C\uFF08\u4EBA\u7C7B\u53EF\u8BFB\uFF09\n# maxmemory:8589934592                  # \u6700\u5927\u5185\u5B58\u9650\u5236\n# maxmemory_human:8.00G                 # \u6700\u5927\u5185\u5B58\u9650\u5236\uFF08\u4EBA\u7C7B\u53EF\u8BFB\uFF09\n# maxmemory_policy:allkeys-lru          # \u5185\u5B58\u6DD8\u6C70\u7B56\u7565\n"})})}),(0,i.jsx)(a.A,{value:"data-structure",label:"\u6570\u636E\u7ED3\u6784\u4F18\u5316",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="\u6570\u636E\u7ED3\u6784\u5185\u5B58\u4F18\u5316"',children:'# 1. String vs Hash \u5BF9\u6BD4\n# \u4E0D\u63A8\u8350\uFF1A\u4F7F\u7528String\u5B58\u50A8\u7528\u6237\u4FE1\u606F\nSET user:1001:name "John"               # \u5360\u7528\u5185\u5B58\uFF1A~50\u5B57\u8282\nSET user:1001:age "25"                  # \u5360\u7528\u5185\u5B58\uFF1A~45\u5B57\u8282  \nSET user:1001:email "john@example.com"  # \u5360\u7528\u5185\u5B58\uFF1A~65\u5B57\u8282\n# \u603B\u8BA1\uFF1A~160\u5B57\u8282\n\n# \u63A8\u8350\uFF1A\u4F7F\u7528Hash\u5B58\u50A8\u7528\u6237\u4FE1\u606F\nHMSET user:1001 name "John" age "25" email "john@example.com"\n# \u603B\u8BA1\uFF1A~80\u5B57\u8282\uFF0C\u8282\u770150%\u5185\u5B58\n\n# 2. \u5C0F\u5BF9\u8C61\u538B\u7F29\u914D\u7F6E\n# Hash\u538B\u7F29\u914D\u7F6E\nhash-max-ziplist-entries 512           # \u5B57\u6BB5\u6570\u91CF\u5C0F\u4E8E512\u65F6\u4F7F\u7528ziplist\nhash-max-ziplist-value 64              # \u5B57\u6BB5\u503C\u5C0F\u4E8E64\u5B57\u8282\u65F6\u4F7F\u7528ziplist\n\n# List\u538B\u7F29\u914D\u7F6E  \nlist-max-ziplist-size -2               # \u6BCF\u4E2A\u8282\u70B9\u6700\u59278KB\nlist-compress-depth 0                  # \u4E0D\u538B\u7F29\u5934\u5C3E\u8282\u70B9\n\n# Set\u538B\u7F29\u914D\u7F6E\nset-max-intset-entries 512             # \u6574\u6570\u96C6\u5408\u6700\u5927512\u4E2A\u5143\u7D20\n\n# Sorted Set\u538B\u7F29\u914D\u7F6E\nzset-max-ziplist-entries 128           # \u5143\u7D20\u6570\u91CF\u5C0F\u4E8E128\u65F6\u4F7F\u7528ziplist\nzset-max-ziplist-value 64              # \u5143\u7D20\u503C\u5C0F\u4E8E64\u5B57\u8282\u65F6\u4F7F\u7528ziplist\n\n# 3. \u5185\u5B58\u788E\u7247\u4F18\u5316\n# \u542F\u7528\u5185\u5B58\u788E\u7247\u6574\u7406\uFF08Redis 4.0+\uFF09\nactivedefrag yes                        # \u542F\u7528\u4E3B\u52A8\u788E\u7247\u6574\u7406\nactive-defrag-ignore-bytes 100mb       # \u788E\u7247\u5C0F\u4E8E100MB\u65F6\u4E0D\u6574\u7406\nactive-defrag-threshold-lower 10       # \u788E\u7247\u7387\u4F4E\u4E8E10%\u65F6\u4E0D\u6574\u7406\nactive-defrag-threshold-upper 100      # \u788E\u7247\u7387\u9AD8\u4E8E100%\u65F6\u79EF\u6781\u6574\u7406\nactive-defrag-cycle-min 5              # \u6700\u5C0FCPU\u4F7F\u7528\u73875%\nactive-defrag-cycle-max 75             # \u6700\u5927CPU\u4F7F\u7528\u738775%\n'})})}),(0,i.jsx)(a.A,{value:"key-design",label:"\u952E\u8BBE\u8BA1\u4F18\u5316",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Redis\u952E\u8BBE\u8BA1\u6700\u4F73\u5B9E\u8DF5"',children:'# 1. \u952E\u547D\u540D\u89C4\u8303\n# \u63A8\u8350\u683C\u5F0F\uFF1A\u4E1A\u52A1:\u5BF9\u8C61:ID:\u5C5E\u6027\nuser:profile:1001:basic                 # \u7528\u6237\u57FA\u7840\u4FE1\u606F\nuser:profile:1001:settings              # \u7528\u6237\u8BBE\u7F6E\u4FE1\u606F\norder:detail:2001:items                 # \u8BA2\u5355\u5546\u54C1\u4FE1\u606F\ncache:product:3001:info                 # \u5546\u54C1\u7F13\u5B58\u4FE1\u606F\n\n# 2. \u907F\u514D\u8FC7\u957F\u7684\u952E\u540D\n# \u4E0D\u63A8\u8350\nSET "this_is_a_very_long_key_name_that_wastes_memory_and_affects_performance" "value"\n\n# \u63A8\u8350  \nSET "user:1001:profile" "value"\n\n# 3. \u4F7F\u7528\u5408\u9002\u7684\u8FC7\u671F\u65F6\u95F4\nSET cache:user:1001 "data" EX 3600      # 1\u5C0F\u65F6\u8FC7\u671F\nSET session:abc123 "data" EX 1800       # 30\u5206\u949F\u8FC7\u671F\nSET temp:data:xyz "data" EX 300         # 5\u5206\u949F\u8FC7\u671F\n\n# 4. \u6279\u91CF\u64CD\u4F5C\u4F18\u5316\n# \u4E0D\u63A8\u8350\uFF1A\u591A\u6B21\u5355\u72EC\u64CD\u4F5C\nSET user:1001:name "John"\nSET user:1001:age "25"  \nSET user:1001:email "john@example.com"\n\n# \u63A8\u8350\uFF1A\u6279\u91CF\u64CD\u4F5C\nMSET user:1001:name "John" user:1001:age "25" user:1001:email "john@example.com"\n\n# \u6216\u8005\u4F7F\u7528Hash\nHMSET user:1001 name "John" age "25" email "john@example.com"\n\n# 5. \u5927key\u62C6\u5206\n# \u4E0D\u63A8\u8350\uFF1A\u5355\u4E2A\u5927Hash\nHMSET big_hash field1 value1 field2 value2 ... field10000 value10000\n\n# \u63A8\u8350\uFF1A\u62C6\u5206\u4E3A\u591A\u4E2A\u5C0FHash\nHMSET hash:1 field1 value1 field2 value2 ... field100 value100\nHMSET hash:2 field101 value101 field102 value102 ... field200 value200\n'})})}),(0,i.jsx)(a.A,{value:"monitoring",label:"\u5185\u5B58\u76D1\u63A7",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="Java\u5185\u5B58\u76D1\u63A7\u5B9E\u73B0"',children:'@Component\npublic class RedisMemoryMonitor {\n    \n    @Autowired\n    private RedisTemplate<String, Object> redisTemplate;\n    \n    private static final Logger logger = LoggerFactory.getLogger(RedisMemoryMonitor.class);\n    \n    /**\n     * \u83B7\u53D6\u5185\u5B58\u4F7F\u7528\u4FE1\u606F\n     */\n    public Map<String, Object> getMemoryInfo() {\n        return redisTemplate.execute((RedisCallback<Map<String, Object>>) connection -> {\n            Properties info = connection.info("memory");\n            Map<String, Object> memoryInfo = new HashMap<>();\n            \n            memoryInfo.put("used_memory", info.getProperty("used_memory"));\n            memoryInfo.put("used_memory_human", info.getProperty("used_memory_human"));\n            memoryInfo.put("used_memory_rss", info.getProperty("used_memory_rss"));\n            memoryInfo.put("used_memory_peak", info.getProperty("used_memory_peak"));\n            memoryInfo.put("maxmemory", info.getProperty("maxmemory"));\n            memoryInfo.put("maxmemory_policy", info.getProperty("maxmemory_policy"));\n            \n            return memoryInfo;\n        });\n    }\n    \n    /**\n     * \u8BA1\u7B97\u5185\u5B58\u4F7F\u7528\u7387\n     */\n    public double getMemoryUsageRatio() {\n        Map<String, Object> memoryInfo = getMemoryInfo();\n        long usedMemory = Long.parseLong((String) memoryInfo.get("used_memory"));\n        long maxMemory = Long.parseLong((String) memoryInfo.get("maxmemory"));\n        \n        if (maxMemory == 0) {\n            return 0.0;\n        }\n        \n        return (double) usedMemory / maxMemory * 100;\n    }\n    \n    /**\n     * \u5185\u5B58\u544A\u8B66\u68C0\u67E5\n     */\n    @Scheduled(fixedRate = 60000) // \u6BCF\u5206\u949F\u68C0\u67E5\u4E00\u6B21\n    public void checkMemoryUsage() {\n        double usageRatio = getMemoryUsageRatio();\n        \n        if (usageRatio > 80) {\n            logger.warn("Redis\u5185\u5B58\u4F7F\u7528\u7387\u8FC7\u9AD8: {}%", String.format("%.2f", usageRatio));\n            // \u53D1\u9001\u544A\u8B66\u901A\u77E5\n            sendAlert("Redis\u5185\u5B58\u4F7F\u7528\u7387\u544A\u8B66", "\u5F53\u524D\u4F7F\u7528\u7387: " + String.format("%.2f", usageRatio) + "%");\n        }\n    }\n    \n    /**\n     * \u5206\u6790\u5927key\n     */\n    public List<String> findBigKeys() {\n        return redisTemplate.execute((RedisCallback<List<String>>) connection -> {\n            List<String> bigKeys = new ArrayList<>();\n            \n            // \u4F7F\u7528SCAN\u547D\u4EE4\u904D\u5386\u6240\u6709key\n            ScanOptions options = ScanOptions.scanOptions().count(100).build();\n            Cursor<byte[]> cursor = connection.scan(options);\n            \n            while (cursor.hasNext()) {\n                byte[] keyBytes = cursor.next();\n                String key = new String(keyBytes);\n                \n                // \u68C0\u67E5key\u7684\u5185\u5B58\u4F7F\u7528\n                Long memoryUsage = connection.memoryUsage(keyBytes);\n                if (memoryUsage != null && memoryUsage > 1024 * 1024) { // \u5927\u4E8E1MB\n                    bigKeys.add(key + " (" + formatBytes(memoryUsage) + ")");\n                }\n            }\n            \n            return bigKeys;\n        });\n    }\n    \n    private String formatBytes(long bytes) {\n        if (bytes < 1024) return bytes + " B";\n        if (bytes < 1024 * 1024) return String.format("%.2f KB", bytes / 1024.0);\n        if (bytes < 1024 * 1024 * 1024) return String.format("%.2f MB", bytes / (1024.0 * 1024));\n        return String.format("%.2f GB", bytes / (1024.0 * 1024 * 1024));\n    }\n    \n    private void sendAlert(String title, String message) {\n        // \u5B9E\u73B0\u544A\u8B66\u901A\u77E5\u903B\u8F91\uFF08\u90AE\u4EF6\u3001\u77ED\u4FE1\u3001\u9489\u9489\u7B49\uFF09\n        logger.error("\u544A\u8B66: {} - {}", title, message);\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"52-\u7F51\u7EDC\u4E0E\u8FDE\u63A5\u4F18\u5316",children:"5.2 \u7F51\u7EDC\u4E0E\u8FDE\u63A5\u4F18\u5316"}),"\n",(0,i.jsx)(n.p,{children:"\u7F51\u7EDC\u548C\u8FDE\u63A5\u914D\u7F6E\u76F4\u63A5\u5F71\u54CDRedis\u7684\u54CD\u5E94\u65F6\u95F4\u548C\u5E76\u53D1\u5904\u7406\u80FD\u529B\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"network-config",label:"\u7F51\u7EDC\u914D\u7F6E",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Redis\u7F51\u7EDC\u914D\u7F6E\u4F18\u5316"',children:"# \u57FA\u7840\u7F51\u7EDC\u914D\u7F6E\nbind 0.0.0.0                           # \u7ED1\u5B9A\u6240\u6709\u7F51\u7EDC\u63A5\u53E3\nport 6379                              # \u76D1\u542C\u7AEF\u53E3\ntcp-backlog 511                        # TCP\u76D1\u542C\u961F\u5217\u957F\u5EA6\ntimeout 0                              # \u5BA2\u6237\u7AEF\u7A7A\u95F2\u8D85\u65F6\u65F6\u95F4\uFF080\u8868\u793A\u4E0D\u8D85\u65F6\uFF09\n\n# TCP\u914D\u7F6E\u4F18\u5316\ntcp-keepalive 300                      # TCP keepalive\u65F6\u95F4\uFF08\u79D2\uFF09\n# \u5EFA\u8BAE\u8BBE\u7F6E\u4E3A300\u79D2\uFF0C\u53EF\u4EE5\u53CA\u65F6\u53D1\u73B0\u65AD\u5F00\u7684\u8FDE\u63A5\n\n# \u5BA2\u6237\u7AEF\u8FDE\u63A5\u914D\u7F6E\nmaxclients 10000                       # \u6700\u5927\u5BA2\u6237\u7AEF\u8FDE\u63A5\u6570\n# \u9ED8\u8BA410000\uFF0C\u6839\u636E\u670D\u52A1\u5668\u6027\u80FD\u548C\u5185\u5B58\u8C03\u6574\n\n# \u8F93\u51FA\u7F13\u51B2\u533A\u914D\u7F6E\nclient-output-buffer-limit normal 0 0 0                    # \u666E\u901A\u5BA2\u6237\u7AEF\u65E0\u9650\u5236\nclient-output-buffer-limit replica 256mb 64mb 60           # \u4ECE\u8282\u70B9\u5BA2\u6237\u7AEF\nclient-output-buffer-limit pubsub 32mb 8mb 60              # \u53D1\u5E03\u8BA2\u9605\u5BA2\u6237\u7AEF\n\n# \u7F51\u7EDC\u6027\u80FD\u76D1\u63A7\nredis-cli INFO clients\n# connected_clients:100              # \u5F53\u524D\u8FDE\u63A5\u7684\u5BA2\u6237\u7AEF\u6570\u91CF\n# client_recent_max_input_buffer:2   # \u6700\u8FD1\u5BA2\u6237\u7AEF\u6700\u5927\u8F93\u5165\u7F13\u51B2\u533A\n# client_recent_max_output_buffer:0  # \u6700\u8FD1\u5BA2\u6237\u7AEF\u6700\u5927\u8F93\u51FA\u7F13\u51B2\u533A\n# blocked_clients:0                  # \u88AB\u963B\u585E\u7684\u5BA2\u6237\u7AEF\u6570\u91CF\n\nredis-cli INFO stats\n# total_connections_received:1000    # \u603B\u8FDE\u63A5\u6570\n# total_commands_processed:50000     # \u603B\u547D\u4EE4\u6570\n# instantaneous_ops_per_sec:100      # \u5F53\u524D\u6BCF\u79D2\u64CD\u4F5C\u6570\n# instantaneous_input_kbps:10.5      # \u5F53\u524D\u8F93\u5165\u901F\u7387(KB/s)\n# instantaneous_output_kbps:15.2     # \u5F53\u524D\u8F93\u51FA\u901F\u7387(KB/s)\n"})})}),(0,i.jsx)(a.A,{value:"connection-pool",label:"\u8FDE\u63A5\u6C60\u4F18\u5316",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="Java\u8FDE\u63A5\u6C60\u914D\u7F6E\u4F18\u5316"',children:'@Configuration\npublic class RedisConnectionPoolConfig {\n    \n    @Bean\n    public LettuceConnectionFactory redisConnectionFactory() {\n        // \u5355\u673A\u914D\u7F6E\n        RedisStandaloneConfiguration config = new RedisStandaloneConfiguration();\n        config.setHostName("192.168.1.100");\n        config.setPort(6379);\n        config.setPassword("your_password");\n        config.setDatabase(0);\n        \n        // \u8FDE\u63A5\u6C60\u914D\u7F6E\n        GenericObjectPoolConfig<Object> poolConfig = new GenericObjectPoolConfig<>();\n        \n        // \u8FDE\u63A5\u6C60\u5927\u5C0F\u914D\u7F6E\n        poolConfig.setMaxTotal(200);                    // \u6700\u5927\u8FDE\u63A5\u6570\n        poolConfig.setMaxIdle(50);                      // \u6700\u5927\u7A7A\u95F2\u8FDE\u63A5\u6570\n        poolConfig.setMinIdle(10);                      // \u6700\u5C0F\u7A7A\u95F2\u8FDE\u63A5\u6570\n        \n        // \u8FDE\u63A5\u83B7\u53D6\u914D\u7F6E\n        poolConfig.setMaxWaitMillis(3000);              // \u6700\u5927\u7B49\u5F85\u65F6\u95F4(ms)\n        poolConfig.setBlockWhenExhausted(true);         // \u8FDE\u63A5\u8017\u5C3D\u65F6\u662F\u5426\u963B\u585E\n        \n        // \u8FDE\u63A5\u9A8C\u8BC1\u914D\u7F6E\n        poolConfig.setTestOnBorrow(true);               // \u83B7\u53D6\u8FDE\u63A5\u65F6\u9A8C\u8BC1\n        poolConfig.setTestOnReturn(false);              // \u5F52\u8FD8\u8FDE\u63A5\u65F6\u9A8C\u8BC1\n        poolConfig.setTestWhileIdle(true);              // \u7A7A\u95F2\u65F6\u9A8C\u8BC1\u8FDE\u63A5\n        poolConfig.setTimeBetweenEvictionRunsMillis(30000); // \u7A7A\u95F2\u68C0\u6D4B\u95F4\u9694(ms)\n        poolConfig.setMinEvictableIdleTimeMillis(60000);    // \u6700\u5C0F\u7A7A\u95F2\u65F6\u95F4(ms)\n        poolConfig.setNumTestsPerEvictionRun(3);            // \u6BCF\u6B21\u68C0\u6D4B\u8FDE\u63A5\u6570\n        \n        // Lettuce\u5BA2\u6237\u7AEF\u914D\u7F6E\n        LettucePoolingClientConfiguration clientConfig = \n            LettucePoolingClientConfiguration.builder()\n                .poolConfig(poolConfig)\n                .commandTimeout(Duration.ofSeconds(5))      // \u547D\u4EE4\u8D85\u65F6\u65F6\u95F4\n                .shutdownTimeout(Duration.ofSeconds(10))    // \u5173\u95ED\u8D85\u65F6\u65F6\u95F4\n                .build();\n        \n        return new LettuceConnectionFactory(config, clientConfig);\n    }\n    \n    @Bean\n    public RedisTemplate<String, Object> redisTemplate(\n            LettuceConnectionFactory connectionFactory) {\n        RedisTemplate<String, Object> template = new RedisTemplate<>();\n        template.setConnectionFactory(connectionFactory);\n        \n        // \u5E8F\u5217\u5316\u914D\u7F6E\n        Jackson2JsonRedisSerializer<Object> serializer = \n            new Jackson2JsonRedisSerializer<>(Object.class);\n        ObjectMapper objectMapper = new ObjectMapper();\n        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);\n        objectMapper.activateDefaultTyping(LaissezFaireSubTypeValidator.instance, \n            ObjectMapper.DefaultTyping.NON_FINAL);\n        serializer.setObjectMapper(objectMapper);\n        \n        template.setKeySerializer(new StringRedisSerializer());\n        template.setValueSerializer(serializer);\n        template.setHashKeySerializer(new StringRedisSerializer());\n        template.setHashValueSerializer(serializer);\n        \n        template.afterPropertiesSet();\n        return template;\n    }\n}\n\n// \u8FDE\u63A5\u6C60\u76D1\u63A7\n@Component\npublic class RedisConnectionPoolMonitor {\n    \n    @Autowired\n    private LettuceConnectionFactory connectionFactory;\n    \n    private static final Logger logger = LoggerFactory.getLogger(RedisConnectionPoolMonitor.class);\n    \n    @Scheduled(fixedRate = 60000) // \u6BCF\u5206\u949F\u76D1\u63A7\u4E00\u6B21\n    public void monitorConnectionPool() {\n        try {\n            // \u83B7\u53D6\u8FDE\u63A5\u6C60\u7EDF\u8BA1\u4FE1\u606F\n            GenericObjectPool<Object> pool = \n                (GenericObjectPool<Object>) connectionFactory.getClientConfiguration();\n            \n            if (pool != null) {\n                int activeConnections = pool.getNumActive();\n                int idleConnections = pool.getNumIdle();\n                int totalConnections = activeConnections + idleConnections;\n                \n                logger.info("Redis\u8FDE\u63A5\u6C60\u72B6\u6001 - \u6D3B\u8DC3\u8FDE\u63A5: {}, \u7A7A\u95F2\u8FDE\u63A5: {}, \u603B\u8FDE\u63A5: {}", \n                    activeConnections, idleConnections, totalConnections);\n                \n                // \u8FDE\u63A5\u6C60\u4F7F\u7528\u7387\u544A\u8B66\n                double usageRatio = (double) activeConnections / pool.getMaxTotal() * 100;\n                if (usageRatio > 80) {\n                    logger.warn("Redis\u8FDE\u63A5\u6C60\u4F7F\u7528\u7387\u8FC7\u9AD8: {}%", String.format("%.2f", usageRatio));\n                }\n            }\n        } catch (Exception e) {\n            logger.error("\u76D1\u63A7Redis\u8FDE\u63A5\u6C60\u5931\u8D25", e);\n        }\n    }\n}\n'})})}),(0,i.jsx)(a.A,{value:"pipeline",label:"Pipeline\u4F18\u5316",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="Pipeline\u6279\u91CF\u64CD\u4F5C\u4F18\u5316"',children:'@Service\npublic class RedisPipelineService {\n    \n    @Autowired\n    private RedisTemplate<String, Object> redisTemplate;\n    \n    /**\n     * \u4F7F\u7528Pipeline\u6279\u91CF\u8BBE\u7F6E\u6570\u636E\n     */\n    public void batchSetWithPipeline(Map<String, Object> data) {\n        redisTemplate.executePipelined((RedisCallback<Object>) connection -> {\n            for (Map.Entry<String, Object> entry : data.entrySet()) {\n                connection.set(\n                    entry.getKey().getBytes(), \n                    serialize(entry.getValue())\n                );\n            }\n            return null;\n        });\n    }\n    \n    /**\n     * \u4F7F\u7528Pipeline\u6279\u91CF\u83B7\u53D6\u6570\u636E\n     */\n    public List<Object> batchGetWithPipeline(List<String> keys) {\n        return redisTemplate.executePipelined((RedisCallback<Object>) connection -> {\n            for (String key : keys) {\n                connection.get(key.getBytes());\n            }\n            return null;\n        });\n    }\n    \n    /**\n     * \u6027\u80FD\u5BF9\u6BD4\u6D4B\u8BD5\n     */\n    public void performanceComparison() {\n        Map<String, Object> testData = new HashMap<>();\n        for (int i = 0; i < 1000; i++) {\n            testData.put("test:key:" + i, "value" + i);\n        }\n        \n        // \u666E\u901A\u65B9\u5F0F\n        long start1 = System.currentTimeMillis();\n        for (Map.Entry<String, Object> entry : testData.entrySet()) {\n            redisTemplate.opsForValue().set(entry.getKey(), entry.getValue());\n        }\n        long time1 = System.currentTimeMillis() - start1;\n        \n        // Pipeline\u65B9\u5F0F\n        long start2 = System.currentTimeMillis();\n        batchSetWithPipeline(testData);\n        long time2 = System.currentTimeMillis() - start2;\n        \n        System.out.println("\u666E\u901A\u65B9\u5F0F\u8017\u65F6: " + time1 + "ms");\n        System.out.println("Pipeline\u65B9\u5F0F\u8017\u65F6: " + time2 + "ms");\n        System.out.println("\u6027\u80FD\u63D0\u5347: " + (time1 / (double) time2) + "\u500D");\n    }\n    \n    /**\n     * \u667A\u80FD\u6279\u91CF\u64CD\u4F5C - \u81EA\u52A8\u5206\u6279\u5904\u7406\n     */\n    public void smartBatchOperation(Map<String, Object> data, int batchSize) {\n        List<Map.Entry<String, Object>> entries = new ArrayList<>(data.entrySet());\n        \n        for (int i = 0; i < entries.size(); i += batchSize) {\n            int endIndex = Math.min(i + batchSize, entries.size());\n            List<Map.Entry<String, Object>> batch = entries.subList(i, endIndex);\n            \n            redisTemplate.executePipelined((RedisCallback<Object>) connection -> {\n                for (Map.Entry<String, Object> entry : batch) {\n                    connection.set(\n                        entry.getKey().getBytes(), \n                        serialize(entry.getValue())\n                    );\n                }\n                return null;\n            });\n        }\n    }\n    \n    private byte[] serialize(Object obj) {\n        // \u5B9E\u73B0\u5E8F\u5217\u5316\u903B\u8F91\n        return obj.toString().getBytes();\n    }\n}\n\n// Lua\u811A\u672C\u4F18\u5316\n@Service\npublic class RedisLuaScriptService {\n    \n    @Autowired\n    private RedisTemplate<String, Object> redisTemplate;\n    \n    // \u539F\u5B50\u6027\u589E\u52A0\u5E93\u5B58\u7684Lua\u811A\u672C\n    private static final String STOCK_SCRIPT = \n        "local key = KEYS[1] " +\n        "local delta = tonumber(ARGV[1]) " +\n        "local current = redis.call(\'GET\', key) " +\n        "if current == false then " +\n        "    current = 0 " +\n        "else " +\n        "    current = tonumber(current) " +\n        "end " +\n        "local newValue = current + delta " +\n        "if newValue >= 0 then " +\n        "    redis.call(\'SET\', key, newValue) " +\n        "    return newValue " +\n        "else " +\n        "    return -1 " +\n        "end";\n    \n    /**\n     * \u539F\u5B50\u6027\u5E93\u5B58\u64CD\u4F5C\n     */\n    public Long atomicStockOperation(String productId, int delta) {\n        DefaultRedisScript<Long> script = new DefaultRedisScript<>();\n        script.setScriptText(STOCK_SCRIPT);\n        script.setResultType(Long.class);\n        \n        return redisTemplate.execute(script, \n            Collections.singletonList("stock:" + productId), \n            String.valueOf(delta));\n    }\n    \n    // \u5206\u5E03\u5F0F\u9650\u6D41Lua\u811A\u672C\n    private static final String RATE_LIMIT_SCRIPT =\n        "local key = KEYS[1] " +\n        "local window = tonumber(ARGV[1]) " +\n        "local limit = tonumber(ARGV[2]) " +\n        "local current = redis.call(\'INCR\', key) " +\n        "if current == 1 then " +\n        "    redis.call(\'EXPIRE\', key, window) " +\n        "end " +\n        "if current <= limit then " +\n        "    return 1 " +\n        "else " +\n        "    return 0 " +\n        "end";\n    \n    /**\n     * \u5206\u5E03\u5F0F\u9650\u6D41\n     */\n    public boolean rateLimitCheck(String key, int windowSeconds, int limit) {\n        DefaultRedisScript<Long> script = new DefaultRedisScript<>();\n        script.setScriptText(RATE_LIMIT_SCRIPT);\n        script.setResultType(Long.class);\n        \n        Long result = redisTemplate.execute(script, \n            Collections.singletonList(key), \n            String.valueOf(windowSeconds), \n            String.valueOf(limit));\n        \n        return Long.valueOf(1).equals(result);\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"53-\u6301\u4E45\u5316\u6027\u80FD\u4F18\u5316",children:"5.3 \u6301\u4E45\u5316\u6027\u80FD\u4F18\u5316"}),"\n",(0,i.jsx)(n.p,{children:"\u6301\u4E45\u5316\u914D\u7F6E\u76F4\u63A5\u5F71\u54CDRedis\u7684\u5199\u5165\u6027\u80FD\u548C\u6570\u636E\u5B89\u5168\u6027\uFF0C\u9700\u8981\u6839\u636E\u4E1A\u52A1\u9700\u6C42\u8FDB\u884C\u5E73\u8861\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"rdb-optimization",label:"RDB\u4F18\u5316",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="RDB\u6301\u4E45\u5316\u6027\u80FD\u4F18\u5316"',children:"# RDB\u89E6\u53D1\u6761\u4EF6\u4F18\u5316\n# \u6839\u636E\u4E1A\u52A1\u7279\u70B9\u8C03\u6574save\u914D\u7F6E\nsave 900 1                             # 15\u5206\u949F\u5185\u81F3\u5C111\u4E2Akey\u53D8\u5316\nsave 300 10                            # 5\u5206\u949F\u5185\u81F3\u5C1110\u4E2Akey\u53D8\u5316\nsave 60 10000                          # 1\u5206\u949F\u5185\u81F3\u5C1110000\u4E2Akey\u53D8\u5316\n\n# \u9AD8\u5199\u5165\u573A\u666F\u7684\u914D\u7F6E\nsave 3600 1                            # 1\u5C0F\u65F6\u5185\u81F3\u5C111\u4E2Akey\u53D8\u5316\nsave 1800 100                          # 30\u5206\u949F\u5185\u81F3\u5C11100\u4E2Akey\u53D8\u5316\nsave 300 10000                         # 5\u5206\u949F\u5185\u81F3\u5C1110000\u4E2Akey\u53D8\u5316\n\n# \u4F4E\u5199\u5165\u573A\u666F\u7684\u914D\u7F6E\nsave 300 1                             # 5\u5206\u949F\u5185\u81F3\u5C111\u4E2Akey\u53D8\u5316\nsave 60 10                             # 1\u5206\u949F\u5185\u81F3\u5C1110\u4E2Akey\u53D8\u5316\nsave 10 1000                           # 10\u79D2\u5185\u81F3\u5C111000\u4E2Akey\u53D8\u5316\n\n# RDB\u6027\u80FD\u914D\u7F6E\nstop-writes-on-bgsave-error yes        # BGSAVE\u5931\u8D25\u65F6\u505C\u6B62\u5199\u5165\nrdbcompression yes                     # \u542F\u7528RDB\u538B\u7F29\uFF08CPU\u6362\u5B58\u50A8\uFF09\nrdbchecksum yes                        # \u542F\u7528RDB\u6821\u9A8C\uFF08\u5B89\u5168\u6027\uFF09\nrdb-save-incremental-fsync yes         # \u589E\u91CFfsync\uFF08\u51CF\u5C11IO\u963B\u585E\uFF09\n\n# \u76D1\u63A7RDB\u6027\u80FD\nredis-cli LASTSAVE                     # \u6700\u540E\u4E00\u6B21\u4FDD\u5B58\u65F6\u95F4\nredis-cli INFO persistence\n# rdb_changes_since_last_save:1000     # \u4E0A\u6B21\u4FDD\u5B58\u540E\u7684\u53D8\u5316\u6570\n# rdb_bgsave_in_progress:0             # \u662F\u5426\u6B63\u5728\u8FDB\u884CBGSAVE\n# rdb_last_save_time:1640995200        # \u6700\u540E\u4FDD\u5B58\u65F6\u95F4\u6233\n# rdb_last_bgsave_status:ok            # \u6700\u540EBGSAVE\u72B6\u6001\n# rdb_last_bgsave_time_sec:2           # \u6700\u540EBGSAVE\u8017\u65F6\n"})})}),(0,i.jsx)(a.A,{value:"aof-optimization",label:"AOF\u4F18\u5316",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="AOF\u6301\u4E45\u5316\u6027\u80FD\u4F18\u5316"',children:'# AOF\u57FA\u7840\u914D\u7F6E\nappendonly yes                         # \u542F\u7528AOF\nappendfilename "appendonly.aof"        # AOF\u6587\u4EF6\u540D\nappendfsync everysec                   # \u6BCF\u79D2\u540C\u6B65\uFF08\u63A8\u8350\uFF09\n\n# AOF\u540C\u6B65\u7B56\u7565\u5BF9\u6BD4\n# appendfsync always    - \u6BCF\u4E2A\u5199\u547D\u4EE4\u90FD\u540C\u6B65\uFF0C\u6700\u5B89\u5168\u4F46\u6027\u80FD\u6700\u4F4E\n# appendfsync everysec  - \u6BCF\u79D2\u540C\u6B65\u4E00\u6B21\uFF0C\u5E73\u8861\u5B89\u5168\u6027\u548C\u6027\u80FD\uFF08\u63A8\u8350\uFF09\n# appendfsync no        - \u7531OS\u51B3\u5B9A\u540C\u6B65\u65F6\u673A\uFF0C\u6027\u80FD\u6700\u9AD8\u4F46\u53EF\u80FD\u4E22\u5931\u6570\u636E\n\n# AOF\u91CD\u5199\u4F18\u5316\u914D\u7F6E\nauto-aof-rewrite-percentage 100       # AOF\u6587\u4EF6\u589E\u957F100%\u65F6\u91CD\u5199\nauto-aof-rewrite-min-size 64mb        # AOF\u6587\u4EF6\u6700\u5C0F64MB\u65F6\u624D\u91CD\u5199\naof-rewrite-incremental-fsync yes     # \u91CD\u5199\u65F6\u589E\u91CF\u540C\u6B65\naof-load-truncated yes                # \u52A0\u8F7D\u622A\u65AD\u7684AOF\u6587\u4EF6\n\n# \u6DF7\u5408\u6301\u4E45\u5316\uFF08\u63A8\u8350\uFF09\naof-use-rdb-preamble yes              # AOF\u91CD\u5199\u65F6\u4F7F\u7528RDB\u683C\u5F0F\n\n# \u76D1\u63A7AOF\u6027\u80FD\nredis-cli INFO persistence\n# aof_enabled:1                        # AOF\u662F\u5426\u542F\u7528\n# aof_rewrite_in_progress:0            # \u662F\u5426\u6B63\u5728\u91CD\u5199\n# aof_rewrite_scheduled:0              # \u662F\u5426\u8BA1\u5212\u91CD\u5199\n# aof_last_rewrite_time_sec:3          # \u6700\u540E\u91CD\u5199\u8017\u65F6\n# aof_current_rewrite_time_sec:-1      # \u5F53\u524D\u91CD\u5199\u8017\u65F6\n# aof_last_bgrewrite_status:ok         # \u6700\u540E\u91CD\u5199\u72B6\u6001\n# aof_current_size:1024000             # \u5F53\u524DAOF\u6587\u4EF6\u5927\u5C0F\n# aof_base_size:512000                 # \u57FA\u7840AOF\u6587\u4EF6\u5927\u5C0F\n'})})}),(0,i.jsx)(a.A,{value:"persistence-monitoring",label:"\u6301\u4E45\u5316\u76D1\u63A7",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="\u6301\u4E45\u5316\u6027\u80FD\u76D1\u63A7"',children:'@Component\npublic class RedisPersistenceMonitor {\n    \n    @Autowired\n    private RedisTemplate<String, Object> redisTemplate;\n    \n    private static final Logger logger = LoggerFactory.getLogger(RedisPersistenceMonitor.class);\n    \n    /**\n     * \u76D1\u63A7\u6301\u4E45\u5316\u72B6\u6001\n     */\n    @Scheduled(fixedRate = 300000) // \u6BCF5\u5206\u949F\u68C0\u67E5\u4E00\u6B21\n    public void monitorPersistence() {\n        Map<String, Object> persistenceInfo = getPersistenceInfo();\n        \n        // \u68C0\u67E5RDB\u72B6\u6001\n        checkRdbStatus(persistenceInfo);\n        \n        // \u68C0\u67E5AOF\u72B6\u6001\n        checkAofStatus(persistenceInfo);\n        \n        // \u68C0\u67E5\u6301\u4E45\u5316\u6027\u80FD\n        checkPersistencePerformance(persistenceInfo);\n    }\n    \n    private Map<String, Object> getPersistenceInfo() {\n        return redisTemplate.execute((RedisCallback<Map<String, Object>>) connection -> {\n            Properties info = connection.info("persistence");\n            Map<String, Object> result = new HashMap<>();\n            \n            for (String key : info.stringPropertyNames()) {\n                result.put(key, info.getProperty(key));\n            }\n            \n            return result;\n        });\n    }\n    \n    private void checkRdbStatus(Map<String, Object> info) {\n        String rdbStatus = (String) info.get("rdb_last_bgsave_status");\n        if (!"ok".equals(rdbStatus)) {\n            logger.error("RDB\u6301\u4E45\u5316\u72B6\u6001\u5F02\u5E38: {}", rdbStatus);\n            sendAlert("RDB\u6301\u4E45\u5316\u544A\u8B66", "RDB\u72B6\u6001: " + rdbStatus);\n        }\n        \n        // \u68C0\u67E5RDB\u8017\u65F6\n        String rdbTimeStr = (String) info.get("rdb_last_bgsave_time_sec");\n        if (rdbTimeStr != null && !"-1".equals(rdbTimeStr)) {\n            int rdbTime = Integer.parseInt(rdbTimeStr);\n            if (rdbTime > 60) { // \u8D85\u8FC760\u79D2\n                logger.warn("RDB\u6301\u4E45\u5316\u8017\u65F6\u8FC7\u957F: {}\u79D2", rdbTime);\n            }\n        }\n    }\n    \n    private void checkAofStatus(Map<String, Object> info) {\n        String aofEnabled = (String) info.get("aof_enabled");\n        if ("1".equals(aofEnabled)) {\n            String aofStatus = (String) info.get("aof_last_bgrewrite_status");\n            if (!"ok".equals(aofStatus)) {\n                logger.error("AOF\u91CD\u5199\u72B6\u6001\u5F02\u5E38: {}", aofStatus);\n                sendAlert("AOF\u6301\u4E45\u5316\u544A\u8B66", "AOF\u91CD\u5199\u72B6\u6001: " + aofStatus);\n            }\n            \n            // \u68C0\u67E5AOF\u6587\u4EF6\u5927\u5C0F\u589E\u957F\n            String currentSizeStr = (String) info.get("aof_current_size");\n            String baseSizeStr = (String) info.get("aof_base_size");\n            \n            if (currentSizeStr != null && baseSizeStr != null) {\n                long currentSize = Long.parseLong(currentSizeStr);\n                long baseSize = Long.parseLong(baseSizeStr);\n                \n                if (baseSize > 0) {\n                    double growthRatio = (double) (currentSize - baseSize) / baseSize * 100;\n                    if (growthRatio > 200) { // \u589E\u957F\u8D85\u8FC7200%\n                        logger.warn("AOF\u6587\u4EF6\u589E\u957F\u8FC7\u5FEB: {}%", String.format("%.2f", growthRatio));\n                    }\n                }\n            }\n        }\n    }\n    \n    private void checkPersistencePerformance(Map<String, Object> info) {\n        // \u68C0\u67E5\u662F\u5426\u6709\u6301\u4E45\u5316\u64CD\u4F5C\u6B63\u5728\u8FDB\u884C\n        String rdbInProgress = (String) info.get("rdb_bgsave_in_progress");\n        String aofInProgress = (String) info.get("aof_rewrite_in_progress");\n        \n        if ("1".equals(rdbInProgress)) {\n            logger.info("RDB\u6301\u4E45\u5316\u6B63\u5728\u8FDB\u884C\u4E2D");\n        }\n        \n        if ("1".equals(aofInProgress)) {\n            logger.info("AOF\u91CD\u5199\u6B63\u5728\u8FDB\u884C\u4E2D");\n            \n            String rewriteTimeStr = (String) info.get("aof_current_rewrite_time_sec");\n            if (rewriteTimeStr != null && !"-1".equals(rewriteTimeStr)) {\n                int rewriteTime = Integer.parseInt(rewriteTimeStr);\n                if (rewriteTime > 300) { // \u8D85\u8FC75\u5206\u949F\n                    logger.warn("AOF\u91CD\u5199\u8017\u65F6\u8FC7\u957F: {}\u79D2", rewriteTime);\n                }\n            }\n        }\n    }\n    \n    /**\n     * \u624B\u52A8\u89E6\u53D1\u6301\u4E45\u5316\u64CD\u4F5C\n     */\n    public void triggerPersistence(String type) {\n        redisTemplate.execute((RedisCallback<Object>) connection -> {\n            switch (type.toLowerCase()) {\n                case "rdb":\n                    connection.bgSave();\n                    logger.info("\u624B\u52A8\u89E6\u53D1RDB\u6301\u4E45\u5316");\n                    break;\n                case "aof":\n                    connection.bgReWriteAof();\n                    logger.info("\u624B\u52A8\u89E6\u53D1AOF\u91CD\u5199");\n                    break;\n                default:\n                    logger.warn("\u672A\u77E5\u7684\u6301\u4E45\u5316\u7C7B\u578B: {}", type);\n            }\n            return null;\n        });\n    }\n    \n    /**\n     * \u83B7\u53D6\u6301\u4E45\u5316\u6027\u80FD\u7EDF\u8BA1\n     */\n    public Map<String, Object> getPersistenceStats() {\n        Map<String, Object> info = getPersistenceInfo();\n        Map<String, Object> stats = new HashMap<>();\n        \n        // RDB\u7EDF\u8BA1\n        stats.put("rdb_last_save_time", info.get("rdb_last_save_time"));\n        stats.put("rdb_changes_since_last_save", info.get("rdb_changes_since_last_save"));\n        stats.put("rdb_last_bgsave_time_sec", info.get("rdb_last_bgsave_time_sec"));\n        \n        // AOF\u7EDF\u8BA1\n        if ("1".equals(info.get("aof_enabled"))) {\n            stats.put("aof_current_size", info.get("aof_current_size"));\n            stats.put("aof_base_size", info.get("aof_base_size"));\n            stats.put("aof_last_rewrite_time_sec", info.get("aof_last_rewrite_time_sec"));\n        }\n        \n        return stats;\n    }\n    \n    private void sendAlert(String title, String message) {\n        // \u5B9E\u73B0\u544A\u8B66\u901A\u77E5\u903B\u8F91\n        logger.error("\u544A\u8B66: {} - {}", title, message);\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(n.h2,{id:"6-redis\u5B9E\u6218\u5E94\u7528\u573A\u666F",children:"6. Redis\u5B9E\u6218\u5E94\u7528\u573A\u666F"}),"\n",(0,i.jsx)(n.p,{children:"Redis\u5728\u5B9E\u9645\u9879\u76EE\u4E2D\u6709\u7740\u5E7F\u6CDB\u7684\u5E94\u7528\u573A\u666F\uFF0C\u4EE5\u4E0B\u662F\u4E00\u4E9B\u5178\u578B\u7684\u5B9E\u6218\u6848\u4F8B\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"61-\u7F13\u5B58\u7CFB\u7EDF\u8BBE\u8BA1",children:"6.1 \u7F13\u5B58\u7CFB\u7EDF\u8BBE\u8BA1"}),"\n",(0,i.jsx)(n.p,{children:"\u7F13\u5B58\u662FRedis\u6700\u5E38\u89C1\u7684\u5E94\u7528\u573A\u666F\uFF0C\u5408\u7406\u7684\u7F13\u5B58\u7B56\u7565\u53EF\u4EE5\u663E\u8457\u63D0\u5347\u7CFB\u7EDF\u6027\u80FD\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"cache-patterns",label:"\u7F13\u5B58\u6A21\u5F0F",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="\u7F13\u5B58\u6A21\u5F0F\u5B9E\u73B0"',children:'@Service\npublic class CacheService {\n    \n    @Autowired\n    private RedisTemplate<String, Object> redisTemplate;\n    \n    @Autowired\n    private UserRepository userRepository;\n    \n    /**\n     * Cache-Aside\u6A21\u5F0F\uFF08\u65C1\u8DEF\u7F13\u5B58\uFF09\n     * \u5E94\u7528\u7A0B\u5E8F\u76F4\u63A5\u7BA1\u7406\u7F13\u5B58\n     */\n    public User getUserCacheAside(Long userId) {\n        String cacheKey = "user:cache:" + userId;\n        \n        // 1. \u5148\u67E5\u7F13\u5B58\n        User user = (User) redisTemplate.opsForValue().get(cacheKey);\n        if (user != null) {\n            return user;\n        }\n        \n        // 2. \u7F13\u5B58\u672A\u547D\u4E2D\uFF0C\u67E5\u6570\u636E\u5E93\n        user = userRepository.findById(userId).orElse(null);\n        if (user != null) {\n            // 3. \u5199\u5165\u7F13\u5B58\uFF0C\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\n            redisTemplate.opsForValue().set(cacheKey, user, 1, TimeUnit.HOURS);\n        }\n        \n        return user;\n    }\n    \n    /**\n     * Write-Through\u6A21\u5F0F\uFF08\u5199\u7A7F\u900F\uFF09\n     * \u5199\u64CD\u4F5C\u540C\u65F6\u66F4\u65B0\u7F13\u5B58\u548C\u6570\u636E\u5E93\n     */\n    public void updateUserWriteThrough(User user) {\n        String cacheKey = "user:cache:" + user.getId();\n        \n        // 1. \u66F4\u65B0\u6570\u636E\u5E93\n        userRepository.save(user);\n        \n        // 2. \u66F4\u65B0\u7F13\u5B58\n        redisTemplate.opsForValue().set(cacheKey, user, 1, TimeUnit.HOURS);\n    }\n    \n    /**\n     * Write-Behind\u6A21\u5F0F\uFF08\u5199\u56DE\uFF09\n     * \u5148\u66F4\u65B0\u7F13\u5B58\uFF0C\u5F02\u6B65\u66F4\u65B0\u6570\u636E\u5E93\n     */\n    public void updateUserWriteBehind(User user) {\n        String cacheKey = "user:cache:" + user.getId();\n        \n        // 1. \u7ACB\u5373\u66F4\u65B0\u7F13\u5B58\n        redisTemplate.opsForValue().set(cacheKey, user, 1, TimeUnit.HOURS);\n        \n        // 2. \u5F02\u6B65\u66F4\u65B0\u6570\u636E\u5E93\n        CompletableFuture.runAsync(() -> {\n            try {\n                Thread.sleep(100); // \u6A21\u62DF\u5EF6\u8FDF\n                userRepository.save(user);\n            } catch (Exception e) {\n                // \u5904\u7406\u5F02\u5E38\uFF0C\u53EF\u80FD\u9700\u8981\u56DE\u6EDA\u7F13\u5B58\n                redisTemplate.delete(cacheKey);\n                throw new RuntimeException("\u6570\u636E\u5E93\u66F4\u65B0\u5931\u8D25", e);\n            }\n        });\n    }\n    \n    /**\n     * \u7F13\u5B58\u9884\u70ED\n     */\n    @PostConstruct\n    public void warmUpCache() {\n        // \u9884\u52A0\u8F7D\u70ED\u70B9\u6570\u636E\n        List<User> hotUsers = userRepository.findHotUsers();\n        for (User user : hotUsers) {\n            String cacheKey = "user:cache:" + user.getId();\n            redisTemplate.opsForValue().set(cacheKey, user, 2, TimeUnit.HOURS);\n        }\n    }\n    \n    /**\n     * \u7F13\u5B58\u7A7F\u900F\u9632\u62A4 - \u5E03\u9686\u8FC7\u6EE4\u5668\n     */\n    public User getUserWithBloomFilter(Long userId) {\n        // 1. \u5E03\u9686\u8FC7\u6EE4\u5668\u68C0\u67E5\n        if (!bloomFilterContains("user:bloom", userId.toString())) {\n            return null; // \u786E\u5B9A\u4E0D\u5B58\u5728\n        }\n        \n        // 2. \u67E5\u7F13\u5B58\n        String cacheKey = "user:cache:" + userId;\n        User user = (User) redisTemplate.opsForValue().get(cacheKey);\n        if (user != null) {\n            return user;\n        }\n        \n        // 3. \u67E5\u6570\u636E\u5E93\n        user = userRepository.findById(userId).orElse(null);\n        if (user != null) {\n            redisTemplate.opsForValue().set(cacheKey, user, 1, TimeUnit.HOURS);\n        } else {\n            // \u7F13\u5B58\u7A7A\u503C\uFF0C\u9632\u6B62\u7F13\u5B58\u7A7F\u900F\n            redisTemplate.opsForValue().set(cacheKey, "NULL", 5, TimeUnit.MINUTES);\n        }\n        \n        return user;\n    }\n    \n    /**\n     * \u7F13\u5B58\u51FB\u7A7F\u9632\u62A4 - \u5206\u5E03\u5F0F\u9501\n     */\n    public User getUserWithLock(Long userId) {\n        String cacheKey = "user:cache:" + userId;\n        String lockKey = "user:lock:" + userId;\n        \n        // 1. \u67E5\u7F13\u5B58\n        User user = (User) redisTemplate.opsForValue().get(cacheKey);\n        if (user != null) {\n            return user;\n        }\n        \n        // 2. \u83B7\u53D6\u5206\u5E03\u5F0F\u9501\n        String lockValue = UUID.randomUUID().toString();\n        Boolean lockAcquired = redisTemplate.opsForValue()\n            .setIfAbsent(lockKey, lockValue, 10, TimeUnit.SECONDS);\n        \n        if (Boolean.TRUE.equals(lockAcquired)) {\n            try {\n                // 3. \u53CC\u91CD\u68C0\u67E5\n                user = (User) redisTemplate.opsForValue().get(cacheKey);\n                if (user != null) {\n                    return user;\n                }\n                \n                // 4. \u67E5\u6570\u636E\u5E93\n                user = userRepository.findById(userId).orElse(null);\n                if (user != null) {\n                    redisTemplate.opsForValue().set(cacheKey, user, 1, TimeUnit.HOURS);\n                }\n                \n                return user;\n            } finally {\n                // 5. \u91CA\u653E\u9501\n                releaseLock(lockKey, lockValue);\n            }\n        } else {\n            // \u7B49\u5F85\u5176\u4ED6\u7EBF\u7A0B\u52A0\u8F7D\u6570\u636E\n            try {\n                Thread.sleep(100);\n                return getUserWithLock(userId); // \u9012\u5F52\u91CD\u8BD5\n            } catch (InterruptedException e) {\n                Thread.currentThread().interrupt();\n                return null;\n            }\n        }\n    }\n    \n    private boolean bloomFilterContains(String filterKey, String value) {\n        // \u7B80\u5316\u7684\u5E03\u9686\u8FC7\u6EE4\u5668\u5B9E\u73B0\n        // \u5B9E\u9645\u9879\u76EE\u4E2D\u5EFA\u8BAE\u4F7F\u7528Redisson\u7684\u5E03\u9686\u8FC7\u6EE4\u5668\n        return true; // \u5047\u8BBE\u5B58\u5728\n    }\n    \n    private void releaseLock(String lockKey, String lockValue) {\n        String script = \n            "if redis.call(\'get\', KEYS[1]) == ARGV[1] then " +\n            "return redis.call(\'del\', KEYS[1]) " +\n            "else return 0 end";\n        \n        redisTemplate.execute(\n            new DefaultRedisScript<>(script, Long.class),\n            Collections.singletonList(lockKey),\n            lockValue\n        );\n    }\n}\n'})})}),(0,i.jsx)(a.A,{value:"cache-strategy",label:"\u7F13\u5B58\u7B56\u7565",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="\u591A\u7EA7\u7F13\u5B58\u7B56\u7565"',children:'@Service\npublic class MultiLevelCacheService {\n    \n    @Autowired\n    private RedisTemplate<String, Object> redisTemplate;\n    \n    // \u672C\u5730\u7F13\u5B58\n    private final Cache<String, Object> localCache = Caffeine.newBuilder()\n        .maximumSize(1000)\n        .expireAfterWrite(5, TimeUnit.MINUTES)\n        .build();\n    \n    /**\n     * \u591A\u7EA7\u7F13\u5B58\u67E5\u8BE2\n     * L1: \u672C\u5730\u7F13\u5B58 -> L2: Redis\u7F13\u5B58 -> L3: \u6570\u636E\u5E93\n     */\n    public Object getWithMultiLevelCache(String key, Supplier<Object> dataLoader) {\n        // L1: \u672C\u5730\u7F13\u5B58\n        Object value = localCache.getIfPresent(key);\n        if (value != null) {\n            return value;\n        }\n        \n        // L2: Redis\u7F13\u5B58\n        value = redisTemplate.opsForValue().get(key);\n        if (value != null) {\n            localCache.put(key, value);\n            return value;\n        }\n        \n        // L3: \u6570\u636E\u5E93\n        value = dataLoader.get();\n        if (value != null) {\n            // \u5199\u5165Redis\u7F13\u5B58\n            redisTemplate.opsForValue().set(key, value, 1, TimeUnit.HOURS);\n            // \u5199\u5165\u672C\u5730\u7F13\u5B58\n            localCache.put(key, value);\n        }\n        \n        return value;\n    }\n    \n    /**\n     * \u7F13\u5B58\u66F4\u65B0\u7B56\u7565\n     */\n    public void updateCache(String key, Object value) {\n        // 1. \u5220\u9664\u672C\u5730\u7F13\u5B58\n        localCache.invalidate(key);\n        \n        // 2. \u66F4\u65B0Redis\u7F13\u5B58\n        redisTemplate.opsForValue().set(key, value, 1, TimeUnit.HOURS);\n        \n        // 3. \u901A\u77E5\u5176\u4ED6\u8282\u70B9\u5220\u9664\u672C\u5730\u7F13\u5B58\n        redisTemplate.convertAndSend("cache:invalidate", key);\n    }\n    \n    /**\n     * \u7F13\u5B58\u5931\u6548\u76D1\u542C\n     */\n    @EventListener\n    public void handleCacheInvalidate(String key) {\n        localCache.invalidate(key);\n    }\n}\n\n// \u7F13\u5B58\u6CE8\u89E3\u5B9E\u73B0\n@Component\n@Aspect\npublic class CacheAspect {\n    \n    @Autowired\n    private RedisTemplate<String, Object> redisTemplate;\n    \n    @Around("@annotation(cacheable)")\n    public Object cache(ProceedingJoinPoint joinPoint, Cacheable cacheable) throws Throwable {\n        String key = generateKey(joinPoint, cacheable.key());\n        \n        // \u67E5\u7F13\u5B58\n        Object cachedValue = redisTemplate.opsForValue().get(key);\n        if (cachedValue != null) {\n            return cachedValue;\n        }\n        \n        // \u6267\u884C\u65B9\u6CD5\n        Object result = joinPoint.proceed();\n        \n        // \u5199\u7F13\u5B58\n        if (result != null) {\n            redisTemplate.opsForValue().set(key, result, \n                cacheable.expire(), TimeUnit.SECONDS);\n        }\n        \n        return result;\n    }\n    \n    private String generateKey(ProceedingJoinPoint joinPoint, String keyExpression) {\n        // \u7B80\u5316\u7684key\u751F\u6210\u903B\u8F91\n        return joinPoint.getSignature().getName() + ":" + \n               Arrays.toString(joinPoint.getArgs());\n    }\n}\n\n// \u81EA\u5B9A\u4E49\u7F13\u5B58\u6CE8\u89E3\n@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface Cacheable {\n    String key() default "";\n    int expire() default 3600;\n}\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"62-\u5206\u5E03\u5F0F\u9501\u5B9E\u73B0",children:"6.2 \u5206\u5E03\u5F0F\u9501\u5B9E\u73B0"}),"\n",(0,i.jsx)(n.p,{children:"\u5206\u5E03\u5F0F\u9501\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u91CD\u8981\u7EC4\u4EF6\uFF0CRedis\u63D0\u4F9B\u4E86\u7B80\u5355\u9AD8\u6548\u7684\u5B9E\u73B0\u65B9\u6848\u3002"}),"\n",(0,i.jsx)(l.A,{children:(0,i.jsx)(a.A,{value:"distributed-lock",label:"\u5206\u5E03\u5F0F\u9501",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="Redis\u5206\u5E03\u5F0F\u9501\u5B9E\u73B0"',children:'@Component\npublic class RedisDistributedLock {\n    \n    @Autowired\n    private RedisTemplate<String, String> redisTemplate;\n    \n    private static final String LOCK_PREFIX = "distributed:lock:";\n    private static final String UNLOCK_SCRIPT = \n        "if redis.call(\'get\', KEYS[1]) == ARGV[1] then " +\n        "return redis.call(\'del\', KEYS[1]) " +\n        "else return 0 end";\n    \n    /**\n     * \u5C1D\u8BD5\u83B7\u53D6\u9501\n     */\n    public boolean tryLock(String lockKey, String lockValue, long expireTime, TimeUnit timeUnit) {\n        String key = LOCK_PREFIX + lockKey;\n        Boolean result = redisTemplate.opsForValue()\n            .setIfAbsent(key, lockValue, expireTime, timeUnit);\n        return Boolean.TRUE.equals(result);\n    }\n    \n    /**\n     * \u91CA\u653E\u9501\n     */\n    public boolean releaseLock(String lockKey, String lockValue) {\n        String key = LOCK_PREFIX + lockKey;\n        Long result = redisTemplate.execute(\n            new DefaultRedisScript<>(UNLOCK_SCRIPT, Long.class),\n            Collections.singletonList(key),\n            lockValue\n        );\n        return Long.valueOf(1).equals(result);\n    }\n    \n    /**\n     * \u53EF\u91CD\u5165\u9501\u5B9E\u73B0\n     */\n    private static final String REENTRANT_LOCK_SCRIPT = \n        "local key = KEYS[1] " +\n        "local value = ARGV[1] " +\n        "local expire = ARGV[2] " +\n        "local current = redis.call(\'HGET\', key, \'owner\') " +\n        "if current == false then " +\n        "    redis.call(\'HSET\', key, \'owner\', value) " +\n        "    redis.call(\'HSET\', key, \'count\', 1) " +\n        "    redis.call(\'EXPIRE\', key, expire) " +\n        "    return 1 " +\n        "elseif current == value then " +\n        "    local count = redis.call(\'HINCRBY\', key, \'count\', 1) " +\n        "    redis.call(\'EXPIRE\', key, expire) " +\n        "    return 1 " +\n        "else " +\n        "    return 0 " +\n        "end";\n    \n    private static final String REENTRANT_UNLOCK_SCRIPT = \n        "local key = KEYS[1] " +\n        "local value = ARGV[1] " +\n        "local current = redis.call(\'HGET\', key, \'owner\') " +\n        "if current == value then " +\n        "    local count = redis.call(\'HINCRBY\', key, \'count\', -1) " +\n        "    if count == 0 then " +\n        "        redis.call(\'DEL\', key) " +\n        "        return 1 " +\n        "    else " +\n        "        return 1 " +\n        "    end " +\n        "else " +\n        "    return 0 " +\n        "end";\n    \n    /**\n     * \u53EF\u91CD\u5165\u9501 - \u83B7\u53D6\u9501\n     */\n    public boolean tryReentrantLock(String lockKey, String lockValue, long expireTime) {\n        String key = LOCK_PREFIX + lockKey;\n        Long result = redisTemplate.execute(\n            new DefaultRedisScript<>(REENTRANT_LOCK_SCRIPT, Long.class),\n            Collections.singletonList(key),\n            lockValue,\n            String.valueOf(expireTime)\n        );\n        return Long.valueOf(1).equals(result);\n    }\n    \n    /**\n     * \u53EF\u91CD\u5165\u9501 - \u91CA\u653E\u9501\n     */\n    public boolean releaseReentrantLock(String lockKey, String lockValue) {\n        String key = LOCK_PREFIX + lockKey;\n        Long result = redisTemplate.execute(\n            new DefaultRedisScript<>(REENTRANT_UNLOCK_SCRIPT, Long.class),\n            Collections.singletonList(key),\n            lockValue\n        );\n        return Long.valueOf(1).equals(result);\n    }\n}\n\n// \u5206\u5E03\u5F0F\u9501\u6CE8\u89E3\n@Component\n@Aspect\npublic class DistributedLockAspect {\n    \n    @Autowired\n    private RedisDistributedLock distributedLock;\n    \n    @Around("@annotation(lockAnnotation)")\n    public Object around(ProceedingJoinPoint joinPoint, DistributedLock lockAnnotation) throws Throwable {\n        String lockKey = generateLockKey(joinPoint, lockAnnotation.key());\n        String lockValue = UUID.randomUUID().toString();\n        \n        boolean acquired = distributedLock.tryLock(\n            lockKey, \n            lockValue, \n            lockAnnotation.expireTime(), \n            lockAnnotation.timeUnit()\n        );\n        \n        if (!acquired) {\n            if (lockAnnotation.waitTime() > 0) {\n                // \u7B49\u5F85\u83B7\u53D6\u9501\n                return waitAndRetry(joinPoint, lockAnnotation, lockKey, lockValue);\n            } else {\n                throw new RuntimeException("\u83B7\u53D6\u5206\u5E03\u5F0F\u9501\u5931\u8D25: " + lockKey);\n            }\n        }\n        \n        try {\n            return joinPoint.proceed();\n        } finally {\n            distributedLock.releaseLock(lockKey, lockValue);\n        }\n    }\n    \n    private Object waitAndRetry(ProceedingJoinPoint joinPoint, DistributedLock lockAnnotation, \n                               String lockKey, String lockValue) throws Throwable {\n        long waitTime = lockAnnotation.waitTime();\n        long startTime = System.currentTimeMillis();\n        \n        while (System.currentTimeMillis() - startTime < waitTime) {\n            boolean acquired = distributedLock.tryLock(\n                lockKey, \n                lockValue, \n                lockAnnotation.expireTime(), \n                lockAnnotation.timeUnit()\n            );\n            \n            if (acquired) {\n                try {\n                    return joinPoint.proceed();\n                } finally {\n                    distributedLock.releaseLock(lockKey, lockValue);\n                }\n            }\n            \n            try {\n                Thread.sleep(100); // \u7B49\u5F85100ms\u540E\u91CD\u8BD5\n            } catch (InterruptedException e) {\n                Thread.currentThread().interrupt();\n                throw new RuntimeException("\u7B49\u5F85\u9501\u88AB\u4E2D\u65AD", e);\n            }\n        }\n        \n        throw new RuntimeException("\u7B49\u5F85\u5206\u5E03\u5F0F\u9501\u8D85\u65F6: " + lockKey);\n    }\n    \n    private String generateLockKey(ProceedingJoinPoint joinPoint, String keyExpression) {\n        if (keyExpression.isEmpty()) {\n            return joinPoint.getSignature().toShortString();\n        }\n        \n        // \u7B80\u5316\u7684SpEL\u8868\u8FBE\u5F0F\u89E3\u6790\n        Object[] args = joinPoint.getArgs();\n        return keyExpression.replace("#args[0]", String.valueOf(args[0]));\n    }\n}\n\n// \u5206\u5E03\u5F0F\u9501\u6CE8\u89E3\u5B9A\u4E49\n@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface DistributedLock {\n    String key() default "";\n    long expireTime() default 30;\n    TimeUnit timeUnit() default TimeUnit.SECONDS;\n    long waitTime() default 0;\n}\n\n// \u4F7F\u7528\u793A\u4F8B\n@Service\npublic class OrderService {\n    \n    @DistributedLock(key = "order:create:#args[0]", expireTime = 10, waitTime = 5000)\n    public void createOrder(String userId, OrderRequest request) {\n        // \u521B\u5EFA\u8BA2\u5355\u7684\u4E1A\u52A1\u903B\u8F91\n        // \u540C\u4E00\u7528\u6237\u540C\u65F6\u53EA\u80FD\u521B\u5EFA\u4E00\u4E2A\u8BA2\u5355\n    }\n    \n    @DistributedLock(key = "inventory:reduce:#args[0]", expireTime = 30)\n    public void reduceInventory(String productId, int quantity) {\n        // \u51CF\u5E93\u5B58\u7684\u4E1A\u52A1\u903B\u8F91\n        // \u540C\u4E00\u5546\u54C1\u7684\u5E93\u5B58\u64CD\u4F5C\u9700\u8981\u4E32\u884C\u5316\n    }\n}\n'})})})}),"\n",(0,i.jsx)(n.h3,{id:"63-\u9650\u6D41\u5668\u5B9E\u73B0",children:"6.3 \u9650\u6D41\u5668\u5B9E\u73B0"}),"\n",(0,i.jsx)(n.p,{children:"\u9650\u6D41\u662F\u4FDD\u62A4\u7CFB\u7EDF\u7A33\u5B9A\u6027\u7684\u91CD\u8981\u624B\u6BB5\uFF0CRedis\u63D0\u4F9B\u4E86\u591A\u79CD\u9650\u6D41\u7B97\u6CD5\u7684\u5B9E\u73B0\u65B9\u6848\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"rate-limiter",label:"\u9650\u6D41\u7B97\u6CD5",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="Redis\u9650\u6D41\u5668\u5B9E\u73B0"',children:'@Component\npublic class RedisRateLimiter {\n    \n    @Autowired\n    private RedisTemplate<String, String> redisTemplate;\n    \n    /**\n     * \u56FA\u5B9A\u7A97\u53E3\u9650\u6D41\n     */\n    private static final String FIXED_WINDOW_SCRIPT = \n        "local key = KEYS[1] " +\n        "local window = tonumber(ARGV[1]) " +\n        "local limit = tonumber(ARGV[2]) " +\n        "local current = redis.call(\'INCR\', key) " +\n        "if current == 1 then " +\n        "    redis.call(\'EXPIRE\', key, window) " +\n        "end " +\n        "if current <= limit then " +\n        "    return {1, current, limit - current} " +\n        "else " +\n        "    return {0, current, 0} " +\n        "end";\n    \n    public RateLimitResult fixedWindowLimit(String key, int windowSeconds, int limit) {\n        List<Long> result = redisTemplate.execute(\n            new DefaultRedisScript<>(FIXED_WINDOW_SCRIPT, List.class),\n            Collections.singletonList("rate_limit:fixed:" + key),\n            String.valueOf(windowSeconds),\n            String.valueOf(limit)\n        );\n        \n        return new RateLimitResult(\n            result.get(0) == 1,\n            result.get(1).intValue(),\n            result.get(2).intValue()\n        );\n    }\n    \n    /**\n     * \u6ED1\u52A8\u7A97\u53E3\u9650\u6D41\n     */\n    private static final String SLIDING_WINDOW_SCRIPT = \n        "local key = KEYS[1] " +\n        "local window = tonumber(ARGV[1]) " +\n        "local limit = tonumber(ARGV[2]) " +\n        "local now = tonumber(ARGV[3]) " +\n        "local clearBefore = now - window * 1000 " +\n        "redis.call(\'ZREMRANGEBYSCORE\', key, 0, clearBefore) " +\n        "local current = redis.call(\'ZCARD\', key) " +\n        "if current < limit then " +\n        "    redis.call(\'ZADD\', key, now, now) " +\n        "    redis.call(\'EXPIRE\', key, window) " +\n        "    return {1, current + 1, limit - current - 1} " +\n        "else " +\n        "    return {0, current, 0} " +\n        "end";\n    \n    public RateLimitResult slidingWindowLimit(String key, int windowSeconds, int limit) {\n        long now = System.currentTimeMillis();\n        List<Long> result = redisTemplate.execute(\n            new DefaultRedisScript<>(SLIDING_WINDOW_SCRIPT, List.class),\n            Collections.singletonList("rate_limit:sliding:" + key),\n            String.valueOf(windowSeconds),\n            String.valueOf(limit),\n            String.valueOf(now)\n        );\n        \n        return new RateLimitResult(\n            result.get(0) == 1,\n            result.get(1).intValue(),\n            result.get(2).intValue()\n        );\n    }\n    \n    /**\n     * \u4EE4\u724C\u6876\u9650\u6D41\n     */\n    private static final String TOKEN_BUCKET_SCRIPT = \n        "local key = KEYS[1] " +\n        "local capacity = tonumber(ARGV[1]) " +\n        "local tokens = tonumber(ARGV[2]) " +\n        "local interval = tonumber(ARGV[3]) " +\n        "local requested = tonumber(ARGV[4]) " +\n        "local now = tonumber(ARGV[5]) " +\n        \n        "local bucket = redis.call(\'HMGET\', key, \'tokens\', \'last_refill\') " +\n        "local current_tokens = tonumber(bucket[1]) or capacity " +\n        "local last_refill = tonumber(bucket[2]) or now " +\n        \n        "local elapsed = now - last_refill " +\n        "local tokens_to_add = math.floor(elapsed / interval * tokens) " +\n        "current_tokens = math.min(capacity, current_tokens + tokens_to_add) " +\n        \n        "if current_tokens >= requested then " +\n        "    current_tokens = current_tokens - requested " +\n        "    redis.call(\'HMSET\', key, \'tokens\', current_tokens, \'last_refill\', now) " +\n        "    redis.call(\'EXPIRE\', key, 3600) " +\n        "    return {1, current_tokens, requested} " +\n        "else " +\n        "    redis.call(\'HMSET\', key, \'tokens\', current_tokens, \'last_refill\', now) " +\n        "    redis.call(\'EXPIRE\', key, 3600) " +\n        "    return {0, current_tokens, 0} " +\n        "end";\n    \n    public RateLimitResult tokenBucketLimit(String key, int capacity, int tokensPerSecond, int requested) {\n        long now = System.currentTimeMillis();\n        List<Long> result = redisTemplate.execute(\n            new DefaultRedisScript<>(TOKEN_BUCKET_SCRIPT, List.class),\n            Collections.singletonList("rate_limit:token:" + key),\n            String.valueOf(capacity),\n            String.valueOf(tokensPerSecond),\n            String.valueOf(1000), // 1\u79D2\u7684\u6BEB\u79D2\u6570\n            String.valueOf(requested),\n            String.valueOf(now)\n        );\n        \n        return new RateLimitResult(\n            result.get(0) == 1,\n            result.get(1).intValue(),\n            result.get(2).intValue()\n        );\n    }\n    \n    /**\n     * \u6F0F\u6876\u9650\u6D41\n     */\n    private static final String LEAKY_BUCKET_SCRIPT = \n        "local key = KEYS[1] " +\n        "local capacity = tonumber(ARGV[1]) " +\n        "local leak_rate = tonumber(ARGV[2]) " +\n        "local requested = tonumber(ARGV[3]) " +\n        "local now = tonumber(ARGV[4]) " +\n        \n        "local bucket = redis.call(\'HMGET\', key, \'volume\', \'last_leak\') " +\n        "local current_volume = tonumber(bucket[1]) or 0 " +\n        "local last_leak = tonumber(bucket[2]) or now " +\n        \n        "local elapsed = now - last_leak " +\n        "local leaked = math.floor(elapsed / 1000 * leak_rate) " +\n        "current_volume = math.max(0, current_volume - leaked) " +\n        \n        "if current_volume + requested <= capacity then " +\n        "    current_volume = current_volume + requested " +\n        "    redis.call(\'HMSET\', key, \'volume\', current_volume, \'last_leak\', now) " +\n        "    redis.call(\'EXPIRE\', key, 3600) " +\n        "    return {1, current_volume, capacity - current_volume} " +\n        "else " +\n        "    redis.call(\'HMSET\', key, \'volume\', current_volume, \'last_leak\', now) " +\n        "    redis.call(\'EXPIRE\', key, 3600) " +\n        "    return {0, current_volume, capacity - current_volume} " +\n        "end";\n    \n    public RateLimitResult leakyBucketLimit(String key, int capacity, int leakRate, int requested) {\n        long now = System.currentTimeMillis();\n        List<Long> result = redisTemplate.execute(\n            new DefaultRedisScript<>(LEAKY_BUCKET_SCRIPT, List.class),\n            Collections.singletonList("rate_limit:leaky:" + key),\n            String.valueOf(capacity),\n            String.valueOf(leakRate),\n            String.valueOf(requested),\n            String.valueOf(now)\n        );\n        \n        return new RateLimitResult(\n            result.get(0) == 1,\n            result.get(1).intValue(),\n            result.get(2).intValue()\n        );\n    }\n    \n    // \u9650\u6D41\u7ED3\u679C\u7C7B\n    public static class RateLimitResult {\n        private final boolean allowed;\n        private final int current;\n        private final int remaining;\n        \n        public RateLimitResult(boolean allowed, int current, int remaining) {\n            this.allowed = allowed;\n            this.current = current;\n            this.remaining = remaining;\n        }\n        \n        // getters\n        public boolean isAllowed() { return allowed; }\n        public int getCurrent() { return current; }\n        public int getRemaining() { return remaining; }\n    }\n}\n\n// \u9650\u6D41\u6CE8\u89E3\u5B9E\u73B0\n@Component\n@Aspect\npublic class RateLimitAspect {\n    \n    @Autowired\n    private RedisRateLimiter rateLimiter;\n    \n    @Around("@annotation(rateLimit)")\n    public Object around(ProceedingJoinPoint joinPoint, RateLimit rateLimit) throws Throwable {\n        String key = generateKey(joinPoint, rateLimit);\n        \n        RedisRateLimiter.RateLimitResult result;\n        switch (rateLimit.algorithm()) {\n            case FIXED_WINDOW:\n                result = rateLimiter.fixedWindowLimit(key, rateLimit.window(), rateLimit.limit());\n                break;\n            case SLIDING_WINDOW:\n                result = rateLimiter.slidingWindowLimit(key, rateLimit.window(), rateLimit.limit());\n                break;\n            case TOKEN_BUCKET:\n                result = rateLimiter.tokenBucketLimit(key, rateLimit.limit(), rateLimit.tokensPerSecond(), 1);\n                break;\n            case LEAKY_BUCKET:\n                result = rateLimiter.leakyBucketLimit(key, rateLimit.limit(), rateLimit.leakRate(), 1);\n                break;\n            default:\n                result = rateLimiter.fixedWindowLimit(key, rateLimit.window(), rateLimit.limit());\n        }\n        \n        if (!result.isAllowed()) {\n            throw new RateLimitExceededException("\u8BF7\u6C42\u9891\u7387\u8FC7\u9AD8\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");\n        }\n        \n        // \u5728\u54CD\u5E94\u5934\u4E2D\u6DFB\u52A0\u9650\u6D41\u4FE1\u606F\n        HttpServletResponse response = getCurrentResponse();\n        if (response != null) {\n            response.setHeader("X-RateLimit-Limit", String.valueOf(rateLimit.limit()));\n            response.setHeader("X-RateLimit-Remaining", String.valueOf(result.getRemaining()));\n            response.setHeader("X-RateLimit-Reset", String.valueOf(System.currentTimeMillis() + rateLimit.window() * 1000));\n        }\n        \n        return joinPoint.proceed();\n    }\n    \n    private String generateKey(ProceedingJoinPoint joinPoint, RateLimit rateLimit) {\n        String baseKey = rateLimit.key();\n        if (baseKey.isEmpty()) {\n            baseKey = joinPoint.getSignature().toShortString();\n        }\n        \n        // \u6839\u636E\u9650\u6D41\u7EF4\u5EA6\u751F\u6210key\n        switch (rateLimit.dimension()) {\n            case IP:\n                return baseKey + ":" + getCurrentClientIp();\n            case USER:\n                return baseKey + ":" + getCurrentUserId();\n            case GLOBAL:\n                return baseKey;\n            default:\n                return baseKey;\n        }\n    }\n    \n    private String getCurrentClientIp() {\n        HttpServletRequest request = getCurrentRequest();\n        if (request != null) {\n            String xForwardedFor = request.getHeader("X-Forwarded-For");\n            if (xForwardedFor != null && !xForwardedFor.isEmpty()) {\n                return xForwardedFor.split(",")[0].trim();\n            }\n            return request.getRemoteAddr();\n        }\n        return "unknown";\n    }\n    \n    private String getCurrentUserId() {\n        // \u4ECE\u5B89\u5168\u4E0A\u4E0B\u6587\u83B7\u53D6\u7528\u6237ID\n        return "user123"; // \u7B80\u5316\u5B9E\u73B0\n    }\n    \n    private HttpServletRequest getCurrentRequest() {\n        RequestAttributes requestAttributes = RequestContextHolder.getRequestAttributes();\n        if (requestAttributes instanceof ServletRequestAttributes) {\n            return ((ServletRequestAttributes) requestAttributes).getRequest();\n        }\n        return null;\n    }\n    \n    private HttpServletResponse getCurrentResponse() {\n        RequestAttributes requestAttributes = RequestContextHolder.getRequestAttributes();\n        if (requestAttributes instanceof ServletRequestAttributes) {\n            return ((ServletRequestAttributes) requestAttributes).getResponse();\n        }\n        return null;\n    }\n}\n\n// \u9650\u6D41\u6CE8\u89E3\u5B9A\u4E49\n@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface RateLimit {\n    String key() default "";\n    int limit() default 100;\n    int window() default 60;\n    RateLimitAlgorithm algorithm() default RateLimitAlgorithm.FIXED_WINDOW;\n    RateLimitDimension dimension() default RateLimitDimension.IP;\n    int tokensPerSecond() default 10;\n    int leakRate() default 10;\n}\n\n// \u9650\u6D41\u7B97\u6CD5\u679A\u4E3E\npublic enum RateLimitAlgorithm {\n    FIXED_WINDOW,    // \u56FA\u5B9A\u7A97\u53E3\n    SLIDING_WINDOW,  // \u6ED1\u52A8\u7A97\u53E3\n    TOKEN_BUCKET,    // \u4EE4\u724C\u6876\n    LEAKY_BUCKET     // \u6F0F\u6876\n}\n\n// \u9650\u6D41\u7EF4\u5EA6\u679A\u4E3E\npublic enum RateLimitDimension {\n    IP,      // \u6309IP\u9650\u6D41\n    USER,    // \u6309\u7528\u6237\u9650\u6D41\n    GLOBAL   // \u5168\u5C40\u9650\u6D41\n}\n\n// \u9650\u6D41\u5F02\u5E38\npublic class RateLimitExceededException extends RuntimeException {\n    public RateLimitExceededException(String message) {\n        super(message);\n    }\n}\n\n// \u4F7F\u7528\u793A\u4F8B\n@RestController\npublic class ApiController {\n    \n    @GetMapping("/api/data")\n    @RateLimit(key = "api:data", limit = 100, window = 60, algorithm = RateLimitAlgorithm.SLIDING_WINDOW)\n    public ResponseEntity<String> getData() {\n        return ResponseEntity.ok("data");\n    }\n    \n    @PostMapping("/api/upload")\n    @RateLimit(key = "api:upload", limit = 10, window = 60, dimension = RateLimitDimension.USER)\n    public ResponseEntity<String> uploadFile() {\n        return ResponseEntity.ok("uploaded");\n    }\n    \n    @GetMapping("/api/search")\n    @RateLimit(key = "api:search", limit = 1000, tokensPerSecond = 50, algorithm = RateLimitAlgorithm.TOKEN_BUCKET)\n    public ResponseEntity<String> search() {\n        return ResponseEntity.ok("search results");\n    }\n}\n'})})}),(0,i.jsxs)(a.A,{value:"rate-limit-comparison",label:"\u9650\u6D41\u7B97\u6CD5\u5BF9\u6BD4",children:[(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="\u9650\u6D41\u7B97\u6CD5\u6027\u80FD\u5BF9\u6BD4"',children:'@Component\npublic class RateLimitPerformanceTest {\n    \n    @Autowired\n    private RedisRateLimiter rateLimiter;\n    \n    /**\n     * \u9650\u6D41\u7B97\u6CD5\u6027\u80FD\u6D4B\u8BD5\n     */\n    public void performanceTest() {\n        int testCount = 10000;\n        String testKey = "performance_test";\n        \n        // \u56FA\u5B9A\u7A97\u53E3\u6D4B\u8BD5\n        long start1 = System.currentTimeMillis();\n        for (int i = 0; i < testCount; i++) {\n            rateLimiter.fixedWindowLimit(testKey + "_fixed", 60, 1000);\n        }\n        long time1 = System.currentTimeMillis() - start1;\n        \n        // \u6ED1\u52A8\u7A97\u53E3\u6D4B\u8BD5\n        long start2 = System.currentTimeMillis();\n        for (int i = 0; i < testCount; i++) {\n            rateLimiter.slidingWindowLimit(testKey + "_sliding", 60, 1000);\n        }\n        long time2 = System.currentTimeMillis() - start2;\n        \n        // \u4EE4\u724C\u6876\u6D4B\u8BD5\n        long start3 = System.currentTimeMillis();\n        for (int i = 0; i < testCount; i++) {\n            rateLimiter.tokenBucketLimit(testKey + "_token", 1000, 100, 1);\n        }\n        long time3 = System.currentTimeMillis() - start3;\n        \n        // \u6F0F\u6876\u6D4B\u8BD5\n        long start4 = System.currentTimeMillis();\n        for (int i = 0; i < testCount; i++) {\n            rateLimiter.leakyBucketLimit(testKey + "_leaky", 1000, 100, 1);\n        }\n        long time4 = System.currentTimeMillis() - start4;\n        \n        System.out.println("\u9650\u6D41\u7B97\u6CD5\u6027\u80FD\u6D4B\u8BD5\u7ED3\u679C\uFF08" + testCount + "\u6B21\u8BF7\u6C42\uFF09\uFF1A");\n        System.out.println("\u56FA\u5B9A\u7A97\u53E3: " + time1 + "ms");\n        System.out.println("\u6ED1\u52A8\u7A97\u53E3: " + time2 + "ms");\n        System.out.println("\u4EE4\u724C\u6876: " + time3 + "ms");\n        System.out.println("\u6F0F\u6876: " + time4 + "ms");\n    }\n}\n'})}),(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u7B97\u6CD5"}),(0,i.jsx)(n.th,{children:"\u4F18\u70B9"}),(0,i.jsx)(n.th,{children:"\u7F3A\u70B9"}),(0,i.jsx)(n.th,{children:"\u9002\u7528\u573A\u666F"}),(0,i.jsx)(n.th,{children:"\u6027\u80FD"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u56FA\u5B9A\u7A97\u53E3"})}),(0,i.jsx)(n.td,{children:"\u5B9E\u73B0\u7B80\u5355\uFF0C\u6027\u80FD\u6700\u9AD8"}),(0,i.jsx)(n.td,{children:"\u8FB9\u754C\u7A81\u523A\u95EE\u9898"}),(0,i.jsx)(n.td,{children:"\u7C97\u7C92\u5EA6\u9650\u6D41"}),(0,i.jsx)(n.td,{children:"\u2B50\u2B50\u2B50\u2B50\u2B50"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6ED1\u52A8\u7A97\u53E3"})}),(0,i.jsx)(n.td,{children:"\u5E73\u6ED1\u9650\u6D41\uFF0C\u7CBE\u786E\u63A7\u5236"}),(0,i.jsx)(n.td,{children:"\u5185\u5B58\u5360\u7528\u8F83\u9AD8"}),(0,i.jsx)(n.td,{children:"\u7CBE\u786E\u9650\u6D41\u9700\u6C42"}),(0,i.jsx)(n.td,{children:"\u2B50\u2B50\u2B50"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u4EE4\u724C\u6876"})}),(0,i.jsx)(n.td,{children:"\u5141\u8BB8\u7A81\u53D1\u6D41\u91CF"}),(0,i.jsx)(n.td,{children:"\u5B9E\u73B0\u590D\u6742"}),(0,i.jsx)(n.td,{children:"\u9700\u8981\u5904\u7406\u7A81\u53D1\u8BF7\u6C42"}),(0,i.jsx)(n.td,{children:"\u2B50\u2B50\u2B50\u2B50"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6F0F\u6876"})}),(0,i.jsx)(n.td,{children:"\u6D41\u91CF\u6574\u5F62\uFF0C\u5E73\u6ED1\u8F93\u51FA"}),(0,i.jsx)(n.td,{children:"\u4E0D\u5141\u8BB8\u7A81\u53D1"}),(0,i.jsx)(n.td,{children:"\u9700\u8981\u5E73\u6ED1\u6D41\u91CF"}),(0,i.jsx)(n.td,{children:"\u2B50\u2B50\u2B50\u2B50"})]})]})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"64-\u6392\u884C\u699C\u7CFB\u7EDF",children:"6.4 \u6392\u884C\u699C\u7CFB\u7EDF"}),"\n",(0,i.jsx)(n.p,{children:"\u57FA\u4E8ERedis Sorted Set\u5B9E\u73B0\u7684\u6392\u884C\u699C\u7CFB\u7EDF\uFF0C\u652F\u6301\u5B9E\u65F6\u66F4\u65B0\u548C\u591A\u7EF4\u5EA6\u6392\u5E8F\u3002"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{value:"leaderboard",label:"\u6392\u884C\u699C\u5B9E\u73B0",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="Redis\u6392\u884C\u699C\u7CFB\u7EDF"',children:'@Service\npublic class LeaderboardService {\n    \n    @Autowired\n    private RedisTemplate<String, Object> redisTemplate;\n    \n    private static final String LEADERBOARD_PREFIX = "leaderboard:";\n    \n    /**\n     * \u66F4\u65B0\u7528\u6237\u5206\u6570\n     */\n    public void updateScore(String leaderboardName, String userId, double score) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        redisTemplate.opsForZSet().add(key, userId, score);\n        \n        // \u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\uFF08\u53EF\u9009\uFF09\n        redisTemplate.expire(key, 7, TimeUnit.DAYS);\n    }\n    \n    /**\n     * \u589E\u52A0\u7528\u6237\u5206\u6570\n     */\n    public Double incrementScore(String leaderboardName, String userId, double increment) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        return redisTemplate.opsForZSet().incrementScore(key, userId, increment);\n    }\n    \n    /**\n     * \u83B7\u53D6\u7528\u6237\u5206\u6570\n     */\n    public Double getUserScore(String leaderboardName, String userId) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        return redisTemplate.opsForZSet().score(key, userId);\n    }\n    \n    /**\n     * \u83B7\u53D6\u7528\u6237\u6392\u540D\uFF08\u4ECE1\u5F00\u59CB\uFF09\n     */\n    public Long getUserRank(String leaderboardName, String userId) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        Long rank = redisTemplate.opsForZSet().reverseRank(key, userId);\n        return rank != null ? rank + 1 : null;\n    }\n    \n    /**\n     * \u83B7\u53D6\u6392\u884C\u699C\u524DN\u540D\n     */\n    public List<LeaderboardEntry> getTopN(String leaderboardName, int n) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        Set<ZSetOperations.TypedTuple<Object>> tuples = \n            redisTemplate.opsForZSet().reverseRangeWithScores(key, 0, n - 1);\n        \n        List<LeaderboardEntry> result = new ArrayList<>();\n        int rank = 1;\n        for (ZSetOperations.TypedTuple<Object> tuple : tuples) {\n            result.add(new LeaderboardEntry(\n                rank++,\n                (String) tuple.getValue(),\n                tuple.getScore()\n            ));\n        }\n        \n        return result;\n    }\n    \n    /**\n     * \u83B7\u53D6\u6307\u5B9A\u6392\u540D\u8303\u56F4\u7684\u7528\u6237\n     */\n    public List<LeaderboardEntry> getRangeByRank(String leaderboardName, long start, long end) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        Set<ZSetOperations.TypedTuple<Object>> tuples = \n            redisTemplate.opsForZSet().reverseRangeWithScores(key, start - 1, end - 1);\n        \n        List<LeaderboardEntry> result = new ArrayList<>();\n        long rank = start;\n        for (ZSetOperations.TypedTuple<Object> tuple : tuples) {\n            result.add(new LeaderboardEntry(\n                rank++,\n                (String) tuple.getValue(),\n                tuple.getScore()\n            ));\n        }\n        \n        return result;\n    }\n    \n    /**\n     * \u83B7\u53D6\u6307\u5B9A\u5206\u6570\u8303\u56F4\u7684\u7528\u6237\n     */\n    public List<LeaderboardEntry> getRangeByScore(String leaderboardName, double minScore, double maxScore) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        Set<ZSetOperations.TypedTuple<Object>> tuples = \n            redisTemplate.opsForZSet().reverseRangeByScoreWithScores(key, minScore, maxScore);\n        \n        List<LeaderboardEntry> result = new ArrayList<>();\n        for (ZSetOperations.TypedTuple<Object> tuple : tuples) {\n            Long rank = redisTemplate.opsForZSet().reverseRank(key, tuple.getValue());\n            result.add(new LeaderboardEntry(\n                rank != null ? rank + 1 : 0,\n                (String) tuple.getValue(),\n                tuple.getScore()\n            ));\n        }\n        \n        return result;\n    }\n    \n    /**\n     * \u83B7\u53D6\u7528\u6237\u5468\u56F4\u7684\u6392\u540D\n     */\n    public List<LeaderboardEntry> getUserNeighbors(String leaderboardName, String userId, int count) {\n        Long userRank = getUserRank(leaderboardName, userId);\n        if (userRank == null) {\n            return Collections.emptyList();\n        }\n        \n        long start = Math.max(1, userRank - count / 2);\n        long end = start + count - 1;\n        \n        return getRangeByRank(leaderboardName, start, end);\n    }\n    \n    /**\n     * \u5220\u9664\u7528\u6237\n     */\n    public void removeUser(String leaderboardName, String userId) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        redisTemplate.opsForZSet().remove(key, userId);\n    }\n    \n    /**\n     * \u83B7\u53D6\u6392\u884C\u699C\u603B\u4EBA\u6570\n     */\n    public Long getTotalCount(String leaderboardName) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        return redisTemplate.opsForZSet().zCard(key);\n    }\n    \n    /**\n     * \u6279\u91CF\u66F4\u65B0\u5206\u6570\n     */\n    public void batchUpdateScores(String leaderboardName, Map<String, Double> userScores) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        \n        Set<ZSetOperations.TypedTuple<Object>> tuples = new HashSet<>();\n        for (Map.Entry<String, Double> entry : userScores.entrySet()) {\n            tuples.add(new DefaultTypedTuple<>(entry.getKey(), entry.getValue()));\n        }\n        \n        redisTemplate.opsForZSet().add(key, tuples);\n    }\n    \n    /**\n     * \u591A\u7EF4\u5EA6\u6392\u884C\u699C\u5408\u5E76\n     */\n    public void mergeLeaderboards(String targetLeaderboard, List<String> sourceLeaderboards, List<Double> weights) {\n        String targetKey = LEADERBOARD_PREFIX + targetLeaderboard;\n        \n        List<String> sourceKeys = sourceLeaderboards.stream()\n            .map(name -> LEADERBOARD_PREFIX + name)\n            .collect(Collectors.toList());\n        \n        // \u4F7F\u7528ZUNIONSTORE\u5408\u5E76\u591A\u4E2A\u6392\u884C\u699C\n        ZSetOperations.Aggregate aggregate = ZSetOperations.Aggregate.SUM;\n        redisTemplate.opsForZSet().unionAndStore(sourceKeys.get(0), sourceKeys.subList(1, sourceKeys.size()), targetKey, aggregate, weights.toArray(new Double[0]));\n        \n        // \u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\n        redisTemplate.expire(targetKey, 1, TimeUnit.HOURS);\n    }\n    \n    // \u6392\u884C\u699C\u6761\u76EE\u7C7B\n    public static class LeaderboardEntry {\n        private final long rank;\n        private final String userId;\n        private final double score;\n        \n        public LeaderboardEntry(long rank, String userId, double score) {\n            this.rank = rank;\n            this.userId = userId;\n            this.score = score;\n        }\n        \n        // getters\n        public long getRank() { return rank; }\n        public String getUserId() { return userId; }\n        public double getScore() { return score; }\n    }\n}\n\n// \u6392\u884C\u699C\u7BA1\u7406\u5668\n@Service\npublic class LeaderboardManager {\n    \n    @Autowired\n    private LeaderboardService leaderboardService;\n    \n    /**\n     * \u6E38\u620F\u6392\u884C\u699C\u793A\u4F8B\n     */\n    public void gameLeaderboardExample() {\n        String leaderboard = "game:global";\n        \n        // \u66F4\u65B0\u73A9\u5BB6\u5206\u6570\n        leaderboardService.updateScore(leaderboard, "player1", 1500);\n        leaderboardService.updateScore(leaderboard, "player2", 1200);\n        leaderboardService.updateScore(leaderboard, "player3", 1800);\n        \n        // \u83B7\u53D6\u524D10\u540D\n        List<LeaderboardService.LeaderboardEntry> top10 = \n            leaderboardService.getTopN(leaderboard, 10);\n        \n        System.out.println("\u6E38\u620F\u6392\u884C\u699C\u524D10\u540D\uFF1A");\n        for (LeaderboardService.LeaderboardEntry entry : top10) {\n            System.out.printf("\u7B2C%d\u540D: %s (\u5206\u6570: %.0f)\\n", \n                entry.getRank(), entry.getUserId(), entry.getScore());\n        }\n    }\n    \n    /**\n     * \u5B9E\u65F6\u6D3B\u52A8\u6392\u884C\u699C\n     */\n    public void activityLeaderboardExample() {\n        String leaderboard = "activity:2025_spring";\n        \n        // \u7528\u6237\u5B8C\u6210\u4EFB\u52A1\uFF0C\u589E\u52A0\u79EF\u5206\n        leaderboardService.incrementScore(leaderboard, "user1", 100);\n        leaderboardService.incrementScore(leaderboard, "user2", 150);\n        leaderboardService.incrementScore(leaderboard, "user3", 80);\n        \n        // \u83B7\u53D6\u7528\u6237\u6392\u540D\u548C\u5468\u56F4\u7528\u6237\n        String userId = "user1";\n        Long userRank = leaderboardService.getUserRank(leaderboard, userId);\n        List<LeaderboardService.LeaderboardEntry> neighbors = \n            leaderboardService.getUserNeighbors(leaderboard, userId, 5);\n        \n        System.out.println("\u7528\u6237" + userId + "\u5F53\u524D\u6392\u540D: " + userRank);\n        System.out.println("\u5468\u56F4\u7528\u6237\u6392\u540D\uFF1A");\n        for (LeaderboardService.LeaderboardEntry entry : neighbors) {\n            System.out.printf("\u7B2C%d\u540D: %s (\u79EF\u5206: %.0f)\\n", \n                entry.getRank(), entry.getUserId(), entry.getScore());\n        }\n    }\n    \n    /**\n     * \u591A\u7EF4\u5EA6\u6392\u884C\u699C\u793A\u4F8B\n     */\n    public void multiDimensionLeaderboardExample() {\n        // \u521B\u5EFA\u4E0D\u540C\u7EF4\u5EA6\u7684\u6392\u884C\u699C\n        String scoreBoard = "game:score";\n        String timeBoard = "game:time";\n        String comboBoard = "game:combo";\n        \n        // \u66F4\u65B0\u5404\u7EF4\u5EA6\u6570\u636E\n        leaderboardService.updateScore(scoreBoard, "player1", 1500);\n        leaderboardService.updateScore(timeBoard, "player1", 120); // \u7528\u65F6120\u79D2\n        leaderboardService.updateScore(comboBoard, "player1", 50); // \u8FDE\u51FB50\u6B21\n        \n        // \u5408\u5E76\u6392\u884C\u699C\uFF08\u7EFC\u5408\u6392\u540D\uFF09\n        List<String> sourceBoards = Arrays.asList(scoreBoard, timeBoard, comboBoard);\n        List<Double> weights = Arrays.asList(0.5, -0.3, 0.2); // \u5206\u6570\u6743\u91CD0.5\uFF0C\u65F6\u95F4\u6743\u91CD-0.3\uFF08\u8D8A\u5C11\u8D8A\u597D\uFF09\uFF0C\u8FDE\u51FB\u6743\u91CD0.2\n        \n        leaderboardService.mergeLeaderboards("game:comprehensive", sourceBoards, weights);\n        \n        // \u83B7\u53D6\u7EFC\u5408\u6392\u884C\u699C\n        List<LeaderboardService.LeaderboardEntry> comprehensive = \n            leaderboardService.getTopN("game:comprehensive", 10);\n        \n        System.out.println("\u7EFC\u5408\u6392\u884C\u699C\uFF1A");\n        for (LeaderboardService.LeaderboardEntry entry : comprehensive) {\n            System.out.printf("\u7B2C%d\u540D: %s (\u7EFC\u5408\u5206: %.2f)\\n", \n                entry.getRank(), entry.getUserId(), entry.getScore());\n        }\n    }\n}\n'})})}),(0,i.jsx)(a.A,{value:"leaderboard-optimization",label:"\u6392\u884C\u699C\u4F18\u5316",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="\u6392\u884C\u699C\u6027\u80FD\u4F18\u5316"',children:'@Service\npublic class OptimizedLeaderboardService {\n    \n    @Autowired\n    private RedisTemplate<String, Object> redisTemplate;\n    \n    /**\n     * \u5206\u9875\u6392\u884C\u699C - \u907F\u514D\u5927\u91CF\u6570\u636E\u4F20\u8F93\n     */\n    public PageResult<LeaderboardEntry> getLeaderboardPage(String leaderboardName, int page, int size) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        \n        long total = redisTemplate.opsForZSet().zCard(key);\n        long start = (page - 1) * size;\n        long end = start + size - 1;\n        \n        Set<ZSetOperations.TypedTuple<Object>> tuples = \n            redisTemplate.opsForZSet().reverseRangeWithScores(key, start, end);\n        \n        List<LeaderboardEntry> entries = new ArrayList<>();\n        long rank = start + 1;\n        for (ZSetOperations.TypedTuple<Object> tuple : tuples) {\n            entries.add(new LeaderboardEntry(\n                rank++,\n                (String) tuple.getValue(),\n                tuple.getScore()\n            ));\n        }\n        \n        return new PageResult<>(entries, page, size, total);\n    }\n    \n    /**\n     * \u7F13\u5B58\u7528\u6237\u6392\u540D - \u51CF\u5C11\u91CD\u590D\u8BA1\u7B97\n     */\n    private final Cache<String, Long> rankCache = Caffeine.newBuilder()\n        .maximumSize(10000)\n        .expireAfterWrite(5, TimeUnit.MINUTES)\n        .build();\n    \n    public Long getCachedUserRank(String leaderboardName, String userId) {\n        String cacheKey = leaderboardName + ":" + userId;\n        \n        return rankCache.get(cacheKey, key -> {\n            String redisKey = LEADERBOARD_PREFIX + leaderboardName;\n            Long rank = redisTemplate.opsForZSet().reverseRank(redisKey, userId);\n            return rank != null ? rank + 1 : null;\n        });\n    }\n    \n    /**\n     * \u6279\u91CF\u83B7\u53D6\u7528\u6237\u6392\u540D\n     */\n    public Map<String, Long> batchGetUserRanks(String leaderboardName, List<String> userIds) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        Map<String, Long> result = new HashMap<>();\n        \n        // \u4F7F\u7528Pipeline\u6279\u91CF\u83B7\u53D6\n        List<Object> ranks = redisTemplate.executePipelined((RedisCallback<Object>) connection -> {\n            for (String userId : userIds) {\n                connection.zRevRank(key.getBytes(), userId.getBytes());\n            }\n            return null;\n        });\n        \n        for (int i = 0; i < userIds.size(); i++) {\n            Long rank = (Long) ranks.get(i);\n            result.put(userIds.get(i), rank != null ? rank + 1 : null);\n        }\n        \n        return result;\n    }\n    \n    /**\n     * \u5B9A\u65F6\u6392\u884C\u699C\u5FEB\u7167\n     */\n    @Scheduled(cron = "0 0 * * * ?") // \u6BCF\u5C0F\u65F6\u6267\u884C\u4E00\u6B21\n    public void createLeaderboardSnapshot() {\n        String sourceKey = LEADERBOARD_PREFIX + "game:realtime";\n        String snapshotKey = LEADERBOARD_PREFIX + "game:snapshot:" + \n            LocalDateTime.now().format(DateTimeFormatter.ofPattern("yyyyMMddHH"));\n        \n        // \u590D\u5236\u6392\u884C\u699C\u6570\u636E\n        redisTemplate.opsForZSet().unionAndStore(sourceKey, Collections.emptyList(), snapshotKey);\n        \n        // \u8BBE\u7F6E\u5FEB\u7167\u8FC7\u671F\u65F6\u95F4\uFF08\u4FDD\u75597\u5929\uFF09\n        redisTemplate.expire(snapshotKey, 7, TimeUnit.DAYS);\n    }\n    \n    /**\n     * \u6392\u884C\u699C\u6570\u636E\u6E05\u7406\n     */\n    public void cleanupLeaderboard(String leaderboardName, int keepTopN) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        \n        // \u53EA\u4FDD\u7559\u524DN\u540D\n        redisTemplate.opsForZSet().removeRange(key, 0, -keepTopN - 1);\n    }\n    \n    /**\n     * \u6392\u884C\u699C\u7EDF\u8BA1\u4FE1\u606F\n     */\n    public LeaderboardStats getLeaderboardStats(String leaderboardName) {\n        String key = LEADERBOARD_PREFIX + leaderboardName;\n        \n        Long totalUsers = redisTemplate.opsForZSet().zCard(key);\n        \n        // \u83B7\u53D6\u6700\u9AD8\u5206\u548C\u6700\u4F4E\u5206\n        Set<ZSetOperations.TypedTuple<Object>> highest = \n            redisTemplate.opsForZSet().reverseRangeWithScores(key, 0, 0);\n        Set<ZSetOperations.TypedTuple<Object>> lowest = \n            redisTemplate.opsForZSet().rangeWithScores(key, 0, 0);\n        \n        Double maxScore = highest.isEmpty() ? 0.0 : highest.iterator().next().getScore();\n        Double minScore = lowest.isEmpty() ? 0.0 : lowest.iterator().next().getScore();\n        \n        // \u8BA1\u7B97\u5E73\u5747\u5206\uFF08\u7B80\u5316\u5B9E\u73B0\uFF09\n        Double avgScore = (maxScore + minScore) / 2;\n        \n        return new LeaderboardStats(totalUsers, maxScore, minScore, avgScore);\n    }\n    \n    // \u5206\u9875\u7ED3\u679C\u7C7B\n    public static class PageResult<T> {\n        private final List<T> data;\n        private final int page;\n        private final int size;\n        private final long total;\n        private final int totalPages;\n        \n        public PageResult(List<T> data, int page, int size, long total) {\n            this.data = data;\n            this.page = page;\n            this.size = size;\n            this.total = total;\n            this.totalPages = (int) Math.ceil((double) total / size);\n        }\n        \n        // getters\n        public List<T> getData() { return data; }\n        public int getPage() { return page; }\n        public int getSize() { return size; }\n        public long getTotal() { return total; }\n        public int getTotalPages() { return totalPages; }\n    }\n    \n    // \u6392\u884C\u699C\u7EDF\u8BA1\u7C7B\n    public static class LeaderboardStats {\n        private final long totalUsers;\n        private final double maxScore;\n        private final double minScore;\n        private final double avgScore;\n        \n        public LeaderboardStats(long totalUsers, double maxScore, double minScore, double avgScore) {\n            this.totalUsers = totalUsers;\n            this.maxScore = maxScore;\n            this.minScore = minScore;\n            this.avgScore = avgScore;\n        }\n        \n        // getters\n        public long getTotalUsers() { return totalUsers; }\n        public double getMaxScore() { return maxScore; }\n        public double getMinScore() { return minScore; }\n        public double getAvgScore() { return avgScore; }\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(n.h2,{id:"7-redis\u9762\u8BD5\u9898\u7CBE\u9009",children:"7. Redis\u9762\u8BD5\u9898\u7CBE\u9009"}),"\n",(0,i.jsx)(n.h3,{id:"71-\u57FA\u7840\u6982\u5FF5\u9898",children:"7.1 \u57FA\u7840\u6982\u5FF5\u9898"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Q1: Redis\u4E3A\u4EC0\u4E48\u8FD9\u4E48\u5FEB\uFF1F"})}),"\n",(0,i.jsx)(n.p,{children:"A: Redis\u9AD8\u6027\u80FD\u7684\u539F\u56E0\u5305\u62EC\uFF1A"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5185\u5B58\u64CD\u4F5C"}),"\uFF1A\u6570\u636E\u5B58\u50A8\u5728\u5185\u5B58\u4E2D\uFF0C\u907F\u514D\u78C1\u76D8I/O"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5355\u7EBF\u7A0B\u6A21\u578B"}),"\uFF1A\u907F\u514D\u7EBF\u7A0B\u5207\u6362\u548C\u9501\u7ADE\u4E89\u5F00\u9500"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u9AD8\u6548\u6570\u636E\u7ED3\u6784"}),"\uFF1A\u9488\u5BF9\u4E0D\u540C\u573A\u666F\u4F18\u5316\u7684\u6570\u636E\u7ED3\u6784"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u975E\u963B\u585EI/O"}),"\uFF1A\u4F7F\u7528epoll\u7B49\u9AD8\u6548I/O\u591A\u8DEF\u590D\u7528"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u4F18\u5316\u7684\u7F51\u7EDC\u534F\u8BAE"}),"\uFF1A\u7B80\u5355\u9AD8\u6548\u7684RESP\u534F\u8BAE"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Q2: Redis\u7684\u6570\u636E\u7C7B\u578B\u6709\u54EA\u4E9B\uFF1F\u5206\u522B\u9002\u7528\u4E8E\u4EC0\u4E48\u573A\u666F\uFF1F"})}),"\n",(0,i.jsx)(n.p,{children:"A: Redis\u652F\u6301\u4EE5\u4E0B\u6570\u636E\u7C7B\u578B\uFF1A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"String"}),"\uFF1A\u7F13\u5B58\u3001\u8BA1\u6570\u5668\u3001\u5206\u5E03\u5F0F\u9501"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Hash"}),"\uFF1A\u5BF9\u8C61\u5B58\u50A8\u3001\u8D2D\u7269\u8F66"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"List"}),"\uFF1A\u6D88\u606F\u961F\u5217\u3001\u65F6\u95F4\u7EBF\u3001\u6700\u65B0\u5217\u8868"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Set"}),"\uFF1A\u6807\u7B7E\u7CFB\u7EDF\u3001\u597D\u53CB\u5173\u7CFB\u3001\u53BB\u91CD"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Sorted Set"}),"\uFF1A\u6392\u884C\u699C\u3001\u4F18\u5148\u7EA7\u961F\u5217\u3001\u8303\u56F4\u67E5\u8BE2"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Stream"}),"\uFF1A\u6D88\u606F\u6D41\u3001\u4E8B\u4EF6\u6EAF\u6E90"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Q3: Redis\u6301\u4E45\u5316\u65B9\u5F0F\u6709\u54EA\u4E9B\uFF1F\u5404\u6709\u4EC0\u4E48\u4F18\u7F3A\u70B9\uFF1F"})}),"\n",(0,i.jsx)(n.p,{children:"A: Redis\u652F\u6301\u4E09\u79CD\u6301\u4E45\u5316\u65B9\u5F0F\uFF1A"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u65B9\u5F0F"}),(0,i.jsx)(n.th,{children:"\u4F18\u70B9"}),(0,i.jsx)(n.th,{children:"\u7F3A\u70B9"}),(0,i.jsx)(n.th,{children:"\u9002\u7528\u573A\u666F"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"RDB"})}),(0,i.jsx)(n.td,{children:"\u6587\u4EF6\u5C0F\u3001\u6062\u590D\u5FEB\u3001\u6027\u80FD\u5F71\u54CD\u5C0F"}),(0,i.jsx)(n.td,{children:"\u53EF\u80FD\u4E22\u5931\u6570\u636E\u3001fork\u8017\u65F6"}),(0,i.jsx)(n.td,{children:"\u5907\u4EFD\u3001\u4E3B\u4ECE\u540C\u6B65"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"AOF"})}),(0,i.jsx)(n.td,{children:"\u6570\u636E\u5B89\u5168\u3001\u53EF\u8BFB\u6027\u5F3A"}),(0,i.jsx)(n.td,{children:"\u6587\u4EF6\u5927\u3001\u6062\u590D\u6162"}),(0,i.jsx)(n.td,{children:"\u6570\u636E\u5B89\u5168\u8981\u6C42\u9AD8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u6DF7\u5408\u6301\u4E45\u5316"})}),(0,i.jsx)(n.td,{children:"\u517C\u987E\u6027\u80FD\u548C\u5B89\u5168"}),(0,i.jsx)(n.td,{children:"\u590D\u6742\u5EA6\u8F83\u9AD8"}),(0,i.jsx)(n.td,{children:"\u751F\u4EA7\u73AF\u5883\u63A8\u8350"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"72-\u67B6\u6784\u8BBE\u8BA1\u9898",children:"7.2 \u67B6\u6784\u8BBE\u8BA1\u9898"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Q4: Redis\u5982\u4F55\u5B9E\u73B0\u9AD8\u53EF\u7528\uFF1F"})}),"\n",(0,i.jsx)(n.p,{children:"A: Redis\u9AD8\u53EF\u7528\u65B9\u6848\uFF1A"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u4E3B\u4ECE\u590D\u5236"}),"\uFF1A\u6570\u636E\u5907\u4EFD\u548C\u8BFB\u5199\u5206\u79BB"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u54E8\u5175\u6A21\u5F0F"}),"\uFF1A\u81EA\u52A8\u6545\u969C\u68C0\u6D4B\u548C\u8F6C\u79FB"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u96C6\u7FA4\u6A21\u5F0F"}),"\uFF1A\u6570\u636E\u5206\u7247\u548C\u6C34\u5E73\u6269\u5C55"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5BA2\u6237\u7AEF\u5BB9\u9519"}),"\uFF1A\u8FDE\u63A5\u6C60\u3001\u91CD\u8BD5\u673A\u5236"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Q5: Redis\u96C6\u7FA4\u7684\u6570\u636E\u5206\u7247\u539F\u7406\u662F\u4EC0\u4E48\uFF1F"})}),"\n",(0,i.jsx)(n.p,{children:"A: Redis\u96C6\u7FA4\u4F7F\u7528\u4E00\u81F4\u6027\u54C8\u5E0C\u7684\u53D8\u79CD\uFF1A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"16384\u4E2A\u69FD\u4F4D\uFF08slot\uFF09"}),"\n",(0,i.jsx)(n.li,{children:"CRC16(key) % 16384 \u8BA1\u7B97\u69FD\u4F4D"}),"\n",(0,i.jsx)(n.li,{children:"\u6BCF\u4E2A\u4E3B\u8282\u70B9\u8D1F\u8D23\u4E00\u90E8\u5206\u69FD\u4F4D"}),"\n",(0,i.jsx)(n.li,{children:"\u4F7F\u7528Hash Tag\u786E\u4FDD\u76F8\u5173key\u5728\u540C\u4E00\u69FD\u4F4D"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Q6: \u5982\u4F55\u89E3\u51B3Redis\u7F13\u5B58\u7A7F\u900F\u3001\u51FB\u7A7F\u3001\u96EA\u5D29\u95EE\u9898\uFF1F"})}),"\n",(0,i.jsx)(n.p,{children:"A: \u89E3\u51B3\u65B9\u6848\uFF1A"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u95EE\u9898"}),(0,i.jsx)(n.th,{children:"\u539F\u56E0"}),(0,i.jsx)(n.th,{children:"\u89E3\u51B3\u65B9\u6848"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u7F13\u5B58\u7A7F\u900F"})}),(0,i.jsx)(n.td,{children:"\u67E5\u8BE2\u4E0D\u5B58\u5728\u7684\u6570\u636E"}),(0,i.jsx)(n.td,{children:"\u5E03\u9686\u8FC7\u6EE4\u5668\u3001\u7F13\u5B58\u7A7A\u503C"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u7F13\u5B58\u51FB\u7A7F"})}),(0,i.jsx)(n.td,{children:"\u70ED\u70B9key\u8FC7\u671F"}),(0,i.jsx)(n.td,{children:"\u5206\u5E03\u5F0F\u9501\u3001\u6C38\u4E0D\u8FC7\u671F"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"\u7F13\u5B58\u96EA\u5D29"})}),(0,i.jsx)(n.td,{children:"\u5927\u91CFkey\u540C\u65F6\u8FC7\u671F"}),(0,i.jsx)(n.td,{children:"\u8FC7\u671F\u65F6\u95F4\u968F\u673A\u5316\u3001\u591A\u7EA7\u7F13\u5B58"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"73-\u6027\u80FD\u4F18\u5316\u9898",children:"7.3 \u6027\u80FD\u4F18\u5316\u9898"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Q7: \u5982\u4F55\u4F18\u5316Redis\u6027\u80FD\uFF1F"})}),"\n",(0,i.jsx)(n.p,{children:"A: \u6027\u80FD\u4F18\u5316\u7B56\u7565\uFF1A"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5185\u5B58\u4F18\u5316"}),"\uFF1A\u5408\u9002\u7684\u6570\u636E\u7ED3\u6784\u3001\u5185\u5B58\u6DD8\u6C70\u7B56\u7565"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u7F51\u7EDC\u4F18\u5316"}),"\uFF1A\u8FDE\u63A5\u6C60\u3001Pipeline\u3001\u6279\u91CF\u64CD\u4F5C"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u6301\u4E45\u5316\u4F18\u5316"}),"\uFF1A\u5408\u7406\u914D\u7F6ERDB\u548CAOF\u53C2\u6570"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u67B6\u6784\u4F18\u5316"}),"\uFF1A\u8BFB\u5199\u5206\u79BB\u3001\u5206\u7247\u3001\u591A\u7EA7\u7F13\u5B58"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Q8: Redis\u7684\u5185\u5B58\u6DD8\u6C70\u7B56\u7565\u6709\u54EA\u4E9B\uFF1F"})}),"\n",(0,i.jsx)(n.p,{children:"A: Redis\u652F\u63018\u79CD\u5185\u5B58\u6DD8\u6C70\u7B56\u7565\uFF1A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"noeviction"}),"\uFF1A\u4E0D\u6DD8\u6C70\uFF0C\u5199\u5165\u62A5\u9519"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"allkeys-lru/lfu"}),"\uFF1A\u4ECE\u6240\u6709key\u4E2D\u6DD8\u6C70"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"volatile-lru/lfu"}),"\uFF1A\u4ECE\u8FC7\u671Fkey\u4E2D\u6DD8\u6C70"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"allkeys-random"}),"\uFF1A\u968F\u673A\u6DD8\u6C70\u6240\u6709key"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"volatile-random"}),"\uFF1A\u968F\u673A\u6DD8\u6C70\u8FC7\u671Fkey"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"volatile-ttl"}),"\uFF1A\u6DD8\u6C70\u5373\u5C06\u8FC7\u671F\u7684key"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"74-\u5B9E\u6218\u5E94\u7528\u9898",children:"7.4 \u5B9E\u6218\u5E94\u7528\u9898"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Q9: \u5982\u4F55\u4F7F\u7528Redis\u5B9E\u73B0\u5206\u5E03\u5F0F\u9501\uFF1F\u9700\u8981\u6CE8\u610F\u4EC0\u4E48\u95EE\u9898\uFF1F"})}),"\n",(0,i.jsx)(n.p,{children:"A: \u5206\u5E03\u5F0F\u9501\u5B9E\u73B0\u8981\u70B9\uFF1A"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u539F\u5B50\u6027"}),"\uFF1A\u4F7F\u7528SET NX EX\u547D\u4EE4"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u552F\u4E00\u6027"}),"\uFF1A\u4F7F\u7528UUID\u4F5C\u4E3A\u9501\u503C"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u8FC7\u671F\u65F6\u95F4"}),"\uFF1A\u9632\u6B62\u6B7B\u9501"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5B89\u5168\u91CA\u653E"}),"\uFF1ALua\u811A\u672C\u786E\u4FDD\u539F\u5B50\u6027"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53EF\u91CD\u5165\u6027"}),"\uFF1A\u4F7F\u7528Hash\u7ED3\u6784\u8BB0\u5F55\u91CD\u5165\u6B21\u6570"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Q10: \u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u9AD8\u6027\u80FD\u7684Redis\u7F13\u5B58\u7CFB\u7EDF\uFF1F"})}),"\n",(0,i.jsx)(n.p,{children:"A: \u8BBE\u8BA1\u8981\u70B9\uFF1A"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u7F13\u5B58\u7B56\u7565"}),"\uFF1ACache-Aside\u3001Write-Through\u7B49"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u6570\u636E\u7ED3\u6784\u9009\u62E9"}),"\uFF1A\u6839\u636E\u573A\u666F\u9009\u62E9\u5408\u9002\u7684\u6570\u636E\u7C7B\u578B"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u8FC7\u671F\u7B56\u7565"}),"\uFF1A\u5408\u7406\u8BBE\u7F6ETTL\uFF0C\u907F\u514D\u96EA\u5D29"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u76D1\u63A7\u544A\u8B66"}),"\uFF1A\u5185\u5B58\u4F7F\u7528\u7387\u3001\u547D\u4E2D\u7387\u3001\u54CD\u5E94\u65F6\u95F4"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5BB9\u707E\u5907\u4EFD"}),"\uFF1A\u4E3B\u4ECE\u590D\u5236\u3001\u5B9A\u671F\u5907\u4EFD"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{title:"Redis\u5B66\u4E60\u5EFA\u8BAE",type:"tip",children:(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u7406\u8BBA\u57FA\u7840"}),"\uFF1A\u6DF1\u5165\u7406\u89E3Redis\u7684\u6570\u636E\u7ED3\u6784\u548C\u5B9E\u73B0\u539F\u7406"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5B9E\u8DF5\u5E94\u7528"}),"\uFF1A\u591A\u505A\u9879\u76EE\u5B9E\u6218\uFF0C\u638C\u63E1\u5E38\u89C1\u5E94\u7528\u573A\u666F"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u6027\u80FD\u8C03\u4F18"}),"\uFF1A\u5B66\u4F1A\u5206\u6790\u6027\u80FD\u74F6\u9888\uFF0C\u638C\u63E1\u4F18\u5316\u6280\u5DE7"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u67B6\u6784\u8BBE\u8BA1"}),"\uFF1A\u4E86\u89E3\u9AD8\u53EF\u7528\u65B9\u6848\uFF0C\u80FD\u591F\u8BBE\u8BA1\u5206\u5E03\u5F0F\u7F13\u5B58\u67B6\u6784"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u6301\u7EED\u5B66\u4E60"}),"\uFF1A\u5173\u6CE8Redis\u65B0\u7248\u672C\u7279\u6027\uFF0C\u5B66\u4E60\u6700\u4F73\u5B9E\u8DF5"]}),"\n"]})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"\u901A\u8FC7\u672C\u7AE0\u7684\u6DF1\u5165\u5B66\u4E60\uFF0C\u4F60\u5E94\u8BE5\u5DF2\u7ECF\u5168\u9762\u638C\u63E1\u4E86Redis\u7684\u6838\u5FC3\u6982\u5FF5\u3001\u6570\u636E\u7ED3\u6784\u3001\u6301\u4E45\u5316\u673A\u5236\u3001\u9AD8\u53EF\u7528\u67B6\u6784\u548C\u6027\u80FD\u4F18\u5316\u6280\u5DE7\u3002Redis\u4F5C\u4E3A\u73B0\u4EE3\u5E94\u7528\u67B6\u6784\u4E2D\u7684\u91CD\u8981\u7EC4\u4EF6\uFF0C\u5728\u7F13\u5B58\u3001\u4F1A\u8BDD\u5B58\u50A8\u3001\u6D88\u606F\u961F\u5217\u3001\u5206\u5E03\u5F0F\u9501\u7B49\u573A\u666F\u4E2D\u53D1\u6325\u7740\u5173\u952E\u4F5C\u7528\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u5B9E\u9645\u9879\u76EE\u4E2D\uFF0C\u5408\u7406\u4F7F\u7528Redis\u4E0D\u4EC5\u80FD\u663E\u8457\u63D0\u5347\u7CFB\u7EDF\u6027\u80FD\uFF0C\u8FD8\u80FD\u7B80\u5316\u67B6\u6784\u8BBE\u8BA1\u3002\u5E0C\u671B\u8FD9\u4EFD\u8BE6\u7EC6\u7684Redis\u6307\u5357\u80FD\u591F\u5E2E\u52A9\u4F60\u5728\u6280\u672F\u9762\u8BD5\u548C\u5B9E\u9645\u5DE5\u4F5C\u4E2D\u6E38\u5203\u6709\u4F59\uFF01"})]})}function m(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(g,{...e})}):g(e)}},57250:function(e,n,t){t.d(n,{A:()=>s});var r=t(74848);t(96540);var i=t(34164);function s({children:e,hidden:n,className:t}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,i.A)("tabItem_Ymn6",t),hidden:n,children:e})}},78010:function(e,n,t){t.d(n,{A:()=>j});var r=t(74848),i=t(96540),s=t(34164),l=t(88287),a=t(28584),o=t(56347),c=t(99989),d=t(96629),u=t(80618),g=t(41367);function m(e){return i.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,i.isValidElement)(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p({value:e,tabValues:n}){return n.some(n=>n.value===e)}var h=t(19863);function S({className:e,block:n,selectedValue:t,selectValue:i,tabValues:l}){let o=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.a_)(),d=e=>{let n=e.currentTarget,r=l[o.indexOf(n)].value;r!==t&&(c(n),i(r))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{let t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{let t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1]}}n?.focus()};return(0,r.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:l.map(({value:e,label:n,attributes:i})=>(0,r.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{o.push(e)},onKeyDown:u,onClick:d,...i,className:(0,s.A)("tabs__item","tabItem_LNqP",i?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function b({lazy:e,children:n,selectedValue:t}){let l=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){let e=l.find(e=>e.props.value===t);return e?(0,i.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,r.jsx)("div",{className:"margin-top--md",children:l.map((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function x(e){let n=function(e){let n,{defaultValue:t,queryString:r=!1,groupId:s}=e,l=function(e){let{values:n,children:t}=e;return(0,i.useMemo)(()=>{let e=n??m(t).map(({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r})),r=(0,u.XI)(e,(e,n)=>e.value===n.value);if(r.length>0)throw Error(`Docusaurus error: Duplicate values "${r.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`);return e},[n,t])}(e),[a,h]=(0,i.useState)(()=>(function({defaultValue:e,tabValues:n}){if(0===n.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}let t=n.find(e=>e.default)??n[0];if(!t)throw Error("Unexpected error: 0 tabValues");return t.value})({defaultValue:t,tabValues:l})),[S,b]=function({queryString:e=!1,groupId:n}){let t=(0,o.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,d.aZ)(r),(0,i.useCallback)(e=>{if(!r)return;let n=new URLSearchParams(t.location.search);n.set(r,e),t.replace({...t.location,search:n.toString()})},[r,t])]}({queryString:r,groupId:s}),[x,j]=function({groupId:e}){let n=e?`docusaurus.tab.${e}`:null,[t,r]=(0,g.Dv)(n);return[t,(0,i.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:s}),y=p({value:n=S??x,tabValues:l})?n:null;return(0,c.A)(()=>{y&&h(y)},[y]),{selectedValue:a,selectValue:(0,i.useCallback)(e=>{if(!p({value:e,tabValues:l}))throw Error(`Can't select invalid tab value=${e}`);h(e),b(e),j(e)},[b,j,l]),tabValues:l}}(e);return(0,r.jsxs)("div",{className:(0,s.A)(l.G.tabs.container,"tabs-container","tabList__CuJ"),children:[(0,r.jsx)(S,{...n,...e}),(0,r.jsx)(b,{...n,...e})]})}function j(e){let n=(0,h.A)();return(0,r.jsx)(x,{...e,children:m(e.children)},String(n))}},67810:function(e,n,t){t.d(n,{A:()=>s});var r=t(83941),i=t(61022);function s(){let{prism:e}=(0,i.p)(),{colorMode:n}=(0,r.G)(),t=e.theme,s=e.darkTheme||t;return"dark"===n?s:t}},25591:function(e,n,t){t.d(n,{A:()=>m});var r=t(74848),i=t(96540),s=t(34164),l=t(71765),a=t(33436),o=t(61022),c=t(67810);let d="codeDot_PWGG",u="langIcon_gX7_",g="copyButtonIcon_f_OW",m=function({children:e,className:n,metastring:t,title:m}){let p,h,[S,b]=(0,i.useState)(!1),[x,j]=(0,i.useState)(!1),y=(0,i.useRef)(null),v=(0,i.useRef)(null),R=(0,i.useRef)(null),{prism:f}=(0,o.p)(),k=(0,c.A)();(0,i.useEffect)(()=>{j(!0)},[]),(0,i.useEffect)(()=>{let e;if(!R.current)return;let n=document.createElement("canvas"),t=document.createElement("div");t.className="matrixContainer_iCb4",t.appendChild(n),R.current.prepend(t);let r=n.getContext("2d"),i=()=>{let e=R.current.getBoundingClientRect();n.width=e.width,n.height=e.height};i(),window.addEventListener("resize",i);let s=()=>"dark"===document.documentElement.getAttribute("data-theme"),l=()=>{let e=(s(),15),t=Math.floor(n.width/e);return{fontSize:e,columns:t}},{fontSize:a,columns:o}=l(),c=[];for(let e=0;e<o;e++)c[e]=Math.floor(Math.random()*n.height/a);let d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789labylabylaby",u=()=>{let t=o;if({fontSize:a,columns:o}=l(),o!==t)for(let e=0;e<o;e++)e<t||(c[e]=Math.floor(Math.random()*n.height/a));s()?r.fillStyle="rgba(0, 0, 0, 0.05)":r.fillStyle="rgba(255, 255, 255, 0.05)",r.fillRect(0,0,n.width,n.height),s()?r.fillStyle="#0F0":r.fillStyle="rgba(0, 80, 0, 0.8)",r.font=`${a}px 'Courier New', monospace`,r.textBaseline="top";for(let e=0;e<c.length;e++){let t=d[Math.floor(Math.random()*d.length)];r.fillText(t,e*a,c[e]*a),c[e]*a>n.height&&Math.random()>.975&&(c[e]=0),Math.random()>.6&&c[e]++}e=setTimeout(()=>requestAnimationFrame(u),70)};u();let g=new MutationObserver(e=>{e.forEach(e=>{"data-theme"===e.attributeName&&r.clearRect(0,0,n.width,n.height)})});return g.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{g.disconnect(),window.removeEventListener("resize",i),clearTimeout(e),cancelAnimationFrame(e)}},[x]);let A=n&&(/language-(\w+)/.exec(n)||["","text"])[1],L=m||(t&&t.match(/title="([^"]+)"/))?.[1]||"";return(0,r.jsxs)("div",{className:(0,s.A)("codeBlockContainer_X7hc",A&&`language-${A}`),ref:v,children:[(0,r.jsxs)("div",{className:"codeBlockHeader_viex",children:[(0,r.jsxs)("div",{className:"codeBlockControls_mxj2",children:[(0,r.jsx)("span",{className:(0,s.A)(d,"codeDotRed_ANoD")}),(0,r.jsx)("span",{className:(0,s.A)(d,"codeDotYellow_HH1J")}),(0,r.jsx)("span",{className:(0,s.A)(d,"codeDotGreen_RM6U")})]}),L&&(0,r.jsx)("div",{className:"codeBlockTitle_B2tn",children:L}),(0,r.jsxs)("div",{className:"codeBlockMeta_lRk3",children:[A&&(0,r.jsxs)("div",{className:"codeBlockLanguage_Vqu6",children:[(p={javascript:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",className:u,children:(0,r.jsx)("path",{fill:"currentColor",d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM243.8 381.4c0 43.6-25.6 63.5-62.9 63.5-33.7 0-53.2-17.4-63.2-38.5l34.3-20.7c6.6 11.7 12.6 21.6 27.1 21.6 13.8 0 22.6-5.4 22.6-26.5V237.7h42.1v143.7zm99.6 63.5c-39.1 0-64.4-18.6-76.7-43l34.3-19.8c9 14.7 20.8 25.6 41.5 25.6 17.4 0 28.6-8.7 28.6-20.8 0-14.4-11.4-19.5-30.7-28l-10.5-4.5c-30.4-12.9-50.5-29.2-50.5-63.5 0-31.6 24.1-55.6 61.6-55.6 26.8 0 46 9.3 59.8 33.7L368 290c-7.2-12.9-15-18-27.1-18-12.3 0-20.1 7.8-20.1 18 0 12.6 7.8 17.7 25.9 25.6l10.5 4.5c35.8 15.3 55.9 31 55.9 66.2 0 37.8-29.8 58.6-69.7 58.6z"})}),jsx:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",className:u,children:(0,r.jsx)("path",{fill:"currentColor",d:"M418.2 177.2c-5.4-1.8-10.8-3.5-16.2-5.1.9-3.7 1.7-7.4 2.5-11.1 12.3-59.6 4.2-107.5-23.1-123.3-26.3-15.1-69.2.6-112.6 38.4-4.3 3.7-8.5 7.6-12.5 11.5-2.7-2.6-5.5-5.2-8.3-7.7-45.5-40.4-91.1-57.4-118.4-41.5-26.2 15.2-34 60.3-23 116.7 1.1 5.6 2.3 11.1 3.7 16.7-6.4 1.8-12.7 3.8-18.6 5.9C38.3 196.2 0 225.4 0 255.6c0 31.2 40.8 62.5 96.3 81.5 4.5 1.5 9 3 13.6 4.3-1.5 6-2.8 11.9-4 18-10.5 55.5-2.3 99.5 23.9 114.6 27 15.6 72.4-.4 116.6-39.1 3.5-3.1 7-6.3 10.5-9.7 4.4 4.3 9 8.4 13.6 12.4 42.8 36.8 85.1 51.7 111.2 36.6 27-15.6 35.8-62.9 24.4-120.5-.9-4.4-1.9-8.9-3-13.5 3.2-.9 6.3-1.9 9.4-2.9 57.7-19.1 99.5-50 99.5-81.7 0-30.3-39.4-59.7-93.8-78.4zM282.9 92.3c37.2-32.4 71.9-45.1 87.7-36 16.9 9.7 23.4 48.9 12.8 100.4-.7 3.4-1.4 6.7-2.3 10-22.2-5-44.7-8.6-67.3-10.6-13-18.6-27.2-36.4-42.6-53.1 3.9-3.7 7.7-7.2 11.7-10.7zM167.2 307.5c5.1 8.7 10.3 17.4 15.8 25.9-15.6-1.7-31.1-4.2-46.4-7.5 4.4-14.4 9.9-29.3 16.3-44.5 4.6 8.8 9.3 17.5 14.3 26.1zm-30.3-120.3c14.4-3.2 29.7-5.8 45.6-7.8-5.3 8.3-10.5 16.8-15.4 25.4-4.9 8.5-9.7 17.2-14.2 26-6.3-14.9-11.6-29.5-16-43.6zm27.4 68.9c6.6-13.8 13.8-27.3 21.4-40.6s15.8-26.2 24.4-38.9c15-1.1 30.3-1.7 45.9-1.7s31 .6 45.9 1.7c8.5 12.6 16.6 25.5 24.3 38.7s14.9 26.7 21.7 40.4c-6.7 13.8-13.9 27.4-21.6 40.8-7.6 13.3-15.7 26.2-24.2 39-14.9 1.1-30.4 1.6-46.1 1.6s-30.9-.5-45.6-1.4c-8.7-12.7-16.9-25.7-24.6-39s-14.8-26.8-21.5-40.6zm180.6 51.2c5.1-8.8 9.9-17.7 14.6-26.7 6.4 14.5 12 29.2 16.9 44.3-15.5 3.5-31.2 6.2-47 8 5.4-8.4 10.5-17 15.5-25.6zm14.4-76.5c-4.7-8.8-9.5-17.6-14.5-26.2-4.9-8.5-10-16.9-15.3-25.2 16.1 2 31.5 4.7 45.9 8-4.6 14.8-10 29.2-16.1 43.4zM256.2 118.3c10.5 11.4 20.4 23.4 29.6 35.8-19.8-.9-39.7-.9-59.5 0 9.8-12.9 19.9-24.9 29.9-35.8zM140.2 57c16.8-9.8 54.1 4.2 93.4 39 2.5 2.2 5 4.6 7.6 7-15.5 16.7-29.8 34.5-42.9 53.1-22.6 2-45 5.5-67.2 10.4-1.3-5.1-2.4-10.3-3.5-15.5-9.4-48.4-3.2-84.9 12.6-94zm-24.5 263.6c-4.2-1.2-8.3-2.5-12.4-3.9-21.3-6.7-45.5-17.3-63-31.2-10.1-7-16.9-17.8-18.8-29.9 0-18.3 31.6-41.7 77.2-57.6 5.7-2 11.5-3.8 17.3-5.5 6.8 21.7 15 43 24.5 63.6-9.6 20.9-17.9 42.5-24.8 64.5zm116.6 98c-16.5 15.1-35.6 27.1-56.4 35.3-11.1 5.3-23.9 5.8-35.3 1.3-15.9-9.2-22.5-44.5-13.5-92 1.1-5.6 2.3-11.2 3.7-16.7 22.4 4.8 45 8.1 67.9 9.8 13.2 18.7 27.7 36.6 43.2 53.4-3.2 3.1-6.4 6.1-9.6 8.9zm24.5-24.3c-10.2-11-20.4-23.2-30.3-36.3 9.6.4 19.5.6 29.5.6 10.3 0 20.4-.2 30.4-.7-9.2 12.7-19.1 24.8-29.6 36.4zm130.7 30c-.9 12.2-6.9 23.6-16.5 31.3-15.9 9.2-49.8-2.8-86.4-34.2-4.2-3.6-8.4-7.5-12.7-11.5 15.3-16.9 29.4-34.8 42.2-53.6 22.9-1.9 45.7-5.4 68.2-10.5 1 4.1 1.9 8.2 2.7 12.2 4.9 21.6 5.7 44.1 2.5 66.3zm18.2-107.5c-2.8.9-5.6 1.8-8.5 2.6-7-21.8-15.6-43.1-25.5-63.8 9.6-20.4 17.7-41.4 24.5-62.9 5.2 1.5 10.2 3.1 15 4.7 46.6 16 79.3 39.8 79.3 58 0 19.6-34.9 44.9-84.8 61.4zm-149.7-15c25.3 0 45.8-20.5 45.8-45.8s-20.5-45.8-45.8-45.8c-25.3 0-45.8 20.5-45.8 45.8s20.5 45.8 45.8 45.8z"})}),typescript:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",className:u,children:[(0,r.jsx)("path",{fill:"currentColor",d:"M233.277 177.622h-82.44v156.756h32.967v-58.743h49.472c39.168 0 71.15-26.284 71.15-49.006.001-22.729-31.981-49.007-71.15-49.007zm-3.533 66.293H183.71v-33.496h46.034c17.392 0 31.407 7.41 31.407 16.747.001 9.341-14.014 16.75-31.407 16.75zm212.408-66.293v32.965h-33.403v123.79h-32.973v-123.79h-33.405v-32.966h99.781z"}),(0,r.jsx)("path",{fill:"currentColor",d:"M512 256.001c0 141.395-114.606 255.996-255.996 255.996C114.606 511.997 0 397.396 0 256.001 0 114.606 114.606 0 256.004 0 397.394 0 512 114.606 512 256.001z",opacity:".1"})]}),css:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",className:u,children:(0,r.jsx)("path",{fill:"currentColor",d:"M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"})}),html:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",className:u,children:(0,r.jsx)("path",{fill:"currentColor",d:"M0 32l34.9 395.8L191.5 480l157.6-52.2L384 32H0zm308.2 127.9H124.4l4.1 49.4h175.6l-13.6 148.4-97.9 27v.3h-1.1l-98.7-27.3-6-75.8h47.7L138 320l53.5 14.5 53.7-14.5 6-62.2H84.3L71.5 112.2h241.1l-4.4 47.7z"})}),java:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",className:u,children:(0,r.jsx)("path",{fill:"currentColor",d:"M277.74 312.9c9.8-6.7 23.4-12.5 23.4-12.5s-38.7 7-77.2 10.2c-47.1 3.9-97.7 4.7-123.1 1.3-60.1-8 33-30.1 33-30.1s-36.1-2.4-80.6 19c-52.5 25.4 130 37 224.5 12.1zm-85.4-32.1c-19-42.7-83.1-80.2 0-145.8C296 45.2 242.8 8.1 242.8 8.1s12.7 50.9-23.5 79.4c-60.3 47.5-78.2-12.6-78.2-12.6-117.2 68.1 38.4 69.6 51.3 93.4 22.9 41.5-40.2 104.8-80.4 93.7-9-2.5 5.2 9.6 19.5 19.4 20.8 14.3 76.1 20.5 116.2-2.8 31.3-18.1-11.7-53.8-23.5-70.7zM381 261.1c-15.6-5.9-37.8-6.6-37.8-6.6s9.4-28.4-37.3-42.3c-94.4-28.3-189 11.5-189 11.5s52.9 47.3 138.2 35c16.6-2.4 51-13.1 51-13.1s-23.8 6.1-32.7 12.1c-223.1 62.2-75.6-7.5-75.6-7.5s19 10.7 50.9 12.8c116.2 8.1 117.1-35.9 132.3-2.9zM239 64.7c-56.6 19.6-49.4 42.6-49.4 42.6 49.3-32 121.4-22.3 121.4-22.3s-23.1-10.1-72 -20.3zm-99.6 23.6c27.8-15.7 49.9-8 49.9-8s-28.6-15.9-60.4-7.6c-21.1 5.6-14.8 23.7-14.8 23.7s5-9.4 25.3-8.1zm146.4 44.6c-39.4 13-43.6 61.5-43.6 61.5s75-36.4 43.6-61.5z"})}),python:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",className:u,children:(0,r.jsx)("path",{fill:"currentColor",d:"M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"})}),bash:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",className:u,children:(0,r.jsx)("path",{fill:"currentColor",d:"M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"})}),json:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",className:u,children:(0,r.jsx)("path",{fill:"currentColor",d:"M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"})}),yaml:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",className:u,children:(0,r.jsx)("path",{fill:"currentColor",d:"M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"})}),markdown:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 208 128",className:u,children:[(0,r.jsx)("rect",{width:"198",height:"118",x:"5",y:"5",ry:"10",stroke:"currentColor",strokeWidth:"10",fill:"none"}),(0,r.jsx)("path",{d:"M30 98V30h20l20 25 20-25h20v68H90V59L70 84 50 59v39zm125 0l-30-33h20V30h20v35h20z",fill:"currentColor"})]}),sql:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",className:u,children:(0,r.jsx)("path",{fill:"currentColor",d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"})})},h=(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",className:u,children:(0,r.jsx)("path",{fill:"currentColor",d:"M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"})}),p["string"==typeof A&&A?A.toLowerCase():""]||h),(0,r.jsx)("span",{children:A})]}),(0,r.jsx)("button",{ref:y,type:"button","aria-label":"\u590D\u5236\u4EE3\u7801",className:"copyButton_H_xL",onClick:()=>{if(v.current){let e=v.current.textContent;(0,a.A)(e),b(!0),setTimeout(()=>{b(!1)},2e3)}},children:S?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",className:g,children:(0,r.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})}),(0,r.jsx)("span",{children:"\u5DF2\u590D\u5236"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",className:g,children:(0,r.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),(0,r.jsx)("span",{children:"\u590D\u5236"})]})})]})]}),(0,r.jsx)("div",{className:"codeBlockContent_vqWU",ref:R,children:(0,r.jsx)(l.f4,{code:e.trim(),language:A||"text",theme:k,children:({className:e,style:n,tokens:t,getLineProps:i,getTokenProps:l})=>(0,r.jsx)("pre",{className:(0,s.A)(e,"codeBlock_wPnj"),style:n,children:(0,r.jsx)("code",{className:"codeBlockLines_fQUY",children:t.map((e,n)=>{1===e.length&&"\n"===e[0].content&&(e[0].content="");let{key:t,...a}=i({line:e,key:n});return(0,r.jsxs)("div",{...a,className:(0,s.A)(a.className,"codeLine_fSta"),children:[(0,r.jsx)("span",{className:"codeLineNumber_x9bH",children:n+1}),(0,r.jsx)("span",{className:"codeLineContent_HA3z",children:e.map((e,n)=>{let{key:t,...i}=l({token:e,key:n});return(0,r.jsx)("span",{...i},t||n)})})]},t||n)})})})})})]})}},28453:function(e,n,t){t.d(n,{R:()=>l,x:()=>a});var r=t(96540);let i={},s=r.createContext(i);function l(e){let n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(s.Provider,{value:n},e.children)}},33436:function(e,n,t){t.d(n,{A:()=>r});function r(e,{target:n=document.body}={}){if("string"!=typeof e)throw TypeError(`Expected parameter \`text\` to be a \`string\`, got \`${typeof e}\`.`);let t=document.createElement("textarea"),i=document.activeElement;t.value=e,t.setAttribute("readonly",""),t.style.all="unset",t.style.contain="strict",t.style.position="absolute",t.style.left="-9999px",t.style.width="2em",t.style.height="2em",t.style.padding="0",t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.style.fontSize="12pt",t.style.whiteSpace="pre";let s=document.getSelection(),l=s.rangeCount>0&&s.getRangeAt(0);n.append(t),t.select(),t.selectionStart=0,t.selectionEnd=e.length;let a=!1;try{a=document.execCommand("copy")}catch{}return t.remove(),l&&(s.removeAllRanges(),s.addRange(l)),i&&i.focus(),a}}}]);