"use strict";(self.webpackChunkfullstack_dev_blog=self.webpackChunkfullstack_dev_blog||[]).push([["63293"],{85682:function(e,n,r){r.r(n),r.d(n,{metadata:()=>i,default:()=>u,frontMatter:()=>t,contentTitle:()=>c,toc:()=>d,assets:()=>a});var i=JSON.parse('{"id":"backend/distributed-systems/distributed-cache","title":"\u5206\u5E03\u5F0F\u7F13\u5B58\u67B6\u6784\u8BE6\u89E3","description":"\u5168\u9762\u4ECB\u7ECD\u5206\u5E03\u5F0F\u7F13\u5B58\u67B6\u6784\u3001\u7B56\u7565\u3001\u4E00\u81F4\u6027\u4FDD\u8BC1\u4E0E\u6700\u4F73\u5B9E\u8DF5","source":"@site/docs/backend/distributed-systems/distributed-cache.mdx","sourceDirName":"backend/distributed-systems","slug":"/backend/distributed-systems/distributed-cache","permalink":"/en/docs/backend/distributed-systems/distributed-cache","draft":false,"unlisted":false,"editUrl":"https://github.com/MasterLiu93/blog-web/tree/main/docs/backend/distributed-systems/distributed-cache.mdx","tags":[],"version":"current","lastUpdatedBy":"Laby","lastUpdatedAt":1736208000000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"\u5206\u5E03\u5F0F\u7F13\u5B58\u67B6\u6784\u8BE6\u89E3","description":"\u5168\u9762\u4ECB\u7ECD\u5206\u5E03\u5F0F\u7F13\u5B58\u67B6\u6784\u3001\u7B56\u7565\u3001\u4E00\u81F4\u6027\u4FDD\u8BC1\u4E0E\u6700\u4F73\u5B9E\u8DF5","authors":["Laby"],"last_update":{"date":"2025-01-07T00:00:00.000Z","author":"Laby"}},"sidebar":"tutorialSidebar","previous":{"title":"\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7406\u8BBA\u57FA\u7840\u8BE6\u89E3","permalink":"/en/docs/backend/distributed-systems/distributed-theory"},"next":{"title":"\u5206\u5E03\u5F0F\u9501\u5B9E\u73B0\u65B9\u6848\u8BE6\u89E3","permalink":"/en/docs/backend/distributed-systems/distributed-lock"}}'),s=r(74848),l=r(28453);let t={sidebar_position:4,title:"\u5206\u5E03\u5F0F\u7F13\u5B58\u67B6\u6784\u8BE6\u89E3",description:"\u5168\u9762\u4ECB\u7ECD\u5206\u5E03\u5F0F\u7F13\u5B58\u67B6\u6784\u3001\u7B56\u7565\u3001\u4E00\u81F4\u6027\u4FDD\u8BC1\u4E0E\u6700\u4F73\u5B9E\u8DF5",authors:["Laby"],last_update:{date:new Date("2025-01-07T00:00:00.000Z"),author:"Laby"}},c="\u5206\u5E03\u5F0F\u7F13\u5B58\u67B6\u6784\u8BE6\u89E3",a={},d=[{value:"1. \u7F13\u5B58\u67B6\u6784\u8BBE\u8BA1",id:"1-\u7F13\u5B58\u67B6\u6784\u8BBE\u8BA1",level:2},{value:"1.1 \u7F13\u5B58\u5206\u7C7B",id:"11-\u7F13\u5B58\u5206\u7C7B",level:3},{value:"\u672C\u5730\u7F13\u5B58\uFF08Local Cache\uFF09",id:"\u672C\u5730\u7F13\u5B58local-cache",level:4},{value:"\u8FDC\u7A0B\u7F13\u5B58\uFF08Remote Cache\uFF09",id:"\u8FDC\u7A0B\u7F13\u5B58remote-cache",level:4},{value:"\u591A\u7EA7\u7F13\u5B58\uFF08Multi-Level Cache\uFF09",id:"\u591A\u7EA7\u7F13\u5B58multi-level-cache",level:4},{value:"1.2 \u7F13\u5B58\u8BFB\u5199\u6A21\u5F0F",id:"12-\u7F13\u5B58\u8BFB\u5199\u6A21\u5F0F",level:3},{value:"Cache-Aside\u6A21\u5F0F\uFF08\u65C1\u8DEF\u7F13\u5B58\uFF09",id:"cache-aside\u6A21\u5F0F\u65C1\u8DEF\u7F13\u5B58",level:4},{value:"Read/Write-Through\u6A21\u5F0F\uFF08\u8BFB\u5199\u7A7F\u900F\uFF09",id:"readwrite-through\u6A21\u5F0F\u8BFB\u5199\u7A7F\u900F",level:4},{value:"Write-Behind\u6A21\u5F0F\uFF08\u5F02\u6B65\u5199\u5165\uFF09",id:"write-behind\u6A21\u5F0F\u5F02\u6B65\u5199\u5165",level:4},{value:"2. \u7F13\u5B58\u7B56\u7565\u4E0E\u4F18\u5316",id:"2-\u7F13\u5B58\u7B56\u7565\u4E0E\u4F18\u5316",level:2},{value:"2.1 \u7F13\u5B58\u952E\u8BBE\u8BA1",id:"21-\u7F13\u5B58\u952E\u8BBE\u8BA1",level:3},{value:"\u952E\u547D\u540D\u89C4\u8303",id:"\u952E\u547D\u540D\u89C4\u8303",level:4},{value:"\u952E\u957F\u5EA6\u4F18\u5316",id:"\u952E\u957F\u5EA6\u4F18\u5316",level:4},{value:"2.2 \u8FC7\u671F\u7B56\u7565",id:"22-\u8FC7\u671F\u7B56\u7565",level:3},{value:"TTL\uFF08Time To Live\uFF09\u7B56\u7565",id:"ttltime-to-live\u7B56\u7565",level:4},{value:"2.3 \u70ED\u70B9\u4FDD\u62A4\u7B56\u7565",id:"23-\u70ED\u70B9\u4FDD\u62A4\u7B56\u7565",level:3},{value:"\u4E92\u65A5\u9501\u4FDD\u62A4",id:"\u4E92\u65A5\u9501\u4FDD\u62A4",level:4},{value:"SingleFlight\u6A21\u5F0F",id:"singleflight\u6A21\u5F0F",level:4},{value:"2.4 \u7F13\u5B58\u4E00\u81F4\u6027\u7B56\u7565",id:"24-\u7F13\u5B58\u4E00\u81F4\u6027\u7B56\u7565",level:3},{value:"\u5931\u6548\u7B56\u7565\uFF08Cache-Aside\uFF09",id:"\u5931\u6548\u7B56\u7565cache-aside",level:4},{value:"\u66F4\u65B0\u7B56\u7565",id:"\u66F4\u65B0\u7B56\u7565",level:4},{value:"\u7F13\u5B58\u4E00\u81F4\u6027",id:"\u7F13\u5B58\u4E00\u81F4\u6027",level:2},{value:"3. \u7F13\u5B58\u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848",id:"3-\u7F13\u5B58\u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848",level:2},{value:"3.1 \u7F13\u5B58\u7A7F\u900F\uFF08Cache Penetration\uFF09",id:"31-\u7F13\u5B58\u7A7F\u900Fcache-penetration",level:3},{value:"\u95EE\u9898\u5206\u6790",id:"\u95EE\u9898\u5206\u6790",level:4},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848",level:4},{value:"3.2 \u7F13\u5B58\u51FB\u7A7F\uFF08Cache Breakdown\uFF09",id:"32-\u7F13\u5B58\u51FB\u7A7Fcache-breakdown",level:3},{value:"\u95EE\u9898\u5206\u6790",id:"\u95EE\u9898\u5206\u6790-1",level:4},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-1",level:4},{value:"3.3 \u7F13\u5B58\u96EA\u5D29\uFF08Cache Avalanche\uFF09",id:"33-\u7F13\u5B58\u96EA\u5D29cache-avalanche",level:3},{value:"\u95EE\u9898\u5206\u6790",id:"\u95EE\u9898\u5206\u6790-2",level:4},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-2",level:4},{value:"4. \u7F13\u5B58\u76D1\u63A7\u4E0E\u8FD0\u7EF4",id:"4-\u7F13\u5B58\u76D1\u63A7\u4E0E\u8FD0\u7EF4",level:2},{value:"4.1 \u5173\u952E\u76D1\u63A7\u6307\u6807",id:"41-\u5173\u952E\u76D1\u63A7\u6307\u6807",level:3},{value:"\u6027\u80FD\u6307\u6807",id:"\u6027\u80FD\u6307\u6807",level:4},{value:"\u5BB9\u91CF\u6307\u6807",id:"\u5BB9\u91CF\u6307\u6807",level:4},{value:"\u4E1A\u52A1\u6307\u6807",id:"\u4E1A\u52A1\u6307\u6807",level:4},{value:"4.2 \u544A\u8B66\u7B56\u7565",id:"42-\u544A\u8B66\u7B56\u7565",level:3},{value:"4.3 \u8FD0\u7EF4\u6700\u4F73\u5B9E\u8DF5",id:"43-\u8FD0\u7EF4\u6700\u4F73\u5B9E\u8DF5",level:3},{value:"\u5BB9\u91CF\u89C4\u5212",id:"\u5BB9\u91CF\u89C4\u5212",level:4},{value:"5. \u5206\u5E03\u5F0F\u7F13\u5B58\u9762\u8BD5\u9898\u7CBE\u9009",id:"5-\u5206\u5E03\u5F0F\u7F13\u5B58\u9762\u8BD5\u9898\u7CBE\u9009",level:2},{value:"5.1 \u57FA\u7840\u6982\u5FF5",id:"51-\u57FA\u7840\u6982\u5FF5",level:3},{value:"Q1: \u4EC0\u4E48\u662F\u5206\u5E03\u5F0F\u7F13\u5B58\uFF1F\u5B83\u7684\u4E3B\u8981\u4F5C\u7528\u662F\u4EC0\u4E48\uFF1F",id:"q1-\u4EC0\u4E48\u662F\u5206\u5E03\u5F0F\u7F13\u5B58\u5B83\u7684\u4E3B\u8981\u4F5C\u7528\u662F\u4EC0\u4E48",level:4},{value:"Q2: \u672C\u5730\u7F13\u5B58\u548C\u5206\u5E03\u5F0F\u7F13\u5B58\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F",id:"q2-\u672C\u5730\u7F13\u5B58\u548C\u5206\u5E03\u5F0F\u7F13\u5B58\u7684\u533A\u522B\u662F\u4EC0\u4E48",level:4},{value:"5.2 \u7F13\u5B58\u7B56\u7565",id:"52-\u7F13\u5B58\u7B56\u7565",level:3},{value:"Q3: Cache-Aside\u3001Write-Through\u3001Write-Behind\u4E09\u79CD\u7F13\u5B58\u6A21\u5F0F\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F",id:"q3-cache-asidewrite-throughwrite-behind\u4E09\u79CD\u7F13\u5B58\u6A21\u5F0F\u7684\u533A\u522B\u662F\u4EC0\u4E48",level:4},{value:"Q4: \u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u7A7F\u900F\u95EE\u9898\uFF1F",id:"q4-\u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u7A7F\u900F\u95EE\u9898",level:4},{value:"5.3 \u7F13\u5B58\u95EE\u9898",id:"53-\u7F13\u5B58\u95EE\u9898",level:3},{value:"Q5: \u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u51FB\u7A7F\u95EE\u9898\uFF1F",id:"q5-\u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u51FB\u7A7F\u95EE\u9898",level:4},{value:"Q6: \u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u96EA\u5D29\u95EE\u9898\uFF1F",id:"q6-\u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u96EA\u5D29\u95EE\u9898",level:4},{value:"5.4 \u9AD8\u7EA7\u95EE\u9898",id:"54-\u9AD8\u7EA7\u95EE\u9898",level:3},{value:"Q7: \u53CC\u5220\u7B56\u7565\u4E3A\u4EC0\u4E48\u8981\u5EF6\u8FDF\uFF1F\u5EF6\u8FDF\u591A\u957F\u65F6\u95F4\u5408\u9002\uFF1F",id:"q7-\u53CC\u5220\u7B56\u7565\u4E3A\u4EC0\u4E48\u8981\u5EF6\u8FDF\u5EF6\u8FDF\u591A\u957F\u65F6\u95F4\u5408\u9002",level:4},{value:"Q8: \u591A\u7EA7\u7F13\u5B58\u4E00\u81F4\u6027\u5982\u4F55\u4FDD\u8BC1\uFF1F",id:"q8-\u591A\u7EA7\u7F13\u5B58\u4E00\u81F4\u6027\u5982\u4F55\u4FDD\u8BC1",level:4},{value:"Q9: \u5982\u4F55\u8BC6\u522B\u4E0E\u6CBB\u7406\u70ED\u70B9Key\uFF1F",id:"q9-\u5982\u4F55\u8BC6\u522B\u4E0E\u6CBB\u7406\u70ED\u70B9key",level:4},{value:"5.5 \u6027\u80FD\u4F18\u5316",id:"55-\u6027\u80FD\u4F18\u5316",level:3},{value:"Q10: \u5982\u4F55\u4F18\u5316\u7F13\u5B58\u6027\u80FD\uFF1F",id:"q10-\u5982\u4F55\u4F18\u5316\u7F13\u5B58\u6027\u80FD",level:4},{value:"6. \u603B\u7ED3",id:"6-\u603B\u7ED3",level:2},{value:"\u5173\u952E\u8981\u70B9",id:"\u5173\u952E\u8981\u70B9",level:3}];function h(e){let n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u5206\u5E03\u5F0F\u7F13\u5B58\u67B6\u6784\u8BE6\u89E3",children:"\u5206\u5E03\u5F0F\u7F13\u5B58\u67B6\u6784\u8BE6\u89E3"})}),"\n",(0,s.jsx)(n.p,{children:"\u5206\u5E03\u5F0F\u7F13\u5B58\u662F\u73B0\u4EE3\u4E92\u8054\u7F51\u5E94\u7528\u7684\u6838\u5FC3\u7EC4\u4EF6\uFF0C\u7528\u4E8E\u63D0\u5347\u8BFB\u6027\u80FD\u3001\u524A\u5CF0\u586B\u8C37\u4E0E\u964D\u4F4E\u540E\u7AEF\u538B\u529B\u3002\u672C\u7AE0\u5C06\u8BE6\u7EC6\u4ECB\u7ECD\u5206\u5E03\u5F0F\u7F13\u5B58\u7684\u67B6\u6784\u8BBE\u8BA1\u3001\u4E00\u81F4\u6027\u7B56\u7565\u3001\u6027\u80FD\u4F18\u5316\u548C\u6700\u4F73\u5B9E\u8DF5\u3002"}),"\n",(0,s.jsx)(n.admonition,{title:"\u7F13\u5B58\u7684\u4EF7\u503C",type:"tip",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u6027\u80FD\u63D0\u5347"}),"\uFF1A\u5C06\u70ED\u70B9\u6570\u636E\u5B58\u50A8\u5728\u5185\u5B58\u4E2D\uFF0C\u5927\u5E45\u63D0\u5347\u8BBF\u95EE\u901F\u5EA6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u538B\u529B\u7F13\u89E3"}),"\uFF1A\u51CF\u5C11\u5BF9\u6570\u636E\u5E93\u7684\u76F4\u63A5\u8BBF\u95EE\uFF0C\u964D\u4F4E\u6570\u636E\u5E93\u538B\u529B"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u6210\u672C\u4F18\u5316"}),"\uFF1A\u901A\u8FC7\u7F13\u5B58\u51CF\u5C11\u6602\u8D35\u7684\u6570\u636E\u5E93\u67E5\u8BE2\u548C\u8BA1\u7B97"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7528\u6237\u4F53\u9A8C"}),"\uFF1A\u63D0\u5347\u7CFB\u7EDF\u54CD\u5E94\u901F\u5EA6\uFF0C\u6539\u5584\u7528\u6237\u4F53\u9A8C"]}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"1-\u7F13\u5B58\u67B6\u6784\u8BBE\u8BA1",children:"1. \u7F13\u5B58\u67B6\u6784\u8BBE\u8BA1"}),"\n",(0,s.jsx)(n.h3,{id:"11-\u7F13\u5B58\u5206\u7C7B",children:"1.1 \u7F13\u5B58\u5206\u7C7B"}),"\n",(0,s.jsx)(n.p,{children:"\u5206\u5E03\u5F0F\u7F13\u5B58\u6309\u7167\u90E8\u7F72\u4F4D\u7F6E\u548C\u8BBF\u95EE\u65B9\u5F0F\u53EF\u4EE5\u5206\u4E3A\u4EE5\u4E0B\u51E0\u7C7B\uFF1A"}),"\n",(0,s.jsx)(n.h4,{id:"\u672C\u5730\u7F13\u5B58local-cache",children:"\u672C\u5730\u7F13\u5B58\uFF08Local Cache\uFF09"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7279\u70B9"}),"\uFF1A\u8FDB\u7A0B\u5185\u7F13\u5B58\uFF0C\u8BBF\u95EE\u901F\u5EA6\u6781\u5FEB\uFF0C\u5BB9\u91CF\u6709\u9650"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5B9E\u73B0"}),"\uFF1AGuava Caches\u3001Caffeine\u3001Ehcache"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u9002\u7528\u573A\u666F"}),"\uFF1A\u9AD8\u9891\u8BBF\u95EE\u7684\u914D\u7F6E\u4FE1\u606F\u3001\u8BA1\u7B97\u7ED3\u679C"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u672C\u5730\u7F13\u5B58\u793A\u4F8B"',children:"public class LocalCacheExample {\n    // \u4F7F\u7528Caffeine\u6784\u5EFA\u9AD8\u6027\u80FD\u672C\u5730\u7F13\u5B58\n    private final Cache<String, User> userCache = Caffeine.newBuilder()\n        .maximumSize(10_000)                    // \u6700\u5927\u5BB9\u91CF\n        .expireAfterWrite(1, TimeUnit.HOURS)    // \u5199\u5165\u540E1\u5C0F\u65F6\u8FC7\u671F\n        .expireAfterAccess(30, TimeUnit.MINUTES) // \u8BBF\u95EE\u540E30\u5206\u949F\u8FC7\u671F\n        .recordStats()                          // \u8BB0\u5F55\u7EDF\u8BA1\u4FE1\u606F\n        .build();\n    \n    public User getUser(String userId) {\n        return userCache.get(userId, key -> {\n            // \u7F13\u5B58\u672A\u547D\u4E2D\u65F6\u7684\u52A0\u8F7D\u903B\u8F91\n            return loadUserFromDatabase(key);\n        });\n    }\n    \n    private User loadUserFromDatabase(String userId) {\n        // \u4ECE\u6570\u636E\u5E93\u52A0\u8F7D\u7528\u6237\u4FE1\u606F\n        return userRepository.findById(userId);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u8FDC\u7A0B\u7F13\u5B58remote-cache",children:"\u8FDC\u7A0B\u7F13\u5B58\uFF08Remote Cache\uFF09"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7279\u70B9"}),"\uFF1A\u96C6\u4E2D\u7BA1\u7406\u7684\u5206\u5E03\u5F0F\u7F13\u5B58\uFF0C\u5BB9\u91CF\u5927\uFF0C\u652F\u6301\u96C6\u7FA4"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5B9E\u73B0"}),"\uFF1ARedis\u3001Memcached\u3001Hazelcast"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u9002\u7528\u573A\u666F"}),"\uFF1A\u8DE8\u670D\u52A1\u5171\u4EAB\u6570\u636E\u3001\u5927\u89C4\u6A21\u6570\u636E\u7F13\u5B58"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="Redis\u7F13\u5B58\u793A\u4F8B"',children:'@Service\npublic class RedisCacheService {\n    @Autowired\n    private RedisTemplate<String, Object> redisTemplate;\n    \n    public User getUser(String userId) {\n        String key = "user:" + userId;\n        \n        // \u5148\u4ECE\u7F13\u5B58\u83B7\u53D6\n        User user = (User) redisTemplate.opsForValue().get(key);\n        if (user != null) {\n            return user;\n        }\n        \n        // \u7F13\u5B58\u672A\u547D\u4E2D\uFF0C\u4ECE\u6570\u636E\u5E93\u52A0\u8F7D\n        user = userRepository.findById(userId);\n        if (user != null) {\n            // \u8BBE\u7F6E\u7F13\u5B58\uFF0C\u8FC7\u671F\u65F6\u95F430\u5206\u949F\n            redisTemplate.opsForValue().set(key, user, 30, TimeUnit.MINUTES);\n        }\n        \n        return user;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"\u591A\u7EA7\u7F13\u5B58multi-level-cache",children:"\u591A\u7EA7\u7F13\u5B58\uFF08Multi-Level Cache\uFF09"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7279\u70B9"}),"\uFF1A\u672C\u5730\u7F13\u5B58 + \u8FDC\u7A0B\u7F13\u5B58\u7684\u7EC4\u5408\uFF0C\u5F62\u6210\u7F13\u5B58\u5C42\u6B21"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4F18\u52BF"}),"\uFF1A\u7ED3\u5408\u672C\u5730\u7F13\u5B58\u7684\u5FEB\u901F\u8BBF\u95EE\u548C\u8FDC\u7A0B\u7F13\u5B58\u7684\u5927\u5BB9\u91CF"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u6311\u6218"}),"\uFF1A\u7F13\u5B58\u4E00\u81F4\u6027\u7684\u4FDD\u8BC1"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u591A\u7EA7\u7F13\u5B58\u793A\u4F8B"',children:"public class MultiLevelCache {\n    private final Cache<String, Object> localCache;  // \u672C\u5730\u7F13\u5B58\n    private final RedisTemplate<String, Object> redisCache; // \u8FDC\u7A0B\u7F13\u5B58\n    \n    public Object get(String key) {\n        // \u7B2C\u4E00\u7EA7\uFF1A\u672C\u5730\u7F13\u5B58\n        Object value = localCache.getIfPresent(key);\n        if (value != null) {\n            return value;\n        }\n        \n        // \u7B2C\u4E8C\u7EA7\uFF1A\u8FDC\u7A0B\u7F13\u5B58\n        value = redisCache.opsForValue().get(key);\n        if (value != null) {\n            // \u56DE\u586B\u672C\u5730\u7F13\u5B58\n            localCache.put(key, value);\n            return value;\n        }\n        \n        // \u7B2C\u4E09\u7EA7\uFF1A\u6570\u636E\u5E93\n        value = loadFromDatabase(key);\n        if (value != null) {\n            // \u540C\u65F6\u66F4\u65B0\u4E24\u7EA7\u7F13\u5B58\n            redisCache.opsForValue().set(key, value, 30, TimeUnit.MINUTES);\n            localCache.put(key, value);\n        }\n        \n        return value;\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"12-\u7F13\u5B58\u8BFB\u5199\u6A21\u5F0F",children:"1.2 \u7F13\u5B58\u8BFB\u5199\u6A21\u5F0F"}),"\n",(0,s.jsx)(n.h4,{id:"cache-aside\u6A21\u5F0F\u65C1\u8DEF\u7F13\u5B58",children:"Cache-Aside\u6A21\u5F0F\uFF08\u65C1\u8DEF\u7F13\u5B58\uFF09"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u539F\u7406"}),"\uFF1A\u5E94\u7528\u7A0B\u5E8F\u76F4\u63A5\u7BA1\u7406\u7F13\u5B58\uFF0C\u5148\u67E5\u7F13\u5B58\uFF0C\u672A\u547D\u4E2D\u5219\u67E5\u6570\u636E\u5E93"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4F18\u70B9"}),"\uFF1A\u5B9E\u73B0\u7B80\u5355\uFF0C\u7F13\u5B58\u7B56\u7565\u7075\u6D3B"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7F3A\u70B9"}),"\uFF1A\u9700\u8981\u624B\u52A8\u7BA1\u7406\u7F13\u5B58\u4E00\u81F4\u6027"]}),"\n"]}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant Cache\n    participant Database\n    \n    Client->>Cache: \u67E5\u8BE2\u6570\u636E\n    alt \u7F13\u5B58\u547D\u4E2D\n        Cache--\x3e>Client: \u8FD4\u56DE\u7F13\u5B58\u6570\u636E\n    else \u7F13\u5B58\u672A\u547D\u4E2D\n        Cache--\x3e>Client: \u8FD4\u56DEnull\n        Client->>Database: \u67E5\u8BE2\u6570\u636E\u5E93\n        Database--\x3e>Client: \u8FD4\u56DE\u6570\u636E\n        Client->>Cache: \u66F4\u65B0\u7F13\u5B58\n    end"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="Cache-Aside\u6A21\u5F0F\u793A\u4F8B"',children:'@Service\npublic class CacheAsideService {\n    \n    public User getUser(String userId) {\n        // 1. \u5148\u67E5\u7F13\u5B58\n        String cacheKey = "user:" + userId;\n        User user = (User) redisTemplate.opsForValue().get(cacheKey);\n        \n        if (user != null) {\n            return user;\n        }\n        \n        // 2. \u7F13\u5B58\u672A\u547D\u4E2D\uFF0C\u67E5\u6570\u636E\u5E93\n        user = userRepository.findById(userId);\n        \n        if (user != null) {\n            // 3. \u66F4\u65B0\u7F13\u5B58\n            redisTemplate.opsForValue().set(cacheKey, user, 30, TimeUnit.MINUTES);\n        }\n        \n        return user;\n    }\n    \n    public void updateUser(User user) {\n        // 1. \u66F4\u65B0\u6570\u636E\u5E93\n        userRepository.save(user);\n        \n        // 2. \u5220\u9664\u7F13\u5B58\uFF08Cache-Aside\u7684\u5199\u7B56\u7565\uFF09\n        String cacheKey = "user:" + user.getId();\n        redisTemplate.delete(cacheKey);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"readwrite-through\u6A21\u5F0F\u8BFB\u5199\u7A7F\u900F",children:"Read/Write-Through\u6A21\u5F0F\uFF08\u8BFB\u5199\u7A7F\u900F\uFF09"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u539F\u7406"}),"\uFF1A\u7F13\u5B58\u4F5C\u4E3A\u6570\u636E\u5E93\u7684\u4EE3\u7406\uFF0C\u6240\u6709\u8BFB\u5199\u90FD\u7ECF\u8FC7\u7F13\u5B58"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4F18\u70B9"}),"\uFF1A\u7F13\u5B58\u4E00\u81F4\u6027\u5BB9\u6613\u4FDD\u8BC1"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7F3A\u70B9"}),"\uFF1A\u589E\u52A0\u4E86\u7CFB\u7EDF\u590D\u6742\u6027"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="Read/Write-Through\u6A21\u5F0F\u793A\u4F8B"',children:"@Service\npublic class WriteThroughService {\n    \n    public User getUser(String userId) {\n        // \u76F4\u63A5\u901A\u8FC7\u7F13\u5B58\u8BFB\u53D6\uFF0C\u7F13\u5B58\u8D1F\u8D23\u4E0E\u6570\u636E\u5E93\u4EA4\u4E92\n        return cacheManager.getUser(userId);\n    }\n    \n    public void updateUser(User user) {\n        // \u76F4\u63A5\u5199\u5165\u7F13\u5B58\uFF0C\u7F13\u5B58\u8D1F\u8D23\u540C\u6B65\u5230\u6570\u636E\u5E93\n        cacheManager.updateUser(user);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"write-behind\u6A21\u5F0F\u5F02\u6B65\u5199\u5165",children:"Write-Behind\u6A21\u5F0F\uFF08\u5F02\u6B65\u5199\u5165\uFF09"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u539F\u7406"}),"\uFF1A\u5199\u64CD\u4F5C\u5148\u66F4\u65B0\u7F13\u5B58\uFF0C\u7136\u540E\u5F02\u6B65\u6279\u91CF\u5199\u5165\u6570\u636E\u5E93"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4F18\u70B9"}),"\uFF1A\u5199\u5165\u6027\u80FD\u9AD8\uFF0C\u51CF\u5C11\u6570\u636E\u5E93\u538B\u529B"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7F3A\u70B9"}),"\uFF1A\u6570\u636E\u53EF\u80FD\u4E22\u5931\uFF0C\u4E00\u81F4\u6027\u8F83\u5F31"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="Write-Behind\u6A21\u5F0F\u793A\u4F8B"',children:'@Service\npublic class WriteBehindService {\n    private final Queue<WriteOperation> writeQueue = new ConcurrentLinkedQueue<>();\n    \n    public void updateUser(User user) {\n        // 1. \u7ACB\u5373\u66F4\u65B0\u7F13\u5B58\n        String cacheKey = "user:" + user.getId();\n        redisTemplate.opsForValue().set(cacheKey, user);\n        \n        // 2. \u5F02\u6B65\u5199\u5165\u6570\u636E\u5E93\n        writeQueue.offer(new WriteOperation(user));\n    }\n    \n    @Scheduled(fixedRate = 5000) // \u6BCF5\u79D2\u6279\u91CF\u5199\u5165\n    public void batchWrite() {\n        List<WriteOperation> operations = new ArrayList<>();\n        WriteOperation op;\n        \n        // \u6536\u96C6\u5F85\u5199\u5165\u7684\u64CD\u4F5C\n        while ((op = writeQueue.poll()) != null) {\n            operations.add(op);\n        }\n        \n        // \u6279\u91CF\u5199\u5165\u6570\u636E\u5E93\n        if (!operations.isEmpty()) {\n            userRepository.saveAll(operations.stream()\n                .map(WriteOperation::getUser)\n                .collect(Collectors.toList()));\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TD;\n  Client--\x3eLocalCache;\n  LocalCache--miss--\x3eRedis;\n  Redis--miss--\x3eDB;\n  DB--data--\x3eRedis;\n  Redis--data--\x3eLocalCache;\n  LocalCache--data--\x3eClient;"}),"\n",(0,s.jsx)(n.h2,{id:"2-\u7F13\u5B58\u7B56\u7565\u4E0E\u4F18\u5316",children:"2. \u7F13\u5B58\u7B56\u7565\u4E0E\u4F18\u5316"}),"\n",(0,s.jsx)(n.h3,{id:"21-\u7F13\u5B58\u952E\u8BBE\u8BA1",children:"2.1 \u7F13\u5B58\u952E\u8BBE\u8BA1"}),"\n",(0,s.jsx)(n.p,{children:"\u826F\u597D\u7684\u7F13\u5B58\u952E\u8BBE\u8BA1\u662F\u7F13\u5B58\u7CFB\u7EDF\u6210\u529F\u7684\u5173\u952E\u56E0\u7D20\u4E4B\u4E00\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u952E\u547D\u540D\u89C4\u8303",children:"\u952E\u547D\u540D\u89C4\u8303"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5C42\u7EA7\u7ED3\u6784"}),"\uFF1A\u4F7F\u7528\u5192\u53F7\u5206\u9694\uFF0C\u5F62\u6210\u5C42\u7EA7\u5173\u7CFB"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4E1A\u52A1\u6807\u8BC6"}),"\uFF1A\u5305\u542B\u4E1A\u52A1\u6A21\u5757\u3001\u5B9E\u4F53\u7C7B\u578B\u3001ID\u7B49\u4FE1\u606F"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7248\u672C\u63A7\u5236"}),"\uFF1A\u652F\u6301\u7F13\u5B58\u7248\u672C\u5347\u7EA7\u548C\u6279\u91CF\u5931\u6548"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u7F13\u5B58\u952E\u8BBE\u8BA1\u793A\u4F8B"',children:'public class CacheKeyGenerator {\n    \n    // \u7528\u6237\u4FE1\u606F\u7F13\u5B58\u952E\n    public static String userKey(String userId) {\n        return String.format("user:info:%s", userId);\n    }\n    \n    // \u7528\u6237\u6743\u9650\u7F13\u5B58\u952E\n    public static String userPermissionKey(String userId) {\n        return String.format("user:permission:%s", userId);\n    }\n    \n    // \u5546\u54C1\u8BE6\u60C5\u7F13\u5B58\u952E\n    public static String productKey(String productId) {\n        return String.format("product:detail:%s", productId);\n    }\n    \n    // \u5546\u54C1\u5217\u8868\u7F13\u5B58\u952E\uFF08\u652F\u6301\u5206\u9875\uFF09\n    public static String productListKey(int page, int size, String category) {\n        return String.format("product:list:%s:%d:%d", category, page, size);\n    }\n    \n    // \u5E26\u7248\u672C\u7684\u7F13\u5B58\u952E\n    public static String versionedKey(String baseKey, String version) {\n        return String.format("%s:v%s", baseKey, version);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"\u952E\u957F\u5EA6\u4F18\u5316",children:"\u952E\u957F\u5EA6\u4F18\u5316"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u952E\u957F\u5EA6\u4F18\u5316\u793A\u4F8B"',children:'public class CompactCacheKeyGenerator {\n    \n    // \u4F7F\u7528\u77ED\u524D\u7F00\n    private static final String USER_PREFIX = "u";\n    private static final String PRODUCT_PREFIX = "p";\n    private static final String ORDER_PREFIX = "o";\n    \n    // \u538B\u7F29\u7684\u952E\u683C\u5F0F\n    public static String compactUserKey(String userId) {\n        return String.format("%s:%s", USER_PREFIX, userId);\n    }\n    \n    public static String compactProductKey(String productId) {\n        return String.format("%s:%s", PRODUCT_PREFIX, productId);\n    }\n    \n    // \u4F7F\u7528\u54C8\u5E0C\u503C\u51CF\u5C11\u952E\u957F\u5EA6\n    public static String hashedKey(String originalKey) {\n        return String.valueOf(originalKey.hashCode());\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"22-\u8FC7\u671F\u7B56\u7565",children:"2.2 \u8FC7\u671F\u7B56\u7565"}),"\n",(0,s.jsx)(n.h4,{id:"ttltime-to-live\u7B56\u7565",children:"TTL\uFF08Time To Live\uFF09\u7B56\u7565"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u56FA\u5B9ATTL"}),"\uFF1A\u6240\u6709\u7F13\u5B58\u9879\u4F7F\u7528\u76F8\u540C\u7684\u8FC7\u671F\u65F6\u95F4"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u52A8\u6001TTL"}),"\uFF1A\u6839\u636E\u6570\u636E\u7279\u6027\u8BBE\u7F6E\u4E0D\u540C\u7684\u8FC7\u671F\u65F6\u95F4"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u968F\u673A\u6296\u52A8"}),"\uFF1A\u907F\u514D\u7F13\u5B58\u96EA\u5D29\uFF0C\u9519\u5CF0\u8FC7\u671F"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="TTL\u7B56\u7565\u793A\u4F8B"',children:'public class TTLStrategy {\n    \n    // \u56FA\u5B9ATTL\n    public static final Duration DEFAULT_TTL = Duration.ofMinutes(30);\n    \n    // \u52A8\u6001TTL\u7B56\u7565\n    public static Duration getTTL(String key, Object value) {\n        if (key.startsWith("user:")) {\n            return Duration.ofHours(1);  // \u7528\u6237\u4FE1\u606F1\u5C0F\u65F6\n        } else if (key.startsWith("product:")) {\n            return Duration.ofMinutes(10); // \u5546\u54C1\u4FE1\u606F10\u5206\u949F\n        } else if (key.startsWith("config:")) {\n            return Duration.ofDays(1);   // \u914D\u7F6E\u4FE1\u606F1\u5929\n        }\n        return DEFAULT_TTL;\n    }\n    \n    // \u968F\u673A\u6296\u52A8TTL\n    public static Duration getRandomizedTTL(Duration baseTTL) {\n        long baseSeconds = baseTTL.getSeconds();\n        long randomOffset = (long) (baseSeconds * 0.1 * Math.random()); // 10%\u968F\u673A\u504F\u79FB\n        return Duration.ofSeconds(baseSeconds + randomOffset);\n    }\n    \n    // \u57FA\u4E8E\u8BBF\u95EE\u9891\u7387\u7684TTL\n    public static Duration getFrequencyBasedTTL(int accessCount) {\n        if (accessCount > 1000) {\n            return Duration.ofHours(2);  // \u9AD8\u9891\u8BBF\u95EE\uFF0C\u5EF6\u957FTTL\n        } else if (accessCount > 100) {\n            return Duration.ofMinutes(30); // \u4E2D\u9891\u8BBF\u95EE\uFF0C\u6807\u51C6TTL\n        } else {\n            return Duration.ofMinutes(5);  // \u4F4E\u9891\u8BBF\u95EE\uFF0C\u77EDTTL\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"23-\u70ED\u70B9\u4FDD\u62A4\u7B56\u7565",children:"2.3 \u70ED\u70B9\u4FDD\u62A4\u7B56\u7565"}),"\n",(0,s.jsx)(n.h4,{id:"\u4E92\u65A5\u9501\u4FDD\u62A4",children:"\u4E92\u65A5\u9501\u4FDD\u62A4"}),"\n",(0,s.jsx)(n.p,{children:"\u9632\u6B62\u7F13\u5B58\u51FB\u7A7F\uFF0C\u786E\u4FDD\u540C\u4E00\u65F6\u95F4\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u91CD\u5EFA\u7F13\u5B58\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u4E92\u65A5\u9501\u4FDD\u62A4\u793A\u4F8B"',children:'@Service\npublic class MutexCacheService {\n    private final Map<String, ReentrantLock> locks = new ConcurrentHashMap<>();\n    \n    public User getUser(String userId) {\n        String cacheKey = "user:" + userId;\n        \n        // \u5148\u67E5\u7F13\u5B58\n        User user = (User) redisTemplate.opsForValue().get(cacheKey);\n        if (user != null) {\n            return user;\n        }\n        \n        // \u83B7\u53D6\u8BE5key\u7684\u4E92\u65A5\u9501\n        ReentrantLock lock = locks.computeIfAbsent(cacheKey, k -> new ReentrantLock());\n        \n        try {\n            lock.lock();\n            \n            // \u53CC\u91CD\u68C0\u67E5\uFF0C\u9632\u6B62\u5728\u83B7\u53D6\u9501\u671F\u95F4\u5176\u4ED6\u7EBF\u7A0B\u5DF2\u7ECF\u91CD\u5EFA\u4E86\u7F13\u5B58\n            user = (User) redisTemplate.opsForValue().get(cacheKey);\n            if (user != null) {\n                return user;\n            }\n            \n            // \u91CD\u5EFA\u7F13\u5B58\n            user = userRepository.findById(userId);\n            if (user != null) {\n                redisTemplate.opsForValue().set(cacheKey, user, 30, TimeUnit.MINUTES);\n            }\n            \n            return user;\n        } finally {\n            lock.unlock();\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"singleflight\u6A21\u5F0F",children:"SingleFlight\u6A21\u5F0F"}),"\n",(0,s.jsx)(n.p,{children:"\u4F7F\u7528SingleFlight\u6A21\u5F0F\uFF0C\u786E\u4FDD\u540C\u4E00\u65F6\u95F4\u53EA\u6709\u4E00\u4E2A\u8BF7\u6C42\u91CD\u5EFA\u7F13\u5B58\uFF0C\u5176\u4ED6\u8BF7\u6C42\u7B49\u5F85\u7ED3\u679C\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="SingleFlight\u6A21\u5F0F\u793A\u4F8B"',children:'@Service\npublic class SingleFlightCacheService {\n    private final Map<String, CompletableFuture<User>> flightMap = new ConcurrentHashMap<>();\n    \n    public User getUser(String userId) {\n        String cacheKey = "user:" + userId;\n        \n        // \u5148\u67E5\u7F13\u5B58\n        User user = (User) redisTemplate.opsForValue().get(cacheKey);\n        if (user != null) {\n            return user;\n        }\n        \n        // \u68C0\u67E5\u662F\u5426\u5DF2\u6709\u91CD\u5EFA\u4EFB\u52A1\u5728\u8FDB\u884C\n        CompletableFuture<User> future = flightMap.get(cacheKey);\n        if (future != null) {\n            try {\n                return future.get(5, TimeUnit.SECONDS); // \u7B49\u5F85\u7ED3\u679C\n            } catch (Exception e) {\n                // \u8D85\u65F6\u6216\u5F02\u5E38\uFF0C\u79FB\u9664future\u5E76\u91CD\u65B0\u5C1D\u8BD5\n                flightMap.remove(cacheKey);\n            }\n        }\n        \n        // \u521B\u5EFA\u65B0\u7684\u91CD\u5EFA\u4EFB\u52A1\n        future = CompletableFuture.supplyAsync(() -> {\n            try {\n                User loadedUser = userRepository.findById(userId);\n                if (loadedUser != null) {\n                    redisTemplate.opsForValue().set(cacheKey, loadedUser, 30, TimeUnit.MINUTES);\n                }\n                return loadedUser;\n            } finally {\n                // \u4EFB\u52A1\u5B8C\u6210\u540E\u79FB\u9664future\n                flightMap.remove(cacheKey);\n            }\n        });\n        \n        flightMap.put(cacheKey, future);\n        \n        try {\n            return future.get(5, TimeUnit.SECONDS);\n        } catch (Exception e) {\n            flightMap.remove(cacheKey);\n            throw new RuntimeException("Failed to load user", e);\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"24-\u7F13\u5B58\u4E00\u81F4\u6027\u7B56\u7565",children:"2.4 \u7F13\u5B58\u4E00\u81F4\u6027\u7B56\u7565"}),"\n",(0,s.jsx)(n.h4,{id:"\u5931\u6548\u7B56\u7565cache-aside",children:"\u5931\u6548\u7B56\u7565\uFF08Cache-Aside\uFF09"}),"\n",(0,s.jsx)(n.p,{children:"\u5199\u64CD\u4F5C\u65F6\u5220\u9664\u7F13\u5B58\uFF0C\u8BFB\u64CD\u4F5C\u65F6\u91CD\u5EFA\u7F13\u5B58\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u5931\u6548\u7B56\u7565\u793A\u4F8B"',children:'@Service\npublic class InvalidationStrategy {\n    \n    public void updateUser(User user) {\n        // 1. \u66F4\u65B0\u6570\u636E\u5E93\n        userRepository.save(user);\n        \n        // 2. \u5220\u9664\u7F13\u5B58\n        String cacheKey = "user:" + user.getId();\n        redisTemplate.delete(cacheKey);\n        \n        // 3. \u53EF\u9009\uFF1A\u5EF6\u8FDF\u53CC\u5220\uFF0C\u907F\u514D\u5E76\u53D1\u95EE\u9898\n        scheduleDelayedDelete(cacheKey, 100); // 100ms\u540E\u518D\u6B21\u5220\u9664\n    }\n    \n    private void scheduleDelayedDelete(String key, long delayMs) {\n        CompletableFuture.runAsync(() -> {\n            try {\n                Thread.sleep(delayMs);\n                redisTemplate.delete(key);\n            } catch (InterruptedException e) {\n                Thread.currentThread().interrupt();\n            }\n        });\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"\u66F4\u65B0\u7B56\u7565",children:"\u66F4\u65B0\u7B56\u7565"}),"\n",(0,s.jsx)(n.p,{children:"\u5199\u64CD\u4F5C\u65F6\u540C\u65F6\u66F4\u65B0\u7F13\u5B58\u548C\u6570\u636E\u5E93\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u66F4\u65B0\u7B56\u7565\u793A\u4F8B"',children:'@Service\npublic class UpdateStrategy {\n    \n    @Transactional\n    public void updateUser(User user) {\n        // 1. \u66F4\u65B0\u6570\u636E\u5E93\n        userRepository.save(user);\n        \n        // 2. \u66F4\u65B0\u7F13\u5B58\n        String cacheKey = "user:" + user.getId();\n        redisTemplate.opsForValue().set(cacheKey, user, 30, TimeUnit.MINUTES);\n    }\n    \n    // \u4F7F\u7528\u5206\u5E03\u5F0F\u9501\u4FDD\u8BC1\u66F4\u65B0\u539F\u5B50\u6027\n    public void updateUserWithLock(User user) {\n        String lockKey = "lock:user:" + user.getId();\n        String cacheKey = "user:" + user.getId();\n        \n        try {\n            // \u83B7\u53D6\u5206\u5E03\u5F0F\u9501\n            if (acquireLock(lockKey, 10, TimeUnit.SECONDS)) {\n                // \u66F4\u65B0\u6570\u636E\u5E93\n                userRepository.save(user);\n                \n                // \u66F4\u65B0\u7F13\u5B58\n                redisTemplate.opsForValue().set(cacheKey, user, 30, TimeUnit.MINUTES);\n            }\n        } finally {\n            // \u91CA\u653E\u9501\n            releaseLock(lockKey);\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Redis\u6DD8\u6C70\u7B56\u7565\uFF08redis.conf\uFF09\nmaxmemory 1gb\nmaxmemory-policy allkeys-lru\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u7F13\u5B58\u4E00\u81F4\u6027",children:"\u7F13\u5B58\u4E00\u81F4\u6027"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u6700\u7EC8\u4E00\u81F4\uFF1A\u5199\u5E93\u540E\u5220\u7F13\u5B58\uFF08\u6216\u66F4\u65B0\u7F13\u5B58\uFF09\uFF0C\u5141\u8BB8\u77ED\u6682\u4E0D\u4E00\u81F4"}),"\n",(0,s.jsx)(n.li,{children:"\u5F3A\u4E00\u81F4\uFF1A\u5199\u5165\u94FE\u8DEF\u4E32\u884C\u5316\uFF08\u5148\u5220\u540E\u5199 + \u540C\u6B65\u66F4\u65B0\uFF09\uFF0C\u6210\u672C\u9AD8"}),"\n",(0,s.jsx)(n.li,{children:"\u8BA2\u9605\u901A\u77E5\uFF1A\u901A\u8FC7\u53D1\u5E03\u8BA2\u9605/\u6D41\u901A\u77E5\u5404\u526F\u672C\u5931\u6548"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u53CC\u5220\u793A\u4F8B\uFF1A"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public void updateThenEvict(User user) {\n    // \u5148\u66F4\u65B0DB\n    userRepository.save(user);\n    // \u5220\u7F13\u5B58\n    redisTemplate.delete("user:" + user.getId());\n    // \u5EF6\u8FDF\u53CC\u5220\uFF0C\u907F\u514D\u5E76\u53D1\u8BFB\u5199\u7A7F\u900F\u65E7\u503C\n    java.util.concurrent.CompletableFuture.runAsync(() -> {\n        try { Thread.sleep(300); } catch (InterruptedException ignored) {}\n        redisTemplate.delete("user:" + user.getId());\n    });\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"3-\u7F13\u5B58\u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848",children:"3. \u7F13\u5B58\u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848"}),"\n",(0,s.jsx)(n.h3,{id:"31-\u7F13\u5B58\u7A7F\u900Fcache-penetration",children:"3.1 \u7F13\u5B58\u7A7F\u900F\uFF08Cache Penetration\uFF09"}),"\n",(0,s.jsx)(n.p,{children:"\u7F13\u5B58\u7A7F\u900F\u662F\u6307\u67E5\u8BE2\u4E00\u4E2A\u4E0D\u5B58\u5728\u7684\u6570\u636E\uFF0C\u7531\u4E8E\u7F13\u5B58\u4E2D\u6CA1\u6709\uFF0C\u6BCF\u6B21\u8BF7\u6C42\u90FD\u4F1A\u6253\u5230\u6570\u636E\u5E93\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u95EE\u9898\u5206\u6790",children:"\u95EE\u9898\u5206\u6790"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TD\n    A[\u6076\u610F\u8BF7\u6C42] --\x3e B[\u67E5\u8BE2\u7F13\u5B58]\n    B --\x3e C{\u7F13\u5B58\u547D\u4E2D?}\n    C --\x3e|\u5426| D[\u67E5\u8BE2\u6570\u636E\u5E93]\n    D --\x3e E[\u6570\u636E\u5E93\u8FD4\u56DEnull]\n    E --\x3e F[\u4E0D\u7F13\u5B58null\u503C]\n    F --\x3e G[\u4E0B\u6B21\u8BF7\u6C42\u7EE7\u7EED\u7A7F\u900F]\n    C --\x3e|\u662F| H[\u8FD4\u56DE\u7F13\u5B58\u6570\u636E]"}),"\n",(0,s.jsx)(n.h4,{id:"\u89E3\u51B3\u65B9\u6848",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"1. \u5E03\u9686\u8FC7\u6EE4\u5668"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u5E03\u9686\u8FC7\u6EE4\u5668\u89E3\u51B3\u65B9\u6848"',children:'@Service\npublic class BloomFilterCacheService {\n    private final BloomFilter<String> bloomFilter;\n    private final RedisTemplate<String, Object> redisTemplate;\n    \n    public BloomFilterCacheService() {\n        // \u521B\u5EFA\u5E03\u9686\u8FC7\u6EE4\u5668\uFF0C\u9884\u671F\u5143\u7D20\u6570\u91CF100\u4E07\uFF0C\u8BEF\u5224\u73870.01\n        this.bloomFilter = BloomFilter.create(\n            Funnels.stringFunnel(Charset.defaultCharset()), \n            1_000_000, \n            0.01\n        );\n    }\n    \n    public User getUser(String userId) {\n        // 1. \u5E03\u9686\u8FC7\u6EE4\u5668\u68C0\u67E5\n        if (!bloomFilter.mightContain(userId)) {\n            return null; // \u80AF\u5B9A\u4E0D\u5B58\u5728\n        }\n        \n        // 2. \u67E5\u8BE2\u7F13\u5B58\n        String cacheKey = "user:" + userId;\n        User user = (User) redisTemplate.opsForValue().get(cacheKey);\n        if (user != null) {\n            return user;\n        }\n        \n        // 3. \u67E5\u8BE2\u6570\u636E\u5E93\n        user = userRepository.findById(userId);\n        \n        if (user != null) {\n            // 4. \u66F4\u65B0\u7F13\u5B58\u548C\u5E03\u9686\u8FC7\u6EE4\u5668\n            redisTemplate.opsForValue().set(cacheKey, user, 30, TimeUnit.MINUTES);\n            bloomFilter.put(userId);\n        } else {\n            // 5. \u7F13\u5B58\u7A7A\u503C\uFF0C\u9632\u6B62\u7A7F\u900F\n            redisTemplate.opsForValue().set(cacheKey, null, 5, TimeUnit.MINUTES);\n        }\n        \n        return user;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"2. \u7F13\u5B58\u7A7A\u503C"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u7F13\u5B58\u7A7A\u503C\u89E3\u51B3\u65B9\u6848"',children:'@Service\npublic class NullValueCacheService {\n    \n    public User getUser(String userId) {\n        String cacheKey = "user:" + userId;\n        \n        // \u67E5\u8BE2\u7F13\u5B58\n        Object cached = redisTemplate.opsForValue().get(cacheKey);\n        if (cached != null) {\n            // \u68C0\u67E5\u662F\u5426\u662F\u7A7A\u503C\u6807\u8BB0\n            if (cached instanceof NullValue) {\n                return null;\n            }\n            return (User) cached;\n        }\n        \n        // \u67E5\u8BE2\u6570\u636E\u5E93\n        User user = userRepository.findById(userId);\n        \n        if (user != null) {\n            // \u7F13\u5B58\u7528\u6237\u6570\u636E\n            redisTemplate.opsForValue().set(cacheKey, user, 30, TimeUnit.MINUTES);\n        } else {\n            // \u7F13\u5B58\u7A7A\u503C\u6807\u8BB0\uFF0C\u77EDTTL\n            redisTemplate.opsForValue().set(cacheKey, new NullValue(), 5, TimeUnit.MINUTES);\n        }\n        \n        return user;\n    }\n    \n    // \u7A7A\u503C\u6807\u8BB0\u7C7B\n    private static class NullValue {\n        // \u7528\u4E8E\u6807\u8BC6\u7A7A\u503C\u7684\u6807\u8BB0\u7C7B\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"32-\u7F13\u5B58\u51FB\u7A7Fcache-breakdown",children:"3.2 \u7F13\u5B58\u51FB\u7A7F\uFF08Cache Breakdown\uFF09"}),"\n",(0,s.jsx)(n.p,{children:"\u7F13\u5B58\u51FB\u7A7F\u662F\u6307\u70ED\u70B9key\u5728\u7F13\u5B58\u8FC7\u671F\u7684\u4E00\u77AC\u95F4\uFF0C\u5927\u91CF\u5E76\u53D1\u8BF7\u6C42\u76F4\u63A5\u6253\u5230\u6570\u636E\u5E93\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u95EE\u9898\u5206\u6790-1",children:"\u95EE\u9898\u5206\u6790"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TD\n    A[\u70ED\u70B9Key\u8FC7\u671F] --\x3e B[\u5927\u91CF\u5E76\u53D1\u8BF7\u6C42]\n    B --\x3e C[\u67E5\u8BE2\u7F13\u5B58]\n    C --\x3e D[\u7F13\u5B58\u672A\u547D\u4E2D]\n    D --\x3e E[\u5E76\u53D1\u67E5\u8BE2\u6570\u636E\u5E93]\n    E --\x3e F[\u6570\u636E\u5E93\u538B\u529B\u6FC0\u589E]\n    F --\x3e G[\u7CFB\u7EDF\u6027\u80FD\u4E0B\u964D]"}),"\n",(0,s.jsx)(n.h4,{id:"\u89E3\u51B3\u65B9\u6848-1",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"1. \u4E92\u65A5\u9501\u4FDD\u62A4"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u4E92\u65A5\u9501\u89E3\u51B3\u65B9\u6848"',children:'@Service\npublic class MutexLockCacheService {\n    private final Map<String, ReentrantLock> locks = new ConcurrentHashMap<>();\n    \n    public User getHotUser(String userId) {\n        String cacheKey = "user:" + userId;\n        \n        // \u5148\u67E5\u7F13\u5B58\n        User user = (User) redisTemplate.opsForValue().get(cacheKey);\n        if (user != null) {\n            return user;\n        }\n        \n        // \u83B7\u53D6\u8BE5key\u7684\u4E92\u65A5\u9501\n        ReentrantLock lock = locks.computeIfAbsent(cacheKey, k -> new ReentrantLock());\n        \n        try {\n            // \u5C1D\u8BD5\u83B7\u53D6\u9501\uFF0C\u8BBE\u7F6E\u8D85\u65F6\u65F6\u95F4\n            if (lock.tryLock(3, TimeUnit.SECONDS)) {\n                try {\n                    // \u53CC\u91CD\u68C0\u67E5\n                    user = (User) redisTemplate.opsForValue().get(cacheKey);\n                    if (user != null) {\n                        return user;\n                    }\n                    \n                    // \u91CD\u5EFA\u7F13\u5B58\n                    user = userRepository.findById(userId);\n                    if (user != null) {\n                        redisTemplate.opsForValue().set(cacheKey, user, 30, TimeUnit.MINUTES);\n                    }\n                    \n                    return user;\n                } finally {\n                    lock.unlock();\n                }\n            } else {\n                // \u83B7\u53D6\u9501\u5931\u8D25\uFF0C\u7B49\u5F85\u4E00\u6BB5\u65F6\u95F4\u540E\u91CD\u8BD5\n                Thread.sleep(100);\n                return getHotUser(userId);\n            }\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt();\n            throw new RuntimeException("Interrupted while waiting for lock", e);\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"2. \u903B\u8F91\u6C38\u4E0D\u8FC7\u671F"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u903B\u8F91\u6C38\u4E0D\u8FC7\u671F\u89E3\u51B3\u65B9\u6848"',children:'@Service\npublic class LogicalExpirationCacheService {\n    \n    public User getHotUser(String userId) {\n        String cacheKey = "user:" + userId;\n        \n        // \u67E5\u8BE2\u7F13\u5B58\n        CacheEntry<User> entry = (CacheEntry<User>) redisTemplate.opsForValue().get(cacheKey);\n        \n        if (entry != null && !entry.isExpired()) {\n            return entry.getData();\n        }\n        \n        // \u7F13\u5B58\u8FC7\u671F\u6216\u4E0D\u5B58\u5728\uFF0C\u5F02\u6B65\u91CD\u5EFA\n        if (entry == null || entry.isExpired()) {\n            CompletableFuture.runAsync(() -> {\n                try {\n                    User user = userRepository.findById(userId);\n                    if (user != null) {\n                        // \u8BBE\u7F6E\u903B\u8F91\u8FC7\u671F\u65F6\u95F4\n                        CacheEntry<User> newEntry = new CacheEntry<>(user, \n                            System.currentTimeMillis() + 30 * 60 * 1000); // 30\u5206\u949F\u540E\u903B\u8F91\u8FC7\u671F\n                        redisTemplate.opsForValue().set(cacheKey, newEntry);\n                    }\n                } catch (Exception e) {\n                    log.error("Failed to rebuild cache for user: " + userId, e);\n                }\n            });\n        }\n        \n        // \u8FD4\u56DE\u65E7\u6570\u636E\uFF08\u5982\u679C\u5B58\u5728\uFF09\n        return entry != null ? entry.getData() : null;\n    }\n    \n    // \u7F13\u5B58\u6761\u76EE\u7C7B\n    private static class CacheEntry<T> {\n        private final T data;\n        private final long expireTime;\n        \n        public CacheEntry(T data, long expireTime) {\n            this.data = data;\n            this.expireTime = expireTime;\n        }\n        \n        public T getData() { return data; }\n        public boolean isExpired() { return System.currentTimeMillis() > expireTime; }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"33-\u7F13\u5B58\u96EA\u5D29cache-avalanche",children:"3.3 \u7F13\u5B58\u96EA\u5D29\uFF08Cache Avalanche\uFF09"}),"\n",(0,s.jsx)(n.p,{children:"\u7F13\u5B58\u96EA\u5D29\u662F\u6307\u5927\u91CF\u7F13\u5B58\u540C\u65F6\u8FC7\u671F\uFF0C\u5BFC\u81F4\u5927\u91CF\u8BF7\u6C42\u76F4\u63A5\u6253\u5230\u6570\u636E\u5E93\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u95EE\u9898\u5206\u6790-2",children:"\u95EE\u9898\u5206\u6790"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TD\n    A[\u5927\u91CF\u7F13\u5B58\u540C\u65F6\u8FC7\u671F] --\x3e B[\u5927\u91CF\u8BF7\u6C42]\n    B --\x3e C[\u7F13\u5B58\u672A\u547D\u4E2D]\n    C --\x3e D[\u5E76\u53D1\u67E5\u8BE2\u6570\u636E\u5E93]\n    D --\x3e E[\u6570\u636E\u5E93\u538B\u529B\u6FC0\u589E]\n    E --\x3e F[\u7CFB\u7EDF\u5D29\u6E83]\n    F --\x3e G[\u7EA7\u8054\u6545\u969C]"}),"\n",(0,s.jsx)(n.h4,{id:"\u89E3\u51B3\u65B9\u6848-2",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"1. TTL\u968F\u673A\u6296\u52A8"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="TTL\u968F\u673A\u6296\u52A8\u89E3\u51B3\u65B9\u6848"',children:"public class RandomTTLStrategy {\n    \n    public static Duration getRandomizedTTL(Duration baseTTL) {\n        long baseSeconds = baseTTL.getSeconds();\n        // \u5728\u57FA\u7840TTL\u57FA\u7840\u4E0A\u589E\u52A0\u968F\u673A\u504F\u79FB\uFF0C\u907F\u514D\u540C\u65F6\u8FC7\u671F\n        long randomOffset = (long) (baseSeconds * 0.2 * Math.random()); // 20%\u968F\u673A\u504F\u79FB\n        return Duration.ofSeconds(baseSeconds + randomOffset);\n    }\n    \n    public void setCacheWithRandomTTL(String key, Object value) {\n        Duration ttl = getRandomizedTTL(Duration.ofMinutes(30));\n        redisTemplate.opsForValue().set(key, value, ttl);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"2. \u7F13\u5B58\u9884\u70ED"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u7F13\u5B58\u9884\u70ED\u89E3\u51B3\u65B9\u6848"',children:'@Service\npublic class CacheWarmupService {\n    \n    @PostConstruct\n    public void warmupCache() {\n        // \u7CFB\u7EDF\u542F\u52A8\u65F6\u9884\u70ED\u70ED\u70B9\u6570\u636E\n        List<String> hotUserIds = getHotUserIds();\n        \n        for (String userId : hotUserIds) {\n            CompletableFuture.runAsync(() -> {\n                try {\n                    User user = userRepository.findById(userId);\n                    if (user != null) {\n                        String cacheKey = "user:" + userId;\n                        Duration ttl = getRandomizedTTL(Duration.ofMinutes(30));\n                        redisTemplate.opsForValue().set(cacheKey, user, ttl);\n                    }\n                } catch (Exception e) {\n                    log.error("Failed to warmup cache for user: " + userId, e);\n                }\n            });\n        }\n    }\n    \n    private List<String> getHotUserIds() {\n        // \u83B7\u53D6\u70ED\u70B9\u7528\u6237ID\u5217\u8868\n        return Arrays.asList("user1", "user2", "user3", "user4", "user5");\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"3. \u7194\u65AD\u964D\u7EA7"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u7194\u65AD\u964D\u7EA7\u89E3\u51B3\u65B9\u6848"',children:'@Service\npublic class CircuitBreakerCacheService {\n    private final CircuitBreaker circuitBreaker;\n    \n    public CircuitBreakerCacheService() {\n        this.circuitBreaker = CircuitBreaker.builder()\n            .failureRateThreshold(50) // \u5931\u8D25\u7387\u9608\u503C50%\n            .waitDurationInOpenState(Duration.ofSeconds(10)) // \u7194\u65AD\u65F6\u95F410\u79D2\n            .ringBufferSizeInHalfOpenState(2) // \u534A\u5F00\u72B6\u6001\u4E0B\u7684\u8BF7\u6C42\u6570\n            .ringBufferSizeInClosedState(10) // \u5173\u95ED\u72B6\u6001\u4E0B\u7684\u8BF7\u6C42\u6570\n            .build();\n    }\n    \n    public User getUser(String userId) {\n        return circuitBreaker.executeSupplier(() -> {\n            String cacheKey = "user:" + userId;\n            \n            // \u5148\u67E5\u7F13\u5B58\n            User user = (User) redisTemplate.opsForValue().get(cacheKey);\n            if (user != null) {\n                return user;\n            }\n            \n            // \u7F13\u5B58\u672A\u547D\u4E2D\uFF0C\u67E5\u8BE2\u6570\u636E\u5E93\n            user = userRepository.findById(userId);\n            if (user != null) {\n                redisTemplate.opsForValue().set(cacheKey, user, 30, TimeUnit.MINUTES);\n            }\n            \n            return user;\n        });\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u903B\u8F91\u6C38\u4E0D\u8FC7\u671F\uFF1A"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"class CacheEntry`<T>` { T data; long expireAt; }\npublic CacheEntry`<User>` getUser(long id) {\n    CacheEntry`<User>` entry = localCache.get(id);\n    if (entry != null && System.currentTimeMillis() < entry.expireAt) {\n        return entry; // \u547D\u4E2D\u65B0\u9C9C\u6570\u636E\n    }\n    // \u8FC7\u671F\u5219\u89E6\u53D1\u540E\u53F0\u5237\u65B0\uFF0C\u4F46\u7EE7\u7EED\u8FD4\u56DE\u65E7\u503C\uFF08\u82E5\u5B58\u5728\uFF09\n    backgroundRefresh(id);\n    return entry; // \u65E7\u503C\u5BB9\u5FCD\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"4-\u7F13\u5B58\u76D1\u63A7\u4E0E\u8FD0\u7EF4",children:"4. \u7F13\u5B58\u76D1\u63A7\u4E0E\u8FD0\u7EF4"}),"\n",(0,s.jsx)(n.h3,{id:"41-\u5173\u952E\u76D1\u63A7\u6307\u6807",children:"4.1 \u5173\u952E\u76D1\u63A7\u6307\u6807"}),"\n",(0,s.jsx)(n.h4,{id:"\u6027\u80FD\u6307\u6807",children:"\u6027\u80FD\u6307\u6807"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u547D\u4E2D\u7387\uFF08Hit Rate\uFF09"}),"\uFF1A\u7F13\u5B58\u547D\u4E2D\u6B21\u6570 / \u603B\u8BF7\u6C42\u6B21\u6570"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5E73\u5747\u5EF6\u8FDF\uFF08Average Latency\uFF09"}),"\uFF1A\u7F13\u5B58\u64CD\u4F5C\u7684\u5E73\u5747\u54CD\u5E94\u65F6\u95F4"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"P99\u5EF6\u8FDF"}),"\uFF1A99%\u8BF7\u6C42\u7684\u54CD\u5E94\u65F6\u95F4"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5931\u8D25\u7387\uFF08Error Rate\uFF09"}),"\uFF1A\u7F13\u5B58\u64CD\u4F5C\u5931\u8D25\u7684\u6BD4\u4F8B"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u5BB9\u91CF\u6307\u6807",children:"\u5BB9\u91CF\u6307\u6807"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5185\u5B58\u4F7F\u7528\u7387"}),"\uFF1A\u7F13\u5B58\u5360\u7528\u7684\u5185\u5B58\u6BD4\u4F8B"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u8FDE\u63A5\u6570"}),"\uFF1A\u5F53\u524D\u6D3B\u8DC3\u7684\u5BA2\u6237\u7AEF\u8FDE\u63A5\u6570"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5E26\u5BBD\u4F7F\u7528"}),"\uFF1A\u7F51\u7EDC\u4F20\u8F93\u7684\u6570\u636E\u91CF"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u4E1A\u52A1\u6307\u6807",children:"\u4E1A\u52A1\u6307\u6807"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u70ED\u70B9Key\u6392\u884C"}),"\uFF1A\u8BBF\u95EE\u9891\u7387\u6700\u9AD8\u7684\u7F13\u5B58\u952E"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u6162\u67E5\u8BE2"}),"\uFF1A\u54CD\u5E94\u65F6\u95F4\u8D85\u8FC7\u9608\u503C\u7684\u67E5\u8BE2"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5927Key"}),"\uFF1A\u5360\u7528\u5185\u5B58\u8F83\u5927\u7684\u7F13\u5B58\u9879"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u7F13\u5B58\u76D1\u63A7\u793A\u4F8B"',children:"@Service\npublic class CacheMonitorService {\n    \n    @EventListener\n    public void onCacheEvent(CacheEvent event) {\n        // \u8BB0\u5F55\u7F13\u5B58\u4E8B\u4EF6\n        recordCacheEvent(event);\n        \n        // \u66F4\u65B0\u76D1\u63A7\u6307\u6807\n        updateMetrics(event);\n    }\n    \n    private void recordCacheEvent(CacheEvent event) {\n        // \u8BB0\u5F55\u7F13\u5B58\u547D\u4E2D/\u672A\u547D\u4E2D\n        if (event.getType() == CacheEventType.HIT) {\n            hitCounter.increment();\n        } else if (event.getType() == CacheEventType.MISS) {\n            missCounter.increment();\n        }\n        \n        // \u8BB0\u5F55\u54CD\u5E94\u65F6\u95F4\n        latencyHistogram.record(event.getLatency());\n    }\n    \n    private void updateMetrics(CacheEvent event) {\n        // \u66F4\u65B0\u70ED\u70B9Key\u7EDF\u8BA1\n        hotKeyCounter.increment(event.getKey());\n        \n        // \u68C0\u67E5\u5927Key\n        if (event.getValueSize() > 1024 * 1024) { // 1MB\n            bigKeyAlert.alert(event.getKey(), event.getValueSize());\n        }\n    }\n    \n    // \u83B7\u53D6\u7F13\u5B58\u547D\u4E2D\u7387\n    public double getHitRate() {\n        long hits = hitCounter.get();\n        long misses = missCounter.get();\n        long total = hits + misses;\n        return total > 0 ? (double) hits / total : 0.0;\n    }\n    \n    // \u83B7\u53D6P99\u5EF6\u8FDF\n    public long getP99Latency() {\n        return latencyHistogram.getSnapshot().get99thPercentile();\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"42-\u544A\u8B66\u7B56\u7565",children:"4.2 \u544A\u8B66\u7B56\u7565"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u7F13\u5B58\u544A\u8B66\u793A\u4F8B"',children:'@Component\npublic class CacheAlertService {\n    \n    @Scheduled(fixedRate = 60000) // \u6BCF\u5206\u949F\u68C0\u67E5\u4E00\u6B21\n    public void checkCacheHealth() {\n        // \u68C0\u67E5\u547D\u4E2D\u7387\n        double hitRate = cacheMonitorService.getHitRate();\n        if (hitRate < 0.8) { // \u547D\u4E2D\u7387\u4F4E\u4E8E80%\n            alertService.sendAlert("Cache hit rate is low: " + hitRate);\n        }\n        \n        // \u68C0\u67E5\u5EF6\u8FDF\n        long p99Latency = cacheMonitorService.getP99Latency();\n        if (p99Latency > 100) { // P99\u5EF6\u8FDF\u8D85\u8FC7100ms\n            alertService.sendAlert("Cache P99 latency is high: " + p99Latency + "ms");\n        }\n        \n        // \u68C0\u67E5\u5185\u5B58\u4F7F\u7528\u7387\n        double memoryUsage = cacheMonitorService.getMemoryUsage();\n        if (memoryUsage > 0.9) { // \u5185\u5B58\u4F7F\u7528\u7387\u8D85\u8FC790%\n            alertService.sendAlert("Cache memory usage is high: " + memoryUsage);\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"43-\u8FD0\u7EF4\u6700\u4F73\u5B9E\u8DF5",children:"4.3 \u8FD0\u7EF4\u6700\u4F73\u5B9E\u8DF5"}),"\n",(0,s.jsx)(n.h4,{id:"\u5BB9\u91CF\u89C4\u5212",children:"\u5BB9\u91CF\u89C4\u5212"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u5BB9\u91CF\u89C4\u5212\u793A\u4F8B"',children:"public class CapacityPlanningService {\n    \n    public CacheConfig calculateOptimalConfig(int expectedQPS, int dataSize) {\n        // \u6839\u636E\u9884\u671FQPS\u548C\u6570\u636E\u5927\u5C0F\u8BA1\u7B97\u6700\u4F18\u914D\u7F6E\n        int optimalConnections = Math.max(10, expectedQPS / 1000);\n        long optimalMemory = dataSize * 2; // \u9884\u75592\u500D\u7A7A\u95F4\n        \n        return CacheConfig.builder()\n            .maxConnections(optimalConnections)\n            .maxMemory(optimalMemory)\n            .build();\n    }\n    \n    public void scaleCache(int currentQPS, int targetQPS) {\n        // \u6839\u636EQPS\u53D8\u5316\u81EA\u52A8\u6269\u7F29\u5BB9\n        if (targetQPS > currentQPS * 1.5) {\n            // \u6269\u5BB9\n            scaleUp();\n        } else if (targetQPS < currentQPS * 0.5) {\n            // \u7F29\u5BB9\n            scaleDown();\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"5-\u5206\u5E03\u5F0F\u7F13\u5B58\u9762\u8BD5\u9898\u7CBE\u9009",children:"5. \u5206\u5E03\u5F0F\u7F13\u5B58\u9762\u8BD5\u9898\u7CBE\u9009"}),"\n",(0,s.jsx)(n.h3,{id:"51-\u57FA\u7840\u6982\u5FF5",children:"5.1 \u57FA\u7840\u6982\u5FF5"}),"\n",(0,s.jsx)(n.h4,{id:"q1-\u4EC0\u4E48\u662F\u5206\u5E03\u5F0F\u7F13\u5B58\u5B83\u7684\u4E3B\u8981\u4F5C\u7528\u662F\u4EC0\u4E48",children:"Q1: \u4EC0\u4E48\u662F\u5206\u5E03\u5F0F\u7F13\u5B58\uFF1F\u5B83\u7684\u4E3B\u8981\u4F5C\u7528\u662F\u4EC0\u4E48\uFF1F"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7B54"}),": \u5206\u5E03\u5F0F\u7F13\u5B58\u662F\u4E00\u79CD\u5C06\u6570\u636E\u5B58\u50A8\u5728\u591A\u4E2A\u8282\u70B9\u4E0A\u7684\u7F13\u5B58\u7CFB\u7EDF\uFF0C\u7528\u4E8E\u63D0\u5347\u7CFB\u7EDF\u6027\u80FD\u548C\u53EF\u6269\u5C55\u6027\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u4E3B\u8981\u4F5C\u7528"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u6027\u80FD\u63D0\u5347"}),"\uFF1A\u5C06\u70ED\u70B9\u6570\u636E\u5B58\u50A8\u5728\u5185\u5B58\u4E2D\uFF0C\u5927\u5E45\u63D0\u5347\u8BBF\u95EE\u901F\u5EA6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u538B\u529B\u7F13\u89E3"}),"\uFF1A\u51CF\u5C11\u5BF9\u6570\u636E\u5E93\u7684\u76F4\u63A5\u8BBF\u95EE\uFF0C\u964D\u4F4E\u6570\u636E\u5E93\u538B\u529B"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u9AD8\u53EF\u7528\u6027"}),"\uFF1A\u901A\u8FC7\u591A\u8282\u70B9\u90E8\u7F72\u63D0\u9AD8\u7CFB\u7EDF\u53EF\u7528\u6027"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u6C34\u5E73\u6269\u5C55"}),"\uFF1A\u652F\u6301\u52A8\u6001\u6DFB\u52A0\u8282\u70B9\u6765\u63D0\u5347\u5BB9\u91CF\u548C\u6027\u80FD"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"q2-\u672C\u5730\u7F13\u5B58\u548C\u5206\u5E03\u5F0F\u7F13\u5B58\u7684\u533A\u522B\u662F\u4EC0\u4E48",children:"Q2: \u672C\u5730\u7F13\u5B58\u548C\u5206\u5E03\u5F0F\u7F13\u5B58\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7B54"}),":"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u7279\u6027"}),(0,s.jsx)(n.th,{children:"\u672C\u5730\u7F13\u5B58"}),(0,s.jsx)(n.th,{children:"\u5206\u5E03\u5F0F\u7F13\u5B58"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"\u90E8\u7F72\u4F4D\u7F6E"})}),(0,s.jsx)(n.td,{children:"\u5E94\u7528\u8FDB\u7A0B\u5185"}),(0,s.jsx)(n.td,{children:"\u72EC\u7ACB\u670D\u52A1\u5668"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"\u8BBF\u95EE\u901F\u5EA6"})}),(0,s.jsx)(n.td,{children:"\u6781\u5FEB\uFF08\u5185\u5B58\u8BBF\u95EE\uFF09"}),(0,s.jsx)(n.td,{children:"\u8F83\u5FEB\uFF08\u7F51\u7EDC\u8BBF\u95EE\uFF09"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"\u5BB9\u91CF"})}),(0,s.jsx)(n.td,{children:"\u6709\u9650\uFF08\u53D7JVM\u5185\u5B58\u9650\u5236\uFF09"}),(0,s.jsx)(n.td,{children:"\u5927\uFF08\u53EF\u6269\u5C55\uFF09"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"\u4E00\u81F4\u6027"})}),(0,s.jsx)(n.td,{children:"\u96BE\u4EE5\u4FDD\u8BC1"}),(0,s.jsx)(n.td,{children:"\u76F8\u5BF9\u5BB9\u6613\u4FDD\u8BC1"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"\u9002\u7528\u573A\u666F"})}),(0,s.jsx)(n.td,{children:"\u9AD8\u9891\u8BBF\u95EE\u7684\u914D\u7F6E\u4FE1\u606F"}),(0,s.jsx)(n.td,{children:"\u8DE8\u670D\u52A1\u5171\u4EAB\u6570\u636E"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"52-\u7F13\u5B58\u7B56\u7565",children:"5.2 \u7F13\u5B58\u7B56\u7565"}),"\n",(0,s.jsx)(n.h4,{id:"q3-cache-asidewrite-throughwrite-behind\u4E09\u79CD\u7F13\u5B58\u6A21\u5F0F\u7684\u533A\u522B\u662F\u4EC0\u4E48",children:"Q3: Cache-Aside\u3001Write-Through\u3001Write-Behind\u4E09\u79CD\u7F13\u5B58\u6A21\u5F0F\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7B54"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cache-Aside\uFF08\u65C1\u8DEF\u7F13\u5B58\uFF09"}),"\uFF1A"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5E94\u7528\u7A0B\u5E8F\u76F4\u63A5\u7BA1\u7406\u7F13\u5B58"}),"\n",(0,s.jsx)(n.li,{children:"\u8BFB\uFF1A\u5148\u67E5\u7F13\u5B58\uFF0C\u672A\u547D\u4E2D\u5219\u67E5\u6570\u636E\u5E93\u5E76\u66F4\u65B0\u7F13\u5B58"}),"\n",(0,s.jsx)(n.li,{children:"\u5199\uFF1A\u5148\u66F4\u65B0\u6570\u636E\u5E93\uFF0C\u518D\u5220\u9664\u7F13\u5B58"}),"\n",(0,s.jsx)(n.li,{children:"\u4F18\u70B9\uFF1A\u5B9E\u73B0\u7B80\u5355\uFF0C\u7F13\u5B58\u7B56\u7565\u7075\u6D3B"}),"\n",(0,s.jsx)(n.li,{children:"\u7F3A\u70B9\uFF1A\u9700\u8981\u624B\u52A8\u7BA1\u7406\u7F13\u5B58\u4E00\u81F4\u6027"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Write-Through\uFF08\u8BFB\u5199\u7A7F\u900F\uFF09"}),"\uFF1A"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u7F13\u5B58\u4F5C\u4E3A\u6570\u636E\u5E93\u7684\u4EE3\u7406"}),"\n",(0,s.jsx)(n.li,{children:"\u6240\u6709\u8BFB\u5199\u90FD\u7ECF\u8FC7\u7F13\u5B58"}),"\n",(0,s.jsx)(n.li,{children:"\u4F18\u70B9\uFF1A\u7F13\u5B58\u4E00\u81F4\u6027\u5BB9\u6613\u4FDD\u8BC1"}),"\n",(0,s.jsx)(n.li,{children:"\u7F3A\u70B9\uFF1A\u589E\u52A0\u4E86\u7CFB\u7EDF\u590D\u6742\u6027"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Write-Behind\uFF08\u5F02\u6B65\u5199\u5165\uFF09"}),"\uFF1A"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5199\u64CD\u4F5C\u5148\u66F4\u65B0\u7F13\u5B58\uFF0C\u7136\u540E\u5F02\u6B65\u6279\u91CF\u5199\u5165\u6570\u636E\u5E93"}),"\n",(0,s.jsx)(n.li,{children:"\u4F18\u70B9\uFF1A\u5199\u5165\u6027\u80FD\u9AD8\uFF0C\u51CF\u5C11\u6570\u636E\u5E93\u538B\u529B"}),"\n",(0,s.jsx)(n.li,{children:"\u7F3A\u70B9\uFF1A\u6570\u636E\u53EF\u80FD\u4E22\u5931\uFF0C\u4E00\u81F4\u6027\u8F83\u5F31"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"q4-\u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u7A7F\u900F\u95EE\u9898",children:"Q4: \u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u7A7F\u900F\u95EE\u9898\uFF1F"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7B54"}),": \u7F13\u5B58\u7A7F\u900F\u662F\u6307\u67E5\u8BE2\u4E0D\u5B58\u5728\u7684\u6570\u636E\uFF0C\u6BCF\u6B21\u8BF7\u6C42\u90FD\u6253\u5230\u6570\u636E\u5E93\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5E03\u9686\u8FC7\u6EE4\u5668"}),"\uFF1A\u5FEB\u901F\u5224\u65AD\u6570\u636E\u662F\u5426\u5B58\u5728\uFF0C\u907F\u514D\u65E0\u6548\u67E5\u8BE2"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7F13\u5B58\u7A7A\u503C"}),"\uFF1A\u5C06\u7A7A\u7ED3\u679C\u4E5F\u7F13\u5B58\uFF0C\u8BBE\u7F6E\u8F83\u77ED\u7684TTL"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u53C2\u6570\u6821\u9A8C"}),"\uFF1A\u5728\u5E94\u7528\u5C42\u8FDB\u884C\u53C2\u6570\u6821\u9A8C\uFF0C\u8FC7\u6EE4\u65E0\u6548\u8BF7\u6C42"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u9650\u6D41\u63AA\u65BD"}),"\uFF1A\u5BF9\u5F02\u5E38\u8BF7\u6C42\u8FDB\u884C\u9650\u6D41"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u5E03\u9686\u8FC7\u6EE4\u5668\u89E3\u51B3\u65B9\u6848"',children:'public User getUser(String userId) {\n    // 1. \u5E03\u9686\u8FC7\u6EE4\u5668\u68C0\u67E5\n    if (!bloomFilter.mightContain(userId)) {\n        return null; // \u80AF\u5B9A\u4E0D\u5B58\u5728\n    }\n    \n    // 2. \u67E5\u8BE2\u7F13\u5B58\n    User user = (User) redisTemplate.opsForValue().get("user:" + userId);\n    if (user != null) {\n        return user;\n    }\n    \n    // 3. \u67E5\u8BE2\u6570\u636E\u5E93\n    user = userRepository.findById(userId);\n    if (user != null) {\n        redisTemplate.opsForValue().set("user:" + userId, user, 30, TimeUnit.MINUTES);\n    } else {\n        // \u7F13\u5B58\u7A7A\u503C\uFF0C\u9632\u6B62\u7A7F\u900F\n        redisTemplate.opsForValue().set("user:" + userId, null, 5, TimeUnit.MINUTES);\n    }\n    \n    return user;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"53-\u7F13\u5B58\u95EE\u9898",children:"5.3 \u7F13\u5B58\u95EE\u9898"}),"\n",(0,s.jsx)(n.h4,{id:"q5-\u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u51FB\u7A7F\u95EE\u9898",children:"Q5: \u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u51FB\u7A7F\u95EE\u9898\uFF1F"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7B54"}),": \u7F13\u5B58\u51FB\u7A7F\u662F\u6307\u70ED\u70B9key\u5728\u7F13\u5B58\u8FC7\u671F\u7684\u4E00\u77AC\u95F4\uFF0C\u5927\u91CF\u5E76\u53D1\u8BF7\u6C42\u76F4\u63A5\u6253\u5230\u6570\u636E\u5E93\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4E92\u65A5\u9501"}),"\uFF1A\u786E\u4FDD\u540C\u4E00\u65F6\u95F4\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u91CD\u5EFA\u7F13\u5B58"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SingleFlight\u6A21\u5F0F"}),"\uFF1A\u786E\u4FDD\u540C\u4E00\u65F6\u95F4\u53EA\u6709\u4E00\u4E2A\u8BF7\u6C42\u91CD\u5EFA\u7F13\u5B58\uFF0C\u5176\u4ED6\u8BF7\u6C42\u7B49\u5F85\u7ED3\u679C"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u903B\u8F91\u6C38\u4E0D\u8FC7\u671F"}),"\uFF1A\u8BBE\u7F6E\u903B\u8F91\u8FC7\u671F\u65F6\u95F4\uFF0C\u5F02\u6B65\u91CD\u5EFA\u7F13\u5B58"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u9884\u70ED\u673A\u5236"}),"\uFF1A\u5728\u7F13\u5B58\u8FC7\u671F\u524D\u4E3B\u52A8\u91CD\u5EFA\u7F13\u5B58"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u4E92\u65A5\u9501\u89E3\u51B3\u65B9\u6848"',children:'public User getHotUser(String userId) {\n    String cacheKey = "user:" + userId;\n    \n    // \u5148\u67E5\u7F13\u5B58\n    User user = (User) redisTemplate.opsForValue().get(cacheKey);\n    if (user != null) {\n        return user;\n    }\n    \n    // \u83B7\u53D6\u8BE5key\u7684\u4E92\u65A5\u9501\n    ReentrantLock lock = locks.computeIfAbsent(cacheKey, k -> new ReentrantLock());\n    \n    try {\n        lock.lock();\n        \n        // \u53CC\u91CD\u68C0\u67E5\n        user = (User) redisTemplate.opsForValue().get(cacheKey);\n        if (user != null) {\n            return user;\n        }\n        \n        // \u91CD\u5EFA\u7F13\u5B58\n        user = userRepository.findById(userId);\n        if (user != null) {\n            redisTemplate.opsForValue().set(cacheKey, user, 30, TimeUnit.MINUTES);\n        }\n        \n        return user;\n    } finally {\n        lock.unlock();\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"q6-\u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u96EA\u5D29\u95EE\u9898",children:"Q6: \u5982\u4F55\u89E3\u51B3\u7F13\u5B58\u96EA\u5D29\u95EE\u9898\uFF1F"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7B54"}),": \u7F13\u5B58\u96EA\u5D29\u662F\u6307\u5927\u91CF\u7F13\u5B58\u540C\u65F6\u8FC7\u671F\uFF0C\u5BFC\u81F4\u5927\u91CF\u8BF7\u6C42\u76F4\u63A5\u6253\u5230\u6570\u636E\u5E93\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TTL\u968F\u673A\u6296\u52A8"}),"\uFF1A\u5728\u57FA\u7840TTL\u57FA\u7840\u4E0A\u589E\u52A0\u968F\u673A\u504F\u79FB\uFF0C\u907F\u514D\u540C\u65F6\u8FC7\u671F"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7F13\u5B58\u9884\u70ED"}),"\uFF1A\u7CFB\u7EDF\u542F\u52A8\u65F6\u4E3B\u52A8\u52A0\u8F7D\u70ED\u70B9\u6570\u636E\u5230\u7F13\u5B58"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7194\u65AD\u964D\u7EA7"}),"\uFF1A\u5F53\u6570\u636E\u5E93\u538B\u529B\u8FC7\u5927\u65F6\uFF0C\u542F\u7528\u7194\u65AD\u673A\u5236"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u591A\u7EA7\u7F13\u5B58"}),"\uFF1A\u4F7F\u7528\u672C\u5730\u7F13\u5B58\u4F5C\u4E3A\u6700\u540E\u4E00\u9053\u9632\u7EBF"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="TTL\u968F\u673A\u6296\u52A8\u89E3\u51B3\u65B9\u6848"',children:"public static Duration getRandomizedTTL(Duration baseTTL) {\n    long baseSeconds = baseTTL.getSeconds();\n    // \u5728\u57FA\u7840TTL\u57FA\u7840\u4E0A\u589E\u52A0\u968F\u673A\u504F\u79FB\uFF0C\u907F\u514D\u540C\u65F6\u8FC7\u671F\n    long randomOffset = (long) (baseSeconds * 0.2 * Math.random()); // 20%\u968F\u673A\u504F\u79FB\n    return Duration.ofSeconds(baseSeconds + randomOffset);\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"54-\u9AD8\u7EA7\u95EE\u9898",children:"5.4 \u9AD8\u7EA7\u95EE\u9898"}),"\n",(0,s.jsx)(n.h4,{id:"q7-\u53CC\u5220\u7B56\u7565\u4E3A\u4EC0\u4E48\u8981\u5EF6\u8FDF\u5EF6\u8FDF\u591A\u957F\u65F6\u95F4\u5408\u9002",children:"Q7: \u53CC\u5220\u7B56\u7565\u4E3A\u4EC0\u4E48\u8981\u5EF6\u8FDF\uFF1F\u5EF6\u8FDF\u591A\u957F\u65F6\u95F4\u5408\u9002\uFF1F"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7B54"}),": \u53CC\u5220\u7B56\u7565\u662F\u4E3A\u4E86\u89E3\u51B3\u7F13\u5B58\u4E00\u81F4\u6027\u95EE\u9898\uFF0C\u5EF6\u8FDF\u5220\u9664\u662F\u4E3A\u4E86\u907F\u514D\u5E76\u53D1\u95EE\u9898\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u539F\u56E0"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5E76\u53D1\u95EE\u9898"}),"\uFF1A\u5728\u5220\u9664\u7F13\u5B58\u548C\u66F4\u65B0\u6570\u636E\u5E93\u4E4B\u95F4\uFF0C\u53EF\u80FD\u6709\u5176\u4ED6\u7EBF\u7A0B\u8BFB\u53D6\u5230\u65E7\u6570\u636E\u5E76\u66F4\u65B0\u7F13\u5B58"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u65F6\u5E8F\u95EE\u9898"}),"\uFF1A\u5EF6\u8FDF\u5220\u9664\u53EF\u4EE5\u786E\u4FDD\u5728\u5E76\u53D1\u64CD\u4F5C\u5B8C\u6210\u540E\u518D\u6B21\u6E05\u7406\u7F13\u5B58"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5EF6\u8FDF\u65F6\u95F4"}),"\uFF1A"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4E00\u822C\u8BBE\u7F6E\u4E3A100-500ms"}),"\n",(0,s.jsx)(n.li,{children:"\u9700\u8981\u6839\u636E\u4E1A\u52A1\u573A\u666F\u548C\u7CFB\u7EDF\u8D1F\u8F7D\u8C03\u6574"}),"\n",(0,s.jsx)(n.li,{children:"\u53EF\u4EE5\u901A\u8FC7\u76D1\u63A7\u548C\u6D4B\u8BD5\u786E\u5B9A\u6700\u4F18\u503C"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u5EF6\u8FDF\u53CC\u5220\u793A\u4F8B"',children:'public void updateUser(User user) {\n    // 1. \u66F4\u65B0\u6570\u636E\u5E93\n    userRepository.save(user);\n    \n    // 2. \u5220\u9664\u7F13\u5B58\n    String cacheKey = "user:" + user.getId();\n    redisTemplate.delete(cacheKey);\n    \n    // 3. \u5EF6\u8FDF\u53CC\u5220\uFF0C\u907F\u514D\u5E76\u53D1\u95EE\u9898\n    scheduleDelayedDelete(cacheKey, 100); // 100ms\u540E\u518D\u6B21\u5220\u9664\n}\n\nprivate void scheduleDelayedDelete(String key, long delayMs) {\n    CompletableFuture.runAsync(() -> {\n        try {\n            Thread.sleep(delayMs);\n            redisTemplate.delete(key);\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt();\n        }\n    });\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"q8-\u591A\u7EA7\u7F13\u5B58\u4E00\u81F4\u6027\u5982\u4F55\u4FDD\u8BC1",children:"Q8: \u591A\u7EA7\u7F13\u5B58\u4E00\u81F4\u6027\u5982\u4F55\u4FDD\u8BC1\uFF1F"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7B54"}),": \u591A\u7EA7\u7F13\u5B58\u4E00\u81F4\u6027\u662F\u4E00\u4E2A\u590D\u6742\u7684\u95EE\u9898\uFF0C\u9700\u8981\u7EFC\u5408\u8003\u8651\u6027\u80FD\u548C\u4E00\u81F4\u6027\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5931\u6548\u7B56\u7565"}),"\uFF1A\u5199\u64CD\u4F5C\u65F6\u540C\u65F6\u5931\u6548\u6240\u6709\u7EA7\u522B\u7684\u7F13\u5B58"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7248\u672C\u63A7\u5236"}),"\uFF1A\u4F7F\u7528\u7248\u672C\u53F7\u63A7\u5236\u7F13\u5B58\u66F4\u65B0"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u8BA2\u9605\u901A\u77E5"}),"\uFF1A\u901A\u8FC7\u6D88\u606F\u961F\u5217\u901A\u77E5\u5404\u8282\u70B9\u66F4\u65B0\u7F13\u5B58"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u6700\u7EC8\u4E00\u81F4\u6027"}),"\uFF1A\u63A5\u53D7\u77ED\u6682\u4E0D\u4E00\u81F4\uFF0C\u901A\u8FC7TTL\u4FDD\u8BC1\u6700\u7EC8\u4E00\u81F4\u6027"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u591A\u7EA7\u7F13\u5B58\u4E00\u81F4\u6027\u793A\u4F8B"',children:'@Service\npublic class MultiLevelCacheService {\n    private final Cache<String, Object> localCache;\n    private final RedisTemplate<String, Object> redisCache;\n    \n    public void updateUser(User user) {\n        // 1. \u66F4\u65B0\u6570\u636E\u5E93\n        userRepository.save(user);\n        \n        // 2. \u540C\u65F6\u5931\u6548\u4E24\u7EA7\u7F13\u5B58\n        String cacheKey = "user:" + user.getId();\n        localCache.invalidate(cacheKey);\n        redisCache.delete(cacheKey);\n        \n        // 3. \u53D1\u9001\u6D88\u606F\u901A\u77E5\u5176\u4ED6\u8282\u70B9\n        messagePublisher.publish("cache:invalidate", cacheKey);\n    }\n    \n    @EventListener\n    public void onCacheInvalidate(String cacheKey) {\n        // \u6536\u5230\u5931\u6548\u6D88\u606F\u65F6\uFF0C\u6E05\u7406\u672C\u5730\u7F13\u5B58\n        localCache.invalidate(cacheKey);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"q9-\u5982\u4F55\u8BC6\u522B\u4E0E\u6CBB\u7406\u70ED\u70B9key",children:"Q9: \u5982\u4F55\u8BC6\u522B\u4E0E\u6CBB\u7406\u70ED\u70B9Key\uFF1F"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7B54"}),": \u70ED\u70B9Key\u662F\u6307\u8BBF\u95EE\u9891\u7387\u5F02\u5E38\u9AD8\u7684\u7F13\u5B58\u952E\uFF0C\u9700\u8981\u7279\u6B8A\u5904\u7406\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8BC6\u522B\u65B9\u6CD5"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u76D1\u63A7\u7EDF\u8BA1"}),"\uFF1A\u901A\u8FC7\u76D1\u63A7\u7CFB\u7EDF\u7EDF\u8BA1Key\u7684\u8BBF\u95EE\u9891\u7387"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5B9E\u65F6\u544A\u8B66"}),"\uFF1A\u8BBE\u7F6E\u9608\u503C\uFF0C\u5F53Key\u8BBF\u95EE\u9891\u7387\u8D85\u8FC7\u9608\u503C\u65F6\u544A\u8B66"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u65E5\u5FD7\u5206\u6790"}),"\uFF1A\u5206\u6790\u8BBF\u95EE\u65E5\u5FD7\uFF0C\u8BC6\u522B\u70ED\u70B9Key"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u6CBB\u7406\u7B56\u7565"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u672C\u5730\u7F13\u5B58"}),"\uFF1A\u5C06\u70ED\u70B9Key\u7F13\u5B58\u5230\u672C\u5730\uFF0C\u51CF\u5C11\u7F51\u7EDC\u5F00\u9500"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5206\u7247\u7B56\u7565"}),"\uFF1A\u5C06\u70ED\u70B9Key\u5206\u6563\u5230\u591A\u4E2A\u8282\u70B9"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u9884\u52A0\u8F7D"}),"\uFF1A\u4E3B\u52A8\u9884\u52A0\u8F7D\u70ED\u70B9\u6570\u636E"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u964D\u7EA7\u7B56\u7565"}),"\uFF1A\u5F53\u70ED\u70B9Key\u538B\u529B\u8FC7\u5927\u65F6\uFF0C\u542F\u7528\u964D\u7EA7\u7B56\u7565"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u70ED\u70B9Key\u6CBB\u7406\u793A\u4F8B"',children:'@Service\npublic class HotKeyService {\n    \n    @Scheduled(fixedRate = 60000) // \u6BCF\u5206\u949F\u68C0\u67E5\u4E00\u6B21\n    public void detectHotKeys() {\n        Map<String, Long> keyAccessCount = getKeyAccessCount();\n        \n        for (Map.Entry<String, Long> entry : keyAccessCount.entrySet()) {\n            if (entry.getValue() > 1000) { // \u8BBF\u95EE\u6B21\u6570\u8D85\u8FC71000\n                String hotKey = entry.getKey();\n                handleHotKey(hotKey);\n            }\n        }\n    }\n    \n    private void handleHotKey(String hotKey) {\n        // 1. \u9884\u52A0\u8F7D\u5230\u672C\u5730\u7F13\u5B58\n        Object value = redisTemplate.opsForValue().get(hotKey);\n        if (value != null) {\n            localCache.put(hotKey, value);\n        }\n        \n        // 2. \u53D1\u9001\u544A\u8B66\n        alertService.sendAlert("Hot key detected: " + hotKey);\n        \n        // 3. \u8BB0\u5F55\u65E5\u5FD7\n        log.warn("Hot key detected: {} with access count: {}", hotKey, getAccessCount(hotKey));\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"55-\u6027\u80FD\u4F18\u5316",children:"5.5 \u6027\u80FD\u4F18\u5316"}),"\n",(0,s.jsx)(n.h4,{id:"q10-\u5982\u4F55\u4F18\u5316\u7F13\u5B58\u6027\u80FD",children:"Q10: \u5982\u4F55\u4F18\u5316\u7F13\u5B58\u6027\u80FD\uFF1F"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7B54"}),": \u7F13\u5B58\u6027\u80FD\u4F18\u5316\u9700\u8981\u4ECE\u591A\u4E2A\u7EF4\u5EA6\u8003\u8651\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u4F18\u5316\u7B56\u7565"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u952E\u8BBE\u8BA1\u4F18\u5316"}),"\uFF1A"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528\u77ED\u800C\u6E05\u6670\u7684\u952E\u540D"}),"\n",(0,s.jsx)(n.li,{children:"\u907F\u514D\u8FC7\u957F\u7684\u952E\u540D"}),"\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528\u538B\u7F29\u7B97\u6CD5\u51CF\u5C11\u952E\u957F\u5EA6"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u6570\u636E\u7ED3\u6784\u4F18\u5316"}),"\uFF1A"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u9009\u62E9\u5408\u9002\u7684Redis\u6570\u636E\u7ED3\u6784"}),"\n",(0,s.jsx)(n.li,{children:"\u907F\u514D\u5B58\u50A8\u5197\u4F59\u6570\u636E"}),"\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528\u5E8F\u5217\u5316\u4F18\u5316"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7F51\u7EDC\u4F18\u5316"}),"\uFF1A"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528\u8FDE\u63A5\u6C60"}),"\n",(0,s.jsx)(n.li,{children:"\u6279\u91CF\u64CD\u4F5C\u51CF\u5C11\u7F51\u7EDC\u5F80\u8FD4"}),"\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528Pipeline\u51CF\u5C11\u7F51\u7EDC\u5EF6\u8FDF"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5185\u5B58\u4F18\u5316"}),"\uFF1A"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5408\u7406\u8BBE\u7F6ETTL"}),"\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528LRU\u7B49\u6DD8\u6C70\u7B56\u7565"}),"\n",(0,s.jsx)(n.li,{children:"\u76D1\u63A7\u5185\u5B58\u4F7F\u7528\u60C5\u51B5"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:'title="\u6027\u80FD\u4F18\u5316\u793A\u4F8B"',children:"@Service\npublic class OptimizedCacheService {\n    \n    // \u4F7F\u7528\u8FDE\u63A5\u6C60\n    private final RedisTemplate<String, Object> redisTemplate;\n    \n    // \u6279\u91CF\u64CD\u4F5C\n    public Map<String, Object> batchGet(List<String> keys) {\n        return redisTemplate.opsForValue().multiGet(keys);\n    }\n    \n    // Pipeline\u64CD\u4F5C\n    public void batchSet(Map<String, Object> data) {\n        redisTemplate.executePipelined((RedisCallback<Object>) connection -> {\n            for (Map.Entry<String, Object> entry : data.entrySet()) {\n                connection.set(\n                    entry.getKey().getBytes(),\n                    serialize(entry.getValue())\n                );\n            }\n            return null;\n        });\n    }\n    \n    // \u538B\u7F29\u952E\u540D\n    public String compressKey(String originalKey) {\n        return String.valueOf(originalKey.hashCode());\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"6-\u603B\u7ED3",children:"6. \u603B\u7ED3"}),"\n",(0,s.jsx)(n.p,{children:"\u5206\u5E03\u5F0F\u7F13\u5B58\u662F\u73B0\u4EE3\u4E92\u8054\u7F51\u5E94\u7528\u7684\u6838\u5FC3\u7EC4\u4EF6\uFF0C\u901A\u8FC7\u5408\u7406\u7684\u8BBE\u8BA1\u548C\u4F18\u5316\uFF0C\u53EF\u4EE5\u663E\u8457\u63D0\u5347\u7CFB\u7EDF\u6027\u80FD\u3002\u5728\u5B9E\u9645\u5E94\u7528\u4E2D\uFF0C\u9700\u8981\u6839\u636E\u4E1A\u52A1\u573A\u666F\u9009\u62E9\u5408\u9002\u7684\u7F13\u5B58\u7B56\u7565\uFF0C\u5E76\u6CE8\u610F\u89E3\u51B3\u7F13\u5B58\u7A7F\u900F\u3001\u51FB\u7A7F\u3001\u96EA\u5D29\u7B49\u95EE\u9898\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u5173\u952E\u8981\u70B9",children:"\u5173\u952E\u8981\u70B9"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u9009\u62E9\u5408\u9002\u7684\u7F13\u5B58\u6A21\u5F0F"}),"\uFF1A\u6839\u636E\u4E1A\u52A1\u9700\u6C42\u9009\u62E9Cache-Aside\u3001Write-Through\u6216Write-Behind"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u89E3\u51B3\u7F13\u5B58\u95EE\u9898"}),"\uFF1A\u4F7F\u7528\u5E03\u9686\u8FC7\u6EE4\u5668\u3001\u4E92\u65A5\u9501\u3001TTL\u968F\u673A\u6296\u52A8\u7B49\u6280\u672F"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4FDD\u8BC1\u7F13\u5B58\u4E00\u81F4\u6027"}),"\uFF1A\u901A\u8FC7\u5931\u6548\u7B56\u7565\u3001\u7248\u672C\u63A7\u5236\u7B49\u65B9\u5F0F\u4FDD\u8BC1\u6570\u636E\u4E00\u81F4\u6027"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u76D1\u63A7\u548C\u4F18\u5316"}),"\uFF1A\u5EFA\u7ACB\u5B8C\u5584\u7684\u76D1\u63A7\u4F53\u7CFB\uFF0C\u6301\u7EED\u4F18\u5316\u7F13\u5B58\u6027\u80FD"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u901A\u8FC7\u6DF1\u5165\u7406\u89E3\u548C\u719F\u7EC3\u8FD0\u7528\u8FD9\u4E9B\u6280\u672F\uFF0C\u6211\u4EEC\u80FD\u591F\u6784\u5EFA\u51FA\u9AD8\u6027\u80FD\u3001\u9AD8\u53EF\u7528\u7684\u5206\u5E03\u5F0F\u7F13\u5B58\u7CFB\u7EDF\u3002"})]})}function u(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},28453:function(e,n,r){r.d(n,{R:()=>t,x:()=>c});var i=r(96540);let s={},l=i.createContext(s);function t(e){let n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);