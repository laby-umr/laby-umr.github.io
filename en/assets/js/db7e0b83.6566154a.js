"use strict";(self.webpackChunkfullstack_dev_blog=self.webpackChunkfullstack_dev_blog||[]).push([["26905"],{22432:function(n,e,i){i.r(e),i.d(e,{metadata:()=>t,default:()=>h,frontMatter:()=>l,contentTitle:()=>a,toc:()=>d,assets:()=>c});var t=JSON.parse('{"id":"backend/distributed-systems/distributed-theory","title":"\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7406\u8BBA\u57FA\u7840\u8BE6\u89E3","description":"\u5168\u9762\u4ECB\u7ECD\u5206\u5E03\u5F0F\u7CFB\u7EDF\u6838\u5FC3\u7406\u8BBA\u3001CAP\u5B9A\u7406\u3001\u4E00\u81F4\u6027\u6A21\u578B\u4E0E\u5DE5\u7A0B\u5B9E\u8DF5","source":"@site/docs/backend/distributed-systems/distributed-theory.mdx","sourceDirName":"backend/distributed-systems","slug":"/backend/distributed-systems/distributed-theory","permalink":"/en/docs/backend/distributed-systems/distributed-theory","draft":false,"unlisted":false,"editUrl":"https://github.com/MasterLiu93/blog-web/tree/main/docs/backend/distributed-systems/distributed-theory.mdx","tags":[],"version":"current","lastUpdatedBy":"Laby","lastUpdatedAt":1754524800000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7406\u8BBA\u57FA\u7840\u8BE6\u89E3","description":"\u5168\u9762\u4ECB\u7ECD\u5206\u5E03\u5F0F\u7CFB\u7EDF\u6838\u5FC3\u7406\u8BBA\u3001CAP\u5B9A\u7406\u3001\u4E00\u81F4\u6027\u6A21\u578B\u4E0E\u5DE5\u7A0B\u5B9E\u8DF5","authors":["Laby"],"last_update":{"date":"2025-08-07T00:00:00.000Z","author":"Laby"}},"sidebar":"tutorialSidebar","previous":{"title":"\u5206\u5E03\u5F0F\u94FE\u8DEF\u8FFD\u8E2A\u8BE6\u89E3","permalink":"/en/docs/backend/microservices/distributed-tracing"},"next":{"title":"\u5206\u5E03\u5F0F\u7F13\u5B58\u67B6\u6784\u8BE6\u89E3","permalink":"/en/docs/backend/distributed-systems/distributed-cache"}}'),r=i(74848),s=i(28453);let l={sidebar_position:1,title:"\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7406\u8BBA\u57FA\u7840\u8BE6\u89E3",description:"\u5168\u9762\u4ECB\u7ECD\u5206\u5E03\u5F0F\u7CFB\u7EDF\u6838\u5FC3\u7406\u8BBA\u3001CAP\u5B9A\u7406\u3001\u4E00\u81F4\u6027\u6A21\u578B\u4E0E\u5DE5\u7A0B\u5B9E\u8DF5",authors:["Laby"],last_update:{date:new Date("2025-08-07T00:00:00.000Z"),author:"Laby"}},a="\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7406\u8BBA\u57FA\u7840\u8BE6\u89E3",c={},d=[{value:"1. \u5206\u5E03\u5F0F\u7CFB\u7EDF\u57FA\u672C\u6982\u5FF5",id:"1-\u5206\u5E03\u5F0F\u7CFB\u7EDF\u57FA\u672C\u6982\u5FF5",level:2},{value:"1.1 \u4EC0\u4E48\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\uFF1F",id:"11-\u4EC0\u4E48\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF",level:3},{value:"1.2 \u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u8BBE\u8BA1\u76EE\u6807",id:"12-\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u8BBE\u8BA1\u76EE\u6807",level:3},{value:"1.3 \u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u6311\u6218",id:"13-\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u6311\u6218",level:3},{value:"2. CAP \u5B9A\u7406\u4E0E\u5DE5\u7A0B\u89E3\u8BFB",id:"2-cap-\u5B9A\u7406\u4E0E\u5DE5\u7A0B\u89E3\u8BFB",level:2},{value:"2.1 CAP\u5B9A\u7406\u6982\u8FF0",id:"21-cap\u5B9A\u7406\u6982\u8FF0",level:3},{value:"CAP\u5B9A\u7406\u5185\u5BB9",id:"cap\u5B9A\u7406\u5185\u5BB9",level:4},{value:"2.2 CAP\u5B9A\u7406\u7684\u5DE5\u7A0B\u89E3\u8BFB",id:"22-cap\u5B9A\u7406\u7684\u5DE5\u7A0B\u89E3\u8BFB",level:3},{value:"CP\u7CFB\u7EDF\uFF08\u4E00\u81F4\u6027\u4F18\u5148\uFF09",id:"cp\u7CFB\u7EDF\u4E00\u81F4\u6027\u4F18\u5148",level:4},{value:"AP\u7CFB\u7EDF\uFF08\u53EF\u7528\u6027\u4F18\u5148\uFF09",id:"ap\u7CFB\u7EDF\u53EF\u7528\u6027\u4F18\u5148",level:4},{value:"2.3 CAP\u5B9A\u7406\u7684\u5B9E\u8DF5\u5EFA\u8BAE",id:"23-cap\u5B9A\u7406\u7684\u5B9E\u8DF5\u5EFA\u8BAE",level:3},{value:"\u6309\u4E1A\u52A1\u573A\u666F\u9009\u62E9",id:"\u6309\u4E1A\u52A1\u573A\u666F\u9009\u62E9",level:4},{value:"\u6DF7\u5408\u67B6\u6784\u8BBE\u8BA1",id:"\u6DF7\u5408\u67B6\u6784\u8BBE\u8BA1",level:4},{value:"3. BASE \u7406\u8BBA\u4E0E\u4E00\u81F4\u6027\u6A21\u578B",id:"3-base-\u7406\u8BBA\u4E0E\u4E00\u81F4\u6027\u6A21\u578B",level:2},{value:"3.1 BASE\u7406\u8BBA\u6982\u8FF0",id:"31-base\u7406\u8BBA\u6982\u8FF0",level:3},{value:"BASE\u7406\u8BBA\u5185\u5BB9",id:"base\u7406\u8BBA\u5185\u5BB9",level:4},{value:"3.2 \u4E00\u81F4\u6027\u6A21\u578B\u8BE6\u89E3",id:"32-\u4E00\u81F4\u6027\u6A21\u578B\u8BE6\u89E3",level:3},{value:"\u4E00\u81F4\u6027\u6A21\u578B\u5C42\u6B21\u7ED3\u6784",id:"\u4E00\u81F4\u6027\u6A21\u578B\u5C42\u6B21\u7ED3\u6784",level:4},{value:"\u7EBF\u6027\u4E00\u81F4\u6027\uFF08Linearizability\uFF09",id:"\u7EBF\u6027\u4E00\u81F4\u6027linearizability",level:4},{value:"\u987A\u5E8F\u4E00\u81F4\u6027\uFF08Sequential Consistency\uFF09",id:"\u987A\u5E8F\u4E00\u81F4\u6027sequential-consistency",level:4},{value:"\u56E0\u679C\u4E00\u81F4\u6027\uFF08Causal Consistency\uFF09",id:"\u56E0\u679C\u4E00\u81F4\u6027causal-consistency",level:4},{value:"\u4F1A\u8BDD\u4E00\u81F4\u6027\uFF08Session Consistency\uFF09",id:"\u4F1A\u8BDD\u4E00\u81F4\u6027session-consistency",level:4},{value:"\u6700\u7EC8\u4E00\u81F4\u6027\uFF08Eventual Consistency\uFF09",id:"\u6700\u7EC8\u4E00\u81F4\u6027eventual-consistency",level:4},{value:"4. \u526F\u672C\u3001Quorum \u4E0E\u51B2\u7A81\u89E3\u51B3",id:"4-\u526F\u672Cquorum-\u4E0E\u51B2\u7A81\u89E3\u51B3",level:2},{value:"4.1 \u526F\u672C\u673A\u5236",id:"41-\u526F\u672C\u673A\u5236",level:3},{value:"\u526F\u672C\u7684\u4F5C\u7528",id:"\u526F\u672C\u7684\u4F5C\u7528",level:4},{value:"\u526F\u672C\u4E00\u81F4\u6027\u7B56\u7565",id:"\u526F\u672C\u4E00\u81F4\u6027\u7B56\u7565",level:4},{value:"4.2 Quorum\u673A\u5236",id:"42-quorum\u673A\u5236",level:3},{value:"Quorum\u8BFB\u5199\u89C4\u5219",id:"quorum\u8BFB\u5199\u89C4\u5219",level:4},{value:"Quorum\u914D\u7F6E\u793A\u4F8B",id:"quorum\u914D\u7F6E\u793A\u4F8B",level:4},{value:"\u4E0D\u540CQuorum\u914D\u7F6E\u7684\u5F71\u54CD",id:"\u4E0D\u540Cquorum\u914D\u7F6E\u7684\u5F71\u54CD",level:4},{value:"4.3 \u51B2\u7A81\u89E3\u51B3\u7B56\u7565",id:"43-\u51B2\u7A81\u89E3\u51B3\u7B56\u7565",level:3},{value:"Last-Write-Wins\uFF08\u6700\u540E\u5199\u5165\u83B7\u80DC\uFF09",id:"last-write-wins\u6700\u540E\u5199\u5165\u83B7\u80DC",level:4},{value:"\u5411\u91CF\u65F6\u949F\uFF08Vector Clock\uFF09",id:"\u5411\u91CF\u65F6\u949Fvector-clock",level:4},{value:"CRDT\uFF08\u65E0\u51B2\u7A81\u53EF\u590D\u5236\u6570\u636E\u7C7B\u578B\uFF09",id:"crdt\u65E0\u51B2\u7A81\u53EF\u590D\u5236\u6570\u636E\u7C7B\u578B",level:4},{value:"5. \u5171\u8BC6\u7B97\u6CD5\uFF08Paxos / Raft / ZAB\uFF09",id:"5-\u5171\u8BC6\u7B97\u6CD5paxos--raft--zab",level:2},{value:"5.1 \u5171\u8BC6\u7B97\u6CD5\u6982\u8FF0",id:"51-\u5171\u8BC6\u7B97\u6CD5\u6982\u8FF0",level:3},{value:"\u5171\u8BC6\u7B97\u6CD5\u7684\u8981\u6C42",id:"\u5171\u8BC6\u7B97\u6CD5\u7684\u8981\u6C42",level:4},{value:"5.2 Paxos\u7B97\u6CD5",id:"52-paxos\u7B97\u6CD5",level:3},{value:"Paxos\u89D2\u8272\u5B9A\u4E49",id:"paxos\u89D2\u8272\u5B9A\u4E49",level:4},{value:"Paxos\u7B97\u6CD5\u6D41\u7A0B",id:"paxos\u7B97\u6CD5\u6D41\u7A0B",level:4},{value:"Paxos\u5B9E\u73B0\u793A\u4F8B",id:"paxos\u5B9E\u73B0\u793A\u4F8B",level:4},{value:"5.3 Raft\u7B97\u6CD5",id:"53-raft\u7B97\u6CD5",level:3},{value:"Raft\u7B97\u6CD5\u67B6\u6784",id:"raft\u7B97\u6CD5\u67B6\u6784",level:4},{value:"Raft\u7B97\u6CD5\u72B6\u6001\u8F6C\u6362",id:"raft\u7B97\u6CD5\u72B6\u6001\u8F6C\u6362",level:4},{value:"Raft\u6838\u5FC3\u673A\u5236",id:"raft\u6838\u5FC3\u673A\u5236",level:4},{value:"5.4 ZAB\u7B97\u6CD5",id:"54-zab\u7B97\u6CD5",level:3},{value:"ZAB\u7B97\u6CD5\u7279\u70B9",id:"zab\u7B97\u6CD5\u7279\u70B9",level:4},{value:"ZAB\u7B97\u6CD5\u6D41\u7A0B",id:"zab\u7B97\u6CD5\u6D41\u7A0B",level:4},{value:"6. \u65F6\u95F4\u4E0E ID\uFF1A\u5355\u8C03\u6027\u4E0E\u552F\u4E00\u6027",id:"6-\u65F6\u95F4\u4E0E-id\u5355\u8C03\u6027\u4E0E\u552F\u4E00\u6027",level:2},{value:"6.1 \u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u65F6\u95F4\u95EE\u9898",id:"61-\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u65F6\u95F4\u95EE\u9898",level:3},{value:"\u7269\u7406\u65F6\u949F vs \u903B\u8F91\u65F6\u949F",id:"\u7269\u7406\u65F6\u949F-vs-\u903B\u8F91\u65F6\u949F",level:4},{value:"Lamport\u65F6\u949F",id:"lamport\u65F6\u949F",level:4},{value:"6.2 \u5168\u5C40\u552F\u4E00ID\u751F\u6210",id:"62-\u5168\u5C40\u552F\u4E00id\u751F\u6210",level:3},{value:"ID\u751F\u6210\u7B56\u7565\u5BF9\u6BD4",id:"id\u751F\u6210\u7B56\u7565\u5BF9\u6BD4",level:4},{value:"Snowflake\u7B97\u6CD5\u5B9E\u73B0",id:"snowflake\u7B97\u6CD5\u5B9E\u73B0",level:4},{value:"\u53F7\u6BB5\u7F13\u5B58\u7B56\u7565",id:"\u53F7\u6BB5\u7F13\u5B58\u7B56\u7565",level:4},{value:"7. \u53EF\u9760\u901A\u4FE1\u4E0E\u91CD\u8BD5\uFF08\u4EA4\u4ED8\u8BED\u4E49\uFF09",id:"7-\u53EF\u9760\u901A\u4FE1\u4E0E\u91CD\u8BD5\u4EA4\u4ED8\u8BED\u4E49",level:2},{value:"7.1 \u6D88\u606F\u4EA4\u4ED8\u8BED\u4E49",id:"71-\u6D88\u606F\u4EA4\u4ED8\u8BED\u4E49",level:3},{value:"\u4E09\u79CD\u4EA4\u4ED8\u8BED\u4E49",id:"\u4E09\u79CD\u4EA4\u4ED8\u8BED\u4E49",level:4},{value:"\u81F3\u5C11\u4E00\u6B21\u4EA4\u4ED8\uFF08At-least-once\uFF09",id:"\u81F3\u5C11\u4E00\u6B21\u4EA4\u4ED8at-least-once",level:4},{value:"\u6070\u597D\u4E00\u6B21\u4EA4\u4ED8\uFF08Exactly-once\uFF09",id:"\u6070\u597D\u4E00\u6B21\u4EA4\u4ED8exactly-once",level:4},{value:"7.2 \u91CD\u8BD5\u7B56\u7565",id:"72-\u91CD\u8BD5\u7B56\u7565",level:3},{value:"\u6307\u6570\u9000\u907F\u7B97\u6CD5",id:"\u6307\u6570\u9000\u907F\u7B97\u6CD5",level:4},{value:"\u91CD\u8BD5\u7B56\u7565\u914D\u7F6E",id:"\u91CD\u8BD5\u7B56\u7565\u914D\u7F6E",level:4},{value:"8. \u8BBE\u8BA1\u4E0E\u843D\u5730\u6E05\u5355\uFF08Best Practices\uFF09",id:"8-\u8BBE\u8BA1\u4E0E\u843D\u5730\u6E05\u5355best-practices",level:2},{value:"8.1 \u7CFB\u7EDF\u8BBE\u8BA1\u539F\u5219",id:"81-\u7CFB\u7EDF\u8BBE\u8BA1\u539F\u5219",level:3},{value:"\u8BBE\u8BA1\u539F\u5219\u6E05\u5355",id:"\u8BBE\u8BA1\u539F\u5219\u6E05\u5355",level:4},{value:"\u4E00\u81F4\u6027\u9700\u6C42\u5206\u6790",id:"\u4E00\u81F4\u6027\u9700\u6C42\u5206\u6790",level:4},{value:"8.2 \u526F\u672C\u914D\u7F6E\u4F18\u5316",id:"82-\u526F\u672C\u914D\u7F6E\u4F18\u5316",level:3},{value:"Quorum\u914D\u7F6E\u68C0\u67E5",id:"quorum\u914D\u7F6E\u68C0\u67E5",level:4},{value:"8.3 \u76D1\u63A7\u4E0E\u89C2\u6D4B",id:"83-\u76D1\u63A7\u4E0E\u89C2\u6D4B",level:3},{value:"\u5173\u952E\u76D1\u63A7\u6307\u6807",id:"\u5173\u952E\u76D1\u63A7\u6307\u6807",level:4},{value:"\u94FE\u8DEF\u8FFD\u8E2A",id:"\u94FE\u8DEF\u8FFD\u8E2A",level:4},{value:"8.4 \u5E42\u7B49\u8BBE\u8BA1",id:"84-\u5E42\u7B49\u8BBE\u8BA1",level:3},{value:"\u5E42\u7B49\u6027\u5B9E\u73B0\u6A21\u5F0F",id:"\u5E42\u7B49\u6027\u5B9E\u73B0\u6A21\u5F0F",level:4},{value:"8.5 \u9650\u6D41\u4E0E\u7194\u65AD",id:"85-\u9650\u6D41\u4E0E\u7194\u65AD",level:3},{value:"\u9650\u6D41\u5668\u5B9E\u73B0",id:"\u9650\u6D41\u5668\u5B9E\u73B0",level:4},{value:"\u7194\u65AD\u5668\u5B9E\u73B0",id:"\u7194\u65AD\u5668\u5B9E\u73B0",level:4},{value:"9. \u5E38\u89C1\u5751\u4F4D\uFF08Pitfalls\uFF09",id:"9-\u5E38\u89C1\u5751\u4F4Dpitfalls",level:2},{value:"9.1 \u65F6\u949F\u4F9D\u8D56\u95EE\u9898",id:"91-\u65F6\u949F\u4F9D\u8D56\u95EE\u9898",level:3},{value:"\u65F6\u949F\u56DE\u62E8\u5904\u7406",id:"\u65F6\u949F\u56DE\u62E8\u5904\u7406",level:4},{value:"9.2 \u7F51\u7EDC\u5206\u533A\u5904\u7406",id:"92-\u7F51\u7EDC\u5206\u533A\u5904\u7406",level:3},{value:"\u5206\u533A\u68C0\u6D4B",id:"\u5206\u533A\u68C0\u6D4B",level:4},{value:"9.3 \u5199\u6269\u6563\u95EE\u9898",id:"93-\u5199\u6269\u6563\u95EE\u9898",level:3},{value:"\u5199\u6269\u6563\u68C0\u6D4B",id:"\u5199\u6269\u6563\u68C0\u6D4B",level:4},{value:"9.4 \u5E42\u7B49\u6027\u7F3A\u5931",id:"94-\u5E42\u7B49\u6027\u7F3A\u5931",level:3},{value:"\u5E42\u7B49\u6027\u68C0\u67E5",id:"\u5E42\u7B49\u6027\u68C0\u67E5",level:4},{value:"10. \u9762\u8BD5\u9898\u7CBE\u9009",id:"10-\u9762\u8BD5\u9898\u7CBE\u9009",level:2},{value:"10.1 \u57FA\u7840\u6982\u5FF5\u9898",id:"101-\u57FA\u7840\u6982\u5FF5\u9898",level:3},{value:"Q1: \u8BF7\u89E3\u91CACAP\u5B9A\u7406\uFF0C\u5E76\u4E3ECP\u4E0EAP\u7CFB\u7EDF\u7684\u5B9E\u9645\u6848\u4F8B\uFF0C\u8BF4\u660E\u53D6\u820D\u7406\u7531",id:"q1-\u8BF7\u89E3\u91CAcap\u5B9A\u7406\u5E76\u4E3Ecp\u4E0Eap\u7CFB\u7EDF\u7684\u5B9E\u9645\u6848\u4F8B\u8BF4\u660E\u53D6\u820D\u7406\u7531",level:4},{value:"Q2: Quorum\u6761\u4EF6R+W&gt;N\u80FD\u4FDD\u8BC1\u4EC0\u4E48\uFF1F\u5728\u7F51\u7EDC\u5206\u533A\u4E0B\u6709\u54EA\u4E9B\u9650\u5236\uFF1F",id:"q2-quorum\u6761\u4EF6rwn\u80FD\u4FDD\u8BC1\u4EC0\u4E48\u5728\u7F51\u7EDC\u5206\u533A\u4E0B\u6709\u54EA\u4E9B\u9650\u5236",level:4},{value:"10.2 \u7B97\u6CD5\u5B9E\u73B0\u9898",id:"102-\u7B97\u6CD5\u5B9E\u73B0\u9898",level:3},{value:"Q3: Raft\u5982\u4F55\u4FDD\u8BC1\u65E5\u5FD7\u7684\u4E00\u81F4\u590D\u5236\u4E0E\u63D0\u4EA4\u7D22\u5F15\u7684\u5B89\u5168\u6027\uFF1F",id:"q3-raft\u5982\u4F55\u4FDD\u8BC1\u65E5\u5FD7\u7684\u4E00\u81F4\u590D\u5236\u4E0E\u63D0\u4EA4\u7D22\u5F15\u7684\u5B89\u5168\u6027",level:4},{value:"Q4: \u4F55\u65F6\u9009\u62E9CRDT\uFF1F\u4E0E\u5411\u91CF\u65F6\u949F\u7684\u5173\u7CFB\u4E0E\u5C40\u9650",id:"q4-\u4F55\u65F6\u9009\u62E9crdt\u4E0E\u5411\u91CF\u65F6\u949F\u7684\u5173\u7CFB\u4E0E\u5C40\u9650",level:4},{value:"10.3 \u7CFB\u7EDF\u8BBE\u8BA1\u9898",id:"103-\u7CFB\u7EDF\u8BBE\u8BA1\u9898",level:3},{value:"Q5: \u8BBE\u8BA1\u4E00\u4E2A\u5168\u5C40\u552F\u4E00ID\u65B9\u6848\uFF0C\u5982\u4F55\u5904\u7406\u65F6\u949F\u56DE\u62E8\u4E0E\u70ED\u70B9\u5206\u914D",id:"q5-\u8BBE\u8BA1\u4E00\u4E2A\u5168\u5C40\u552F\u4E00id\u65B9\u6848\u5982\u4F55\u5904\u7406\u65F6\u949F\u56DE\u62E8\u4E0E\u70ED\u70B9\u5206\u914D",level:4},{value:"Q6: \u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u9AD8\u53EF\u7528\u7684\u5206\u5E03\u5F0F\u9501\u7CFB\u7EDF\uFF1F",id:"q6-\u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u9AD8\u53EF\u7528\u7684\u5206\u5E03\u5F0F\u9501\u7CFB\u7EDF",level:4},{value:"Q7: \u8BBE\u8BA1\u4E00\u4E2A\u5206\u5E03\u5F0F\u7F13\u5B58\u7CFB\u7EDF\uFF0C\u5982\u4F55\u5904\u7406\u7F13\u5B58\u4E00\u81F4\u6027\u95EE\u9898\uFF1F",id:"q7-\u8BBE\u8BA1\u4E00\u4E2A\u5206\u5E03\u5F0F\u7F13\u5B58\u7CFB\u7EDF\u5982\u4F55\u5904\u7406\u7F13\u5B58\u4E00\u81F4\u6027\u95EE\u9898",level:4}];function o(n){let e={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7406\u8BBA\u57FA\u7840\u8BE6\u89E3",children:"\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7406\u8BBA\u57FA\u7840\u8BE6\u89E3"})}),"\n",(0,r.jsx)(e.p,{children:"\u5206\u5E03\u5F0F\u7CFB\u7EDF\u662F\u73B0\u4EE3\u4E92\u8054\u7F51\u5E94\u7528\u7684\u57FA\u7840\u67B6\u6784\uFF0C\u638C\u63E1\u5206\u5E03\u5F0F\u7CFB\u7EDF\u8BBE\u8BA1\u5BF9\u4E8E\u6784\u5EFA\u9AD8\u53EF\u7528\u3001\u9AD8\u6027\u80FD\u7684\u7CFB\u7EDF\u81F3\u5173\u91CD\u8981\u3002\u672C\u7AE0\u7CFB\u7EDF\u68B3\u7406\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u6838\u5FC3\u7406\u8BBA\u4E0E\u5DE5\u7A0B\u53D6\u820D\uFF0C\u5E2E\u52A9\u4F60\u5728\u8BBE\u8BA1\u4E0E\u843D\u5730\u65F6\u505A\u51FA\u53EF\u89E3\u91CA\u7684\u6743\u8861\u3002"}),"\n",(0,r.jsxs)(e.admonition,{title:"\u5B66\u4E60\u76EE\u6807",type:"tip",children:[(0,r.jsx)(e.p,{children:"\u901A\u8FC7\u672C\u7AE0\u5B66\u4E60\uFF0C\u4F60\u5C06\u638C\u63E1\uFF1A"}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u57FA\u672C\u6982\u5FF5\u548C\u8BBE\u8BA1\u76EE\u6807"}),"\n",(0,r.jsx)(e.li,{children:"CAP\u5B9A\u7406\u7684\u6DF1\u5165\u7406\u89E3\u548C\u5DE5\u7A0B\u5B9E\u8DF5"}),"\n",(0,r.jsx)(e.li,{children:"\u4E00\u81F4\u6027\u6A21\u578B\u7684\u5206\u7C7B\u548C\u5E94\u7528\u573A\u666F"}),"\n",(0,r.jsx)(e.li,{children:"\u5171\u8BC6\u7B97\u6CD5\u7684\u539F\u7406\u548C\u5B9E\u73B0"}),"\n",(0,r.jsx)(e.li,{children:"\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u8BBE\u8BA1\u6A21\u5F0F\u548C\u6700\u4F73\u5B9E\u8DF5"}),"\n"]})]}),"\n",(0,r.jsx)(e.h2,{id:"1-\u5206\u5E03\u5F0F\u7CFB\u7EDF\u57FA\u672C\u6982\u5FF5",children:"1. \u5206\u5E03\u5F0F\u7CFB\u7EDF\u57FA\u672C\u6982\u5FF5"}),"\n",(0,r.jsx)(e.h3,{id:"11-\u4EC0\u4E48\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF",children:"1.1 \u4EC0\u4E48\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\uFF1F"}),"\n",(0,r.jsx)(e.p,{children:"\u5206\u5E03\u5F0F\u7CFB\u7EDF\u662F\u7531\u591A\u4E2A\u72EC\u7ACB\u8BA1\u7B97\u673A\u8282\u70B9\u7EC4\u6210\u7684\u7CFB\u7EDF\uFF0C\u8FD9\u4E9B\u8282\u70B9\u901A\u8FC7\u7F51\u7EDC\u8FDB\u884C\u901A\u4FE1\u548C\u534F\u4F5C\uFF0C\u5BF9\u5916\u8868\u73B0\u4E3A\u4E00\u4E2A\u7EDF\u4E00\u7684\u7CFB\u7EDF\u3002"}),"\n",(0,r.jsx)(e.admonition,{title:"\u6838\u5FC3\u7279\u5F81",type:"info",children:(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8282\u70B9\u72EC\u7ACB\u6027"}),"\uFF1A\u6BCF\u4E2A\u8282\u70B9\u90FD\u662F\u72EC\u7ACB\u7684\u8BA1\u7B97\u673A\uFF0C\u53EF\u4EE5\u72EC\u7ACB\u8FD0\u884C"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7F51\u7EDC\u901A\u4FE1"}),"\uFF1A\u8282\u70B9\u95F4\u901A\u8FC7\u7F51\u7EDC\u8FDB\u884C\u901A\u4FE1\uFF0C\u5B58\u5728\u7F51\u7EDC\u5EF6\u8FDF\u548C\u6545\u969C"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7EDF\u4E00\u5BF9\u5916"}),"\uFF1A\u5BF9\u5916\u8868\u73B0\u4E3A\u4E00\u4E2A\u6574\u4F53\u7CFB\u7EDF\uFF0C\u9690\u85CF\u5185\u90E8\u590D\u6742\u6027"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5E76\u53D1\u5904\u7406"}),"\uFF1A\u591A\u4E2A\u8282\u70B9\u53EF\u4EE5\u5E76\u53D1\u5904\u7406\u8BF7\u6C42\uFF0C\u63D0\u9AD8\u7CFB\u7EDF\u6027\u80FD"]}),"\n"]})}),"\n",(0,r.jsx)(e.h3,{id:"12-\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u8BBE\u8BA1\u76EE\u6807",children:"1.2 \u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u8BBE\u8BA1\u76EE\u6807"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u8BBE\u8BA1\u76EE\u6807"}),(0,r.jsx)(e.th,{children:"\u5B9A\u4E49"}),(0,r.jsx)(e.th,{children:"\u91CD\u8981\u6027"}),(0,r.jsx)(e.th,{children:"\u5B9E\u73B0\u6311\u6218"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u53EF\u4F38\u7F29\u6027\uFF08Scalability\uFF09"})}),(0,r.jsx)(e.td,{children:"\u7CFB\u7EDF\u80FD\u591F\u901A\u8FC7\u589E\u52A0\u8282\u70B9\u6765\u63D0\u5347\u5904\u7406\u80FD\u529B"}),(0,r.jsx)(e.td,{children:"\u652F\u6301\u4E1A\u52A1\u589E\u957F"}),(0,r.jsx)(e.td,{children:"\u6570\u636E\u5206\u7247\u3001\u8D1F\u8F7D\u5747\u8861"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u9AD8\u53EF\u7528\u6027\uFF08Availability\uFF09"})}),(0,r.jsx)(e.td,{children:"\u7CFB\u7EDF\u5728\u6545\u969C\u65F6\u4ECD\u80FD\u63D0\u4F9B\u670D\u52A1"}),(0,r.jsx)(e.td,{children:"\u4FDD\u8BC1\u4E1A\u52A1\u8FDE\u7EED\u6027"}),(0,r.jsx)(e.td,{children:"\u6545\u969C\u68C0\u6D4B\u3001\u81EA\u52A8\u6062\u590D"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u4E00\u81F4\u6027\uFF08Consistency\uFF09"})}),(0,r.jsx)(e.td,{children:"\u6570\u636E\u5728\u591A\u4E2A\u526F\u672C\u95F4\u4FDD\u6301\u4E00\u81F4"}),(0,r.jsx)(e.td,{children:"\u4FDD\u8BC1\u6570\u636E\u6B63\u786E\u6027"}),(0,r.jsx)(e.td,{children:"\u540C\u6B65\u673A\u5236\u3001\u51B2\u7A81\u89E3\u51B3"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u5BB9\u9519\u6027\uFF08Fault Tolerance\uFF09"})}),(0,r.jsx)(e.td,{children:"\u7CFB\u7EDF\u5728\u90E8\u5206\u8282\u70B9\u6545\u969C\u65F6\u4ECD\u80FD\u8FD0\u884C"}),(0,r.jsx)(e.td,{children:"\u63D0\u9AD8\u7CFB\u7EDF\u7A33\u5B9A\u6027"}),(0,r.jsx)(e.td,{children:"\u5197\u4F59\u8BBE\u8BA1\u3001\u6545\u969C\u9694\u79BB"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"13-\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u6311\u6218",children:"1.3 \u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u6311\u6218"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph TD\n    A[\u5206\u5E03\u5F0F\u7CFB\u7EDF\u6311\u6218] --\x3e B[\u7F51\u7EDC\u5206\u533A]\n    A --\x3e C[\u65F6\u949F\u540C\u6B65]\n    A --\x3e D[\u6570\u636E\u4E00\u81F4\u6027]\n    A --\x3e E[\u6545\u969C\u5904\u7406]\n    A --\x3e F[\u5E76\u53D1\u63A7\u5236]\n    \n    B --\x3e B1[\u7F51\u7EDC\u5EF6\u8FDF]\n    B --\x3e B2[\u6D88\u606F\u4E22\u5931]\n    B --\x3e B3[\u7F51\u7EDC\u6296\u52A8]\n    \n    C --\x3e C1[\u65F6\u949F\u6F02\u79FB]\n    C --\x3e C2[\u65F6\u949F\u56DE\u62E8]\n    C --\x3e C3[\u65F6\u95F4\u540C\u6B65]\n    \n    D --\x3e D1[\u5F3A\u4E00\u81F4\u6027]\n    D --\x3e D2[\u6700\u7EC8\u4E00\u81F4\u6027]\n    D --\x3e D3[\u56E0\u679C\u4E00\u81F4\u6027]\n    \n    E --\x3e E1[\u8282\u70B9\u6545\u969C]\n    E --\x3e E2[\u7F51\u7EDC\u6545\u969C]\n    E --\x3e E3[\u8F6F\u4EF6\u6545\u969C]\n    \n    F --\x3e F1[\u7ADE\u6001\u6761\u4EF6]\n    F --\x3e F2[\u6B7B\u9501\u95EE\u9898]\n    F --\x3e F3[\u6D3B\u9501\u95EE\u9898]"}),"\n",(0,r.jsxs)(e.admonition,{title:"\u5DE5\u7A0B\u5B9E\u8DF5\u8981\u70B9",type:"caution",children:[(0,r.jsx)(e.p,{children:"\u5728\u5B9E\u9645\u5DE5\u7A0B\u4E2D\uFF0C\u6211\u4EEC\u901A\u5E38\u9700\u8981\u5728\u4E0D\u540C\u7684\u8BBE\u8BA1\u76EE\u6807\u4E4B\u95F4\u8FDB\u884C\u6743\u8861\uFF1A"}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"CP\u7CFB\u7EDF"}),"\uFF1A\u4F18\u5148\u4FDD\u8BC1\u4E00\u81F4\u6027\u548C\u5206\u533A\u5BB9\u9519\u6027\uFF0C\u727A\u7272\u90E8\u5206\u53EF\u7528\u6027"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"AP\u7CFB\u7EDF"}),"\uFF1A\u4F18\u5148\u4FDD\u8BC1\u53EF\u7528\u6027\u548C\u5206\u533A\u5BB9\u9519\u6027\uFF0C\u63A5\u53D7\u6700\u7EC8\u4E00\u81F4\u6027"]}),"\n"]})]}),"\n",(0,r.jsx)(e.h2,{id:"2-cap-\u5B9A\u7406\u4E0E\u5DE5\u7A0B\u89E3\u8BFB",children:"2. CAP \u5B9A\u7406\u4E0E\u5DE5\u7A0B\u89E3\u8BFB"}),"\n",(0,r.jsx)(e.h3,{id:"21-cap\u5B9A\u7406\u6982\u8FF0",children:"2.1 CAP\u5B9A\u7406\u6982\u8FF0"}),"\n",(0,r.jsx)(e.p,{children:"CAP\u5B9A\u7406\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\u8BBE\u8BA1\u7684\u7406\u8BBA\u57FA\u7840\uFF0C\u7531Eric Brewer\u57282000\u5E74\u63D0\u51FA\uFF0C\u540E\u6765\u7531Seth Gilbert\u548CNancy Lynch\u57282003\u5E74\u8FDB\u884C\u4E86\u5F62\u5F0F\u5316\u8BC1\u660E\u3002"}),"\n",(0,r.jsx)(e.h4,{id:"cap\u5B9A\u7406\u5185\u5BB9",children:"CAP\u5B9A\u7406\u5185\u5BB9"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"C\uFF08Consistency \u4E00\u81F4\u6027\uFF09"}),"\uFF1A\u540C\u4E00\u6570\u636E\u5728\u4EFB\u610F\u526F\u672C\u8BFB\u53D6\u5230\u76F8\u540C\u503C"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"A\uFF08Availability \u53EF\u7528\u6027\uFF09"}),"\uFF1A\u6BCF\u4E2A\u8BF7\u6C42\u90FD\u80FD\u5728\u6709\u9650\u65F6\u95F4\u5185\u8FD4\u56DE\uFF08\u4E0D\u4E00\u5B9A\u662F\u6700\u65B0\uFF09"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"P\uFF08Partition tolerance \u5206\u533A\u5BB9\u9519\uFF09"}),"\uFF1A\u51FA\u73B0\u7F51\u7EDC\u5206\u533A\u65F6\u7CFB\u7EDF\u4ECD\u80FD\u5BF9\u5916\u670D\u52A1"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7ED3\u8BBA"}),"\uFF1A\u5206\u533A\u4E00\u65E6\u53D1\u751F\uFF08P \u5FC5\u9009\uFF09\uFF0C\u53EA\u80FD\u5728 C \u4E0E A \u4E4B\u95F4\u4E8C\u9009\u4E00\u3002"]}),"\n",(0,r.jsx)(e.h3,{id:"22-cap\u5B9A\u7406\u7684\u5DE5\u7A0B\u89E3\u8BFB",children:"2.2 CAP\u5B9A\u7406\u7684\u5DE5\u7A0B\u89E3\u8BFB"}),"\n",(0,r.jsx)(e.h4,{id:"cp\u7CFB\u7EDF\u4E00\u81F4\u6027\u4F18\u5148",children:"CP\u7CFB\u7EDF\uFF08\u4E00\u81F4\u6027\u4F18\u5148\uFF09"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph LR\n    A[\u5BA2\u6237\u7AEF] --\x3e B[CP\u7CFB\u7EDF]\n    B --\x3e C[\u5F3A\u4E00\u81F4\u6027\u4FDD\u8BC1]\n    B --\x3e D[\u5206\u533A\u65F6\u62D2\u7EDD\u670D\u52A1]\n    B --\x3e E[\u6570\u636E\u6B63\u786E\u6027\u4F18\u5148]\n    \n    C --\x3e F[ZooKeeper]\n    C --\x3e G[Etcd]\n    C --\x3e H[Consul]"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7279\u70B9"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5728\u7F51\u7EDC\u5206\u533A\u65F6\uFF0C\u7CFB\u7EDF\u4F1A\u62D2\u7EDD\u90E8\u5206\u8BF7\u6C42\u4EE5\u4FDD\u8BC1\u4E00\u81F4\u6027"}),"\n",(0,r.jsx)(e.li,{children:"\u9002\u5408\u5BF9\u6570\u636E\u6B63\u786E\u6027\u8981\u6C42\u6781\u9AD8\u7684\u573A\u666F"}),"\n",(0,r.jsx)(e.li,{children:"\u5178\u578B\u5E94\u7528\uFF1A\u914D\u7F6E\u7BA1\u7406\u3001\u5206\u5E03\u5F0F\u9501\u3001\u5143\u6570\u636E\u5B58\u50A8"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u5B9E\u73B0\u65B9\u5F0F"}),"\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="CP\u7CFB\u7EDF\u793A\u4F8B - \u5206\u5E03\u5F0F\u9501"',children:'public class DistributedLock {\n    private final ZooKeeper zk;\n    private final String lockPath;\n    \n    public boolean tryLock(String resource, long timeout) {\n        try {\n            // \u521B\u5EFA\u4E34\u65F6\u8282\u70B9\uFF0C\u4FDD\u8BC1\u5F3A\u4E00\u81F4\u6027\n            String path = zk.create("/locks/" + resource + "/lock-", \n                                   new byte[0], \n                                   ZooDefs.Ids.OPEN_ACL_UNSAFE, \n                                   CreateMode.EPHEMERAL_SEQUENTIAL);\n            \n            // \u68C0\u67E5\u662F\u5426\u83B7\u5F97\u9501\n            List<String> children = zk.getChildren("/locks/" + resource, false);\n            Collections.sort(children);\n            \n            if (path.endsWith(children.get(0))) {\n                return true; // \u83B7\u5F97\u9501\n            }\n            \n            // \u7B49\u5F85\u9501\u91CA\u653E\n            return waitForLock(children, path, timeout);\n        } catch (Exception e) {\n            return false;\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h4,{id:"ap\u7CFB\u7EDF\u53EF\u7528\u6027\u4F18\u5148",children:"AP\u7CFB\u7EDF\uFF08\u53EF\u7528\u6027\u4F18\u5148\uFF09"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph LR\n    A[\u5BA2\u6237\u7AEF] --\x3e B[AP\u7CFB\u7EDF]\n    B --\x3e C[\u9AD8\u53EF\u7528\u6027\u4FDD\u8BC1]\n    B --\x3e D[\u63A5\u53D7\u6700\u7EC8\u4E00\u81F4\u6027]\n    B --\x3e E[\u670D\u52A1\u53EF\u7528\u6027\u4F18\u5148]\n    \n    C --\x3e F[Cassandra]\n    C --\x3e G[DynamoDB]\n    C --\x3e H[Riak]"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7279\u70B9"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5728\u7F51\u7EDC\u5206\u533A\u65F6\uFF0C\u7CFB\u7EDF\u7EE7\u7EED\u63D0\u4F9B\u670D\u52A1\uFF0C\u4F46\u53EF\u80FD\u8FD4\u56DE\u65E7\u6570\u636E"}),"\n",(0,r.jsx)(e.li,{children:"\u9002\u5408\u5BF9\u53EF\u7528\u6027\u8981\u6C42\u6781\u9AD8\u7684\u573A\u666F"}),"\n",(0,r.jsx)(e.li,{children:"\u5178\u578B\u5E94\u7528\uFF1A\u5185\u5BB9\u5206\u53D1\u3001\u7F13\u5B58\u7CFB\u7EDF\u3001\u65E5\u5FD7\u5B58\u50A8"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u5B9E\u73B0\u65B9\u5F0F"}),"\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="AP\u7CFB\u7EDF\u793A\u4F8B - \u6700\u7EC8\u4E00\u81F4\u6027\u7F13\u5B58"',children:"public class EventuallyConsistentCache<K, V> {\n    private final Map<K, V> localCache = new ConcurrentHashMap<>();\n    private final List<CacheNode> nodes;\n    \n    public V get(K key) {\n        // \u4F18\u5148\u4ECE\u672C\u5730\u7F13\u5B58\u8BFB\u53D6\uFF0C\u4FDD\u8BC1\u53EF\u7528\u6027\n        V value = localCache.get(key);\n        if (value != null) {\n            return value;\n        }\n        \n        // \u5C1D\u8BD5\u4ECE\u5176\u4ED6\u8282\u70B9\u8BFB\u53D6\n        for (CacheNode node : nodes) {\n            try {\n                value = node.get(key);\n                if (value != null) {\n                    localCache.put(key, value);\n                    return value;\n                }\n            } catch (Exception e) {\n                // \u8282\u70B9\u4E0D\u53EF\u7528\uFF0C\u7EE7\u7EED\u5C1D\u8BD5\u5176\u4ED6\u8282\u70B9\n                continue;\n            }\n        }\n        \n        return null;\n    }\n    \n    public void put(K key, V value) {\n        // \u5148\u66F4\u65B0\u672C\u5730\u7F13\u5B58\uFF0C\u4FDD\u8BC1\u53EF\u7528\u6027\n        localCache.put(key, value);\n        \n        // \u5F02\u6B65\u66F4\u65B0\u5176\u4ED6\u8282\u70B9\uFF0C\u63A5\u53D7\u6700\u7EC8\u4E00\u81F4\u6027\n        for (CacheNode node : nodes) {\n            CompletableFuture.runAsync(() -> {\n                try {\n                    node.put(key, value);\n                } catch (Exception e) {\n                    // \u5F02\u6B65\u66F4\u65B0\u5931\u8D25\uFF0C\u4E0D\u5F71\u54CD\u4E3B\u6D41\u7A0B\n                }\n            });\n        }\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"23-cap\u5B9A\u7406\u7684\u5B9E\u8DF5\u5EFA\u8BAE",children:"2.3 CAP\u5B9A\u7406\u7684\u5B9E\u8DF5\u5EFA\u8BAE"}),"\n",(0,r.jsx)(e.h4,{id:"\u6309\u4E1A\u52A1\u573A\u666F\u9009\u62E9",children:"\u6309\u4E1A\u52A1\u573A\u666F\u9009\u62E9"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u4E1A\u52A1\u573A\u666F"}),(0,r.jsx)(e.th,{children:"\u63A8\u8350\u9009\u62E9"}),(0,r.jsx)(e.th,{children:"\u7406\u7531"}),(0,r.jsx)(e.th,{children:"\u5178\u578B\u7CFB\u7EDF"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u91D1\u878D\u4EA4\u6613"})}),(0,r.jsx)(e.td,{children:"CP"}),(0,r.jsx)(e.td,{children:"\u6570\u636E\u6B63\u786E\u6027\u81F3\u5173\u91CD\u8981"}),(0,r.jsx)(e.td,{children:"\u94F6\u884C\u6838\u5FC3\u7CFB\u7EDF"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u7535\u5546\u5E93\u5B58"})}),(0,r.jsx)(e.td,{children:"CP"}),(0,r.jsx)(e.td,{children:"\u907F\u514D\u8D85\u5356\u95EE\u9898"}),(0,r.jsx)(e.td,{children:"\u5E93\u5B58\u7BA1\u7406\u7CFB\u7EDF"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u7528\u6237\u914D\u7F6E"})}),(0,r.jsx)(e.td,{children:"CP"}),(0,r.jsx)(e.td,{children:"\u914D\u7F6E\u4E00\u81F4\u6027\u91CD\u8981"}),(0,r.jsx)(e.td,{children:"\u914D\u7F6E\u4E2D\u5FC3"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u5185\u5BB9\u7F13\u5B58"})}),(0,r.jsx)(e.td,{children:"AP"}),(0,r.jsx)(e.td,{children:"\u53EF\u7528\u6027\u4F18\u5148\uFF0C\u5185\u5BB9\u53EF\u5BB9\u5FCD\u5EF6\u8FDF"}),(0,r.jsx)(e.td,{children:"CDN\u7CFB\u7EDF"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u65E5\u5FD7\u5B58\u50A8"})}),(0,r.jsx)(e.td,{children:"AP"}),(0,r.jsx)(e.td,{children:"\u53EF\u7528\u6027\u4F18\u5148\uFF0C\u6570\u636E\u53EF\u5BB9\u5FCD\u4E22\u5931"}),(0,r.jsx)(e.td,{children:"\u65E5\u5FD7\u7CFB\u7EDF"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u793E\u4EA4\u52A8\u6001"})}),(0,r.jsx)(e.td,{children:"AP"}),(0,r.jsx)(e.td,{children:"\u53EF\u7528\u6027\u4F18\u5148\uFF0C\u5185\u5BB9\u53EF\u5BB9\u5FCD\u5EF6\u8FDF"}),(0,r.jsx)(e.td,{children:"\u793E\u4EA4\u5E73\u53F0"})]})]})]}),"\n",(0,r.jsx)(e.h4,{id:"\u6DF7\u5408\u67B6\u6784\u8BBE\u8BA1",children:"\u6DF7\u5408\u67B6\u6784\u8BBE\u8BA1"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph TB\n    A[\u5BA2\u6237\u7AEF] --\x3e B[API\u7F51\u5173]\n    B --\x3e C[\u5F3A\u4E00\u81F4\u6838\u5FC3]\n    B --\x3e D[\u6700\u7EC8\u4E00\u81F4\u8FB9\u7F18]\n    \n    C --\x3e E[\u7528\u6237\u8D26\u6237]\n    C --\x3e F[\u8BA2\u5355\u7CFB\u7EDF]\n    C --\x3e G[\u652F\u4ED8\u7CFB\u7EDF]\n    \n    D --\x3e H[\u5546\u54C1\u4FE1\u606F]\n    D --\x3e I[\u7528\u6237\u52A8\u6001]\n    D --\x3e J[\u63A8\u8350\u7CFB\u7EDF]"}),"\n",(0,r.jsx)(e.admonition,{title:"CAP\u9009\u62E9\u539F\u5219",type:"tip",children:(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6570\u636E\u91CD\u8981\u6027"}),"\uFF1A\u5173\u952E\u4E1A\u52A1\u6570\u636E\u9009\u62E9CP\uFF0C\u975E\u5173\u952E\u6570\u636E\u9009\u62E9AP"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5B9E\u65F6\u6027\u8981\u6C42"}),"\uFF1A\u5F3A\u5B9E\u65F6\u6027\u9009\u62E9CP\uFF0C\u53EF\u5BB9\u5FCD\u5EF6\u8FDF\u9009\u62E9AP"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u4E1A\u52A1\u5BB9\u5FCD\u5EA6"}),"\uFF1A\u5BF9\u6570\u636E\u9519\u8BEF\u5BB9\u5FCD\u5EA6\u4F4E\u9009\u62E9CP\uFF0C\u5BF9\u670D\u52A1\u4E2D\u65AD\u5BB9\u5FCD\u5EA6\u4F4E\u9009\u62E9AP"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6210\u672C\u8003\u8651"}),"\uFF1ACP\u7CFB\u7EDF\u901A\u5E38\u6210\u672C\u66F4\u9AD8\uFF0CAP\u7CFB\u7EDF\u6210\u672C\u76F8\u5BF9\u8F83\u4F4E"]}),"\n"]})}),"\n",(0,r.jsx)(e.h2,{id:"3-base-\u7406\u8BBA\u4E0E\u4E00\u81F4\u6027\u6A21\u578B",children:"3. BASE \u7406\u8BBA\u4E0E\u4E00\u81F4\u6027\u6A21\u578B"}),"\n",(0,r.jsx)(e.h3,{id:"31-base\u7406\u8BBA\u6982\u8FF0",children:"3.1 BASE\u7406\u8BBA\u6982\u8FF0"}),"\n",(0,r.jsx)(e.p,{children:"BASE\u7406\u8BBA\u662F\u5BF9CAP\u5B9A\u7406\u4E2DAP\u7CFB\u7EDF\u7684\u8865\u5145\uFF0C\u7531Dan Pritchett\u57282008\u5E74\u63D0\u51FA\uFF0C\u662F\u5BF9\u4F20\u7EDFACID\u7279\u6027\u7684\u8865\u5145\u3002"}),"\n",(0,r.jsx)(e.h4,{id:"base\u7406\u8BBA\u5185\u5BB9",children:"BASE\u7406\u8BBA\u5185\u5BB9"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"B\uFF08Basically Available \u57FA\u672C\u53EF\u7528\uFF09"}),"\uFF1A\u7CFB\u7EDF\u5728\u6545\u969C\u65F6\u4ECD\u80FD\u63D0\u4F9B\u57FA\u672C\u670D\u52A1"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"S\uFF08Soft state \u8F6F\u72B6\u6001\uFF09"}),"\uFF1A\u5141\u8BB8\u7CFB\u7EDF\u5B58\u5728\u4E2D\u95F4\u72B6\u6001\uFF0C\u4E0D\u8981\u6C42\u5F3A\u4E00\u81F4\u6027"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"E\uFF08Eventual consistency \u6700\u7EC8\u4E00\u81F4\u6027\uFF09"}),"\uFF1A\u7ECF\u8FC7\u4E00\u6BB5\u65F6\u95F4\u540E\uFF0C\u6240\u6709\u526F\u672C\u6700\u7EC8\u4F1A\u8FBE\u5230\u4E00\u81F4\u72B6\u6001"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"32-\u4E00\u81F4\u6027\u6A21\u578B\u8BE6\u89E3",children:"3.2 \u4E00\u81F4\u6027\u6A21\u578B\u8BE6\u89E3"}),"\n",(0,r.jsx)(e.h4,{id:"\u4E00\u81F4\u6027\u6A21\u578B\u5C42\u6B21\u7ED3\u6784",children:"\u4E00\u81F4\u6027\u6A21\u578B\u5C42\u6B21\u7ED3\u6784"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph TD\n    A[\u4E00\u81F4\u6027\u6A21\u578B] --\x3e B[\u5F3A\u4E00\u81F4\u6027]\n    A --\x3e C[\u5F31\u4E00\u81F4\u6027]\n    \n    B --\x3e D[\u7EBF\u6027\u4E00\u81F4\u6027]\n    B --\x3e E[\u987A\u5E8F\u4E00\u81F4\u6027]\n    \n    C --\x3e F[\u56E0\u679C\u4E00\u81F4\u6027]\n    C --\x3e G[\u4F1A\u8BDD\u4E00\u81F4\u6027]\n    C --\x3e H[\u6700\u7EC8\u4E00\u81F4\u6027]\n    \n    D --\x3e I[\u770B\u8D77\u6765\u50CF\u5355\u673A\u987A\u5E8F\u6267\u884C]\n    E --\x3e J[\u6240\u6709\u64CD\u4F5C\u53EF\u91CD\u6392\u4E3A\u540C\u4E00\u987A\u5E8F]\n    F --\x3e K[\u5C0A\u91CD\u56E0\u679C\u5148\u540E\u5173\u7CFB]\n    G --\x3e L[\u540C\u4F1A\u8BDD\u5185\u8BFB\u5230\u81EA\u5DF1\u7684\u5199]\n    H --\x3e M[\u8DB3\u591F\u957F\u65F6\u95F4\u540E\u6536\u655B\u5230\u540C\u4E00\u72B6\u6001]"}),"\n",(0,r.jsx)(e.h4,{id:"\u7EBF\u6027\u4E00\u81F4\u6027linearizability",children:"\u7EBF\u6027\u4E00\u81F4\u6027\uFF08Linearizability\uFF09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u7EBF\u6027\u4E00\u81F4\u6027\u793A\u4F8B"',children:"public class LinearizableCounter {\n    private final AtomicLong counter = new AtomicLong(0);\n    \n    public long increment() {\n        // \u7EBF\u6027\u4E00\u81F4\u6027\uFF1A\u6240\u6709\u64CD\u4F5C\u770B\u8D77\u6765\u50CF\u5728\u5355\u673A\u4E0A\u987A\u5E8F\u6267\u884C\n        return counter.incrementAndGet();\n    }\n    \n    public long get() {\n        // \u8BFB\u53D6\u64CD\u4F5C\u80FD\u770B\u5230\u6240\u6709\u5DF2\u5B8C\u6210\u7684\u5199\u64CD\u4F5C\n        return counter.get();\n    }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7279\u70B9"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u6240\u6709\u64CD\u4F5C\u770B\u8D77\u6765\u50CF\u5728\u5355\u673A\u4E0A\u987A\u5E8F\u6267\u884C"}),"\n",(0,r.jsx)(e.li,{children:"\u8BFB\u53D6\u64CD\u4F5C\u80FD\u770B\u5230\u6240\u6709\u5DF2\u5B8C\u6210\u7684\u5199\u64CD\u4F5C"}),"\n",(0,r.jsx)(e.li,{children:"\u5B9E\u73B0\u590D\u6742\uFF0C\u6027\u80FD\u5F00\u9500\u5927"}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"\u987A\u5E8F\u4E00\u81F4\u6027sequential-consistency",children:"\u987A\u5E8F\u4E00\u81F4\u6027\uFF08Sequential Consistency\uFF09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u987A\u5E8F\u4E00\u81F4\u6027\u793A\u4F8B"',children:"public class SequentiallyConsistentQueue {\n    private final Queue<String> queue = new ConcurrentLinkedQueue<>();\n    \n    public void enqueue(String item) {\n        // \u987A\u5E8F\u4E00\u81F4\u6027\uFF1A\u6240\u6709\u64CD\u4F5C\u53EF\u91CD\u6392\u4E3A\u540C\u4E00\u987A\u5E8F\n        queue.offer(item);\n    }\n    \n    public String dequeue() {\n        // \u5355\u5BA2\u6237\u7AEF\u7A0B\u5E8F\u6B21\u5E8F\u4FDD\u7559\n        return queue.poll();\n    }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7279\u70B9"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u6240\u6709\u64CD\u4F5C\u53EF\u91CD\u6392\u4E3A\u540C\u4E00\u987A\u5E8F"}),"\n",(0,r.jsx)(e.li,{children:"\u5355\u5BA2\u6237\u7AEF\u7A0B\u5E8F\u6B21\u5E8F\u4FDD\u7559"}),"\n",(0,r.jsx)(e.li,{children:"\u6BD4\u7EBF\u6027\u4E00\u81F4\u6027\u5F31\uFF0C\u4F46\u5B9E\u73B0\u76F8\u5BF9\u7B80\u5355"}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"\u56E0\u679C\u4E00\u81F4\u6027causal-consistency",children:"\u56E0\u679C\u4E00\u81F4\u6027\uFF08Causal Consistency\uFF09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u56E0\u679C\u4E00\u81F4\u6027\u793A\u4F8B"',children:"public class CausallyConsistentChat {\n    private final Map<String, Message> messages = new ConcurrentHashMap<>();\n    private final VectorClock vectorClock = new VectorClock();\n    \n    public void sendMessage(String userId, String content) {\n        Message message = new Message(userId, content, vectorClock.increment(userId));\n        messages.put(message.getId(), message);\n    }\n    \n    public List<Message> getMessages() {\n        // \u56E0\u679C\u4E00\u81F4\u6027\uFF1A\u5C0A\u91CD\u56E0\u679C\u5148\u540E\u5173\u7CFB\n        return messages.values().stream()\n                      .sorted(Comparator.comparing(Message::getVectorClock))\n                      .collect(Collectors.toList());\n    }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7279\u70B9"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5C0A\u91CD\u56E0\u679C\u5148\u540E\u5173\u7CFB"}),"\n",(0,r.jsx)(e.li,{children:"\u4F7F\u7528\u5411\u91CF\u65F6\u949F\uFF08Vector Clock\uFF09\u8868\u8FBE\u56E0\u679C\u5173\u7CFB"}),"\n",(0,r.jsx)(e.li,{children:"\u9002\u5408\u5206\u5E03\u5F0F\u804A\u5929\u3001\u534F\u4F5C\u7F16\u8F91\u7B49\u573A\u666F"}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"\u4F1A\u8BDD\u4E00\u81F4\u6027session-consistency",children:"\u4F1A\u8BDD\u4E00\u81F4\u6027\uFF08Session Consistency\uFF09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u4F1A\u8BDD\u4E00\u81F4\u6027\u793A\u4F8B"',children:"public class SessionConsistentCache {\n    private final Map<String, Object> cache = new ConcurrentHashMap<>();\n    private final String sessionId;\n    \n    public SessionConsistentCache(String sessionId) {\n        this.sessionId = sessionId;\n    }\n    \n    public void put(String key, Object value) {\n        cache.put(key, value);\n        // \u540C\u4F1A\u8BDD\u5185\u7ACB\u5373\u53EF\u89C1\n    }\n    \n    public Object get(String key) {\n        // \u540C\u4F1A\u8BDD\u5185\u80FD\u8BFB\u5230\u81EA\u5DF1\u7684\u5199\n        return cache.get(key);\n    }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7279\u70B9"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u540C\u4F1A\u8BDD\u5185\u80FD\u8BFB\u5230\u81EA\u5DF1\u7684\u5199\u64CD\u4F5C"}),"\n",(0,r.jsx)(e.li,{children:"\u4E0D\u540C\u4F1A\u8BDD\u95F4\u53EF\u80FD\u770B\u5230\u4E0D\u540C\u72B6\u6001"}),"\n",(0,r.jsx)(e.li,{children:"\u5B9E\u73B0\u76F8\u5BF9\u7B80\u5355\uFF0C\u6027\u80FD\u8F83\u597D"}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"\u6700\u7EC8\u4E00\u81F4\u6027eventual-consistency",children:"\u6700\u7EC8\u4E00\u81F4\u6027\uFF08Eventual Consistency\uFF09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u6700\u7EC8\u4E00\u81F4\u6027\u793A\u4F8B"',children:"public class EventuallyConsistentDatabase {\n    private final Map<String, Replica> replicas = new HashMap<>();\n    \n    public void write(String key, String value) {\n        // \u5F02\u6B65\u590D\u5236\u5230\u6240\u6709\u526F\u672C\n        for (Replica replica : replicas.values()) {\n            CompletableFuture.runAsync(() -> {\n                replica.write(key, value);\n            });\n        }\n    }\n    \n    public String read(String key) {\n        // \u4ECE\u4EFB\u610F\u526F\u672C\u8BFB\u53D6\uFF0C\u53EF\u80FD\u8BFB\u5230\u65E7\u503C\n        Replica replica = selectReplica();\n        return replica.read(key);\n    }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7279\u70B9"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u7ECF\u8FC7\u4E00\u6BB5\u65F6\u95F4\u540E\uFF0C\u6240\u6709\u526F\u672C\u6700\u7EC8\u4F1A\u8FBE\u5230\u4E00\u81F4\u72B6\u6001"}),"\n",(0,r.jsx)(e.li,{children:"\u5B9E\u73B0\u7B80\u5355\uFF0C\u6027\u80FD\u6700\u597D"}),"\n",(0,r.jsx)(e.li,{children:"\u9002\u5408\u5BF9\u4E00\u81F4\u6027\u8981\u6C42\u4E0D\u9AD8\u7684\u573A\u666F"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"4-\u526F\u672Cquorum-\u4E0E\u51B2\u7A81\u89E3\u51B3",children:"4. \u526F\u672C\u3001Quorum \u4E0E\u51B2\u7A81\u89E3\u51B3"}),"\n",(0,r.jsx)(e.h3,{id:"41-\u526F\u672C\u673A\u5236",children:"4.1 \u526F\u672C\u673A\u5236"}),"\n",(0,r.jsx)(e.h4,{id:"\u526F\u672C\u7684\u4F5C\u7528",children:"\u526F\u672C\u7684\u4F5C\u7528"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph LR\n    A[\u6570\u636E] --\x3e B[\u526F\u672C1]\n    A --\x3e C[\u526F\u672C2]\n    A --\x3e D[\u526F\u672C3]\n    \n    B --\x3e E[\u63D0\u9AD8\u53EF\u7528\u6027]\n    C --\x3e F[\u63D0\u9AD8\u8BFB\u6027\u80FD]\n    D --\x3e G[\u6570\u636E\u5907\u4EFD]\n    \n    E --\x3e H[\u6545\u969C\u6062\u590D]\n    F --\x3e I[\u8D1F\u8F7D\u5206\u62C5]\n    G --\x3e J[\u6570\u636E\u4FDD\u62A4]"}),"\n",(0,r.jsx)(e.h4,{id:"\u526F\u672C\u4E00\u81F4\u6027\u7B56\u7565",children:"\u526F\u672C\u4E00\u81F4\u6027\u7B56\u7565"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u7B56\u7565"}),(0,r.jsx)(e.th,{children:"\u7279\u70B9"}),(0,r.jsx)(e.th,{children:"\u9002\u7528\u573A\u666F"}),(0,r.jsx)(e.th,{children:"\u793A\u4F8B"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u540C\u6B65\u590D\u5236"})}),(0,r.jsx)(e.td,{children:"\u5199\u64CD\u4F5C\u7B49\u5F85\u6240\u6709\u526F\u672C\u786E\u8BA4"}),(0,r.jsx)(e.td,{children:"\u5F3A\u4E00\u81F4\u6027\u8981\u6C42"}),(0,r.jsx)(e.td,{children:"\u91D1\u878D\u4EA4\u6613\u7CFB\u7EDF"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u5F02\u6B65\u590D\u5236"})}),(0,r.jsx)(e.td,{children:"\u5199\u64CD\u4F5C\u4E0D\u7B49\u5F85\u526F\u672C\u786E\u8BA4"}),(0,r.jsx)(e.td,{children:"\u9AD8\u6027\u80FD\u8981\u6C42"}),(0,r.jsx)(e.td,{children:"\u65E5\u5FD7\u7CFB\u7EDF"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u534A\u540C\u6B65\u590D\u5236"})}),(0,r.jsx)(e.td,{children:"\u7B49\u5F85\u90E8\u5206\u526F\u672C\u786E\u8BA4"}),(0,r.jsx)(e.td,{children:"\u5E73\u8861\u6027\u80FD\u548C\u4E00\u81F4\u6027"}),(0,r.jsx)(e.td,{children:"\u4E00\u822C\u4E1A\u52A1\u7CFB\u7EDF"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"42-quorum\u673A\u5236",children:"4.2 Quorum\u673A\u5236"}),"\n",(0,r.jsx)(e.h4,{id:"quorum\u8BFB\u5199\u89C4\u5219",children:"Quorum\u8BFB\u5199\u89C4\u5219"}),"\n",(0,r.jsx)(e.p,{children:"\u8BBE\u526F\u672C\u6570\u4E3AN\uFF0C\u8BFB\u64CD\u4F5C\u4E3AR\uFF0C\u5199\u64CD\u4F5C\u4E3AW\uFF0C\u5219\uFF1A"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5F3A\u4E00\u81F4\u6027\u6761\u4EF6"}),"\uFF1AR + W > N"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u53EF\u7528\u6027\u4F18\u5148"}),"\uFF1AR + W \u2264 N"]}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"quorum\u914D\u7F6E\u793A\u4F8B",children:"Quorum\u914D\u7F6E\u793A\u4F8B"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="Quorum\u8BFB\u5199\u5B9E\u73B0"',children:'public class QuorumDatabase {\n    private final List<Replica> replicas;\n    private final int readQuorum;\n    private final int writeQuorum;\n    \n    public QuorumDatabase(List<Replica> replicas, int readQuorum, int writeQuorum) {\n        this.replicas = replicas;\n        this.readQuorum = readQuorum;\n        this.writeQuorum = writeQuorum;\n    }\n    \n    public String read(String key) {\n        // \u4ECE\u591A\u4E2A\u526F\u672C\u8BFB\u53D6\uFF0C\u53D6\u6700\u65B0\u503C\n        List<String> values = new ArrayList<>();\n        for (Replica replica : replicas) {\n            try {\n                String value = replica.read(key);\n                values.add(value);\n                if (values.size() >= readQuorum) {\n                    break;\n                }\n            } catch (Exception e) {\n                // \u526F\u672C\u4E0D\u53EF\u7528\uFF0C\u7EE7\u7EED\u5C1D\u8BD5\n            }\n        }\n        \n        // \u8FD4\u56DE\u6700\u65B0\u503C\uFF08\u9700\u8981\u7248\u672C\u53F7\u6216\u65F6\u95F4\u6233\uFF09\n        return selectLatestValue(values);\n    }\n    \n    public void write(String key, String value) {\n        // \u5199\u5165\u591A\u4E2A\u526F\u672C\uFF0C\u786E\u4FDD\u5199\u5165\u6210\u529F\n        int successCount = 0;\n        for (Replica replica : replicas) {\n            try {\n                replica.write(key, value);\n                successCount++;\n                if (successCount >= writeQuorum) {\n                    return; // \u5199\u5165\u6210\u529F\n                }\n            } catch (Exception e) {\n                // \u526F\u672C\u5199\u5165\u5931\u8D25\uFF0C\u7EE7\u7EED\u5C1D\u8BD5\n            }\n        }\n        \n        throw new RuntimeException("Write failed: insufficient replicas");\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h4,{id:"\u4E0D\u540Cquorum\u914D\u7F6E\u7684\u5F71\u54CD",children:"\u4E0D\u540CQuorum\u914D\u7F6E\u7684\u5F71\u54CD"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"\u793A\u4F8B\uFF08N=3\uFF09\uFF1A\n- \u5F3A\u8BFB\u914D\u7F6E\uFF1AW=2, R=2 \u21D2 R+W=4>3\uFF0C\u8BFB\u5FC5\u8986\u76D6\u5199\n- \u504F\u53EF\u7528\u914D\u7F6E\uFF1AW=1, R=1 \u21D2 R+W=2\u22643\uFF0C\u5199\u5FEB\u4F46\u8BFB\u53EF\u80FD\u662F\u65E7\u503C\n- \u5E73\u8861\u914D\u7F6E\uFF1AW=2, R=1 \u21D2 R+W=3\u22643\uFF0C\u5199\u5B89\u5168\u4F46\u8BFB\u53EF\u80FD\u4E0D\u4E00\u81F4\n"})}),"\n",(0,r.jsx)(e.h3,{id:"43-\u51B2\u7A81\u89E3\u51B3\u7B56\u7565",children:"4.3 \u51B2\u7A81\u89E3\u51B3\u7B56\u7565"}),"\n",(0,r.jsx)(e.h4,{id:"last-write-wins\u6700\u540E\u5199\u5165\u83B7\u80DC",children:"Last-Write-Wins\uFF08\u6700\u540E\u5199\u5165\u83B7\u80DC\uFF09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="Last-Write-Wins\u5B9E\u73B0"',children:"public class LastWriteWinsResolver {\n    public Data resolveConflict(List<Data> versions) {\n        // \u57FA\u4E8E\u65F6\u95F4\u6233\u9009\u62E9\u6700\u65B0\u7248\u672C\n        return versions.stream()\n                      .max(Comparator.comparing(Data::getTimestamp))\n                      .orElse(null);\n    }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7279\u70B9"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5B9E\u73B0\u7B80\u5355\uFF0C\u6027\u80FD\u597D"}),"\n",(0,r.jsx)(e.li,{children:"\u9700\u8981\u5355\u8C03\u65F6\u949F"}),"\n",(0,r.jsx)(e.li,{children:"\u53EF\u80FD\u4E22\u5931\u6570\u636E"}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"\u5411\u91CF\u65F6\u949Fvector-clock",children:"\u5411\u91CF\u65F6\u949F\uFF08Vector Clock\uFF09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u5411\u91CF\u65F6\u949F\u5B9E\u73B0"',children:"public class VectorClock {\n    private final Map<String, Long> clock = new ConcurrentHashMap<>();\n    \n    public void increment(String nodeId) {\n        clock.merge(nodeId, 1L, Long::sum);\n    }\n    \n    public boolean isConcurrent(VectorClock other) {\n        // \u68C0\u67E5\u4E24\u4E2A\u65F6\u949F\u662F\u5426\u5E76\u53D1\n        boolean thisGreater = false;\n        boolean otherGreater = false;\n        \n        Set<String> allNodes = new HashSet<>(clock.keySet());\n        allNodes.addAll(other.clock.keySet());\n        \n        for (String node : allNodes) {\n            long thisValue = clock.getOrDefault(node, 0L);\n            long otherValue = other.clock.getOrDefault(node, 0L);\n            \n            if (thisValue > otherValue) {\n                thisGreater = true;\n            } else if (otherValue > thisValue) {\n                otherGreater = true;\n            }\n        }\n        \n        return thisGreater && otherGreater;\n    }\n    \n    public boolean isCausallyBefore(VectorClock other) {\n        // \u68C0\u67E5\u662F\u5426\u56E0\u679C\u5148\u4E8E\n        for (Map.Entry<String, Long> entry : clock.entrySet()) {\n            String node = entry.getKey();\n            long thisValue = entry.getValue();\n            long otherValue = other.clock.getOrDefault(node, 0L);\n            \n            if (thisValue > otherValue) {\n                return false;\n            }\n        }\n        return true;\n    }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7279\u70B9"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u4FDD\u7559\u5E76\u53D1\u5199\u5143\u4FE1\u606F"}),"\n",(0,r.jsx)(e.li,{children:"\u80FD\u68C0\u6D4B\u56E0\u679C\u5173\u7CFB"}),"\n",(0,r.jsx)(e.li,{children:"\u5B9E\u73B0\u590D\u6742\uFF0C\u5B58\u50A8\u5F00\u9500\u5927"}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"crdt\u65E0\u51B2\u7A81\u53EF\u590D\u5236\u6570\u636E\u7C7B\u578B",children:"CRDT\uFF08\u65E0\u51B2\u7A81\u53EF\u590D\u5236\u6570\u636E\u7C7B\u578B\uFF09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="CRDT\u793A\u4F8B - \u8BA1\u6570\u5668"',children:"public class GCounter {\n    private final Map<String, Long> counters = new ConcurrentHashMap<>();\n    \n    public void increment(String nodeId) {\n        counters.merge(nodeId, 1L, Long::sum);\n    }\n    \n    public long getValue() {\n        return counters.values().stream().mapToLong(Long::longValue).sum();\n    }\n    \n    public void merge(GCounter other) {\n        // \u5408\u5E76\u4E24\u4E2A\u8BA1\u6570\u5668\n        for (Map.Entry<String, Long> entry : other.counters.entrySet()) {\n            String nodeId = entry.getKey();\n            long value = entry.getValue();\n            counters.merge(nodeId, value, Math::max);\n        }\n    }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7279\u70B9"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5929\u7136\u6536\u655B\uFF0C\u65E0\u9700\u51B2\u7A81\u89E3\u51B3"}),"\n",(0,r.jsx)(e.li,{children:"\u652F\u6301\u5E76\u53D1\u4FEE\u6539"}),"\n",(0,r.jsx)(e.li,{children:"\u7C7B\u578B\u7279\u5B9A\uFF0C\u901A\u7528\u6027\u6709\u9650"}),"\n"]}),"\n",(0,r.jsx)(e.admonition,{title:"\u51B2\u7A81\u89E3\u51B3\u9009\u62E9",type:"tip",children:(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7B80\u5355\u573A\u666F"}),"\uFF1A\u4F7F\u7528Last-Write-Wins"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u9700\u8981\u4FDD\u7559\u4FE1\u606F"}),"\uFF1A\u4F7F\u7528\u5411\u91CF\u65F6\u949F"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7279\u5B9A\u6570\u636E\u7C7B\u578B"}),"\uFF1A\u4F7F\u7528CRDT"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u590D\u6742\u4E1A\u52A1\u903B\u8F91"}),"\uFF1A\u81EA\u5B9A\u4E49\u51B2\u7A81\u89E3\u51B3\u7B56\u7565"]}),"\n"]})}),"\n",(0,r.jsx)(e.h2,{id:"5-\u5171\u8BC6\u7B97\u6CD5paxos--raft--zab",children:"5. \u5171\u8BC6\u7B97\u6CD5\uFF08Paxos / Raft / ZAB\uFF09"}),"\n",(0,r.jsx)(e.h3,{id:"51-\u5171\u8BC6\u7B97\u6CD5\u6982\u8FF0",children:"5.1 \u5171\u8BC6\u7B97\u6CD5\u6982\u8FF0"}),"\n",(0,r.jsx)(e.p,{children:"\u5171\u8BC6\u7B97\u6CD5\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u5B9E\u73B0\u5F3A\u4E00\u81F4\u6027\u7684\u6838\u5FC3\u673A\u5236\uFF0C\u786E\u4FDD\u591A\u4E2A\u8282\u70B9\u5728\u5B58\u5728\u6545\u969C\u7684\u60C5\u51B5\u4E0B\u80FD\u591F\u5C31\u67D0\u4E2A\u503C\u8FBE\u6210\u4E00\u81F4\u3002"}),"\n",(0,r.jsx)(e.h4,{id:"\u5171\u8BC6\u7B97\u6CD5\u7684\u8981\u6C42",children:"\u5171\u8BC6\u7B97\u6CD5\u7684\u8981\u6C42"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph TD\n    A[\u5171\u8BC6\u7B97\u6CD5\u8981\u6C42] --\x3e B[\u5B89\u5168\u6027]\n    A --\x3e C[\u6D3B\u6027]\n    A --\x3e D[\u5BB9\u9519\u6027]\n    \n    B --\x3e B1[\u53EA\u6709\u63D0\u8BAE\u7684\u503C\u624D\u80FD\u88AB\u9009\u62E9]\n    B --\x3e B2[\u4E00\u65E6\u503C\u88AB\u9009\u62E9\uFF0C\u5C31\u4E0D\u80FD\u6539\u53D8]\n    \n    C --\x3e C1[\u6700\u7EC8\u4F1A\u9009\u62E9\u4E00\u4E2A\u503C]\n    C --\x3e C2[\u4E0D\u4F1A\u65E0\u9650\u671F\u963B\u585E]\n    \n    D --\x3e D1[\u5BB9\u5FCD\u90E8\u5206\u8282\u70B9\u6545\u969C]\n    D --\x3e D2[\u7F51\u7EDC\u5206\u533A\u65F6\u4ECD\u80FD\u5DE5\u4F5C]"}),"\n",(0,r.jsx)(e.h3,{id:"52-paxos\u7B97\u6CD5",children:"5.2 Paxos\u7B97\u6CD5"}),"\n",(0,r.jsx)(e.h4,{id:"paxos\u89D2\u8272\u5B9A\u4E49",children:"Paxos\u89D2\u8272\u5B9A\u4E49"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="Paxos\u89D2\u8272"',children:"public enum PaxosRole {\n    PROPOSER,  // \u63D0\u8BAE\u8005\uFF1A\u53D1\u8D77\u63D0\u8BAE\n    ACCEPTOR,  // \u63A5\u53D7\u8005\uFF1A\u63A5\u53D7\u6216\u62D2\u7EDD\u63D0\u8BAE\n    LEARNER    // \u5B66\u4E60\u8005\uFF1A\u5B66\u4E60\u6700\u7EC8\u9009\u62E9\u7684\u503C\n}\n"})}),"\n",(0,r.jsx)(e.h4,{id:"paxos\u7B97\u6CD5\u6D41\u7A0B",children:"Paxos\u7B97\u6CD5\u6D41\u7A0B"}),"\n",(0,r.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant P as Proposer\n    participant A1 as Acceptor 1\n    participant A2 as Acceptor 2\n    participant A3 as Acceptor 3\n    participant L as Learner\n    \n    P->>A1: Phase 1a: Prepare(n)\n    P->>A2: Phase 1a: Prepare(n)\n    P->>A3: Phase 1a: Prepare(n)\n    \n    A1->>P: Phase 1b: Promise(n, v)\n    A2->>P: Phase 1b: Promise(n, v)\n    A3->>P: Phase 1b: Promise(n, v)\n    \n    P->>A1: Phase 2a: Accept(n, v)\n    P->>A2: Phase 2a: Accept(n, v)\n    P->>A3: Phase 2a: Accept(n, v)\n    \n    A1->>P: Phase 2b: Accepted(n, v)\n    A2->>P: Phase 2b: Accepted(n, v)\n    A3->>P: Phase 2b: Accepted(n, v)\n    \n    P->>L: Learn(v)"}),"\n",(0,r.jsx)(e.h4,{id:"paxos\u5B9E\u73B0\u793A\u4F8B",children:"Paxos\u5B9E\u73B0\u793A\u4F8B"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="Paxos\u7B80\u5316\u5B9E\u73B0"',children:"public class PaxosNode {\n    private final String nodeId;\n    private final List<String> acceptors;\n    private long proposalNumber = 0;\n    private Object acceptedValue = null;\n    \n    public PaxosNode(String nodeId, List<String> acceptors) {\n        this.nodeId = nodeId;\n        this.acceptors = acceptors;\n    }\n    \n    public Object propose(Object value) {\n        long n = generateProposalNumber();\n        \n        // Phase 1: Prepare\n        List<Promise> promises = prepare(n);\n        if (promises.size() < majority()) {\n            return null; // \u51C6\u5907\u5931\u8D25\n        }\n        \n        // \u9009\u62E9\u63D0\u8BAE\u503C\n        Object proposedValue = selectProposedValue(promises, value);\n        \n        // Phase 2: Accept\n        int acceptedCount = accept(n, proposedValue);\n        if (acceptedCount >= majority()) {\n            // \u5B66\u4E60\u9636\u6BB5\n            learn(proposedValue);\n            return proposedValue;\n        }\n        \n        return null; // \u63A5\u53D7\u5931\u8D25\n    }\n    \n    private List<Promise> prepare(long n) {\n        List<Promise> promises = new ArrayList<>();\n        for (String acceptor : acceptors) {\n            try {\n                Promise promise = sendPrepare(acceptor, n);\n                promises.add(promise);\n            } catch (Exception e) {\n                // \u5FFD\u7565\u5931\u8D25\u7684acceptor\n            }\n        }\n        return promises;\n    }\n    \n    private int accept(long n, Object value) {\n        int acceptedCount = 0;\n        for (String acceptor : acceptors) {\n            try {\n                boolean accepted = sendAccept(acceptor, n, value);\n                if (accepted) {\n                    acceptedCount++;\n                }\n            } catch (Exception e) {\n                // \u5FFD\u7565\u5931\u8D25\u7684acceptor\n            }\n        }\n        return acceptedCount;\n    }\n    \n    private int majority() {\n        return acceptors.size() / 2 + 1;\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"53-raft\u7B97\u6CD5",children:"5.3 Raft\u7B97\u6CD5"}),"\n",(0,r.jsx)(e.h4,{id:"raft\u7B97\u6CD5\u67B6\u6784",children:"Raft\u7B97\u6CD5\u67B6\u6784"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph TD\n    A[Raft\u96C6\u7FA4] --\x3e B[Leader]\n    A --\x3e C[Follower 1]\n    A --\x3e D[Follower 2]\n    A --\x3e E[Follower 3]\n    \n    B --\x3e F[\u5904\u7406\u5BA2\u6237\u7AEF\u8BF7\u6C42]\n    B --\x3e G[\u65E5\u5FD7\u590D\u5236]\n    B --\x3e H[\u5FC3\u8DF3\u7EF4\u62A4]\n    \n    C --\x3e I[\u63A5\u6536\u65E5\u5FD7]\n    D --\x3e I\n    E --\x3e I"}),"\n",(0,r.jsx)(e.h4,{id:"raft\u7B97\u6CD5\u72B6\u6001\u8F6C\u6362",children:"Raft\u7B97\u6CD5\u72B6\u6001\u8F6C\u6362"}),"\n",(0,r.jsx)(e.mermaid,{value:"stateDiagram-v2\n    [*] --\x3e Follower\n    Follower --\x3e Candidate : \u8D85\u65F6\n    Candidate --\x3e Leader : \u83B7\u5F97\u591A\u6570\u7968\n    Candidate --\x3e Follower : \u53D1\u73B0\u66F4\u9AD8\u4EFB\u671F\n    Leader --\x3e Follower : \u53D1\u73B0\u66F4\u9AD8\u4EFB\u671F\n    Leader --\x3e Follower : \u5931\u53BB\u8FDE\u63A5"}),"\n",(0,r.jsx)(e.h4,{id:"raft\u6838\u5FC3\u673A\u5236",children:"Raft\u6838\u5FC3\u673A\u5236"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Leader\u9009\u4E3E"}),"\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="Raft Leader\u9009\u4E3E"',children:"public class RaftNode {\n    private RaftState state = RaftState.FOLLOWER;\n    private long currentTerm = 0;\n    private String votedFor = null;\n    private long lastHeartbeat = 0;\n    private final Random random = new Random();\n    \n    public void startElection() {\n        state = RaftState.CANDIDATE;\n        currentTerm++;\n        votedFor = nodeId;\n        \n        // \u53D1\u9001\u6295\u7968\u8BF7\u6C42\n        int votes = 1; // \u81EA\u5DF1\u7684\u4E00\u7968\n        for (String peer : peers) {\n            try {\n                boolean voteGranted = requestVote(peer, currentTerm, nodeId);\n                if (voteGranted) {\n                    votes++;\n                }\n            } catch (Exception e) {\n                // \u5FFD\u7565\u5931\u8D25\u7684\u8BF7\u6C42\n            }\n        }\n        \n        if (votes > majority()) {\n            becomeLeader();\n        }\n    }\n    \n    public void becomeLeader() {\n        state = RaftState.LEADER;\n        // \u521D\u59CB\u5316leader\u72B6\u6001\n        nextIndex.clear();\n        matchIndex.clear();\n        for (String peer : peers) {\n            nextIndex.put(peer, log.getLastIndex() + 1);\n            matchIndex.put(peer, 0L);\n        }\n        \n        // \u5F00\u59CB\u53D1\u9001\u5FC3\u8DF3\n        startHeartbeat();\n    }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u65E5\u5FD7\u590D\u5236"}),"\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="Raft\u65E5\u5FD7\u590D\u5236"',children:"public class RaftLog {\n    private final List<LogEntry> entries = new ArrayList<>();\n    private long commitIndex = 0;\n    \n    public void appendEntry(LogEntry entry) {\n        entry.setTerm(currentTerm);\n        entry.setIndex(entries.size());\n        entries.add(entry);\n        \n        // \u590D\u5236\u5230\u5176\u4ED6\u8282\u70B9\n        replicateLog();\n    }\n    \n    private void replicateLog() {\n        for (String peer : peers) {\n            long nextIdx = nextIndex.get(peer);\n            List<LogEntry> entriesToSend = getEntriesFrom(nextIdx);\n            \n            try {\n                boolean success = sendAppendEntries(peer, currentTerm, nextIdx, entriesToSend);\n                if (success) {\n                    nextIndex.put(peer, nextIdx + entriesToSend.size());\n                    matchIndex.put(peer, nextIdx + entriesToSend.size() - 1);\n                } else {\n                    nextIndex.put(peer, Math.max(1, nextIdx - 1));\n                }\n            } catch (Exception e) {\n                // \u5904\u7406\u7F51\u7EDC\u9519\u8BEF\n            }\n        }\n        \n        // \u5C1D\u8BD5\u63D0\u4EA4\u65E5\u5FD7\n        tryCommit();\n    }\n    \n    private void tryCommit() {\n        for (long i = commitIndex + 1; i <= entries.size(); i++) {\n            int replicatedCount = 1; // \u81EA\u5DF1\n            for (String peer : peers) {\n                if (matchIndex.get(peer) >= i) {\n                    replicatedCount++;\n                }\n            }\n            \n            if (replicatedCount > majority() && entries.get((int)i-1).getTerm() == currentTerm) {\n                commitIndex = i;\n            }\n        }\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"54-zab\u7B97\u6CD5",children:"5.4 ZAB\u7B97\u6CD5"}),"\n",(0,r.jsx)(e.h4,{id:"zab\u7B97\u6CD5\u7279\u70B9",children:"ZAB\u7B97\u6CD5\u7279\u70B9"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"ZooKeeper\u7684\u539F\u5B50\u5E7F\u64AD\u534F\u8BAE"}),"\n",(0,r.jsx)(e.li,{children:"\u5D29\u6E83\u6062\u590D + \u987A\u5E8F\u4FDD\u8BC1"}),"\n",(0,r.jsx)(e.li,{children:"\u57FA\u4E8E\u4E3B\u4ECE\u67B6\u6784"}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"zab\u7B97\u6CD5\u6D41\u7A0B",children:"ZAB\u7B97\u6CD5\u6D41\u7A0B"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph LR\n    A[\u5BA2\u6237\u7AEF\u8BF7\u6C42] --\x3e B[Leader]\n    B --\x3e C[\u539F\u5B50\u5E7F\u64AD]\n    C --\x3e D[Follower 1]\n    C --\x3e E[Follower 2]\n    C --\x3e F[Follower 3]\n    \n    B --\x3e G[\u5D29\u6E83\u6062\u590D]\n    G --\x3e H[Leader\u9009\u4E3E]\n    G --\x3e I[\u6570\u636E\u540C\u6B65]"}),"\n",(0,r.jsx)(e.h2,{id:"6-\u65F6\u95F4\u4E0E-id\u5355\u8C03\u6027\u4E0E\u552F\u4E00\u6027",children:"6. \u65F6\u95F4\u4E0E ID\uFF1A\u5355\u8C03\u6027\u4E0E\u552F\u4E00\u6027"}),"\n",(0,r.jsx)(e.h3,{id:"61-\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u65F6\u95F4\u95EE\u9898",children:"6.1 \u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u65F6\u95F4\u95EE\u9898"}),"\n",(0,r.jsx)(e.h4,{id:"\u7269\u7406\u65F6\u949F-vs-\u903B\u8F91\u65F6\u949F",children:"\u7269\u7406\u65F6\u949F vs \u903B\u8F91\u65F6\u949F"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph TD\n    A[\u65F6\u95F4\u6982\u5FF5] --\x3e B[\u7269\u7406\u65F6\u949F]\n    A --\x3e C[\u903B\u8F91\u65F6\u949F]\n    \n    B --\x3e D[\u771F\u5B9E\u65F6\u95F4]\n    B --\x3e E[\u65F6\u949F\u6F02\u79FB]\n    B --\x3e F[\u65F6\u949F\u56DE\u62E8]\n    \n    C --\x3e G[Lamport\u65F6\u949F]\n    C --\x3e H[\u5411\u91CF\u65F6\u949F]\n    C --\x3e I[\u903B\u8F91\u65F6\u95F4\u6233]"}),"\n",(0,r.jsx)(e.h4,{id:"lamport\u65F6\u949F",children:"Lamport\u65F6\u949F"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="Lamport\u65F6\u949F\u5B9E\u73B0"',children:"public class LamportClock {\n    private long timestamp = 0;\n    private final String nodeId;\n    \n    public LamportClock(String nodeId) {\n        this.nodeId = nodeId;\n    }\n    \n    public long tick() {\n        return ++timestamp;\n    }\n    \n    public long send() {\n        return tick();\n    }\n    \n    public void receive(long receivedTimestamp) {\n        timestamp = Math.max(timestamp, receivedTimestamp) + 1;\n    }\n    \n    public long getTimestamp() {\n        return timestamp;\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"62-\u5168\u5C40\u552F\u4E00id\u751F\u6210",children:"6.2 \u5168\u5C40\u552F\u4E00ID\u751F\u6210"}),"\n",(0,r.jsx)(e.h4,{id:"id\u751F\u6210\u7B56\u7565\u5BF9\u6BD4",children:"ID\u751F\u6210\u7B56\u7565\u5BF9\u6BD4"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u7B56\u7565"}),(0,r.jsx)(e.th,{children:"\u4F18\u70B9"}),(0,r.jsx)(e.th,{children:"\u7F3A\u70B9"}),(0,r.jsx)(e.th,{children:"\u9002\u7528\u573A\u666F"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u6570\u636E\u5E93\u81EA\u589E"})}),(0,r.jsx)(e.td,{children:"\u7B80\u5355\u3001\u6709\u5E8F"}),(0,r.jsx)(e.td,{children:"\u5355\u70B9\u6545\u969C\u3001\u6027\u80FD\u74F6\u9888"}),(0,r.jsx)(e.td,{children:"\u5C0F\u89C4\u6A21\u7CFB\u7EDF"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u53F7\u6BB5\u7F13\u5B58"})}),(0,r.jsx)(e.td,{children:"\u6027\u80FD\u597D\u3001\u6709\u5E8F"}),(0,r.jsx)(e.td,{children:"\u6D6A\u8D39\u53F7\u6BB5\u3001\u5355\u70B9\u6545\u969C"}),(0,r.jsx)(e.td,{children:"\u4E2D\u7B49\u89C4\u6A21\u7CFB\u7EDF"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"UUID"})}),(0,r.jsx)(e.td,{children:"\u53BB\u4E2D\u5FC3\u5316\u3001\u65E0\u51B2\u7A81"}),(0,r.jsx)(e.td,{children:"\u65E0\u5E8F\u3001\u5B58\u50A8\u7A7A\u95F4\u5927"}),(0,r.jsx)(e.td,{children:"\u5206\u5E03\u5F0F\u7CFB\u7EDF"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Snowflake"})}),(0,r.jsx)(e.td,{children:"\u6709\u5E8F\u3001\u9AD8\u6027\u80FD\u3001\u53BB\u4E2D\u5FC3\u5316"}),(0,r.jsx)(e.td,{children:"\u65F6\u949F\u4F9D\u8D56\u3001\u5B9E\u73B0\u590D\u6742"}),(0,r.jsx)(e.td,{children:"\u5927\u89C4\u6A21\u5206\u5E03\u5F0F\u7CFB\u7EDF"})]})]})]}),"\n",(0,r.jsx)(e.h4,{id:"snowflake\u7B97\u6CD5\u5B9E\u73B0",children:"Snowflake\u7B97\u6CD5\u5B9E\u73B0"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="Snowflake ID\u751F\u6210\u5668"',children:'public final class SnowflakeIdGenerator {\n    // \u8D77\u59CB\u7EAA\u5143\uFF08\u53EF\u81EA\u5B9A\u4E49\uFF09\uFF0C31\u4F4D\u5DEE\u4E0D\u591A\u53EF\u8986\u76D6\u591A\u5E74\n    private static final long EPOCH = 1577836800000L; // 2020-01-01\n    // \u673A\u623FID\u4E0E\u673A\u5668ID\u4F4D\u5BBD\uFF08\u793A\u4F8B\uFF1A5+5\uFF09\uFF0C\u5E8F\u521712\u4F4D\n    private static final int DATACENTER_BITS = 5;\n    private static final int WORKER_BITS = 5;\n    private static final int SEQUENCE_BITS = 12;\n\n    private static final long MAX_DATACENTER = (1L << DATACENTER_BITS) - 1;\n    private static final long MAX_WORKER = (1L << WORKER_BITS) - 1;\n    private static final long MAX_SEQUENCE = (1L << SEQUENCE_BITS) - 1;\n\n    private static final int WORKER_SHIFT = SEQUENCE_BITS;\n    private static final int DATACENTER_SHIFT = SEQUENCE_BITS + WORKER_BITS;\n    private static final int TIMESTAMP_SHIFT = SEQUENCE_BITS + WORKER_BITS + DATACENTER_BITS;\n\n    private final long datacenterId; // \u673A\u623FID\n    private final long workerId;     // \u673A\u5668ID\n\n    private long lastTimestamp = -1L; // \u4E0A\u6B21\u751F\u6210ID\u7684\u65F6\u95F4\u6233\n    private long sequence = 0L;       // \u5F53\u524D\u6BEB\u79D2\u5185\u7684\u5E8F\u5217\n\n    public SnowflakeIdGenerator(long datacenterId, long workerId) {\n        if (datacenterId < 0 || datacenterId > MAX_DATACENTER) {\n            throw new IllegalArgumentException("bad datacenterId");\n        }\n        if (workerId < 0 || workerId > MAX_WORKER) {\n            throw new IllegalArgumentException("bad workerId");\n        }\n        this.datacenterId = datacenterId;\n        this.workerId = workerId;\n    }\n\n    // \u7EBF\u7A0B\u5B89\u5168\uFF1A\u65B9\u6CD5\u7EA7\u540C\u6B65\uFF0C\u6216\u4F7F\u7528CAS\u4E0E\u81EA\u65CB\u4FDD\u8BC1\u5E76\u53D1\u4E0B\u6B63\u786E\u6027\n    public synchronized long nextId() {\n        long now = System.currentTimeMillis();\n        if (now < lastTimestamp) {\n            // \u65F6\u949F\u56DE\u62E8\uFF1A\u53EF\u963B\u585E\u7B49\u5F85\u3001\u629B\u9519\u6216\u4F7F\u7528\u56DE\u62E8\u7A97\u53E3\u5E8F\u5217\n            long offset = lastTimestamp - now;\n            if (offset > 5) { // \u8D85\u8FC7\u5BB9\u5FCD\u7A97\u53E3\n                throw new IllegalStateException("clock moved backwards: " + offset + "ms");\n            }\n            // \u9000\u907F\u7B49\u5F85\u5230 lastTimestamp\n            try { Thread.sleep(offset); } catch (InterruptedException ignored) {}\n            now = System.currentTimeMillis();\n        }\n        if (now == lastTimestamp) {\n            // \u540C\u4E00\u6BEB\u79D2\u5185\u81EA\u589E\u5E8F\u5217\n            sequence = (sequence + 1) & MAX_SEQUENCE;\n            if (sequence == 0) {\n                // \u5E8F\u5217\u6EA2\u51FA\uFF0C\u81EA\u65CB\u5230\u4E0B\u4E00\u6BEB\u79D2\n                do { now = System.currentTimeMillis(); } while (now <= lastTimestamp);\n            }\n        } else {\n            // \u65B0\u6BEB\u79D2\u91CD\u7F6E\u5E8F\u5217\n            sequence = 0L;\n        }\n        lastTimestamp = now;\n        // \u7EC4\u88C5ID\uFF1A\u65F6\u95F4\u6233\u9AD8\u4F4D + \u673A\u623F + \u673A\u5668 + \u5E8F\u5217\n        return ((now - EPOCH) << TIMESTAMP_SHIFT)\n                | (datacenterId << DATACENTER_SHIFT)\n                | (workerId << WORKER_SHIFT)\n                | sequence;\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h4,{id:"\u53F7\u6BB5\u7F13\u5B58\u7B56\u7565",children:"\u53F7\u6BB5\u7F13\u5B58\u7B56\u7565"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u53F7\u6BB5\u7F13\u5B58\u5B9E\u73B0"',children:'public class SegmentIdGenerator {\n    private final DataSource dataSource;\n    private final String bizType;\n    private final int step = 1000; // \u6BCF\u6B21\u83B7\u53D6\u7684\u53F7\u6BB5\u5927\u5C0F\n    \n    private long currentId = 0;\n    private long maxId = 0;\n    \n    public SegmentIdGenerator(DataSource dataSource, String bizType) {\n        this.dataSource = dataSource;\n        this.bizType = bizType;\n        loadSegment();\n    }\n    \n    public synchronized long nextId() {\n        if (currentId >= maxId) {\n            loadSegment();\n        }\n        return currentId++;\n    }\n    \n    private void loadSegment() {\n        try (Connection conn = dataSource.getConnection()) {\n            conn.setAutoCommit(false);\n            \n            // \u66F4\u65B0\u53F7\u6BB5\n            String updateSql = "UPDATE id_segments SET current_id = current_id + ? WHERE biz_type = ?";\n            try (PreparedStatement stmt = conn.prepareStatement(updateSql)) {\n                stmt.setInt(1, step);\n                stmt.setString(2, bizType);\n                stmt.executeUpdate();\n            }\n            \n            // \u83B7\u53D6\u5F53\u524D\u53F7\u6BB5\n            String selectSql = "SELECT current_id FROM id_segments WHERE biz_type = ?";\n            try (PreparedStatement stmt = conn.prepareStatement(selectSql)) {\n                stmt.setString(1, bizType);\n                ResultSet rs = stmt.executeQuery();\n                if (rs.next()) {\n                    currentId = rs.getLong("current_id") - step + 1;\n                    maxId = rs.getLong("current_id");\n                }\n            }\n            \n            conn.commit();\n        } catch (SQLException e) {\n            throw new RuntimeException("Failed to load segment", e);\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"7-\u53EF\u9760\u901A\u4FE1\u4E0E\u91CD\u8BD5\u4EA4\u4ED8\u8BED\u4E49",children:"7. \u53EF\u9760\u901A\u4FE1\u4E0E\u91CD\u8BD5\uFF08\u4EA4\u4ED8\u8BED\u4E49\uFF09"}),"\n",(0,r.jsx)(e.h3,{id:"71-\u6D88\u606F\u4EA4\u4ED8\u8BED\u4E49",children:"7.1 \u6D88\u606F\u4EA4\u4ED8\u8BED\u4E49"}),"\n",(0,r.jsx)(e.h4,{id:"\u4E09\u79CD\u4EA4\u4ED8\u8BED\u4E49",children:"\u4E09\u79CD\u4EA4\u4ED8\u8BED\u4E49"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph TD\n    A[\u6D88\u606F\u4EA4\u4ED8\u8BED\u4E49] --\x3e B[\u81F3\u5C11\u4E00\u6B21]\n    A --\x3e C[\u81F3\u591A\u4E00\u6B21]\n    A --\x3e D[\u6070\u597D\u4E00\u6B21]\n    \n    B --\x3e E[\u53EF\u80FD\u91CD\u590D]\n    B --\x3e F[\u4E0D\u4F1A\u4E22\u5931]\n    \n    C --\x3e G[\u53EF\u80FD\u4E22\u5931]\n    C --\x3e H[\u4E0D\u4F1A\u91CD\u590D]\n    \n    D --\x3e I[\u4E0D\u4E22\u5931]\n    D --\x3e J[\u4E0D\u91CD\u590D]"}),"\n",(0,r.jsx)(e.h4,{id:"\u81F3\u5C11\u4E00\u6B21\u4EA4\u4ED8at-least-once",children:"\u81F3\u5C11\u4E00\u6B21\u4EA4\u4ED8\uFF08At-least-once\uFF09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u81F3\u5C11\u4E00\u6B21\u4EA4\u4ED8\u5B9E\u73B0"',children:'public class AtLeastOnceSender {\n    private final MessageQueue queue;\n    private final int maxRetries;\n    \n    public void send(String message) {\n        int retries = 0;\n        while (retries < maxRetries) {\n            try {\n                queue.send(message);\n                return; // \u53D1\u9001\u6210\u529F\n            } catch (Exception e) {\n                retries++;\n                if (retries >= maxRetries) {\n                    throw new RuntimeException("Failed to send message after " + maxRetries + " retries", e);\n                }\n                // \u6307\u6570\u9000\u907F\n                try {\n                    Thread.sleep((long) Math.pow(2, retries) * 1000);\n                } catch (InterruptedException ie) {\n                    Thread.currentThread().interrupt();\n                    break;\n                }\n            }\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h4,{id:"\u6070\u597D\u4E00\u6B21\u4EA4\u4ED8exactly-once",children:"\u6070\u597D\u4E00\u6B21\u4EA4\u4ED8\uFF08Exactly-once\uFF09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u6070\u597D\u4E00\u6B21\u4EA4\u4ED8\u5B9E\u73B0"',children:"public class ExactlyOnceSender {\n    private final MessageQueue queue;\n    private final Set<String> processedIds = new ConcurrentHashSet<>();\n    \n    public void send(String messageId, String message) {\n        // \u68C0\u67E5\u662F\u5426\u5DF2\u5904\u7406\n        if (processedIds.contains(messageId)) {\n            return; // \u5E42\u7B49\u5904\u7406\n        }\n        \n        try {\n            queue.send(message);\n            processedIds.add(messageId);\n        } catch (Exception e) {\n            // \u53D1\u9001\u5931\u8D25\uFF0C\u4E0D\u8BB0\u5F55ID\n            throw e;\n        }\n    }\n    \n    // \u5B9A\u671F\u6E05\u7406\u5DF2\u5904\u7406\u7684ID\n    public void cleanupProcessedIds() {\n        // \u53EF\u4EE5\u57FA\u4E8E\u65F6\u95F4\u6216\u6570\u91CF\u6E05\u7406\n        if (processedIds.size() > 10000) {\n            processedIds.clear();\n        }\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"72-\u91CD\u8BD5\u7B56\u7565",children:"7.2 \u91CD\u8BD5\u7B56\u7565"}),"\n",(0,r.jsx)(e.h4,{id:"\u6307\u6570\u9000\u907F\u7B97\u6CD5",children:"\u6307\u6570\u9000\u907F\u7B97\u6CD5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u6307\u6570\u9000\u907F\u5B9E\u73B0"',children:"public class ExponentialBackoff {\n    private final int maxRetries;\n    private final long initialDelay;\n    private final double multiplier;\n    private final long maxDelay;\n    \n    public ExponentialBackoff(int maxRetries, long initialDelay, double multiplier, long maxDelay) {\n        this.maxRetries = maxRetries;\n        this.initialDelay = initialDelay;\n        this.multiplier = multiplier;\n        this.maxDelay = maxDelay;\n    }\n    \n    public <T> T execute(Supplier<T> operation) throws Exception {\n        int retries = 0;\n        long delay = initialDelay;\n        \n        while (true) {\n            try {\n                return operation.get();\n            } catch (Exception e) {\n                retries++;\n                if (retries > maxRetries) {\n                    throw e;\n                }\n                \n                // \u8BA1\u7B97\u9000\u907F\u65F6\u95F4\n                long backoffDelay = Math.min(delay, maxDelay);\n                \n                // \u6DFB\u52A0\u6296\u52A8\n                long jitter = (long) (Math.random() * backoffDelay * 0.1);\n                long totalDelay = backoffDelay + jitter;\n                \n                Thread.sleep(totalDelay);\n                delay = (long) (delay * multiplier);\n            }\n        }\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h4,{id:"\u91CD\u8BD5\u7B56\u7565\u914D\u7F6E",children:"\u91CD\u8BD5\u7B56\u7565\u914D\u7F6E"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u91CD\u8BD5\u7B56\u7565\u914D\u7F6E"',children:"public class RetryConfig {\n    private final int maxRetries;\n    private final Duration initialDelay;\n    private final Duration maxDelay;\n    private final double multiplier;\n    private final Set<Class<? extends Exception>> retryableExceptions;\n    \n    public static RetryConfig defaultConfig() {\n        return new RetryConfig(\n            3,                          // \u6700\u5927\u91CD\u8BD5\u6B21\u6570\n            Duration.ofMillis(100),     // \u521D\u59CB\u5EF6\u8FDF\n            Duration.ofSeconds(1),      // \u6700\u5927\u5EF6\u8FDF\n            2.0,                        // \u500D\u6570\n            Set.of(IOException.class, TimeoutException.class) // \u53EF\u91CD\u8BD5\u5F02\u5E38\n        );\n    }\n    \n    public boolean shouldRetry(Exception e, int attemptCount) {\n        return attemptCount < maxRetries && \n               retryableExceptions.stream().anyMatch(ex -> ex.isInstance(e));\n    }\n}\n"})}),"\n",(0,r.jsx)(e.admonition,{title:"\u91CD\u8BD5\u6700\u4F73\u5B9E\u8DF5",type:"tip",children:(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8BBE\u7F6E\u6700\u5927\u91CD\u8BD5\u6B21\u6570"}),"\uFF1A\u907F\u514D\u65E0\u9650\u91CD\u8BD5"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u4F7F\u7528\u6307\u6570\u9000\u907F"}),"\uFF1A\u51CF\u5C11\u5BF9\u7CFB\u7EDF\u7684\u538B\u529B"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6DFB\u52A0\u6296\u52A8"}),"\uFF1A\u907F\u514D\u91CD\u8BD5\u98CE\u66B4"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u533A\u5206\u5F02\u5E38\u7C7B\u578B"}),"\uFF1A\u53EA\u5BF9\u7279\u5B9A\u5F02\u5E38\u91CD\u8BD5"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5B9E\u73B0\u5E42\u7B49\u6027"}),"\uFF1A\u786E\u4FDD\u91CD\u8BD5\u4E0D\u4F1A\u4EA7\u751F\u526F\u4F5C\u7528"]}),"\n"]})}),"\n",(0,r.jsx)(e.h2,{id:"8-\u8BBE\u8BA1\u4E0E\u843D\u5730\u6E05\u5355best-practices",children:"8. \u8BBE\u8BA1\u4E0E\u843D\u5730\u6E05\u5355\uFF08Best Practices\uFF09"}),"\n",(0,r.jsx)(e.h3,{id:"81-\u7CFB\u7EDF\u8BBE\u8BA1\u539F\u5219",children:"8.1 \u7CFB\u7EDF\u8BBE\u8BA1\u539F\u5219"}),"\n",(0,r.jsx)(e.h4,{id:"\u8BBE\u8BA1\u539F\u5219\u6E05\u5355",children:"\u8BBE\u8BA1\u539F\u5219\u6E05\u5355"}),"\n",(0,r.jsx)(e.mermaid,{value:"graph TD\n    A[\u5206\u5E03\u5F0F\u7CFB\u7EDF\u8BBE\u8BA1\u539F\u5219] --\x3e B[\u660E\u786E\u4E00\u81F4\u6027\u9700\u6C42]\n    A --\x3e C[\u5408\u7406\u526F\u672C\u914D\u7F6E]\n    A --\x3e D[Leader\u9009\u4E3E\u4F18\u5316]\n    A --\x3e E[\u76D1\u63A7\u4E0E\u89C2\u6D4B]\n    A --\x3e F[\u5E42\u7B49\u8BBE\u8BA1]\n    A --\x3e G[\u9650\u6D41\u4E0E\u7194\u65AD]\n    \n    B --\x3e B1[\u5F3A\u4E00\u81F4/\u4F1A\u8BDD\u4E00\u81F4/\u6700\u7EC8\u4E00\u81F4]\n    C --\x3e C1[\u907F\u514DR+W\u2264N]\n    D --\x3e D1[\u52A8\u6001\u8C03\u6574\u8D85\u65F6]\n    E --\x3e E1[\u5EF6\u8FDF\u5206\u5E03/\u9519\u8BEF\u7387/\u9971\u548C\u5EA6]\n    F --\x3e F1[\u5E42\u7B49\u952E/\u53BB\u91CD\u8868/\u5929\u7136\u5E42\u7B49]\n    G --\x3e G1[\u907F\u514D\u7EA7\u8054\u6545\u969C]"}),"\n",(0,r.jsx)(e.h4,{id:"\u4E00\u81F4\u6027\u9700\u6C42\u5206\u6790",children:"\u4E00\u81F4\u6027\u9700\u6C42\u5206\u6790"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u4E00\u81F4\u6027\u9700\u6C42\u5206\u6790\u6846\u67B6"',children:"public class ConsistencyRequirementAnalyzer {\n    \n    public ConsistencyLevel analyzeRequirement(BusinessContext context) {\n        // \u5206\u6790\u4E1A\u52A1\u573A\u666F\n        if (isFinancialTransaction(context)) {\n            return ConsistencyLevel.STRONG;\n        }\n        \n        if (isUserSession(context)) {\n            return ConsistencyLevel.SESSION;\n        }\n        \n        if (isContentCache(context)) {\n            return ConsistencyLevel.EVENTUAL;\n        }\n        \n        return ConsistencyLevel.EVENTUAL; // \u9ED8\u8BA4\u6700\u7EC8\u4E00\u81F4\n    }\n    \n    private boolean isFinancialTransaction(BusinessContext context) {\n        return context.getBusinessType() == BusinessType.FINANCIAL &&\n               context.getDataImportance() == DataImportance.CRITICAL;\n    }\n    \n    private boolean isUserSession(BusinessContext context) {\n        return context.getBusinessType() == BusinessType.USER_SESSION;\n    }\n    \n    private boolean isContentCache(BusinessContext context) {\n        return context.getBusinessType() == BusinessType.CONTENT_CACHE;\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"82-\u526F\u672C\u914D\u7F6E\u4F18\u5316",children:"8.2 \u526F\u672C\u914D\u7F6E\u4F18\u5316"}),"\n",(0,r.jsx)(e.h4,{id:"quorum\u914D\u7F6E\u68C0\u67E5",children:"Quorum\u914D\u7F6E\u68C0\u67E5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="Quorum\u914D\u7F6E\u9A8C\u8BC1"',children:'public class QuorumConfigValidator {\n    \n    public ValidationResult validateQuorumConfig(int replicaCount, int readQuorum, int writeQuorum) {\n        ValidationResult result = new ValidationResult();\n        \n        // \u68C0\u67E5\u57FA\u672C\u7EA6\u675F\n        if (readQuorum > replicaCount || writeQuorum > replicaCount) {\n            result.addError("Quorum cannot exceed replica count");\n        }\n        \n        if (readQuorum <= 0 || writeQuorum <= 0) {\n            result.addError("Quorum must be positive");\n        }\n        \n        // \u68C0\u67E5\u4E00\u81F4\u6027\u4FDD\u8BC1\n        if (readQuorum + writeQuorum > replicaCount) {\n            result.addInfo("Strong consistency guaranteed");\n        } else {\n            result.addWarning("Availability prioritized over consistency");\n        }\n        \n        // \u68C0\u67E5\u53EF\u7528\u6027\n        int maxFailures = replicaCount - Math.max(readQuorum, writeQuorum);\n        if (maxFailures < 1) {\n            result.addError("System cannot tolerate any failures");\n        }\n        \n        return result;\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"83-\u76D1\u63A7\u4E0E\u89C2\u6D4B",children:"8.3 \u76D1\u63A7\u4E0E\u89C2\u6D4B"}),"\n",(0,r.jsx)(e.h4,{id:"\u5173\u952E\u76D1\u63A7\u6307\u6807",children:"\u5173\u952E\u76D1\u63A7\u6307\u6807"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u5206\u5E03\u5F0F\u7CFB\u7EDF\u76D1\u63A7\u6307\u6807"',children:"public class DistributedSystemMetrics {\n    \n    // \u5EF6\u8FDF\u6307\u6807\n    public void recordLatency(String operation, long latency) {\n        // \u8BB0\u5F55P50\u3001P95\u3001P99\u5EF6\u8FDF\n        histogram.record(latency);\n    }\n    \n    // \u9519\u8BEF\u7387\u6307\u6807\n    public void recordError(String operation, String errorType) {\n        errorCounter.increment(errorType);\n    }\n    \n    // \u9971\u548C\u5EA6\u6307\u6807\n    public void recordSaturation(String resource, double utilization) {\n        gauge.set(utilization);\n    }\n    \n    // \u4E00\u81F4\u6027\u6307\u6807\n    public void recordConsistencyViolation(String dataType) {\n        consistencyViolationCounter.increment(dataType);\n    }\n    \n    // \u5206\u533A\u6307\u6807\n    public void recordPartition(String partitionType, long duration) {\n        partitionHistogram.record(duration);\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h4,{id:"\u94FE\u8DEF\u8FFD\u8E2A",children:"\u94FE\u8DEF\u8FFD\u8E2A"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u5206\u5E03\u5F0F\u94FE\u8DEF\u8FFD\u8E2A"',children:'public class DistributedTracer {\n    \n    public Span startSpan(String operationName) {\n        Span span = tracer.buildSpan(operationName)\n                         .withTag("service", serviceName)\n                         .withTag("node", nodeId)\n                         .start();\n        \n        // \u6CE8\u5165\u5230\u5F53\u524D\u4E0A\u4E0B\u6587\n        tracer.activateSpan(span);\n        return span;\n    }\n    \n    public void addEvent(String eventName, Map<String, Object> attributes) {\n        Span span = tracer.activeSpan();\n        if (span != null) {\n            span.log(eventName, attributes);\n        }\n    }\n    \n    public void setTag(String key, String value) {\n        Span span = tracer.activeSpan();\n        if (span != null) {\n            span.setTag(key, value);\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"84-\u5E42\u7B49\u8BBE\u8BA1",children:"8.4 \u5E42\u7B49\u8BBE\u8BA1"}),"\n",(0,r.jsx)(e.h4,{id:"\u5E42\u7B49\u6027\u5B9E\u73B0\u6A21\u5F0F",children:"\u5E42\u7B49\u6027\u5B9E\u73B0\u6A21\u5F0F"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u5E42\u7B49\u6027\u5B9E\u73B0"',children:'public class IdempotentService {\n    \n    // \u5E42\u7B49\u952E\u6A21\u5F0F\n    public void processWithIdempotentKey(String idempotentKey, Request request) {\n        if (isProcessed(idempotentKey)) {\n            return; // \u5DF2\u5904\u7406\uFF0C\u76F4\u63A5\u8FD4\u56DE\n        }\n        \n        try {\n            processRequest(request);\n            markAsProcessed(idempotentKey);\n        } catch (Exception e) {\n            // \u5904\u7406\u5931\u8D25\uFF0C\u4E0D\u6807\u8BB0\u4E3A\u5DF2\u5904\u7406\n            throw e;\n        }\n    }\n    \n    // \u53BB\u91CD\u8868\u6A21\u5F0F\n    public void processWithDeduplicationTable(String requestId, Request request) {\n        try (Connection conn = dataSource.getConnection()) {\n            conn.setAutoCommit(false);\n            \n            // \u68C0\u67E5\u662F\u5426\u5DF2\u5904\u7406\n            if (isRequestProcessed(conn, requestId)) {\n                conn.rollback();\n                return;\n            }\n            \n            // \u6807\u8BB0\u4E3A\u5904\u7406\u4E2D\n            markRequestAsProcessing(conn, requestId);\n            \n            // \u5904\u7406\u8BF7\u6C42\n            processRequest(request);\n            \n            // \u6807\u8BB0\u4E3A\u5DF2\u5904\u7406\n            markRequestAsProcessed(conn, requestId);\n            \n            conn.commit();\n        } catch (Exception e) {\n            throw new RuntimeException("Failed to process request", e);\n        }\n    }\n    \n    // \u5929\u7136\u5E42\u7B49\u6A21\u5F0F\n    public void updateUserProfile(String userId, UserProfile profile) {\n        // PUT\u64CD\u4F5C\u5929\u7136\u5E42\u7B49\n        userRepository.put(userId, profile);\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"85-\u9650\u6D41\u4E0E\u7194\u65AD",children:"8.5 \u9650\u6D41\u4E0E\u7194\u65AD"}),"\n",(0,r.jsx)(e.h4,{id:"\u9650\u6D41\u5668\u5B9E\u73B0",children:"\u9650\u6D41\u5668\u5B9E\u73B0"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u5206\u5E03\u5F0F\u9650\u6D41\u5668"',children:'public class DistributedRateLimiter {\n    private final RedisTemplate<String, String> redisTemplate;\n    private final String keyPrefix;\n    \n    public boolean tryAcquire(String resource, int permits, int capacity, Duration window) {\n        String key = keyPrefix + ":" + resource;\n        long now = System.currentTimeMillis();\n        long windowStart = now - window.toMillis();\n        \n        // \u4F7F\u7528Redis\u7684ZREMRANGEBYSCORE\u548CZADD\u5B9E\u73B0\u6ED1\u52A8\u7A97\u53E3\n        redisTemplate.execute(new SessionCallback<Boolean>() {\n            @Override\n            public Boolean execute(RedisOperations operations) throws DataAccessException {\n                operations.multi();\n                \n                // \u79FB\u9664\u7A97\u53E3\u5916\u7684\u8BF7\u6C42\n                operations.opsForZSet().removeRangeByScore(key, 0, windowStart);\n                \n                // \u83B7\u53D6\u5F53\u524D\u7A97\u53E3\u5185\u7684\u8BF7\u6C42\u6570\n                Long currentCount = operations.opsForZSet().zCard(key);\n                \n                if (currentCount + permits <= capacity) {\n                    // \u6DFB\u52A0\u65B0\u8BF7\u6C42\n                    operations.opsForZSet().add(key, UUID.randomUUID().toString(), now);\n                    return true;\n                }\n                \n                return false;\n            }\n        });\n        \n        return false;\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h4,{id:"\u7194\u65AD\u5668\u5B9E\u73B0",children:"\u7194\u65AD\u5668\u5B9E\u73B0"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u7194\u65AD\u5668\u6A21\u5F0F"',children:'public class CircuitBreaker {\n    private final String name;\n    private final int failureThreshold;\n    private final Duration timeout;\n    private final Duration resetTimeout;\n    \n    private CircuitState state = CircuitState.CLOSED;\n    private int failureCount = 0;\n    private long lastFailureTime = 0;\n    \n    public <T> T execute(Supplier<T> operation) throws Exception {\n        if (state == CircuitState.OPEN) {\n            if (System.currentTimeMillis() - lastFailureTime > resetTimeout.toMillis()) {\n                state = CircuitState.HALF_OPEN;\n            } else {\n                throw new CircuitBreakerOpenException("Circuit breaker is open");\n            }\n        }\n        \n        try {\n            T result = operation.get();\n            onSuccess();\n            return result;\n        } catch (Exception e) {\n            onFailure();\n            throw e;\n        }\n    }\n    \n    private void onSuccess() {\n        failureCount = 0;\n        if (state == CircuitState.HALF_OPEN) {\n            state = CircuitState.CLOSED;\n        }\n    }\n    \n    private void onFailure() {\n        failureCount++;\n        lastFailureTime = System.currentTimeMillis();\n        \n        if (failureCount >= failureThreshold) {\n            state = CircuitState.OPEN;\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"9-\u5E38\u89C1\u5751\u4F4Dpitfalls",children:"9. \u5E38\u89C1\u5751\u4F4D\uFF08Pitfalls\uFF09"}),"\n",(0,r.jsx)(e.h3,{id:"91-\u65F6\u949F\u4F9D\u8D56\u95EE\u9898",children:"9.1 \u65F6\u949F\u4F9D\u8D56\u95EE\u9898"}),"\n",(0,r.jsx)(e.h4,{id:"\u65F6\u949F\u56DE\u62E8\u5904\u7406",children:"\u65F6\u949F\u56DE\u62E8\u5904\u7406"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u65F6\u949F\u56DE\u62E8\u5904\u7406"',children:'public class ClockDriftHandler {\n    \n    public void handleClockDrift(long currentTime, long lastTime) {\n        if (currentTime < lastTime) {\n            long drift = lastTime - currentTime;\n            \n            if (drift > maxAllowedDrift) {\n                // \u65F6\u949F\u56DE\u62E8\u8FC7\u5927\uFF0C\u8BB0\u5F55\u544A\u8B66\n                alertService.sendAlert("Clock drift too large: " + drift + "ms");\n                \n                // \u53EF\u4EE5\u9009\u62E9\u505C\u6B62\u670D\u52A1\u6216\u4F7F\u7528\u903B\u8F91\u65F6\u949F\n                if (stopOnLargeDrift) {\n                    throw new ClockDriftException("Clock drifted too much");\n                }\n            } else {\n                // \u5C0F\u5E45\u5EA6\u56DE\u62E8\uFF0C\u7B49\u5F85\u65F6\u949F\u8FFD\u4E0A\n                try {\n                    Thread.sleep(drift);\n                } catch (InterruptedException e) {\n                    Thread.currentThread().interrupt();\n                }\n            }\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"92-\u7F51\u7EDC\u5206\u533A\u5904\u7406",children:"9.2 \u7F51\u7EDC\u5206\u533A\u5904\u7406"}),"\n",(0,r.jsx)(e.h4,{id:"\u5206\u533A\u68C0\u6D4B",children:"\u5206\u533A\u68C0\u6D4B"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u7F51\u7EDC\u5206\u533A\u68C0\u6D4B"',children:"public class PartitionDetector {\n    private final Map<String, Long> lastHeartbeat = new ConcurrentHashMap<>();\n    private final Duration heartbeatTimeout;\n    \n    public void recordHeartbeat(String nodeId) {\n        lastHeartbeat.put(nodeId, System.currentTimeMillis());\n    }\n    \n    public List<String> detectPartitionedNodes() {\n        long now = System.currentTimeMillis();\n        return lastHeartbeat.entrySet().stream()\n                .filter(entry -> now - entry.getValue() > heartbeatTimeout.toMillis())\n                .map(Map.Entry::getKey)\n                .collect(Collectors.toList());\n    }\n    \n    public void handlePartition(List<String> partitionedNodes) {\n        // \u6839\u636E\u4E1A\u52A1\u9700\u6C42\u5904\u7406\u5206\u533A\n        if (isCriticalPartition(partitionedNodes)) {\n            // \u89E6\u53D1\u6545\u969C\u8F6C\u79FB\n            triggerFailover();\n        } else {\n            // \u8BB0\u5F55\u5206\u533A\u4E8B\u4EF6\n            logPartitionEvent(partitionedNodes);\n        }\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"93-\u5199\u6269\u6563\u95EE\u9898",children:"9.3 \u5199\u6269\u6563\u95EE\u9898"}),"\n",(0,r.jsx)(e.h4,{id:"\u5199\u6269\u6563\u68C0\u6D4B",children:"\u5199\u6269\u6563\u68C0\u6D4B"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u5199\u6269\u6563\u68C0\u6D4B"',children:'public class WriteAmplificationDetector {\n    \n    public void detectWriteAmplification(String operation, int actualWrites, int expectedWrites) {\n        double amplification = (double) actualWrites / expectedWrites;\n        \n        if (amplification > writeAmplificationThreshold) {\n            // \u8BB0\u5F55\u5199\u6269\u6563\u4E8B\u4EF6\n            metrics.recordWriteAmplification(operation, amplification);\n            \n            // \u53D1\u9001\u544A\u8B66\n            if (amplification > criticalThreshold) {\n                alertService.sendAlert("Critical write amplification: " + amplification);\n            }\n        }\n    }\n    \n    public void optimizeWritePattern(String operation) {\n        // \u5206\u6790\u5199\u6A21\u5F0F\uFF0C\u63D0\u4F9B\u4F18\u5316\u5EFA\u8BAE\n        WritePattern pattern = analyzeWritePattern(operation);\n        \n        if (pattern.hasCrossShardWrites()) {\n            suggestBatchWrites(pattern);\n        }\n        \n        if (pattern.hasRedundantWrites()) {\n            suggestDeduplication(pattern);\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"94-\u5E42\u7B49\u6027\u7F3A\u5931",children:"9.4 \u5E42\u7B49\u6027\u7F3A\u5931"}),"\n",(0,r.jsx)(e.h4,{id:"\u5E42\u7B49\u6027\u68C0\u67E5",children:"\u5E42\u7B49\u6027\u68C0\u67E5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",metastring:'title="\u5E42\u7B49\u6027\u68C0\u67E5\u5DE5\u5177"',children:'public class IdempotencyChecker {\n    \n    public void checkIdempotency(String operation, Object request) {\n        if (!isIdempotent(operation)) {\n            logWarning("Operation " + operation + " may not be idempotent");\n            \n            // \u5EFA\u8BAE\u6DFB\u52A0\u5E42\u7B49\u952E\n            suggestIdempotencyKey(operation);\n        }\n    }\n    \n    private boolean isIdempotent(String operation) {\n        // \u68C0\u67E5\u64CD\u4F5C\u662F\u5426\u5929\u7136\u5E42\u7B49\n        return operation.startsWith("PUT") || \n               operation.startsWith("DELETE") ||\n               operation.equals("GET");\n    }\n    \n    private void suggestIdempotencyKey(String operation) {\n        // \u63D0\u4F9B\u6DFB\u52A0\u5E42\u7B49\u952E\u7684\u5EFA\u8BAE\n        logInfo("Consider adding idempotency key for operation: " + operation);\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"10-\u9762\u8BD5\u9898\u7CBE\u9009",children:"10. \u9762\u8BD5\u9898\u7CBE\u9009"}),"\n",(0,r.jsx)(e.h3,{id:"101-\u57FA\u7840\u6982\u5FF5\u9898",children:"10.1 \u57FA\u7840\u6982\u5FF5\u9898"}),"\n",(0,r.jsx)(e.h4,{id:"q1-\u8BF7\u89E3\u91CAcap\u5B9A\u7406\u5E76\u4E3Ecp\u4E0Eap\u7CFB\u7EDF\u7684\u5B9E\u9645\u6848\u4F8B\u8BF4\u660E\u53D6\u820D\u7406\u7531",children:"Q1: \u8BF7\u89E3\u91CACAP\u5B9A\u7406\uFF0C\u5E76\u4E3ECP\u4E0EAP\u7CFB\u7EDF\u7684\u5B9E\u9645\u6848\u4F8B\uFF0C\u8BF4\u660E\u53D6\u820D\u7406\u7531"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7B54"}),": CAP\u5B9A\u7406\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\u8BBE\u8BA1\u7684\u7406\u8BBA\u57FA\u7840\uFF0C\u6307\u51FA\u5728\u7F51\u7EDC\u5206\u533A\uFF08P\uFF09\u53D1\u751F\u65F6\uFF0C\u7CFB\u7EDF\u53EA\u80FD\u5728\u4E00\u81F4\u6027\uFF08C\uFF09\u548C\u53EF\u7528\u6027\uFF08A\uFF09\u4E4B\u95F4\u9009\u62E9\u5176\u4E00\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"CP\u7CFB\u7EDF\u6848\u4F8B"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"ZooKeeper"}),"\uFF1A\u914D\u7F6E\u7BA1\u7406\u3001\u5206\u5E03\u5F0F\u9501"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7406\u7531"}),"\uFF1A\u914D\u7F6E\u6570\u636E\u5FC5\u987B\u4E00\u81F4\uFF0C\u5426\u5219\u4F1A\u5BFC\u81F4\u7CFB\u7EDF\u884C\u4E3A\u4E0D\u4E00\u81F4"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"AP\u7CFB\u7EDF\u6848\u4F8B"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Cassandra"}),"\uFF1A\u5185\u5BB9\u5B58\u50A8\u3001\u65E5\u5FD7\u7CFB\u7EDF"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7406\u7531"}),"\uFF1A\u53EF\u7528\u6027\u4F18\u5148\uFF0C\u6570\u636E\u6700\u7EC8\u4E00\u81F4\u5373\u53EF"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u53D6\u820D\u8003\u8651"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6570\u636E\u91CD\u8981\u6027"}),"\uFF1A\u5173\u952E\u6570\u636E\u9009CP\uFF0C\u975E\u5173\u952E\u6570\u636E\u9009AP"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5B9E\u65F6\u6027\u8981\u6C42"}),"\uFF1A\u5F3A\u5B9E\u65F6\u9009CP\uFF0C\u53EF\u5BB9\u5FCD\u5EF6\u8FDF\u9009AP"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u4E1A\u52A1\u5BB9\u5FCD\u5EA6"}),"\uFF1A\u5BF9\u6570\u636E\u9519\u8BEF\u5BB9\u5FCD\u5EA6\u4F4E\u9009CP\uFF0C\u5BF9\u670D\u52A1\u4E2D\u65AD\u5BB9\u5FCD\u5EA6\u4F4E\u9009AP"]}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"q2-quorum\u6761\u4EF6rwn\u80FD\u4FDD\u8BC1\u4EC0\u4E48\u5728\u7F51\u7EDC\u5206\u533A\u4E0B\u6709\u54EA\u4E9B\u9650\u5236",children:"Q2: Quorum\u6761\u4EF6R+W>N\u80FD\u4FDD\u8BC1\u4EC0\u4E48\uFF1F\u5728\u7F51\u7EDC\u5206\u533A\u4E0B\u6709\u54EA\u4E9B\u9650\u5236\uFF1F"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7B54"}),":\n",(0,r.jsx)(e.strong,{children:"R+W>N\u4FDD\u8BC1"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u8BFB\u64CD\u4F5C\u4E00\u5B9A\u80FD\u8BFB\u5230\u6700\u65B0\u5199\u5165\u7684\u6570\u636E"}),"\n",(0,r.jsx)(e.li,{children:"\u5728\u5355\u5206\u533A\u524D\u63D0\u4E0B\u63D0\u4F9B\u5F3A\u4E00\u81F4\u6027\u4FDD\u8BC1"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7F51\u7EDC\u5206\u533A\u9650\u5236"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5F53\u7F51\u7EDC\u5206\u533A\u65F6\uFF0C\u53EF\u80FD\u65E0\u6CD5\u6EE1\u8DB3R+W>N\u6761\u4EF6"}),"\n",(0,r.jsx)(e.li,{children:"\u9700\u8981\u5728\u4E00\u81F4\u6027\u548C\u53EF\u7528\u6027\u4E4B\u95F4\u505A\u51FA\u9009\u62E9"}),"\n",(0,r.jsx)(e.li,{children:"\u53EF\u80FD\u51FA\u73B0\u8111\u88C2\u95EE\u9898"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u793A\u4F8B"}),"\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"N=3, R=2, W=2\u7684\u60C5\u51B5\uFF1A\n- \u6B63\u5E38\u60C5\u51B5\uFF1AR+W=4>3\uFF0C\u5F3A\u4E00\u81F4\u6027\n- \u7F51\u7EDC\u5206\u533A\uFF1A\u53EF\u80FD\u53EA\u67092\u4E2A\u8282\u70B9\u53EF\u8FBE\uFF0C\u65E0\u6CD5\u6EE1\u8DB3W=2\n"})}),"\n",(0,r.jsx)(e.h3,{id:"102-\u7B97\u6CD5\u5B9E\u73B0\u9898",children:"10.2 \u7B97\u6CD5\u5B9E\u73B0\u9898"}),"\n",(0,r.jsx)(e.h4,{id:"q3-raft\u5982\u4F55\u4FDD\u8BC1\u65E5\u5FD7\u7684\u4E00\u81F4\u590D\u5236\u4E0E\u63D0\u4EA4\u7D22\u5F15\u7684\u5B89\u5168\u6027",children:"Q3: Raft\u5982\u4F55\u4FDD\u8BC1\u65E5\u5FD7\u7684\u4E00\u81F4\u590D\u5236\u4E0E\u63D0\u4EA4\u7D22\u5F15\u7684\u5B89\u5168\u6027\uFF1F"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7B54"}),":\n",(0,r.jsx)(e.strong,{children:"\u65E5\u5FD7\u4E00\u81F4\u590D\u5236"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Leader\u9009\u4E3E"}),"\uFF1A\u53EA\u6709\u5305\u542B\u6240\u6709\u5DF2\u63D0\u4EA4\u65E5\u5FD7\u7684\u8282\u70B9\u624D\u80FD\u6210\u4E3ALeader"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u65E5\u5FD7\u5339\u914D"}),"\uFF1ALeader\u53D1\u9001AppendEntries\u65F6\u5305\u542B\u524D\u4E00\u6761\u65E5\u5FD7\u7684\u7D22\u5F15\u548C\u4EFB\u671F"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5F3A\u5236\u8986\u76D6"}),"\uFF1AFollower\u53D1\u73B0\u65E5\u5FD7\u4E0D\u5339\u914D\u65F6\uFF0C\u5220\u9664\u51B2\u7A81\u65E5\u5FD7\u5E76\u63A5\u53D7Leader\u7684\u65E5\u5FD7"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u63D0\u4EA4\u7D22\u5F15\u5B89\u5168\u6027"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u591A\u6570\u6D3E\u786E\u8BA4"}),"\uFF1A\u53EA\u6709\u591A\u6570\u6D3E\u590D\u5236\u4E86\u65E5\u5FD7\uFF0CLeader\u624D\u63D0\u4EA4"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u4EFB\u671F\u68C0\u67E5"}),"\uFF1A\u53EA\u6709\u5F53\u524D\u4EFB\u671F\u7684\u65E5\u5FD7\u624D\u80FD\u901A\u8FC7\u591A\u6570\u6D3E\u63D0\u4EA4"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5411\u540E\u4F20\u64AD"}),"\uFF1A\u63D0\u4EA4\u7D22\u5F15\u5411\u540E\u4F20\u64AD\uFF0C\u786E\u4FDD\u4E4B\u524D\u4EFB\u671F\u7684\u65E5\u5FD7\u4E5F\u88AB\u63D0\u4EA4"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u4EE3\u7801\u793A\u4F8B"}),"\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"private void tryCommit() {\n    for (long i = commitIndex + 1; i <= entries.size(); i++) {\n        int replicatedCount = 1; // \u81EA\u5DF1\n        for (String peer : peers) {\n            if (matchIndex.get(peer) >= i) {\n                replicatedCount++;\n            }\n        }\n        \n        // \u53EA\u6709\u5F53\u524D\u4EFB\u671F\u7684\u65E5\u5FD7\u624D\u80FD\u901A\u8FC7\u591A\u6570\u6D3E\u63D0\u4EA4\n        if (replicatedCount > majority() && \n            entries.get((int)i-1).getTerm() == currentTerm) {\n            commitIndex = i;\n        }\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h4,{id:"q4-\u4F55\u65F6\u9009\u62E9crdt\u4E0E\u5411\u91CF\u65F6\u949F\u7684\u5173\u7CFB\u4E0E\u5C40\u9650",children:"Q4: \u4F55\u65F6\u9009\u62E9CRDT\uFF1F\u4E0E\u5411\u91CF\u65F6\u949F\u7684\u5173\u7CFB\u4E0E\u5C40\u9650"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7B54"}),":\n",(0,r.jsx)(e.strong,{children:"CRDT\u9002\u7528\u573A\u666F"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u534F\u4F5C\u7F16\u8F91"}),"\uFF1A\u591A\u4EBA\u540C\u65F6\u7F16\u8F91\u6587\u6863"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8BA1\u6570\u5668"}),"\uFF1A\u5206\u5E03\u5F0F\u8BA1\u6570\u5668"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u96C6\u5408\u64CD\u4F5C"}),"\uFF1A\u5206\u5E03\u5F0F\u96C6\u5408\u7684\u5E76\u96C6\u3001\u4EA4\u96C6"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6700\u7EC8\u4E00\u81F4\u6027\u573A\u666F"}),"\uFF1A\u53EF\u4EE5\u63A5\u53D7\u6700\u7EC8\u4E00\u81F4\u6027\u7684\u5E94\u7528"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u4E0E\u5411\u91CF\u65F6\u949F\u7684\u5173\u7CFB"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5411\u91CF\u65F6\u949F"}),"\uFF1A\u68C0\u6D4B\u56E0\u679C\u5173\u7CFB\uFF0C\u4F46\u4E0D\u89E3\u51B3\u51B2\u7A81"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"CRDT"}),"\uFF1A\u5929\u7136\u6536\u655B\uFF0C\u65E0\u9700\u51B2\u7A81\u89E3\u51B3"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7ED3\u5408\u4F7F\u7528"}),"\uFF1A\u5411\u91CF\u65F6\u949F\u7528\u4E8E\u68C0\u6D4B\u51B2\u7A81\uFF0CCRDT\u7528\u4E8E\u81EA\u52A8\u5408\u5E76"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"CRDT\u5C40\u9650"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7C7B\u578B\u7279\u5B9A"}),"\uFF1A\u6BCF\u79CD\u6570\u636E\u7C7B\u578B\u9700\u8981\u7279\u5B9A\u7684CRDT\u5B9E\u73B0"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5B58\u50A8\u5F00\u9500"}),"\uFF1A\u9700\u8981\u5B58\u50A8\u989D\u5916\u7684\u5143\u6570\u636E"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8BED\u4E49\u9650\u5236"}),"\uFF1A\u4E0D\u662F\u6240\u6709\u64CD\u4F5C\u90FD\u80FD\u7528CRDT\u8868\u793A"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"103-\u7CFB\u7EDF\u8BBE\u8BA1\u9898",children:"10.3 \u7CFB\u7EDF\u8BBE\u8BA1\u9898"}),"\n",(0,r.jsx)(e.h4,{id:"q5-\u8BBE\u8BA1\u4E00\u4E2A\u5168\u5C40\u552F\u4E00id\u65B9\u6848\u5982\u4F55\u5904\u7406\u65F6\u949F\u56DE\u62E8\u4E0E\u70ED\u70B9\u5206\u914D",children:"Q5: \u8BBE\u8BA1\u4E00\u4E2A\u5168\u5C40\u552F\u4E00ID\u65B9\u6848\uFF0C\u5982\u4F55\u5904\u7406\u65F6\u949F\u56DE\u62E8\u4E0E\u70ED\u70B9\u5206\u914D"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7B54"}),":\n",(0,r.jsx)(e.strong,{children:"\u8BBE\u8BA1\u65B9\u6848"}),"\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class GlobalIdGenerator {\n    private final long datacenterId;\n    private final long workerId;\n    private final AtomicLong sequence = new AtomicLong(0);\n    private volatile long lastTimestamp = -1L;\n    \n    public long nextId() {\n        long timestamp = System.currentTimeMillis();\n        \n        // \u5904\u7406\u65F6\u949F\u56DE\u62E8\n        if (timestamp < lastTimestamp) {\n            long offset = lastTimestamp - timestamp;\n            if (offset > maxClockDrift) {\n                throw new ClockDriftException("Clock drifted too much");\n            }\n            // \u7B49\u5F85\u65F6\u949F\u8FFD\u4E0A\n            while (timestamp < lastTimestamp) {\n                timestamp = System.currentTimeMillis();\n            }\n        }\n        \n        // \u5904\u7406\u540C\u4E00\u6BEB\u79D2\u5185\u7684\u5E8F\u5217\n        if (timestamp == lastTimestamp) {\n            long currentSequence = sequence.incrementAndGet();\n            if (currentSequence > maxSequence) {\n                // \u5E8F\u5217\u6EA2\u51FA\uFF0C\u7B49\u5F85\u4E0B\u4E00\u6BEB\u79D2\n                timestamp = waitForNextMillis(lastTimestamp);\n                sequence.set(0);\n            }\n        } else {\n            sequence.set(0);\n        }\n        \n        lastTimestamp = timestamp;\n        \n        return ((timestamp - epoch) << timestampShift) |\n               (datacenterId << datacenterShift) |\n               (workerId << workerShift) |\n               sequence.get();\n    }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u65F6\u949F\u56DE\u62E8\u5904\u7406"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u68C0\u6D4B\u56DE\u62E8"}),"\uFF1A\u6BD4\u8F83\u5F53\u524D\u65F6\u95F4\u4E0E\u4E0A\u6B21\u65F6\u95F4"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5BB9\u5FCD\u7A97\u53E3"}),"\uFF1A\u5C0F\u5E45\u5EA6\u56DE\u62E8\u7B49\u5F85\u65F6\u949F\u8FFD\u4E0A"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5F02\u5E38\u5904\u7406"}),"\uFF1A\u5927\u5E45\u5EA6\u56DE\u62E8\u629B\u51FA\u5F02\u5E38"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u70ED\u70B9\u5206\u914D\u5904\u7406"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u9884\u5206\u914D\u53F7\u6BB5"}),"\uFF1A\u63D0\u524D\u5206\u914D\u53F7\u6BB5\uFF0C\u51CF\u5C11\u7ADE\u4E89"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6279\u91CF\u751F\u6210"}),"\uFF1A\u4E00\u6B21\u751F\u6210\u591A\u4E2AID"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u672C\u5730\u7F13\u5B58"}),"\uFF1A\u5728\u672C\u5730\u7F13\u5B58\u4E00\u5B9A\u6570\u91CF\u7684ID"]}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"q6-\u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u9AD8\u53EF\u7528\u7684\u5206\u5E03\u5F0F\u9501\u7CFB\u7EDF",children:"Q6: \u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u9AD8\u53EF\u7528\u7684\u5206\u5E03\u5F0F\u9501\u7CFB\u7EDF\uFF1F"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7B54"}),":\n",(0,r.jsx)(e.strong,{children:"\u8BBE\u8BA1\u65B9\u6848"}),"\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class DistributedLock {\n    private final ZooKeeper zk;\n    private final String lockPath;\n    private final String lockName;\n    \n    public boolean tryLock(String resource, long timeout) {\n        try {\n            // \u521B\u5EFA\u4E34\u65F6\u987A\u5E8F\u8282\u70B9\n            String path = zk.create("/locks/" + resource + "/lock-", \n                                   new byte[0], \n                                   ZooDefs.Ids.OPEN_ACL_UNSAFE, \n                                   CreateMode.EPHEMERAL_SEQUENTIAL);\n            \n            // \u68C0\u67E5\u662F\u5426\u83B7\u5F97\u9501\n            List<String> children = zk.getChildren("/locks/" + resource, false);\n            Collections.sort(children);\n            \n            if (path.endsWith(children.get(0))) {\n                return true; // \u83B7\u5F97\u9501\n            }\n            \n            // \u7B49\u5F85\u9501\u91CA\u653E\n            return waitForLock(children, path, timeout);\n        } catch (Exception e) {\n            return false;\n        }\n    }\n    \n    private boolean waitForLock(List<String> children, String path, long timeout) {\n        // \u76D1\u542C\u524D\u4E00\u4E2A\u8282\u70B9\u7684\u5220\u9664\u4E8B\u4EF6\n        String watchPath = "/locks/" + resource + "/" + children.get(getIndex(children, path) - 1);\n        \n        CountDownLatch latch = new CountDownLatch(1);\n        Watcher watcher = event -> {\n            if (event.getType() == EventType.NodeDeleted) {\n                latch.countDown();\n            }\n        };\n        \n        try {\n            zk.exists(watchPath, watcher);\n            return latch.await(timeout, TimeUnit.MILLISECONDS);\n        } catch (Exception e) {\n            return false;\n        }\n    }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u9AD8\u53EF\u7528\u4FDD\u8BC1"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u591A\u526F\u672C"}),"\uFF1A\u4F7F\u7528ZooKeeper\u96C6\u7FA4\uFF0C\u5BB9\u5FCD\u90E8\u5206\u8282\u70B9\u6545\u969C"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u81EA\u52A8\u6545\u969C\u8F6C\u79FB"}),"\uFF1ALeader\u6545\u969C\u65F6\u81EA\u52A8\u9009\u4E3E\u65B0Leader"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u76D1\u63A7\u544A\u8B66"}),"\uFF1A\u76D1\u63A7\u9501\u7684\u83B7\u53D6\u548C\u91CA\u653E\u60C5\u51B5"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8D85\u65F6\u673A\u5236"}),"\uFF1A\u8BBE\u7F6E\u5408\u7406\u7684\u8D85\u65F6\u65F6\u95F4\uFF0C\u907F\u514D\u6B7B\u9501"]}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"q7-\u8BBE\u8BA1\u4E00\u4E2A\u5206\u5E03\u5F0F\u7F13\u5B58\u7CFB\u7EDF\u5982\u4F55\u5904\u7406\u7F13\u5B58\u4E00\u81F4\u6027\u95EE\u9898",children:"Q7: \u8BBE\u8BA1\u4E00\u4E2A\u5206\u5E03\u5F0F\u7F13\u5B58\u7CFB\u7EDF\uFF0C\u5982\u4F55\u5904\u7406\u7F13\u5B58\u4E00\u81F4\u6027\u95EE\u9898\uFF1F"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7B54"}),":\n",(0,r.jsx)(e.strong,{children:"\u8BBE\u8BA1\u65B9\u6848"}),"\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class DistributedCache {\n    private final Map<String, CacheNode> nodes;\n    private final ConsistencyLevel consistencyLevel;\n    \n    public void put(String key, String value) {\n        switch (consistencyLevel) {\n            case STRONG:\n                // \u5F3A\u4E00\u81F4\u6027\uFF1A\u540C\u6B65\u5199\u5165\u6240\u6709\u8282\u70B9\n                putStrongConsistency(key, value);\n                break;\n            case EVENTUAL:\n                // \u6700\u7EC8\u4E00\u81F4\u6027\uFF1A\u5F02\u6B65\u5199\u5165\n                putEventualConsistency(key, value);\n                break;\n        }\n    }\n    \n    private void putStrongConsistency(String key, String value) {\n        int successCount = 0;\n        for (CacheNode node : nodes.values()) {\n            try {\n                node.put(key, value);\n                successCount++;\n            } catch (Exception e) {\n                // \u8BB0\u5F55\u5931\u8D25\n            }\n        }\n        \n        if (successCount < majority()) {\n            throw new ConsistencyException("Failed to achieve strong consistency");\n        }\n    }\n    \n    private void putEventualConsistency(String key, String value) {\n        // \u5148\u5199\u5165\u672C\u5730\n        localCache.put(key, value);\n        \n        // \u5F02\u6B65\u590D\u5236\u5230\u5176\u4ED6\u8282\u70B9\n        for (CacheNode node : nodes.values()) {\n            CompletableFuture.runAsync(() -> {\n                try {\n                    node.put(key, value);\n                } catch (Exception e) {\n                    // \u5F02\u6B65\u5931\u8D25\u4E0D\u5F71\u54CD\u4E3B\u6D41\u7A0B\n                }\n            });\n        }\n    }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u4E00\u81F4\u6027\u5904\u7406\u7B56\u7565"}),"\uFF1A"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5F3A\u4E00\u81F4\u6027"}),"\uFF1A\u540C\u6B65\u5199\u5165\u6240\u6709\u8282\u70B9\uFF0C\u786E\u4FDD\u6570\u636E\u4E00\u81F4"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6700\u7EC8\u4E00\u81F4\u6027"}),"\uFF1A\u5F02\u6B65\u590D\u5236\uFF0C\u63A5\u53D7\u77ED\u6682\u4E0D\u4E00\u81F4"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7248\u672C\u63A7\u5236"}),"\uFF1A\u4F7F\u7528\u7248\u672C\u53F7\u68C0\u6D4B\u51B2\u7A81"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5931\u6548\u7B56\u7565"}),"\uFF1A\u8BBE\u7F6E\u5408\u7406\u7684\u7F13\u5B58\u5931\u6548\u65F6\u95F4"]}),"\n"]}),"\n",(0,r.jsx)(e.admonition,{title:"\u5206\u5E03\u5F0F\u7CFB\u7EDF\u5B66\u4E60\u8981\u70B9",type:"tip",children:(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7406\u89E3CAP\u5B9A\u7406"}),"\uFF1A\u8FD9\u662F\u5206\u5E03\u5F0F\u7CFB\u7EDF\u8BBE\u8BA1\u7684\u7406\u8BBA\u57FA\u7840"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u638C\u63E1\u4E00\u81F4\u6027\u6A21\u578B"}),"\uFF1A\u6839\u636E\u4E1A\u52A1\u9700\u6C42\u9009\u62E9\u5408\u9002\u7684\u4E00\u81F4\u6027\u7EA7\u522B"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u719F\u6089\u5171\u8BC6\u7B97\u6CD5"}),"\uFF1A\u7406\u89E3Paxos\u3001Raft\u7B49\u7B97\u6CD5\u7684\u539F\u7406"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5B9E\u8DF5\u5DE5\u7A0B\u7ECF\u9A8C"}),"\uFF1A\u5728\u5B9E\u9645\u9879\u76EE\u4E2D\u5E94\u7528\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7406\u8BBA"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6301\u7EED\u5B66\u4E60"}),"\uFF1A\u5206\u5E03\u5F0F\u7CFB\u7EDF\u6280\u672F\u4E0D\u65AD\u53D1\u5C55\uFF0C\u9700\u8981\u6301\u7EED\u5B66\u4E60"]}),"\n"]})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.p,{children:"\u901A\u8FC7\u672C\u7AE0\u7684\u5B66\u4E60\uFF0C\u4F60\u5E94\u8BE5\u5DF2\u7ECF\u638C\u63E1\u4E86\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u6838\u5FC3\u7406\u8BBA\u3001\u8BBE\u8BA1\u539F\u5219\u548C\u5DE5\u7A0B\u5B9E\u8DF5\u3002\u5206\u5E03\u5F0F\u7CFB\u7EDF\u662F\u73B0\u4EE3\u4E92\u8054\u7F51\u5E94\u7528\u7684\u57FA\u7840\uFF0C\u7406\u89E3\u8FD9\u4E9B\u7406\u8BBA\u5BF9\u4E8E\u6784\u5EFA\u9AD8\u53EF\u7528\u3001\u9AD8\u6027\u80FD\u7684\u7CFB\u7EDF\u81F3\u5173\u91CD\u8981\u3002\u5728\u5B9E\u9645\u9879\u76EE\u4E2D\uFF0C\u8981\u6839\u636E\u5177\u4F53\u9700\u6C42\u9009\u62E9\u5408\u9002\u7684\u7406\u8BBA\u548C\u6280\u672F\uFF0C\u5E76\u5728\u5B9E\u8DF5\u4E2D\u4E0D\u65AD\u4F18\u5316\u548C\u6539\u8FDB\u3002"})]})}function h(n={}){let{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}},28453:function(n,e,i){i.d(e,{R:()=>l,x:()=>a});var t=i(96540);let r={},s=t.createContext(r);function l(n){let e=t.useContext(s);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),t.createElement(s.Provider,{value:e},n.children)}}}]);