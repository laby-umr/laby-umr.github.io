<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-backend/distributed-systems/distributed-search" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>分布式搜索引擎详解 | Laby的博客</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true property=og:image content=https://laby-umr.github.io/en/img/docusaurus-social-card.jpg /><meta data-rh=true name=twitter:image content=https://laby-umr.github.io/en/img/docusaurus-social-card.jpg /><meta data-rh=true property=og:url content=https://laby-umr.github.io/en/docs/backend/distributed-systems/distributed-search /><meta data-rh=true property=og:locale content=en /><meta data-rh=true property=og:locale:alternate content=zh_Hans /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=keywords content="blog, javascript, typescript, react, vue, java, spring, 前端, 后端, 全栈开发"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:type content=website /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="分布式搜索引擎详解 | Laby的博客"/><meta data-rh=true name=description content=深入理解Elasticsearch、Solr等分布式搜索引擎的架构、原理与最佳实践 /><meta data-rh=true property=og:description content=深入理解Elasticsearch、Solr等分布式搜索引擎的架构、原理与最佳实践 /><link data-rh=true rel=icon href=/en/img/logo.jpg /><link data-rh=true rel=canonical href=https://laby-umr.github.io/en/docs/backend/distributed-systems/distributed-search /><link data-rh=true rel=alternate href=https://laby-umr.github.io/docs/backend/distributed-systems/distributed-search hreflang=zh-Hans /><link data-rh=true rel=alternate href=https://laby-umr.github.io/en/docs/backend/distributed-systems/distributed-search hreflang=en /><link data-rh=true rel=alternate href=https://laby-umr.github.io/docs/backend/distributed-systems/distributed-search hreflang=x-default /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://laby-umr.github.io/en/docs/backend","name":"Backend Development","position":1},{"@type":"ListItem","item":"https://laby-umr.github.io/en/docs/backend/distributed-systems/distributed-search","name":"分布式搜索引擎详解","position":2}]}</script><link rel=alternate type=application/rss+xml href=/en/blog/rss.xml title="Laby的博客 RSS Feed"><link rel=alternate type=application/atom+xml href=/en/blog/atom.xml title="Laby的博客 Atom Feed"><link rel=alternate type=application/json href=/en/blog/feed.json title="Laby的博客 JSON Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-03NXQZ7S0Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-03NXQZ7S0Z",{anonymize_ip:!0})</script><link rel=icon href=/en/img/logo.jpg><link rel=manifest href=/en/manifest.json><meta name=theme-color content=#667eea><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=black-translucent><link rel=apple-touch-icon href=/en/img/logo.jpg><script>window.blogApiConfig={apiBaseUrl:"http://120.48.86.168:48080"}</script><link rel=dns-prefetch href=http://120.48.86.168:48080><link rel=preconnect href=http://120.48.86.168:48080 crossorigin=anonymous><link rel=stylesheet href=/en/assets/css/styles.a3cb8417.css /><script src=/en/assets/js/runtime~main.c547e4ce.js defer></script><script src=/en/assets/js/main.7712110c.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id=__docusaurus><link rel=preload as=image href=/en/img/logo.jpg /><link rel=preload as=image href=/img/head.jpg /><link rel=preload as=image href=/img/user/WeChat.png /><div class=progressBar_BgkN style="width:0%;height:3px;background:linear-gradient(90deg, #667eea 0%, #764ba2 100%);position:fixed;top:0;left:0;z-index:9999;transition:width 0.2s ease"></div><canvas style=position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none></canvas><div class=progressBar_BgkN style="width:0%;height:3px;background:linear-gradient(90deg, #667eea 0%, #764ba2 100%);position:fixed;top:0;left:0;z-index:9999;transition:width 0.2s ease"></div><div class=target-cursor-wrapper><div class=target-cursor-dot></div><div class="target-cursor-corner corner-tl"></div><div class="target-cursor-corner corner-tr"></div><div class="target-cursor-corner corner-br"></div><div class="target-cursor-corner corner-bl"></div></div><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style=background-color:#667eea;color:#ffffff role=banner><div class=announcementBarPlaceholder_vyr4></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ 如果觉得这个项目对你有帮助，请给个 <a target=_blank rel="noopener noreferrer" href=https://github.com/laby-umr/laby-umr.github.io>Star</a> 支持一下！</div><button type=button aria-label=Close class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width=14 height=14><g stroke=currentColor stroke-width=3.1><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"/></g></svg></button></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/en/><div class=navbar__logo><img src=/en/img/logo.jpg alt="Laby's Blog Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/en/img/logo.jpg alt="Laby's Blog Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div><b class="navbar__title text--truncate">Laby's Blog</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/en/docs/intro>Knowledge Base</a><a class="navbar__item navbar__link" href=/en/blog>Blog</a><a class="navbar__item navbar__link" href=/en/projects>Projects</a><a class="navbar__item navbar__link" href=/en/music>音乐</a><a class="navbar__item navbar__link" href=/en/contact>Contact Me</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href=/en/about>About Me</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>English</a><ul class=dropdown__menu><li><a href=/docs/backend/distributed-systems/distributed-search target=_self rel="noopener noreferrer" class=dropdown__link lang=zh-Hans>简体中文</a><li><a href=/en/docs/backend/distributed-systems/distributed-search target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=en>English</a></ul></div><a href=https://github.com/MasterLiu93 target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class="navbar__search searchBarContainer_NW3z" dir=ltr><input placeholder=Search aria-label=Search class="navbar__search-input searchInput_YFbd" value="" /><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/en/docs/intro><span title=知识库导航 class=linkLabel_WmDU>知识库导航</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/en/docs/frontend><span title="Frontend Development" class=categoryLinkLabel_W154>Frontend Development</span></a><button aria-label="Expand sidebar category 'Frontend Development'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href=/en/docs/backend><span title="Backend Development" class=categoryLinkLabel_W154>Backend Development</span></a><button aria-label="Collapse sidebar category 'Backend Development'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/backend/backend-intro><span title=后端开发知识体系 class=linkLabel_WmDU>后端开发知识体系</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/java-basics/data-types><span title="Java Basics" class=categoryLinkLabel_W154>Java Basics</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/java-collections/collection-interface><span title="Java Collections Framework" class=categoryLinkLabel_W154>Java Collections Framework</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/concurrency/thread-basics><span title="Concurrent Programming" class=categoryLinkLabel_W154>Concurrent Programming</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/jvm/memory-model><span title=JVM class=categoryLinkLabel_W154>JVM</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/spring/ioc><span title="Spring Framework" class=categoryLinkLabel_W154>Spring Framework</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/database-orm/database-intro><span title="Database and ORM" class=categoryLinkLabel_W154>Database and ORM</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/microservices/service-discovery><span title=Microservices class=categoryLinkLabel_W154>Microservices</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/en/docs/backend/distributed-systems/distributed-theory><span title="Distributed Systems" class=categoryLinkLabel_W154>Distributed Systems</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/backend/distributed-systems/distributed-theory><span title=分布式系统理论基础详解 class=linkLabel_WmDU>分布式系统理论基础详解</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/backend/distributed-systems/distributed-cache><span title=分布式缓存架构详解 class=linkLabel_WmDU>分布式缓存架构详解</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/backend/distributed-systems/distributed-lock><span title=分布式锁实现方案详解 class=linkLabel_WmDU>分布式锁实现方案详解</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/backend/distributed-systems/distributed-transaction><span title=分布式事务解决方案详解 class=linkLabel_WmDU>分布式事务解决方案详解</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/en/docs/backend/distributed-systems/distributed-search><span title=分布式搜索引擎详解 class=linkLabel_WmDU>分布式搜索引擎详解</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/message-queues/kafka><span title="Message Queues" class=categoryLinkLabel_W154>Message Queues</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/network-programming/tcp-ip><span title="Network Programming" class=categoryLinkLabel_W154>Network Programming</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/design-patterns/code-quality-intro><span title="Design Patterns" class=categoryLinkLabel_W154>Design Patterns</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/big-data/big-data-intro><span title="Big Data Technologies" class=categoryLinkLabel_W154>Big Data Technologies</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/en/docs/backend/system-design/devops-intro><span title="System Design" class=categoryLinkLabel_W154>System Design</span></a></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/en/docs/digital-twin/digital-twin-intro><span title="Digital Twin" class=categoryLinkLabel_W154>Digital Twin</span></a><button aria-label="Expand sidebar category 'Digital Twin'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/en/docs/projectDesign/project-design-intro><span title="Project Design" class=categoryLinkLabel_W154>Project Design</span></a><button aria-label="Expand sidebar category 'Project Design'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/en/docs/document-template/template-index><span title="Document Templates" class=categoryLinkLabel_W154>Document Templates</span></a><button aria-label="Expand sidebar category 'Document Templates'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/en/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/en/docs/backend><span>Backend Development</span></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Distributed Systems</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>分布式搜索引擎详解</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>分布式搜索引擎详解</h1></header>
<p>分布式搜索引擎是现代互联网应用中不可或缺的基础设施，它能够处理海量数据的快速检索、分析和聚合。本章将深入探讨Elasticsearch、Solr等主流分布式搜索引擎的核心概念、架构设计和工程实践。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>应用场景</div><div class=admonitionContent_BuS1><p>分布式搜索引擎广泛应用于：<ul>
<li class="">电商商品搜索与推荐</li>
<li class="">日志分析与监控</li>
<li class="">内容管理系统</li>
<li class="">企业知识库</li>
<li class="">实时数据分析</li>
<li class="">地理位置服务</li>
</ul></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=1-elasticsearch-核心架构>1. Elasticsearch 核心架构<a href=#1-elasticsearch-核心架构 class=hash-link aria-label="Direct link to 1. Elasticsearch 核心架构" title="Direct link to 1. Elasticsearch 核心架构" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=11-基本概念与组件>1.1 基本概念与组件<a href=#11-基本概念与组件 class=hash-link aria-label="Direct link to 1.1 基本概念与组件" title="Direct link to 1.1 基本概念与组件" translate=no>​</a></h3>
<p>Elasticsearch是一个基于Lucene的分布式搜索引擎，采用RESTful API设计，支持实时搜索和分析。</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=核心组件架构>核心组件架构<a href=#核心组件架构 class=hash-link aria-label="Direct link to 核心组件架构" title="Direct link to 核心组件架构" translate=no>​</a></h4>
<!-- -->
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=核心概念详解>核心概念详解<a href=#核心概念详解 class=hash-link aria-label="Direct link to 核心概念详解" title="Direct link to 核心概念详解" translate=no>​</a></h4>
<table><thead><tr><th>概念<th>定义<th>作用<th>示例<tbody><tr><td><strong>Index（索引）</strong><td>逻辑上的数据容器，类似数据库中的表<td>组织和管理文档集合<td><code>products</code>、<code>users</code>、<code>logs</code><tr><td><strong>Document（文档）</strong><td>JSON格式的数据单元，类似数据库中的行<td>存储具体的数据内容<td><code>{"id": 1, "name": "iPhone", "price": 999}</code><tr><td><strong>Field（字段）</strong><td>文档中的具体属性，类似数据库中的列<td>定义数据的结构和类型<td><code>name</code>、<code>price</code>、<code>created_at</code><tr><td><strong>Shard（分片）</strong><td>索引的物理分割，分为Primary和Replica<td>实现水平扩展和负载均衡<td>每个索引可以有多个分片<tr><td><strong>Replica（副本）</strong><td>分片的备份，提供高可用和读性能<td>故障恢复和读取负载分担<td>每个分片可以有多个副本</table>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>分片策略</div><div class=admonitionContent_BuS1><ul>
<li class=""><strong>Primary Shard（主分片）</strong>：负责处理写请求，数量在索引创建时确定且不可更改</li>
<li class=""><strong>Replica Shard（副本分片）</strong>：主分片的备份，可以动态调整数量</li>
<li class=""><strong>分片数量建议</strong>：<code>分片数 = 节点数 × 每个节点可承载的分片数</code></li>
</ul></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=12-倒排索引机制>1.2 倒排索引机制<a href=#12-倒排索引机制 class=hash-link aria-label="Direct link to 1.2 倒排索引机制" title="Direct link to 1.2 倒排索引机制" translate=no>​</a></h3>
<p>倒排索引是搜索引擎的核心数据结构，它将文档中的词项映射到包含该词项的文档列表。</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=倒排索引构建过程>倒排索引构建过程<a href=#倒排索引构建过程 class=hash-link aria-label="Direct link to 倒排索引构建过程" title="Direct link to 倒排索引构建过程" translate=no>​</a></h4>
<!-- -->
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=倒排索引示例>倒排索引示例<a href=#倒排索引示例 class=hash-link aria-label="Direct link to 倒排索引示例" title="Direct link to 倒排索引示例" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-text"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 640 512" class=langIcon_gX7_><path fill=currentColor d="M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"/></svg><span>text</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-text codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token plain">原始文档：</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">Doc1: "Elasticsearch is a search engine"</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">Doc2: "Elasticsearch is distributed"</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">Doc3: "Search engine is powerful"</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain" style=display:inline-block></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">倒排索引：</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">elasticsearch -> [Doc1, Doc2]</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">search -> [Doc1, Doc3]</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">engine -> [Doc1, Doc3]</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">is -> [Doc1, Doc2, Doc3]</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">a -> [Doc1]</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">distributed -> [Doc2]</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">powerful -> [Doc3]</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=倒排索引的优势>倒排索引的优势<a href=#倒排索引的优势 class=hash-link aria-label="Direct link to 倒排索引的优势" title="Direct link to 倒排索引的优势" translate=no>​</a></h4>
<ul>
<li class=""><strong>快速查找</strong>：O(1)时间复杂度找到包含特定词项的文档</li>
<li class=""><strong>支持复杂查询</strong>：布尔查询、短语查询、模糊查询等</li>
<li class=""><strong>高效聚合</strong>：基于词项的统计和分析操作</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=13-分词器analyzer>1.3 分词器（Analyzer）<a href=#13-分词器analyzer class=hash-link aria-label="Direct link to 1.3 分词器（Analyzer）" title="Direct link to 1.3 分词器（Analyzer）" translate=no>​</a></h3>
<p>分词器负责将文本转换为词项，是搜索质量的关键因素。</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=分词器组成>分词器组成<a href=#分词器组成 class=hash-link aria-label="Direct link to 分词器组成" title="Direct link to 分词器组成" translate=no>​</a></h4>
<!-- -->
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=内置分词器对比>内置分词器对比<a href=#内置分词器对比 class=hash-link aria-label="Direct link to 内置分词器对比" title="Direct link to 内置分词器对比" translate=no>​</a></h4>
<table><thead><tr><th>分词器<th>特点<th>适用场景<th>示例<tbody><tr><td><strong>Standard</strong><td>标准分词，按空格和标点分割<td>英文文本<td>"Quick brown fox" → ["Quick", "brown", "fox"]<tr><td><strong>Simple</strong><td>按非字母字符分割<td>简单分词<td>"Quick-brown_fox" → ["Quick", "brown", "fox"]<tr><td><strong>Whitespace</strong><td>按空白字符分割<td>保留原始格式<td>"Quick brown fox" → ["Quick", "brown", "fox"]<tr><td><strong>Stop</strong><td>移除停用词<td>减少索引大小<td>"The quick brown fox" → ["quick", "brown", "fox"]<tr><td><strong>Keyword</strong><td>不分词，整体索引<td>精确匹配<td>"Quick brown fox" → ["Quick brown fox"]</table>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=自定义分词器配置>自定义分词器配置<a href=#自定义分词器配置 class=hash-link aria-label="Direct link to 自定义分词器配置" title="Direct link to 自定义分词器配置" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>自定义分词器示例</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"settings"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"analysis"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"analyzer"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"my_custom_analyzer"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"custom"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"char_filter"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"html_strip"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"tokenizer"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"standard"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"filter"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"lowercase"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"my_stop_words"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"filter"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"my_stop_words"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"stop"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"stopwords"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"the"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"a"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"an"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>19</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>20</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=2-elasticsearch-索引管理>2. Elasticsearch 索引管理<a href=#2-elasticsearch-索引管理 class=hash-link aria-label="Direct link to 2. Elasticsearch 索引管理" title="Direct link to 2. Elasticsearch 索引管理" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=21-索引创建与配置>2.1 索引创建与配置<a href=#21-索引创建与配置 class=hash-link aria-label="Direct link to 2.1 索引创建与配置" title="Direct link to 2.1 索引创建与配置" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=索引创建示例>索引创建示例<a href=#索引创建示例 class=hash-link aria-label="Direct link to 索引创建示例" title="Direct link to 索引创建示例" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>创建产品索引</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token plain">PUT /products</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"settings"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"number_of_shards"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"number_of_replicas"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"refresh_interval"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"1s"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"analysis"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"analyzer"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"product_analyzer"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"custom"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"tokenizer"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"standard"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"filter"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"lowercase"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"stemmer"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"mappings"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"properties"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>19</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"id"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>20</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"keyword"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>21</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>22</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"name"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>23</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"text"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>24</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"analyzer"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"product_analyzer"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>25</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"search_analyzer"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"product_analyzer"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>26</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"fields"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>27</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"keyword"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>28</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"keyword"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>29</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token property">"ignore_above"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">256</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>30</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>31</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>32</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>33</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"description"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>34</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"text"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>35</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"analyzer"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"product_analyzer"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>36</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>37</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>38</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"double"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>39</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>40</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"category"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>41</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"keyword"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>42</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>43</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"tags"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>44</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"keyword"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>45</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>46</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"created_at"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>47</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"date"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>48</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"format"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>49</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>50</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"location"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>51</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"geo_point"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>52</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>53</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>54</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>55</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=字段类型详解>字段类型详解<a href=#字段类型详解 class=hash-link aria-label="Direct link to 字段类型详解" title="Direct link to 字段类型详解" translate=no>​</a></h4>
<table><thead><tr><th>字段类型<th>用途<th>特点<th>示例<tbody><tr><td><strong>text</strong><td>全文搜索字段<td>会被分词，支持全文搜索<td>商品名称、描述<tr><td><strong>keyword</strong><td>精确匹配字段<td>不分词，用于聚合和过滤<td>商品ID、分类、标签<tr><td><strong>long/double</strong><td>数值字段<td>支持范围查询和聚合<td>价格、数量、评分<tr><td><strong>date</strong><td>日期字段<td>支持日期范围查询<td>创建时间、更新时间<tr><td><strong>geo_point</strong><td>地理位置<td>支持地理距离查询<td>用户位置、商店地址<tr><td><strong>nested</strong><td>嵌套对象<td>保持对象内部关系<td>订单中的商品列表<tr><td><strong>object</strong><td>对象字段<td>扁平化存储<td>用户信息对象</table>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 16 16"><path fill-rule=evenodd d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg></span>映射设计注意事项</div><div class=admonitionContent_BuS1><ol>
<li class=""><strong>避免映射爆炸</strong>：控制字段数量，避免动态映射产生过多字段</li>
<li class=""><strong>合理使用keyword</strong>：需要精确匹配或聚合的字段使用keyword类型</li>
<li class=""><strong>多字段映射</strong>：为text字段添加keyword子字段，支持精确匹配</li>
<li class=""><strong>日期格式</strong>：明确指定日期格式，避免解析错误</li>
</ol></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=22-文档操作>2.2 文档操作<a href=#22-文档操作 class=hash-link aria-label="Direct link to 2.2 文档操作" title="Direct link to 2.2 文档操作" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=索引文档>索引文档<a href=#索引文档 class=hash-link aria-label="Direct link to 索引文档" title="Direct link to 索引文档" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>索引单个文档</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token plain">PUT /products/_doc/</span><span class="token number">1</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"id"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"P001"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"name"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"iPhone 15 Pro"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"description"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"最新款iPhone，搭载A17 Pro芯片"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">999.99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"category"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"electronics"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"tags"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"smartphone"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"apple"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"5g"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"created_at"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"2024-01-15T10:30:00"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"location"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"lat"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">37.7749</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"lon"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">-122.4194</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=批量操作>批量操作<a href=#批量操作 class=hash-link aria-label="Direct link to 批量操作" title="Direct link to 批量操作" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>批量索引文档</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token plain">POST /_bulk</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"index"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"_index"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"products"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"_id"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"1"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"id"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"P001"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"name"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"iPhone 15 Pro"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">999.99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"index"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"_index"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"products"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"_id"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"2"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"id"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"P002"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"name"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Samsung Galaxy S24"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">899.99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"index"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"_index"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"products"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"_id"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"3"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"id"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"P003"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"name"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"MacBook Pro"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1999.99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=更新文档>更新文档<a href=#更新文档 class=hash-link aria-label="Direct link to 更新文档" title="Direct link to 更新文档" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>更新文档</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token plain">POST /products/_update/</span><span class="token number">1</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"doc"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">899.99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"updated_at"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"2024-01-16T14:20:00"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=3-查询与搜索>3. 查询与搜索<a href=#3-查询与搜索 class=hash-link aria-label="Direct link to 3. 查询与搜索" title="Direct link to 3. 查询与搜索" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=31-查询dsl基础>3.1 查询DSL基础<a href=#31-查询dsl基础 class=hash-link aria-label="Direct link to 3.1 查询DSL基础" title="Direct link to 3.1 查询DSL基础" translate=no>​</a></h3>
<p>Elasticsearch提供了丰富的查询DSL（Domain Specific Language），支持各种复杂的搜索需求。</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=查询结构>查询结构<a href=#查询结构 class=hash-link aria-label="Direct link to 查询结构" title="Direct link to 查询结构" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>基本查询结构</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"query"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"查询类型"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"字段"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"查询值"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"sort"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"字段"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"order"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"desc"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"from"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"size"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"_source"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"字段1"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"字段2"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=常用查询类型>常用查询类型<a href=#常用查询类型 class=hash-link aria-label="Direct link to 常用查询类型" title="Direct link to 常用查询类型" translate=no>​</a></h4>
<table><thead><tr><th>查询类型<th>用途<th>特点<th>示例<tbody><tr><td><strong>match</strong><td>全文搜索<td>对字段进行分词匹配<td><code>{"match": {"name": "iPhone"}}</code><tr><td><strong>term</strong><td>精确匹配<td>不分词，精确匹配词项<td><code>{"term": {"category": "electronics"}}</code><tr><td><strong>range</strong><td>范围查询<td>数值、日期范围查询<td><code>{"range": {"price": {"gte": 100, "lte": 1000}}}</code><tr><td><strong>exists</strong><td>存在性查询<td>检查字段是否存在<td><code>{"exists": {"field": "description"}}</code><tr><td><strong>wildcard</strong><td>通配符查询<td>支持*和?通配符<td><code>{"wildcard": {"name": "iPhone*"}}</code><tr><td><strong>fuzzy</strong><td>模糊查询<td>支持拼写错误容错<td><code>{"fuzzy": {"name": "iphne"}}</code></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=32-复合查询>3.2 复合查询<a href=#32-复合查询 class=hash-link aria-label="Direct link to 3.2 复合查询" title="Direct link to 3.2 复合查询" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=布尔查询bool-query>布尔查询（Bool Query）<a href=#布尔查询bool-query class=hash-link aria-label="Direct link to 布尔查询（Bool Query）" title="Direct link to 布尔查询（Bool Query）" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>复杂布尔查询</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"query"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"bool"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"must"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"match"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"iPhone"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"range"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"gte"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">500</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"lte"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1500</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"should"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"match"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"description"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"5g"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"term"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"tags"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"apple"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"must_not"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"term"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"category"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"accessories"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"filter"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"range"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"created_at"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"gte"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"2024-01-01"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"minimum_should_match"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>19</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>20</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>21</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=布尔查询子句说明>布尔查询子句说明<a href=#布尔查询子句说明 class=hash-link aria-label="Direct link to 布尔查询子句说明" title="Direct link to 布尔查询子句说明" translate=no>​</a></h4>
<table><thead><tr><th>子句<th>作用<th>评分影响<th>缓存<tbody><tr><td><strong>must</strong><td>必须匹配，相当于AND<td>影响评分<td>可缓存<tr><td><strong>should</strong><td>应该匹配，相当于OR<td>影响评分<td>可缓存<tr><td><strong>must_not</strong><td>必须不匹配，相当于NOT<td>不影响评分<td>可缓存<tr><td><strong>filter</strong><td>过滤条件，不影响评分<td>不影响评分<td>可缓存</table>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>查询优化建议</div><div class=admonitionContent_BuS1><ol>
<li class=""><strong>使用filter</strong>：不需要评分的条件使用filter，提高性能</li>
<li class=""><strong>合理使用should</strong>：设置<code>minimum_should_match</code>控制匹配度</li>
<li class=""><strong>避免深度嵌套</strong>：过深的嵌套查询影响性能</li>
<li class=""><strong>使用查询缓存</strong>：filter查询结果会被缓存</li>
</ol></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=33-聚合查询>3.3 聚合查询<a href=#33-聚合查询 class=hash-link aria-label="Direct link to 3.3 聚合查询" title="Direct link to 3.3 聚合查询" translate=no>​</a></h3>
<p>聚合查询用于对数据进行统计分析，支持多种聚合类型。</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=指标聚合metrics-aggregations>指标聚合（Metrics Aggregations）<a href=#指标聚合metrics-aggregations class=hash-link aria-label="Direct link to 指标聚合（Metrics Aggregations）" title="Direct link to 指标聚合（Metrics Aggregations）" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>指标聚合示例</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"size"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"aggs"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"avg_price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"avg"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"price"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"max_price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"max"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"price"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"min_price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"min"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"price"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"price_stats"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"stats"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"price"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"price_percentiles"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"percentiles"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"price"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>19</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"percents"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">25</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">75</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">95</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>20</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>21</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>22</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>23</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=桶聚合bucket-aggregations>桶聚合（Bucket Aggregations）<a href=#桶聚合bucket-aggregations class=hash-link aria-label="Direct link to 桶聚合（Bucket Aggregations）" title="Direct link to 桶聚合（Bucket Aggregations）" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>桶聚合示例</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"size"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"aggs"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"categories"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"terms"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"category"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"size"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"aggs"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"avg_price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"avg"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"price"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"price_ranges"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"range"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"price"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"ranges"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>19</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"to"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>20</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"from"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"to"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">500</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>21</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"from"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">500</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"to"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>22</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"from"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>23</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>24</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>25</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>26</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"price_histogram"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>27</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"histogram"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>28</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"price"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>29</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"interval"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">100</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>30</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>31</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>32</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>33</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=管道聚合pipeline-aggregations>管道聚合（Pipeline Aggregations）<a href=#管道聚合pipeline-aggregations class=hash-link aria-label="Direct link to 管道聚合（Pipeline Aggregations）" title="Direct link to 管道聚合（Pipeline Aggregations）" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>管道聚合示例</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"size"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"aggs"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"categories"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"terms"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"category"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"aggs"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"avg_price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"avg"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"price"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"price_diff"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"bucket_script"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token property">"buckets_path"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">              </span><span class="token property">"avg_price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"avg_price"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token property">"script"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"params.avg_price - 500"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>19</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>20</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>21</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=34-高亮与建议>3.4 高亮与建议<a href=#34-高亮与建议 class=hash-link aria-label="Direct link to 3.4 高亮与建议" title="Direct link to 3.4 高亮与建议" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=高亮查询>高亮查询<a href=#高亮查询 class=hash-link aria-label="Direct link to 高亮查询" title="Direct link to 高亮查询" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>高亮查询示例</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"query"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"match"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"description"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"iPhone"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"highlight"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"fields"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"name"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"pre_tags"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"&lt;em>"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"post_tags"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"&lt;/em>"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"fragment_size"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">150</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"number_of_fragments"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"description"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"pre_tags"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"&lt;strong>"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"post_tags"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"&lt;/strong>"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>19</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=搜索建议>搜索建议<a href=#搜索建议 class=hash-link aria-label="Direct link to 搜索建议" title="Direct link to 搜索建议" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>搜索建议示例</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"suggest"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"product_suggest"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"prefix"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"iph"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"completion"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"name_suggest"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"size"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"term_suggest"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"text"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"iphne"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"term"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"field"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"name"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"suggest_mode"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"always"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=4-性能优化与调优>4. 性能优化与调优<a href=#4-性能优化与调优 class=hash-link aria-label="Direct link to 4. 性能优化与调优" title="Direct link to 4. 性能优化与调优" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=41-索引性能优化>4.1 索引性能优化<a href=#41-索引性能优化 class=hash-link aria-label="Direct link to 4.1 索引性能优化" title="Direct link to 4.1 索引性能优化" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=批量写入优化>批量写入优化<a href=#批量写入优化 class=hash-link aria-label="Direct link to 批量写入优化" title="Direct link to 批量写入优化" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-java"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>批量写入示例</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M277.74 312.9c9.8-6.7 23.4-12.5 23.4-12.5s-38.7 7-77.2 10.2c-47.1 3.9-97.7 4.7-123.1 1.3-60.1-8 33-30.1 33-30.1s-36.1-2.4-80.6 19c-52.5 25.4 130 37 224.5 12.1zm-85.4-32.1c-19-42.7-83.1-80.2 0-145.8C296 45.2 242.8 8.1 242.8 8.1s12.7 50.9-23.5 79.4c-60.3 47.5-78.2-12.6-78.2-12.6-117.2 68.1 38.4 69.6 51.3 93.4 22.9 41.5-40.2 104.8-80.4 93.7-9-2.5 5.2 9.6 19.5 19.4 20.8 14.3 76.1 20.5 116.2-2.8 31.3-18.1-11.7-53.8-23.5-70.7zM381 261.1c-15.6-5.9-37.8-6.6-37.8-6.6s9.4-28.4-37.3-42.3c-94.4-28.3-189 11.5-189 11.5s52.9 47.3 138.2 35c16.6-2.4 51-13.1 51-13.1s-23.8 6.1-32.7 12.1c-223.1 62.2-75.6-7.5-75.6-7.5s19 10.7 50.9 12.8c116.2 8.1 117.1-35.9 132.3-2.9zM239 64.7c-56.6 19.6-49.4 42.6-49.4 42.6 49.3-32 121.4-22.3 121.4-22.3s-23.1-10.1-72 -20.3zm-99.6 23.6c27.8-15.7 49.9-8 49.9-8s-28.6-15.9-60.4-7.6c-21.1 5.6-14.8 23.7-14.8 23.7s5-9.4 25.3-8.1zm146.4 44.6c-39.4 13-43.6 61.5-43.6 61.5s75-36.4 43.6-61.5z"/></svg><span>java</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-java codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">BulkIndexer</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">final</span><span class="token plain"> </span><span class="token class-name">RestHighLevelClient</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">final</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> indexName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">final</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> batchSize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">final</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token generics class-name">IndexRequest</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"> batch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">    </span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> </span><span class="token class-name">BulkIndexer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">RestHighLevelClient</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> indexName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> batchSize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">client </span><span class="token operator">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">indexName </span><span class="token operator">=</span><span class="token plain"> indexName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">batchSize </span><span class="token operator">=</span><span class="token plain"> batchSize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">batch </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">    </span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token class-name">Map</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token generics class-name">String</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token generics"> </span><span class="token generics class-name">Object</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"> document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token class-name">IndexRequest</span><span class="token plain"> request </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">IndexRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">indexName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">source</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain">        batch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>19</span><span class=codeLineContent_HA3z><span class="token plain">        </span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>20</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">batch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">>=</span><span class="token plain"> batchSize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>21</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token function" style="color:rgb(80, 250, 123)">flush</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>22</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>23</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>24</span><span class=codeLineContent_HA3z><span class="token plain">    </span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>25</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">flush</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">throws</span><span class="token plain"> </span><span class="token class-name">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>26</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">batch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">isEmpty</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>27</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>28</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>29</span><span class=codeLineContent_HA3z><span class="token plain">        </span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>30</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token class-name">BulkRequest</span><span class="token plain"> bulkRequest </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">BulkRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>31</span><span class=codeLineContent_HA3z><span class="token plain">        batch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">forEach</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">bulkRequest</span><span class="token operator">::</span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>32</span><span class=codeLineContent_HA3z><span class="token plain">        </span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>33</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token class-name">BulkResponse</span><span class="token plain"> response </span><span class="token operator">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">bulk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">bulkRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token class-name">RequestOptions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token constant" style="color:rgb(189, 147, 249)">DEFAULT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>34</span><span class=codeLineContent_HA3z><span class="token plain">        </span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>35</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">hasFailures</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>36</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token comment" style="color:rgb(98, 114, 164)">// 处理失败的情况</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>37</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">BulkItemResponse</span><span class="token plain"> item </span><span class="token operator">:</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">getItems</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>38</span><span class=codeLineContent_HA3z><span class="token plain">                </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">item</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">isFailed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>39</span><span class=codeLineContent_HA3z><span class="token plain">                    </span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">"Failed to index document: "</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">getFailureMessage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>40</span><span class=codeLineContent_HA3z><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>41</span><span class=codeLineContent_HA3z><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>42</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>43</span><span class=codeLineContent_HA3z><span class="token plain">        </span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>44</span><span class=codeLineContent_HA3z><span class="token plain">        batch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">clear</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>45</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>46</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=索引设置优化>索引设置优化<a href=#索引设置优化 class=hash-link aria-label="Direct link to 索引设置优化" title="Direct link to 索引设置优化" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>写入优化配置</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"settings"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"number_of_shards"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"number_of_replicas"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"refresh_interval"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"30s"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"translog"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"durability"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"async"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"sync_interval"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"5s"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"index"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"max_result_window"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">10000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"mapping"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"nested_fields"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"limit"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">100</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>19</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=42-查询性能优化>4.2 查询性能优化<a href=#42-查询性能优化 class=hash-link aria-label="Direct link to 4.2 查询性能优化" title="Direct link to 4.2 查询性能优化" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=查询优化策略>查询优化策略<a href=#查询优化策略 class=hash-link aria-label="Direct link to 查询优化策略" title="Direct link to 查询优化策略" translate=no>​</a></h4>
<table><thead><tr><th>优化策略<th>说明<th>实现方式<tbody><tr><td><strong>使用filter</strong><td>filter不影响评分，可缓存<td>将不需要评分的条件放在filter中<tr><td><strong>避免深度分页</strong><td>深度分页性能差<td>使用search_after或scroll API<tr><td><strong>合理设置size</strong><td>避免返回过多数据<td>根据实际需求设置合理的size<tr><td><strong>使用_source过滤</strong><td>只返回需要的字段<td>在查询中指定_source字段<tr><td><strong>预热查询</strong><td>将常用查询加入缓存<td>定期执行常用查询</table>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=查询缓存配置>查询缓存配置<a href=#查询缓存配置 class=hash-link aria-label="Direct link to 查询缓存配置" title="Direct link to 查询缓存配置" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>查询缓存优化</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"settings"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"indices"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"queries"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"cache"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"size"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"10%"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"fielddata"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token property">"cache"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">          </span><span class="token property">"size"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"20%"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=43-集群性能调优>4.3 集群性能调优<a href=#43-集群性能调优 class=hash-link aria-label="Direct link to 4.3 集群性能调优" title="Direct link to 4.3 集群性能调优" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=jvm调优>JVM调优<a href=#jvm调优 class=hash-link aria-label="Direct link to JVM调优" title="Direct link to JVM调优" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-bash"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>JVM配置示例</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 448 512" class=langIcon_gX7_><path fill=currentColor d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg><span>bash</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-bash codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token comment" style="color:rgb(98, 114, 164)"># elasticsearch.yml</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-Xms4g</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-Xmx4g</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-XX:+UseG1GC</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-XX:G1HeapRegionSize</span><span class="token operator">=</span><span class="token plain">32m</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-XX:MaxGCPauseMillis</span><span class="token operator">=</span><span class="token number">200</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-XX:+UnlockExperimentalVMOptions</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-XX:+UseCGroupMemoryLimitForHeap</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=操作系统调优>操作系统调优<a href=#操作系统调优 class=hash-link aria-label="Direct link to 操作系统调优" title="Direct link to 操作系统调优" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-bash"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>系统调优命令</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 448 512" class=langIcon_gX7_><path fill=currentColor d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg><span>bash</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-bash codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token comment" style="color:rgb(98, 114, 164)"># 增加文件描述符限制</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"* soft nofile 65536"</span><span class="token plain"> </span><span class="token operator">>></span><span class="token plain"> /etc/security/limits.conf</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"* hard nofile 65536"</span><span class="token plain"> </span><span class="token operator">>></span><span class="token plain"> /etc/security/limits.conf</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain" style=display:inline-block></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 禁用交换</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">swapoff </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain" style=display:inline-block></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 调整虚拟内存</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"vm.max_map_count=262144"</span><span class="token plain"> </span><span class="token operator">>></span><span class="token plain"> /etc/sysctl.conf</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sysctl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span></span></div></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=5-solr-搜索引擎>5. Solr 搜索引擎<a href=#5-solr-搜索引擎 class=hash-link aria-label="Direct link to 5. Solr 搜索引擎" title="Direct link to 5. Solr 搜索引擎" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=51-solr-vs-elasticsearch>5.1 Solr vs Elasticsearch<a href=#51-solr-vs-elasticsearch class=hash-link aria-label="Direct link to 5.1 Solr vs Elasticsearch" title="Direct link to 5.1 Solr vs Elasticsearch" translate=no>​</a></h3>
<table><thead><tr><th>特性<th>Solr<th>Elasticsearch<tbody><tr><td><strong>架构</strong><td>基于Lucene，传统搜索引擎<td>基于Lucene，分布式优先<tr><td><strong>部署</strong><td>需要外部容器（如Tomcat）<td>内置HTTP服务器<tr><td><strong>配置</strong><td>XML配置文件<td>JSON API配置<tr><td><strong>扩展性</strong><td>SolrCloud支持分布式<td>原生分布式支持<tr><td><strong>实时性</strong><td>近实时搜索<td>实时搜索<tr><td><strong>生态</strong><td>成熟的企业级生态<td>更活跃的开源生态</table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=52-solr核心概念>5.2 Solr核心概念<a href=#52-solr核心概念 class=hash-link aria-label="Direct link to 5.2 Solr核心概念" title="Direct link to 5.2 Solr核心概念" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=solr架构图>Solr架构图<a href=#solr架构图 class=hash-link aria-label="Direct link to Solr架构图" title="Direct link to Solr架构图" translate=no>​</a></h4>
<!-- -->
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=solr配置示例>Solr配置示例<a href=#solr配置示例 class=hash-link aria-label="Direct link to Solr配置示例" title="Direct link to Solr配置示例" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-xml"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>solrconfig.xml核心配置</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 640 512" class=langIcon_gX7_><path fill=currentColor d="M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"/></svg><span>xml</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-xml codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">config</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- 查询处理器配置 --></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">requestHandler</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">/select</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">solr.SearchHandler</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">lst</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">defaults</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">str</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">defType</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain">edismax</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">str</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">str</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">qf</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain">name^2.0 description^1.0</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">str</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">str</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">bf</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain">recip(rord(id),1,1000,1000)</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">str</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">lst</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">requestHandler</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">  </span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- 缓存配置 --></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">queryResultCache</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">solr.LRUCache</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">size</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">4096</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">initialSize</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">512</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">autowarmCount</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">documentCache</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">solr.LRUCache</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">size</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">512</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">initialSize</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">512</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">autowarmCount</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">filterCache</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">solr.LRUCache</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">size</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">512</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">initialSize</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">512</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">autowarmCount</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">"</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">  </span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- 自动提交配置 --></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">autoCommit</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">maxTime</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain">15000</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">maxTime</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>19</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">openSearcher</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain">false</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">openSearcher</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>20</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">autoCommit</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>21</span><span class=codeLineContent_HA3z><span class="token plain">  </span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>22</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">autoSoftCommit</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>23</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">maxTime</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain">1000</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">maxTime</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>24</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">autoSoftCommit</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>25</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">config</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">></span></span></div></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=6-监控与运维>6. 监控与运维<a href=#6-监控与运维 class=hash-link aria-label="Direct link to 6. 监控与运维" title="Direct link to 6. 监控与运维" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=61-关键监控指标>6.1 关键监控指标<a href=#61-关键监控指标 class=hash-link aria-label="Direct link to 6.1 关键监控指标" title="Direct link to 6.1 关键监控指标" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=集群健康指标>集群健康指标<a href=#集群健康指标 class=hash-link aria-label="Direct link to 集群健康指标" title="Direct link to 集群健康指标" translate=no>​</a></h4>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockTitle_B2tn>集群健康检查</div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token plain">GET /_cluster/health?pretty</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"cluster_name"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"elasticsearch"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"status"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"green"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"timed_out"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"number_of_nodes"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"number_of_data_nodes"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"active_primary_shards"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">15</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"active_shards"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">30</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"relocating_shards"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"initializing_shards"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"unassigned_shards"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"delayed_unassigned_shards"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>14</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"number_of_pending_tasks"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>15</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"number_of_in_flight_fetch"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>16</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"task_max_waiting_in_queue_millis"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>17</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"active_shards_percent_as_number"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">100.0</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>18</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=性能监控指标>性能监控指标<a href=#性能监控指标 class=hash-link aria-label="Direct link to 性能监控指标" title="Direct link to 性能监控指标" translate=no>​</a></h4>
<table><thead><tr><th>指标类别<th>关键指标<th>说明<th>告警阈值<tbody><tr><td><strong>查询性能</strong><td>查询延迟<td>查询响应时间<td>P95 > 1s<tr><td><strong>索引性能</strong><td>索引速率<td>每秒索引文档数<td>&lt; 1000 docs/s<tr><td><strong>JVM性能</strong><td>堆内存使用率<td>JVM堆内存使用情况<td>> 85%<tr><td><strong>磁盘性能</strong><td>磁盘使用率<td>磁盘空间使用情况<td>> 80%<tr><td><strong>网络性能</strong><td>网络延迟<td>节点间通信延迟<td>> 100ms</table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=62-常见问题与解决方案>6.2 常见问题与解决方案<a href=#62-常见问题与解决方案 class=hash-link aria-label="Direct link to 6.2 常见问题与解决方案" title="Direct link to 6.2 常见问题与解决方案" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=问题诊断流程>问题诊断流程<a href=#问题诊断流程 class=hash-link aria-label="Direct link to 问题诊断流程" title="Direct link to 问题诊断流程" translate=no>​</a></h4>
<!-- -->
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=7-面试题精选>7. 面试题精选<a href=#7-面试题精选 class=hash-link aria-label="Direct link to 7. 面试题精选" title="Direct link to 7. 面试题精选" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=71-基础概念题>7.1 基础概念题<a href=#71-基础概念题 class=hash-link aria-label="Direct link to 7.1 基础概念题" title="Direct link to 7.1 基础概念题" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=q1-什么是倒排索引它有什么优势>Q1: 什么是倒排索引？它有什么优势？<a href=#q1-什么是倒排索引它有什么优势 class=hash-link aria-label="Direct link to Q1: 什么是倒排索引？它有什么优势？" title="Direct link to Q1: 什么是倒排索引？它有什么优势？" translate=no>​</a></h4>
<p><strong>答</strong>: 倒排索引是搜索引擎的核心数据结构，它将文档中的词项映射到包含该词项的文档列表。</p>
<p><strong>优势</strong>:</p>
<ol>
<li class=""><strong>快速查找</strong>: O(1)时间复杂度找到包含特定词项的文档</li>
<li class=""><strong>支持复杂查询</strong>: 布尔查询、短语查询、模糊查询等</li>
<li class=""><strong>高效聚合</strong>: 基于词项的统计和分析操作</li>
<li class=""><strong>压缩存储</strong>: 支持高效的压缩算法</li>
</ol>
<p><strong>示例</strong>:</p>
<div class="codeBlockContainer_X7hc language-text"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 640 512" class=langIcon_gX7_><path fill=currentColor d="M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"/></svg><span>text</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-text codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token plain">原始文档:</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">Doc1: "Elasticsearch is a search engine"</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">Doc2: "Elasticsearch is distributed"</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain" style=display:inline-block></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">倒排索引:</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">elasticsearch -> [Doc1, Doc2]</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">search -> [Doc1]</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">engine -> [Doc1]</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">is -> [Doc1, Doc2]</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">distributed -> [Doc2]</span></span></div></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=q2-elasticsearch中的分片和副本有什么区别>Q2: Elasticsearch中的分片和副本有什么区别？<a href=#q2-elasticsearch中的分片和副本有什么区别 class=hash-link aria-label="Direct link to Q2: Elasticsearch中的分片和副本有什么区别？" title="Direct link to Q2: Elasticsearch中的分片和副本有什么区别？" translate=no>​</a></h4>
<p><strong>答</strong>:</p>
<ol>
<li class="">
<p><strong>分片（Shard）</strong>:</p>
<ul>
<li class="">索引的物理分割，实现水平扩展</li>
<li class="">分为Primary Shard和Replica Shard</li>
<li class="">Primary Shard数量在索引创建时确定且不可更改</li>
<li class="">每个分片是一个独立的Lucene索引</li>
</ul>
</li>
<li class="">
<p><strong>副本（Replica）</strong>:</p>
<ul>
<li class="">分片的备份，提供高可用性</li>
<li class="">可以动态调整数量</li>
<li class="">提高读取性能，分担读取负载</li>
<li class="">故障恢复时自动提升为Primary</li>
</ul>
</li>
</ol>
<p><strong>最佳实践</strong>:</p>
<ul>
<li class="">分片数量 = 节点数 × 每个节点可承载的分片数</li>
<li class="">副本数量建议为1-2个，平衡可用性和存储成本</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=q3-term查询和match查询的区别是什么>Q3: term查询和match查询的区别是什么？<a href=#q3-term查询和match查询的区别是什么 class=hash-link aria-label="Direct link to Q3: term查询和match查询的区别是什么？" title="Direct link to Q3: term查询和match查询的区别是什么？" translate=no>​</a></h4>
<p><strong>答</strong>:</p>
<ol>
<li class="">
<p><strong>term查询</strong>:</p>
<ul>
<li class="">精确匹配，不分词</li>
<li class="">直接匹配索引中的词项</li>
<li class="">适用于keyword类型字段</li>
<li class="">性能较好，可缓存</li>
</ul>
</li>
<li class="">
<p><strong>match查询</strong>:</p>
<ul>
<li class="">全文搜索，会分词</li>
<li class="">对查询文本进行分词后匹配</li>
<li class="">适用于text类型字段</li>
<li class="">支持相关性评分</li>
</ul>
</li>
</ol>
<p><strong>示例</strong>:</p>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token comment" style="color:rgb(98, 114, 164)">// term查询 - 精确匹配</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"term"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"category"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"electronics"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain" style=display:inline-block></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// match查询 - 全文搜索</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"match"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"description"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"iPhone smartphone"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=72-性能优化题>7.2 性能优化题<a href=#72-性能优化题 class=hash-link aria-label="Direct link to 7.2 性能优化题" title="Direct link to 7.2 性能优化题" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=q4-如何优化elasticsearch的写入性能>Q4: 如何优化Elasticsearch的写入性能？<a href=#q4-如何优化elasticsearch的写入性能 class=hash-link aria-label="Direct link to Q4: 如何优化Elasticsearch的写入性能？" title="Direct link to Q4: 如何优化Elasticsearch的写入性能？" translate=no>​</a></h4>
<p><strong>答</strong>:</p>
<ol>
<li class="">
<p><strong>批量写入</strong>:</p>
<ul>
<li class="">使用bulk API批量索引文档</li>
<li class="">合理设置批量大小（1000-5000条）</li>
<li class="">避免单条写入</li>
</ul>
</li>
<li class="">
<p><strong>索引设置优化</strong>:</p>
<ul>
<li class="">增加<code>refresh_interval</code>（如30s）</li>
<li class="">设置<code>translog.durability</code>为async</li>
<li class="">调整<code>number_of_replicas</code></li>
</ul>
</li>
<li class="">
<p><strong>硬件优化</strong>:</p>
<ul>
<li class="">使用SSD存储</li>
<li class="">增加内存配置</li>
<li class="">优化网络带宽</li>
</ul>
</li>
<li class="">
<p><strong>JVM调优</strong>:</p>
<ul>
<li class="">合理设置堆内存大小</li>
<li class="">使用G1GC垃圾收集器</li>
<li class="">调整GC参数</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=q5-如何优化elasticsearch的查询性能>Q5: 如何优化Elasticsearch的查询性能？<a href=#q5-如何优化elasticsearch的查询性能 class=hash-link aria-label="Direct link to Q5: 如何优化Elasticsearch的查询性能？" title="Direct link to Q5: 如何优化Elasticsearch的查询性能？" translate=no>​</a></h4>
<p><strong>答</strong>:</p>
<ol>
<li class="">
<p><strong>查询优化</strong>:</p>
<ul>
<li class="">使用filter代替query（不影响评分）</li>
<li class="">避免深度分页，使用search_after</li>
<li class="">合理设置size，避免返回过多数据</li>
<li class="">使用_source过滤，只返回需要的字段</li>
</ul>
</li>
<li class="">
<p><strong>索引优化</strong>:</p>
<ul>
<li class="">合理设计mapping</li>
<li class="">避免过多字段</li>
<li class="">使用合适的字段类型</li>
<li class="">定期清理无用索引</li>
</ul>
</li>
<li class="">
<p><strong>缓存优化</strong>:</p>
<ul>
<li class="">启用查询缓存</li>
<li class="">使用fielddata缓存</li>
<li class="">预热常用查询</li>
</ul>
</li>
<li class="">
<p><strong>集群优化</strong>:</p>
<ul>
<li class="">合理分配分片</li>
<li class="">监控节点负载</li>
<li class="">及时扩容</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=73-架构设计题>7.3 架构设计题<a href=#73-架构设计题 class=hash-link aria-label="Direct link to 7.3 架构设计题" title="Direct link to 7.3 架构设计题" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=q6-设计一个电商商品搜索系统需要考虑哪些方面>Q6: 设计一个电商商品搜索系统，需要考虑哪些方面？<a href=#q6-设计一个电商商品搜索系统需要考虑哪些方面 class=hash-link aria-label="Direct link to Q6: 设计一个电商商品搜索系统，需要考虑哪些方面？" title="Direct link to Q6: 设计一个电商商品搜索系统，需要考虑哪些方面？" translate=no>​</a></h4>
<p><strong>答</strong>:</p>
<ol>
<li class="">
<p><strong>索引设计</strong>:</p>
<div class="codeBlockContainer_X7hc language-json"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=langIcon_gX7_><path fill=currentColor d="M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"/></svg><span>json</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-json codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token property">"mappings"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token property">"properties"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"id"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"keyword"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"name"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"text"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token property">"analyzer"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"ik_max_word"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"category"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"keyword"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"brand"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"keyword"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"price"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"double"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"tags"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"keyword"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">      </span><span class="token property">"location"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"geo_point"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>12</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>13</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
</li>
<li class="">
<p><strong>查询功能</strong>:</p>
<ul>
<li class="">全文搜索（商品名称、描述）</li>
<li class="">分类筛选</li>
<li class="">价格范围查询</li>
<li class="">品牌筛选</li>
<li class="">地理位置搜索</li>
<li class="">排序（价格、销量、评分）</li>
</ul>
</li>
<li class="">
<p><strong>性能优化</strong>:</p>
<ul>
<li class="">使用filter缓存分类、品牌等固定条件</li>
<li class="">实现搜索建议</li>
<li class="">支持高亮显示</li>
<li class="">结果聚合（分类统计、价格分布）</li>
</ul>
</li>
<li class="">
<p><strong>高可用设计</strong>:</p>
<ul>
<li class="">多副本部署</li>
<li class="">负载均衡</li>
<li class="">监控告警</li>
<li class="">故障自动恢复</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=q7-如何处理elasticsearch中的数据一致性问题>Q7: 如何处理Elasticsearch中的数据一致性问题？<a href=#q7-如何处理elasticsearch中的数据一致性问题 class=hash-link aria-label="Direct link to Q7: 如何处理Elasticsearch中的数据一致性问题？" title="Direct link to Q7: 如何处理Elasticsearch中的数据一致性问题？" translate=no>​</a></h4>
<p><strong>答</strong>:</p>
<ol>
<li class="">
<p><strong>写入一致性</strong>:</p>
<ul>
<li class="">设置<code>consistency</code>参数（one/quorum/all）</li>
<li class="">使用<code>wait_for_active_shards</code>等待活跃分片</li>
<li class="">实现重试机制</li>
</ul>
</li>
<li class="">
<p><strong>读取一致性</strong>:</p>
<ul>
<li class="">使用<code>preference</code>参数控制读取分片</li>
<li class="">设置<code>timeout</code>避免长时间等待</li>
<li class="">实现读取重试</li>
</ul>
</li>
<li class="">
<p><strong>数据同步</strong>:</p>
<ul>
<li class="">监控副本同步状态</li>
<li class="">定期检查数据一致性</li>
<li class="">实现数据校验机制</li>
</ul>
</li>
<li class="">
<p><strong>故障处理</strong>:</p>
<ul>
<li class="">自动故障转移</li>
<li class="">数据恢复机制</li>
<li class="">监控告警</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=74-运维监控题>7.4 运维监控题<a href=#74-运维监控题 class=hash-link aria-label="Direct link to 7.4 运维监控题" title="Direct link to 7.4 运维监控题" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=q8-如何监控elasticsearch集群的健康状态>Q8: 如何监控Elasticsearch集群的健康状态？<a href=#q8-如何监控elasticsearch集群的健康状态 class=hash-link aria-label="Direct link to Q8: 如何监控Elasticsearch集群的健康状态？" title="Direct link to Q8: 如何监控Elasticsearch集群的健康状态？" translate=no>​</a></h4>
<p><strong>答</strong>:</p>
<ol>
<li class="">
<p><strong>集群健康检查</strong>:</p>
<div class="codeBlockContainer_X7hc language-bash"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 448 512" class=langIcon_gX7_><path fill=currentColor d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg><span>bash</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-bash codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token comment" style="color:rgb(98, 114, 164)"># 检查集群状态</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain">GET /_cluster/health</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain" style=display:inline-block></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 检查节点状态</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain">GET /_nodes/stats</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain" style=display:inline-block></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 检查索引状态</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">GET /_cat/indices?v</span></span></div></code></pre></div></div>
</li>
<li class="">
<p><strong>关键监控指标</strong>:</p>
<ul>
<li class="">集群状态（green/yellow/red）</li>
<li class="">节点数量和数据节点数量</li>
<li class="">分片分配状态</li>
<li class="">JVM堆内存使用率</li>
<li class="">磁盘使用率</li>
</ul>
</li>
<li class="">
<p><strong>性能监控</strong>:</p>
<ul>
<li class="">查询延迟（P50/P95/P99）</li>
<li class="">索引速率</li>
<li class="">缓存命中率</li>
<li class="">GC时间和频率</li>
</ul>
</li>
<li class="">
<p><strong>告警设置</strong>:</p>
<ul>
<li class="">集群状态变为yellow或red</li>
<li class="">节点离线</li>
<li class="">磁盘使用率超过阈值</li>
<li class="">查询延迟超过阈值</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=q9-elasticsearch集群扩容的步骤和注意事项有哪些>Q9: Elasticsearch集群扩容的步骤和注意事项有哪些？<a href=#q9-elasticsearch集群扩容的步骤和注意事项有哪些 class=hash-link aria-label="Direct link to Q9: Elasticsearch集群扩容的步骤和注意事项有哪些？" title="Direct link to Q9: Elasticsearch集群扩容的步骤和注意事项有哪些？" translate=no>​</a></h4>
<p><strong>答</strong>:</p>
<ol>
<li class="">
<p><strong>扩容前准备</strong>:</p>
<ul>
<li class="">评估当前集群负载</li>
<li class="">准备新节点硬件</li>
<li class="">备份重要数据</li>
<li class="">制定扩容计划</li>
</ul>
</li>
<li class="">
<p><strong>扩容步骤</strong>:</p>
<div class="codeBlockContainer_X7hc language-bash"><div class=codeBlockHeader_viex><div class=codeBlockControls_mxj2><span class="codeDot_PWGG codeDotRed_ANoD"></span><span class="codeDot_PWGG codeDotYellow_HH1J"></span><span class="codeDot_PWGG codeDotGreen_RM6U"></span></div><div class=codeBlockMeta_lRk3><div class=codeBlockLanguage_Vqu6><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 448 512" class=langIcon_gX7_><path fill=currentColor d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg><span>bash</span></div><button type=button aria-label=复制代码 class=copyButton_H_xL><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor class=copyButtonIcon_f_OW><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg><span>复制</span></button></div></div><div class=codeBlockContent_vqWU><pre class="prism-code language-bash codeBlock_wPnj" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_fQUY><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>1</span><span class=codeLineContent_HA3z><span class="token comment" style="color:rgb(98, 114, 164)"># 1. 启动新节点</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>2</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 2. 检查节点加入集群</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>3</span><span class=codeLineContent_HA3z><span class="token plain">GET /_cat/nodes?v</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>4</span><span class=codeLineContent_HA3z><span class="token plain" style=display:inline-block></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>5</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 3. 重新分配分片</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>6</span><span class=codeLineContent_HA3z><span class="token plain">PUT /_cluster/settings</span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>7</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>8</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"transient"</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>9</span><span class=codeLineContent_HA3z><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">"cluster.routing.rebalance.enable"</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"all"</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>10</span><span class=codeLineContent_HA3z><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span></div><div class="token-line codeLine_fSta" style=color:#F8F8F2><span class=codeLineNumber_x9bH>11</span><span class=codeLineContent_HA3z><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></div></code></pre></div></div>
</li>
<li class="">
<p><strong>注意事项</strong>:</p>
<ul>
<li class="">扩容期间避免大量写入</li>
<li class="">监控分片重分配进度</li>
<li class="">确保网络带宽充足</li>
<li class="">验证扩容后性能</li>
</ul>
</li>
<li class="">
<p><strong>验证扩容效果</strong>:</p>
<ul>
<li class="">检查分片分布</li>
<li class="">测试查询性能</li>
<li class="">监控集群状态</li>
<li class="">调整相关配置</li>
</ul>
</li>
</ol>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>搜索引擎学习要点</div><div class=admonitionContent_BuS1><ol>
<li class=""><strong>理解倒排索引</strong>：这是搜索引擎的核心机制</li>
<li class=""><strong>掌握查询DSL</strong>：熟练使用各种查询类型和聚合</li>
<li class=""><strong>性能优化</strong>：学会识别和解决性能瓶颈</li>
<li class=""><strong>运维监控</strong>：建立完善的监控和告警体系</li>
<li class=""><strong>实际应用</strong>：在真实项目中应用搜索引擎技术</li>
</ol></div></div>
<hr/>
<p>通过本章的学习，你应该已经掌握了分布式搜索引擎的核心概念、架构设计和最佳实践。Elasticsearch和Solr都是强大的搜索引擎，选择合适的工具并正确使用它们，可以显著提升应用的搜索体验和性能。在实际项目中，要根据具体需求选择合适的搜索引擎，并持续优化配置和查询性能。<div class=docFooter_IWbN><div class=commentsSection_qKMH><div class=commentsContainer_DyUU><h2 class=commentsTitle_lsB6>参与讨论</h2><div class=commentsWrapper_DNkH></div></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href=https://github.com/MasterLiu93/blog-web/tree/main/docs/backend/distributed-systems/distributed-search.mdx target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated>Last updated<!-- --> on <b><time datetime=2025-08-07T00:00:00.000Z itemprop=dateModified>Aug 7, 2025</time></b> by <b>Laby</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/en/docs/backend/distributed-systems/distributed-transaction><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>分布式事务解决方案详解</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/en/docs/backend/message-queues/kafka><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Apache Kafka详解</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#1-elasticsearch-核心架构 class="table-of-contents__link toc-highlight">1. Elasticsearch 核心架构</a><ul><li><a href=#11-基本概念与组件 class="table-of-contents__link toc-highlight">1.1 基本概念与组件</a><li><a href=#12-倒排索引机制 class="table-of-contents__link toc-highlight">1.2 倒排索引机制</a><li><a href=#13-分词器analyzer class="table-of-contents__link toc-highlight">1.3 分词器（Analyzer）</a></ul><li><a href=#2-elasticsearch-索引管理 class="table-of-contents__link toc-highlight">2. Elasticsearch 索引管理</a><ul><li><a href=#21-索引创建与配置 class="table-of-contents__link toc-highlight">2.1 索引创建与配置</a><li><a href=#22-文档操作 class="table-of-contents__link toc-highlight">2.2 文档操作</a></ul><li><a href=#3-查询与搜索 class="table-of-contents__link toc-highlight">3. 查询与搜索</a><ul><li><a href=#31-查询dsl基础 class="table-of-contents__link toc-highlight">3.1 查询DSL基础</a><li><a href=#32-复合查询 class="table-of-contents__link toc-highlight">3.2 复合查询</a><li><a href=#33-聚合查询 class="table-of-contents__link toc-highlight">3.3 聚合查询</a><li><a href=#34-高亮与建议 class="table-of-contents__link toc-highlight">3.4 高亮与建议</a></ul><li><a href=#4-性能优化与调优 class="table-of-contents__link toc-highlight">4. 性能优化与调优</a><ul><li><a href=#41-索引性能优化 class="table-of-contents__link toc-highlight">4.1 索引性能优化</a><li><a href=#42-查询性能优化 class="table-of-contents__link toc-highlight">4.2 查询性能优化</a><li><a href=#43-集群性能调优 class="table-of-contents__link toc-highlight">4.3 集群性能调优</a></ul><li><a href=#5-solr-搜索引擎 class="table-of-contents__link toc-highlight">5. Solr 搜索引擎</a><ul><li><a href=#51-solr-vs-elasticsearch class="table-of-contents__link toc-highlight">5.1 Solr vs Elasticsearch</a><li><a href=#52-solr核心概念 class="table-of-contents__link toc-highlight">5.2 Solr核心概念</a></ul><li><a href=#6-监控与运维 class="table-of-contents__link toc-highlight">6. 监控与运维</a><ul><li><a href=#61-关键监控指标 class="table-of-contents__link toc-highlight">6.1 关键监控指标</a><li><a href=#62-常见问题与解决方案 class="table-of-contents__link toc-highlight">6.2 常见问题与解决方案</a></ul><li><a href=#7-面试题精选 class="table-of-contents__link toc-highlight">7. 面试题精选</a><ul><li><a href=#71-基础概念题 class="table-of-contents__link toc-highlight">7.1 基础概念题</a><li><a href=#72-性能优化题 class="table-of-contents__link toc-highlight">7.2 性能优化题</a><li><a href=#73-架构设计题 class="table-of-contents__link toc-highlight">7.3 架构设计题</a><li><a href=#74-运维监控题 class="table-of-contents__link toc-highlight">7.4 运维监控题</a></ul></ul></div></div></div></div></main></div></div></div><footer class=footer_xBL4><div class=container><div class=footerContent_QbTG><div class=footerSection_NcK9><div class=profileSection_obHN><img src=/img/head.jpg alt=Laby class=footerAvatar_Tac4 /><div class=profileInfo_hxzo><h3 class=profileName_hl7T>Laby</h3><p class=profileDesc_qTmn>A passionate full-stack engineer who loves all new technologies. Creating value with technology, changing the world with code.</div></div></div><div class=footerSection_NcK9><h4 class=sectionTitle_wYQ0>Quick Links</h4><ul class=linkList_QvGs><li><a href=/>Home</a><li><a href=/blog>Blog</a><li><a href=/projects>Projects</a><li><a href=/contact>Contact</a><li><a href=/about>About</a></ul></div><div class=footerSection_NcK9><h4 class=sectionTitle_wYQ0>Contact</h4><ul class=contactList_FX1g><li class=contactItem_xQY_><svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg><span>1521170425@qq.com</span><li class=contactItem_xQY_><svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/></svg><span>13261915710</span><li class=contactItem_xQY_><svg viewBox="0 0 24 24" width=16 height=16 fill=currentColor><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg><span>北京</span></ul><div class=socialLinks_pCXT><a href=https://github.com/MasterLiu93 target=_blank rel="noopener noreferrer" class=socialIcon_oRq4><svg viewBox="0 0 24 24" width=20 height=20 fill=currentColor><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg></a><a href=https://twitter.com target=_blank rel="noopener noreferrer" class=socialIcon_oRq4><svg viewBox="0 0 24 24" width=20 height=20 fill=currentColor><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg></a><a href=https://linkedin.com target=_blank rel="noopener noreferrer" class=socialIcon_oRq4><svg viewBox="0 0 24 24" width=20 height=20 fill=currentColor><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg></a></div></div><div class=footerSection_NcK9><h4 class=sectionTitle_wYQ0>WeChat</h4><div class=qrcodeWrapper_Hqnk><img src=/img/user/WeChat.png alt="WeChat QR Code" class=qrcode_e_MU /><p class=qrcodeText_Hzwk>Scan to add friend</div></div></div><div class=footerBottom_SMHg><div class=copyright_g70o><p>Copyright © <!-- -->2025<!-- --> Laby的博客. Built with<!-- --> <a href=https://docusaurus.io target=_blank rel="noopener noreferrer">Docusaurus</a>.</div></div></div></footer><button class=floatingButton_SY9y aria-label="打开 AI 助手"><span role=img aria-label=robot class="anticon anticon-robot icon_PXiV"><svg viewBox="64 64 896 896" focusable=false data-icon=robot width=1em height=1em fill=currentColor aria-hidden=true><path d="M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"/></svg></span><span class=badge_DEfZ>AI</span></button></div></body>