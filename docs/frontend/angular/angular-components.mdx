---
sidebar_position: 2
title: Angularå¸¸ç”¨ç»„ä»¶å¼€å‘æŒ‡å—
description: Angularç»„ä»¶åº“å¼€å‘ä¸å®è·µï¼ŒåŒ…å«å¸¸ç”¨UIç»„ä»¶ä¸åŠŸèƒ½ç»„ä»¶
authors: [Laby]
tags: [Angular, ç»„ä»¶, UIç»„ä»¶, è‡ªå®šä¹‰ç»„ä»¶]
last_update:
  date: 2025-08-15
  author: Laby
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

# Angularå¸¸ç”¨ç»„ä»¶å¼€å‘æŒ‡å—

Angularç»„ä»¶æ˜¯æ„å»ºAngularåº”ç”¨çš„åŸºç¡€æ„å»ºå—ã€‚é€šè¿‡ç»„ä»¶åŒ–å¼€å‘ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¯å¤ç”¨ã€å¯æµ‹è¯•å’Œå¯ç»´æŠ¤çš„ç•Œé¢å…ƒç´ ã€‚æœ¬æ–‡å°†ä»‹ç»Angularå¸¸ç”¨ç»„ä»¶çš„å¼€å‘å®è·µã€‚

:::tip æ ¸å¿ƒä»·å€¼
**Angularç»„ä»¶åŒ–å¼€å‘ä¼˜åŠ¿**
- ğŸ§© **ä»£ç å¤ç”¨**ï¼šå°è£…UIå’Œé€»è¾‘ä¸ºå¯é‡ç”¨ç»„ä»¶
- ğŸ› ï¸ **å…³æ³¨ç‚¹åˆ†ç¦»**ï¼šæ¯ä¸ªç»„ä»¶è´Ÿè´£ç‰¹å®šåŠŸèƒ½
- ğŸ“¦ **å£°æ˜å¼æ¨¡æ¿**ï¼šç›´è§‚çš„HTMLæ¨¡æ¿è¯­æ³•
- ğŸ”„ **å•å‘æ•°æ®æµ**ï¼šæ›´æ˜“äºç†è§£çš„æ•°æ®æµåŠ¨
- ğŸ” **å˜æ›´æ£€æµ‹**ï¼šé«˜æ•ˆçš„ç»„ä»¶æ›´æ–°æœºåˆ¶
:::

## 1. ç»„ä»¶åŸºç¡€è®¾è®¡æ¨¡å¼

### 1.1 å±•ç¤ºå‹ç»„ä»¶ vs å®¹å™¨å‹ç»„ä»¶

Angularåº”ç”¨ä¸­å¸¸ç”¨çš„ç»„ä»¶è®¾è®¡æ¨¡å¼æ˜¯å°†ç»„ä»¶åˆ†ä¸ºå±•ç¤ºå‹ç»„ä»¶å’Œå®¹å™¨å‹ç»„ä»¶ï¼š

1. **å±•ç¤ºå‹ç»„ä»¶(Presentational Components)**ï¼š
   - ä¸“æ³¨äºUIæ¸²æŸ“
   - é€šè¿‡Inputæ¥æ”¶æ•°æ®ï¼Œé€šè¿‡Outputå‘é€äº‹ä»¶
   - ä¸ä¾èµ–å¤–éƒ¨æœåŠ¡å’ŒçŠ¶æ€ç®¡ç†
   - å®¹æ˜“æµ‹è¯•å’Œé‡ç”¨

2. **å®¹å™¨å‹ç»„ä»¶(Container Components)**ï¼š
   - å¤„ç†æ•°æ®è·å–å’ŒçŠ¶æ€ç®¡ç†
   - åŒ…å«ä¸šåŠ¡é€»è¾‘
   - æ³¨å…¥æœåŠ¡å’Œä¸åç«¯äº¤äº’
   - å°†æ•°æ®ä¼ é€’ç»™å±•ç¤ºå‹ç»„ä»¶

```typescript title="å±•ç¤ºå‹ç»„ä»¶ç¤ºä¾‹"
import { Component, Input, Output, EventEmitter } from '@angular/core';

@Component({
  selector: 'app-user-profile-card',
  template: `
    <div class="user-card">
      <img [src]="user.avatar" alt="{{ user.name }}">
      <h3>{{ user.name }}</h3>
      <p>{{ user.email }}</p>
      <button (click)="onContact()">è”ç³»ç”¨æˆ·</button>
    </div>
  `,
  styleUrls: ['./user-profile-card.component.scss']
})
export class UserProfileCardComponent {
  @Input() user: any;
  @Output() contact = new EventEmitter<any>();
  
  onContact() {
    this.contact.emit(this.user);
  }
}
```

```typescript title="å®¹å™¨å‹ç»„ä»¶ç¤ºä¾‹"
import { Component, OnInit } from '@angular/core';
import { UserService } from '../../services/user.service';

@Component({
  selector: 'app-user-dashboard',
  template: `
    <div *ngIf="loading">åŠ è½½ä¸­...</div>
    <div *ngIf="error">{{ error }}</div>
    
    <div class="user-grid">
      <app-user-profile-card 
        *ngFor="let user of users" 
        [user]="user"
        (contact)="contactUser($event)">
      </app-user-profile-card>
    </div>
  `,
  styleUrls: ['./user-dashboard.component.scss']
})
export class UserDashboardComponent implements OnInit {
  users = [];
  loading = false;
  error = '';
  
  constructor(private userService: UserService) {}
  
  ngOnInit() {
    this.loading = true;
    this.userService.getUsers()
      .subscribe({
        next: (data) => {
          this.users = data;
          this.loading = false;
        },
        error: (err) => {
          this.error = 'æ— æ³•åŠ è½½ç”¨æˆ·æ•°æ®';
          this.loading = false;
          console.error(err);
        }
      });
  }
  
  contactUser(user) {
    this.userService.initiateContact(user);
  }
}
```

### 1.2 ç»„ä»¶é€šä¿¡ç­–ç•¥

ç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ˜¯æ„å»ºAngularåº”ç”¨çš„å…³é”®éƒ¨åˆ†ï¼š

1. **çˆ¶ç»„ä»¶ -> å­ç»„ä»¶**: ä½¿ç”¨`@Input()`è£…é¥°å™¨
2. **å­ç»„ä»¶ -> çˆ¶ç»„ä»¶**: ä½¿ç”¨`@Output()`å’Œ`EventEmitter`
3. **æ— ç›´æ¥å…³ç³»ç»„ä»¶**: ä½¿ç”¨æœåŠ¡å’ŒRxJS Subject/BehaviorSubject
4. **è·¨å¤šå±‚çº§ç»„ä»¶**: ä¾èµ–æ³¨å…¥å’Œæä¾›è€…å±‚çº§

```typescript title="ä½¿ç”¨æœåŠ¡è¿›è¡Œè·¨ç»„ä»¶é€šä¿¡"
// æ¶ˆæ¯æœåŠ¡
import { Injectable } from '@angular/core';
import { BehaviorSubject, Observable } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class MessageService {
  private messageSource = new BehaviorSubject<string>('é»˜è®¤æ¶ˆæ¯');
  currentMessage = this.messageSource.asObservable();
  
  constructor() { }
  
  changeMessage(message: string) {
    this.messageSource.next(message);
  }
}

// å‘é€ç»„ä»¶
@Component({
  selector: 'app-sender',
  template: `
    <input [(ngModel)]="message" placeholder="è¾“å…¥æ¶ˆæ¯">
    <button (click)="sendMessage()">å‘é€</button>
  `
})
export class SenderComponent {
  message: string;
  
  constructor(private messageService: MessageService) {}
  
  sendMessage() {
    this.messageService.changeMessage(this.message);
  }
}

// æ¥æ”¶ç»„ä»¶
@Component({
  selector: 'app-receiver',
  template: `<p>å½“å‰æ¶ˆæ¯: {{ message }}</p>`
})
export class ReceiverComponent implements OnInit {
  message: string;
  
  constructor(private messageService: MessageService) {}
  
  ngOnInit() {
    this.messageService.currentMessage.subscribe(message => {
      this.message = message;
    });
  }
  
  ngOnDestroy() {
    // é‡è¦ï¼šå–æ¶ˆè®¢é˜…é¿å…å†…å­˜æ³„æ¼
    this.subscription.unsubscribe();
  }
}
``` 

## 2. è¡¨å•ç»„ä»¶

è¡¨å•ç»„ä»¶æ˜¯ä»»ä½•Webåº”ç”¨çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚Angularæä¾›äº†å¼ºå¤§çš„è¡¨å•æ§åˆ¶åŠŸèƒ½ï¼Œä¸‹é¢ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„è¡¨å•ç»„ä»¶å®ç°ã€‚

### 2.1 é«˜çº§è¾“å…¥æ¡†ç»„ä»¶

ä¸€ä¸ªå¸¦æœ‰éªŒè¯ã€æ ‡ç­¾å’Œé”™è¯¯æç¤ºçš„å¢å¼ºè¾“å…¥æ¡†ç»„ä»¶ï¼š

```typescript title="advanced-input.component.ts"
import { Component, forwardRef, Input } from '@angular/core';
import { ControlValueAccessor, NG_VALUE_ACCESSOR, NG_VALIDATORS, FormControl, Validator } from '@angular/forms';

@Component({
  selector: 'app-advanced-input',
  template: `
    <div class="form-field" [class.has-error]="showError">
      <label *ngIf="label" [for]="id" class="form-label">
        {{ label }}
        <span class="required" *ngIf="required">*</span>
      </label>
      
      <div class="input-container">
        <input
          [type]="type"
          [id]="id"
          class="form-input"
          [placeholder]="placeholder"
          [value]="value"
          [disabled]="disabled"
          (input)="onInputChange($event)"
          (blur)="onTouched()"
        />
        
        <button
          *ngIf="value && clearable"
          type="button"
          class="clear-button"
          (click)="clearValue()"
          aria-label="Clear input">
          âœ•
        </button>
      </div>
      
      <div *ngIf="showError" class="error-message">
        {{ errorMessage }}
      </div>
    </div>
  `,
  styles: [`
    .form-field {
      margin-bottom: 1rem;
    }
    
    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }
    
    .input-container {
      position: relative;
      display: flex;
    }
    
    .form-input {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    
    .form-input:focus {
      outline: none;
      border-color: #4299e1;
      box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
    }
    
    .has-error .form-input {
      border-color: #e53e3e;
    }
    
    .has-error .form-input:focus {
      box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.2);
    }
    
    .clear-button {
      position: absolute;
      right: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #718096;
      cursor: pointer;
      padding: 0.25rem;
      line-height: 1;
    }
    
    .required {
      color: #e53e3e;
      margin-left: 0.25rem;
    }
    
    .error-message {
      color: #e53e3e;
      font-size: 0.875rem;
      margin-top: 0.5rem;
    }
  `],
  providers: [
    {
      provide: NG_VALUE_ACCESSOR,
      useExisting: forwardRef(() => AdvancedInputComponent),
      multi: true
    },
    {
      provide: NG_VALIDATORS,
      useExisting: forwardRef(() => AdvancedInputComponent),
      multi: true
    }
  ]
})
export class AdvancedInputComponent implements ControlValueAccessor, Validator {
  @Input() label: string;
  @Input() placeholder: string = '';
  @Input() type: string = 'text';
  @Input() id: string = `input-${Math.random().toString(36).substring(2, 11)}`;
  @Input() required: boolean = false;
  @Input() clearable: boolean = true;
  @Input() minLength: number = 0;
  @Input() maxLength: number;
  @Input() pattern: string;
  @Input() customValidator: (value: any) => { valid: boolean, message: string };
  
  value: any = '';
  disabled: boolean = false;
  touched: boolean = false;
  errorMessage: string = '';
  
  onChange: any = () => {};
  onTouched: any = () => {};
  
  constructor() {}
  
  // ControlValueAccessor æ¥å£
  writeValue(value: any): void {
    this.value = value;
  }
  
  registerOnChange(fn: any): void {
    this.onChange = fn;
  }
  
  registerOnTouched(fn: any): void {
    this.onTouched = fn;
  }
  
  setDisabledState(isDisabled: boolean): void {
    this.disabled = isDisabled;
  }
  
  // å½“è¾“å…¥æ”¹å˜æ—¶
  onInputChange(event: Event): void {
    const input = event.target as HTMLInputElement;
    this.value = input.value;
    this.onChange(this.value);
    this.validate(null);
  }
  
  // æ¸…é™¤è¾“å…¥å€¼
  clearValue(): void {
    this.value = '';
    this.onChange(this.value);
    this.onTouched();
  }
  
  // Validator æ¥å£
  validate(control: FormControl): {[key: string]: any} | null {
    // å¦‚æœç»„ä»¶æ§åˆ¶è‡ªå·±çš„å€¼ï¼Œä½¿ç”¨this.valueä»£æ›¿control.value
    const value = control ? control.value : this.value;
    
    // å¿…å¡«éªŒè¯
    if (this.required && !value) {
      this.errorMessage = 'æ­¤å­—æ®µä¸ºå¿…å¡«é¡¹';
      return { 'required': true };
    }
    
    // æœ€å°é•¿åº¦éªŒè¯
    if (this.minLength && value && value.length < this.minLength) {
      this.errorMessage = `æœ€å°‘éœ€è¦ ${this.minLength} ä¸ªå­—ç¬¦`;
      return { 'minlength': { requiredLength: this.minLength, actualLength: value.length } };
    }
    
    // æœ€å¤§é•¿åº¦éªŒè¯
    if (this.maxLength && value && value.length > this.maxLength) {
      this.errorMessage = `æœ€å¤šå…è®¸ ${this.maxLength} ä¸ªå­—ç¬¦`;
      return { 'maxlength': { requiredLength: this.maxLength, actualLength: value.length } };
    }
    
    // æ¨¡å¼éªŒè¯
    if (this.pattern && value) {
      const regex = new RegExp(this.pattern);
      if (!regex.test(value)) {
        this.errorMessage = 'è¾“å…¥æ ¼å¼ä¸æ­£ç¡®';
        return { 'pattern': { requiredPattern: this.pattern, actualValue: value } };
      }
    }
    
    // è‡ªå®šä¹‰éªŒè¯
    if (this.customValidator && value) {
      const result = this.customValidator(value);
      if (!result.valid) {
        this.errorMessage = result.message;
        return { 'custom': true };
      }
    }
    
    // éªŒè¯é€šè¿‡
    this.errorMessage = '';
    return null;
  }
  
  // æ˜¾ç¤ºé”™è¯¯çš„æ¡ä»¶
  get showError(): boolean {
    return this.errorMessage !== '' && this.touched;
  }
}
```

ä½¿ç”¨æ–¹æ³•ç¤ºä¾‹ï¼š

```html
<form [formGroup]="userForm">
  <app-advanced-input
    label="ç”¨æˆ·å"
    formControlName="username"
    required
    [minLength]="3"
    [maxLength]="20"
  ></app-advanced-input>
  
  <app-advanced-input
    label="ç”µå­é‚®ç®±"
    type="email"
    formControlName="email"
    required
    [pattern]="emailPattern"
  ></app-advanced-input>
  
  <button type="submit" [disabled]="userForm.invalid">æäº¤</button>
</form>
```

### 2.2 ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶

å¸¦æœ‰æœç´¢åŠŸèƒ½çš„ä¸‹æ‹‰é€‰æ‹©ç»„ä»¶ï¼š

```typescript title="searchable-select.component.ts"
import { Component, forwardRef, Input, ElementRef, ViewChild, HostListener } from '@angular/core';
import { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';

interface Option {
  value: any;
  label: string;
}

@Component({
  selector: 'app-searchable-select',
  template: `
    <div class="select-container">
      <label *ngIf="label" [for]="id" class="select-label">
        {{ label }}
        <span class="required" *ngIf="required">*</span>
      </label>
      
      <div
        class="select-input"
        [class.open]="isOpen"
        [class.disabled]="disabled"
        (click)="toggleDropdown()">
        <span *ngIf="selectedOption; else placeholderTpl">{{ selectedOption.label }}</span>
        <ng-template #placeholderTpl>
          <span class="placeholder">{{ placeholder }}</span>
        </ng-template>
        
        <div class="select-arrow">â–¼</div>
      </div>
      
      <div class="dropdown" *ngIf="isOpen">
        <div class="search-container">
          <input
            #searchInput
            type="text"
            class="search-input"
            placeholder="æœç´¢..."
            [value]="searchText"
            (input)="onSearch($event)"
            (click)="$event.stopPropagation()">
        </div>
        
        <div class="options-list" *ngIf="filteredOptions.length > 0">
          <div
            *ngFor="let option of filteredOptions"
            class="option-item"
            [class.selected]="value === option.value"
            (click)="selectOption(option); $event.stopPropagation()">
            {{ option.label }}
          </div>
        </div>
        
        <div class="no-results" *ngIf="filteredOptions.length === 0">
          æ— åŒ¹é…ç»“æœ
        </div>
      </div>
    </div>
  `,
  styles: [`
    .select-container {
      position: relative;
      margin-bottom: 1rem;
    }
    
    .select-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }
    
    .select-input {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0.75rem 1rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      background-color: #fff;
      cursor: pointer;
      user-select: none;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    
    .select-input:hover {
      border-color: #a0aec0;
    }
    
    .select-input.open {
      border-color: #4299e1;
      box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
    }
    
    .select-input.disabled {
      background-color: #f7fafc;
      cursor: not-allowed;
      color: #a0aec0;
    }
    
    .placeholder {
      color: #a0aec0;
    }
    
    .select-arrow {
      font-size: 0.75rem;
      color: #718096;
      transition: transform 0.2s;
    }
    
    .open .select-arrow {
      transform: rotate(180deg);
    }
    
    .dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      width: 100%;
      background: #fff;
      border: 1px solid #e2e8f0;
      border-radius: 4px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      z-index: 10;
      margin-top: 4px;
      max-height: 300px;
      display: flex;
      flex-direction: column;
    }
    
    .search-container {
      padding: 0.5rem;
      border-bottom: 1px solid #e2e8f0;
    }
    
    .search-input {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #e2e8f0;
      border-radius: 4px;
      font-size: 0.875rem;
    }
    
    .options-list {
      overflow-y: auto;
      max-height: 240px;
    }
    
    .option-item {
      padding: 0.75rem 1rem;
      cursor: pointer;
      transition: background-color 0.15s;
    }
    
    .option-item:hover {
      background-color: #f7fafc;
    }
    
    .option-item.selected {
      background-color: #ebf8ff;
      color: #3182ce;
      font-weight: 500;
    }
    
    .no-results {
      padding: 0.75rem 1rem;
      text-align: center;
      color: #a0aec0;
      font-style: italic;
    }
    
    .required {
      color: #e53e3e;
      margin-left: 0.25rem;
    }
  `],
  providers: [
    {
      provide: NG_VALUE_ACCESSOR,
      useExisting: forwardRef(() => SearchableSelectComponent),
      multi: true
    }
  ]
})
export class SearchableSelectComponent implements ControlValueAccessor {
  @Input() options: Option[] = [];
  @Input() label: string;
  @Input() placeholder: string = 'è¯·é€‰æ‹©';
  @Input() id: string = `select-${Math.random().toString(36).substring(2, 11)}`;
  @Input() required: boolean = false;
  
  @ViewChild('searchInput') searchInput: ElementRef;
  
  value: any = null;
  disabled: boolean = false;
  isOpen: boolean = false;
  searchText: string = '';
  
  onChange: any = () => {};
  onTouched: any = () => {};
  
  constructor(private elementRef: ElementRef) {}
  
  // å…³é—­ä¸‹æ‹‰æ¡†çš„ç‚¹å‡»å¤–éƒ¨å…ƒç´ äº‹ä»¶
  @HostListener('document:click', ['$event'])
  onClickOutside(event: Event) {
    if (!this.elementRef.nativeElement.contains(event.target)) {
      this.isOpen = false;
    }
  }
  
  // ControlValueAccessor æ¥å£
  writeValue(value: any): void {
    this.value = value;
  }
  
  registerOnChange(fn: any): void {
    this.onChange = fn;
  }
  
  registerOnTouched(fn: any): void {
    this.onTouched = fn;
  }
  
  setDisabledState(isDisabled: boolean): void {
    this.disabled = isDisabled;
  }
  
  // åˆ‡æ¢ä¸‹æ‹‰æ¡†çŠ¶æ€
  toggleDropdown(): void {
    if (this.disabled) return;
    
    this.isOpen = !this.isOpen;
    this.searchText = '';
    
    if (this.isOpen) {
      setTimeout(() => {
        this.searchInput?.nativeElement.focus();
      });
    }
  }
  
  // é€‰æ‹©é€‰é¡¹
  selectOption(option: Option): void {
    this.value = option.value;
    this.onChange(this.value);
    this.onTouched();
    this.isOpen = false;
  }
  
  // æœç´¢
  onSearch(event: Event): void {
    this.searchText = (event.target as HTMLInputElement).value;
  }
  
  // è¿‡æ»¤é€‰é¡¹
  get filteredOptions(): Option[] {
    if (!this.searchText) return this.options;
    
    return this.options.filter(option => 
      option.label.toLowerCase().includes(this.searchText.toLowerCase())
    );
  }
  
  // è·å–é€‰ä¸­é¡¹
  get selectedOption(): Option | undefined {
    return this.options.find(option => option.value === this.value);
  }
}
```

ä½¿ç”¨æ–¹æ³•ç¤ºä¾‹ï¼š

```html
<form [formGroup]="productForm">
  <app-searchable-select
    label="åˆ†ç±»"
    [options]="categoryOptions"
    formControlName="category"
    required
  ></app-searchable-select>
</form>

<script>
  // ç»„ä»¶ä»£ç 
  categoryOptions = [
    { value: 'electronics', label: 'ç”µå­äº§å“' },
    { value: 'clothing', label: 'æœè£…' },
    { value: 'books', label: 'å›¾ä¹¦' },
    { value: 'food', label: 'é£Ÿå“' },
    // ...æ›´å¤šé€‰é¡¹
  ];
</script>
``` 

## 3. å¸ƒå±€ç»„ä»¶

å¸ƒå±€ç»„ä»¶å¸®åŠ©æ„å»ºé¡µé¢çš„æ•´ä½“ç»“æ„å’Œç»„ç»‡å†…å®¹ã€‚ä¸‹é¢ä»‹ç»å‡ ä¸ªå®ç”¨çš„å¸ƒå±€ç»„ä»¶ã€‚

### 3.1 ç½‘æ ¼ç³»ç»Ÿç»„ä»¶

ä¸€ä¸ªçµæ´»çš„å“åº”å¼ç½‘æ ¼ç³»ç»Ÿç»„ä»¶ï¼š

```typescript title="grid-row.component.ts"
import { Component, Input, HostBinding } from '@angular/core';

@Component({
  selector: 'app-grid-row',
  template: `<ng-content></ng-content>`,
  styles: [`
    :host {
      display: flex;
      flex-wrap: wrap;
      box-sizing: border-box;
    }
  `]
})
export class GridRowComponent {
  @Input() gutter: number = 0;
  @Input() justify: 'start' | 'end' | 'center' | 'space-between' | 'space-around' = 'start';
  @Input() align: 'top' | 'middle' | 'bottom' = 'top';
  
  // æ˜ å°„åˆ°flexå±æ€§
  private justifyMap = {
    'start': 'flex-start',
    'end': 'flex-end',
    'center': 'center',
    'space-between': 'space-between',
    'space-around': 'space-around'
  };
  
  private alignMap = {
    'top': 'flex-start',
    'middle': 'center',
    'bottom': 'flex-end'
  };
  
  @HostBinding('style.margin-left.px')
  @HostBinding('style.margin-right.px')
  get marginOffset() {
    return this.gutter ? -(this.gutter / 2) : 0;
  }
  
  @HostBinding('style.justify-content')
  get justifyContent() {
    return this.justifyMap[this.justify];
  }
  
  @HostBinding('style.align-items')
  get alignItems() {
    return this.alignMap[this.align];
  }
}
```

```typescript title="grid-column.component.ts"
import { Component, Input, HostBinding, OnInit } from '@angular/core';

@Component({
  selector: 'app-grid-col',
  template: `<ng-content></ng-content>`,
  styles: [`
    :host {
      box-sizing: border-box;
    }
    
    /* å“åº”å¼æ–­ç‚¹ - å¯ä»¥æ ¹æ®éœ€æ±‚è°ƒæ•´ */
    @media (max-width: 575.98px) {
      :host.responsive {
        flex: 0 0 100%;
        max-width: 100%;
      }
    }
  `]
})
export class GridColumnComponent implements OnInit {
  @Input() span: number = 24;
  @Input() offset: number = 0;
  @Input() xs: number | object;
  @Input() sm: number | object;
  @Input() md: number | object;
  @Input() lg: number | object;
  @Input() xl: number | object;
  @Input() gutter: number = 0;
  
  @HostBinding('style.padding-left.px')
  @HostBinding('style.padding-right.px')
  get padding() {
    return this.gutter ? this.gutter / 2 : 0;
  }
  
  @HostBinding('style.flex')
  @HostBinding('style.max-width')
  get flexStyle() {
    return `0 0 ${(this.span / 24 * 100).toFixed(8)}%`;
  }
  
  @HostBinding('style.margin-left')
  get offsetStyle() {
    return this.offset ? `${(this.offset / 24 * 100).toFixed(8)}%` : null;
  }
  
  @HostBinding('class.responsive')
  get isResponsive() {
    return !!(this.xs || this.sm || this.md || this.lg || this.xl);
  }
  
  constructor() {}
  
  ngOnInit() {
    this.setResponsiveStyles();
  }
  
  private setResponsiveStyles() {
    // è¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤æ‚çš„å“åº”å¼æ ·å¼å¤„ç†é€»è¾‘
    // ä¾‹å¦‚åˆ›å»ºåª’ä½“æŸ¥è¯¢æ ·å¼å¹¶æ·»åŠ åˆ°document.head
  }
}
```

ä½¿ç”¨æ–¹æ³•ç¤ºä¾‹ï¼š

```html
<app-grid-row [gutter]="16" justify="space-between" align="middle">
  <app-grid-col [span]="8">
    <div class="column-content">åˆ— 1</div>
  </app-grid-col>
  <app-grid-col [span]="8">
    <div class="column-content">åˆ— 2</div>
  </app-grid-col>
  <app-grid-col [span]="8">
    <div class="column-content">åˆ— 3</div>
  </app-grid-col>
</app-grid-row>

<app-grid-row [gutter]="24">
  <app-grid-col [span]="6" [xs]="24" [sm]="12" [md]="8" [lg]="6">
    <div class="column-content">å“åº”å¼åˆ—</div>
  </app-grid-col>
  <app-grid-col [span]="6" [xs]="24" [sm]="12" [md]="8" [lg]="6">
    <div class="column-content">å“åº”å¼åˆ—</div>
  </app-grid-col>
  <app-grid-col [span]="6" [xs]="24" [sm]="12" [md]="8" [lg]="6">
    <div class="column-content">å“åº”å¼åˆ—</div>
  </app-grid-col>
  <app-grid-col [span]="6" [xs]="24" [sm]="12" [md]="8" [lg]="6">
    <div class="column-content">å“åº”å¼åˆ—</div>
  </app-grid-col>
</app-grid-row>
```

### 3.2 å¡ç‰‡ç»„ä»¶

ä¸€ä¸ªå¤šåŠŸèƒ½çš„å¡ç‰‡ç»„ä»¶ï¼Œç”¨äºå±•ç¤ºå†…å®¹ï¼š

```typescript title="card.component.ts"
import { Component, Input } from '@angular/core';

@Component({
  selector: 'app-card',
  template: `
    <div class="card" [ngClass]="cardClasses">
      <!-- å¡ç‰‡å¤´éƒ¨ -->
      <div class="card-header" *ngIf="title || subtitle || headerTemplate">
        <ng-container *ngIf="!headerTemplate">
          <h3 class="card-title" *ngIf="title">{{ title }}</h3>
          <div class="card-subtitle" *ngIf="subtitle">{{ subtitle }}</div>
        </ng-container>
        <ng-container *ngTemplateOutlet="headerTemplate"></ng-container>
      </div>
      
      <!-- å¡ç‰‡å°é¢ -->
      <div class="card-cover" *ngIf="coverImage">
        <img [src]="coverImage" [alt]="title || 'Card image'">
      </div>
      
      <!-- å¡ç‰‡å†…å®¹ -->
      <div class="card-body">
        <ng-content></ng-content>
      </div>
      
      <!-- å¡ç‰‡æ“ä½œåŒº -->
      <div class="card-actions" *ngIf="actionsTemplate">
        <ng-container *ngTemplateOutlet="actionsTemplate"></ng-container>
      </div>
    </div>
  `,
  styles: [`
    .card {
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      overflow: hidden;
      transition: box-shadow 0.3s, transform 0.3s;
      margin-bottom: 1.5rem;
      display: flex;
      flex-direction: column;
    }
    
    .card.hoverable:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
      transform: translateY(-4px);
    }
    
    .card.bordered {
      box-shadow: none;
      border: 1px solid #eee;
    }
    
    .card-header {
      padding: 1rem 1.5rem;
      border-bottom: 1px solid #f0f0f0;
      display: flex;
      flex-direction: column;
    }
    
    .card-title {
      margin: 0;
      font-size: 1.25rem;
      font-weight: 500;
      color: rgba(0, 0, 0, 0.85);
      line-height: 1.4;
    }
    
    .card-subtitle {
      margin-top: 0.25rem;
      color: rgba(0, 0, 0, 0.45);
      font-size: 0.875rem;
    }
    
    .card-cover img {
      width: 100%;
      display: block;
    }
    
    .card-body {
      padding: 1.5rem;
      flex: 1;
    }
    
    .card-actions {
      padding: 0.75rem 1.5rem;
      border-top: 1px solid #f0f0f0;
      background: #fafafa;
    }
    
    /* å°ºå¯¸å˜ä½“ */
    .card.small {
      font-size: 0.875rem;
    }
    
    .card.small .card-header {
      padding: 0.75rem 1rem;
    }
    
    .card.small .card-body {
      padding: 1rem;
    }
    
    .card.small .card-title {
      font-size: 1rem;
    }
    
    .card.large .card-header {
      padding: 1.5rem 2rem;
    }
    
    .card.large .card-body {
      padding: 2rem;
    }
    
    .card.large .card-title {
      font-size: 1.5rem;
    }
  `]
})
export class CardComponent {
  @Input() title: string;
  @Input() subtitle: string;
  @Input() coverImage: string;
  @Input() bordered: boolean = false;
  @Input() hoverable: boolean = false;
  @Input() size: 'small' | 'default' | 'large' = 'default';
  @Input() headerTemplate: any; // ng-templateå¼•ç”¨
  @Input() actionsTemplate: any; // ng-templateå¼•ç”¨
  
  get cardClasses(): {[key: string]: boolean} {
    return {
      'bordered': this.bordered,
      'hoverable': this.hoverable,
      'small': this.size === 'small',
      'large': this.size === 'large'
    };
  }
}
```

ä½¿ç”¨æ–¹æ³•ç¤ºä¾‹ï¼š

```html
<!-- åŸºæœ¬ç”¨æ³• -->
<app-card 
  title="å¡ç‰‡æ ‡é¢˜" 
  subtitle="å¡ç‰‡å‰¯æ ‡é¢˜" 
  [hoverable]="true"
  coverImage="assets/images/card-image.jpg">
  <p>è¿™æ˜¯å¡ç‰‡å†…å®¹åŒºåŸŸï¼Œå¯ä»¥æ”¾ç½®ä»»ä½•å†…å®¹ã€‚</p>
</app-card>

<!-- ä½¿ç”¨æ¨¡æ¿è‡ªå®šä¹‰å¤´éƒ¨å’Œæ“ä½œåŒº -->
<app-card [headerTemplate]="customHeader" [actionsTemplate]="customActions">
  <p>å¡ç‰‡å†…å®¹åŒºåŸŸ</p>
</app-card>

<ng-template #customHeader>
  <div class="custom-header">
    <img src="assets/icons/user.svg" alt="User icon">
    <div>
      <h3>è‡ªå®šä¹‰æ ‡é¢˜</h3>
      <span>åˆ›å»ºäºï¼š{{ createdDate | date }}</span>
    </div>
  </div>
</ng-template>

<ng-template #customActions>
  <div class="action-buttons">
    <button (click)="onEdit()">ç¼–è¾‘</button>
    <button (click)="onDelete()">åˆ é™¤</button>
  </div>
</ng-template>
```

### 3.3 åˆ†éš”é¢æ¿ç»„ä»¶

ä¸€ä¸ªå¯æŠ˜å çš„é¢æ¿ç»„ä»¶ï¼Œé€‚åˆå±•ç¤ºåˆ†ç»„å†…å®¹ï¼š

```typescript title="collapse.component.ts"
import { Component, Input } from '@angular/core';

@Component({
  selector: 'app-collapse',
  template: `
    <div class="collapse-container">
      <ng-content></ng-content>
    </div>
  `,
  styles: [`
    .collapse-container {
      border: 1px solid #eee;
      border-radius: 4px;
    }
  `]
})
export class CollapseComponent {
  @Input() accordion: boolean = false;
  
  activeKeys: string[] = [];
  
  togglePanel(key: string): void {
    if (this.accordion) {
      this.activeKeys = this.activeKeys.includes(key) ? [] : [key];
    } else {
      const index = this.activeKeys.indexOf(key);
      if (index > -1) {
        this.activeKeys.splice(index, 1);
      } else {
        this.activeKeys.push(key);
      }
    }
  }
}
```

```typescript title="collapse-panel.component.ts"
import { Component, Input, Host, Optional } from '@angular/core';
import { CollapseComponent } from './collapse.component';

@Component({
  selector: 'app-collapse-panel',
  template: `
    <div class="collapse-panel" [class.active]="isActive">
      <div class="panel-header" (click)="toggle()">
        <div class="header-content">{{ header }}</div>
        <div class="expand-icon">
          <i class="arrow" [class.down]="!isActive" [class.up]="isActive"></i>
        </div>
      </div>
      
      <div class="panel-content" [style.height]="isActive ? contentHeight : '0'">
        <div class="content-inner" #contentWrapper>
          <ng-content></ng-content>
        </div>
      </div>
    </div>
  `,
  styles: [`
    .collapse-panel {
      border-bottom: 1px solid #eee;
    }
    
    .collapse-panel:last-child {
      border-bottom: none;
    }
    
    .panel-header {
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      user-select: none;
      color: rgba(0, 0, 0, 0.85);
      font-weight: 500;
    }
    
    .panel-header:hover {
      background-color: #fafafa;
    }
    
    .collapse-panel.active .panel-header {
      border-bottom: 1px solid #eee;
    }
    
    .arrow {
      border: solid #999;
      border-width: 0 2px 2px 0;
      display: inline-block;
      padding: 3px;
      transition: transform 0.3s;
    }
    
    .arrow.down {
      transform: rotate(45deg);
    }
    
    .arrow.up {
      transform: rotate(-135deg);
    }
    
    .panel-content {
      overflow: hidden;
      transition: height 0.3s ease-out;
    }
    
    .content-inner {
      padding: 1rem;
      color: rgba(0, 0, 0, 0.65);
    }
  `]
})
export class CollapsePanelComponent {
  @Input() header: string;
  @Input() key: string = Math.random().toString(36).substring(2, 9);
  @Input() disabled: boolean = false;
  
  private _contentHeight = 'auto';
  
  get isActive(): boolean {
    return this.collapseComponent?.activeKeys.includes(this.key) ?? false;
  }
  
  get contentHeight(): string {
    return this.isActive ? this._contentHeight : '0';
  }
  
  constructor(@Optional() @Host() private collapseComponent: CollapseComponent) {}
  
  toggle(): void {
    if (this.disabled) return;
    
    this.collapseComponent?.togglePanel(this.key);
  }
}
```

ä½¿ç”¨æ–¹æ³•ç¤ºä¾‹ï¼š

```html
<!-- åŸºæœ¬æŠ˜å é¢æ¿ -->
<app-collapse>
  <app-collapse-panel header="æŠ˜å é¢æ¿ 1" key="panel1">
    <p>è¿™é‡Œæ˜¯é¢æ¿1çš„å†…å®¹åŒºåŸŸã€‚</p>
  </app-collapse-panel>
  
  <app-collapse-panel header="æŠ˜å é¢æ¿ 2" key="panel2">
    <p>è¿™é‡Œæ˜¯é¢æ¿2çš„å†…å®¹åŒºåŸŸã€‚</p>
    <p>å¯ä»¥åŒ…å«ä»»æ„å†…å®¹ï¼Œæ¯”å¦‚æ–‡æœ¬ã€è¡¨å•æˆ–å…¶ä»–ç»„ä»¶ã€‚</p>
  </app-collapse-panel>
  
  <app-collapse-panel header="æŠ˜å é¢æ¿ 3" key="panel3" [disabled]="true">
    <p>è¿™ä¸ªé¢æ¿è¢«ç¦ç”¨äº†ï¼Œæ— æ³•ç‚¹å‡»å±•å¼€ã€‚</p>
  </app-collapse-panel>
</app-collapse>

<!-- æ‰‹é£ç´æ¨¡å¼ -->
<app-collapse [accordion]="true">
  <app-collapse-panel header="éƒ¨åˆ† 1" key="section1">
    <p>æ‰‹é£ç´æ¨¡å¼ä¸‹ä¸€æ¬¡åªèƒ½å±•å¼€ä¸€ä¸ªé¢æ¿ã€‚</p>
  </app-collapse-panel>
  
  <app-collapse-panel header="éƒ¨åˆ† 2" key="section2">
    <p>ç‚¹å‡»è¿™ä¸ªé¢æ¿ä¼šè‡ªåŠ¨å…³é—­å…¶ä»–é¢æ¿ã€‚</p>
  </app-collapse-panel>
</app-collapse>
``` 

## 4. åŠŸèƒ½ç»„ä»¶

åŠŸèƒ½ç»„ä»¶æä¾›ç‰¹å®šçš„äº¤äº’åŠŸèƒ½ï¼Œå¦‚æ¨¡æ€å¯¹è¯æ¡†ã€é€šçŸ¥æé†’ç­‰ã€‚

### 4.1 æ¨¡æ€å¯¹è¯æ¡†ç»„ä»¶

ä¸€ä¸ªå¯å¤ç”¨çš„æ¨¡æ€å¯¹è¯æ¡†ç»„ä»¶ï¼š

```typescript title="modal.component.ts"
import { Component, Input, Output, EventEmitter, TemplateRef } from '@angular/core';
import { trigger, state, style, transition, animate } from '@angular/animations';

@Component({
  selector: 'app-modal',
  template: `
    <div class="modal-backdrop" *ngIf="visible" (click)="onBackdropClick()" [@backdropAnimation]="'show'">
      <div class="modal-dialog" [class]="modalSizeClass" (click)="$event.stopPropagation()" [@dialogAnimation]="'show'">
        <!-- æ¨¡æ€æ¡†å¤´éƒ¨ -->
        <div class="modal-header">
          <ng-container *ngIf="!customHeader">
            <h4 class="modal-title">{{ title }}</h4>
          </ng-container>
          <ng-container *ngTemplateOutlet="customHeader"></ng-container>
          
          <button *ngIf="showClose" type="button" class="close-button" aria-label="Close" (click)="close()">
            &times;
          </button>
        </div>
        
        <!-- æ¨¡æ€æ¡†å†…å®¹ -->
        <div class="modal-body">
          <ng-content></ng-content>
          <ng-container *ngTemplateOutlet="contentTemplate"></ng-container>
        </div>
        
        <!-- æ¨¡æ€æ¡†åº•éƒ¨ -->
        <div class="modal-footer" *ngIf="showFooter">
          <ng-container *ngIf="!customFooter">
            <button type="button" class="btn btn-secondary" (click)="close()">{{ cancelText }}</button>
            <button type="button" class="btn btn-primary" (click)="confirm()">{{ confirmText }}</button>
          </ng-container>
          <ng-container *ngTemplateOutlet="customFooter"></ng-container>
        </div>
      </div>
    </div>
  `,
  styles: [`
    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1050;
    }
    
    .modal-dialog {
      background-color: #fff;
      border-radius: 4px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      max-width: 90%;
      max-height: 90vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    .modal-size-small {
      width: 400px;
    }
    
    .modal-size-medium {
      width: 600px;
    }
    
    .modal-size-large {
      width: 800px;
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      border-bottom: 1px solid #eee;
    }
    
    .modal-title {
      margin: 0;
      font-weight: 500;
      color: rgba(0, 0, 0, 0.85);
    }
    
    .close-button {
      background: transparent;
      border: none;
      font-size: 1.5rem;
      font-weight: 700;
      line-height: 1;
      color: #999;
      cursor: pointer;
      padding: 0;
    }
    
    .close-button:hover {
      color: #333;
    }
    
    .modal-body {
      padding: 1.5rem;
      overflow-y: auto;
      flex: 1;
    }
    
    .modal-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid #eee;
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
    }
    
    .btn {
      padding: 0.5rem 1rem;
      border-radius: 4px;
      font-weight: 400;
      border: 1px solid transparent;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .btn-primary {
      background-color: #1890ff;
      border-color: #1890ff;
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #40a9ff;
      border-color: #40a9ff;
    }
    
    .btn-secondary {
      background-color: white;
      border-color: #d9d9d9;
      color: rgba(0, 0, 0, 0.65);
    }
    
    .btn-secondary:hover {
      background-color: #f5f5f5;
      border-color: #d9d9d9;
    }
  `],
  animations: [
    trigger('backdropAnimation', [
      state('void', style({
        opacity: 0
      })),
      state('show', style({
        opacity: 1
      })),
      transition('void => show', animate('200ms')),
      transition('show => void', animate('200ms'))
    ]),
    trigger('dialogAnimation', [
      state('void', style({
        transform: 'scale(0.7)',
        opacity: 0
      })),
      state('show', style({
        transform: 'scale(1)',
        opacity: 1
      })),
      transition('void => show', animate('200ms cubic-bezier(0.35, 0, 0.25, 1)')),
      transition('show => void', animate('200ms cubic-bezier(0.35, 0, 0.25, 1)'))
    ])
  ]
})
export class ModalComponent {
  @Input() visible: boolean = false;
  @Input() title: string = 'å¯¹è¯æ¡†';
  @Input() size: 'small' | 'medium' | 'large' = 'medium';
  @Input() showClose: boolean = true;
  @Input() showFooter: boolean = true;
  @Input() closeOnBackdrop: boolean = true;
  @Input() customHeader: TemplateRef<any>;
  @Input() customFooter: TemplateRef<any>;
  @Input() contentTemplate: TemplateRef<any>;
  @Input() confirmText: string = 'ç¡®å®š';
  @Input() cancelText: string = 'å–æ¶ˆ';
  
  @Output() visibleChange = new EventEmitter<boolean>();
  @Output() confirmed = new EventEmitter<void>();
  @Output() cancelled = new EventEmitter<void>();
  
  get modalSizeClass(): string {
    return `modal-size-${this.size}`;
  }
  
  close(): void {
    this.visibleChange.emit(false);
    this.cancelled.emit();
  }
  
  confirm(): void {
    this.confirmed.emit();
    this.visibleChange.emit(false);
  }
  
  onBackdropClick(): void {
    if (this.closeOnBackdrop) {
      this.close();
    }
  }
}
```

ä½¿ç”¨æ–¹æ³•ç¤ºä¾‹ï¼š

```html
<!-- åŸºæœ¬ç”¨æ³• -->
<button (click)="openModal()">æ‰“å¼€æ¨¡æ€æ¡†</button>

<app-modal 
  [(visible)]="isModalVisible"
  title="ç”¨æˆ·ä¿¡æ¯"
  (confirmed)="handleConfirm()"
  (cancelled)="handleCancel()">
  <p>è¿™æ˜¯æ¨¡æ€æ¡†çš„å†…å®¹åŒºåŸŸã€‚</p>
  <form>
    <div class="form-group">
      <label for="name">å§“å</label>
      <input id="name" type="text">
    </div>
    <div class="form-group">
      <label for="email">ç”µå­é‚®ç®±</label>
      <input id="email" type="email">
    </div>
  </form>
</app-modal>

<!-- ä½¿ç”¨è‡ªå®šä¹‰æ¨¡æ¿ -->
<app-modal 
  [(visible)]="isCustomModalVisible"
  [customHeader]="customModalHeader"
  [customFooter]="customModalFooter">
  <p>å¸¦æœ‰è‡ªå®šä¹‰å¤´éƒ¨å’Œåº•éƒ¨çš„æ¨¡æ€æ¡†ã€‚</p>
</app-modal>

<ng-template #customModalHeader>
  <div class="custom-header">
    <i class="icon-warning"></i>
    <span>è­¦å‘Šæç¤º</span>
  </div>
</ng-template>

<ng-template #customModalFooter>
  <button (click)="cancelAction()">ä¸ï¼Œæˆ‘å†æƒ³æƒ³</button>
  <button class="danger-button" (click)="confirmAction()">æ˜¯çš„ï¼Œæˆ‘ç¡®å®š</button>
</ng-template>
```

### 4.2 é€šçŸ¥æç¤ºç»„ä»¶

ä¸€ä¸ªç”¨äºæ˜¾ç¤ºå…¨å±€é€šçŸ¥çš„ç»„ä»¶ï¼ŒåŒ…å«æœåŠ¡å’Œç»„ä»¶ï¼š

```typescript title="notification.service.ts"
import { Injectable } from '@angular/core';
import { Subject } from 'rxjs';

export type NotificationType = 'success' | 'info' | 'warning' | 'error';

export interface NotificationConfig {
  id?: string;
  title?: string;
  message: string;
  type?: NotificationType;
  duration?: number;  // æ˜¾ç¤ºæ—¶é•¿ï¼Œå•ä½æ¯«ç§’ï¼Œ0è¡¨ç¤ºä¸è‡ªåŠ¨å…³é—­
}

export interface NotificationInstance extends NotificationConfig {
  id: string;
  timestamp: number;
}

@Injectable({
  providedIn: 'root'
})
export class NotificationService {
  private notifications$ = new Subject<NotificationInstance | { id: string, remove: true }>();
  
  // å¯è§‚å¯Ÿçš„é€šçŸ¥æµ
  notifications = this.notifications$.asObservable();
  
  constructor() {}
  
  // æ˜¾ç¤ºé€šçŸ¥
  show(config: NotificationConfig): string {
    const id = config.id || `notification-${Date.now()}-${Math.floor(Math.random() * 1000)}`;
    
    const notification: NotificationInstance = {
      ...config,
      id,
      type: config.type || 'info',
      duration: config.duration === undefined ? 4500 : config.duration,
      timestamp: Date.now()
    };
    
    this.notifications$.next(notification);
    
    return id;
  }
  
  // å…³é—­é€šçŸ¥
  close(id: string): void {
    this.notifications$.next({ id, remove: true });
  }
  
  // å¿«æ·æ–¹æ³•
  success(message: string, title?: string, duration?: number): string {
    return this.show({ message, title, type: 'success', duration });
  }
  
  info(message: string, title?: string, duration?: number): string {
    return this.show({ message, title, type: 'info', duration });
  }
  
  warning(message: string, title?: string, duration?: number): string {
    return this.show({ message, title, type: 'warning', duration });
  }
  
  error(message: string, title?: string, duration?: number): string {
    return this.show({ message, title, type: 'error', duration });
  }
}
```

```typescript title="notification.component.ts"
import { Component, OnInit, OnDestroy } from '@angular/core';
import { trigger, state, style, transition, animate } from '@angular/animations';
import { NotificationService, NotificationInstance } from './notification.service';
import { Subscription } from 'rxjs';

@Component({
  selector: 'app-notification-container',
  template: `
    <div class="notification-container">
      <div 
        *ngFor="let notification of notifications" 
        class="notification"
        [ngClass]="'notification-' + notification.type"
        [@notificationAnimation]="'visible'"
        (@notificationAnimation.done)="onAnimationDone($event, notification)"
      >
        <div class="notification-icon">
          <i class="icon" [ngClass]="getIconClass(notification.type)"></i>
        </div>
        <div class="notification-content">
          <div class="notification-title" *ngIf="notification.title">{{ notification.title }}</div>
          <div class="notification-message">{{ notification.message }}</div>
        </div>
        <button class="notification-close" (click)="close(notification.id)">&times;</button>
      </div>
    </div>
  `,
  styles: [`
    .notification-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1060;
      max-width: 350px;
    }
    
    .notification {
      background: white;
      border-radius: 4px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      margin-bottom: 16px;
      padding: 16px;
      position: relative;
      display: flex;
      align-items: flex-start;
      overflow: hidden;
    }
    
    .notification-icon {
      margin-right: 12px;
      font-size: 20px;
      line-height: 24px;
    }
    
    .notification-content {
      flex: 1;
    }
    
    .notification-title {
      font-weight: 500;
      font-size: 16px;
      margin-bottom: 4px;
      color: rgba(0, 0, 0, 0.85);
    }
    
    .notification-message {
      font-size: 14px;
      color: rgba(0, 0, 0, 0.65);
    }
    
    .notification-close {
      position: absolute;
      right: 16px;
      top: 12px;
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: rgba(0, 0, 0, 0.45);
    }
    
    .notification-success {
      border-left: 4px solid #52c41a;
    }
    
    .notification-success .icon {
      color: #52c41a;
    }
    
    .notification-info {
      border-left: 4px solid #1890ff;
    }
    
    .notification-info .icon {
      color: #1890ff;
    }
    
    .notification-warning {
      border-left: 4px solid #faad14;
    }
    
    .notification-warning .icon {
      color: #faad14;
    }
    
    .notification-error {
      border-left: 4px solid #f5222d;
    }
    
    .notification-error .icon {
      color: #f5222d;
    }
  `],
  animations: [
    trigger('notificationAnimation', [
      state('void', style({
        opacity: 0,
        transform: 'translateX(100%)'
      })),
      state('visible', style({
        opacity: 1,
        transform: 'translateX(0)'
      })),
      transition('void => visible', animate('200ms cubic-bezier(0, 0, 0.2, 1)')),
      transition('visible => void', animate('200ms cubic-bezier(0.4, 0, 1, 1)'))
    ])
  ]
})
export class NotificationContainerComponent implements OnInit, OnDestroy {
  notifications: NotificationInstance[] = [];
  private subscription: Subscription;
  private timers = new Map<string, any>();
  
  constructor(private notificationService: NotificationService) {}
  
  ngOnInit(): void {
    this.subscription = this.notificationService.notifications.subscribe(notification => {
      if ('remove' in notification) {
        this.removeNotification(notification.id);
      } else {
        this.addNotification(notification);
      }
    });
  }
  
  ngOnDestroy(): void {
    this.subscription.unsubscribe();
    // æ¸…é™¤æ‰€æœ‰è®¡æ—¶å™¨
    this.timers.forEach(timerId => clearTimeout(timerId));
    this.timers.clear();
  }
  
  private addNotification(notification: NotificationInstance): void {
    this.notifications = [...this.notifications, notification];
    
    // è®¾ç½®è‡ªåŠ¨å…³é—­è®¡æ—¶å™¨
    if (notification.duration > 0) {
      const timerId = setTimeout(() => {
        this.close(notification.id);
      }, notification.duration);
      
      this.timers.set(notification.id, timerId);
    }
  }
  
  private removeNotification(id: string): void {
    const index = this.notifications.findIndex(n => n.id === id);
    if (index > -1) {
      const notification = this.notifications[index];
      notification['removing'] = true;
      this.notifications = [...this.notifications];
      
      // æ¸…é™¤è¯¥é€šçŸ¥çš„è®¡æ—¶å™¨
      if (this.timers.has(id)) {
        clearTimeout(this.timers.get(id));
        this.timers.delete(id);
      }
    }
  }
  
  close(id: string): void {
    this.notificationService.close(id);
  }
  
  onAnimationDone(event: any, notification: NotificationInstance): void {
    if (event.toState === 'void') {
      this.notifications = this.notifications.filter(n => n.id !== notification.id);
    }
  }
  
  getIconClass(type: string): string {
    switch (type) {
      case 'success': return 'icon-check-circle';
      case 'info': return 'icon-info-circle';
      case 'warning': return 'icon-exclamation-circle';
      case 'error': return 'icon-close-circle';
      default: return 'icon-info-circle';
    }
  }
}
```

ä½¿ç”¨æ–¹æ³•ç¤ºä¾‹ï¼š

```typescript
import { Component } from '@angular/core';
import { NotificationService } from './notification.service';

@Component({
  selector: 'app-demo',
  template: `
    <button (click)="showSuccessNotification()">æ˜¾ç¤ºæˆåŠŸé€šçŸ¥</button>
    <button (click)="showInfoNotification()">æ˜¾ç¤ºä¿¡æ¯é€šçŸ¥</button>
    <button (click)="showWarningNotification()">æ˜¾ç¤ºè­¦å‘Šé€šçŸ¥</button>
    <button (click)="showErrorNotification()">æ˜¾ç¤ºé”™è¯¯é€šçŸ¥</button>
  `
})
export class DemoComponent {
  constructor(private notificationService: NotificationService) {}
  
  showSuccessNotification(): void {
    this.notificationService.success('æ“ä½œæˆåŠŸå®Œæˆ', 'æˆåŠŸ', 3000);
  }
  
  showInfoNotification(): void {
    this.notificationService.info('è¿™æ˜¯ä¸€æ¡ä¿¡æ¯é€šçŸ¥', 'æç¤º');
  }
  
  showWarningNotification(): void {
    this.notificationService.warning('è¯·æ³¨æ„å¯èƒ½çš„é—®é¢˜', 'è­¦å‘Š');
  }
  
  showErrorNotification(): void {
    this.notificationService.error('æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•', 'é”™è¯¯', 0); // 0è¡¨ç¤ºä¸è‡ªåŠ¨å…³é—­
  }
}
```

## 5. Angularç»„ä»¶æœ€ä½³å®è·µ

### 5.1 ç»„ä»¶è®¾è®¡åŸåˆ™

å¼€å‘Angularç»„ä»¶æ—¶åº”éµå¾ªä»¥ä¸‹è®¾è®¡åŸåˆ™ï¼š

1. **å•ä¸€èŒè´£åŸåˆ™**ï¼šæ¯ä¸ªç»„ä»¶åº”ä¸“æ³¨äºåšä¸€ä»¶äº‹ï¼Œå¹¶åšå¥½å®ƒã€‚
2. **å¯å¤ç”¨æ€§**ï¼šç»„ä»¶åº”è®¾è®¡ä¸ºå¯é‡ç”¨ï¼Œé¿å…ç‰¹å®šä¸šåŠ¡é€»è¾‘ç¡¬ç¼–ç ã€‚
3. **å¯æµ‹è¯•æ€§**ï¼šç»„ä»¶åº”ä¾¿äºå•å…ƒæµ‹è¯•ï¼Œä¾èµ–æ³¨å…¥è€Œéç›´æ¥ä¾èµ–å®ç°ã€‚
4. **å¯ç»„åˆæ€§**ï¼šç»„ä»¶åº”è®¾è®¡ä¸ºå¯ç»„åˆï¼Œæ”¯æŒå†…å®¹æŠ•å½±å’Œæ¨¡æ¿å®šåˆ¶ã€‚
5. **å°è£…æ€§**ï¼šç»„ä»¶åº”å°è£…å…¶å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œåªæš´éœ²å¿…è¦çš„APIã€‚

### 5.2 ç»„ä»¶è®¾è®¡æ¨¡å¼

1. **å±•ç¤ºå‹ç»„ä»¶ä¸å®¹å™¨å‹ç»„ä»¶åˆ†ç¦»**ï¼š
   - å±•ç¤ºå‹ç»„ä»¶ï¼šå¤„ç†UIå±•ç¤ºï¼Œé€šè¿‡è¾“å…¥æ¥æ”¶æ•°æ®ï¼Œé€šè¿‡è¾“å‡ºå‘é€äº‹ä»¶
   - å®¹å™¨å‹ç»„ä»¶ï¼šå¤„ç†æ•°æ®å’ŒçŠ¶æ€ç®¡ç†ï¼Œæ³¨å…¥æœåŠ¡ï¼Œåè°ƒå­ç»„ä»¶

2. **ç»„ä»¶ç»„åˆæ¨¡å¼**ï¼š
   - ä½¿ç”¨å†…å®¹æŠ•å½±(`ng-content`)ç»„åˆç»„ä»¶
   - ä½¿ç”¨æ¨¡æ¿å¼•ç”¨å®šåˆ¶ç»„ä»¶å¤–è§‚
   - ä½¿ç”¨ç»„ä»¶APIè¿›è¡Œé…ç½®

3. **æ™ºèƒ½é»˜è®¤å€¼ä¸æ¸è¿›å¼æ¥å£**ï¼š
   - æä¾›åˆç†é»˜è®¤å€¼ï¼Œå‡å°‘å¿…è¦é…ç½®
   - å…è®¸é€šè¿‡å¯é€‰è¾“å…¥è¿›è¡Œå®šåˆ¶
   - ä¿æŒç®€å•æ¥å£ï¼ŒåŒæ—¶æ”¯æŒé«˜çº§åŠŸèƒ½

### 5.3 ç»„ä»¶æ€§èƒ½ä¼˜åŒ–

1. **ä½¿ç”¨OnPushå˜æ›´æ£€æµ‹ç­–ç•¥**ï¼š

```typescript
@Component({
  selector: 'app-performance',
  template: `...`,
  changeDetection: ChangeDetectionStrategy.OnPush
})
export class PerformanceComponent {}
```

2. **é¿å…è¿‡åº¦ä½¿ç”¨`ngDoCheck`**ï¼š
   - è¯¥é’©å­è¿è¡Œé¢‘ç‡é«˜ï¼Œå®ç°åº”ä¿æŒè½»é‡
   - è€ƒè™‘ä½¿ç”¨é˜²æŠ–æˆ–èŠ‚æµå‡å°‘æ‰§è¡Œæ¬¡æ•°

3. **è·Ÿè¸ªngFor**ï¼š

```html
<div *ngFor="let item of items; trackBy: trackByFn">{{ item.name }}</div>
```

```typescript
trackByFn(index: number, item: any): number {
  return item.id;
}
```

4. **å»¶è¿ŸåŠ è½½**ï¼š
   - ä½¿ç”¨`*ngIf`æ¡ä»¶æ¸²æŸ“å¤æ‚ç»„ä»¶
   - è€ƒè™‘ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨å¤„ç†å¤§åˆ—è¡¨
   - ä½¿ç”¨`defer`å—ï¼ˆAngular 17+ï¼‰å»¶è¿ŸåŠ è½½ç»„ä»¶

5. **çº¯ç®¡é“æ›¿ä»£æ–¹æ³•**ï¼š
   - ä½¿ç”¨çº¯ç®¡é“å¤„ç†æ¨¡æ¿ä¸­çš„æ•°æ®è½¬æ¢ï¼Œè€Œéç»„ä»¶æ–¹æ³•

### 5.4 ç»„ä»¶åº“å¼€å‘å»ºè®®

å¦‚æœè¦å¼€å‘è‡ªå·±çš„ç»„ä»¶åº“ï¼Œè¯·éµå¾ªä»¥ä¸‹å»ºè®®ï¼š

1. **ä¸€è‡´çš„APIè®¾è®¡**ï¼š
   - ä¿æŒè¾“å…¥/è¾“å‡ºå‘½åä¸€è‡´æ€§
   - ä½¿ç”¨ç±»ä¼¼çš„äº¤äº’æ¨¡å¼
   - ä¿æŒç›¸ä¼¼çš„é”™è¯¯å¤„ç†ç­–ç•¥

2. **å¯è®¿é—®æ€§**ï¼š
   - æ”¯æŒé”®ç›˜å¯¼èˆª
   - æ·»åŠ é€‚å½“çš„ARIAå±æ€§
   - ç¡®ä¿è¶³å¤Ÿçš„é¢œè‰²å¯¹æ¯”åº¦
   - æ”¯æŒå±å¹•é˜…è¯»å™¨

3. **ä¸»é¢˜åŒ–æ”¯æŒ**ï¼š
   - ä½¿ç”¨CSSå˜é‡å®ç°ä¸»é¢˜åˆ‡æ¢
   - é¿å…ç¡¬ç¼–ç æ ·å¼å€¼
   - æä¾›æš—è‰²æ¨¡å¼æ”¯æŒ

4. **æ–‡æ¡£ä¸ç¤ºä¾‹**ï¼š
   - ä¸ºæ¯ä¸ªç»„ä»¶æä¾›æ¸…æ™°æ–‡æ¡£
   - åŒ…å«åŸºæœ¬å’Œé«˜çº§ä½¿ç”¨ç¤ºä¾‹
   - è®°å½•å…¬å…±APIå’Œäº‹ä»¶

5. **ç‰ˆæœ¬æ§åˆ¶ä¸è¿ç§»**ï¼š
   - éµå¾ªè¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶
   - æä¾›æ¸…æ™°çš„å˜æ›´æ—¥å¿—
   - åŒ…å«ç‰ˆæœ¬é—´è¿ç§»æŒ‡å— 