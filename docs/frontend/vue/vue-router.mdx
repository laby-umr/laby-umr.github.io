---
sidebar_position: 3
title: Vue Routerè·¯ç”±ç®¡ç†
description: Vue Routerä½¿ç”¨æŒ‡å—ä¸é«˜çº§åŠŸèƒ½ï¼ŒåŒ…å«è·¯ç”±é…ç½®ã€å¯¼èˆªå®ˆå«ä¸æœ€ä½³å®è·µ
authors: [Laby]
tags: [Vue.js, Vue Router, å‰ç«¯è·¯ç”±, å¯¼èˆªå®ˆå«, è·¯ç”±é‰´æƒ]
last_update:
  date: 2025-08-15
  author: Laby
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

# Vue Routerè·¯ç”±ç®¡ç†

Vue Routeræ˜¯Vue.jsçš„å®˜æ–¹è·¯ç”±ç®¡ç†å™¨ï¼Œç”¨äºæ„å»ºå•é¡µåº”ç”¨(SPA)ã€‚å®ƒä¸Vue.jsæ·±åº¦é›†æˆï¼Œæä¾›äº†å£°æ˜å¼çš„è·¯ç”±é…ç½®ã€åŠ¨æ€è·¯ç”±åŒ¹é…ã€åµŒå¥—è·¯ç”±ã€å¯¼èˆªå®ˆå«ç­‰å¼ºå¤§åŠŸèƒ½ã€‚

:::tip æ ¸å¿ƒä»·å€¼
**Vue Routerä¼˜åŠ¿**
- ğŸ§­ **å£°æ˜å¼è·¯ç”±**ï¼šé€šè¿‡é…ç½®å®šä¹‰åº”ç”¨è·¯ç”±ç»“æ„
- ğŸ”„ **åŠ¨æ€è·¯ç”±**ï¼šæ”¯æŒå‚æ•°åŒ–è·¯ç”±å’Œé€šé…ç¬¦
- ğŸ§© **ç»„ä»¶åŒ–è·¯ç”±**ï¼šæ¯ä¸ªè·¯ç”±å¯¹åº”ä¸€ä¸ªç»„ä»¶
- ğŸ›¡ï¸ **è·¯ç”±å®ˆå«**ï¼šæ§åˆ¶è·¯ç”±çš„è®¿é—®æƒé™
- ğŸ“± **å“åº”å¼è·¯ç”±**ï¼šä¸Vueå“åº”å¼ç³»ç»Ÿå®Œç¾ç»“åˆ
:::

## 1. Vue RouteråŸºç¡€é…ç½®

### 1.1 å®‰è£…ä¸åŸºæœ¬è®¾ç½®

```bash
# å®‰è£…Vue Router
npm install vue-router@4 # é€‚ç”¨äºVue 3
```

åœ¨Vue 3é¡¹ç›®ä¸­åˆ›å»ºè·¯ç”±é…ç½®ï¼š

```js title="src/router/index.js"
import { createRouter, createWebHistory } from 'vue-router'
import HomeView from '../views/HomeView.vue'
import AboutView from '../views/AboutView.vue'
import NotFound from '../views/NotFound.vue'

const routes = [
  {
    path: '/',
    name: 'home',
    component: HomeView,
    meta: {
      title: 'é¦–é¡µ',
      requiresAuth: false
    }
  },
  {
    path: '/about',
    name: 'about',
    component: AboutView,
    meta: {
      title: 'å…³äºæˆ‘ä»¬',
      requiresAuth: false
    }
  },
  {
    path: '/user/:id',
    name: 'user',
    component: () => import('../views/UserView.vue'), // æ‡’åŠ è½½è·¯ç”±
    meta: {
      title: 'ç”¨æˆ·è¯¦æƒ…',
      requiresAuth: true
    }
  },
  {
    path: '/:pathMatch(.*)*',
    name: 'not-found',
    component: NotFound,
    meta: {
      title: 'é¡µé¢æœªæ‰¾åˆ°'
    }
  }
]

const router = createRouter({
  history: createWebHistory(), // HTML5 Historyæ¨¡å¼
  routes,
  scrollBehavior(to, from, savedPosition) {
    // é¡µé¢åˆ‡æ¢æ—¶æ»šåŠ¨è¡Œä¸º
    if (savedPosition) {
      return savedPosition // å¦‚æœæ˜¯å‰è¿›/åé€€æŒ‰é’®ï¼Œæ¢å¤ä¹‹å‰çš„ä½ç½®
    } else {
      return { top: 0 } // å¦åˆ™æ»šåŠ¨åˆ°é¡¶éƒ¨
    }
  }
})

export default router
```

åœ¨ä¸»åº”ç”¨ä¸­æ³¨å†Œè·¯ç”±ï¼š

```js title="src/main.js"
import { createApp } from 'vue'
import App from './App.vue'
import router from './router'

const app = createApp(App)
app.use(router)
app.mount('#app')
```

### 1.2 è·¯ç”±è§†å›¾ä¸é“¾æ¥

åœ¨åº”ç”¨ä¸­ä½¿ç”¨è·¯ç”±å¯¼èˆªå’Œè§†å›¾ï¼š

```vue title="App.vue"
<template>
  <header>
    <nav>
      <RouterLink to="/">é¦–é¡µ</RouterLink>
      <RouterLink to="/about">å…³äº</RouterLink>
      <RouterLink :to="{ name: 'user', params: { id: userId } }">ç”¨æˆ·èµ„æ–™</RouterLink>
    </nav>
  </header>
  
  <!-- è·¯ç”±è§†å›¾ï¼Œè·¯ç”±åŒ¹é…çš„ç»„ä»¶ä¼šæ¸²æŸ“åœ¨è¿™é‡Œ -->
  <RouterView v-slot="{ Component }">
    <Transition name="fade" mode="out-in">
      <component :is="Component" />
    </Transition>
  </RouterView>
</template>

<script setup>
import { RouterLink, RouterView } from 'vue-router'
import { ref } from 'vue'

const userId = ref('12345')
</script>

<style scoped>
nav {
  padding: 1rem 0;
}

nav a {
  margin-right: 1rem;
}

.fade-enter-active,
.fade-leave-active {
  transition: opacity 0.3s;
}

.fade-enter-from,
.fade-leave-to {
  opacity: 0;
}
</style>
```

## 2. é«˜çº§è·¯ç”±åŠŸèƒ½

### 2.1 åµŒå¥—è·¯ç”±

åµŒå¥—è·¯ç”±å…è®¸åœ¨çˆ¶è·¯ç”±ç»„ä»¶å†…éƒ¨å®šä¹‰å­è·¯ç”±ï¼Œå®ç°æ›´å¤æ‚çš„UIç»“æ„ã€‚

```js title="åµŒå¥—è·¯ç”±é…ç½®ç¤ºä¾‹"
const routes = [
  {
    path: '/dashboard',
    component: DashboardLayout,
    children: [
      {
        path: '', // é»˜è®¤å­è·¯ç”±ï¼Œè®¿é—®/dashboardæ—¶æ˜¾ç¤º
        name: 'dashboard-overview',
        component: DashboardOverview
      },
      {
        path: 'profile',
        name: 'dashboard-profile',
        component: UserProfile
      },
      {
        path: 'settings',
        name: 'dashboard-settings',
        component: UserSettings
      }
    ]
  }
]
```

ä½¿ç”¨åµŒå¥—è·¯ç”±çš„çˆ¶ç»„ä»¶éœ€è¦åŒ…å«`<RouterView>`æ¥æ˜¾ç¤ºå­è·¯ç”±ç»„ä»¶ï¼š

```vue title="DashboardLayout.vue"
<template>
  <div class="dashboard-layout">
    <aside class="sidebar">
      <nav>
        <RouterLink :to="{ name: 'dashboard-overview' }">æ¦‚è§ˆ</RouterLink>
        <RouterLink :to="{ name: 'dashboard-profile' }">ä¸ªäººèµ„æ–™</RouterLink>
        <RouterLink :to="{ name: 'dashboard-settings' }">è®¾ç½®</RouterLink>
      </nav>
    </aside>
    
    <main class="content">
      <!-- å­è·¯ç”±ç»„ä»¶å°†åœ¨è¿™é‡Œæ¸²æŸ“ -->
      <RouterView />
    </main>
  </div>
</template>
```

### 2.2 åŠ¨æ€è·¯ç”±åŒ¹é…

åŠ¨æ€è·¯ç”±æ”¯æŒåœ¨URLä¸­åŒ…å«å‚æ•°ï¼Œå¹¶åœ¨ç»„ä»¶ä¸­è®¿é—®è¿™äº›å‚æ•°ï¼š

```vue title="UserView.vue"
<template>
  <div class="user-view">
    <h1>ç”¨æˆ·è¯¦æƒ…</h1>
    <div v-if="user">
      <img :src="user.avatar" alt="User Avatar" />
      <h2>{{ user.name }}</h2>
      <p>ID: {{ $route.params.id }}</p>
      <p>é‚®ç®±: {{ user.email }}</p>
    </div>
    <p v-else>åŠ è½½ç”¨æˆ·æ•°æ®ä¸­...</p>
  </div>
</template>

<script setup>
import { ref, onMounted, watch } from 'vue'
import { useRoute } from 'vue-router'

const route = useRoute()
const user = ref(null)

// æ ¹æ®è·¯ç”±å‚æ•°åŠ è½½ç”¨æˆ·æ•°æ®
const fetchUserData = async (userId) => {
  try {
    // æ¨¡æ‹ŸAPIè°ƒç”¨
    const response = await fetch(`/api/users/${userId}`)
    if (!response.ok) throw new Error('ç”¨æˆ·æ•°æ®è·å–å¤±è´¥')
    user.value = await response.json()
  } catch (error) {
    console.error(error)
  }
}

// ç»„ä»¶æŒ‚è½½æ—¶è·å–æ•°æ®
onMounted(() => {
  fetchUserData(route.params.id)
})

// å½“è·¯ç”±å‚æ•°å˜åŒ–æ—¶é‡æ–°è·å–æ•°æ®
watch(() => route.params.id, (newId) => {
  fetchUserData(newId)
})
</script>
```

### 2.3 è·¯ç”±æ‡’åŠ è½½

è·¯ç”±æ‡’åŠ è½½å¯ä»¥æé«˜åº”ç”¨æ€§èƒ½ï¼Œåªæœ‰å½“è·¯ç”±è¢«è®¿é—®æ—¶æ‰åŠ è½½å¯¹åº”çš„ç»„ä»¶ï¼š

```js
const routes = [
  {
    path: '/analytics',
    name: 'analytics',
    // ä½¿ç”¨importåŠ¨æ€å¯¼å…¥å®ç°æ‡’åŠ è½½
    component: () => import('../views/AnalyticsView.vue'),
    // å¯ä»¥è‡ªå®šä¹‰åŠ è½½ä¸­å’Œé”™è¯¯çŠ¶æ€çš„ç»„ä»¶
    meta: {
      title: 'æ•°æ®åˆ†æ'
    }
  },
  {
    path: '/reports',
    name: 'reports',
    component: () => import(/* webpackChunkName: "reports" */ '../views/ReportsView.vue')
    // webpackChunkNameå¯ä»¥æŒ‡å®šæ‰“åŒ…åçš„æ–‡ä»¶å
  }
]
```

### 2.4 å‘½åè§†å›¾

å‘½åè§†å›¾å…è®¸åœ¨åŒä¸€ä¸ªè·¯ç”±ä¸‹æ˜¾ç¤ºå¤šä¸ªç»„ä»¶ï¼Œé€‚ç”¨äºå¤æ‚çš„å¸ƒå±€ï¼š

```js
const routes = [
  {
    path: '/workspace',
    components: {
      default: WorkspaceMain,
      sidebar: WorkspaceSidebar,
      toolbar: WorkspaceToolbar
    }
  }
]
```

åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨å‘½åè§†å›¾ï¼š

```vue
<template>
  <div class="layout">
    <RouterView name="toolbar" class="toolbar" />
    <RouterView name="sidebar" class="sidebar" />
    <RouterView class="main-content" /> <!-- defaultè§†å›¾ -->
  </div>
</template>
```

## 3. å¯¼èˆªå®ˆå«

### 3.1 å…¨å±€å¯¼èˆªå®ˆå«

å…¨å±€å¯¼èˆªå®ˆå«å¯ä»¥ç”¨äºæƒé™éªŒè¯ã€é¡µé¢æ ‡é¢˜è®¾ç½®ç­‰åŠŸèƒ½ï¼š

```js title="src/router/index.js"
// å…¨å±€å‰ç½®å®ˆå«
router.beforeEach((to, from, next) => {
  // è®¾ç½®æ–‡æ¡£æ ‡é¢˜
  document.title = to.meta.title || 'é»˜è®¤æ ‡é¢˜'
  
  // æƒé™æ£€æŸ¥
  if (to.meta.requiresAuth) {
    const authService = useAuthService()
    if (!authService.isLoggedIn()) {
      // æœªç™»å½•æ—¶é‡å®šå‘åˆ°ç™»å½•é¡µ
      next({
        path: '/login',
        query: { redirect: to.fullPath } // ä¿å­˜åŸç›®æ ‡è·¯å¾„
      })
      return
    }
  }
  
  // ç»§ç»­å¯¼èˆª
  next()
})

// å…¨å±€è§£æå®ˆå«
router.beforeResolve(async (to, from, next) => {
  try {
    // åœ¨å¯¼èˆªè¢«ç¡®è®¤å‰ï¼ŒåŠ è½½ä¸è§†å›¾ç›¸å…³çš„æ•°æ®
    for (const component of to.matched) {
      if (component.meta.fetchData) {
        await component.meta.fetchData()
      }
    }
    next()
  } catch (error) {
    console.error('æ•°æ®åŠ è½½å¤±è´¥', error)
    next(false) // ä¸­æ­¢å¯¼èˆª
  }
})

// å…¨å±€åç½®é’©å­
router.afterEach((to, from) => {
  // å¯¼èˆªå®Œæˆåçš„é€»è¾‘
  const analyticsService = useAnalyticsService()
  analyticsService.trackPageView(to.fullPath)
})
```

### 3.2 è·¯ç”±ç‹¬äº«å®ˆå«

å¯ä»¥ä¸ºç‰¹å®šè·¯ç”±é…ç½®å®ˆå«ï¼š

```js
const routes = [
  {
    path: '/admin',
    component: AdminPanel,
    beforeEnter: (to, from, next) => {
      const authService = useAuthService()
      if (!authService.hasAdminRights()) {
        next('/forbidden')
      } else {
        next()
      }
    }
  }
]
```

### 3.3 ç»„ä»¶å†…å®ˆå«

å¯ä»¥åœ¨ç»„ä»¶å†…éƒ¨å®šä¹‰è·¯ç”±å®ˆå«ï¼š

```vue
<script setup>
import { onBeforeRouteLeave, onBeforeRouteUpdate } from 'vue-router'
import { ref } from 'vue'

const hasUnsavedChanges = ref(false)

// ç¦»å¼€è·¯ç”±å‰ç¡®è®¤
onBeforeRouteLeave((to, from, next) => {
  if (hasUnsavedChanges.value) {
    if (confirm('æœ‰æœªä¿å­˜çš„æ›´æ”¹ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ')) {
      next()
    } else {
      next(false)
    }
  } else {
    next()
  }
})

// è·¯ç”±å‚æ•°æ›´æ–°æ—¶çš„å¤„ç†
onBeforeRouteUpdate(async (to, from, next) => {
  if (to.params.id !== from.params.id) {
    try {
      // åŠ è½½æ–°çš„æ•°æ®
      await loadData(to.params.id)
      next()
    } catch (error) {
      console.error('æ•°æ®åŠ è½½å¤±è´¥', error)
      next(false)
    }
  } else {
    next()
  }
})
</script>
```

## 4. è·¯ç”±æ¨¡å¼ä¸å†å²è®°å½•

Vue Routeræ”¯æŒå¤šç§è·¯ç”±æ¨¡å¼ï¼š

```js
// HTML5 Historyæ¨¡å¼
const router = createRouter({
  history: createWebHistory(),
  routes
})

// Hashæ¨¡å¼
const router = createRouter({
  history: createWebHashHistory(),
  routes
})

// å†…å­˜æ¨¡å¼(ç”¨äºSSRç­‰åœºæ™¯)
const router = createRouter({
  history: createMemoryHistory(),
  routes
})
```

### 4.1 Historyæ¨¡å¼é…ç½®

Historyæ¨¡å¼éœ€è¦æœåŠ¡å™¨ç«¯é…ç½®æ”¯æŒï¼Œä»¥é˜²æ­¢åˆ·æ–°é¡µé¢æ—¶å‡ºç°404é”™è¯¯ï¼š

<Tabs>
<TabItem value="nginx" label="Nginxé…ç½®">

```nginx
server {
  listen 80;
  server_name example.com;
  root /var/www/html;
  index index.html;

  location / {
    try_files $uri $uri/ /index.html;
  }
}
```

</TabItem>
<TabItem value="apache" label="Apacheé…ç½®">

```apache
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteRule ^index\.html$ - [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /index.html [L]
</IfModule>
```

</TabItem>
<TabItem value="express" label="Express.jsé…ç½®">

```js
const express = require('express')
const app = express()

// é™æ€èµ„æº
app.use(express.static('dist'))

// æ‰€æœ‰è·¯ç”±æŒ‡å‘index.html
app.get('*', (req, res) => {
  res.sendFile('dist/index.html', { root: __dirname })
})

app.listen(3000)
```

</TabItem>
</Tabs>

## 5. è·¯ç”±æœ€ä½³å®è·µ

### 5.1 æ¨¡å—åŒ–è·¯ç”±é…ç½®

å¯¹äºå¤§å‹åº”ç”¨ï¼Œå¯ä»¥å°†è·¯ç”±é…ç½®æ¨¡å—åŒ–ï¼š

```js title="src/router/modules/user.js"
export default [
  {
    path: '/users',
    component: () => import('@/views/users/UserList.vue'),
    meta: { title: 'ç”¨æˆ·åˆ—è¡¨' }
  },
  {
    path: '/users/:id',
    component: () => import('@/views/users/UserDetail.vue'),
    meta: { title: 'ç”¨æˆ·è¯¦æƒ…' }
  },
  // å…¶ä»–ç”¨æˆ·ç›¸å…³è·¯ç”±...
]
```

```js title="src/router/index.js"
import { createRouter, createWebHistory } from 'vue-router'
import userRoutes from './modules/user'
import productRoutes from './modules/product'
import orderRoutes from './modules/order'

const routes = [
  {
    path: '/',
    component: () => import('@/views/Home.vue'),
    meta: { title: 'é¦–é¡µ' }
  },
  // å¯¼å…¥å„æ¨¡å—è·¯ç”±
  ...userRoutes,
  ...productRoutes,
  ...orderRoutes,
  {
    path: '/:pathMatch(.*)*',
    component: () => import('@/views/NotFound.vue'),
    meta: { title: 'é¡µé¢æœªæ‰¾åˆ°' }
  }
]

const router = createRouter({
  history: createWebHistory(),
  routes
})

export default router
```

### 5.2 è·¯ç”±å…ƒä¿¡æ¯çš„é«˜çº§ç”¨æ³•

è·¯ç”±å…ƒä¿¡æ¯å¯ä»¥å­˜å‚¨ä¸è·¯ç”±ç›¸å…³çš„è‡ªå®šä¹‰æ•°æ®ï¼š

```js
const routes = [
  {
    path: '/dashboard',
    component: Dashboard,
    meta: {
      title: 'ä»ªè¡¨ç›˜',
      icon: 'dashboard',
      requiresAuth: true,
      permissions: ['view-dashboard'],
      layout: 'admin',
      transition: 'fade',
      breadcrumb: [{ name: 'é¦–é¡µ', path: '/' }, { name: 'ä»ªè¡¨ç›˜' }],
      cacheable: true
    }
  }
]
```

ä½¿ç”¨è·¯ç”±å…ƒä¿¡æ¯æ„å»ºå¯¼èˆªèœå•ï¼š

```vue title="SideMenu.vue"
<template>
  <nav class="side-menu">
    <ul>
      <li v-for="route in navigationRoutes" :key="route.path">
        <RouterLink :to="route.path">
          <i :class="route.meta.icon"></i>
          {{ route.meta.title }}
        </RouterLink>
      </li>
    </ul>
  </nav>
</template>

<script setup>
import { computed } from 'vue'
import { useRouter } from 'vue-router'

const router = useRouter()

// è¿‡æ»¤å‡ºéœ€è¦åœ¨å¯¼èˆªä¸­æ˜¾ç¤ºçš„è·¯ç”±
const navigationRoutes = computed(() => {
  return router.options.routes.filter(route => {
    return route.meta?.showInNav && hasPermission(route.meta.permissions)
  })
})

const hasPermission = (requiredPermissions) => {
  // æƒé™æ£€æŸ¥é€»è¾‘
  const userPermissions = getCurrentUserPermissions()
  if (!requiredPermissions) return true
  return requiredPermissions.some(perm => userPermissions.includes(perm))
}
</script>
```

### 5.3 è·¯ç”±æƒé™ç®¡ç†

å®ç°åŸºäºè§’è‰²çš„è·¯ç”±æƒé™æ§åˆ¶ï¼š

```js title="src/permission.js"
import router from './router'
import store from './store'

// ç™½åå•è·¯ç”±ï¼ˆæ— éœ€ç™»å½•ï¼‰
const whiteList = ['/login', '/register', '/forgot-password']

router.beforeEach(async (to, from, next) => {
  // è·å–ç”¨æˆ·ä»¤ç‰Œ
  const hasToken = localStorage.getItem('token')

  if (hasToken) {
    if (to.path === '/login') {
      // å·²ç™»å½•åˆ™é‡å®šå‘åˆ°é¦–é¡µ
      next({ path: '/' })
    } else {
      // åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²è·å–è§’è‰²ä¿¡æ¯
      const hasRoles = store.getters.roles && store.getters.roles.length > 0
      if (hasRoles) {
        next()
      } else {
        try {
          // è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆåŒ…æ‹¬è§’è‰²ï¼‰
          const { roles } = await store.dispatch('user/getUserInfo')
          
          // æ ¹æ®è§’è‰²ç”Ÿæˆå¯è®¿é—®è·¯ç”±
          const accessibleRoutes = await store.dispatch('permission/generateRoutes', roles)
          
          // åŠ¨æ€æ·»åŠ è·¯ç”±
          accessibleRoutes.forEach(route => {
            router.addRoute(route)
          })
          
          // ç¡®ä¿addRouteå®Œæˆ
          next({ ...to, replace: true })
        } catch (error) {
          // å‡ºé”™åˆ™é‡ç½®ä»¤ç‰Œå¹¶é‡å®šå‘åˆ°ç™»å½•é¡µ
          await store.dispatch('user/resetToken')
          next(`/login?redirect=${to.path}`)
        }
      }
    }
  } else {
    // æœªç™»å½•
    if (whiteList.includes(to.path)) {
      // åœ¨ç™½åå•ä¸­ï¼Œç›´æ¥è®¿é—®
      next()
    } else {
      // å¦åˆ™é‡å®šå‘åˆ°ç™»å½•é¡µ
      next(`/login?redirect=${to.path}`)
    }
  }
})
```

## 6. ä¸çŠ¶æ€ç®¡ç†ç»“åˆ

Vue Routerä¸Piniaç»“åˆä½¿ç”¨ç¤ºä¾‹ï¼š

```js title="src/stores/routerStore.js"
import { defineStore } from 'pinia'
import { useRouter, useRoute } from 'vue-router'

export const useRouterStore = defineStore('router', () => {
  const router = useRouter()
  const route = useRoute()
  
  // å¯¼èˆªå†å²
  const navigationHistory = ref([])
  
  // æ·»åŠ å†å²è®°å½•
  function addToHistory(route) {
    // é¿å…é‡å¤
    if (!navigationHistory.value.find(item => item.path === route.path)) {
      navigationHistory.value.push({
        path: route.path,
        name: route.name,
        title: route.meta.title,
        timestamp: Date.now()
      })
      
      // é™åˆ¶å†å²è®°å½•æ•°é‡
      if (navigationHistory.value.length > 10) {
        navigationHistory.value.shift()
      }
    }
  }
  
  // å¯¼èˆªåˆ°ä¸Šä¸€ä¸ªé¡µé¢
  function goBack() {
    if (navigationHistory.value.length > 1) {
      // ç§»é™¤å½“å‰é¡µé¢
      navigationHistory.value.pop()
      // è·å–ä¸Šä¸€ä¸ªé¡µé¢
      const prevPage = navigationHistory.value[navigationHistory.value.length - 1]
      router.push(prevPage.path)
    } else {
      router.push('/')
    }
  }
  
  // å¿«æ·å¯¼èˆªæ–¹æ³•
  function navigateTo(routeName, params = {}, query = {}) {
    router.push({ name: routeName, params, query })
  }
  
  // è·Ÿè¸ªå½“å‰è·¯ç”±
  const currentRouteMeta = computed(() => route.meta)
  const currentPath = computed(() => route.path)
  const isActiveRoute = (path) => route.path === path
  
  return { 
    navigationHistory,
    addToHistory,
    goBack,
    navigateTo,
    currentRouteMeta,
    currentPath,
    isActiveRoute
  }
})
```

åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼š

```vue
<template>
  <div>
    <button @click="routerStore.goBack()">è¿”å›ä¸Šä¸€é¡µ</button>
    <button @click="routerStore.navigateTo('dashboard')">å‰å¾€ä»ªè¡¨ç›˜</button>
    
    <div v-if="routerStore.navigationHistory.length > 0">
      <h3>æµè§ˆå†å²</h3>
      <ul>
        <li v-for="(item, index) in routerStore.navigationHistory" :key="index">
          {{ item.title || item.name }} - {{ new Date(item.timestamp).toLocaleTimeString() }}
        </li>
      </ul>
    </div>
  </div>
</template>

<script setup>
import { useRouterStore } from '../stores/routerStore'

const routerStore = useRouterStore()
</script>
```

## 7. Vue Routerä¸SSR

Vue Routeråœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“(SSR)ç¯å¢ƒä¸­çš„ä½¿ç”¨ï¼š

```js title="server.js (åŸºäºExpresså’ŒVue SSR)"
const express = require('express')
const { renderToString } = require('vue/server-renderer')
const { createSSRApp } = require('vue')
const { createRouter, createMemoryHistory } = require('vue-router')
const fs = require('fs')
const path = require('path')

const server = express()

server.get('*', async (req, res) => {
  try {
    // 1. ä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºæ–°çš„Vueåº”ç”¨å®ä¾‹
    const app = createSSRApp(/* ... */)
    
    // 2. ä½¿ç”¨å†…å­˜å†å²æ¨¡å¼åˆ›å»ºrouter
    const router = createRouter({
      history: createMemoryHistory(),
      routes: [/* è·¯ç”±é…ç½® */]
    })
    
    app.use(router)
    
    // 3. å°†è¯·æ±‚çš„URLè®¾ç½®ä¸ºè·¯ç”±ä½ç½®
    await router.push(req.url)
    await router.isReady()
    
    // 4. æ¸²æŸ“åº”ç”¨ä¸ºHTML
    const appContent = await renderToString(app)
    
    // 5. æ³¨å…¥æ¸²æŸ“çš„HTMLåˆ°æ¨¡æ¿ä¸­
    const html = fs.readFileSync(
      path.join(__dirname, 'index.html'),
      'utf-8'
    ).replace('<!--app-html-->', appContent)
    
    // 6. è¿”å›é¡µé¢
    res.status(200).set({ 'Content-Type': 'text/html' }).end(html)
  } catch (error) {
    console.error(error)
    res.status(500).end('Internal Server Error')
  }
})

server.listen(3000)
``` 