---
sidebar_position: 4
title: MyBatis-Plusæ¡†æ¶è¯¦è§£
description: æ·±å…¥ç†è§£MyBatis-Plusæ ¸å¿ƒç‰¹æ€§ã€ä»£ç ç”Ÿæˆå™¨ä¸é«˜çº§åŠŸèƒ½å®æˆ˜
authors: [Laby]
tags: [MyBatis-Plus, ORM, ä»£ç ç”Ÿæˆ, åˆ†é¡µæ’ä»¶, æ¡ä»¶æ„é€ å™¨]
last_update:
  date: 2025-08-11
  author: Laby
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

# MyBatis-Plusæ¡†æ¶è¯¦è§£

MyBatis-Plusï¼ˆç®€ç§°MPï¼‰æ˜¯ä¸€ä¸ªMyBatisçš„å¢å¼ºå·¥å…·ï¼Œåœ¨MyBatisçš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºç®€åŒ–å¼€å‘ã€æé«˜æ•ˆç‡è€Œç”Ÿã€‚å®ƒæä¾›äº†å¼ºå¤§çš„CRUDæ“ä½œã€ä»£ç ç”Ÿæˆå™¨ã€æ¡ä»¶æ„é€ å™¨ç­‰åŠŸèƒ½ï¼Œè®©å¼€å‘è€…ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘è€Œéé‡å¤çš„CRUDä»£ç ã€‚

:::tip æ ¸å¿ƒä»·å€¼
**MyBatis-Plus = MyBatiså¢å¼º + é›¶ä¾µå…¥ + æŸè€—å° + å¼ºå¤§CRUD + æ”¯æŒLambda**
- ğŸš€ **å¼€ç®±å³ç”¨**ï¼šåªéœ€ç®€å•é…ç½®ï¼Œå³å¯å¿«é€Ÿè¿›è¡ŒCRUDæ“ä½œ
- ğŸ¯ **ä»£ç ç”Ÿæˆ**ï¼šå†…ç½®ä»£ç ç”Ÿæˆå™¨ï¼Œå¿«é€Ÿç”ŸæˆEntityã€Mapperã€Serviceã€Controller
- ğŸ’¡ **æ¡ä»¶æ„é€ å™¨**ï¼šå¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨ï¼Œæ”¯æŒå„ç§å¤æ‚æŸ¥è¯¢
- ğŸ”§ **å†…ç½®åˆ†é¡µ**ï¼šåŸºäºMyBatisç‰©ç†åˆ†é¡µï¼Œæ€§èƒ½ä¼˜ç§€
- ğŸ›¡ï¸ **é˜²å…¨è¡¨æ›´æ–°åˆ é™¤**ï¼šå†…ç½®é˜²æ­¢å…¨è¡¨æ›´æ–°åˆ é™¤æ’ä»¶
:::

## 1. æ ¸å¿ƒç‰¹æ€§ä¸æ¶æ„

### 1.1 æ¡†æ¶ä¼˜åŠ¿

MyBatis-Plusç›¸æ¯”åŸç”ŸMyBatiså…·æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿ï¼Œä¸»è¦ä½“ç°åœ¨ä»£ç é‡å‡å°‘ã€å¼€å‘æ•ˆç‡æå‡ã€åŠŸèƒ½æ›´åŠ ä¸°å¯Œã€æ€§èƒ½æŸè€—æå°å’Œæ— ä¾µå…¥æ€§ç­‰æ–¹é¢ã€‚

| ç‰¹æ€§ | MyBatis | MyBatis-Plus |
|------|---------|--------------|
| **é€šç”¨CRUD** | âŒ éœ€æ‰‹åŠ¨ç¼–å†™ | âœ… å†…ç½®é€šç”¨Mapper |
| **åˆ†é¡µæ”¯æŒ** | âŒ éœ€æ‰‹åŠ¨å®ç° | âœ… å†…ç½®åˆ†é¡µæ’ä»¶ |
| **æ¡ä»¶æ„é€ å™¨** | âŒ éœ€æ‰‹åŠ¨æ‹¼æ¥SQL | âœ… å¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨ |
| **ä»£ç ç”Ÿæˆå™¨** | âŒ éœ€ç¬¬ä¸‰æ–¹æ’ä»¶ | âœ… å†…ç½®ä»£ç ç”Ÿæˆå™¨ |
| **é€»è¾‘åˆ é™¤** | âŒ éœ€æ‰‹åŠ¨å®ç° | âœ… ä¸€é”®é…ç½®å³ç”¨ |
| **ä¹è§‚é”æ’ä»¶** | âŒ éœ€æ‰‹åŠ¨å®ç° | âœ… å†…ç½®ä¹è§‚é”æ’ä»¶ |

### 1.2 æ ¸å¿ƒç»„ä»¶

MyBatis-Plusçš„æ ¸å¿ƒç»„ä»¶åŒ…æ‹¬ï¼š

- **BaseMapper**ï¼šæä¾›åŸºç¡€çš„CRUDæ–¹æ³•
- **IService/ServiceImpl**ï¼šä¸šåŠ¡å±‚å°è£…ï¼Œæä¾›æ›´å¤šæ‰¹é‡æ“ä½œæ–¹æ³•
- **æ¡ä»¶æ„é€ å™¨**ï¼šQueryWrapperã€LambdaQueryWrapperç­‰
- **åˆ†é¡µæ’ä»¶**ï¼šç‰©ç†åˆ†é¡µæ”¯æŒ
- **ä»£ç ç”Ÿæˆå™¨**ï¼šå¿«é€Ÿç”Ÿæˆå„å±‚ä»£ç 
- **æ’ä»¶ä½“ç³»**ï¼šæä¾›å¤šç§æ‰©å±•æ’ä»¶

## 2. CRUDå¢å¼ºåŠŸèƒ½

### 2.1 é€šç”¨Mapperæ¥å£

BaseMapperæ¥å£æä¾›äº†å¸¸ç”¨çš„CRUDæ–¹æ³•ï¼Œåªéœ€è®©è‡ªå·±çš„Mapperæ¥å£ç»§æ‰¿BaseMapperå³å¯è·å¾—è¿™äº›æ–¹æ³•ã€‚

```java
public interface UserMapper extends BaseMapper<User> {
    // æ— éœ€ç¼–å†™ä»»ä½•æ–¹æ³•ï¼Œå·²ç»ç»§æ‰¿äº†BaseMapperçš„æ‰€æœ‰æ–¹æ³•
}
```

å¸¸ç”¨æ–¹æ³•åŒ…æ‹¬ï¼š
- `insert(T entity)`ï¼šæ’å…¥ä¸€æ¡è®°å½•
- `deleteById(Serializable id)`ï¼šæ ¹æ®IDåˆ é™¤
- `updateById(T entity)`ï¼šæ ¹æ®IDæ›´æ–°
- `selectById(Serializable id)`ï¼šæ ¹æ®IDæŸ¥è¯¢
- `selectList(Wrapper<T> queryWrapper)`ï¼šæ¡ä»¶æŸ¥è¯¢
- `selectPage(Page<T> page, Wrapper<T> queryWrapper)`ï¼šåˆ†é¡µæŸ¥è¯¢

### 2.2 é€šç”¨Serviceæ¥å£

IServiceæ¥å£å’ŒServiceImplå®ç°ç±»è¿›ä¸€æ­¥å°è£…äº†BaseMapperçš„æ–¹æ³•ï¼Œæä¾›äº†æ›´å¤šçš„æ‰¹é‡æ“ä½œå’Œé“¾å¼è°ƒç”¨æ–¹æ³•ã€‚

```java
public interface UserService extends IService<User> {
    // è‡ªå®šä¹‰æ–¹æ³•
}

@Service
public class UserServiceImpl extends ServiceImpl<UserMapper, User> implements UserService {
    // å®ç°è‡ªå®šä¹‰æ–¹æ³•
}
```

IServiceç›¸æ¯”BaseMapperçš„ä¼˜åŠ¿ï¼š
- è¿”å›æ“ä½œç»“æœ(boolean)è€Œéå½±å“è¡Œæ•°(int)
- æä¾›æ›´å¤šæ‰¹é‡æ“ä½œæ–¹æ³•
- æ”¯æŒé“¾å¼è°ƒç”¨API
- æ›´å¥½çš„äº‹åŠ¡æ”¯æŒ

### 2.3 ActiveRecordæ¨¡å¼

ActiveRecordæ¨¡å¼å…è®¸ç›´æ¥é€šè¿‡æ¨¡å‹å¯¹è±¡è¿›è¡Œæ•°æ®åº“æ“ä½œï¼Œæ— éœ€é¢å¤–çš„DAOå±‚ã€‚

```java
@Data
@TableName("user")
public class User extends Model<User> {
    private Long id;
    private String name;
    
    @Override
    protected Serializable pkVal() {
        return this.id;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
User user = new User();
user.setName("å¼ ä¸‰");
user.insert(); // ç›´æ¥è°ƒç”¨insertæ–¹æ³•æ’å…¥æ•°æ®
```

## 3. æ¡ä»¶æ„é€ å™¨

### 3.1 QueryWrapper

QueryWrapperç”¨äºæ„å»ºWHEREæ¡ä»¶ã€ORDER BYã€GROUP BYç­‰SQLç‰‡æ®µã€‚

```java
// åŸºæœ¬ä½¿ç”¨
QueryWrapper<User> queryWrapper = new QueryWrapper<>();
queryWrapper.eq("name", "å¼ ä¸‰")       // name = 'å¼ ä¸‰'
           .ge("age", 18)            // age >= 18
           .orderByDesc("create_time"); // ORDER BY create_time DESC
```

### 3.2 LambdaQueryWrapper

LambdaQueryWrapperæ˜¯QueryWrapperçš„Lambdaè¡¨è¾¾å¼å¢å¼ºç‰ˆï¼Œé€šè¿‡Lambdaè¡¨è¾¾å¼å®ç°ç±»å‹å®‰å…¨çš„æŸ¥è¯¢æ¡ä»¶æ„å»ºã€‚

```java
LambdaQueryWrapper<User> lambdaQuery = Wrappers.<User>lambdaQuery();
lambdaQuery.eq(User::getName, "å¼ ä¸‰")
          .ge(User::getAge, 18);
```

### 3.3 æ¡ä»¶æ„é€ å™¨é«˜çº§ç”¨æ³•

- **åŠ¨æ€æ¡ä»¶**ï¼šæ ¹æ®å‚æ•°å€¼æ˜¯å¦ä¸ºç©ºå†³å®šæ˜¯å¦åŠ å…¥æ¡ä»¶
- **åµŒå¥—æŸ¥è¯¢**ï¼šä½¿ç”¨nestedã€andã€oræ–¹æ³•å®ç°å¤æ‚æ¡ä»¶ç»„åˆ
- **å­æŸ¥è¯¢**ï¼šä½¿ç”¨inSqlã€existsç­‰æ–¹æ³•å®ç°å­æŸ¥è¯¢
- **SQLå‡½æ•°**ï¼šä½¿ç”¨applyæ–¹æ³•æ”¯æŒSQLå‡½æ•°

## 4. ä»£ç ç”Ÿæˆå™¨

ä»£ç ç”Ÿæˆå™¨å¯ä»¥å¿«é€Ÿç”ŸæˆEntityã€Mapperã€Serviceã€Controllerç­‰å„å±‚ä»£ç ã€‚

```java
// åŸºæœ¬é…ç½®
AutoGenerator generator = new AutoGenerator();
// å…¨å±€é…ç½®ã€æ•°æ®æºé…ç½®ã€åŒ…é…ç½®ã€ç­–ç•¥é…ç½®ç­‰
generator.execute();
```

ä¸»è¦é…ç½®é¡¹ï¼š
- **å…¨å±€é…ç½®**ï¼šè¾“å‡ºç›®å½•ã€ä½œè€…ã€æ˜¯å¦è¦†ç›–ç­‰
- **æ•°æ®æºé…ç½®**ï¼šæ•°æ®åº“è¿æ¥ä¿¡æ¯
- **åŒ…é…ç½®**ï¼šå„å±‚åŒ…åè®¾ç½®
- **ç­–ç•¥é…ç½®**ï¼šè¡¨åç”Ÿæˆç­–ç•¥ã€å­—æ®µåç”Ÿæˆç­–ç•¥ç­‰
- **æ¨¡æ¿é…ç½®**ï¼šè‡ªå®šä¹‰ä»£ç æ¨¡æ¿

## 5. åˆ†é¡µæ’ä»¶

### 5.1 é…ç½®åˆ†é¡µæ’ä»¶

```java
@Configuration
public class MybatisPlusConfig {
    @Bean
    public MybatisPlusInterceptor mybatisPlusInterceptor() {
        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
        // æ·»åŠ åˆ†é¡µæ’ä»¶
        interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL));
        return interceptor;
    }
}
```

### 5.2 ä½¿ç”¨åˆ†é¡µæŸ¥è¯¢

```java
// åˆ›å»ºPageå¯¹è±¡
Page<User> page = new Page<>(1, 10);
// æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢
Page<User> userPage = userMapper.selectPage(page, null);
// è·å–åˆ†é¡µç»“æœ
List<User> records = userPage.getRecords(); // å½“å‰é¡µæ•°æ®
long total = userPage.getTotal(); // æ€»è®°å½•æ•°
```

### 5.3 è‡ªå®šä¹‰åˆ†é¡µæŸ¥è¯¢

å¯¹äºå¤æ‚çš„åˆ†é¡µæŸ¥è¯¢ï¼Œå¯ä»¥è‡ªå®šä¹‰SQLå¹¶ä½¿ç”¨åˆ†é¡µæ’ä»¶ï¼š

```java
public interface UserMapper extends BaseMapper<User> {
    IPage<UserVO> selectUserPage(Page<UserVO> page, Integer state);
}

// XMLé…ç½®
<select id="selectUserPage" resultType="com.example.vo.UserVO">
    SELECT * FROM user WHERE state = #{state}
</select>
```

## 6. é€»è¾‘åˆ é™¤ä¸ä¹è§‚é”

### 6.1 é€»è¾‘åˆ é™¤

é€»è¾‘åˆ é™¤æ˜¯æŒ‡åœ¨æ•°æ®åº“ä¸­å¹¶ä¸çœŸæ­£åˆ é™¤æ•°æ®ï¼Œè€Œæ˜¯é€šè¿‡ä¿®æ”¹ä¸€ä¸ªå­—æ®µçš„å€¼æ¥æ ‡è®°è¯¥æ•°æ®å·²è¢«åˆ é™¤ã€‚

```yaml
# å…¨å±€é…ç½®
mybatis-plus:
  global-config:
    db-config:
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0
```

```java
// å®ä½“ç±»é…ç½®
public class User {
    @TableLogic
    private Integer deleted;
}
```

### 6.2 ä¹è§‚é”

ä¹è§‚é”æ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼Œé€šè¿‡ç‰ˆæœ¬å·æˆ–æ—¶é—´æˆ³æ¥å®ç°ã€‚

```java
@Configuration
public class MybatisPlusConfig {
    @Bean
    public MybatisPlusInterceptor mybatisPlusInterceptor() {
        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
        // æ·»åŠ ä¹è§‚é”æ’ä»¶
        interceptor.addInnerInterceptor(new OptimisticLockerInnerInterceptor());
        return interceptor;
    }
}
```

```java
// å®ä½“ç±»é…ç½®
public class User {
    @Version
    private Integer version;
}
```

## 7. æ’ä»¶ä½“ç³»

MyBatis-Plusæä¾›äº†ä¸°å¯Œçš„æ’ä»¶ä½“ç³»ï¼ŒåŒ…æ‹¬ï¼š

### 7.1 å¤šç§Ÿæˆ·æ’ä»¶

å¤šç§Ÿæˆ·æ’ä»¶å¯ä»¥å®ç°è¡Œçº§åˆ«çš„å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»ï¼š

```java
interceptor.addInnerInterceptor(new TenantLineInnerInterceptor(new TenantLineHandler() {
    @Override
    public Expression getTenantId() {
        return new LongValue(TenantContext.getCurrentTenantId());
    }
    
    @Override
    public String getTenantIdColumn() {
        return "tenant_id";
    }
}));
```

### 7.2 åŠ¨æ€è¡¨åæ’ä»¶

åŠ¨æ€è¡¨åæ’ä»¶å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€æ›¿æ¢SQLä¸­çš„è¡¨åï¼š

```java
DynamicTableNameInnerInterceptor dynamicTableNameInnerInterceptor = new DynamicTableNameInnerInterceptor();
dynamicTableNameInnerInterceptor.setTableNameHandler((sql, tableName) -> {
    if ("user".equals(tableName)) {
        return "user_" + DateUtil.format(new Date(), "yyyyMM");
    }
    return tableName;
});
```

### 7.3 è‡ªå®šä¹‰æ’ä»¶å¼€å‘

å¯ä»¥é€šè¿‡å®ç°InnerInterceptoræ¥å£æ¥å¼€å‘è‡ªå®šä¹‰æ’ä»¶ï¼š

```java
public class MyCustomInterceptor implements InnerInterceptor {
    @Override
    public void beforeQuery(Executor executor, MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, BoundSql boundSql) {
        // æŸ¥è¯¢å‰çš„å¤„ç†
    }
}
```

## 8. å®æˆ˜åº”ç”¨ä¸æœ€ä½³å®è·µ

### 8.1 æƒé™ç³»ç»Ÿå¼€å‘

åœ¨æƒé™ç³»ç»Ÿä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¤šç§Ÿæˆ·æ’ä»¶å®ç°æ•°æ®éš”ç¦»ï¼Œä½¿ç”¨åŠ¨æ€è¡¨åæ’ä»¶å®ç°åˆ†è¡¨ï¼Œä½¿ç”¨ä¹è§‚é”æ’ä»¶å®ç°å¹¶å‘æ§åˆ¶ã€‚

### 8.2 å¤§æ•°æ®é‡è¡¨æ ¼ä¼˜åŒ–

å¯¹äºå¤§æ•°æ®é‡è¡¨æ ¼ï¼Œå¯ä»¥ä½¿ç”¨åˆ†é¡µæ’ä»¶å®ç°é«˜æ•ˆåˆ†é¡µï¼Œä½¿ç”¨æ¡ä»¶æ„é€ å™¨ä¼˜åŒ–æŸ¥è¯¢æ¡ä»¶ï¼Œä½¿ç”¨åŠ¨æ€è¡¨åæ’ä»¶å®ç°åˆ†è¡¨ã€‚

### 8.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®

- ä½¿ç”¨åˆ†é¡µæ’ä»¶è¿›è¡Œç‰©ç†åˆ†é¡µ
- åˆç†ä½¿ç”¨æ¡ä»¶æ„é€ å™¨ï¼Œé¿å…å…¨è¡¨æ‰«æ
- ä½¿ç”¨æ‰¹é‡æ“ä½œæ–¹æ³•ï¼Œå‡å°‘æ•°æ®åº“äº¤äº’æ¬¡æ•°
- ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½
- ä½¿ç”¨ä¹è§‚é”ï¼Œé¿å…æ‚²è§‚é”å¯¼è‡´çš„æ€§èƒ½é—®é¢˜

## 9. æ€»ç»“

MyBatis-Plusä½œä¸ºMyBatisçš„å¢å¼ºå·¥å…·ï¼Œæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½å’Œæ’ä»¶ï¼Œå¤§å¤§ç®€åŒ–äº†å¼€å‘å·¥ä½œï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†MyBatis-Plusçš„æ ¸å¿ƒç‰¹æ€§å’Œä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥åœ¨å®é™…é¡¹ç›®ä¸­çµæ´»åº”ç”¨ã€‚

## 10. é¢è¯•é¢˜ç²¾é€‰

### 10.1 MyBatis-Plusçš„æ ¸å¿ƒç‰¹æ€§æœ‰å“ªäº›ï¼Ÿ

- é€šç”¨CRUDæ“ä½œ
- æ¡ä»¶æ„é€ å™¨
- åˆ†é¡µæ’ä»¶
- ä»£ç ç”Ÿæˆå™¨
- é€»è¾‘åˆ é™¤
- ä¹è§‚é”
- å¤šç§Ÿæˆ·
- åŠ¨æ€è¡¨å

### 10.2 MyBatis-Pluså¦‚ä½•é˜²æ­¢å…¨è¡¨æ›´æ–°ä¸åˆ é™¤ï¼Ÿ

MyBatis-Plusæä¾›äº†é˜²æ­¢å…¨è¡¨æ›´æ–°ä¸åˆ é™¤çš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡é…ç½®`update-strategy`ä¸º`not_empty`æ¥å®ç°ã€‚å½“æ²¡æœ‰WHEREæ¡ä»¶çš„æ›´æ–°æˆ–åˆ é™¤æ“ä½œå°†ä¼šè¢«é˜»æ­¢ã€‚

### 10.3 MyBatis-Plusçš„æ¡ä»¶æ„é€ å™¨æœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ

- é“¾å¼è°ƒç”¨ï¼Œä»£ç ç®€æ´
- ç±»å‹å®‰å…¨ï¼ˆLambdaQueryWrapperï¼‰
- åŠ¨æ€æ¡ä»¶ï¼Œæ ¹æ®å‚æ•°å€¼å†³å®šæ˜¯å¦åŠ å…¥æ¡ä»¶
- æ”¯æŒå¤æ‚æ¡ä»¶ç»„åˆï¼Œå¦‚åµŒå¥—æŸ¥è¯¢ã€å­æŸ¥è¯¢ç­‰
- é˜²SQLæ³¨å…¥

:::tip MyBatis-Pluså­¦ä¹ è¦ç‚¹
1. **æŒæ¡æ ¸å¿ƒæ¦‚å¿µ**ï¼šç†è§£BaseMapperã€IServiceç­‰æ ¸å¿ƒæ¥å£
2. **ç†Ÿç»ƒä½¿ç”¨æ¡ä»¶æ„é€ å™¨**ï¼šæŒæ¡å„ç§æŸ¥è¯¢æ¡ä»¶çš„æ„é€ æ–¹æ³•
3. **åˆç†ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨**ï¼šæé«˜å¼€å‘æ•ˆç‡ï¼Œä½†è¦ç†è§£ç”Ÿæˆçš„ä»£ç 
4. **å…³æ³¨æ€§èƒ½ä¼˜åŒ–**ï¼šå­¦ä¼šåˆ†æå’Œä¼˜åŒ–SQLæ€§èƒ½
5. **æŒç»­å­¦ä¹ **ï¼šå…³æ³¨MyBatis-Plusæ–°ç‰ˆæœ¬ç‰¹æ€§å’Œæœ€ä½³å®è·µ
:::