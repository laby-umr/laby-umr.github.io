---
sidebar_position: 3
title: Javaåå°„æœºåˆ¶å®Œå…¨æŒ‡å—
description: æ·±å…¥è§£æJavaåå°„æœºåˆ¶çš„åŸç†ã€åº”ç”¨åœºæ™¯ã€æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ
authors: [Laby]
tags: [Java, åå°„, Reflection, åŠ¨æ€ç¼–ç¨‹, æ¡†æ¶å¼€å‘, å…ƒç¼–ç¨‹]
last_update:
  date: 2025-08-14
  author: Laby
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';
import TOCInline from '@theme/TOCInline';

# Javaåå°„æœºåˆ¶å®Œå…¨æŒ‡å—

Javaåå°„ï¼ˆReflectionï¼‰æ˜¯Javaè¯­è¨€æœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œå®ƒå…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œæ“ä½œç±»ã€æ¥å£ã€å­—æ®µå’Œæ–¹æ³•çš„ä¿¡æ¯ã€‚åå°„æœºåˆ¶ä¸ºJavaæä¾›äº†å¼ºå¤§çš„åŠ¨æ€ç¼–ç¨‹èƒ½åŠ›ï¼Œæ˜¯Springã€Hibernateç­‰ä¸»æµæ¡†æ¶çš„æ ¸å¿ƒæŠ€æœ¯åŸºç¡€ã€‚

:::info æœ¬æ–‡å†…å®¹æ¦‚è§ˆ
<TOCInline toc={toc} />
:::

:::tip æ ¸å¿ƒä»·å€¼
**åå°„ = è¿è¡Œæ—¶è‡ªçœ + åŠ¨æ€è°ƒç”¨ + æ¡†æ¶åŸºç¡€ + å…ƒç¼–ç¨‹èƒ½åŠ›**
- ğŸ” **è‡ªçœæœºåˆ¶**ï¼šè¿è¡Œæ—¶æ£€æŸ¥ç±»å‹ä¿¡æ¯ï¼Œå®ç°åŠ¨æ€ç‰¹æ€§
- ğŸ”„ **åŠ¨æ€è°ƒç”¨**ï¼šè¿è¡Œæ—¶åˆ›å»ºå¯¹è±¡ã€è°ƒç”¨æ–¹æ³•ï¼Œæä¾›æå¤§çµæ´»æ€§
- ğŸ—ï¸ **æ¡†æ¶åŸºç¡€**ï¼šæ”¯æŒä¾èµ–æ³¨å…¥ã€åºåˆ—åŒ–ç­‰åº•å±‚æ¡†æ¶èƒ½åŠ›
- ğŸ› ï¸ **å·¥å…·å¼€å‘**ï¼šç¼–å†™å„ç±»å¼€å‘å·¥å…·ï¼Œå¦‚è°ƒè¯•å™¨ã€ä»£ç ç”Ÿæˆå™¨
- ğŸ”Œ **æ‰©å±•æ€§è®¾è®¡**ï¼šæ„å»ºå¯é…ç½®ã€å¯æ‰©å±•çš„åº”ç”¨æ¶æ„
:::

## 1. åå°„åŸºç¡€æ¦‚å¿µä¸åŸç†

### 1.1 åå°„æœºåˆ¶æ·±åº¦è§£æ

åå°„æ˜¯æŒ‡ç¨‹åºå¯ä»¥è®¿é—®ã€æ£€æµ‹å’Œä¿®æ”¹å®ƒæœ¬èº«çŠ¶æ€æˆ–è¡Œä¸ºçš„ä¸€ç§èƒ½åŠ›ã€‚åœ¨Javaä¸­ï¼Œåå°„ä¸»è¦é€šè¿‡`java.lang.reflect`åŒ…å®ç°ã€‚

```mermaid
graph TB
    subgraph "Javaåå°„ä½“ç³»æ¶æ„"
        A["Classå¯¹è±¡"] --> B["Fieldå­—æ®µåå°„"]
        A --> C["Methodæ–¹æ³•åå°„"]
        A --> D["Constructoræ„é€ å™¨åå°„"]
        A --> E["Annotationæ³¨è§£åå°„"]
        A --> F["Arrayæ•°ç»„åå°„"]
        
        B --> B1["å­—æ®µè®¿é—®æ§åˆ¶"]
        B --> B2["å­—æ®µå€¼æ“ä½œ"]
        
        C --> C1["æ–¹æ³•è°ƒç”¨"]
        C --> C2["å‚æ•°å¤„ç†"]
        
        D --> D1["å¯¹è±¡åˆ›å»º"]
        D --> D2["æ„é€ å‚æ•°"]
        
        E --> E1["æ³¨è§£è¯»å–"]
        E --> E2["å…ƒæ•°æ®å¤„ç†"]
        
        F --> F1["æ•°ç»„åˆ›å»º"]
        F --> F2["æ•°ç»„æ“ä½œ"]
    end
```

#### åå°„æ ¸å¿ƒç±»å¯¹æ¯”è¡¨

| æ ¸å¿ƒç±» | ä½œç”¨ | ä¸»è¦æ–¹æ³• | ä½¿ç”¨åœºæ™¯ | æ€§èƒ½å½±å“ |
|--------|------|----------|----------|----------|
| **Class** | ç±»ä¿¡æ¯è¡¨ç¤º | `forName()`, `newInstance()` | ç±»åŠ è½½ã€å®ä¾‹åˆ›å»º | ä¸­ç­‰ |
| **Field** | å­—æ®µæ“ä½œ | `get()`, `set()`, `setAccessible()` | å±æ€§æ³¨å…¥ã€åºåˆ—åŒ– | è¾ƒé«˜ |
| **Method** | æ–¹æ³•è°ƒç”¨ | `invoke()`, `getParameterTypes()` | åŠ¨æ€æ–¹æ³•è°ƒç”¨ | é«˜ |
| **Constructor** | æ„é€ å™¨æ“ä½œ | `newInstance()`, `getParameters()` | å¯¹è±¡åˆ›å»º | ä¸­ç­‰ |
| **Parameter** | å‚æ•°ä¿¡æ¯ | `getName()`, `getType()` | å‚æ•°è§£æ | ä½ |
<Tabs>
<TabItem value="class-object" label="Classå¯¹è±¡è·å–">

### è·å–Classå¯¹è±¡çš„å¤šç§æ–¹å¼

```java title="Classå¯¹è±¡è·å–æ–¹å¼å¯¹æ¯”"
public class ClassObjectDemo {
    public static void main(String[] args) throws ClassNotFoundException {
        // æ–¹å¼1ï¼šé€šè¿‡ç±»å.classè·å–ï¼ˆç¼–è¯‘æ—¶ç¡®å®šï¼‰
        Class<String> clazz1 = String.class;
        System.out.println("æ–¹å¼1: " + clazz1.getName());
        
        // æ–¹å¼2ï¼šé€šè¿‡å¯¹è±¡.getClass()è·å–ï¼ˆè¿è¡Œæ—¶ç¡®å®šï¼‰
        String str = "Hello";
        Class<?> clazz2 = str.getClass();
        System.out.println("æ–¹å¼2: " + clazz2.getName());
        
        // æ–¹å¼3ï¼šé€šè¿‡Class.forName()è·å–ï¼ˆåŠ¨æ€åŠ è½½ï¼‰
        Class<?> clazz3 = Class.forName("java.lang.String");
        System.out.println("æ–¹å¼3: " + clazz3.getName());
        
        // æ–¹å¼4ï¼šé€šè¿‡ç±»åŠ è½½å™¨è·å–
        ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
        Class<?> clazz4 = classLoader.loadClass("java.lang.String");
        System.out.println("æ–¹å¼4: " + clazz4.getName());
        
        // éªŒè¯æ˜¯å¦ä¸ºåŒä¸€ä¸ªClasså¯¹è±¡
        System.out.println("æ˜¯å¦ä¸ºåŒä¸€ä¸ªClasså¯¹è±¡: " + (clazz1 == clazz2));
        System.out.println("æ˜¯å¦ä¸ºåŒä¸€ä¸ªClasså¯¹è±¡: " + (clazz2 == clazz3));
    }
}
```

#### Classå¯¹è±¡è·å–æ–¹å¼å¯¹æ¯”

| è·å–æ–¹å¼ | è¯­æ³• | ä½¿ç”¨åœºæ™¯ | æ€§èƒ½ | å¼‚å¸¸å¤„ç† |
|----------|------|----------|------|----------|
| **ç±»å.class** | `String.class` | ç¼–è¯‘æ—¶å·²çŸ¥ç±»å‹ | æœ€å¿« | æ— å¼‚å¸¸ |
| **å¯¹è±¡.getClass()** | `obj.getClass()` | è¿è¡Œæ—¶è·å–å¯¹è±¡ç±»å‹ | å¿« | æ— å¼‚å¸¸ |
| **Class.forName()** | `Class.forName("ç±»å")` | åŠ¨æ€åŠ è½½ç±» | è¾ƒæ…¢ | ClassNotFoundException |
| **ç±»åŠ è½½å™¨** | `classLoader.loadClass()` | è‡ªå®šä¹‰ç±»åŠ è½½ | è¾ƒæ…¢ | ClassNotFoundException |

</TabItem>
<TabItem value="class-info" label="ç±»ä¿¡æ¯è·å–">

### è·å–ç±»çš„è¯¦ç»†ä¿¡æ¯

```java title="ç±»ä¿¡æ¯è·å–å®Œæ•´ç¤ºä¾‹"
import java.lang.reflect.*;
import java.util.Arrays;

public class ClassInfoDemo {
    public static void analyzeClass(Class<?> clazz) {
        System.out.println("=== åˆ†æç±»: " + clazz.getName() + " ===");
        
        // 1. åŸºæœ¬ä¿¡æ¯
        System.out.println("ç®€å•åç§°: " + clazz.getSimpleName());
        System.out.println("åŒ…å: " + clazz.getPackage().getName());
        System.out.println("æ˜¯å¦ä¸ºæ¥å£: " + clazz.isInterface());
        System.out.println("æ˜¯å¦ä¸ºæŠ½è±¡ç±»: " + Modifier.isAbstract(clazz.getModifiers()));
        System.out.println("æ˜¯å¦ä¸ºfinalç±»: " + Modifier.isFinal(clazz.getModifiers()));
        
        // 2. ç»§æ‰¿å…³ç³»
        Class<?> superClass = clazz.getSuperclass();
        if (superClass != null) {
            System.out.println("çˆ¶ç±»: " + superClass.getName());
        }
        
        // 3. å®ç°çš„æ¥å£
        Class<?>[] interfaces = clazz.getInterfaces();
        if (interfaces.length > 0) {
            System.out.println("å®ç°çš„æ¥å£: " + Arrays.toString(interfaces));
        }
        
        // 4. æ³›å‹ä¿¡æ¯
        TypeVariable<?>[] typeParameters = clazz.getTypeParameters();
        if (typeParameters.length > 0) {
            System.out.println("æ³›å‹å‚æ•°: " + Arrays.toString(typeParameters));
        }
        
        // 5. æ³¨è§£ä¿¡æ¯
        Annotation[] annotations = clazz.getAnnotations();
        if (annotations.length > 0) {
            System.out.println("ç±»æ³¨è§£: " + Arrays.toString(annotations));
        }
        
        // 6. å†…éƒ¨ç±»
        Class<?>[] innerClasses = clazz.getDeclaredClasses();
        if (innerClasses.length > 0) {
            System.out.println("å†…éƒ¨ç±»: " + Arrays.toString(innerClasses));
        }
        
        System.out.println();
    }
    
    public static void main(String[] args) {
        // åˆ†æä¸åŒç±»å‹çš„ç±»
        analyzeClass(String.class);
        analyzeClass(java.util.ArrayList.class);
        analyzeClass(java.util.List.class);
        analyzeClass(Thread.class);
    }
}
```

</TabItem>
<TabItem value="performance" label="æ€§èƒ½è€ƒè™‘">

### åå°„æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

```java title="åå°„æ€§èƒ½ä¼˜åŒ–å®è·µ"
import java.lang.reflect.*;
import java.util.concurrent.ConcurrentHashMap;

public class ReflectionPerformanceOptimizer {
    // ç¼“å­˜Classå¯¹è±¡
    private static final ConcurrentHashMap<String, Class<?>> CLASS_CACHE = new ConcurrentHashMap<>();
    
    // ç¼“å­˜Methodå¯¹è±¡
    private static final ConcurrentHashMap<String, Method> METHOD_CACHE = new ConcurrentHashMap<>();
    
    // ç¼“å­˜Fieldå¯¹è±¡
    private static final ConcurrentHashMap<String, Field> FIELD_CACHE = new ConcurrentHashMap<>();
    
    /**
     * ä¼˜åŒ–çš„Classè·å–æ–¹æ³•
     */
    public static Class<?> getClassOptimized(String className) throws ClassNotFoundException {
        return CLASS_CACHE.computeIfAbsent(className, key -> {
            try {
                return Class.forName(key);
            } catch (ClassNotFoundException e) {
                throw new RuntimeException(e);
            }
        });
    }
    
    /**
     * ä¼˜åŒ–çš„Methodè·å–æ–¹æ³•
     */
    public static Method getMethodOptimized(Class<?> clazz, String methodName, Class<?>... parameterTypes) 
            throws NoSuchMethodException {
        String key = clazz.getName() + "#" + methodName + "#" + Arrays.toString(parameterTypes);
        return METHOD_CACHE.computeIfAbsent(key, k -> {
            try {
                Method method = clazz.getDeclaredMethod(methodName, parameterTypes);
                method.setAccessible(true); // é¢„å…ˆè®¾ç½®è®¿é—®æƒé™
                return method;
            } catch (NoSuchMethodException e) {
                throw new RuntimeException(e);
            }
        });
    }
    
    /**
     * ä¼˜åŒ–çš„Fieldè·å–æ–¹æ³•
     */
    public static Field getFieldOptimized(Class<?> clazz, String fieldName) throws NoSuchFieldException {
        String key = clazz.getName() + "#" + fieldName;
        return FIELD_CACHE.computeIfAbsent(key, k -> {
            try {
                Field field = clazz.getDeclaredField(fieldName);
                field.setAccessible(true); // é¢„å…ˆè®¾ç½®è®¿é—®æƒé™
                return field;
            } catch (NoSuchFieldException e) {
                throw new RuntimeException(e);
            }
        });
    }
    
    /**
     * æ€§èƒ½æµ‹è¯•å¯¹æ¯”
     */
    public static void performanceTest() throws Exception {
        int iterations = 100000;
        Class<?> clazz = String.class;
        
        // æµ‹è¯•ç›´æ¥è°ƒç”¨ vs åå°„è°ƒç”¨
        String testStr = "Hello World";
        
        // ç›´æ¥è°ƒç”¨æ€§èƒ½æµ‹è¯•
        long startTime = System.nanoTime();
        for (int i = 0; i < iterations; i++) {
            testStr.length();
        }
        long directCallTime = System.nanoTime() - startTime;
        
        // åå°„è°ƒç”¨æ€§èƒ½æµ‹è¯•ï¼ˆæœªä¼˜åŒ–ï¼‰
        Method lengthMethod = clazz.getMethod("length");
        startTime = System.nanoTime();
        for (int i = 0; i < iterations; i++) {
            lengthMethod.invoke(testStr);
        }
        long reflectionCallTime = System.nanoTime() - startTime;
        
        // åå°„è°ƒç”¨æ€§èƒ½æµ‹è¯•ï¼ˆä¼˜åŒ–åï¼‰
        Method cachedMethod = getMethodOptimized(clazz, "length");
        startTime = System.nanoTime();
        for (int i = 0; i < iterations; i++) {
            cachedMethod.invoke(testStr);
        }
        long optimizedReflectionTime = System.nanoTime() - startTime;
        
        System.out.println("æ€§èƒ½æµ‹è¯•ç»“æœ (" + iterations + " æ¬¡è°ƒç”¨):");
        System.out.println("ç›´æ¥è°ƒç”¨: " + directCallTime / 1_000_000 + " ms");
        System.out.println("åå°„è°ƒç”¨(æœªä¼˜åŒ–): " + reflectionCallTime / 1_000_000 + " ms");
        System.out.println("åå°„è°ƒç”¨(ä¼˜åŒ–å): " + optimizedReflectionTime / 1_000_000 + " ms");
        System.out.println("åå°„æ€§èƒ½æŸå¤±: " + (reflectionCallTime / (double) directCallTime) + "x");
        System.out.println("ä¼˜åŒ–åæ€§èƒ½æŸå¤±: " + (optimizedReflectionTime / (double) directCallTime) + "x");
    }
    
    public static void main(String[] args) throws Exception {
        performanceTest();
    }
}
```

:::warning æ€§èƒ½æ³¨æ„äº‹é¡¹
1. **ç¼“å­˜åå°„å¯¹è±¡**ï¼šMethodã€Fieldã€Constructorå¯¹è±¡åº”è¯¥ç¼“å­˜å¤ç”¨
2. **é¢„è®¾è®¿é—®æƒé™**ï¼šæå‰è°ƒç”¨`setAccessible(true)`é¿å…é‡å¤æ£€æŸ¥
3. **é¿å…é¢‘ç¹åå°„**ï¼šåœ¨æ€§èƒ½æ•æ„Ÿçš„ä»£ç è·¯å¾„ä¸­è°¨æ…ä½¿ç”¨åå°„
4. **ä½¿ç”¨MethodHandle**ï¼šJava 7+å¯ä»¥è€ƒè™‘ä½¿ç”¨MethodHandleæ›¿ä»£åå°„
:::

</TabItem>
</Tabs>

## 2. å­—æ®µï¼ˆFieldï¼‰æ“ä½œè¯¦è§£

å­—æ®µåå°„å…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶è®¿é—®å’Œä¿®æ”¹å¯¹è±¡çš„å­—æ®µå€¼ï¼ŒåŒ…æ‹¬ç§æœ‰å­—æ®µã€‚

```mermaid
graph TB
    subgraph "å­—æ®µåå°„æ“ä½œæµç¨‹"
        A["è·å–Classå¯¹è±¡"] --> B["è·å–Fieldå¯¹è±¡"]
        B --> C["è®¾ç½®è®¿é—®æƒé™"]
        C --> D["å­—æ®µæ“ä½œ"]
        
        D --> D1["è·å–å­—æ®µå€¼ get()"]
        D --> D2["è®¾ç½®å­—æ®µå€¼ set()"]
        D --> D3["è·å–å­—æ®µç±»å‹ getType()"]
        D --> D4["è·å–å­—æ®µæ³¨è§£ getAnnotations()"]
    end
```

<Tabs>
<TabItem value="field-access" label="å­—æ®µè®¿é—®æ“ä½œ">

### å­—æ®µè®¿é—®ä¸æ“ä½œ

```java title="å­—æ®µåå°„æ“ä½œå®Œæ•´ç¤ºä¾‹"
import java.lang.reflect.*;

// ç¤ºä¾‹ç±»
class Person {
    private String name;
    protected int age;
    public String email;
    private static final String SPECIES = "Homo sapiens";
    
    public Person(String name, int age, String email) {
        this.name = name;
        this.age = age;
        this.email = email;
    }
    
    @Override
    public String toString() {
        return String.format("Person{name='%s', age=%d, email='%s'}", name, age, email);
    }
}

public class FieldReflectionDemo {
    public static void main(String[] args) throws Exception {
        Person person = new Person("å¼ ä¸‰", 25, "zhangsan@example.com");
        Class<?> personClass = person.getClass();
        
        System.out.println("åŸå§‹å¯¹è±¡: " + person);
        
        // 1. è·å–æ‰€æœ‰å­—æ®µï¼ˆåŒ…æ‹¬ç§æœ‰å­—æ®µï¼‰
        System.out.println("\n=== æ‰€æœ‰å£°æ˜çš„å­—æ®µ ===");
        Field[] declaredFields = personClass.getDeclaredFields();
        for (Field field : declaredFields) {
            System.out.printf("å­—æ®µ: %s, ç±»å‹: %s, ä¿®é¥°ç¬¦: %s%n", 
                field.getName(), 
                field.getType().getSimpleName(),
                Modifier.toString(field.getModifiers())
            );
        }
        
        // 2. è·å–å…¬å…±å­—æ®µ
        System.out.println("\n=== å…¬å…±å­—æ®µ ===");
        Field[] publicFields = personClass.getFields();
        for (Field field : publicFields) {
            System.out.println("å…¬å…±å­—æ®µ: " + field.getName());
        }
        
        // 3. è®¿é—®ç§æœ‰å­—æ®µ
        System.out.println("\n=== è®¿é—®ç§æœ‰å­—æ®µ ===");
        Field nameField = personClass.getDeclaredField("name");
        nameField.setAccessible(true); // çªç ´è®¿é—®æ§åˆ¶
        
        String originalName = (String) nameField.get(person);
        System.out.println("åŸå§‹å§“å: " + originalName);
        
        // ä¿®æ”¹ç§æœ‰å­—æ®µå€¼
        nameField.set(person, "æå››");
        System.out.println("ä¿®æ”¹åå¯¹è±¡: " + person);
        
        // 4. è®¿é—®é™æ€å­—æ®µ
        System.out.println("\n=== è®¿é—®é™æ€å­—æ®µ ===");
        Field speciesField = personClass.getDeclaredField("SPECIES");
        speciesField.setAccessible(true);
        String species = (String) speciesField.get(null); // é™æ€å­—æ®µä¼ null
        System.out.println("ç‰©ç§: " + species);
        
        // 5. å­—æ®µç±»å‹åˆ¤æ–­
        System.out.println("\n=== å­—æ®µç±»å‹åˆ¤æ–­ ===");
        for (Field field : declaredFields) {
            System.out.printf("å­—æ®µ %s: ", field.getName());
            System.out.printf("æ˜¯å¦é™æ€=%s, ", Modifier.isStatic(field.getModifiers()));
            System.out.printf("æ˜¯å¦final=%s, ", Modifier.isFinal(field.getModifiers()));
            System.out.printf("æ˜¯å¦ç§æœ‰=%s%n", Modifier.isPrivate(field.getModifiers()));
        }
    }
}
```

</TabItem>
<TabItem value="field-utils" label="å­—æ®µå·¥å…·ç±»">

### é€šç”¨å­—æ®µæ“ä½œå·¥å…·ç±»

```java title="å­—æ®µåå°„å·¥å…·ç±»"
import java.lang.reflect.*;
import java.util.*;

public class FieldUtils {
    
    /**
     * è·å–å¯¹è±¡çš„æ‰€æœ‰å­—æ®µå€¼ï¼ˆåŒ…æ‹¬ç»§æ‰¿çš„å­—æ®µï¼‰
     */
    public static Map<String, Object> getAllFieldValues(Object obj) {
        Map<String, Object> fieldValues = new HashMap<>();
        Class<?> clazz = obj.getClass();
        
        // éå†ç±»å±‚æ¬¡ç»“æ„
        while (clazz != null && clazz != Object.class) {
            Field[] fields = clazz.getDeclaredFields();
            for (Field field : fields) {
                if (!Modifier.isStatic(field.getModifiers())) {
                    try {
                        field.setAccessible(true);
                        Object value = field.get(obj);
                        fieldValues.put(field.getName(), value);
                    } catch (IllegalAccessException e) {
                        System.err.println("æ— æ³•è®¿é—®å­—æ®µ: " + field.getName());
                    }
                }
            }
            clazz = clazz.getSuperclass();
        }
        
        return fieldValues;
    }
    
    /**
     * å¤åˆ¶å¯¹è±¡å­—æ®µå€¼
     */
    public static void copyFields(Object source, Object target) {
        Class<?> sourceClass = source.getClass();
        Class<?> targetClass = target.getClass();
        
        Field[] sourceFields = sourceClass.getDeclaredFields();
        
        for (Field sourceField : sourceFields) {
            if (Modifier.isStatic(sourceField.getModifiers()) || 
                Modifier.isFinal(sourceField.getModifiers())) {
                continue;
            }
            
            try {
                Field targetField = targetClass.getDeclaredField(sourceField.getName());
                
                // æ£€æŸ¥ç±»å‹å…¼å®¹æ€§
                if (targetField.getType().isAssignableFrom(sourceField.getType())) {
                    sourceField.setAccessible(true);
                    targetField.setAccessible(true);
                    
                    Object value = sourceField.get(source);
                    targetField.set(target, value);
                    
                    System.out.println("å¤åˆ¶å­—æ®µ: " + sourceField.getName() + " = " + value);
                }
            } catch (NoSuchFieldException e) {
                System.out.println("ç›®æ ‡å¯¹è±¡æ²¡æœ‰å­—æ®µ: " + sourceField.getName());
            } catch (IllegalAccessException e) {
                System.err.println("æ— æ³•è®¿é—®å­—æ®µ: " + sourceField.getName());
            }
        }
    }
    
    /**
     * å°†å¯¹è±¡è½¬æ¢ä¸ºMap
     */
    public static Map<String, Object> objectToMap(Object obj) {
        Map<String, Object> map = new HashMap<>();
        Class<?> clazz = obj.getClass();
        
        Field[] fields = clazz.getDeclaredFields();
        for (Field field : fields) {
            if (!Modifier.isStatic(field.getModifiers())) {
                try {
                    field.setAccessible(true);
                    Object value = field.get(obj);
                    map.put(field.getName(), value);
                } catch (IllegalAccessException e) {
                    System.err.println("æ— æ³•è®¿é—®å­—æ®µ: " + field.getName());
                }
            }
        }
        
        return map;
    }
    
    /**
     * ä»Mapåˆ›å»ºå¯¹è±¡
     */
    public static <T> T mapToObject(Map<String, Object> map, Class<T> clazz) throws Exception {
        T instance = clazz.getDeclaredConstructor().newInstance();
        
        for (Map.Entry<String, Object> entry : map.entrySet()) {
            try {
                Field field = clazz.getDeclaredField(entry.getKey());
                field.setAccessible(true);
                field.set(instance, entry.getValue());
            } catch (NoSuchFieldException e) {
                System.out.println("å­—æ®µä¸å­˜åœ¨: " + entry.getKey());
            }
        }
        
        return instance;
    }
    
    /**
     * æŸ¥æ‰¾å¸¦æœ‰ç‰¹å®šæ³¨è§£çš„å­—æ®µ
     */
    public static List<Field> findFieldsWithAnnotation(Class<?> clazz, Class<? extends Annotation> annotationClass) {
        List<Field> annotatedFields = new ArrayList<>();
        
        Field[] fields = clazz.getDeclaredFields();
        for (Field field : fields) {
            if (field.isAnnotationPresent(annotationClass)) {
                annotatedFields.add(field);
            }
        }
        
        return annotatedFields;
    }
    
    // ä½¿ç”¨ç¤ºä¾‹
    public static void main(String[] args) throws Exception {
        Person person1 = new Person("å¼ ä¸‰", 25, "zhangsan@example.com");
        Person person2 = new Person("", 0, "");
        
        System.out.println("=== è·å–æ‰€æœ‰å­—æ®µå€¼ ===");
        Map<String, Object> fieldValues = getAllFieldValues(person1);
        fieldValues.forEach((name, value) -> System.out.println(name + " = " + value));
        
        System.out.println("\n=== å¤åˆ¶å­—æ®µå€¼ ===");
        System.out.println("å¤åˆ¶å‰ person2: " + person2);
        copyFields(person1, person2);
        System.out.println("å¤åˆ¶å person2: " + person2);
        
        System.out.println("\n=== å¯¹è±¡è½¬Map ===");
        Map<String, Object> personMap = objectToMap(person1);
        System.out.println("Person Map: " + personMap);
        
        System.out.println("\n=== Mapè½¬å¯¹è±¡ ===");
        Person person3 = mapToObject(personMap, Person.class);
        System.out.println("ä»Mapåˆ›å»ºçš„å¯¹è±¡: " + person3);
    }
}
```

</TabItem>
<TabItem value="field-annotations" label="å­—æ®µæ³¨è§£å¤„ç†">

### å­—æ®µæ³¨è§£å¤„ç†

```java title="å­—æ®µæ³¨è§£å¤„ç†ç¤ºä¾‹"
import java.lang.annotation.*;
import java.lang.reflect.*;

// è‡ªå®šä¹‰æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.FIELD)
@interface Validate {
    String message() default "éªŒè¯å¤±è´¥";
    int min() default 0;
    int max() default Integer.MAX_VALUE;
    boolean required() default false;
}

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.FIELD)
@interface JsonProperty {
    String value() default "";
}

// ä½¿ç”¨æ³¨è§£çš„ç¤ºä¾‹ç±»
class User {
    @Validate(required = true, message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @JsonProperty("username")
    private String name;
    
    @Validate(min = 18, max = 100, message = "å¹´é¾„å¿…é¡»åœ¨18-100ä¹‹é—´")
    private int age;
    
    @Validate(required = true, message = "é‚®ç®±ä¸èƒ½ä¸ºç©º")
    @JsonProperty("email_address")
    private String email;
    
    public User(String name, int age, String email) {
        this.name = name;
        this.age = age;
        this.email = email;
    }
    
    // getters and setters...
}

public class FieldAnnotationProcessor {
    
    /**
     * éªŒè¯å¯¹è±¡å­—æ®µ
     */
    public static boolean validateObject(Object obj) {
        Class<?> clazz = obj.getClass();
        Field[] fields = clazz.getDeclaredFields();
        boolean isValid = true;
        
        for (Field field : fields) {
            if (field.isAnnotationPresent(Validate.class)) {
                Validate validate = field.getAnnotation(Validate.class);
                
                try {
                    field.setAccessible(true);
                    Object value = field.get(obj);
                    
                    // æ£€æŸ¥å¿…å¡«é¡¹
                    if (validate.required() && (value == null || value.toString().trim().isEmpty())) {
                        System.err.println("éªŒè¯å¤±è´¥ - " + field.getName() + ": " + validate.message());
                        isValid = false;
                        continue;
                    }
                    
                    // æ£€æŸ¥æ•°å€¼èŒƒå›´
                    if (value instanceof Integer) {
                        int intValue = (Integer) value;
                        if (intValue < validate.min() || intValue > validate.max()) {
                            System.err.println("éªŒè¯å¤±è´¥ - " + field.getName() + ": " + validate.message());
                            isValid = false;
                        }
                    }
                    
                } catch (IllegalAccessException e) {
                    System.err.println("æ— æ³•è®¿é—®å­—æ®µ: " + field.getName());
                    isValid = false;
                }
            }
        }
        
        return isValid;
    }
    
    /**
     * å°†å¯¹è±¡è½¬æ¢ä¸ºJSONæ ¼å¼çš„Mapï¼ˆåŸºäºæ³¨è§£ï¼‰
     */
    public static Map<String, Object> toJsonMap(Object obj) {
        Map<String, Object> jsonMap = new HashMap<>();
        Class<?> clazz = obj.getClass();
        Field[] fields = clazz.getDeclaredFields();
        
        for (Field field : fields) {
            try {
                field.setAccessible(true);
                Object value = field.get(obj);
                
                String jsonKey = field.getName();
                if (field.isAnnotationPresent(JsonProperty.class)) {
                    JsonProperty jsonProperty = field.getAnnotation(JsonProperty.class);
                    if (!jsonProperty.value().isEmpty()) {
                        jsonKey = jsonProperty.value();
                    }
                }
                
                jsonMap.put(jsonKey, value);
                
            } catch (IllegalAccessException e) {
                System.err.println("æ— æ³•è®¿é—®å­—æ®µ: " + field.getName());
            }
        }
        
        return jsonMap;
    }
    
    public static void main(String[] args) {
        // æµ‹è¯•éªŒè¯åŠŸèƒ½
        User validUser = new User("å¼ ä¸‰", 25, "zhangsan@example.com");
        User invalidUser = new User("", 15, "");
        
        System.out.println("=== éªŒè¯æœ‰æ•ˆç”¨æˆ· ===");
        boolean isValid1 = validateObject(validUser);
        System.out.println("éªŒè¯ç»“æœ: " + (isValid1 ? "é€šè¿‡" : "å¤±è´¥"));
        
        System.out.println("\n=== éªŒè¯æ— æ•ˆç”¨æˆ· ===");
        boolean isValid2 = validateObject(invalidUser);
        System.out.println("éªŒè¯ç»“æœ: " + (isValid2 ? "é€šè¿‡" : "å¤±è´¥"));
        
        System.out.println("\n=== JSONè½¬æ¢ ===");
        Map<String, Object> jsonMap = toJsonMap(validUser);
        System.out.println("JSON Map: " + jsonMap);
    }
}
```

</TabItem>
</Tabs>

## 3. æ–¹æ³•ï¼ˆMethodï¼‰æ“ä½œè¯¦è§£

æ–¹æ³•åå°„æ˜¯åå°„æœºåˆ¶ä¸­æœ€å¤æ‚ä¹Ÿæ˜¯æœ€å¼ºå¤§çš„éƒ¨åˆ†ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶åŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ã€‚

```mermaid
graph TB
    subgraph "æ–¹æ³•åå°„æ“ä½œæµç¨‹"
        A["è·å–Classå¯¹è±¡"] --> B["è·å–Methodå¯¹è±¡"]
        B --> C["è®¾ç½®è®¿é—®æƒé™"]
        C --> D["å‡†å¤‡å‚æ•°"]
        D --> E["è°ƒç”¨æ–¹æ³• invoke()"]
        E --> F["å¤„ç†è¿”å›å€¼"]
        
        B --> B1["getMethod å…¬å…±æ–¹æ³•"]
        B --> B2["getDeclaredMethod æ‰€æœ‰æ–¹æ³•"]
        B --> B3["getMethods ç»§æ‰¿çš„å…¬å…±æ–¹æ³•"]
        B --> B4["getDeclaredMethods æ‰€æœ‰å£°æ˜æ–¹æ³•"]
    end
```

<Tabs>
<TabItem value="method-invoke" label="æ–¹æ³•è°ƒç”¨">

### æ–¹æ³•è°ƒç”¨ä¸å‚æ•°å¤„ç†

```java title="æ–¹æ³•åå°„è°ƒç”¨å®Œæ•´ç¤ºä¾‹"
import java.lang.reflect.*;
import java.util.*;

// ç¤ºä¾‹æœåŠ¡ç±»
class CalculatorService {
    public int add(int a, int b) {
        System.out.println("æ‰§è¡ŒåŠ æ³•: " + a + " + " + b);
        return a + b;
    }
    
    public double multiply(double a, double b) {
        System.out.println("æ‰§è¡Œä¹˜æ³•: " + a + " * " + b);
        return a * b;
    }
    
    private String formatResult(String operation, Object result) {
        return String.format("è¿ç®—ç»“æœ: %s = %s", operation, result);
    }
    
    public static String getServiceInfo() {
        return "è®¡ç®—å™¨æœåŠ¡ v1.0";
    }
    
    // é‡è½½æ–¹æ³•
    public String process(String input) {
        return "å¤„ç†å­—ç¬¦ä¸²: " + input;
    }
    
    public String process(int input) {
        return "å¤„ç†æ•´æ•°: " + input;
    }
    
    // å¯å˜å‚æ•°æ–¹æ³•
    public int sum(int... numbers) {
        int total = 0;
        for (int num : numbers) {
            total += num;
        }
        return total;
    }
}

public class MethodReflectionDemo {
    public static void main(String[] args) throws Exception {
        CalculatorService calculator = new CalculatorService();
        Class<?> calculatorClass = calculator.getClass();
        
        // 1. è°ƒç”¨å…¬å…±æ–¹æ³•
        System.out.println("=== è°ƒç”¨å…¬å…±æ–¹æ³• ===");
        Method addMethod = calculatorClass.getMethod("add", int.class, int.class);
        Object result1 = addMethod.invoke(calculator, 10, 20);
        System.out.println("åå°„è°ƒç”¨ç»“æœ: " + result1);
        
        // 2. è°ƒç”¨ç§æœ‰æ–¹æ³•
        System.out.println("\n=== è°ƒç”¨ç§æœ‰æ–¹æ³• ===");
        Method formatMethod = calculatorClass.getDeclaredMethod("formatResult", String.class, Object.class);
        formatMethod.setAccessible(true);
        Object result2 = formatMethod.invoke(calculator, "10 + 20", 30);
        System.out.println("ç§æœ‰æ–¹æ³•ç»“æœ: " + result2);
        
        // 3. è°ƒç”¨é™æ€æ–¹æ³•
        System.out.println("\n=== è°ƒç”¨é™æ€æ–¹æ³• ===");
        Method staticMethod = calculatorClass.getMethod("getServiceInfo");
        Object result3 = staticMethod.invoke(null); // é™æ€æ–¹æ³•ä¼ null
        System.out.println("é™æ€æ–¹æ³•ç»“æœ: " + result3);
        
        // 4. å¤„ç†é‡è½½æ–¹æ³•
        System.out.println("\n=== å¤„ç†é‡è½½æ–¹æ³• ===");
        Method processString = calculatorClass.getMethod("process", String.class);
        Method processInt = calculatorClass.getMethod("process", int.class);
        
        Object result4 = processString.invoke(calculator, "Hello");
        Object result5 = processInt.invoke(calculator, 42);
        System.out.println("é‡è½½æ–¹æ³•ç»“æœ1: " + result4);
        System.out.println("é‡è½½æ–¹æ³•ç»“æœ2: " + result5);
        
        // 5. å¤„ç†å¯å˜å‚æ•°æ–¹æ³•
        System.out.println("\n=== å¤„ç†å¯å˜å‚æ•°æ–¹æ³• ===");
        Method sumMethod = calculatorClass.getMethod("sum", int[].class);
        Object result6 = sumMethod.invoke(calculator, new int[]{1, 2, 3, 4, 5});
        System.out.println("å¯å˜å‚æ•°æ–¹æ³•ç»“æœ: " + result6);
        
        // 6. è·å–æ–¹æ³•ä¿¡æ¯
        System.out.println("\n=== æ–¹æ³•ä¿¡æ¯åˆ†æ ===");
        analyzeMethod(addMethod);
        analyzeMethod(formatMethod);
    }
    
    private static void analyzeMethod(Method method) {
        System.out.println("æ–¹æ³•å: " + method.getName());
        System.out.println("è¿”å›ç±»å‹: " + method.getReturnType().getSimpleName());
        System.out.println("å‚æ•°ç±»å‹: " + Arrays.toString(method.getParameterTypes()));
        System.out.println("ä¿®é¥°ç¬¦: " + Modifier.toString(method.getModifiers()));
        System.out.println("æ˜¯å¦å¯å˜å‚æ•°: " + method.isVarArgs());
        System.out.println("å¼‚å¸¸ç±»å‹: " + Arrays.toString(method.getExceptionTypes()));
        System.out.println("---");
    }
}
```

</TabItem>
<TabItem value="method-utils" label="æ–¹æ³•å·¥å…·ç±»">

### é€šç”¨æ–¹æ³•æ“ä½œå·¥å…·ç±»

```java title="æ–¹æ³•åå°„å·¥å…·ç±»"
import java.lang.reflect.*;
import java.util.*;
import java.util.concurrent.ConcurrentHashMap;

public class MethodUtils {
    // æ–¹æ³•ç¼“å­˜
    private static final Map<String, Method> METHOD_CACHE = new ConcurrentHashMap<>();
    
    /**
     * å®‰å…¨è°ƒç”¨æ–¹æ³•ï¼ˆå¸¦å¼‚å¸¸å¤„ç†ï¼‰
     */
    public static Object safeInvoke(Object target, String methodName, Object... args) {
        try {
            Class<?> clazz = target.getClass();
            Class<?>[] paramTypes = getParameterTypes(args);
            
            Method method = findMethod(clazz, methodName, paramTypes);
            if (method == null) {
                throw new NoSuchMethodException("æ‰¾ä¸åˆ°æ–¹æ³•: " + methodName);
            }
            
            method.setAccessible(true);
            return method.invoke(target, args);
            
        } catch (Exception e) {
            System.err.println("æ–¹æ³•è°ƒç”¨å¤±è´¥: " + methodName + " - " + e.getMessage());
            return null;
        }
    }
    
    /**
     * æŸ¥æ‰¾æ–¹æ³•ï¼ˆæ”¯æŒç»§æ‰¿å’Œé‡è½½ï¼‰
     */
    public static Method findMethod(Class<?> clazz, String methodName, Class<?>... paramTypes) {
        String cacheKey = clazz.getName() + "#" + methodName + "#" + Arrays.toString(paramTypes);
        
        return METHOD_CACHE.computeIfAbsent(cacheKey, key -> {
            // é¦–å…ˆå°è¯•ç²¾ç¡®åŒ¹é…
            try {
                return clazz.getDeclaredMethod(methodName, paramTypes);
            } catch (NoSuchMethodException e) {
                // å°è¯•åœ¨çˆ¶ç±»ä¸­æŸ¥æ‰¾
                return findMethodInHierarchy(clazz, methodName, paramTypes);
            }
        });
    }
    
    /**
     * åœ¨ç±»å±‚æ¬¡ç»“æ„ä¸­æŸ¥æ‰¾æ–¹æ³•
     */
    private static Method findMethodInHierarchy(Class<?> clazz, String methodName, Class<?>[] paramTypes) {
        Class<?> currentClass = clazz;
        
        while (currentClass != null && currentClass != Object.class) {
            try {
                return currentClass.getDeclaredMethod(methodName, paramTypes);
            } catch (NoSuchMethodException e) {
                // å°è¯•æ¨¡ç³ŠåŒ¹é…ï¼ˆå‚æ•°ç±»å‹å…¼å®¹ï¼‰
                Method[] methods = currentClass.getDeclaredMethods();
                for (Method method : methods) {
                    if (method.getName().equals(methodName) && 
                        isParameterTypesCompatible(method.getParameterTypes(), paramTypes)) {
                        return method;
                    }
                }
                currentClass = currentClass.getSuperclass();
            }
        }
        
        return null;
    }
    
    /**
     * æ£€æŸ¥å‚æ•°ç±»å‹å…¼å®¹æ€§
     */
    private static boolean isParameterTypesCompatible(Class<?>[] methodParams, Class<?>[] actualParams) {
        if (methodParams.length != actualParams.length) {
            return false;
        }
        
        for (int i = 0; i < methodParams.length; i++) {
            if (!methodParams[i].isAssignableFrom(actualParams[i])) {
                return false;
            }
        }
        
        return true;
    }
    
    /**
     * è·å–å‚æ•°ç±»å‹æ•°ç»„
     */
    private static Class<?>[] getParameterTypes(Object... args) {
        if (args == null || args.length == 0) {
            return new Class<?>[0];
        }
        
        Class<?>[] types = new Class<?>[args.length];
        for (int i = 0; i < args.length; i++) {
            types[i] = args[i] != null ? args[i].getClass() : Object.class;
        }
        
        return types;
    }
    
    /**
     * è·å–æ‰€æœ‰æ–¹æ³•ï¼ˆåŒ…æ‹¬ç»§æ‰¿çš„ï¼‰
     */
    public static List<Method> getAllMethods(Class<?> clazz) {
        List<Method> allMethods = new ArrayList<>();
        Class<?> currentClass = clazz;
        
        while (currentClass != null && currentClass != Object.class) {
            Method[] methods = currentClass.getDeclaredMethods();
            allMethods.addAll(Arrays.asList(methods));
            currentClass = currentClass.getSuperclass();
        }
        
        return allMethods;
    }
    
    /**
     * æŸ¥æ‰¾å¸¦æœ‰ç‰¹å®šæ³¨è§£çš„æ–¹æ³•
     */
    public static List<Method> findMethodsWithAnnotation(Class<?> clazz, Class<? extends Annotation> annotationClass) {
        List<Method> annotatedMethods = new ArrayList<>();
        List<Method> allMethods = getAllMethods(clazz);
        
        for (Method method : allMethods) {
            if (method.isAnnotationPresent(annotationClass)) {
                annotatedMethods.add(method);
            }
        }
        
        return annotatedMethods;
    }
    
    /**
     * æ–¹æ³•ç­¾åæ¯”è¾ƒ
     */
    public static boolean isSameSignature(Method method1, Method method2) {
        return method1.getName().equals(method2.getName()) &&
               Arrays.equals(method1.getParameterTypes(), method2.getParameterTypes());
    }
    
    /**
     * åˆ›å»ºæ–¹æ³•ä»£ç†
     */
    public static Object createMethodProxy(Object target, String methodName, Object... args) {
        return new Object() {
            public Object invoke() {
                return safeInvoke(target, methodName, args);
            }
        };
    }
    
    // ä½¿ç”¨ç¤ºä¾‹
    public static void main(String[] args) {
        CalculatorService calculator = new CalculatorService();
        
        System.out.println("=== å®‰å…¨æ–¹æ³•è°ƒç”¨ ===");
        Object result1 = safeInvoke(calculator, "add", 10, 20);
        System.out.println("ç»“æœ: " + result1);
        
        Object result2 = safeInvoke(calculator, "nonExistentMethod", "test");
        System.out.println("ä¸å­˜åœ¨çš„æ–¹æ³•ç»“æœ: " + result2);
        
        System.out.println("\n=== æŸ¥æ‰¾æ‰€æœ‰æ–¹æ³• ===");
        List<Method> allMethods = getAllMethods(CalculatorService.class);
        allMethods.forEach(method -> System.out.println("æ–¹æ³•: " + method.getName()));
        
        System.out.println("\n=== æ–¹æ³•ç­¾åæ¯”è¾ƒ ===");
        try {
            Method method1 = CalculatorService.class.getMethod("add", int.class, int.class);
            Method method2 = CalculatorService.class.getMethod("multiply", double.class, double.class);
            System.out.println("æ–¹æ³•ç­¾åç›¸åŒ: " + isSameSignature(method1, method2));
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        }
    }
}
```

</TabItem>
<TabItem value="method-interceptor" label="æ–¹æ³•æ‹¦æˆªå™¨">

### æ–¹æ³•æ‹¦æˆªå™¨å®ç°

```java title="æ–¹æ³•æ‹¦æˆªå™¨å’ŒAOPå®ç°"
import java.lang.annotation.*;
import java.lang.reflect.*;
import java.util.Arrays;

// æ–¹æ³•æ‰§è¡Œæ—¶é—´æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
@interface Timed {
    String value() default "";
}

// æ—¥å¿—æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
@interface Logged {
    boolean logParameters() default true;
    boolean logResult() default true;
}

// æ–¹æ³•æ‹¦æˆªå™¨æ¥å£
interface MethodInterceptor {
    Object intercept(Object target, Method method, Object[] args) throws Exception;
}

// æ‰§è¡Œæ—¶é—´æ‹¦æˆªå™¨
class TimingInterceptor implements MethodInterceptor {
    @Override
    public Object intercept(Object target, Method method, Object[] args) throws Exception {
        long startTime = System.nanoTime();
        
        try {
            Object result = method.invoke(target, args);
            return result;
        } finally {
            long endTime = System.nanoTime();
            long duration = (endTime - startTime) / 1_000_000; // è½¬æ¢ä¸ºæ¯«ç§’
            
            Timed timed = method.getAnnotation(Timed.class);
            String methodName = timed.value().isEmpty() ? method.getName() : timed.value();
            System.out.println(String.format("[TIMING] %s æ‰§è¡Œæ—¶é—´: %d ms", methodName, duration));
        }
    }
}

// æ—¥å¿—æ‹¦æˆªå™¨
class LoggingInterceptor implements MethodInterceptor {
    @Override
    public Object intercept(Object target, Method method, Object[] args) throws Exception {
        Logged logged = method.getAnnotation(Logged.class);
        
        if (logged.logParameters()) {
            System.out.println(String.format("[LOG] è°ƒç”¨æ–¹æ³•: %s, å‚æ•°: %s", 
                method.getName(), Arrays.toString(args)));
        }
        
        Object result = method.invoke(target, args);
        
        if (logged.logResult()) {
            System.out.println(String.format("[LOG] æ–¹æ³•: %s, è¿”å›å€¼: %s", 
                method.getName(), result));
        }
        
        return result;
    }
}

// ä»£ç†å·¥å‚
class ProxyFactory {
    public static <T> T createProxy(T target, MethodInterceptor... interceptors) {
        Class<?> targetClass = target.getClass();
        
        return (T) Proxy.newProxyInstance(
            targetClass.getClassLoader(),
            targetClass.getInterfaces(),
            new InvocationHandler() {
                @Override
                public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                    // æ£€æŸ¥æ–¹æ³•æ˜¯å¦éœ€è¦æ‹¦æˆª
                    boolean needsInterception = method.isAnnotationPresent(Timed.class) || 
                                              method.isAnnotationPresent(Logged.class);
                    
                    if (!needsInterception) {
                        return method.invoke(target, args);
                    }
                    
                    // åº”ç”¨æ‹¦æˆªå™¨
                    Object result = null;
                    for (MethodInterceptor interceptor : interceptors) {
                        if ((interceptor instanceof TimingInterceptor && method.isAnnotationPresent(Timed.class)) ||
                            (interceptor instanceof LoggingInterceptor && method.isAnnotationPresent(Logged.class))) {
                            result = interceptor.intercept(target, method, args);
                        }
                    }
                    
                    return result != null ? result : method.invoke(target, args);
                }
            }
        );
    }
}

// ä¸šåŠ¡æœåŠ¡æ¥å£
interface BusinessService {
    String processData(String data);
    int calculate(int a, int b);
    void doSomething();
}

// ä¸šåŠ¡æœåŠ¡å®ç°
class BusinessServiceImpl implements BusinessService {
    
    @Timed("æ•°æ®å¤„ç†")
    @Logged(logParameters = true, logResult = true)
    @Override
    public String processData(String data) {
        // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
        try {
            Thread.sleep(100);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
        return "å¤„ç†åçš„æ•°æ®: " + data.toUpperCase();
    }
    
    @Timed
    @Override
    public int calculate(int a, int b) {
        // æ¨¡æ‹Ÿå¤æ‚è®¡ç®—
        try {
            Thread.sleep(50);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
        return a * b + (a + b);
    }
    
    @Logged(logParameters = false, logResult = false)
    @Override
    public void doSomething() {
        System.out.println("æ‰§è¡ŒæŸäº›æ“ä½œ...");
    }
}

public class MethodInterceptorDemo {
    public static void main(String[] args) {
        // åˆ›å»ºåŸå§‹æœåŠ¡
        BusinessService originalService = new BusinessServiceImpl();
        
        // åˆ›å»ºä»£ç†æœåŠ¡
        BusinessService proxyService = ProxyFactory.createProxy(
            originalService,
            new TimingInterceptor(),
            new LoggingInterceptor()
        );
        
        System.out.println("=== ä½¿ç”¨ä»£ç†æœåŠ¡ ===");
        
        // æµ‹è¯•å¸¦æ—¶é—´å’Œæ—¥å¿—çš„æ–¹æ³•
        String result1 = proxyService.processData("hello world");
        System.out.println("æœ€ç»ˆç»“æœ: " + result1);
        
        System.out.println();
        
        // æµ‹è¯•åªå¸¦æ—¶é—´çš„æ–¹æ³•
        int result2 = proxyService.calculate(10, 20);
        System.out.println("è®¡ç®—ç»“æœ: " + result2);
        
        System.out.println();
        
        // æµ‹è¯•åªå¸¦æ—¥å¿—çš„æ–¹æ³•
        proxyService.doSomething();
    }
}
```

</TabItem>
</Tabs>

## 4. æ„é€ å™¨ï¼ˆConstructorï¼‰æ“ä½œè¯¦è§£

æ„é€ å™¨åå°„å…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼Œè¿™æ˜¯ä¾èµ–æ³¨å…¥æ¡†æ¶çš„æ ¸å¿ƒæŠ€æœ¯ã€‚

```mermaid
graph TB
    subgraph "æ„é€ å™¨åå°„æ“ä½œ"
        A["è·å–Classå¯¹è±¡"] --> B["è·å–Constructorå¯¹è±¡"]
        B --> C["è®¾ç½®è®¿é—®æƒé™"]
        C --> D["å‡†å¤‡æ„é€ å‚æ•°"]
        D --> E["åˆ›å»ºå®ä¾‹ newInstance()"]
        
        B --> B1["getConstructor å…¬å…±æ„é€ å™¨"]
        B --> B2["getDeclaredConstructor æ‰€æœ‰æ„é€ å™¨"]
        B --> B3["getConstructors æ‰€æœ‰å…¬å…±æ„é€ å™¨"]
        B --> B4["getDeclaredConstructors æ‰€æœ‰å£°æ˜æ„é€ å™¨"]
    end
```
# 5. æ³¨è§£ï¼ˆAnnotationï¼‰åå°„å¤„ç†

æ³¨è§£åå°„æ˜¯ç°ä»£Javaæ¡†æ¶çš„æ ¸å¿ƒæŠ€æœ¯ï¼ŒSpringã€Hibernateç­‰æ¡†æ¶å¤§é‡ä½¿ç”¨æ³¨è§£æ¥ç®€åŒ–é…ç½®ã€‚

```mermaid
graph TB
    subgraph "æ³¨è§£åå°„å¤„ç†æµç¨‹"
        A["å®šä¹‰æ³¨è§£"] --> B["ä½¿ç”¨æ³¨è§£æ ‡è®°"]
        B --> C["è¿è¡Œæ—¶è·å–æ³¨è§£"]
        C --> D["å¤„ç†æ³¨è§£ä¿¡æ¯"]
        D --> E["æ‰§è¡Œç›¸åº”é€»è¾‘"]
        
        C --> C1["getAnnotation"]
        C --> C2["getAnnotations"]
        C --> C3["isAnnotationPresent"]
        C --> C4["getDeclaredAnnotations"]
    end
```

<Tabs>
<TabItem value="annotation-basics" label="æ³¨è§£åŸºç¡€">

### æ³¨è§£å®šä¹‰ä¸ä½¿ç”¨

```java title="è‡ªå®šä¹‰æ³¨è§£å®Œæ•´ç¤ºä¾‹"
import java.lang.annotation.*;
import java.lang.reflect.*;
import java.util.*;

// 1. å­—æ®µéªŒè¯æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.FIELD)
@interface Validate {
    String message() default "éªŒè¯å¤±è´¥";
    int min() default 0;
    int max() default Integer.MAX_VALUE;
    boolean required() default false;
    String pattern() default "";
}

// 2. æ–¹æ³•çº§æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
@interface Cacheable {
    String key() default "";
    int expireTime() default 3600; // ç§’
}

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
@interface Transactional {
    String value() default "default";
    boolean readOnly() default false;
}

// 3. ç±»çº§æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@interface Entity {
    String tableName() default "";
}

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@interface Service {
    String value() default "";
}

// ä½¿ç”¨æ³¨è§£çš„ç¤ºä¾‹ç±»
@Entity(tableName = "users")
class User {
    @Validate(required = true, message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    private String username;
    
    @Validate(min = 18, max = 100, message = "å¹´é¾„å¿…é¡»åœ¨18-100ä¹‹é—´")
    private int age;
    
    @Validate(required = true, pattern = "^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$", message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    private String password;
    
    public User(String username, int age, String email, String password) {
        this.username = username;
        this.age = age;
        this.email = email;
        this.password = password;
    }
    
    // getters and setters...
    public String getUsername() { return username; }
    public int getAge() { return age; }
    public String getEmail() { return email; }
    public String getPassword() { return password; }
    
    @Override
    public String toString() {
        return String.format("User{username='%s', age=%d, email='%s'}", username, age, email);
    }
}

@Service("userService")
class UserService {
    
    @Cacheable(key = "user:{0}", expireTime = 1800)
    @Transactional(readOnly = true)
    public User findById(Long id) {
        System.out.println("ä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·: " + id);
        // æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢
        return new User("user" + id, 25, "user" + id + "@example.com", "password");
    }
    
    @Transactional
    public void saveUser(User user) {
        System.out.println("ä¿å­˜ç”¨æˆ·åˆ°æ•°æ®åº“: " + user);
        // æ¨¡æ‹Ÿä¿å­˜æ“ä½œ
    }
    
    @Cacheable(key = "userList", expireTime = 600)
    public List<User> findAll() {
        System.out.println("ä»æ•°æ®åº“æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·");
        // æ¨¡æ‹ŸæŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
        return Arrays.asList(
            new User("alice", 28, "alice@example.com", "pass1"),
            new User("bob", 32, "bob@example.com", "pass2")
        );
    }
}

public class AnnotationReflectionDemo {
    
    /**
     * éªŒè¯å¯¹è±¡å­—æ®µ
     */
    public static boolean validateObject(Object obj) {
        Class<?> clazz = obj.getClass();
        Field[] fields = clazz.getDeclaredFields();
        boolean isValid = true;
        
        System.out.println("éªŒè¯å¯¹è±¡: " + obj.getClass().getSimpleName());
        
        for (Field field : fields) {
            if (field.isAnnotationPresent(Validate.class)) {
                Validate validate = field.getAnnotation(Validate.class);
                
                try {
                    field.setAccessible(true);
                    Object value = field.get(obj);
                    
                    // æ£€æŸ¥å¿…å¡«é¡¹
                    if (validate.required()) {
                        if (value == null || (value instanceof String && ((String) value).trim().isEmpty())) {
                            System.err.println("  âŒ " + field.getName() + ": " + validate.message());
                            isValid = false;
                            continue;
                        }
                    }
                    
                    // æ£€æŸ¥æ•°å€¼èŒƒå›´
                    if (value instanceof Integer) {
                        int intValue = (Integer) value;
                        if (intValue < validate.min() || intValue > validate.max()) {
                            System.err.println("  âŒ " + field.getName() + ": " + validate.message());
                            isValid = false;
                        }
                    }
                    
                    // æ£€æŸ¥æ­£åˆ™è¡¨è¾¾å¼
                    if (!validate.pattern().isEmpty() && value instanceof String) {
                        String strValue = (String) value;
                        if (!strValue.matches(validate.pattern())) {
                            System.err.println("  âŒ " + field.getName() + ": " + validate.message());
                            isValid = false;
                        }
                    }
                    
                    if (isValid) {
                        System.out.println("  âœ… " + field.getName() + ": éªŒè¯é€šè¿‡");
                    }
                    
                } catch (IllegalAccessException e) {
                    System.err.println("æ— æ³•è®¿é—®å­—æ®µ: " + field.getName());
                    isValid = false;
                }
            }
        }
        
        return isValid;
    }
    
    /**
     * åˆ†æç±»çš„æ³¨è§£ä¿¡æ¯
     */
    public static void analyzeClassAnnotations(Class<?> clazz) {
        System.out.println("\n=== åˆ†æç±»æ³¨è§£: " + clazz.getSimpleName() + " ===");
        
        // ç±»çº§æ³¨è§£
        Annotation[] classAnnotations = clazz.getAnnotations();
        if (classAnnotations.length > 0) {
            System.out.println("ç±»æ³¨è§£:");
            for (Annotation annotation : classAnnotations) {
                System.out.println("  " + annotation);
                
                // å¤„ç†ç‰¹å®šæ³¨è§£
                if (annotation instanceof Entity) {
                    Entity entity = (Entity) annotation;
                    String tableName = entity.tableName().isEmpty() ? 
                        clazz.getSimpleName().toLowerCase() : entity.tableName();
                    System.out.println("    è¡¨å: " + tableName);
                }
                
                if (annotation instanceof Service) {
                    Service service = (Service) annotation;
                    String serviceName = service.value().isEmpty() ? 
                        clazz.getSimpleName() : service.value();
                    System.out.println("    æœåŠ¡å: " + serviceName);
                }
            }
        }
        
        // æ–¹æ³•æ³¨è§£
        Method[] methods = clazz.getDeclaredMethods();
        for (Method method : methods) {
            Annotation[] methodAnnotations = method.getAnnotations();
            if (methodAnnotations.length > 0) {
                System.out.println("æ–¹æ³• " + method.getName() + " çš„æ³¨è§£:");
                for (Annotation annotation : methodAnnotations) {
                    System.out.println("  " + annotation);
                }
            }
        }
    }
    
    public static void main(String[] args) {
        // æµ‹è¯•å¯¹è±¡éªŒè¯
        User validUser = new User("alice", 25, "alice@example.com", "password123");
        User invalidUser = new User("", 15, "invalid-email", "pass");
        
        System.out.println("=== éªŒè¯æœ‰æ•ˆç”¨æˆ· ===");
        boolean isValid1 = validateObject(validUser);
        System.out.println("éªŒè¯ç»“æœ: " + (isValid1 ? "âœ… é€šè¿‡" : "âŒ å¤±è´¥"));
        
        System.out.println("\n=== éªŒè¯æ— æ•ˆç”¨æˆ· ===");
        boolean isValid2 = validateObject(invalidUser);
        System.out.println("éªŒè¯ç»“æœ: " + (isValid2 ? "âœ… é€šè¿‡" : "âŒ å¤±è´¥"));
        
        // åˆ†æç±»æ³¨è§£
        analyzeClassAnnotations(User.class);
        analyzeClassAnnotations(UserService.class);
    }
}
```

</TabItem>
</Tabs>

## 6. åå°„åœ¨æ¡†æ¶ä¸­çš„åº”ç”¨

åå°„æ˜¯Javaæ¡†æ¶å¼€å‘çš„æ ¸å¿ƒæŠ€æœ¯ï¼ŒSpringã€Hibernateç­‰æ¡†æ¶éƒ½å¤§é‡ä½¿ç”¨åå°„ã€‚

:::tip æ¡†æ¶åº”ç”¨åœºæ™¯
- **ä¾èµ–æ³¨å…¥**ï¼šSpring IoCå®¹å™¨é€šè¿‡åå°„åˆ›å»ºå’Œæ³¨å…¥å¯¹è±¡
- **ORMæ˜ å°„**ï¼šHibernateé€šè¿‡åå°„å®ç°å¯¹è±¡å…³ç³»æ˜ å°„
- **AOPåˆ‡é¢**ï¼šåŠ¨æ€ä»£ç†å’Œå­—èŠ‚ç å¢å¼º
- **åºåˆ—åŒ–**ï¼šJSONã€XMLåºåˆ—åŒ–æ¡†æ¶
- **æµ‹è¯•æ¡†æ¶**ï¼šJUnité€šè¿‡åå°„å‘ç°å’Œæ‰§è¡Œæµ‹è¯•æ–¹æ³•
:::

é€šè¿‡æŒæ¡Javaåå°„æœºåˆ¶çš„æ ¸å¿ƒæ¦‚å¿µå’Œå®è·µæŠ€å·§ï¼Œä½ å¯ä»¥æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨å„ç§Javaæ¡†æ¶ï¼ŒåŒæ—¶å…·å¤‡å¼€å‘è‡ªå·±çš„æ¡†æ¶å’Œå·¥å…·çš„èƒ½åŠ›ã€‚

## 7. é¢è¯•é¢˜ç²¾é€‰

### 7.1 ä»€ä¹ˆæ˜¯Javaåå°„ï¼Ÿå®ƒçš„ä½œç”¨å’Œåº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ

**ç­”æ¡ˆï¼š** Javaåå°„æ˜¯ä¸€ç§åœ¨è¿è¡Œæ—¶æ£€æŸ¥ã€è®¿é—®å’Œä¿®æ”¹ç±»ã€æ¥å£ã€å­—æ®µå’Œæ–¹æ³•çš„æœºåˆ¶ã€‚å®ƒå…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶è€Œéç¼–è¯‘æ—¶è·å–ç±»çš„ä¿¡æ¯å¹¶æ“ä½œç±»çš„å¯¹è±¡ã€‚

**ä½œç”¨å’Œåº”ç”¨åœºæ™¯ï¼š**
1. **ä¾èµ–æ³¨å…¥æ¡†æ¶**ï¼šSpringæ¡†æ¶ä½¿ç”¨åå°„å®ç°ä¾èµ–æ³¨å…¥å’Œæ§åˆ¶åè½¬(IoC)
2. **ORMæ¡†æ¶**ï¼šHibernateç­‰ORMæ¡†æ¶ä½¿ç”¨åå°„å°†å¯¹è±¡æ˜ å°„åˆ°æ•°æ®åº“è¡¨
3. **å•å…ƒæµ‹è¯•æ¡†æ¶**ï¼šJUnitä½¿ç”¨åå°„æ¥è¯†åˆ«å’Œè¿è¡Œæµ‹è¯•æ–¹æ³•
4. **åºåˆ—åŒ–å’Œååºåˆ—åŒ–**ï¼šJacksonã€Gsonç­‰JSONåº“ä½¿ç”¨åå°„è‡ªåŠ¨åºåˆ—åŒ–å¯¹è±¡
5. **åŠ¨æ€ä»£ç†**ï¼šå®ç°AOP(é¢å‘åˆ‡é¢ç¼–ç¨‹)
6. **æ³¨è§£å¤„ç†**ï¼šåœ¨è¿è¡Œæ—¶å¤„ç†å’Œè§£é‡Šæ³¨è§£
7. **æ’ä»¶å’Œæ¨¡å—åŒ–ç³»ç»Ÿ**ï¼šåŠ¨æ€åŠ è½½å’Œä½¿ç”¨æ¨¡å—æˆ–æ’ä»¶
8. **IDEå¼€å‘å·¥å…·**ï¼šä»£ç è¡¥å…¨ã€è°ƒè¯•å™¨ç­‰åŠŸèƒ½

### 7.2 Javaåå°„çš„æ ¸å¿ƒAPIæœ‰å“ªäº›ï¼Ÿå¦‚ä½•è·å–Classå¯¹è±¡ï¼Ÿ

**ç­”æ¡ˆï¼š** Javaåå°„çš„æ ¸å¿ƒAPIä½äº`java.lang.reflect`åŒ…ä¸­ï¼Œä¸»è¦åŒ…æ‹¬ï¼š

1. **Class**ï¼šè¡¨ç¤ºç±»æˆ–æ¥å£çš„ç±»å‹ä¿¡æ¯
2. **Field**ï¼šè¡¨ç¤ºç±»çš„å­—æ®µï¼ˆæˆå‘˜å˜é‡ï¼‰
3. **Method**ï¼šè¡¨ç¤ºç±»çš„æ–¹æ³•
4. **Constructor**ï¼šè¡¨ç¤ºç±»çš„æ„é€ æ–¹æ³•
5. **Modifier**ï¼šæä¾›å¯¹ç±»å’Œæˆå‘˜è®¿é—®ä¿®é¥°ç¬¦çš„ä¿¡æ¯
6. **Array**ï¼šæä¾›åŠ¨æ€åˆ›å»ºå’Œè®¿é—®æ•°ç»„çš„é™æ€æ–¹æ³•
7. **Parameter**ï¼šè¡¨ç¤ºæ–¹æ³•æˆ–æ„é€ å‡½æ•°å‚æ•°ï¼ˆJava 8+ï¼‰

**è·å–Classå¯¹è±¡çš„æ–¹å¼ï¼š**
```java
// æ–¹å¼1ï¼šé€šè¿‡ç±»å.classï¼ˆç¼–è¯‘æ—¶ç¡®å®šï¼‰
Class<String> clazz1 = String.class;

// æ–¹å¼2ï¼šé€šè¿‡å¯¹è±¡çš„getClass()æ–¹æ³•ï¼ˆè¿è¡Œæ—¶ç¡®å®šï¼‰
String str = "Hello";
Class<?> clazz2 = str.getClass();

// æ–¹å¼3ï¼šé€šè¿‡Class.forName()ï¼ˆåŠ¨æ€åŠ è½½ï¼Œæœ€å¸¸ç”¨ï¼‰
Class<?> clazz3 = Class.forName("java.lang.String");

// æ–¹å¼4ï¼šé€šè¿‡ç±»åŠ è½½å™¨
ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
Class<?> clazz4 = classLoader.loadClass("java.lang.String");
```

### 7.3 Javaåå°„çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•æé«˜åå°„æ€§èƒ½ï¼Ÿ

**ç­”æ¡ˆï¼š**

**ä¼˜ç‚¹ï¼š**
1. **çµæ´»æ€§**ï¼šå…è®¸åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œä¿®æ”¹ç±»çš„è¡Œä¸º
2. **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒåˆ›å»ºå¯æ‰©å±•çš„åº”ç”¨å’Œæ¡†æ¶
3. **åŠ¨æ€æ€§**ï¼šèƒ½å¤ŸåŠ¨æ€åˆ›å»ºå¯¹è±¡å’Œè°ƒç”¨æ–¹æ³•
4. **è§£è€¦**ï¼šå¸®åŠ©å®ç°æ¾è€¦åˆè®¾è®¡

**ç¼ºç‚¹ï¼š**
1. **æ€§èƒ½æŸå¤±**ï¼šåå°„æ“ä½œæ¯”ç›´æ¥ä»£ç è°ƒç”¨æ…¢ï¼Œæœ‰æ€§èƒ½å¼€é”€
2. **å®‰å…¨é™åˆ¶**ï¼šå¯èƒ½è¿åè®¿é—®æ§åˆ¶è§„åˆ™
3. **ä»£ç å¤æ‚æ€§**ï¼šåå°„ä»£ç éš¾ä»¥ç†è§£å’Œç»´æŠ¤
4. **ç¼–è¯‘æ—¶æ£€æŸ¥ç¼ºå¤±**ï¼šç±»å‹é”™è¯¯åœ¨è¿è¡Œæ—¶æ‰ä¼šå‘ç°

**æé«˜åå°„æ€§èƒ½çš„æ–¹æ³•ï¼š**
1. **ç¼“å­˜åå°„å¯¹è±¡**ï¼šé‡ç”¨Classã€Methodã€Fieldç­‰åå°„å¯¹è±¡
2. **ä½¿ç”¨setAccessible(true)**ï¼šé¿å…Javaå®‰å…¨æ£€æŸ¥çš„å¼€é”€
3. **æ‰¹é‡æ“ä½œ**ï¼šä¸€æ¬¡è·å–æ‰€æœ‰éœ€è¦çš„åå°„ä¿¡æ¯ï¼Œé¿å…é‡å¤æŸ¥æ‰¾
4. **é™åˆ¶ä½¿ç”¨èŒƒå›´**ï¼šåªåœ¨å¿…è¦æ—¶ä½¿ç”¨åå°„
5. **ä½¿ç”¨MethodHandles**ï¼šJava 7å¼•å…¥çš„MethodHandleæ¯”ä¼ ç»Ÿåå°„æ€§èƒ½æ›´å¥½

### 7.4 åå°„ä¸­çš„setAccessible(true)ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ

**ç­”æ¡ˆï¼š** setAccessible(true)æ–¹æ³•ç”¨äºå–æ¶ˆJavaè¯­è¨€è®¿é—®æ£€æŸ¥ï¼Œä½¿å¾—å¯ä»¥è®¿é—®å’Œä¿®æ”¹åŸæœ¬æ— æ³•è®¿é—®çš„æˆå‘˜ï¼ˆå¦‚privateå­—æ®µæˆ–æ–¹æ³•ï¼‰ã€‚

**ä½œç”¨ï¼š**
1. **è®¿é—®ç§æœ‰æˆå‘˜**ï¼šå…è®¸è®¿é—®ç±»çš„privateå­—æ®µã€æ–¹æ³•å’Œæ„é€ å™¨
2. **æé«˜æ€§èƒ½**ï¼šç»•è¿‡JVMçš„å®‰å…¨æ£€æŸ¥ï¼Œæé«˜åå°„æ“ä½œçš„æ€§èƒ½

**ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼š**
1. **æ¡†æ¶å¼€å‘**ï¼šæ¡†æ¶éœ€è¦è®¿é—®ç”¨æˆ·ç±»çš„ç§æœ‰æˆå‘˜
2. **æµ‹è¯•ç›®çš„**ï¼šå•å…ƒæµ‹è¯•æ—¶å¯èƒ½éœ€è¦è®¿é—®ç§æœ‰æ–¹æ³•æˆ–å­—æ®µ
3. **åºåˆ—åŒ–/ååºåˆ—åŒ–**ï¼šåºåˆ—åŒ–åº“éœ€è¦è®¿é—®æ‰€æœ‰å­—æ®µï¼ŒåŒ…æ‹¬ç§æœ‰å­—æ®µ
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šåœ¨åå°„é¢‘ç¹ä½¿ç”¨çš„åœºæ™¯ä¸‹ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡

```java
// è®¿é—®ç§æœ‰å­—æ®µç¤ºä¾‹
Field field = targetClass.getDeclaredField("privateField");
field.setAccessible(true);  // å…³é”®æ­¥éª¤
field.set(targetObject, newValue);

// è°ƒç”¨ç§æœ‰æ–¹æ³•ç¤ºä¾‹
Method method = targetClass.getDeclaredMethod("privateMethod", String.class);
method.setAccessible(true);  // å…³é”®æ­¥éª¤
method.invoke(targetObject, "parameter");
```

**æ³¨æ„äº‹é¡¹ï¼š** è™½ç„¶setAccessible(true)å¯ä»¥ç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­åº”è°¨æ…ä½¿ç”¨ï¼Œä»¥å…ç ´åå°è£…æ€§ã€‚ä»Java 9å¼€å§‹ï¼Œæ¨¡å—ç³»ç»Ÿå¯ä»¥é™åˆ¶éæ³•åå°„è®¿é—®ã€‚

### 7.5 å¦‚ä½•é€šè¿‡åå°„è°ƒç”¨æ–¹æ³•ï¼Ÿå¦‚ä½•å¤„ç†æ–¹æ³•çš„å¼‚å¸¸ï¼Ÿ

**ç­”æ¡ˆï¼š** é€šè¿‡Methodå¯¹è±¡çš„invoke()æ–¹æ³•å¯ä»¥åå°„è°ƒç”¨æ–¹æ³•ï¼š

```java
public static void invokeMethod() {
    try {
        // è·å–Classå¯¹è±¡
        Class<?> clazz = Class.forName("java.util.ArrayList");
        
        // åˆ›å»ºå®ä¾‹
        Object list = clazz.getDeclaredConstructor().newInstance();
        
        // è·å–addæ–¹æ³•
        Method addMethod = clazz.getMethod("add", Object.class);
        
        // è°ƒç”¨addæ–¹æ³•
        boolean result = (boolean)addMethod.invoke(list, "Hello");
        
        // è·å–sizeæ–¹æ³•
        Method sizeMethod = clazz.getMethod("size");
        
        // è°ƒç”¨sizeæ–¹æ³•
        int size = (int)sizeMethod.invoke(list);
        
        System.out.println("æ·»åŠ ç»“æœ: " + result);
        System.out.println("åˆ—è¡¨å¤§å°: " + size);
        
    } catch (ClassNotFoundException e) {
        System.out.println("ç±»æœªæ‰¾åˆ°: " + e.getMessage());
    } catch (NoSuchMethodException e) {
        System.out.println("æ–¹æ³•æœªæ‰¾åˆ°: " + e.getMessage());
    } catch (InstantiationException | IllegalAccessException e) {
        System.out.println("å®ä¾‹åŒ–é”™è¯¯: " + e.getMessage());
    } catch (InvocationTargetException e) {
        // å¤„ç†ç›®æ ‡æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸
        System.out.println("æ–¹æ³•æ‰§è¡Œå¼‚å¸¸: " + e.getTargetException().getMessage());
    }
}
```

**å¤„ç†åå°„æ–¹æ³•çš„å¼‚å¸¸ï¼š**
1. **InvocationTargetException**ï¼šè¡¨ç¤ºè¢«è°ƒç”¨çš„æ–¹æ³•æœ¬èº«æŠ›å‡ºäº†å¼‚å¸¸ï¼Œé€šè¿‡getTargetException()å¯ä»¥è·å–åŸå§‹å¼‚å¸¸
2. **NoSuchMethodException**ï¼šå½“è¯·æ±‚çš„æ–¹æ³•ä¸å­˜åœ¨æ—¶æŠ›å‡º
3. **IllegalAccessException**ï¼šå½“è®¿é—®æ§åˆ¶ä¸å…è®¸æ‰§è¡Œæ“ä½œæ—¶æŠ›å‡º
4. **IllegalArgumentException**ï¼šå½“å‚æ•°ç±»å‹ä¸åŒ¹é…æ—¶æŠ›å‡º

**æœ€ä½³å®è·µï¼š**
- æ€»æ˜¯æ•è·å¹¶å¤„ç†InvocationTargetExceptionï¼Œå®ƒåŒ…è£…äº†ç›®æ ‡æ–¹æ³•çš„åŸå§‹å¼‚å¸¸
- æ£€æŸ¥å‚æ•°ç±»å‹çš„å…¼å®¹æ€§ï¼Œé¿å…ç±»å‹è½¬æ¢å¼‚å¸¸
- è€ƒè™‘ä½¿ç”¨try-with-resourcesè¯­å¥å¤„ç†å¯èƒ½éœ€è¦å…³é—­çš„èµ„æº