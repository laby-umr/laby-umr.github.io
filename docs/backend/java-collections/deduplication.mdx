---
sidebar_position: 3
title: "Javaé›†åˆå¯¹è±¡å»é‡æŠ€æœ¯è¯¦è§£"
description: "å…¨é¢ä»‹ç»Javaé›†åˆå¯¹è±¡å»é‡çš„æ ¸å¿ƒæŠ€æœ¯ã€å®ç°æ–¹æ³•ã€æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ"
authors: [Laby]
last_update:
  date: 2025-01-07
  author: Laby
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Java é›†åˆå¯¹è±¡å»é‡æŠ€æœ¯è¯¦è§£

åœ¨Javaå¼€å‘ä¸­ï¼Œå¯¹è±¡å»é‡æ˜¯ä¸€ä¸ªå¸¸è§ä¸”é‡è¦çš„éœ€æ±‚ã€‚æ— è®ºæ˜¯å¤„ç†ç”¨æˆ·æ•°æ®ã€ä¸šåŠ¡è®°å½•è¿˜æ˜¯ç³»ç»Ÿæ—¥å¿—ï¼Œå»é‡æŠ€æœ¯éƒ½èƒ½å¸®åŠ©æˆ‘ä»¬æé«˜æ•°æ®è´¨é‡ã€ä¼˜åŒ–å­˜å‚¨ç©ºé—´å’Œæå‡æŸ¥è¯¢æ€§èƒ½ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å„ç§å»é‡æŠ€æœ¯åŠå…¶é€‚ç”¨åœºæ™¯ã€‚

## 1. å¯¹è±¡å»é‡æ¦‚è¿°

### 1.1 ä»€ä¹ˆæ˜¯å¯¹è±¡å»é‡ï¼Ÿ

:::tip æ ¸å¿ƒæ¦‚å¿µ
**å¯¹è±¡å»é‡æ˜¯æŒ‡ä»é›†åˆä¸­ç§»é™¤é‡å¤å…ƒç´ ï¼Œä¿ç•™å”¯ä¸€å…ƒç´ çš„è¿‡ç¨‹ã€‚å»é‡çš„æ ¸å¿ƒåœ¨äºå¦‚ä½•å®šä¹‰"é‡å¤"ï¼š**

- ğŸ” **åŸºäºå¯¹è±¡å¼•ç”¨**ï¼šä¸¤ä¸ªå¯¹è±¡å¼•ç”¨æŒ‡å‘åŒä¸€å†…å­˜åœ°å€ï¼Œä½¿ç”¨`==`æ¯”è¾ƒ
- ğŸ“¦ **åŸºäºå¯¹è±¡å†…å®¹**ï¼šä¸¤ä¸ªå¯¹è±¡åœ¨ä¸šåŠ¡é€»è¾‘ä¸Šè¢«è®¤ä¸ºæ˜¯ç›¸åŒçš„ï¼Œé€šè¿‡`equals()`å’Œ`hashCode()`
- ğŸ·ï¸ **åŸºäºç‰¹å®šå­—æ®µ**ï¼šä¸¤ä¸ªå¯¹è±¡åœ¨æŒ‡å®šå­—æ®µä¸Šå…·æœ‰ç›¸åŒçš„å€¼ï¼Œä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒé€»è¾‘
- ğŸ”„ **åŸºäºç»„åˆæ¡ä»¶**ï¼šå¤šä¸ªå­—æ®µæˆ–å¤æ‚ä¸šåŠ¡è§„åˆ™çš„ç»„åˆåˆ¤æ–­
:::

### 1.2 å»é‡çš„é‡è¦æ€§

| é‡è¦æ€§ | å…·ä½“ä½“ç° | ä¸šåŠ¡ä»·å€¼ |
|--------|----------|----------|
| **æ•°æ®è´¨é‡** | é¿å…é‡å¤æ•°æ®å½±å“åˆ†æç»“æœ | æé«˜å†³ç­–å‡†ç¡®æ€§ |
| **å­˜å‚¨ä¼˜åŒ–** | å‡å°‘å†—ä½™æ•°æ®å ç”¨ç©ºé—´ | é™ä½å­˜å‚¨æˆæœ¬ |
| **æ€§èƒ½æå‡** | å‡å°‘é‡å¤æŸ¥è¯¢å’Œå¤„ç† | æå‡ç³»ç»Ÿå“åº”é€Ÿåº¦ |
| **ä¸šåŠ¡é€»è¾‘** | ç¡®ä¿ä¸šåŠ¡è§„åˆ™çš„ä¸€è‡´æ€§ | ç»´æŠ¤æ•°æ®å®Œæ•´æ€§ |

### 1.3 å»é‡æŠ€æœ¯åˆ†ç±»

```mermaid
graph TD
    A[Javaå¯¹è±¡å»é‡æŠ€æœ¯] --> B[åŸºäºé›†åˆ]
    A --> C[åŸºäºStream]
    A --> D[åŸºäºè‡ªå®šä¹‰é€»è¾‘]
    A --> E[åŸºäºæ•°æ®åº“]
    
    B --> B1[HashSet]
    B --> B2[TreeSet]
    B --> B3[LinkedHashSet]
    
    C --> C1[distinct()]
    C --> C2[toMap()]
    C --> C3[groupingBy()]
    C --> C4[collectingAndThen()]
    
    D --> D1[è‡ªå®šä¹‰æ¯”è¾ƒå™¨]
    D --> D2[å¤šå­—æ®µç»„åˆ]
    D --> D3[åŸºäºæ—¶é—´æˆ³]
    D --> D4[ä¸šåŠ¡è§„åˆ™]
    
    E --> E1[å”¯ä¸€çº¦æŸ]
    E --> E2[DISTINCTå…³é”®å­—]
    E --> E3[GROUP BYå­å¥]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B,C,D,E fill:#bbf,stroke:#333,stroke-width:1px
```

```java title="å»é‡æŠ€æœ¯åˆ†ç±»ç¤ºä¾‹"
public class DeduplicationTechniques {
    
    /**
     * åŸºäºé›†åˆçš„å»é‡æŠ€æœ¯
     */
    public enum CollectionBased {
        HASH_SET,      // åŸºäºHashSet
        TREE_SET,      // åŸºäºTreeSet
        LINKED_HASH_SET // åŸºäºLinkedHashSet
    }
    
    /**
     * åŸºäºStreamçš„å»é‡æŠ€æœ¯
     */
    public enum StreamBased {
        DISTINCT,      // ä½¿ç”¨distinct()æ–¹æ³•
        TO_MAP,        // ä½¿ç”¨toMap()æ”¶é›†å™¨
        COLLECTING_AND_THEN // ä½¿ç”¨collectingAndThen
    }
    
    /**
     * åŸºäºè‡ªå®šä¹‰é€»è¾‘çš„å»é‡æŠ€æœ¯
     */
    public enum CustomBased {
        COMPARATOR,    // è‡ªå®šä¹‰æ¯”è¾ƒå™¨
        MULTI_FIELD,   // å¤šå­—æ®µç»„åˆ
        TIMESTAMP,     // åŸºäºæ—¶é—´æˆ³
        BUSINESS_RULE  // åŸºäºä¸šåŠ¡è§„åˆ™
    }
}
```

## 2. åŸºæœ¬å»é‡æ–¹æ³•è¯¦è§£

<Tabs>
<TabItem value="hashset" label="HashSetå»é‡">

### 2.1 ä½¿ç”¨HashSetå»é‡

HashSetæ˜¯æœ€å¸¸ç”¨çš„å»é‡æ–¹å¼ï¼ŒåŸºäºå¯¹è±¡çš„hashCode()å’Œequals()æ–¹æ³•ï¼š

```java title="HashSetå»é‡å®Œæ•´ç¤ºä¾‹"
public class User {
    private String name;
    private int age;
    private String email;
    
    // æ„é€ å‡½æ•°
    public User(String name, int age, String email) {
        this.name = name;
        this.age = age;
        this.email = email;
    }
    
    // Getteræ–¹æ³•
    public String getName() { return name; }
    public int getAge() { return age; }
    public String getEmail() { return email; }
    
    @Override
    public boolean equals(Object obj) {
        if (this == obj) return true;
        if (obj == null || getClass() != obj.getClass()) return false;
        User user = (User) obj;
        return age == user.age && 
               Objects.equals(name, user.name) && 
               Objects.equals(email, user.email);
    }
    
    @Override
    public int hashCode() {
        return Objects.hash(name, age, email);
    }
    
    @Override
    public String toString() {
        return "User{name='" + name + "', age=" + age + ", email='" + email + "'}";
    }
}

// HashSetå»é‡ç¤ºä¾‹
public class HashSetDeduplicationExample {
    public static void main(String[] args) {
        // åˆ›å»ºåŒ…å«é‡å¤å…ƒç´ çš„ç”¨æˆ·åˆ—è¡¨
        List<User> users = Arrays.asList(
            new User("Alice", 25, "alice@example.com"),
            new User("Bob", 30, "bob@example.com"),
            new User("Alice", 25, "alice@example.com"),  // é‡å¤
            new User("Charlie", 35, "charlie@example.com"),
            new User("Bob", 30, "bob@example.com")       // é‡å¤
        );
        
        System.out.println("=== HashSetå»é‡ç¤ºä¾‹ ===");
        System.out.println("åŸå§‹ç”¨æˆ·åˆ—è¡¨å¤§å°: " + users.size());
        System.out.println("åŸå§‹ç”¨æˆ·åˆ—è¡¨: " + users);
        
        // ä½¿ç”¨HashSetå»é‡
        Set<User> uniqueUsers = new HashSet<>(users);
        List<User> deduplicatedList = new ArrayList<>(uniqueUsers);
        
        System.out.println("å»é‡åç”¨æˆ·åˆ—è¡¨å¤§å°: " + deduplicatedList.size());
        System.out.println("å»é‡åç”¨æˆ·åˆ—è¡¨: " + deduplicatedList);
        
        // éªŒè¯å»é‡æ•ˆæœ
        System.out.println("å»é‡æ•ˆæœ: " + (users.size() - deduplicatedList.size()) + " ä¸ªé‡å¤å…ƒç´ è¢«ç§»é™¤");
    }
}
```

#### HashSetå»é‡ç‰¹ç‚¹å¯¹æ¯”

| ç‰¹ç‚¹ | ä¼˜åŠ¿ | å±€é™æ€§ | é€‚ç”¨åœºæ™¯ |
|------|------|--------|----------|
| **æ—¶é—´å¤æ‚åº¦** | O(1) å¹³å‡æŸ¥æ‰¾æ—¶é—´ | æœ€åæƒ…å†µO(n) | ä¸€èˆ¬æ•°æ®é‡ |
| **ç©ºé—´å¤æ‚åº¦** | é¢å¤–ç©ºé—´å­˜å‚¨Set | éœ€è¦é¢å¤–å†…å­˜ | å†…å­˜å……è¶³ |
| **é¡ºåºä¿æŒ** | ä¸ä¿è¯åŸæœ‰é¡ºåº | é¡ºåºéšæœº | ä¸è¦æ±‚é¡ºåº |
| **nullå¤„ç†** | æ”¯æŒnullå€¼ | éœ€è¦ç‰¹æ®Šå¤„ç† | åŒ…å«nullçš„é›†åˆ |

</TabItem>
<TabItem value="stream" label="Stream APIå»é‡">

### 2.2 ä½¿ç”¨Stream APIå»é‡

Java 8çš„Stream APIæä¾›äº†æ›´ä¼˜é›…çš„å»é‡æ–¹å¼ï¼š

```java title="Stream APIå»é‡ç¤ºä¾‹"
public class StreamDeduplicationExample {
    public static void main(String[] args) {
        List<User> users = Arrays.asList(
            new User("Alice", 25, "alice@example.com"),
            new User("Bob", 30, "bob@example.com"),
            new User("Alice", 25, "alice@example.com"),
            new User("Charlie", 35, "charlie@example.com"),
            new User("Bob", 30, "bob@example.com")
        );
        
        System.out.println("=== Stream APIå»é‡ç¤ºä¾‹ ===");
        
        // 1. åŸºäºequalsæ–¹æ³•å»é‡ï¼ˆä¿æŒé¡ºåºï¼‰
        List<User> uniqueUsers = users.stream()
            .distinct()
            .collect(Collectors.toList());
        System.out.println("distinct()å»é‡ç»“æœ: " + uniqueUsers);
        
        // 2. åŸºäºç‰¹å®šå­—æ®µå»é‡ï¼ˆä¿ç•™ç¬¬ä¸€ä¸ªï¼‰
        List<User> uniqueByName = users.stream()
            .collect(Collectors.toMap(
                User::getName,
                user -> user,
                (existing, replacement) -> existing
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
        System.out.println("åŸºäºnameå­—æ®µå»é‡ç»“æœ: " + uniqueByName);
        
        // 3. åŸºäºå¤šä¸ªå­—æ®µå»é‡
        List<User> uniqueByNameAndAge = users.stream()
            .collect(Collectors.toMap(
                user -> user.getName() + "|" + user.getAge(),
                user -> user,
                (existing, replacement) -> existing
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
        System.out.println("åŸºäºnameå’Œageå­—æ®µå»é‡ç»“æœ: " + uniqueByNameAndAge);
        
        // 4. ä½¿ç”¨collectingAndThenä¼˜åŒ–
        List<User> optimizedUnique = users.stream()
            .collect(Collectors.collectingAndThen(
                Collectors.toMap(
                    User::getName,
                    user -> user,
                    (existing, replacement) -> existing
                ),
                map -> new ArrayList<>(map.values())
            ));
        System.out.println("ä¼˜åŒ–åçš„å»é‡ç»“æœ: " + optimizedUnique);
    }
}
```

#### Stream APIå»é‡æ–¹æ³•å¯¹æ¯”

| æ–¹æ³• | åŠŸèƒ½ | æ€§èƒ½ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| `distinct()` | åŸºäºequalså»é‡ | ä¸­ç­‰ | ä¿æŒé¡ºåºï¼ŒåŸºäºå¯¹è±¡å†…å®¹ |
| `toMap()` | åŸºäºå­—æ®µå»é‡ | è¾ƒé«˜ | åŸºäºç‰¹å®šå­—æ®µï¼Œå¯è‡ªå®šä¹‰å†²çªå¤„ç† |
| `collectingAndThen` | é“¾å¼æ“ä½œä¼˜åŒ– | é«˜ | éœ€è¦è¿›ä¸€æ­¥å¤„ç†çš„åœºæ™¯ |
| `groupingBy` | åˆ†ç»„åå»é‡ | ä¸­ç­‰ | éœ€è¦åˆ†ç»„ç»Ÿè®¡çš„åœºæ™¯ |

</TabItem>
<TabItem value="linkedhashset" label="LinkedHashSetå»é‡">

### 2.3 ä½¿ç”¨LinkedHashSetä¿æŒé¡ºåº

å¦‚æœéœ€è¦ä¿æŒåŸæœ‰é¡ºåºï¼š

```java title="LinkedHashSetä¿æŒé¡ºåºå»é‡ç¤ºä¾‹"
public class LinkedHashSetDeduplicationExample {
    public static void main(String[] args) {
        List<String> names = Arrays.asList(
            "Alice", "Bob", "Charlie", "Alice", "David", "Bob"
        );
        
        System.out.println("=== LinkedHashSetä¿æŒé¡ºåºå»é‡ç¤ºä¾‹ ===");
        System.out.println("åŸå§‹é¡ºåº: " + names);
        
        // ä½¿ç”¨LinkedHashSetä¿æŒé¡ºåº
        Set<String> uniqueNames = new LinkedHashSet<>(names);
        List<String> orderedUniqueList = new ArrayList<>(uniqueNames);
        
        System.out.println("å»é‡åé¡ºåº: " + orderedUniqueList);
        
        // å¯¹æ¯”HashSetï¼ˆä¸ä¿è¯é¡ºåºï¼‰
        Set<String> hashSetNames = new HashSet<>(names);
        List<String> unorderedList = new ArrayList<>(hashSetNames);
        System.out.println("HashSetå»é‡ï¼ˆä¸ä¿è¯é¡ºåºï¼‰: " + unorderedList);
        
        // æ€§èƒ½å¯¹æ¯”
        long startTime = System.nanoTime();
        Set<String> linkedHashSet = new LinkedHashSet<>(names);
        long linkedHashSetTime = System.nanoTime() - startTime;
        
        startTime = System.nanoTime();
        Set<String> hashSet = new HashSet<>(names);
        long hashSetTime = System.nanoTime() - startTime;
        
        System.out.println("LinkedHashSetè€—æ—¶: " + linkedHashSetTime + " çº³ç§’");
        System.out.println("HashSetè€—æ—¶: " + hashSetTime + " çº³ç§’");
        System.out.println("æ€§èƒ½å·®å¼‚: " + (linkedHashSetTime - hashSetTime) + " çº³ç§’");
    }
}
```

</TabItem>
<TabItem value="treeset" label="TreeSetå»é‡">

### 2.4 ä½¿ç”¨TreeSetæœ‰åºå»é‡

TreeSetåŸºäºçº¢é»‘æ ‘å®ç°ï¼Œåœ¨å»é‡çš„åŒæ—¶å¯ä»¥æŒ‰æŒ‡å®šé¡ºåºæ’åºï¼š

```java title="TreeSetå»é‡ç¤ºä¾‹"
public class TreeSetDeduplicationExample {
    public static void main(String[] args) {
        List<User> users = Arrays.asList(
            new User("Alice", 25, "alice@example.com"),
            new User("Bob", 30, "bob@example.com"),
            new User("Charlie", 35, "charlie@example.com"),
            new User("Bob", 30, "bob@example.com"),       // é‡å¤
            new User("Alice", 25, "alice@example.com")    // é‡å¤
        );
        
        System.out.println("=== TreeSetå»é‡ç¤ºä¾‹ ===");
        System.out.println("åŸå§‹ç”¨æˆ·åˆ—è¡¨: " + users);
        
        // ä½¿ç”¨TreeSetæŒ‰è‡ªç„¶é¡ºåºå»é‡
        // æ³¨æ„ï¼šUserç±»éœ€è¦å®ç°Comparableæ¥å£
        TreeSet<User> naturalOrderSet = new TreeSet<>(new Comparator<User>() {
            @Override
            public int compare(User u1, User u2) {
                int nameCompare = u1.getName().compareTo(u2.getName());
                if (nameCompare != 0) return nameCompare;
                return Integer.compare(u1.getAge(), u2.getAge());
            }
        });
        naturalOrderSet.addAll(users);
        
        System.out.println("è‡ªç„¶é¡ºåºå»é‡: " + naturalOrderSet);
        
        // ä½¿ç”¨TreeSetæŒ‰æŒ‡å®šé¡ºåºå»é‡
        TreeSet<User> ageOrderSet = new TreeSet<>(
            Comparator.comparingInt(User::getAge).thenComparing(User::getName)
        );
        ageOrderSet.addAll(users);
        
        System.out.println("æŒ‰å¹´é¾„æ’åºå»é‡: " + ageOrderSet);
        
        // ä½¿ç”¨TreeSetçš„å¯¼èˆªåŠŸèƒ½
        User first = ageOrderSet.first();
        User last = ageOrderSet.last();
        
        System.out.println("å¹´é¾„æœ€å°çš„ç”¨æˆ·: " + first);
        System.out.println("å¹´é¾„æœ€å¤§çš„ç”¨æˆ·: " + last);
        
        // èŒƒå›´æŸ¥è¯¢
        User target = new User("Bob", 30, "bob@example.com");
        User higher = ageOrderSet.higher(target); // è·å–æ¯”targetå¤§çš„ä¸‹ä¸€ä¸ªå…ƒç´ 
        
        if (higher != null) {
            System.out.println("æ¯”Bobå¹´é¾„å¤§çš„ä¸‹ä¸€ä¸ªç”¨æˆ·: " + higher);
        }
    }
}
```

| ç‰¹ç‚¹ | TreeSet | HashSet | LinkedHashSet |
|------|--------|---------|--------------|
| **å»é‡åŸç†** | åŸºäºçº¢é»‘æ ‘å’Œæ¯”è¾ƒå™¨ | åŸºäºå“ˆå¸Œç å’Œequals | åŸºäºå“ˆå¸Œç å’Œequals |
| **æ˜¯å¦æœ‰åº** | æ˜¯ï¼ˆè‡ªç„¶é¡ºåºæˆ–æ¯”è¾ƒå™¨æŒ‡å®šï¼‰ | å¦ | æ˜¯ï¼ˆæ’å…¥é¡ºåºï¼‰ |
| **æ—¶é—´å¤æ‚åº¦** | O(log n) | O(1) | O(1) |
| **ç©ºé—´å¤æ‚åº¦** | O(n) | O(n) | O(n) |
| **ç‰¹æœ‰åŠŸèƒ½** | èŒƒå›´æŸ¥è¯¢ã€å¯¼èˆªæ“ä½œ | æ—  | ä¿æŒæ’å…¥é¡ºåº |
| **é€‚ç”¨åœºæ™¯** | éœ€è¦æœ‰åºå»é‡ | ä¸€èˆ¬å»é‡åœºæ™¯ | ä¿æŒé¡ºåºçš„å»é‡ |

</TabItem>
</Tabs>

## 3. é«˜çº§å»é‡æŠ€æœ¯

```mermaid
graph TD
    A["é«˜çº§å»é‡æŠ€æœ¯"] --> B["åŸºäºå¤šå­—æ®µ"]
    A --> C["è‡ªå®šä¹‰æ¯”è¾ƒå™¨"]
    A --> D["åŸºäºæ—¶é—´æˆ³"]
    A --> E["ä¸šåŠ¡è§„åˆ™"]
    
    B --> B1["keyæ‹¼æ¥ (user.getName() + '|' + user.getAge())"]
    B --> B2["CompositeKeyå¯¹è±¡ (name, department, location)"]
    B --> B3["å¤šå­—æ®µæå–å™¨"]
    
    C --> C1["å­—æ®µä¼˜å…ˆçº§æ¯”è¾ƒå™¨"]
    C --> C2["æ¡ä»¶è¿‡æ»¤æ¯”è¾ƒå™¨"]
    C --> C3["é“¾å¼æ¯”è¾ƒå™¨"]
    
    D --> D1["ä¿ç•™æœ€æ–°è®°å½•"]
    D --> D2["ä¿ç•™æœ€æ—©è®°å½•"]
    D --> D3["æ—¶é—´çª—å£å»é‡"]
    
    E --> E1["ç‰¹æ®Šä¸šåŠ¡åœºæ™¯å»é‡"]
    E --> E2["ç»„åˆå¤šè§„åˆ™å»é‡"]
    E --> E3["åŸºäºå¤–éƒ¨æ•°æ®æºå»é‡"]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B,C,D,E fill:#bbf,stroke:#333,stroke-width:1px
```

<Tabs>
<TabItem value="multifield" label="å¤šå­—æ®µå»é‡">

### 3.1 åŸºäºå¤šä¸ªå­—æ®µå»é‡

```java title="å¤šå­—æ®µå»é‡ç¤ºä¾‹"
public class ComplexUser {
    private String name;
    private int age;
    private String department;
    private String location;
    
    // æ„é€ å‡½æ•°å’Œgetteræ–¹æ³•çœç•¥...
    
    /**
     * åŸºäºnameå’Œdepartmentå»é‡
     */
    public static List<ComplexUser> deduplicateByNameAndDept(List<ComplexUser> users) {
        return users.stream()
            .collect(Collectors.toMap(
                user -> user.getName() + "|" + user.getDepartment(),
                user -> user,
                (existing, replacement) -> existing
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
    }
    
    /**
     * åŸºäºå¤šä¸ªå­—æ®µç»„åˆå»é‡
     */
    public static List<ComplexUser> deduplicateByMultipleFields(
            List<ComplexUser> users, 
            Function<ComplexUser, String>... fieldExtractors) {
        
        return users.stream()
            .collect(Collectors.toMap(
                user -> Arrays.stream(fieldExtractors)
                    .map(extractor -> extractor.apply(user))
                    .filter(Objects::nonNull)
                    .collect(Collectors.joining("|")),
                user -> user,
                (existing, replacement) -> existing
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
    }
    
    /**
     * ä½¿ç”¨Builderæ¨¡å¼åˆ›å»ºå¤åˆé”®
     */
    public static class CompositeKey {
        private final String name;
        private final String department;
        private final String location;
        
        public CompositeKey(String name, String department, String location) {
            this.name = name;
            this.department = department;
            this.location = location;
        }
        
        @Override
        public boolean equals(Object obj) {
            if (this == obj) return true;
            if (obj == null || getClass() != obj.getClass()) return false;
            CompositeKey that = (CompositeKey) obj;
            return Objects.equals(name, that.name) &&
                   Objects.equals(department, that.department) &&
                   Objects.equals(location, that.location);
        }
        
        @Override
        public int hashCode() {
            return Objects.hash(name, department, location);
        }
    }
    
    /**
     * ä½¿ç”¨å¤åˆé”®å»é‡
     */
    public static List<ComplexUser> deduplicateByCompositeKey(List<ComplexUser> users) {
        return users.stream()
            .collect(Collectors.toMap(
                user -> new CompositeKey(user.getName(), user.getDepartment(), user.getLocation()),
                user -> user,
                (existing, replacement) -> existing
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
    }
}
```

</TabItem>
<TabItem value="comparator" label="è‡ªå®šä¹‰æ¯”è¾ƒå™¨å»é‡">

### 3.2 è‡ªå®šä¹‰æ¯”è¾ƒå™¨å»é‡

```java title="è‡ªå®šä¹‰æ¯”è¾ƒå™¨å»é‡ç¤ºä¾‹"
public class CustomComparatorDeduplicationExample {
    public static void main(String[] args) {
        List<User> users = Arrays.asList(
            new User("Alice", 25, "alice@example.com"),
            new User("Alice", 30, "alice2@example.com"),
            new User("Bob", 25, "bob@example.com"),
            new User("Bob", 30, "bob2@example.com")
        );
        
        System.out.println("=== è‡ªå®šä¹‰æ¯”è¾ƒå™¨å»é‡ç¤ºä¾‹ ===");
        
        // 1. ä½¿ç”¨TreeSetå’Œè‡ªå®šä¹‰æ¯”è¾ƒå™¨
        List<User> uniqueByName = users.stream()
            .collect(Collectors.toCollection(() -> 
                new TreeSet<>(Comparator.comparing(User::getName)
                    .thenComparing(User::getAge))
            ))
            .stream()
            .collect(Collectors.toList());
        System.out.println("åŸºäºnameå’Œageæ’åºå»é‡: " + uniqueByName);
        
        // 2. è‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘æ¯”è¾ƒå™¨
        Comparator<User> businessComparator = (u1, u2) -> {
            // é¦–å…ˆæŒ‰nameæ¯”è¾ƒ
            int nameCompare = u1.getName().compareTo(u2.getName());
            if (nameCompare != 0) return nameCompare;
            
            // nameç›¸åŒæ—¶ï¼ŒæŒ‰å¹´é¾„é™åºï¼ˆä¿ç•™å¹´é¾„å¤§çš„ï¼‰
            return Integer.compare(u2.getAge(), u1.getAge());
        };
        
        List<User> uniqueByBusinessRule = users.stream()
            .collect(Collectors.toCollection(() -> 
                new TreeSet<>(businessComparator)
            ))
            .stream()
            .collect(Collectors.toList());
        System.out.println("åŸºäºä¸šåŠ¡è§„åˆ™å»é‡: " + uniqueByBusinessRule);
        
        // 3. é“¾å¼æ¯”è¾ƒå™¨
        Comparator<User> chainedComparator = Comparator
            .comparing(User::getName)
            .thenComparing(User::getAge)
            .thenComparing(User::getEmail);
        
        List<User> uniqueByChained = users.stream()
            .collect(Collectors.toCollection(() -> 
                new TreeSet<>(chainedComparator)
            ))
            .stream()
            .collect(Collectors.toList());
        System.out.println("åŸºäºé“¾å¼æ¯”è¾ƒå™¨å»é‡: " + uniqueByChained);
    }
}
```

</TabItem>
<TabItem value="timestamp" label="æ—¶é—´æˆ³å»é‡">

### 3.3 åŸºäºæ—¶é—´æˆ³å»é‡

```java title="åŸºäºæ—¶é—´æˆ³å»é‡ç¤ºä¾‹"
public class TimestampedUser {
    private String name;
    private LocalDateTime timestamp;
    private String data;
    
    // æ„é€ å‡½æ•°å’Œgetteræ–¹æ³•çœç•¥...
    
    /**
     * ä¿ç•™æœ€æ–°çš„è®°å½•
     */
    public static List<TimestampedUser> deduplicateKeepLatest(List<TimestampedUser> users) {
        return users.stream()
            .collect(Collectors.toMap(
                TimestampedUser::getName,
                user -> user,
                (existing, replacement) -> 
                    existing.getTimestamp().isAfter(replacement.getTimestamp()) ? existing : replacement
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
    }
    
    /**
     * ä¿ç•™æœ€æ—©çš„è®°å½•
     */
    public static List<TimestampedUser> deduplicateKeepEarliest(List<TimestampedUser> users) {
        return users.stream()
            .collect(Collectors.toMap(
                TimestampedUser::getName,
                user -> user,
                (existing, replacement) -> 
                    existing.getTimestamp().isBefore(replacement.getTimestamp()) ? existing : replacement
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
    }
    
    /**
     * åŸºäºæ—¶é—´çª—å£å»é‡
     */
    public static List<TimestampedUser> deduplicateByTimeWindow(
            List<TimestampedUser> users, 
            Duration window) {
        
        return users.stream()
            .sorted(Comparator.comparing(TimestampedUser::getTimestamp))
            .collect(Collectors.toMap(
                TimestampedUser::getName,
                user -> user,
                (existing, replacement) -> {
                    Duration timeDiff = Duration.between(existing.getTimestamp(), replacement.getTimestamp());
                    return timeDiff.compareTo(window) <= 0 ? existing : replacement;
                }
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
    }
}
```

</TabItem>
</Tabs>

## 4. æ€§èƒ½ä¼˜åŒ–æŠ€å·§

```mermaid
graph TD
    A["æ€§èƒ½ä¼˜åŒ–æŠ€å·§"] --> B["æ•°æ®ç»“æ„ä¼˜åŒ–"]
    A --> C["ç®—æ³•ä¼˜åŒ–"]
    A --> D["å†…å­˜ä¼˜åŒ–"]
    A --> E["å¹¶å‘ä¼˜åŒ–"]
    
    B --> B1["é¢„åˆ†é…å®¹é‡ (new HashSet<>(size))"]
    B --> B2["é€‰æ‹©åˆé€‚çš„é›†åˆ"]
    B --> B3["è‡ªå®šä¹‰å“ˆå¸Œå‡½æ•°"]
    
    C --> C1["åˆ†æ‰¹å¤„ç†å¤§æ•°æ®é›†"]
    C --> C2["é¿å…é‡å¤è®¡ç®—"]
    C --> C3["å‡å°‘ä¸­é—´é›†åˆ"]
    
    D --> D1["é¿å…è£…ç®±æ‹†ç®±"]
    D --> D2["å¼±å¼•ç”¨ç¼“å­˜"]
    D --> D3["å»¶è¿ŸåŠ è½½"]
    
    E --> E1["å¹¶è¡Œæµå¤„ç†"]
    E --> E2["çº¿ç¨‹æ± æ‰§è¡Œ"]
    E --> E3["åˆ†æ®µå»é‡åˆå¹¶"]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B,C,D,E fill:#bbf,stroke:#333,stroke-width:1px
```

<Tabs>
<TabItem value="capacity" label="å®¹é‡ä¼˜åŒ–">

### 4.1 é¢„åˆ†é…å®¹é‡

```java title="é¢„åˆ†é…å®¹é‡ä¼˜åŒ–ç¤ºä¾‹"
public class CapacityOptimizationExample {
    public static void main(String[] args) {
        List<User> users = generateLargeUserList(10000);
        
        System.out.println("=== å®¹é‡ä¼˜åŒ–ç¤ºä¾‹ ===");
        
        // 1. é¢„åˆ†é…HashSetå®¹é‡ï¼Œé¿å…æ‰©å®¹
        long startTime = System.nanoTime();
        Set<User> uniqueUsers = new HashSet<>(users.size());
        uniqueUsers.addAll(users);
        long optimizedTime = System.nanoTime() - startTime;
        
        // 2. ä¸é¢„åˆ†é…å®¹é‡
        startTime = System.nanoTime();
        Set<User> uniqueUsers2 = new HashSet<>();
        uniqueUsers2.addAll(users);
        long defaultTime = System.nanoTime() - startTime;
        
        System.out.println("é¢„åˆ†é…å®¹é‡è€—æ—¶: " + optimizedTime + " çº³ç§’");
        System.out.println("é»˜è®¤å®¹é‡è€—æ—¶: " + defaultTime + " çº³ç§’");
        System.out.println("æ€§èƒ½æå‡: " + ((defaultTime - optimizedTime) * 100.0 / defaultTime) + "%");
        
        // 3. ä¸åŒåˆå§‹å®¹é‡çš„æ€§èƒ½å¯¹æ¯”
        testDifferentCapacities(users);
    }
    
    private static void testDifferentCapacities(List<User> users) {
        System.out.println("\n=== ä¸åŒåˆå§‹å®¹é‡æ€§èƒ½å¯¹æ¯” ===");
        
        int[] capacities = {16, 100, 1000, 10000, 20000};
        
        for (int capacity : capacities) {
            long startTime = System.nanoTime();
            Set<User> set = new HashSet<>(capacity);
            set.addAll(users);
            long time = System.nanoTime() - startTime;
            
            System.out.println("åˆå§‹å®¹é‡ " + capacity + ": " + time + " çº³ç§’");
        }
    }
    
    private static List<User> generateLargeUserList(int size) {
        List<User> users = new ArrayList<>(size);
        Random random = new Random();
        
        for (int i = 0; i < size; i++) {
            users.add(new User(
                "User" + random.nextInt(1000),
                random.nextInt(100),
                "user" + random.nextInt(1000) + "@example.com"
            ));
        }
        
        return users;
    }
}
```

</TabItem>
<TabItem value="parallel" label="å¹¶è¡Œæµä¼˜åŒ–">

### 4.2 ä½¿ç”¨å¹¶è¡Œæµå¤„ç†å¤§æ•°æ®é‡

```java title="å¹¶è¡Œæµå»é‡ç¤ºä¾‹"
public class ParallelStreamDeduplicationExample {
    public static void main(String[] args) {
        List<User> users = generateLargeUserList(100000);
        
        System.out.println("=== å¹¶è¡Œæµå»é‡æ€§èƒ½å¯¹æ¯” ===");
        
        // 1. ä¸²è¡Œæµå»é‡
        long startTime = System.nanoTime();
        List<User> uniqueUsers = users.stream()
            .distinct()
            .collect(Collectors.toList());
        long sequentialTime = System.nanoTime() - startTime;
        
        // 2. å¹¶è¡Œæµå»é‡
        startTime = System.nanoTime();
        List<User> uniqueUsersParallel = users.parallelStream()
            .distinct()
            .collect(Collectors.toList());
        long parallelTime = System.nanoTime() - startTime;
        
        System.out.println("ä¸²è¡Œæµå»é‡è€—æ—¶: " + sequentialTime + " çº³ç§’");
        System.out.println("å¹¶è¡Œæµå»é‡è€—æ—¶: " + parallelTime + " çº³ç§’");
        System.out.println("æ€§èƒ½æå‡: " + ((sequentialTime - parallelTime) * 100.0 / sequentialTime) + "%");
        
        // 3. ä¸åŒæ•°æ®é‡çš„æ€§èƒ½å¯¹æ¯”
        testDifferentDataSizes();
    }
    
    private static void testDifferentDataSizes() {
        System.out.println("\n=== ä¸åŒæ•°æ®é‡æ€§èƒ½å¯¹æ¯” ===");
        
        int[] sizes = {1000, 10000, 100000, 1000000};
        
        for (int size : sizes) {
            List<User> users = generateLargeUserList(size);
            
            long startTime = System.nanoTime();
            users.stream().distinct().collect(Collectors.toList());
            long sequentialTime = System.nanoTime() - startTime;
            
            startTime = System.nanoTime();
            users.parallelStream().distinct().collect(Collectors.toList());
            long parallelTime = System.nanoTime() - startTime;
            
            System.out.println("æ•°æ®é‡ " + size + ":");
            System.out.println("  ä¸²è¡Œ: " + sequentialTime + " çº³ç§’");
            System.out.println("  å¹¶è¡Œ: " + parallelTime + " çº³ç§’");
            System.out.println("  æå‡: " + ((sequentialTime - parallelTime) * 100.0 / sequentialTime) + "%");
        }
    }
    
    private static List<User> generateLargeUserList(int size) {
        List<User> users = new ArrayList<>(size);
        Random random = new Random();
        
        for (int i = 0; i < size; i++) {
            users.add(new User(
                "User" + random.nextInt(size / 10), // æ§åˆ¶é‡å¤ç‡
                random.nextInt(100),
                "user" + random.nextInt(size / 10) + "@example.com"
            ));
        }
        
        return users;
    }
}
```

</TabItem>
<TabItem value="batch" label="åˆ†æ‰¹å¤„ç†">

### 4.3 åˆ†æ‰¹å¤„ç†è¶…å¤§æ•°æ®é›†

```java title="åˆ†æ‰¹å¤„ç†å¤§æ•°æ®é›†ç¤ºä¾‹"
public class BatchProcessingDeduplicationExample {
    public static void main(String[] args) {
        List<User> users = generateLargeUserList(1000000);
        
        System.out.println("=== åˆ†æ‰¹å¤„ç†å¤§æ•°æ®é›†ç¤ºä¾‹ ===");
        System.out.println("æ•°æ®é›†å¤§å°: " + users.size());
        
        // 1. åˆ†æ‰¹å¤„ç†å»é‡
        int batchSize = 100000;
        long startTime = System.nanoTime();
        List<User> result = deduplicateLargeDataset(users, batchSize);
        long batchTime = System.nanoTime() - startTime;
        
        // 2. ç›´æ¥å¤„ç†å»é‡
        startTime = System.nanoTime();
        List<User> directResult = users.stream().distinct().collect(Collectors.toList());
        long directTime = System.nanoTime() - startTime;
        
        System.out.println("åˆ†æ‰¹å¤„ç†è€—æ—¶: " + batchTime + " çº³ç§’");
        System.out.println("ç›´æ¥å¤„ç†è€—æ—¶: " + directTime + " çº³ç§’");
        System.out.println("åˆ†æ‰¹å¤„ç†ç»“æœæ•°é‡: " + result.size());
        System.out.println("ç›´æ¥å¤„ç†ç»“æœæ•°é‡: " + directResult.size());
        
        // 3. ä¸åŒæ‰¹æ¬¡å¤§å°çš„æ€§èƒ½å¯¹æ¯”
        testDifferentBatchSizes(users);
    }
    
    public static <T> List<T> deduplicateLargeDataset(List<T> items, int batchSize) {
        Set<T> uniqueItems = new HashSet<>();
        List<T> result = new ArrayList<>();
        
        for (int i = 0; i < items.size(); i += batchSize) {
            int end = Math.min(i + batchSize, items.size());
            List<T> batch = items.subList(i, end);
            
            for (T item : batch) {
                if (uniqueItems.add(item)) {
                    result.add(item);
                }
            }
            
            // è¾“å‡ºè¿›åº¦
            if (i % (batchSize * 10) == 0) {
                System.out.println("å·²å¤„ç†: " + end + "/" + items.size());
            }
        }
        
        return result;
    }
    
    private static void testDifferentBatchSizes(List<User> users) {
        System.out.println("\n=== ä¸åŒæ‰¹æ¬¡å¤§å°æ€§èƒ½å¯¹æ¯” ===");
        
        int[] batchSizes = {10000, 50000, 100000, 200000};
        
        for (int batchSize : batchSizes) {
            long startTime = System.nanoTime();
            List<User> result = deduplicateLargeDataset(users, batchSize);
            long time = System.nanoTime() - startTime;
            
            System.out.println("æ‰¹æ¬¡å¤§å° " + batchSize + ": " + time + " çº³ç§’");
        }
    }
    
    private static List<User> generateLargeUserList(int size) {
        List<User> users = new ArrayList<>(size);
        Random random = new Random();
        
        for (int i = 0; i < size; i++) {
            users.add(new User(
                "User" + random.nextInt(size / 100), // æ§åˆ¶é‡å¤ç‡
                random.nextInt(100),
                "user" + random.nextInt(size / 100) + "@example.com"
            ));
        }
        
        return users;
    }
}
```

</TabItem>
</Tabs>

## 5. å®é™…åº”ç”¨åœºæ™¯

```mermaid
graph TD
    A["å®é™…åº”ç”¨åœºæ™¯"] --> B["æ•°æ®å±‚åº”ç”¨"]
    A --> C["ä¸šåŠ¡å±‚åº”ç”¨"]
    A --> D["å±•ç¤ºå±‚åº”ç”¨"]
    A --> E["ç³»ç»Ÿå±‚åº”ç”¨"]
    
    B --> B1["ç”¨æˆ·æ•°æ®å»é‡"]
    B --> B2["äº¤æ˜“è®°å½•å»é‡"]
    B --> B3["æ—¥å¿—æ•°æ®å»é‡"]
    
    C --> C1["ä¸šåŠ¡å¯¹è±¡å»é‡"]
    C --> C2["æŠ¥è¡¨æ•°æ®å»é‡"]
    C --> C3["æ¶ˆæ¯é˜Ÿåˆ—å»é‡"]
    
    D --> D1["ç•Œé¢å…ƒç´ å»é‡"]
    D --> D2["è¿”å›ç»“æœå»é‡"]
    D --> D3["æœç´¢ç»“æœå»é‡"]
    
    E --> E1["ç¼“å­˜æ•°æ®å»é‡"]
    E --> E2["é…ç½®ä¿¡æ¯å»é‡"]
    E --> E3["ä»»åŠ¡é˜Ÿåˆ—å»é‡"]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B,C,D,E fill:#bbf,stroke:#333,stroke-width:1px
```

<Tabs>
<TabItem value="user" label="ç”¨æˆ·æ•°æ®å»é‡">

### 5.1 ç”¨æˆ·æ•°æ®å»é‡

```java title="ç”¨æˆ·æ•°æ®å»é‡åº”ç”¨ç¤ºä¾‹"
public class UserDataDeduplicationExample {
    public static void main(String[] args) {
        // æ¨¡æ‹Ÿä»ä¸åŒæ•°æ®æºè·å–çš„ç”¨æˆ·æ•°æ®
        List<User> source1Users = Arrays.asList(
            new User("Alice", 25, "alice@example.com"),
            new User("Bob", 30, "bob@example.com"),
            new User("Charlie", 35, "charlie@example.com")
        );
        
        List<User> source2Users = Arrays.asList(
            new User("Alice", 25, "alice@example.com"), // é‡å¤
            new User("David", 28, "david@example.com"),
            new User("Eve", 32, "eve@example.com")
        );
        
        List<User> source3Users = Arrays.asList(
            new User("Bob", 30, "bob@example.com"), // é‡å¤
            new User("Frank", 40, "frank@example.com")
        );
        
        System.out.println("=== å¤šæ•°æ®æºç”¨æˆ·å»é‡ç¤ºä¾‹ ===");
        
        // åˆå¹¶æ‰€æœ‰æ•°æ®æº
        List<User> allUsers = new ArrayList<>();
        allUsers.addAll(source1Users);
        allUsers.addAll(source2Users);
        allUsers.addAll(source3Users);
        
        System.out.println("åˆå¹¶å‰æ€»ç”¨æˆ·æ•°: " + allUsers.size());
        
        // åŸºäºé‚®ç®±å»é‡ï¼ˆé‚®ç®±é€šå¸¸å”¯ä¸€ï¼‰
        List<User> uniqueByEmail = allUsers.stream()
            .collect(Collectors.toMap(
                User::getEmail,
                user -> user,
                (existing, replacement) -> existing
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
        
        System.out.println("åŸºäºé‚®ç®±å»é‡åç”¨æˆ·æ•°: " + uniqueByEmail.size());
        System.out.println("å»é‡æ•ˆæœ: " + (allUsers.size() - uniqueByEmail.size()) + " ä¸ªé‡å¤ç”¨æˆ·è¢«ç§»é™¤");
        
        // åŸºäºå§“åå’Œå¹´é¾„å»é‡ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
        List<User> uniqueByNameAndAge = allUsers.stream()
            .collect(Collectors.toMap(
                user -> user.getName() + "|" + user.getAge(),
                user -> user,
                (existing, replacement) -> existing
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
        
        System.out.println("åŸºäºå§“åå’Œå¹´é¾„å»é‡åç”¨æˆ·æ•°: " + uniqueByNameAndAge.size());
        
        // è¾“å‡ºå»é‡ç»“æœ
        System.out.println("\nå»é‡åçš„ç”¨æˆ·åˆ—è¡¨:");
        uniqueByEmail.forEach(user -> 
            System.out.println("  " + user.getName() + " (" + user.getAge() + ") - " + user.getEmail())
        );
    }
}
```

</TabItem>
<TabItem value="logs" label="æ—¥å¿—æ•°æ®å»é‡">

### 5.2 æ—¥å¿—æ•°æ®å»é‡

```java title="æ—¥å¿—æ•°æ®å»é‡åº”ç”¨ç¤ºä¾‹"
public class LogDeduplicationExample {
    public static void main(String[] args) {
        // æ¨¡æ‹Ÿæ—¥å¿—æ•°æ®
        List<LogEntry> logs = Arrays.asList(
            new LogEntry("ERROR", "Database connection failed", "2024-01-07 10:00:00", "user-service"),
            new LogEntry("ERROR", "Database connection failed", "2024-01-07 10:00:01", "user-service"),
            new LogEntry("ERROR", "Database connection failed", "2024-01-07 10:00:02", "user-service"),
            new LogEntry("INFO", "User login successful", "2024-01-07 10:01:00", "auth-service"),
            new LogEntry("WARN", "High memory usage", "2024-01-07 10:02:00", "system-monitor"),
            new LogEntry("WARN", "High memory usage", "2024-01-07 10:03:00", "system-monitor")
        );
        
        System.out.println("=== æ—¥å¿—æ•°æ®å»é‡ç¤ºä¾‹ ===");
        System.out.println("åŸå§‹æ—¥å¿—æ•°é‡: " + logs.size());
        
        // 1. åŸºäºæ—¥å¿—å†…å®¹å»é‡ï¼ˆä¿ç•™æœ€æ–°çš„ï¼‰
        List<LogEntry> uniqueByContent = logs.stream()
            .collect(Collectors.toMap(
                log -> log.getLevel() + "|" + log.getMessage() + "|" + log.getService(),
                log -> log,
                (existing, replacement) -> 
                    existing.getTimestamp().compareTo(replacement.getTimestamp()) > 0 ? existing : replacement
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
        
        System.out.println("åŸºäºå†…å®¹å»é‡åæ—¥å¿—æ•°é‡: " + uniqueByContent.size());
        
        // 2. åŸºäºæ—¶é—´çª—å£å»é‡ï¼ˆ5åˆ†é’Ÿå†…ç›¸åŒæ—¥å¿—è§†ä¸ºé‡å¤ï¼‰
        List<LogEntry> uniqueByTimeWindow = deduplicateLogsByTimeWindow(logs, Duration.ofMinutes(5));
        System.out.println("åŸºäºæ—¶é—´çª—å£å»é‡åæ—¥å¿—æ•°é‡: " + uniqueByTimeWindow.size());
        
        // 3. è¾“å‡ºå»é‡ç»“æœ
        System.out.println("\nå»é‡åçš„æ—¥å¿—:");
        uniqueByContent.forEach(log -> 
            System.out.println("  [" + log.getTimestamp() + "] " + log.getLevel() + 
                             " - " + log.getMessage() + " (" + log.getService() + ")")
        );
    }
    
    private static List<LogEntry> deduplicateLogsByTimeWindow(List<LogEntry> logs, Duration window) {
        return logs.stream()
            .sorted(Comparator.comparing(LogEntry::getTimestamp))
            .collect(Collectors.toMap(
                log -> log.getLevel() + "|" + log.getMessage() + "|" + log.getService(),
                log -> log,
                (existing, replacement) -> {
                    Duration timeDiff = Duration.between(existing.getTimestamp(), replacement.getTimestamp());
                    return timeDiff.compareTo(window) <= 0 ? existing : replacement;
                }
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
    }
}

class LogEntry {
    private String level;
    private String message;
    private LocalDateTime timestamp;
    private String service;
    
    // æ„é€ å‡½æ•°å’Œgetteræ–¹æ³•çœç•¥...
}
```

</TabItem>
<TabItem value="business" label="ä¸šåŠ¡æ•°æ®å»é‡">

### 5.3 ä¸šåŠ¡æ•°æ®å»é‡

```java title="ä¸šåŠ¡æ•°æ®å»é‡åº”ç”¨ç¤ºä¾‹"
public class BusinessDataDeduplicationExample {
    public static void main(String[] args) {
        // æ¨¡æ‹Ÿè®¢å•æ•°æ®
        List<Order> orders = Arrays.asList(
            new Order("ORD001", "Alice", 100.0, "2024-01-07 09:00:00", "PENDING"),
            new Order("ORD001", "Alice", 100.0, "2024-01-07 09:01:00", "CONFIRMED"), // é‡å¤è®¢å•å·
            new Order("ORD002", "Bob", 200.0, "2024-01-07 10:00:00", "PENDING"),
            new Order("ORD003", "Charlie", 150.0, "2024-01-07 11:00:00", "PENDING"),
            new Order("ORD003", "Charlie", 150.0, "2024-01-07 11:05:00", "CANCELLED") // é‡å¤è®¢å•å·
        );
        
        System.out.println("=== ä¸šåŠ¡æ•°æ®å»é‡ç¤ºä¾‹ ===");
        System.out.println("åŸå§‹è®¢å•æ•°é‡: " + orders.size());
        
        // 1. åŸºäºè®¢å•å·å»é‡ï¼ˆä¿ç•™æœ€æ–°çš„çŠ¶æ€ï¼‰
        List<Order> uniqueByOrderId = orders.stream()
            .collect(Collectors.toMap(
                Order::getOrderId,
                order -> order,
                (existing, replacement) -> 
                    existing.getTimestamp().compareTo(replacement.getTimestamp()) > 0 ? existing : replacement
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
        
        System.out.println("åŸºäºè®¢å•å·å»é‡åè®¢å•æ•°é‡: " + uniqueByOrderId.size());
        
        // 2. åŸºäºå®¢æˆ·å’Œé‡‘é¢å»é‡ï¼ˆé˜²æ­¢é‡å¤ä¸‹å•ï¼‰
        List<Order> uniqueByCustomerAndAmount = orders.stream()
            .collect(Collectors.toMap(
                order -> order.getCustomerName() + "|" + order.getAmount(),
                order -> order,
                (existing, replacement) -> 
                    existing.getTimestamp().compareTo(replacement.getTimestamp()) > 0 ? existing : replacement
            ))
            .values()
            .stream()
            .collect(Collectors.toList());
        
        System.out.println("åŸºäºå®¢æˆ·å’Œé‡‘é¢å»é‡åè®¢å•æ•°é‡: " + uniqueByCustomerAndAmount.size());
        
        // 3. è¾“å‡ºå»é‡ç»“æœ
        System.out.println("\nå»é‡åçš„è®¢å•:");
        uniqueByOrderId.forEach(order -> 
            System.out.println("  " + order.getOrderId() + " - " + order.getCustomerName() + 
                             " ($" + order.getAmount() + ") - " + order.getStatus() + 
                             " [" + order.getTimestamp() + "]")
        );
    }
}

class Order {
    private String orderId;
    private String customerName;
    private double amount;
    private LocalDateTime timestamp;
    private String status;
    
    // æ„é€ å‡½æ•°å’Œgetteræ–¹æ³•çœç•¥...
}
```

</TabItem>
</Tabs>

## 6. æœ€ä½³å®è·µæ€»ç»“

```mermaid
graph TD
    A["å»é‡æœ€ä½³å®è·µ"] --> B["ç­–ç•¥é€‰æ‹©"]
    A --> C["æ€§èƒ½ä¼˜åŒ–"]
    A --> D["é¿å…é™·é˜±"]
    A --> E["æµ‹è¯•éªŒè¯"]
    
    B --> B1["éœ€è¦é¡ºåº: LinkedHashSet"]
    B --> B2["é«˜æ€§èƒ½: HashSet"]
    B --> B3["è‡ªåŠ¨æ’åº: TreeSet"]
    B --> B4["å¤šå­—æ®µ: CompositeKey"]
    
    C --> C1["é¢„åˆ†é…å®¹é‡"]
    C --> C2["å‡å°‘ä¸´æ—¶å¯¹è±¡"]
    C --> C3["å¤§æ•°æ®é‡åˆ†æ‰¹å¤„ç†"]
    C --> C4["å¹¶è¡Œæµå¤„ç†"]
    
    D --> D1["é¿å…å¯å˜å¯¹è±¡ä½œä¸ºé”®"]
    D --> D2["æ³¨æ„è‡ªå®šä¹‰equals/hashCode"]
    D --> D3["é¿å…åˆ›å»ºå¤šä½™é›†åˆ"]
    D --> D4["å¤„ç†å¥½nullå€¼"]
    
    E --> E1["å•å…ƒæµ‹è¯•ä¸åŒåœºæ™¯"]
    E --> E2["æ€§èƒ½åŸºå‡†æµ‹è¯•"]
    E --> E3["è¾¹ç•Œæƒ…å†µéªŒè¯"]
    E --> E4["å†…å­˜ä½¿ç”¨ç›‘æ§"]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B,C,D,E fill:#bbf,stroke:#333,stroke-width:1px
```

### 6.1 å»é‡ç­–ç•¥é€‰æ‹©

:::tip æ ¸å¿ƒåŸåˆ™
é€‰æ‹©åˆé€‚çš„å»é‡ç­–ç•¥éœ€è¦è€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š
- **æ•°æ®è§„æ¨¡**ï¼šå°æ•°æ®é›†ä½¿ç”¨HashSetï¼Œå¤§æ•°æ®é›†è€ƒè™‘åˆ†æ‰¹å¤„ç†
- **æ€§èƒ½è¦æ±‚**ï¼šå¯¹æ€§èƒ½è¦æ±‚é«˜çš„åœºæ™¯ä½¿ç”¨å¹¶è¡Œæµ
- **å†…å­˜é™åˆ¶**ï¼šå†…å­˜å—é™æ—¶ä½¿ç”¨åˆ†æ‰¹å¤„ç†æˆ–å¤–éƒ¨å­˜å‚¨
- **ä¸šåŠ¡é€»è¾‘**ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„å»é‡å­—æ®µ
:::

### 6.2 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

| ä¼˜åŒ–ç­–ç•¥ | å…·ä½“æ–¹æ³• | é€‚ç”¨åœºæ™¯ | é¢„æœŸæ•ˆæœ |
|----------|----------|----------|----------|
| **é¢„åˆ†é…å®¹é‡** | ä½¿ç”¨ `new HashSet<>(expectedSize)` | å·²çŸ¥æ•°æ®é‡ | é¿å…æ‰©å®¹ï¼Œæå‡20-30% |
| **é€‰æ‹©åˆé€‚çš„é›†åˆ** | HashSetç”¨äºæŸ¥æ‰¾ï¼ŒTreeSetç”¨äºæ’åº | æ ¹æ®ä½¿ç”¨åœºæ™¯ | æå‡æŸ¥æ‰¾æ€§èƒ½ |
| **å¹¶è¡Œå¤„ç†** | ä½¿ç”¨ `parallelStream()` | å¤§æ•°æ®é‡ | å¤šæ ¸ç¯å¢ƒä¸‹æå‡2-4å€ |
| **åˆ†æ‰¹å¤„ç†** | å°†å¤§æ•°æ®é›†åˆ†æˆå°æ‰¹æ¬¡ | è¶…å¤§æ•°æ®é›† | é¿å…å†…å­˜æº¢å‡º |
| **ç¼“å­˜ç»“æœ** | ç¼“å­˜å»é‡ç»“æœ | é‡å¤å»é‡ | é¿å…é‡å¤è®¡ç®— |

### 6.3 å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ

:::caution æ³¨æ„äº‹é¡¹
åœ¨ä½¿ç”¨å»é‡æŠ€æœ¯æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å¸¸è§é™·é˜±ï¼š
:::

1. **equals()å’ŒhashCode()ä¸ä¸€è‡´**
   ```java
   // é”™è¯¯ï¼šequalså’ŒhashCodeä¸ä¸€è‡´
   @Override
   public boolean equals(Object obj) {
       if (this == obj) return true;
       if (obj == null || getClass() != obj.getClass()) return false;
       User user = (User) obj;
       return Objects.equals(name, user.name); // åªæ¯”è¾ƒname
   }
   
   @Override
   public int hashCode() {
       return Objects.hash(name, age, email); // ä½†hashCodeåŒ…å«æ‰€æœ‰å­—æ®µ
   }
   
   // æ­£ç¡®ï¼šä¿æŒä¸€è‡´æ€§
   @Override
   public boolean equals(Object obj) {
       if (this == obj) return true;
       if (obj == null || getClass() != obj.getClass()) return false;
       User user = (User) obj;
       return Objects.equals(name, user.name);
   }
   
   @Override
   public int hashCode() {
       return Objects.hash(name); // åªåŒ…å«equalsä¸­æ¯”è¾ƒçš„å­—æ®µ
   }
   ```

2. **Stream APIçš„å»¶è¿Ÿæ‰§è¡Œ**
   ```java
   // é”™è¯¯ï¼šStreamå»¶è¿Ÿæ‰§è¡Œå¯èƒ½å¯¼è‡´é—®é¢˜
   Stream<User> stream = users.stream().distinct();
   users.add(new User("New", 25, "new@example.com")); // è¿™ä¼šå½±å“streamçš„ç»“æœ
   List<User> result = stream.collect(Collectors.toList());
   
   // æ­£ç¡®ï¼šç«‹å³æ”¶é›†ç»“æœ
   List<User> result = users.stream().distinct().collect(Collectors.toList());
   users.add(new User("New", 25, "new@example.com")); // ä¸ä¼šå½±å“å·²æ”¶é›†çš„ç»“æœ
   ```

3. **å†…å­˜æº¢å‡ºé—®é¢˜**
   ```java
   // é”™è¯¯ï¼šç›´æ¥å¤„ç†è¶…å¤§æ•°æ®é›†
   List<User> hugeList = generateHugeList(10000000);
   Set<User> uniqueUsers = new HashSet<>(hugeList); // å¯èƒ½å†…å­˜æº¢å‡º
   
   // æ­£ç¡®ï¼šåˆ†æ‰¹å¤„ç†
   List<User> uniqueUsers = deduplicateLargeDataset(hugeList, 100000);
   ```

### 6.4 æµ‹è¯•å’Œè°ƒè¯•å»ºè®®

1. **å•å…ƒæµ‹è¯•è¦†ç›–**
   - æµ‹è¯•è¾¹ç•Œæ¡ä»¶ï¼ˆç©ºé›†åˆã€nullå€¼ã€å•ä¸ªå…ƒç´ ï¼‰
   - æµ‹è¯•é‡å¤å…ƒç´ çš„å¤„ç†é€»è¾‘
   - æµ‹è¯•ä¸åŒæ•°æ®ç±»å‹çš„å»é‡æ•ˆæœ

2. **æ€§èƒ½æµ‹è¯•**
   - ä½¿ç”¨JMHè¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•
   - æµ‹è¯•ä¸åŒæ•°æ®é‡ä¸‹çš„æ€§èƒ½è¡¨ç°
   - ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ

3. **è°ƒè¯•æŠ€å·§**
   - ä½¿ç”¨æ—¥å¿—è®°å½•å»é‡è¿‡ç¨‹
   - ä½¿ç”¨Stream APIçš„ `peek()` æ–¹æ³•è°ƒè¯•æµæ“ä½œ
   - éªŒè¯å»é‡ç»“æœçš„æ­£ç¡®æ€§

## 7. æ€»ç»“

Javaé›†åˆå¯¹è±¡å»é‡æŠ€æœ¯ä¸ºæ•°æ®å¤„ç†æä¾›äº†å¼ºå¤§è€Œçµæ´»çš„å·¥å…·ã€‚é€šè¿‡åˆç†ä½¿ç”¨å„ç§å»é‡æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š

- **æé«˜æ•°æ®è´¨é‡**ï¼šå»é™¤é‡å¤æ•°æ®ï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§
- **ä¼˜åŒ–å­˜å‚¨ç©ºé—´**ï¼šå‡å°‘å†—ä½™æ•°æ®ï¼Œé™ä½å­˜å‚¨æˆæœ¬
- **æå‡å¤„ç†æ€§èƒ½**ï¼šé¿å…é‡å¤è®¡ç®—ï¼Œæé«˜ç³»ç»Ÿå“åº”é€Ÿåº¦
- **æ”¯æŒä¸šåŠ¡éœ€æ±‚**ï¼šæ ¹æ®ä¸åŒçš„ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„å»é‡ç­–ç•¥

åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ï¼š

1. **ç†è§£ä¸šåŠ¡éœ€æ±‚**ï¼šæ˜ç¡®å»é‡çš„ä¸šåŠ¡å«ä¹‰å’Œè§„åˆ™
2. **é€‰æ‹©åˆé€‚çš„ç®—æ³•**ï¼šæ ¹æ®æ•°æ®è§„æ¨¡å’Œæ€§èƒ½è¦æ±‚é€‰æ‹©åˆé€‚çš„æ–¹æ³•
3. **æ³¨æ„æ€§èƒ½ä¼˜åŒ–**ï¼šåˆç†ä½¿ç”¨é¢„åˆ†é…å®¹é‡ã€å¹¶è¡Œå¤„ç†ç­‰æŠ€æœ¯
4. **ä¿è¯ä»£ç è´¨é‡**ï¼šæ­£ç¡®å®ç°equals()å’ŒhashCode()æ–¹æ³•ï¼Œå¤„ç†è¾¹ç•Œæƒ…å†µ

é€šè¿‡æ·±å…¥ç†è§£å’Œç†Ÿç»ƒè¿ç”¨è¿™äº›å»é‡æŠ€æœ¯ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ„å»ºå‡ºæ›´åŠ é«˜æ•ˆã€å¥å£®å’Œå¯ç»´æŠ¤çš„Javaåº”ç”¨ç¨‹åºã€‚ 