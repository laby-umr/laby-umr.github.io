---
sidebar_position: 4
title: Java Queueé›†åˆè¯¦è§£
description: å…¨é¢ä»‹ç»Java Queueæ¥å£åŠå…¶å®ç°ç±»ã€æ ¸å¿ƒç‰¹æ€§ã€æ€§èƒ½åˆ†æä¸æœ€ä½³å®è·µ
authors: [Laby]
last_update:
  date: 2025-08-07
  author: Laby
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Java Queue é›†åˆè¯¦è§£

Queueæ˜¯Javaé›†åˆæ¡†æ¶ä¸­ç”¨äºå¤„ç†å…ƒç´ é˜Ÿåˆ—çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒç»§æ‰¿è‡ªCollectionæ¥å£ï¼Œæä¾›äº†å…ˆè¿›å…ˆå‡º(FIFO)çš„æ•°æ®ç»“æ„ã€‚åœ¨Javaå¼€å‘ä¸­ï¼ŒQueueé›†åˆè¢«å¹¿æ³›åº”ç”¨äºä»»åŠ¡è°ƒåº¦ã€æ¶ˆæ¯ä¼ é€’ã€ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ç­‰å„ç§åœºæ™¯ï¼Œæ˜¯å¹¶å‘ç¼–ç¨‹å’Œå¼‚æ­¥å¤„ç†çš„é‡è¦åŸºç¡€ã€‚

:::tip æ ¸å¿ƒç‰¹æ€§
**Queueæ¥å£ = å…ˆè¿›å…ˆå‡º + é˜»å¡æ“ä½œæ”¯æŒ + ä¼˜å…ˆçº§æ’åº + çº¿ç¨‹å®‰å…¨ + å¹¶å‘æ§åˆ¶**

- ğŸš¶â€â™‚ï¸ **å…ˆè¿›å…ˆå‡º(FIFO)** - å…ƒç´ æŒ‰ç…§æ’å…¥é¡ºåºè¢«å¤„ç†ï¼Œéµå¾ª"å…ˆæ¥å…ˆæœåŠ¡"åŸåˆ™
- â³ **é˜»å¡æ“ä½œ** - æ”¯æŒåœ¨é˜Ÿåˆ—æ»¡æˆ–ç©ºæ—¶è‡ªåŠ¨ç­‰å¾…ï¼Œç®€åŒ–å¹¶å‘ç¼–ç¨‹
- ğŸ¥‡ **ä¼˜å…ˆçº§æ”¯æŒ** - å¯åŸºäºå…ƒç´ ä¼˜å…ˆçº§è€Œéæ’å…¥é¡ºåºè¿›è¡Œå¤„ç†
- ğŸ”’ **çº¿ç¨‹å®‰å…¨** - æä¾›å¤šç§çº¿ç¨‹å®‰å…¨å®ç°ï¼Œé€‚ç”¨äºå¹¶å‘ç¯å¢ƒ
- ğŸ”„ **åŒç«¯é˜Ÿåˆ—** - é€šè¿‡Dequeæ¥å£æ‰©å±•ï¼Œæ”¯æŒä¸¤ç«¯æ’å…¥å’Œåˆ é™¤æ“ä½œ
:::

## 1. Queueæ¥å£åŸºç¡€æ¦‚å¿µ

### 1.1 ä»€ä¹ˆæ˜¯Queueæ¥å£ï¼Ÿ

Queueæ¥å£æ˜¯Javaé›†åˆæ¡†æ¶ä¸­çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒç»§æ‰¿è‡ªCollectionæ¥å£ï¼Œä¸ºé˜Ÿåˆ—æ“ä½œæä¾›äº†å®Œæ•´çš„æŠ½è±¡ã€‚ä¸‹é¢æ˜¯Queueæ¥å£çš„ç»§æ‰¿å±‚æ¬¡ç»“æ„å’Œä¸»è¦å®ç°ç±»ï¼š

```mermaid
classDiagram
    Collection <|-- Queue
    Queue <|-- Deque
    Queue <|-- BlockingQueue
    BlockingQueue <|-- BlockingDeque
    
    Deque <|.. ArrayDeque
    Deque <|.. LinkedList
    
    BlockingQueue <|.. LinkedBlockingQueue
    BlockingQueue <|.. ArrayBlockingQueue
    BlockingQueue <|.. PriorityBlockingQueue
    BlockingQueue <|.. DelayQueue
    BlockingQueue <|.. SynchronousQueue
    
    BlockingDeque <|.. LinkedBlockingDeque
    
    Queue <|.. PriorityQueue
    
    class Collection {
        +add(E) boolean
        +remove(Object) boolean
        +contains(Object) boolean
        +size() int
        +isEmpty() boolean
        +iterator() Iterator
    }
    
    class Queue {
        +offer(E) boolean
        +poll() E
        +peek() E
        +element() E
        +remove() E
    }
    
    class Deque {
        +addFirst(E) void
        +addLast(E) void
        +offerFirst(E) boolean
        +offerLast(E) boolean
        +removeFirst() E
        +removeLast() E
        +pollFirst() E
        +pollLast() E
        +getFirst() E
        +getLast() E
        +peekFirst() E
        +peekLast() E
    }
    
    class BlockingQueue {
        +put(E) void
        +take() E
        +offer(E, long, TimeUnit) boolean
        +poll(long, TimeUnit) E
    }
    
    class BlockingDeque {
        +putFirst(E) void
        +putLast(E) void
        +takeFirst() E
        +takeLast() E
        +offerFirst(E, long, TimeUnit) boolean
        +offerLast(E, long, TimeUnit) boolean
        +pollFirst(long, TimeUnit) E
        +pollLast(long, TimeUnit) E
    }
    
    <<interface>> Collection
    <<interface>> Queue
    <<interface>> Deque
    <<interface>> BlockingQueue
    <<interface>> BlockingDeque
```

Queueé›†åˆå…·æœ‰ä»¥ä¸‹æ ¸å¿ƒç‰¹å¾ï¼š

- **å…ˆè¿›å…ˆå‡º**ï¼šå…ƒç´ æŒ‰ç…§æ’å…¥é¡ºåºå¤„ç†ï¼Œæœ€å…ˆæ’å…¥çš„å…ƒç´ æœ€å…ˆè¢«å¤„ç†
- **é˜»å¡æ“ä½œ**ï¼šæŸäº›å®ç°ç±»æ”¯æŒé˜»å¡æ“ä½œï¼Œé€‚åˆå¹¶å‘ç¯å¢ƒ
- **ä¼˜å…ˆçº§æ’åº**ï¼šæŸäº›å®ç°ç±»æ”¯æŒæŒ‰ä¼˜å…ˆçº§æ’åº
- **çº¿ç¨‹å®‰å…¨**ï¼šæŸäº›å®ç°ç±»æä¾›çº¿ç¨‹å®‰å…¨ä¿è¯
- **å¹¶å‘æ§åˆ¶**ï¼šæ”¯æŒç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼

### 1.2 Queueæ¥å£çš„é‡è¦æ€§

| é‡è¦æ€§ | å…·ä½“ä½“ç° | ä¸šåŠ¡ä»·å€¼ |
|--------|----------|----------|
| **ä»»åŠ¡è°ƒåº¦** | æä¾›æœ‰åºçš„ä»»åŠ¡å¤„ç†æœºåˆ¶ | æ”¯æŒç³»ç»Ÿä»»åŠ¡çš„æœ‰åºæ‰§è¡Œ |
| **æ¶ˆæ¯ä¼ é€’** | å®ç°å¼‚æ­¥æ¶ˆæ¯å¤„ç† | æé«˜ç³»ç»Ÿå“åº”æ€§èƒ½ |
| **å¹¶å‘æ§åˆ¶** | æ”¯æŒå¤šçº¿ç¨‹é—´çš„æ•°æ®ä¼ é€’ | ç®€åŒ–å¹¶å‘ç¼–ç¨‹å¤æ‚åº¦ |
| **èµ„æºç®¡ç†** | æ§åˆ¶èµ„æºè®¿é—®é¡ºåº | é¿å…èµ„æºç«äº‰å’Œæ­»é” |

### 1.3 Queueæ¥å£è®¾è®¡åŸåˆ™

Queueæ¥å£çš„è®¾è®¡éµå¾ªä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒåŸåˆ™ï¼š

#### FIFOåŸåˆ™
æä¾›å…ˆè¿›å…ˆå‡ºçš„å…ƒç´ å¤„ç†é¡ºåºï¼Œä¿è¯å¤„ç†çš„å…¬å¹³æ€§

#### é˜»å¡åŸåˆ™  
æ”¯æŒé˜»å¡æ“ä½œï¼Œåœ¨é˜Ÿåˆ—æ»¡æˆ–ç©ºæ—¶è‡ªåŠ¨ç­‰å¾…

#### ä¼˜å…ˆçº§åŸåˆ™
æ”¯æŒæŒ‰ä¼˜å…ˆçº§æ’åºï¼Œæ»¡è¶³ä¸åŒä¸šåŠ¡åœºæ™¯éœ€æ±‚

#### å¹¶å‘åŸåˆ™
æä¾›çº¿ç¨‹å®‰å…¨çš„æ“ä½œï¼Œæ”¯æŒå¤šçº¿ç¨‹ç¯å¢ƒ

```java title="Queueæ¥å£æ ¸å¿ƒæ–¹æ³•ç¤ºä¾‹"
public interface Queue<E> extends Collection<E> {
    
    // ========== æ·»åŠ æ“ä½œ ==========
    boolean add(E e);                    // æ·»åŠ å…ƒç´ ï¼Œå¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸
    boolean offer(E e);                  // æ·»åŠ å…ƒç´ ï¼Œå¤±è´¥æ—¶è¿”å›false
    
    // ========== åˆ é™¤æ“ä½œ ==========
    E remove();                          // åˆ é™¤å¹¶è¿”å›å¤´éƒ¨å…ƒç´ ï¼Œå¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸
    E poll();                           // åˆ é™¤å¹¶è¿”å›å¤´éƒ¨å…ƒç´ ï¼Œå¤±è´¥æ—¶è¿”å›null
    
    // ========== æŸ¥çœ‹æ“ä½œ ==========
    E element();                        // æŸ¥çœ‹å¤´éƒ¨å…ƒç´ ï¼Œå¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸
    E peek();                          // æŸ¥çœ‹å¤´éƒ¨å…ƒç´ ï¼Œå¤±è´¥æ—¶è¿”å›null
}
```

### 1.4 Queueæ¥å£æ–¹æ³•åˆ†ç±»è¯¦è§£

Queueæ¥å£æä¾›äº†ä¸°å¯Œçš„æ–¹æ³•æ¥æ“ä½œé˜Ÿåˆ—ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥åˆ†ä¸ºå‡ ä¸ªä¸»è¦ç±»åˆ«ï¼š

```mermaid
graph TD
    A["Queueæ–¹æ³•åˆ†ç±»"] --> B["æ·»åŠ æ“ä½œ"]
    A --> C["åˆ é™¤æ“ä½œ"]
    A --> D["æ£€æŸ¥æ“ä½œ"]
    A --> E["é˜»å¡æ“ä½œ"]
    
    B --> B1["add/offer"]
    B --> B2["addAll"]
    
    C --> C1["remove/poll"]
    C --> C2["remove(Object)"]
    C --> C3["clear"]
    
    D --> D1["element/peek"]
    D --> D2["isEmpty"]
    D --> D3["contains"]
    
    E --> E1["put/take"]
    E --> E2["é˜»å¡offer/poll"]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B,C,D,E fill:#bbf,stroke:#333,stroke-width:1px
```

<Tabs>
<TabItem value="add" label="æ·»åŠ æ“ä½œæ–¹æ³•">

```java title="Queueæ·»åŠ æ“ä½œæ–¹æ³•"
public interface Queue<E> extends Collection<E> {
    
    // æ·»åŠ å…ƒç´ åˆ°é˜Ÿåˆ—å°¾éƒ¨
    boolean add(E e);                    // æ·»åŠ å…ƒç´ ï¼Œé˜Ÿåˆ—æ»¡æ—¶æŠ›å‡ºIllegalStateException
    boolean offer(E e);                  // æ·»åŠ å…ƒç´ ï¼Œé˜Ÿåˆ—æ»¡æ—¶è¿”å›false
    
    // ç»§æ‰¿è‡ªCollectionçš„æ–¹æ³•
    boolean addAll(Collection<? extends E> c);  // æ‰¹é‡æ·»åŠ å…ƒç´ 
}
```

| æ–¹æ³• | æè¿° | å¤±è´¥æ—¶è¡Œä¸º | é€‚ç”¨åœºæ™¯ |
|------|------|------------|----------|
| `add(E)` | æ·»åŠ å…ƒç´ åˆ°é˜Ÿåˆ—å°¾éƒ¨ | æŠ›å‡ºå¼‚å¸¸ | å¸Œæœ›ç«‹å³çŸ¥é“æ“ä½œæ˜¯å¦æˆåŠŸ |
| `offer(E)` | æ·»åŠ å…ƒç´ åˆ°é˜Ÿåˆ—å°¾éƒ¨ | è¿”å›false | å¯¹æ“ä½œå¤±è´¥æœ‰ç‰¹æ®Šå¤„ç†é€»è¾‘ |
| `addAll(Collection)` | æ‰¹é‡æ·»åŠ å…ƒç´  | éƒ¨åˆ†æ·»åŠ å¹¶æŠ›å‡ºå¼‚å¸¸ | éœ€è¦æ‰¹é‡æ“ä½œæ—¶ |

:::info é˜»å¡é˜Ÿåˆ—çš„æ·»åŠ æ“ä½œ
å¯¹äº`BlockingQueue`å®ç°ï¼Œè¿˜æä¾›äº†é¢å¤–çš„æ·»åŠ æ–¹æ³•ï¼š
- `put(E)`ï¼šæ·»åŠ å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡åˆ™é˜»å¡ç­‰å¾…
- `offer(E, long, TimeUnit)`ï¼šæ·»åŠ å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡åˆ™é˜»å¡ç­‰å¾…æŒ‡å®šæ—¶é—´
:::

```java title="é˜»å¡é˜Ÿåˆ—æ·»åŠ ç¤ºä¾‹"
BlockingQueue<String> queue = new LinkedBlockingQueue<>(10);
// é˜»å¡æ·»åŠ 
queue.put("å…ƒç´ ");  // å¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œä¼šé˜»å¡ç­‰å¾…
// é™æ—¶æ·»åŠ 
boolean success = queue.offer("å…ƒç´ ", 5, TimeUnit.SECONDS); // æœ€å¤šç­‰å¾…5ç§’
```

</TabItem>
<TabItem value="remove" label="åˆ é™¤æ“ä½œæ–¹æ³•">
```java title="Queueåˆ é™¤æ“ä½œæ–¹æ³•"
public interface Queue<E> extends Collection<E> {
    
    // åˆ é™¤å¹¶è¿”å›é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ 
    E remove();                          // åˆ é™¤å…ƒç´ ï¼Œé˜Ÿåˆ—ç©ºæ—¶æŠ›å‡ºNoSuchElementException
    E poll();                           // åˆ é™¤å…ƒç´ ï¼Œé˜Ÿåˆ—ç©ºæ—¶è¿”å›null
    
    // åˆ é™¤æŒ‡å®šå…ƒç´ 
    boolean remove(Object o);            // åˆ é™¤æŒ‡å®šå…ƒç´ ï¼Œç»§æ‰¿è‡ªCollection
    boolean removeAll(Collection<?> c);  // æ‰¹é‡åˆ é™¤å…ƒç´ ï¼Œç»§æ‰¿è‡ªCollection
}
```

| æ–¹æ³• | æè¿° | é˜Ÿåˆ—ä¸ºç©ºæ—¶è¡Œä¸º | é€‚ç”¨åœºæ™¯ |
|------|------|--------------|----------|
| `remove()` | ç§»é™¤å¹¶è¿”å›é˜Ÿåˆ—å¤´éƒ¨å…ƒç´  | æŠ›å‡ºå¼‚å¸¸ | ç¡®ä¿¡é˜Ÿåˆ—éç©ºæ—¶ |
| `poll()` | ç§»é™¤å¹¶è¿”å›é˜Ÿåˆ—å¤´éƒ¨å…ƒç´  | è¿”å›null | é˜Ÿåˆ—å¯èƒ½ä¸ºç©ºæ—¶ |
| `remove(Object)` | ç§»é™¤ç‰¹å®šå…ƒç´ (è‹¥å­˜åœ¨) | è¿”å›æ“ä½œç»“æœ | æŒ‰å€¼åˆ é™¤è€Œéä½ç½® |
| `clear()` | æ¸…ç©ºæ•´ä¸ªé˜Ÿåˆ— | é˜Ÿåˆ—å˜ä¸ºç©º | éœ€è¦é‡ç½®é˜Ÿåˆ—æ—¶ |

:::info é˜»å¡é˜Ÿåˆ—çš„åˆ é™¤æ“ä½œ
å¯¹äº`BlockingQueue`å®ç°ï¼Œè¿˜æä¾›äº†é¢å¤–çš„åˆ é™¤æ–¹æ³•ï¼š
- `take()`ï¼šè·å–å¹¶ç§»é™¤é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºåˆ™é˜»å¡ç­‰å¾…
- `poll(long, TimeUnit)`ï¼šè·å–å¹¶ç§»é™¤é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºåˆ™é˜»å¡ç­‰å¾…æŒ‡å®šæ—¶é—´
:::

```java title="é˜»å¡é˜Ÿåˆ—åˆ é™¤ç¤ºä¾‹"
BlockingQueue<String> queue = new LinkedBlockingQueue<>();
// é˜»å¡åˆ é™¤
String element = queue.take();  // å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œä¼šé˜»å¡ç­‰å¾…
// é™æ—¶åˆ é™¤
String element2 = queue.poll(3, TimeUnit.SECONDS); // æœ€å¤šç­‰å¾…3ç§’
```

</TabItem>
<TabItem value="peek" label="æŸ¥çœ‹æ“ä½œæ–¹æ³•">
```java title="QueueæŸ¥çœ‹æ“ä½œæ–¹æ³•"
public interface Queue<E> extends Collection<E> {
    
    // æŸ¥çœ‹é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ ä½†ä¸åˆ é™¤
    E element();                        // æŸ¥çœ‹å…ƒç´ ï¼Œé˜Ÿåˆ—ç©ºæ—¶æŠ›å‡ºNoSuchElementException
    E peek();                          // æŸ¥çœ‹å…ƒç´ ï¼Œé˜Ÿåˆ—ç©ºæ—¶è¿”å›null
}
```

| æ–¹æ³• | æè¿° | é˜Ÿåˆ—ä¸ºç©ºæ—¶è¡Œä¸º | é€‚ç”¨åœºæ™¯ |
|------|------|--------------|----------|
| `element()` | è·å–ä½†ä¸ç§»é™¤é˜Ÿåˆ—å¤´éƒ¨å…ƒç´  | æŠ›å‡ºå¼‚å¸¸ | ç¡®ä¿¡é˜Ÿåˆ—éç©ºæ—¶ |
| `peek()` | è·å–ä½†ä¸ç§»é™¤é˜Ÿåˆ—å¤´éƒ¨å…ƒç´  | è¿”å›null | é˜Ÿåˆ—å¯èƒ½ä¸ºç©ºæ—¶ |

:::tip ä¸åˆ é™¤æ“ä½œçš„åŒºåˆ«
æŸ¥çœ‹æ“ä½œä¸åˆ é™¤æ“ä½œçš„ä¸»è¦åŒºåˆ«åœ¨äºï¼š
- æŸ¥çœ‹æ“ä½œåªæ˜¯è·å–å…ƒç´ å¼•ç”¨ï¼Œä¸ä¼šä¿®æ”¹é˜Ÿåˆ—ç»“æ„
- åˆ é™¤æ“ä½œä¼šå°†å…ƒç´ ä»é˜Ÿåˆ—ä¸­ç§»é™¤
- åœ¨å¹¶å‘ç¯å¢ƒä¸­ï¼ŒæŸ¥çœ‹åå†åˆ é™¤çš„æ“ä½œä¸æ˜¯åŸå­çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸ä¸€è‡´
:::

```java title="æŸ¥çœ‹æ“ä½œç¤ºä¾‹"
Queue<Integer> queue = new LinkedList<>();
queue.add(1);
queue.add(2);

// æŸ¥çœ‹å…ƒç´ ä½†ä¸åˆ é™¤
Integer head1 = queue.peek();  // è¿”å›1ï¼Œé˜Ÿåˆ—ä»æœ‰[1,2]
// ä½¿ç”¨elementæ–¹æ³•
Integer head2 = queue.element(); // è¿”å›1ï¼Œé˜Ÿåˆ—ä»æœ‰[1,2]

// åˆ é™¤æ“ä½œä¼šä¿®æ”¹é˜Ÿåˆ—
Integer removed = queue.poll(); // è¿”å›1ï¼Œé˜Ÿåˆ—å˜ä¸º[2]
```

</TabItem>
<TabItem value="collection" label="é›†åˆæ“ä½œæ–¹æ³•">
```java title="Queueé›†åˆæ“ä½œæ–¹æ³•"
public interface Queue<E> extends Collection<E> {
    
    // é›†åˆä¿¡æ¯
    int size();                         // è·å–é˜Ÿåˆ—å¤§å°
    boolean isEmpty();                  // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º
    boolean contains(Object o);         // åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ 
    void clear();                       // æ¸…ç©ºé˜Ÿåˆ—
    
    // è¿­ä»£å™¨
    Iterator<E> iterator();             // è·å–è¿­ä»£å™¨
}
```

| æ–¹æ³• | æè¿° | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| `size()` | è·å–é˜Ÿåˆ—ä¸­å…ƒç´ æ•°é‡ | O(1)æ—¶é—´å¤æ‚åº¦ | éœ€è¦çŸ¥é“é˜Ÿåˆ—å¤§å°æ—¶ |
| `isEmpty()` | æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º | æ¯”size()==0æ›´é«˜æ•ˆ | åˆ¤æ–­é˜Ÿåˆ—ç©ºçŠ¶æ€æ—¶ |
| `contains(Object)` | æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ | O(n)æ—¶é—´å¤æ‚åº¦ | éœ€è¦ç¡®è®¤å…ƒç´ å­˜åœ¨æ—¶ |
| `clear()` | æ¸…ç©ºæ‰€æœ‰å…ƒç´  | ä¸ä¿ç•™å®¹é‡ | å®Œå…¨é‡ç½®é˜Ÿåˆ—æ—¶ |
| `iterator()` | è·å–è¿­ä»£å™¨ | å¯èƒ½ä¸ä¿è¯é¡ºåº | éœ€è¦éå†æ‰€æœ‰å…ƒç´ æ—¶ |

:::warning è¿­ä»£å™¨ä½¿ç”¨æ³¨æ„
ä½¿ç”¨è¿­ä»£å™¨éå†Queueæ—¶è¦æ³¨æ„ï¼š
- è¿­ä»£é¡ºåºå¯èƒ½ä¸Queueçš„å‡ºé˜Ÿé¡ºåºä¸ä¸€è‡´
- å¹¶å‘ä¿®æ”¹ä¼šå¯¼è‡´ConcurrentModificationException
- æŸäº›Queueå®ç°ä¸æ”¯æŒè¿­ä»£å™¨çš„remove()æ“ä½œ
:::

```java title="é›†åˆæ“ä½œç¤ºä¾‹"
Queue<String> queue = new ArrayDeque<>();
queue.add("A");
queue.add("B");
queue.add("C");

// æ£€æŸ¥å¤§å°å’Œå†…å®¹
System.out.println("Size: " + queue.size());  // è¾“å‡º3
System.out.println("Contains 'B': " + queue.contains("B"));  // è¾“å‡ºtrue

// ä½¿ç”¨è¿­ä»£å™¨éå†
for (String item : queue) {
    System.out.println(item);  // è¾“å‡ºA, B, C (é¡ºåºå¯èƒ½å› å®ç°è€Œå¼‚)
}

// æ¸…ç©ºé˜Ÿåˆ—
queue.clear();
System.out.println("Is empty: " + queue.isEmpty());  // è¾“å‡ºtrue
```

</TabItem>
</Tabs>

### 1.5 Queueæ¥å£æ–¹æ³•å¯¹æ¯”åˆ†æ

| æ“ä½œç±»å‹ | æ–¹æ³•å | æˆåŠŸæ—¶è¿”å›å€¼ | å¤±è´¥æ—¶è¡Œä¸º | ä½¿ç”¨åœºæ™¯ |
|----------|--------|--------------|------------|----------|
| **æ·»åŠ æ“ä½œ** | add(E) | true | æŠ›å‡ºå¼‚å¸¸ | å¿…é¡»æˆåŠŸçš„åœºæ™¯ |
| **æ·»åŠ æ“ä½œ** | offer(E) | true | è¿”å›false | å¯å®¹å¿å¤±è´¥çš„åœºæ™¯ |
| **åˆ é™¤æ“ä½œ** | remove() | è¢«åˆ é™¤çš„å…ƒç´  | æŠ›å‡ºå¼‚å¸¸ | å¿…é¡»æˆåŠŸçš„åœºæ™¯ |
| **åˆ é™¤æ“ä½œ** | poll() | è¢«åˆ é™¤çš„å…ƒç´  | è¿”å›null | å¯å®¹å¿å¤±è´¥çš„åœºæ™¯ |
| **æŸ¥çœ‹æ“ä½œ** | element() | å¤´éƒ¨å…ƒç´  | æŠ›å‡ºå¼‚å¸¸ | å¿…é¡»æˆåŠŸçš„åœºæ™¯ |
| **æŸ¥çœ‹æ“ä½œ** | peek() | å¤´éƒ¨å…ƒç´  | è¿”å›null | å¯å®¹å¿å¤±è´¥çš„åœºæ™¯ |

:::tip æ–¹æ³•é€‰æ‹©å»ºè®®
- **éé˜»å¡åœºæ™¯**ï¼šä¼˜å…ˆä½¿ç”¨offer()ã€poll()ã€peek()æ–¹æ³•
- **é˜»å¡åœºæ™¯**ï¼šä½¿ç”¨BlockingQueueçš„put()ã€take()æ–¹æ³•
- **å¼‚å¸¸å¤„ç†**ï¼šä½¿ç”¨add()ã€remove()ã€element()æ–¹æ³•æ—¶æ³¨æ„å¼‚å¸¸å¤„ç†
:::

## 2. Queueå®ç°ç±»è¯¦è§£

```mermaid
graph TD
    subgraph æ€§èƒ½æ¯”è¾ƒ
        A["Queueå®ç°ç±»"] --> B["ArrayDeque (éé˜»å¡é«˜æ€§èƒ½)"]
        A --> C["LinkedList (åŒå‘é“¾è¡¨)"]
        A --> D["PriorityQueue (ä¼˜å…ˆçº§)"]
        A --> E["BlockingQueue (å¹¶å‘)"]
    end
    
    subgraph æ—¶é—´å¤æ‚åº¦
        B --> B1["æ·»åŠ /åˆ é™¤: O(1)"]
        B --> B2["æ— å®¹é‡é™åˆ¶"]
        
        C --> C1["æ·»åŠ /åˆ é™¤: O(1)"]
        C --> C2["å†…å­˜å ç”¨å¤§"]
        
        D --> D1["æ·»åŠ /åˆ é™¤: O(log n)"]
        D --> D2["ä¼˜å…ˆçº§å †å®ç°"]
        
        E --> E1["çº¿ç¨‹å®‰å…¨"]
        E --> E2["æ”¯æŒé˜»å¡æ“ä½œ"]
    end
    
    classDef default fill:#f9f9f9,stroke:#333,stroke-width:1px;
    classDef fast fill:#d1f0d1,stroke:#333,stroke-width:1px;
    classDef slow fill:#f0d1d1,stroke:#333,stroke-width:1px;
    
    class B1,C1 fast;
    class D1 slow;
```

<Tabs>
<TabItem value="linkedlist" label="LinkedList å®ç°">

### 2.1 LinkedList æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
LinkedListæ˜¯Queueæ¥å£çš„é‡è¦å®ç°ç±»ï¼ŒåŸºäºåŒå‘é“¾è¡¨å®ç°ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- ğŸ”„ **åŒå‘é“¾è¡¨**ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å‰åæŒ‡é’ˆï¼Œæ”¯æŒåŒå‘éå†
- ğŸ“¥ **é˜Ÿåˆ—æ“ä½œ**ï¼šå®ç°äº†Queueæ¥å£ï¼Œæ”¯æŒFIFOæ“ä½œ
- ğŸ”€ **åŒç«¯é˜Ÿåˆ—**ï¼šå®ç°äº†Dequeæ¥å£ï¼Œæ”¯æŒä¸¤ç«¯æ“ä½œ
- âš¡ **æ’å…¥åˆ é™¤é«˜æ•ˆ**ï¼šåœ¨ä»»æ„ä½ç½®æ’å…¥åˆ é™¤å…ƒç´ æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)
- âš ï¸ **çº¿ç¨‹ä¸å®‰å…¨**ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦å¤–éƒ¨åŒæ­¥
:::

#### é€‚ç”¨åœºæ™¯
- éœ€è¦é˜Ÿåˆ—åŠŸèƒ½çš„åœºæ™¯
- éœ€è¦åŒç«¯é˜Ÿåˆ—åŠŸèƒ½çš„åœºæ™¯
- é¢‘ç¹çš„æ’å…¥åˆ é™¤æ“ä½œ
- å…ƒç´ æ•°é‡å˜åŒ–è¾ƒå¤§çš„åœºæ™¯

### 2.2 LinkedList å†…éƒ¨ç»“æ„

LinkedListåŸºäºåŒå‘é“¾è¡¨å®ç°ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«å¯¹å‰ä¸€ä¸ªå’Œåä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ï¼Œæ”¯æŒåŒå‘éå†ã€‚

#### æ ¸å¿ƒå­—æ®µ

```java title="LinkedListæ ¸å¿ƒå­—æ®µ"
public class LinkedList<E> extends AbstractSequentialList<E>
        implements List<E>, Deque<E>, Cloneable, java.io.Serializable {
    
    // åŒå‘é“¾è¡¨èŠ‚ç‚¹
    private static class Node<E> {
        E item;           // å­˜å‚¨çš„å…ƒç´ 
        Node<E> next;     // ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
        Node<E> prev;     // ä¸Šä¸€ä¸ªèŠ‚ç‚¹
        
        Node(Node<E> prev, E element, Node<E> next) {
            this.item = element;
            this.next = next;
            this.prev = prev;
        }
    }
    
    // å¤´èŠ‚ç‚¹ï¼ˆç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰
    transient Node<E> first;
    
    // å°¾èŠ‚ç‚¹ï¼ˆæœ€åä¸€ä¸ªå…ƒç´ ï¼‰
    transient Node<E> last;
    
    // é“¾è¡¨ä¸­çš„å…ƒç´ ä¸ªæ•°
    transient int size = 0;
}
```

#### å†…å­˜å¸ƒå±€ç¤ºæ„å›¾

```
LinkedList å®ä¾‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ first: Node<E>                          â”‚
â”‚ last: Node<E>                           â”‚
â”‚ size: 3                                 â”‚
â”‚ modCount: 1                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚
         â–¼                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Node 1  â”‚â—„â”€â”€â–ºâ”‚ Node 2  â”‚â—„â”€â”€â–ºâ”‚ Node 3  â”‚
    â”‚ item: A â”‚    â”‚ item: B â”‚    â”‚ item: C â”‚
    â”‚ prev:   â”‚    â”‚ prev: 1 â”‚    â”‚ prev: 2 â”‚
    â”‚ next: 2 â”‚    â”‚ next: 3 â”‚    â”‚ next:   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 LinkedList é˜Ÿåˆ—æ“ä½œå®ç°

#### 2.3.1 æ·»åŠ å…ƒç´ 

```java title="LinkedListæ·»åŠ å…ƒç´ å®ç°"
public class LinkedList<E> extends AbstractSequentialList<E> {
    
    /**
     * åœ¨é“¾è¡¨å¤´éƒ¨æ·»åŠ å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(1)
     */
    private void linkFirst(E e) {
        final Node<E> f = first;
        final Node<E> newNode = new Node<>(null, e, f);
        first = newNode;
        if (f == null) {
            last = newNode;  // å¦‚æœé“¾è¡¨ä¸ºç©º
        } else {
            f.prev = newNode;  // è®¾ç½®åŸå¤´èŠ‚ç‚¹çš„å‰é©±
        }
        size++;
        modCount++;
    }
    
    /**
     * åœ¨é“¾è¡¨å°¾éƒ¨æ·»åŠ å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(1)
     */
    void linkLast(E e) {
        final Node<E> l = last;
        final Node<E> newNode = new Node<>(l, e, null);
        last = newNode;
        if (l == null) {
            first = newNode;  // å¦‚æœé“¾è¡¨ä¸ºç©º
        } else {
            l.next = newNode;  // è®¾ç½®åŸå°¾èŠ‚ç‚¹çš„åç»§
        }
        size++;
        modCount++;
    }
}
```

#### 2.3.2 åˆ é™¤å…ƒç´ 

```java title="LinkedListåˆ é™¤å…ƒç´ å®ç°"
public class LinkedList<E> extends AbstractSequentialList<E> {
    
    /**
     * åˆ é™¤å¤´èŠ‚ç‚¹
     * æ—¶é—´å¤æ‚åº¦ï¼šO(1)
     */
    private E unlinkFirst(Node<E> f) {
        final E element = f.item;
        final Node<E> next = f.next;
        f.item = null;
        f.next = null; // å¸®åŠ©GC
        first = next;
        if (next == null) {
            last = null;  // å¦‚æœé“¾è¡¨å˜ä¸ºç©º
        } else {
            next.prev = null;  // æ–°å¤´èŠ‚ç‚¹çš„å‰é©±è®¾ä¸ºnull
        }
        size--;
        modCount++;
        return element;
    }
    
    /**
     * åˆ é™¤å°¾èŠ‚ç‚¹
     * æ—¶é—´å¤æ‚åº¦ï¼šO(1)
     */
    private E unlinkLast(Node<E> l) {
        final E element = l.item;
        final Node<E> prev = l.prev;
        l.item = null;
        l.prev = null; // å¸®åŠ©GC
        last = prev;
        if (prev == null) {
            first = null;  // å¦‚æœé“¾è¡¨å˜ä¸ºç©º
        } else {
            prev.next = null;  // æ–°å°¾èŠ‚ç‚¹çš„åç»§è®¾ä¸ºnull
        }
        size--;
        modCount++;
        return element;
    }
}
```

### 2.4 LinkedList æ€§èƒ½åˆ†æ

#### 2.4.1 æ—¶é—´å¤æ‚åº¦å¯¹æ¯”

| æ“ä½œ | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜ |
|------|------------|------|
| **å¤´éƒ¨æ’å…¥** | O(1) | ç›´æ¥ä¿®æ”¹å¤´èŠ‚ç‚¹å¼•ç”¨ |
| **å°¾éƒ¨æ’å…¥** | O(1) | ç›´æ¥ä¿®æ”¹å°¾èŠ‚ç‚¹å¼•ç”¨ |
| **å¤´éƒ¨åˆ é™¤** | O(1) | ç›´æ¥ä¿®æ”¹å¤´èŠ‚ç‚¹å¼•ç”¨ |
| **å°¾éƒ¨åˆ é™¤** | O(1) | ç›´æ¥ä¿®æ”¹å°¾èŠ‚ç‚¹å¼•ç”¨ |
| **éšæœºè®¿é—®** | O(n) | éœ€è¦éå†é“¾è¡¨ |
| **æŸ¥æ‰¾å…ƒç´ ** | O(n) | éœ€è¦éå†æ¯”è¾ƒ |

#### 2.4.2 ç©ºé—´å¤æ‚åº¦

- **èŠ‚ç‚¹å¼€é”€**ï¼šæ¯ä¸ªå…ƒç´ éœ€è¦é¢å¤–çš„èŠ‚ç‚¹å¯¹è±¡ï¼ˆåŒ…å«itemã€nextã€prevå¼•ç”¨ï¼‰
- **å†…å­˜åˆ†æ•£**ï¼šå…ƒç´ åœ¨å†…å­˜ä¸­åˆ†æ•£å­˜å‚¨ï¼Œç¼“å­˜ä¸å‹å¥½
- **å¼•ç”¨å¼€é”€**ï¼šæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸¤ä¸ªå¼•ç”¨ï¼ˆnextã€prevï¼‰

### 2.5 LinkedList ä½¿ç”¨ç¤ºä¾‹

#### 2.5.1 åŸºæœ¬é˜Ÿåˆ—æ“ä½œç¤ºä¾‹

```java title="LinkedListåŸºæœ¬é˜Ÿåˆ—æ“ä½œç¤ºä¾‹"
public class LinkedListQueueExample {
    
    public static void main(String[] args) {
        // åˆ›å»ºLinkedListä½œä¸ºQueueä½¿ç”¨
        Queue<String> queue = new LinkedList<>();
        
        // æ·»åŠ å…ƒç´ 
        queue.offer("Java");
        queue.offer("Python");
        queue.offer("C++");
        queue.offer("JavaScript");
        
        System.out.println("é˜Ÿåˆ—å¤§å°: " + queue.size());
        System.out.println("é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º: " + queue.isEmpty());
        
        // æŸ¥çœ‹å¤´éƒ¨å…ƒç´ 
        String head = queue.peek();
        System.out.println("å¤´éƒ¨å…ƒç´ : " + head);
        
        // åˆ é™¤å¹¶è¿”å›å¤´éƒ¨å…ƒç´ 
        String removed = queue.poll();
        System.out.println("åˆ é™¤çš„å…ƒç´ : " + removed);
        
        // éå†é˜Ÿåˆ—
        System.out.println("å‰©ä½™å…ƒç´ :");
        while (!queue.isEmpty()) {
            System.out.println(queue.poll());
        }
    }
}
```

#### 2.5.2 åŒç«¯é˜Ÿåˆ—æ“ä½œç¤ºä¾‹

```java title="LinkedListåŒç«¯é˜Ÿåˆ—æ“ä½œç¤ºä¾‹"
public class LinkedListDequeExample {
    
    public static void main(String[] args) {
        // åˆ›å»ºLinkedListä½œä¸ºDequeä½¿ç”¨
        Deque<String> deque = new LinkedList<>();
        
        // å¤´éƒ¨æ“ä½œ
        deque.addFirst("First");
        deque.offerFirst("OfferFirst");
        
        // å°¾éƒ¨æ“ä½œ
        deque.addLast("Last");
        deque.offerLast("OfferLast");
        
        System.out.println("åŒç«¯é˜Ÿåˆ—: " + deque);
        
        // å¤´éƒ¨æŸ¥çœ‹å’Œåˆ é™¤
        String first = deque.getFirst();
        System.out.println("ç¬¬ä¸€ä¸ªå…ƒç´ : " + first);
        
        String removedFirst = deque.removeFirst();
        System.out.println("åˆ é™¤çš„ç¬¬ä¸€ä¸ªå…ƒç´ : " + removedFirst);
        
        // å°¾éƒ¨æŸ¥çœ‹å’Œåˆ é™¤
        String last = deque.getLast();
        System.out.println("æœ€åä¸€ä¸ªå…ƒç´ : " + last);
        
        String removedLast = deque.removeLast();
        System.out.println("åˆ é™¤çš„æœ€åä¸€ä¸ªå…ƒç´ : " + removedLast);
        
        System.out.println("æ“ä½œåçš„åŒç«¯é˜Ÿåˆ—: " + deque);
    }
}
```

#### 2.5.3 æ ˆæ“ä½œç¤ºä¾‹

```java title="LinkedListæ ˆæ“ä½œç¤ºä¾‹"
public class LinkedListStackExample {
    
    public static void main(String[] args) {
        // ä½¿ç”¨LinkedListå®ç°æ ˆ
        Deque<String> stack = new LinkedList<>();
        
        // å‹æ ˆæ“ä½œ
        stack.push("å…ƒç´ 1");
        stack.push("å…ƒç´ 2");
        stack.push("å…ƒç´ 3");
        
        System.out.println("æ ˆå¤§å°: " + stack.size());
        
        // å¼¹æ ˆæ“ä½œ
        while (!stack.isEmpty()) {
            String element = stack.pop();
            System.out.println("å¼¹æ ˆ: " + element);
        }
        
        // ä½¿ç”¨LinkedListå®ç°é˜Ÿåˆ—
        Queue<String> queue = new LinkedList<>();
        
        // å…¥é˜Ÿæ“ä½œ
        queue.offer("ä»»åŠ¡1");
        queue.offer("ä»»åŠ¡2");
        queue.offer("ä»»åŠ¡3");
        
        // å‡ºé˜Ÿæ“ä½œ
        while (!queue.isEmpty()) {
            String task = queue.poll();
            System.out.println("å¤„ç†ä»»åŠ¡: " + task);
        }
    }
}

</TabItem>
<TabItem value="arraydeque" label="ArrayDeque å®ç°">

### 3.1 ArrayDeque æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
ArrayDequeæ˜¯åŸºäºæ•°ç»„å®ç°çš„åŒç«¯é˜Ÿåˆ—ï¼Œæ˜¯Javaä¸­æœ€é«˜æ•ˆçš„é˜Ÿåˆ—å®ç°ä¹‹ä¸€ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- ğŸ“Š **æ•°ç»„å®ç°**ï¼šåŸºäºå¾ªç¯æ•°ç»„å®ç°ï¼Œå­˜å–æ•ˆç‡é«˜
- ğŸ”„ **åŒç«¯æ“ä½œ**ï¼šæ”¯æŒåœ¨ä¸¤ç«¯é«˜æ•ˆæ·»åŠ å’Œåˆ é™¤å…ƒç´ 
- âš¡ **æ— å®¹é‡é™åˆ¶**ï¼šè‡ªåŠ¨æ‰©å®¹ï¼Œæ— éœ€æŒ‡å®šåˆå§‹å¤§å°
- âŒ **ä¸å…è®¸null**ï¼šä¸èƒ½å­˜å‚¨nullå…ƒç´ 
- ğŸ“ˆ **é«˜æ€§èƒ½**ï¼šåœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹æ€§èƒ½ä¼˜äºLinkedList
:::

#### é€‚ç”¨åœºæ™¯
- éœ€è¦åœ¨ä¸¤ç«¯é«˜æ•ˆæ“ä½œçš„é˜Ÿåˆ—åœºæ™¯
- å®ç°æ ˆæˆ–é˜Ÿåˆ—çš„åœºæ™¯
- éœ€è¦é¢‘ç¹æ·»åŠ ã€åˆ é™¤å…ƒç´ çš„åœºæ™¯
- å¯¹å†…å­˜å ç”¨æ•æ„Ÿçš„åœºæ™¯

### 3.2 ArrayDeque å†…éƒ¨ç»“æ„

```java title="ArrayDequeæ ¸å¿ƒå­—æ®µ"
public class ArrayDeque<E> extends AbstractCollection<E>
    implements Deque<E>, Cloneable, Serializable {
    
    // å­˜å‚¨å…ƒç´ çš„æ•°ç»„
    transient Object[] elements;
    
    // å¤´éƒ¨å…ƒç´ çš„ç´¢å¼•
    transient int head;
    
    // å°¾éƒ¨å…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®çš„ç´¢å¼•
    transient int tail;
    
    // æœ€å°åˆå§‹å®¹é‡
    private static final int MIN_INITIAL_CAPACITY = 8;
}
```

#### å†…å­˜å¸ƒå±€ç¤ºæ„å›¾

```
ArrayDeque å®ä¾‹ (å¾ªç¯æ•°ç»„)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ elements: Object[]                      â”‚
â”‚ â”œâ”€â”€ [0] â†’ D                            â”‚
â”‚ â”œâ”€â”€ [1] â†’ E                            â”‚
â”‚ â”œâ”€â”€ [2] â†’ null                         â”‚
â”‚ â”œâ”€â”€ [3] â†’ null                         â”‚
â”‚ â”œâ”€â”€ [4] â†’ null                         â”‚
â”‚ â”œâ”€â”€ [5] â†’ null                         â”‚
â”‚ â”œâ”€â”€ [6] â†’ A                            â”‚
â”‚ â”œâ”€â”€ [7] â†’ B                            â”‚
â”‚ â””â”€â”€ [8] â†’ C                            â”‚
â”‚ head: 6                                â”‚
â”‚ tail: 2                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é€»è¾‘é˜Ÿåˆ—: [A, B, C, D, E]  (headæŒ‡å‘Aï¼ŒtailæŒ‡å‘Dåé¢çš„ä½ç½®)
```

</TabItem>
<TabItem value="priorityqueue" label="PriorityQueue å®ç°">

### 4.1 PriorityQueue æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
PriorityQueueæ˜¯åŸºäºä¼˜å…ˆçº§å †çš„æ— ç•Œé˜Ÿåˆ—ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- ğŸ† **ä¼˜å…ˆçº§å †**ï¼šåŸºäºæ•°ç»„å®ç°çš„äºŒå‰å †æ•°æ®ç»“æ„
- ğŸ”„ **è‡ªåŠ¨æ’åº**ï¼šå…ƒç´ æŒ‰ç…§è‡ªç„¶é¡ºåºæˆ–è‡ªå®šä¹‰æ¯”è¾ƒå™¨æ’åº
- ğŸ“ˆ **æ— ç•Œé˜Ÿåˆ—**ï¼šå®¹é‡å¯ä»¥åŠ¨æ€å¢é•¿
- âŒ **ä¸å…è®¸null**ï¼šä¸æ”¯æŒnullå…ƒç´ 
- âš ï¸ **çº¿ç¨‹ä¸å®‰å…¨**ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦å¤–éƒ¨åŒæ­¥
:::

#### é€‚ç”¨åœºæ™¯
- éœ€è¦æŒ‰ä¼˜å…ˆçº§å¤„ç†ä»»åŠ¡çš„åœºæ™¯
- ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ
- äº‹ä»¶å¤„ç†ç³»ç»Ÿ
- éœ€è¦è‡ªåŠ¨æ’åºçš„æ•°æ®å¤„ç†

### 3.2 PriorityQueue å†…éƒ¨ç»“æ„

PriorityQueueåŸºäºæ•°ç»„å®ç°çš„äºŒå‰å †ï¼Œé€šè¿‡å †çš„æ€§è´¨ä¿è¯ä¼˜å…ˆçº§é¡ºåºã€‚

#### æ ¸å¿ƒå­—æ®µ

```java title="PriorityQueueæ ¸å¿ƒå­—æ®µ"
public class PriorityQueue<E> extends AbstractQueue<E>
    implements java.io.Serializable {
    
    // é»˜è®¤åˆå§‹å®¹é‡
    private static final int DEFAULT_INITIAL_CAPACITY = 11;
    
    // å­˜å‚¨å…ƒç´ çš„æ•°ç»„
    transient Object[] queue;
    
    // å…ƒç´ ä¸ªæ•°
    private int size = 0;
    
    // æ¯”è¾ƒå™¨
    private final Comparator<? super E> comparator;
    
    // ä¿®æ”¹æ¬¡æ•°
    transient int modCount = 0;
}
```

#### æ„é€ æ–¹æ³•

```java title="PriorityQueueæ„é€ æ–¹æ³•"
public class PriorityQueue<E> extends AbstractQueue<E> {
    
    /**
     * æ„é€ ä¸€ä¸ªé»˜è®¤å®¹é‡çš„ä¼˜å…ˆçº§é˜Ÿåˆ—
     */
    public PriorityQueue() {
        this(DEFAULT_INITIAL_CAPACITY, null);
    }
    
    /**
     * æ„é€ ä¸€ä¸ªæŒ‡å®šåˆå§‹å®¹é‡çš„ä¼˜å…ˆçº§é˜Ÿåˆ—
     */
    public PriorityQueue(int initialCapacity) {
        this(initialCapacity, null);
    }
    
    /**
     * æ„é€ ä¸€ä¸ªæŒ‡å®šæ¯”è¾ƒå™¨çš„ä¼˜å…ˆçº§é˜Ÿåˆ—
     */
    public PriorityQueue(Comparator<? super E> comparator) {
        this(DEFAULT_INITIAL_CAPACITY, comparator);
    }
    
    /**
     * æ„é€ ä¸€ä¸ªæŒ‡å®šåˆå§‹å®¹é‡å’Œæ¯”è¾ƒå™¨çš„ä¼˜å…ˆçº§é˜Ÿåˆ—
     */
    public PriorityQueue(int initialCapacity, Comparator<? super E> comparator) {
        if (initialCapacity < 1)
            throw new IllegalArgumentException();
        this.queue = new Object[initialCapacity];
        this.comparator = comparator;
    }
}
```

#### å†…å­˜å¸ƒå±€ç¤ºæ„å›¾

```
PriorityQueue å®ä¾‹ (æœ€å°å †)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ queue: Object[]                         â”‚
â”‚ â”œâ”€â”€ [0] â†’ 1 (æ ¹èŠ‚ç‚¹)                   â”‚
â”‚ â”œâ”€â”€ [1] â†’ 3 (å·¦å­èŠ‚ç‚¹)                 â”‚
â”‚ â”œâ”€â”€ [2] â†’ 5 (å³å­èŠ‚ç‚¹)                 â”‚
â”‚ â”œâ”€â”€ [3] â†’ 7                            â”‚
â”‚ â”œâ”€â”€ [4] â†’ 9                            â”‚
â”‚ â””â”€â”€ [5] â†’ null                         â”‚
â”‚ size: 5                                â”‚
â”‚ comparator: null (è‡ªç„¶é¡ºåº)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å †çš„æ ‘å½¢ç»“æ„:
       1
     /   \
    3     5
   / \
  7   9
```

### 3.3 PriorityQueue æ ¸å¿ƒæ–¹æ³•å®ç°

#### 3.3.1 æ·»åŠ å…ƒç´ 

```java title="PriorityQueueæ·»åŠ å…ƒç´ å®ç°"
public class PriorityQueue<E> extends AbstractQueue<E> {
    
    /**
     * æ·»åŠ å…ƒç´ åˆ°ä¼˜å…ˆçº§é˜Ÿåˆ—
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    public boolean offer(E e) {
        if (e == null)
            throw new NullPointerException();
        modCount++;
        int i = size;
        if (i >= queue.length)
            grow(i + 1);  // æ‰©å®¹
        size = i + 1;
        if (i == 0)
            queue[0] = e;  // ç¬¬ä¸€ä¸ªå…ƒç´ 
        else
            siftUp(i, e);  // ä¸Šæµ®æ“ä½œ
        return true;
    }
    
    /**
     * ä¸Šæµ®æ“ä½œï¼ˆæœ€å°å †ï¼‰
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    private void siftUp(int k, E x) {
        if (comparator != null)
            siftUpUsingComparator(k, x);
        else
            siftUpComparable(k, x);
    }
    
    /**
     * ä½¿ç”¨è‡ªç„¶é¡ºåºçš„ä¸Šæµ®æ“ä½œ
     */
    @SuppressWarnings("unchecked")
    private void siftUpComparable(int k, E x) {
        Comparable<? super E> key = (Comparable<? super E>) x;
        while (k > 0) {
            int parent = (k - 1) >>> 1;  // çˆ¶èŠ‚ç‚¹ç´¢å¼•
            Object e = queue[parent];
            if (key.compareTo((E) e) >= 0)
                break;
            queue[k] = e;
            k = parent;
        }
        queue[k] = key;
    }
}
```

#### 3.3.2 åˆ é™¤å…ƒç´ 

```java title="PriorityQueueåˆ é™¤å…ƒç´ å®ç°"
public class PriorityQueue<E> extends AbstractQueue<E> {
    
    /**
     * åˆ é™¤å¹¶è¿”å›ä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    public E poll() {
        if (size == 0)
            return null;
        int s = --size;
        modCount++;
        E result = (E) queue[0];  // æ ¹èŠ‚ç‚¹
        E x = (E) queue[s];       // æœ€åä¸€ä¸ªå…ƒç´ 
        queue[s] = null;
        if (s != 0)
            siftDown(0, x);       // ä¸‹æ²‰æ“ä½œ
        return result;
    }
    
    /**
     * ä¸‹æ²‰æ“ä½œï¼ˆæœ€å°å †ï¼‰
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    private void siftDown(int k, E x) {
        if (comparator != null)
            siftDownUsingComparator(k, x);
        else
            siftDownComparable(k, x);
    }
    
    /**
     * ä½¿ç”¨è‡ªç„¶é¡ºåºçš„ä¸‹æ²‰æ“ä½œ
     */
    @SuppressWarnings("unchecked")
    private void siftDownComparable(int k, E x) {
        Comparable<? super E> key = (Comparable<? super E>) x;
        int half = size >>> 1;  // éå¶å­èŠ‚ç‚¹æ•°é‡
        while (k < half) {
            int child = (k << 1) + 1;  // å·¦å­èŠ‚ç‚¹
            Object c = queue[child];
            int right = child + 1;     // å³å­èŠ‚ç‚¹
            if (right < size &&
                ((Comparable<? super E>) c).compareTo((E) queue[right]) > 0)
                c = queue[child = right];
            if (key.compareTo((E) c) <= 0)
                break;
            queue[k] = c;
            k = child;
        }
        queue[k] = key;
    }
}
```

#### 3.3.3 æ‰©å®¹æœºåˆ¶

```java title="PriorityQueueæ‰©å®¹æœºåˆ¶"
public class PriorityQueue<E> extends AbstractQueue<E> {
    
    /**
     * æ‰©å®¹æ–¹æ³•
     */
    private void grow(int minCapacity) {
        int oldCapacity = queue.length;
        // æ–°å®¹é‡ = æ—§å®¹é‡ + æ—§å®¹é‡/2ï¼ˆ1.5å€å¢é•¿ï¼‰
        int newCapacity = oldCapacity + ((oldCapacity < 64) ?
                                       (oldCapacity + 2) : (oldCapacity >> 1));
        
        if (newCapacity - MAX_ARRAY_SIZE > 0)
            newCapacity = hugeCapacity(minCapacity);
        
        queue = Arrays.copyOf(queue, newCapacity);
    }
    
    /**
     * è®¡ç®—æœ€å¤§å®¹é‡
     */
    private static int hugeCapacity(int minCapacity) {
        if (minCapacity < 0)
            throw new OutOfMemoryError();
        return (minCapacity > MAX_ARRAY_SIZE) ?
            Integer.MAX_VALUE : MAX_ARRAY_SIZE;
    }
}
```

### 3.4 PriorityQueue æ€§èƒ½åˆ†æ

#### 3.4.1 æ—¶é—´å¤æ‚åº¦å¯¹æ¯”

| æ“ä½œ | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜ |
|------|------------|------|
| **æ’å…¥å…ƒç´ ** | O(log n) | éœ€è¦ä¸Šæµ®æ“ä½œè°ƒæ•´å †ç»“æ„ |
| **åˆ é™¤å…ƒç´ ** | O(log n) | éœ€è¦ä¸‹æ²‰æ“ä½œè°ƒæ•´å †ç»“æ„ |
| **æŸ¥çœ‹å…ƒç´ ** | O(1) | ç›´æ¥è®¿é—®æ ¹èŠ‚ç‚¹ |
| **æŸ¥æ‰¾å…ƒç´ ** | O(n) | éœ€è¦éå†æ•´ä¸ªå † |

#### 3.4.2 ç©ºé—´å¤æ‚åº¦

- **å­˜å‚¨å¼€é”€**ï¼šæ¯ä¸ªå…ƒç´ å ç”¨ä¸€ä¸ªæ•°ç»„ä½ç½®
- **æ‰©å®¹å¼€é”€**ï¼šæ‰©å®¹æ—¶ä¼šåˆ›å»ºæ–°æ•°ç»„ï¼Œä¸´æ—¶å ç”¨åŒå€å†…å­˜
- **æ¯”è¾ƒå™¨å¼€é”€**ï¼šå¦‚æœä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå™¨ï¼Œéœ€è¦é¢å¤–çš„å¯¹è±¡å¼•ç”¨

### 3.5 PriorityQueue ä½¿ç”¨ç¤ºä¾‹

#### 3.5.1 åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹

```java title="PriorityQueueåŸºæœ¬ä½¿ç”¨ç¤ºä¾‹"
public class PriorityQueueBasicExample {
    
    public static void main(String[] args) {
        // è‡ªç„¶é¡ºåºä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆæœ€å°å †ï¼‰
        Queue<Integer> naturalOrderQueue = new PriorityQueue<>();
        naturalOrderQueue.offer(5);
        naturalOrderQueue.offer(2);
        naturalOrderQueue.offer(8);
        naturalOrderQueue.offer(1);
        naturalOrderQueue.offer(3);
        
        System.out.println("è‡ªç„¶é¡ºåºä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆä»å°åˆ°å¤§ï¼‰:");
        while (!naturalOrderQueue.isEmpty()) {
            System.out.println(naturalOrderQueue.poll());
        }
        
        // è‡ªå®šä¹‰æ¯”è¾ƒå™¨ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆæœ€å¤§å †ï¼‰
        Queue<Integer> customOrderQueue = new PriorityQueue<>((a, b) -> b - a);
        customOrderQueue.offer(5);
        customOrderQueue.offer(2);
        customOrderQueue.offer(8);
        customOrderQueue.offer(1);
        customOrderQueue.offer(3);
        
        System.out.println("è‡ªå®šä¹‰é¡ºåºä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆä»å¤§åˆ°å°ï¼‰:");
        while (!customOrderQueue.isEmpty()) {
            System.out.println(customOrderQueue.poll());
        }
        
        // å­—ç¬¦ä¸²ä¼˜å…ˆçº§é˜Ÿåˆ—
        Queue<String> stringQueue = new PriorityQueue<>();
        stringQueue.offer("Java");
        stringQueue.offer("Python");
        stringQueue.offer("C++");
        stringQueue.offer("JavaScript");
        stringQueue.offer("Go");
        
        System.out.println("å­—ç¬¦ä¸²ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆæŒ‰å­—æ¯é¡ºåºï¼‰:");
        while (!stringQueue.isEmpty()) {
            System.out.println(stringQueue.poll());
        }
    }
}
```

#### 3.5.2 è‡ªå®šä¹‰å¯¹è±¡ä¼˜å…ˆçº§é˜Ÿåˆ—

```java title="PriorityQueueè‡ªå®šä¹‰å¯¹è±¡ç¤ºä¾‹"
public class PriorityQueueCustomExample {
    
    // ä»»åŠ¡ç±»
    static class Task implements Comparable<Task> {
        private String name;
        private int priority;  // ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜
        private long createTime;
        
        public Task(String name, int priority) {
            this.name = name;
            this.priority = priority;
            this.createTime = System.currentTimeMillis();
        }
        
        @Override
        public int compareTo(Task other) {
            // é¦–å…ˆæŒ‰ä¼˜å…ˆçº§æ¯”è¾ƒ
            int priorityCompare = Integer.compare(this.priority, other.priority);
            if (priorityCompare != 0) {
                return priorityCompare;
            }
            // ä¼˜å…ˆçº§ç›¸åŒæ—¶ï¼ŒæŒ‰åˆ›å»ºæ—¶é—´æ¯”è¾ƒï¼ˆå…ˆåˆ›å»ºçš„ä¼˜å…ˆï¼‰
            return Long.compare(this.createTime, other.createTime);
        }
        
        @Override
        public String toString() {
            return "Task{name='" + name + "', priority=" + priority + "}";
        }
    }
    
    public static void main(String[] args) {
        // åˆ›å»ºä»»åŠ¡ä¼˜å…ˆçº§é˜Ÿåˆ—
        Queue<Task> taskQueue = new PriorityQueue<>();
        
        // æ·»åŠ ä»»åŠ¡
        taskQueue.offer(new Task("ä½ä¼˜å…ˆçº§ä»»åŠ¡1", 3));
        taskQueue.offer(new Task("é«˜ä¼˜å…ˆçº§ä»»åŠ¡1", 1));
        taskQueue.offer(new Task("ä¸­ä¼˜å…ˆçº§ä»»åŠ¡1", 2));
        taskQueue.offer(new Task("é«˜ä¼˜å…ˆçº§ä»»åŠ¡2", 1));
        taskQueue.offer(new Task("ä½ä¼˜å…ˆçº§ä»»åŠ¡2", 3));
        
        System.out.println("ä»»åŠ¡å¤„ç†é¡ºåº:");
        while (!taskQueue.isEmpty()) {
            Task task = taskQueue.poll();
            System.out.println("å¤„ç†ä»»åŠ¡: " + task);
        }
    }
}
```

#### 3.5.3 ä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå™¨

```java title="PriorityQueueè‡ªå®šä¹‰æ¯”è¾ƒå™¨ç¤ºä¾‹"
public class PriorityQueueComparatorExample {
    
    public static void main(String[] args) {
        // ä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå™¨åˆ›å»ºä¼˜å…ˆçº§é˜Ÿåˆ—
        Queue<String> lengthQueue = new PriorityQueue<>((s1, s2) -> {
            // æŒ‰å­—ç¬¦ä¸²é•¿åº¦æ’åºï¼Œé•¿åº¦çŸ­çš„ä¼˜å…ˆ
            int lengthCompare = Integer.compare(s1.length(), s2.length());
            if (lengthCompare != 0) {
                return lengthCompare;
            }
            // é•¿åº¦ç›¸åŒæ—¶ï¼ŒæŒ‰å­—æ¯é¡ºåºæ’åº
            return s1.compareTo(s2);
        });
        
        lengthQueue.offer("Java");
        lengthQueue.offer("Python");
        lengthQueue.offer("C++");
        lengthQueue.offer("JavaScript");
        lengthQueue.offer("Go");
        lengthQueue.offer("Rust");
        
        System.out.println("æŒ‰é•¿åº¦æ’åºçš„å­—ç¬¦ä¸²é˜Ÿåˆ—:");
        while (!lengthQueue.isEmpty()) {
            System.out.println(lengthQueue.poll());
        }
        
        // ä½¿ç”¨Lambdaè¡¨è¾¾å¼åˆ›å»ºæ¯”è¾ƒå™¨
        Queue<Integer> evenFirstQueue = new PriorityQueue<>((a, b) -> {
            boolean aEven = a % 2 == 0;
            boolean bEven = b % 2 == 0;
            
            if (aEven && !bEven) return -1;  // aæ˜¯å¶æ•°ï¼Œbæ˜¯å¥‡æ•°ï¼Œaä¼˜å…ˆ
            if (!aEven && bEven) return 1;   // aæ˜¯å¥‡æ•°ï¼Œbæ˜¯å¶æ•°ï¼Œbä¼˜å…ˆ
            return Integer.compare(a, b);    // éƒ½æ˜¯å¶æ•°æˆ–éƒ½æ˜¯å¥‡æ•°ï¼ŒæŒ‰æ•°å€¼å¤§å°
        });
        
        evenFirstQueue.offer(5);
        evenFirstQueue.offer(2);
        evenFirstQueue.offer(8);
        evenFirstQueue.offer(1);
        evenFirstQueue.offer(6);
        evenFirstQueue.offer(3);
        
        System.out.println("å¶æ•°ä¼˜å…ˆçš„æ•´æ•°é˜Ÿåˆ—:");
        while (!evenFirstQueue.isEmpty()) {
            System.out.println(evenFirstQueue.poll());
        }
    }
} 

</TabItem>
<TabItem value="blockingqueue" label="BlockingQueue å®ç°">

### 5.1 BlockingQueue æ¥å£æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
BlockingQueueæ˜¯Queueçš„å­æ¥å£ï¼Œæä¾›äº†é˜»å¡æ“ä½œï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- â±ï¸ **é˜»å¡æ“ä½œ**ï¼šæ”¯æŒput/takeç­‰é˜»å¡æ–¹æ³•
- ğŸ”’ **çº¿ç¨‹å®‰å…¨**ï¼šæ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„
- ğŸ“Š **æœ‰ç•Œé˜Ÿåˆ—**ï¼šæŸäº›å®ç°ç±»æ˜¯æœ‰ç•Œçš„
- ğŸ”„ **ç”Ÿäº§è€…-æ¶ˆè´¹è€…**ï¼šå¤©ç„¶é€‚åˆç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼
- â³ **è¶…æ—¶æ“ä½œ**ï¼šæ”¯æŒå¸¦è¶…æ—¶çš„é˜»å¡æ“ä½œ
:::

#### é€‚ç”¨åœºæ™¯
- ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼
- çº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—
- æ¶ˆæ¯é˜Ÿåˆ—å®ç°
- å¹¶å‘æ•°æ®å¤„ç†
- å¼‚æ­¥ä»»åŠ¡è°ƒåº¦

### 4.2 BlockingQueue æ¥å£æ–¹æ³•

```java title="BlockingQueueæ¥å£æ–¹æ³•"
public interface BlockingQueue<E> extends Queue<E> {
    
    // ========== é˜»å¡æ·»åŠ æ“ä½œ ==========
    void put(E e) throws InterruptedException;           // é˜»å¡æ·»åŠ 
    boolean offer(E e, long timeout, TimeUnit unit)      // è¶…æ—¶æ·»åŠ 
        throws InterruptedException;
    
    // ========== é˜»å¡åˆ é™¤æ“ä½œ ==========
    E take() throws InterruptedException;                // é˜»å¡åˆ é™¤
    E poll(long timeout, TimeUnit unit)                  // è¶…æ—¶åˆ é™¤
        throws InterruptedException;
    
    // ========== æ‰¹é‡æ“ä½œ ==========
    int drainTo(Collection<? super E> c);                // æ‰¹é‡è½¬ç§»
    int drainTo(Collection<? super E> c, int maxElements); // é™åˆ¶æ‰¹é‡è½¬ç§»
}
```

### 4.3 ArrayBlockingQueue å®ç°ç±»è¯¦è§£

#### 4.3.1 ArrayBlockingQueue æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
ArrayBlockingQueueæ˜¯åŸºäºæ•°ç»„çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- **æ•°ç»„å®ç°**ï¼šåŸºäºæ•°ç»„çš„å¾ªç¯é˜Ÿåˆ—
- **æœ‰ç•Œé˜Ÿåˆ—**ï¼šå®¹é‡å›ºå®šï¼Œåˆ›å»ºæ—¶æŒ‡å®š
- **çº¿ç¨‹å®‰å…¨**ï¼šä½¿ç”¨ReentrantLockä¿è¯çº¿ç¨‹å®‰å…¨
- **FIFOé¡ºåº**ï¼šä¸¥æ ¼æŒ‰å…ˆè¿›å…ˆå‡ºé¡ºåºå¤„ç†
- **é˜»å¡æ“ä½œ**ï¼šæ”¯æŒput/takeç­‰é˜»å¡æ–¹æ³•
:::

#### 4.3.2 ArrayBlockingQueue å†…éƒ¨ç»“æ„

```java title="ArrayBlockingQueueæ ¸å¿ƒå­—æ®µ"
public class ArrayBlockingQueue<E> extends AbstractQueue<E>
        implements BlockingQueue<E>, java.io.Serializable {
    
    // å­˜å‚¨å…ƒç´ çš„æ•°ç»„
    final Object[] items;
    
    // ä¸‹ä¸€ä¸ªè¦å–å…ƒç´ çš„ä½ç½®
    int takeIndex;
    
    // ä¸‹ä¸€ä¸ªè¦æ”¾å…ƒç´ çš„ä½ç½®
    int putIndex;
    
    // å…ƒç´ ä¸ªæ•°
    int count;
    
    // é”
    final ReentrantLock lock;
    
    // éç©ºæ¡ä»¶
    private final Condition notEmpty;
    
    // éæ»¡æ¡ä»¶
    private final Condition notFull;
}
```

#### 4.3.3 å†…å­˜å¸ƒå±€ç¤ºæ„å›¾

```
ArrayBlockingQueue å®ä¾‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ items: Object[]                         â”‚
â”‚ â”œâ”€â”€ [0] â†’ "Java"                       â”‚
â”‚ â”œâ”€â”€ [1] â†’ "Python"                     â”‚
â”‚ â”œâ”€â”€ [2] â†’ "C++"                        â”‚
â”‚ â”œâ”€â”€ [3] â†’ null                         â”‚
â”‚ â””â”€â”€ [4] â†’ null                         â”‚
â”‚ takeIndex: 0                            â”‚
â”‚ putIndex: 3                             â”‚
â”‚ count: 3                                â”‚
â”‚ lock: ReentrantLock                     â”‚
â”‚ notEmpty: Condition                     â”‚
â”‚ notFull: Condition                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.4 ArrayBlockingQueue æ ¸å¿ƒæ–¹æ³•å®ç°

```java title="ArrayBlockingQueueæ ¸å¿ƒæ–¹æ³•å®ç°"
public class ArrayBlockingQueue<E> extends AbstractQueue<E> {
    
    /**
     * é˜»å¡æ·»åŠ å…ƒç´ 
     * å¦‚æœé˜Ÿåˆ—æ»¡ï¼Œåˆ™é˜»å¡ç­‰å¾…
     */
    public void put(E e) throws InterruptedException {
        checkNotNull(e);
        final ReentrantLock lock = this.lock;
        lock.lockInterruptibly();
        try {
            while (count == items.length)
                notFull.await();  // é˜Ÿåˆ—æ»¡æ—¶ç­‰å¾…
            enqueue(e);
        } finally {
            lock.unlock();
        }
    }
    
    /**
     * é˜»å¡åˆ é™¤å…ƒç´ 
     * å¦‚æœé˜Ÿåˆ—ç©ºï¼Œåˆ™é˜»å¡ç­‰å¾…
     */
    public E take() throws InterruptedException {
        final ReentrantLock lock = this.lock;
        lock.lockInterruptibly();
        try {
            while (count == 0)
                notEmpty.await();  // é˜Ÿåˆ—ç©ºæ—¶ç­‰å¾…
            return dequeue();
        } finally {
            lock.unlock();
        }
    }
    
    /**
     * å…¥é˜Ÿæ“ä½œ
     */
    private void enqueue(E x) {
        final Object[] items = this.items;
        items[putIndex] = x;
        if (++putIndex == items.length)
            putIndex = 0;  // å¾ªç¯é˜Ÿåˆ—
        count++;
        notEmpty.signal();  // å”¤é†’ç­‰å¾…çš„æ¶ˆè´¹è€…
    }
    
    /**
     * å‡ºé˜Ÿæ“ä½œ
     */
    private E dequeue() {
        final Object[] items = this.items;
        @SuppressWarnings("unchecked")
        E x = (E) items[takeIndex];
        items[takeIndex] = null;
        if (++takeIndex == items.length)
            takeIndex = 0;  // å¾ªç¯é˜Ÿåˆ—
        count--;
        notFull.signal();  // å”¤é†’ç­‰å¾…çš„ç”Ÿäº§è€…
        return x;
    }
}
```

#### 4.3.5 ArrayBlockingQueue ä½¿ç”¨ç¤ºä¾‹

```java title="ArrayBlockingQueueä½¿ç”¨ç¤ºä¾‹"
public class ArrayBlockingQueueExample {
    
    public static void main(String[] args) {
        // åˆ›å»ºæœ‰ç•Œé˜»å¡é˜Ÿåˆ—
        BlockingQueue<String> queue = new ArrayBlockingQueue<>(3);
        
        // ç”Ÿäº§è€…çº¿ç¨‹
        Thread producer = new Thread(() -> {
            try {
                String[] items = {"Java", "Python", "C++", "JavaScript", "Go"};
                for (String item : items) {
                    queue.put(item);  // é˜»å¡æ·»åŠ 
                    System.out.println("ç”Ÿäº§è€…æ·»åŠ : " + item);
                    Thread.sleep(500);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });
        
        // æ¶ˆè´¹è€…çº¿ç¨‹
        Thread consumer = new Thread(() -> {
            try {
                Thread.sleep(1000); // å»¶è¿Ÿæ¶ˆè´¹
                for (int i = 0; i < 5; i++) {
                    String item = queue.take();  // é˜»å¡åˆ é™¤
                    System.out.println("æ¶ˆè´¹è€…å¤„ç†: " + item);
                    Thread.sleep(1000);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });
        
        producer.start();
        consumer.start();
        
        try {
            producer.join();
            consumer.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

### 4.4 LinkedBlockingQueue å®ç°ç±»è¯¦è§£

#### 4.4.1 LinkedBlockingQueue æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
LinkedBlockingQueueæ˜¯åŸºäºé“¾è¡¨çš„æœ‰ç•Œæˆ–æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- **é“¾è¡¨å®ç°**ï¼šåŸºäºå•å‘é“¾è¡¨çš„é˜Ÿåˆ—
- **å¯é€‰æœ‰ç•Œ**ï¼šå¯ä»¥æ˜¯æœ‰ç•Œæˆ–æ— ç•Œé˜Ÿåˆ—
- **çº¿ç¨‹å®‰å…¨**ï¼šä½¿ç”¨ä¸¤ä¸ªReentrantLockåˆ†åˆ«ä¿æŠ¤å¤´éƒ¨å’Œå°¾éƒ¨
- **é«˜æ€§èƒ½**ï¼šç›¸æ¯”ArrayBlockingQueueæœ‰æ›´å¥½çš„å¹¶å‘æ€§èƒ½
- **å†…å­˜æ•ˆç‡**ï¼šåŠ¨æ€åˆ†é…å†…å­˜ï¼Œé¿å…å†…å­˜æµªè´¹
:::

#### 4.4.2 LinkedBlockingQueue å†…éƒ¨ç»“æ„

```java title="LinkedBlockingQueueæ ¸å¿ƒå­—æ®µ"
public class LinkedBlockingQueue<E> extends AbstractQueue<E>
        implements BlockingQueue<E>, java.io.Serializable {
    
    // é“¾è¡¨èŠ‚ç‚¹
    static class Node<E> {
        E item;
        Node<E> next;
        
        Node(E x) { item = x; }
    }
    
    // é˜Ÿåˆ—å®¹é‡
    private final int capacity;
    
    // å½“å‰å…ƒç´ ä¸ªæ•°
    private final AtomicInteger count = new AtomicInteger();
    
    // å¤´èŠ‚ç‚¹
    transient Node<E> head;
    
    // å°¾èŠ‚ç‚¹
    private transient Node<E> last;
    
    // å–é”
    private final ReentrantLock takeLock = new ReentrantLock();
    
    // éç©ºæ¡ä»¶
    private final Condition notEmpty = takeLock.newCondition();
    
    // æ”¾é”
    private final ReentrantLock putLock = new ReentrantLock();
    
    // éæ»¡æ¡ä»¶
    private final Condition notFull = putLock.newCondition();
}
```

#### 4.4.3 LinkedBlockingQueue ä½¿ç”¨ç¤ºä¾‹

```java title="LinkedBlockingQueueä½¿ç”¨ç¤ºä¾‹"
public class LinkedBlockingQueueExample {
    
    public static void main(String[] args) {
        // æ— ç•Œé˜Ÿåˆ—
        BlockingQueue<String> unboundedQueue = new LinkedBlockingQueue<>();
        
        // æœ‰ç•Œé˜Ÿåˆ—
        BlockingQueue<String> boundedQueue = new LinkedBlockingQueue<>(100);
        
        // ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼
        BlockingQueue<String> queue = new LinkedBlockingQueue<>(5);
        
        // ç”Ÿäº§è€…
        Thread producer = new Thread(() -> {
            try {
                for (int i = 0; i < 10; i++) {
                    String item = "Item-" + i;
                    queue.put(item);
                    System.out.println("ç”Ÿäº§: " + item);
                    Thread.sleep(100);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });
        
        // æ¶ˆè´¹è€…
        Thread consumer = new Thread(() -> {
            try {
                for (int i = 0; i < 10; i++) {
                    String item = queue.take();
                    System.out.println("æ¶ˆè´¹: " + item);
                    Thread.sleep(200);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });
        
        producer.start();
        consumer.start();
        
        try {
            producer.join();
            consumer.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

### 4.5 SynchronousQueue å®ç°ç±»è¯¦è§£

#### 4.5.1 SynchronousQueue æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
SynchronousQueueæ˜¯ä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- **ä¸å­˜å‚¨å…ƒç´ **ï¼šæ¯ä¸ªæ’å…¥æ“ä½œå¿…é¡»ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹çš„ç§»é™¤æ“ä½œ
- **ç›´æ¥ä¼ é€’**ï¼šé€‚åˆçº¿ç¨‹é—´ç›´æ¥ä¼ é€’æ•°æ®
- **æ€§èƒ½è¾ƒé«˜**ï¼šé¿å…äº†æ•°æ®å¤åˆ¶å’Œå­˜å‚¨å¼€é”€
- **å…¬å¹³æ€§**ï¼šæ”¯æŒå…¬å¹³å’Œéå…¬å¹³æ¨¡å¼
- **é›¶å®¹é‡**ï¼šé˜Ÿåˆ—å®¹é‡å§‹ç»ˆä¸º0
:::

#### 4.5.2 SynchronousQueue ä½¿ç”¨ç¤ºä¾‹

```java title="SynchronousQueueä½¿ç”¨ç¤ºä¾‹"
public class SynchronousQueueExample {
    
    public static void main(String[] args) {
        BlockingQueue<String> queue = new SynchronousQueue<>();
        
        // ç”Ÿäº§è€…çº¿ç¨‹
        Thread producer = new Thread(() -> {
            try {
                for (int i = 0; i < 5; i++) {
                    String item = "Item-" + i;
                    queue.put(item);
                    System.out.println("ç”Ÿäº§: " + item);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });
        
        // æ¶ˆè´¹è€…çº¿ç¨‹
        Thread consumer = new Thread(() -> {
            try {
                for (int i = 0; i < 5; i++) {
                    String item = queue.take();
                    System.out.println("æ¶ˆè´¹: " + item);
                    Thread.sleep(100);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });
        
        consumer.start(); // æ¶ˆè´¹è€…å…ˆå¯åŠ¨
        Thread.sleep(100);
        producer.start(); // ç”Ÿäº§è€…åå¯åŠ¨
        
        try {
            producer.join();
            consumer.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

### 4.6 DelayQueue å®ç°ç±»è¯¦è§£

#### 4.6.1 DelayQueue æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
DelayQueueæ˜¯ä¸€ä¸ªæ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- **å»¶è¿Ÿè·å–**ï¼šåªæœ‰åœ¨å»¶è¿ŸæœŸæ»¡æ—¶æ‰èƒ½ä»ä¸­æå–å…ƒç´ 
- **ä¼˜å…ˆçº§é˜Ÿåˆ—**ï¼šåŸºäºPriorityQueueå®ç°
- **Delayedæ¥å£**ï¼šå…ƒç´ å¿…é¡»å®ç°Delayedæ¥å£
- **å®šæ—¶ä»»åŠ¡**ï¼šé€‚åˆå®šæ—¶ä»»åŠ¡è°ƒåº¦
- **çº¿ç¨‹å®‰å…¨**ï¼šæ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„
:::

#### 4.6.2 DelayQueue ä½¿ç”¨ç¤ºä¾‹

```java title="DelayQueueä½¿ç”¨ç¤ºä¾‹"
public class DelayQueueExample {
    
    // å»¶è¿Ÿå…ƒç´ 
    static class DelayedElement implements Delayed {
        private String name;
        private long startTime;
        
        public DelayedElement(String name, long delay) {
            this.name = name;
            this.startTime = System.currentTimeMillis() + delay;
        }
        
        @Override
        public long getDelay(TimeUnit unit) {
            long diff = startTime - System.currentTimeMillis();
            return unit.convert(diff, TimeUnit.MILLISECONDS);
        }
        
        @Override
        public int compareTo(Delayed o) {
            return Long.compare(this.startTime, ((DelayedElement) o).startTime);
        }
        
        @Override
        public String toString() {
            return name + " - " + startTime;
        }
    }
    
    public static void main(String[] args) {
        DelayQueue<DelayedElement> queue = new DelayQueue<>();
        
        // æ·»åŠ å»¶è¿Ÿå…ƒç´ 
        queue.put(new DelayedElement("Task1", 2000));
        queue.put(new DelayedElement("Task2", 1000));
        queue.put(new DelayedElement("Task3", 3000));
        
        // æ¶ˆè´¹è€…çº¿ç¨‹
        Thread consumer = new Thread(() -> {
            try {
                while (!queue.isEmpty()) {
                    DelayedElement element = queue.take();
                    System.out.println("æ‰§è¡Œ: " + element);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });
        
        consumer.start();
        
        try {
            consumer.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

### 4.7 é˜»å¡é˜Ÿåˆ—æ€§èƒ½å¯¹æ¯”

| å®ç°ç±» | åº•å±‚ç»“æ„ | å®¹é‡ | çº¿ç¨‹å®‰å…¨ | æ€§èƒ½ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|--------|----------|------|----------|----------|----------|
| **ArrayBlockingQueue** | æ•°ç»„ | æœ‰ç•Œ | æ˜¯ | ä¸­ç­‰ | å›ºå®šå®¹é‡åœºæ™¯ |
| **LinkedBlockingQueue** | é“¾è¡¨ | å¯é€‰ | æ˜¯ | é«˜ | åŠ¨æ€å®¹é‡åœºæ™¯ |
| **SynchronousQueue** | æ— å­˜å‚¨ | 0 | æ˜¯ | æœ€é«˜ | ç›´æ¥ä¼ é€’åœºæ™¯ |
| **DelayQueue** | ä¼˜å…ˆçº§é˜Ÿåˆ— | æ— ç•Œ | æ˜¯ | ä¸­ç­‰ | å®šæ—¶ä»»åŠ¡åœºæ™¯ |
| **PriorityBlockingQueue** | ä¼˜å…ˆçº§é˜Ÿåˆ— | æ— ç•Œ | æ˜¯ | ä¸­ç­‰ | ä¼˜å…ˆçº§å¤„ç†åœºæ™¯ | 

</TabItem>
</Tabs>

## 5. å®é™…åº”ç”¨åœºæ™¯

```mermaid
graph TD
    subgraph åº”ç”¨åœºæ™¯
        A["Queueåº”ç”¨åœºæ™¯"] --> B["ä»»åŠ¡è°ƒåº¦"]
        A --> C["æ¶ˆæ¯ä¼ é€’"]
        A --> D["å¹¶å‘æ§åˆ¶"]
        A --> E["èµ„æºç®¡ç†"]
    end
    
    B --> B1["ä¼˜å…ˆçº§ä»»åŠ¡é˜Ÿåˆ—"]
    B --> B2["å®šæ—¶ä»»åŠ¡"]
    B --> B3["äº‹ä»¶é©±åŠ¨æ¨¡å‹"]
    
    C --> C1["æ¶ˆæ¯é˜Ÿåˆ—"]
    C --> C2["ç¼“å†²åŒº"]
    C --> C3["æ—¥å¿—å¤„ç†"]
    
    D --> D1["ç”Ÿäº§è€…-æ¶ˆè´¹è€…"]
    D --> D2["çº¿ç¨‹æ± é˜Ÿåˆ—"]
    D --> D3["è¯·æ±‚é™æµ"]
    
    E --> E1["è¿æ¥æ± ç®¡ç†"]
    E --> E2["å¯¹è±¡æ± "]
    E --> E3["å†…å­˜ç®¡ç†"]
    
    subgraph å®ç°ç±»é€‰æ‹©
        F["å®ç°ç±»é€‰æ‹©"] --> F1["LinkedList"]
        F --> F2["ArrayDeque"]
        F --> F3["PriorityQueue"]
        F --> F4["BlockingQueue"]
        
        F1 --> G1["ä¸€èˆ¬åœºæ™¯"]
        F2 --> G2["é«˜æ€§èƒ½è¦æ±‚"]
        F3 --> G3["ä¼˜å…ˆçº§æ’åº"]
        F4 --> G4["å¹¶å‘/é˜»å¡"]
    end
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style F fill:#bbf,stroke:#333,stroke-width:1px
```

### 5.1 ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼

```java title="ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ç¤ºä¾‹"
public class ProducerConsumerExample {
    private static final int QUEUE_SIZE = 10;
    private static final BlockingQueue<String> queue = new ArrayBlockingQueue<>(QUEUE_SIZE);
    
    // ç”Ÿäº§è€…
    static class Producer implements Runnable {
        private String name;
        
        public Producer(String name) {
            this.name = name;
        }
        
        @Override
        public void run() {
            try {
                for (int i = 0; i < 5; i++) {
                    String item = name + "-Item-" + i;
                    queue.put(item);
                    System.out.println(name + " ç”Ÿäº§: " + item);
                    Thread.sleep(100);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
    
    // æ¶ˆè´¹è€…
    static class Consumer implements Runnable {
        private String name;
        
        public Consumer(String name) {
            this.name = name;
        }
        
        @Override
        public void run() {
            try {
                for (int i = 0; i < 5; i++) {
                    String item = queue.take();
                    System.out.println(name + " æ¶ˆè´¹: " + item);
                    Thread.sleep(200);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
    
    public static void main(String[] args) {
        Thread producer1 = new Thread(new Producer("Producer1"));
        Thread producer2 = new Thread(new Producer("Producer2"));
        Thread consumer1 = new Thread(new Consumer("Consumer1"));
        Thread consumer2 = new Thread(new Consumer("Consumer2"));
        
        producer1.start();
        producer2.start();
        consumer1.start();
        consumer2.start();
        
        try {
            producer1.join();
            producer2.join();
            consumer1.join();
            consumer2.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

### 5.2 ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ

```java title="ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿç¤ºä¾‹"
public class TaskSchedulerExample {
    private static final DelayQueue<DelayedTask> taskQueue = new DelayQueue<>();
    
    static class DelayedTask implements Delayed {
        private String taskName;
        private long executeTime;
        
        public DelayedTask(String taskName, long delay) {
            this.taskName = taskName;
            this.executeTime = System.currentTimeMillis() + delay;
        }
        
        @Override
        public long getDelay(TimeUnit unit) {
            return unit.convert(executeTime - System.currentTimeMillis(), TimeUnit.MILLISECONDS);
        }
        
        @Override
        public int compareTo(Delayed o) {
            return Long.compare(this.executeTime, ((DelayedTask) o).executeTime);
        }
        
        public void execute() {
            System.out.println("æ‰§è¡Œä»»åŠ¡: " + taskName + " æ—¶é—´: " + new Date());
        }
    }
    
    public static void main(String[] args) {
        // æ·»åŠ å®šæ—¶ä»»åŠ¡
        taskQueue.put(new DelayedTask("Task1", 2000));
        taskQueue.put(new DelayedTask("Task2", 1000));
        taskQueue.put(new DelayedTask("Task3", 3000));
        
        // ä»»åŠ¡æ‰§è¡Œå™¨
        Thread executor = new Thread(() -> {
            try {
                while (true) {
                    DelayedTask task = taskQueue.take();
                    task.execute();
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });
        
        executor.start();
        
        try {
            Thread.sleep(5000);
            executor.interrupt();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

### 5.3 æ¶ˆæ¯é˜Ÿåˆ—å®ç°

```java title="æ¶ˆæ¯é˜Ÿåˆ—å®ç°ç¤ºä¾‹"
public class MessageQueueExample {
    
    // æ¶ˆæ¯ç±»
    static class Message {
        private String id;
        private String content;
        private long timestamp;
        
        public Message(String id, String content) {
            this.id = id;
            this.content = content;
            this.timestamp = System.currentTimeMillis();
        }
        
        @Override
        public String toString() {
            return "Message{id='" + id + "', content='" + content + "', timestamp=" + timestamp + "}";
        }
    }
    
    // æ¶ˆæ¯é˜Ÿåˆ—
    static class MessageQueue {
        private final BlockingQueue<Message> queue;
        private final String name;
        
        public MessageQueue(String name, int capacity) {
            this.name = name;
            this.queue = new LinkedBlockingQueue<>(capacity);
        }
        
        public void sendMessage(Message message) throws InterruptedException {
            queue.put(message);
            System.out.println("å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ— " + name + ": " + message);
        }
        
        public Message receiveMessage() throws InterruptedException {
            Message message = queue.take();
            System.out.println("ä»é˜Ÿåˆ— " + name + " æ¥æ”¶æ¶ˆæ¯: " + message);
            return message;
        }
        
        public int size() {
            return queue.size();
        }
    }
    
    public static void main(String[] args) {
        MessageQueue messageQueue = new MessageQueue("main", 100);
        
        // å‘é€è€…çº¿ç¨‹
        Thread sender = new Thread(() -> {
            try {
                for (int i = 0; i < 10; i++) {
                    Message message = new Message("msg-" + i, "å†…å®¹-" + i);
                    messageQueue.sendMessage(message);
                    Thread.sleep(100);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });
        
        // æ¥æ”¶è€…çº¿ç¨‹
        Thread receiver = new Thread(() -> {
            try {
                for (int i = 0; i < 10; i++) {
                    messageQueue.receiveMessage();
                    Thread.sleep(200);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });
        
        sender.start();
        receiver.start();
        
        try {
            sender.join();
            receiver.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

### 5.4 çº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—

```java title="çº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—ç¤ºä¾‹"
public class ThreadPoolTaskQueueExample {
    
    // ä»»åŠ¡ç±»
    static class Task implements Runnable {
        private String name;
        private int priority;
        
        public Task(String name, int priority) {
            this.name = name;
            this.priority = priority;
        }
        
        @Override
        public void run() {
            System.out.println("æ‰§è¡Œä»»åŠ¡: " + name + " (ä¼˜å…ˆçº§: " + priority + ")");
            try {
                Thread.sleep(100); // æ¨¡æ‹Ÿä»»åŠ¡æ‰§è¡Œæ—¶é—´
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        
        public int getPriority() {
            return priority;
        }
    }
    
    // ä¼˜å…ˆçº§ä»»åŠ¡æ¯”è¾ƒå™¨
    static class TaskComparator implements Comparator<Task> {
        @Override
        public int compare(Task t1, Task t2) {
            return Integer.compare(t1.getPriority(), t2.getPriority());
        }
    }
    
    public static void main(String[] args) {
        // ä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—çš„çº¿ç¨‹æ± 
        BlockingQueue<Runnable> taskQueue = new PriorityBlockingQueue<>(100, new TaskComparator());
        
        // åˆ›å»ºçº¿ç¨‹æ± 
        ThreadPoolExecutor executor = new ThreadPoolExecutor(
            2,  // æ ¸å¿ƒçº¿ç¨‹æ•°
            4,  // æœ€å¤§çº¿ç¨‹æ•°
            60L, // ç©ºé—²çº¿ç¨‹å­˜æ´»æ—¶é—´
            TimeUnit.SECONDS,
            taskQueue
        );
        
        // æäº¤ä»»åŠ¡
        executor.submit(new Task("é«˜ä¼˜å…ˆçº§ä»»åŠ¡1", 1));
        executor.submit(new Task("ä½ä¼˜å…ˆçº§ä»»åŠ¡1", 3));
        executor.submit(new Task("ä¸­ä¼˜å…ˆçº§ä»»åŠ¡1", 2));
        executor.submit(new Task("é«˜ä¼˜å…ˆçº§ä»»åŠ¡2", 1));
        executor.submit(new Task("ä½ä¼˜å…ˆçº§ä»»åŠ¡2", 3));
        
        // å…³é—­çº¿ç¨‹æ± 
        executor.shutdown();
        
        try {
            executor.awaitTermination(5, TimeUnit.SECONDS);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

## 6. æœ€ä½³å®è·µæ€»ç»“

### 6.1 Queueå®ç°ç±»é€‰æ‹©ç­–ç•¥

:::tip é€‰æ‹©å»ºè®®
é€‰æ‹©åˆé€‚çš„Queueå®ç°ç±»éœ€è¦è€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š
- **ä½¿ç”¨åœºæ™¯**ï¼šä¸€èˆ¬é˜Ÿåˆ—ã€ä¼˜å…ˆçº§é˜Ÿåˆ—ã€é˜»å¡é˜Ÿåˆ—
- **æ€§èƒ½è¦æ±‚**ï¼šæ’å…¥åˆ é™¤æ€§èƒ½ã€å†…å­˜ä½¿ç”¨æ•ˆç‡
- **çº¿ç¨‹å®‰å…¨**ï¼šå•çº¿ç¨‹ç¯å¢ƒè¿˜æ˜¯å¤šçº¿ç¨‹ç¯å¢ƒ
- **å®¹é‡è¦æ±‚**ï¼šæœ‰ç•Œé˜Ÿåˆ—è¿˜æ˜¯æ— ç•Œé˜Ÿåˆ—
- **åŠŸèƒ½éœ€æ±‚**ï¼šæ˜¯å¦éœ€è¦é˜»å¡æ“ä½œã€ä¼˜å…ˆçº§æ’åºç­‰
:::

| å®ç°ç±» | é€‚ç”¨åœºæ™¯ | ä¼˜åŠ¿ | åŠ£åŠ¿ |
|--------|----------|------|------|
| **LinkedList** | ä¸€èˆ¬é˜Ÿåˆ—ã€åŒç«¯é˜Ÿåˆ— | æ’å…¥åˆ é™¤å¿«ã€åŠŸèƒ½ä¸°å¯Œ | éšæœºè®¿é—®æ…¢ã€çº¿ç¨‹ä¸å®‰å…¨ |
| **PriorityQueue** | ä¼˜å…ˆçº§å¤„ç† | è‡ªåŠ¨æ’åºã€æ€§èƒ½ç¨³å®š | çº¿ç¨‹ä¸å®‰å…¨ã€å†…å­˜å¼€é”€ |
| **ArrayBlockingQueue** | å›ºå®šå®¹é‡ç”Ÿäº§è€…-æ¶ˆè´¹è€… | çº¿ç¨‹å®‰å…¨ã€æ€§èƒ½ç¨³å®š | å®¹é‡å›ºå®šã€å†…å­˜æµªè´¹ |
| **LinkedBlockingQueue** | åŠ¨æ€å®¹é‡ç”Ÿäº§è€…-æ¶ˆè´¹è€… | çº¿ç¨‹å®‰å…¨ã€å†…å­˜æ•ˆç‡é«˜ | å†…å­˜åˆ†é…å¼€é”€ |
| **SynchronousQueue** | çº¿ç¨‹é—´ç›´æ¥ä¼ é€’ | æ€§èƒ½æœ€é«˜ã€é›¶å†…å­˜å¼€é”€ | å®¹é‡ä¸ºé›¶ã€ä½¿ç”¨å¤æ‚ |
| **DelayQueue** | å®šæ—¶ä»»åŠ¡è°ƒåº¦ | å»¶è¿Ÿå¤„ç†ã€è‡ªåŠ¨æ’åº | ä½¿ç”¨å¤æ‚ã€æ€§èƒ½ä¸­ç­‰ |

### 6.2 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

```java title="Queueæ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹"
public class QueuePerformanceOptimization {
    
    /**
     * é¢„åˆ†é…å®¹é‡ä¼˜åŒ–
     */
    public static void capacityOptimization() {
        // çŸ¥é“å¤§æ¦‚å…ƒç´ æ•°é‡æ—¶ï¼Œé¢„åˆ†é…å®¹é‡
        int expectedSize = 1000;
        BlockingQueue<String> optimizedQueue = new ArrayBlockingQueue<>(expectedSize);
        
        // é¿å…é¢‘ç¹æ‰©å®¹
        for (int i = 0; i < expectedSize; i++) {
            try {
                optimizedQueue.put("item" + i);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
    
    /**
     * æ‰¹é‡æ“ä½œä¼˜åŒ–
     */
    public static void batchOperationOptimization() {
        Queue<String> queue = new LinkedList<>();
        Collection<String> items = Arrays.asList("a", "b", "c", "d", "e");
        
        // æ‰¹é‡æ·»åŠ ï¼Œæ¯”å¾ªç¯addæ•ˆç‡é«˜
        queue.addAll(items);
        
        // æ‰¹é‡å¤„ç†
while (!queue.isEmpty()) {
    String item = queue.poll();
            // å¤„ç†å…ƒç´ 
        }
    }
    
    /**
     * é˜»å¡æ“ä½œä¼˜åŒ–
     */
    public static void blockingOperationOptimization() {
        BlockingQueue<String> queue = new LinkedBlockingQueue<>(10);
        
        // ä½¿ç”¨è¶…æ—¶æ“ä½œé¿å…æ— é™é˜»å¡
        try {
            boolean offered = queue.offer("item", 1, TimeUnit.SECONDS);
            if (!offered) {
                System.out.println("æ·»åŠ å¤±è´¥ï¼Œé˜Ÿåˆ—å·²æ»¡");
            }
            
            String item = queue.poll(1, TimeUnit.SECONDS);
            if (item == null) {
                System.out.println("è·å–å¤±è´¥ï¼Œé˜Ÿåˆ—ä¸ºç©º");
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

### 6.3 å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ

:::caution æ³¨æ„äº‹é¡¹
1. **æ— é™é˜»å¡**ï¼šä½¿ç”¨put/takeæ–¹æ³•æ—¶å¯èƒ½æ— é™é˜»å¡ï¼Œåº”ä½¿ç”¨è¶…æ—¶ç‰ˆæœ¬
2. **å†…å­˜æ³„æ¼**ï¼šæ— ç•Œé˜Ÿåˆ—å¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡ºï¼Œåº”è®¾ç½®åˆç†çš„å®¹é‡é™åˆ¶
3. **çº¿ç¨‹å®‰å…¨é—®é¢˜**ï¼šLinkedListå’ŒPriorityQueueä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„
4. **ä¼˜å…ˆçº§é˜Ÿåˆ—æ’åº**ï¼šè‡ªå®šä¹‰å¯¹è±¡å¿…é¡»å®ç°Comparableæ¥å£æˆ–æä¾›Comparator
5. **å»¶è¿Ÿé˜Ÿåˆ—ä½¿ç”¨**ï¼šå…ƒç´ å¿…é¡»å®ç°Delayedæ¥å£
:::

```java title="å¸¸è§é™·é˜±ç¤ºä¾‹"
public class QueueCommonTraps {
    
    /**
     * æ— é™é˜»å¡é™·é˜±
     */
    public static void infiniteBlockingTrap() {
        BlockingQueue<String> queue = new ArrayBlockingQueue<>(1);
        
        // é”™è¯¯ï¼šå¯èƒ½æ— é™é˜»å¡
        try {
            queue.put("item1");
            queue.put("item2"); // å¯èƒ½æ— é™é˜»å¡
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        
        // æ­£ç¡®ï¼šä½¿ç”¨è¶…æ—¶æ“ä½œ
        try {
            boolean offered = queue.offer("item2", 1, TimeUnit.SECONDS);
            if (!offered) {
                System.out.println("æ·»åŠ å¤±è´¥ï¼Œè¶…æ—¶");
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
    
    /**
     * çº¿ç¨‹å®‰å…¨é—®é¢˜
     */
    public static void threadSafetyTrap() {
        Queue<String> queue = new LinkedList<>(); // çº¿ç¨‹ä¸å®‰å…¨
        
        // é”™è¯¯ï¼šå¤šçº¿ç¨‹è®¿é—®
        Thread t1 = new Thread(() -> {
            for (int i = 0; i < 100; i++) {
                queue.offer("item" + i);
            }
        });
        
        Thread t2 = new Thread(() -> {
            for (int i = 0; i < 100; i++) {
                queue.poll();
            }
        });
        
        // æ­£ç¡®ï¼šä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—
        BlockingQueue<String> safeQueue = new LinkedBlockingQueue<>();
        // æˆ–è€…ä½¿ç”¨Collections.synchronizedQueue(queue)
    }
    
    /**
     * ä¼˜å…ˆçº§é˜Ÿåˆ—é™·é˜±
     */
    public static void priorityQueueTrap() {
        // é”™è¯¯ï¼šè‡ªå®šä¹‰å¯¹è±¡æ²¡æœ‰å®ç°Comparable
        // Queue<CustomObject> queue = new PriorityQueue<>(); // ç¼–è¯‘é”™è¯¯
        
        // æ­£ç¡®ï¼šå®ç°Comparableæ¥å£
        Queue<ComparableObject> queue1 = new PriorityQueue<>();
        
        // æˆ–è€…æä¾›Comparator
        Queue<CustomObject> queue2 = new PriorityQueue<>((o1, o2) -> o1.name.compareTo(o2.name));
    }
    
    static class ComparableObject implements Comparable<ComparableObject> {
        String name;
        
        @Override
        public int compareTo(ComparableObject other) {
            return this.name.compareTo(other.name);
        }
    }
    
    static class CustomObject {
        String name;
    }
}
```

### 6.4 æµ‹è¯•å’Œè°ƒè¯•å»ºè®®

```java title="Queueæµ‹è¯•è°ƒè¯•ç¤ºä¾‹"
public class QueueTestingDebugging {
    
    /**
     * å•å…ƒæµ‹è¯•ç¤ºä¾‹
     */
    public static void unitTestExample() {
        Queue<String> queue = new LinkedList<>();
        
        // æµ‹è¯•æ·»åŠ æ“ä½œ
        assert queue.isEmpty();
        queue.offer("test");
        assert queue.size() == 1;
        assert "test".equals(queue.peek());
        
        // æµ‹è¯•åˆ é™¤æ“ä½œ
        String removed = queue.poll();
        assert "test".equals(removed);
        assert queue.isEmpty();
        
        System.out.println("æ‰€æœ‰æµ‹è¯•é€šè¿‡");
    }
    
    /**
     * æ€§èƒ½æµ‹è¯•ç¤ºä¾‹
     */
    public static void performanceTestExample() {
        int size = 100000;
        
        // LinkedListæ€§èƒ½æµ‹è¯•
        long start = System.currentTimeMillis();
        Queue<Integer> linkedListQueue = new LinkedList<>();
        for (int i = 0; i < size; i++) {
            linkedListQueue.offer(i);
        }
        long linkedListTime = System.currentTimeMillis() - start;
        
        // PriorityQueueæ€§èƒ½æµ‹è¯•
        start = System.currentTimeMillis();
        Queue<Integer> priorityQueue = new PriorityQueue<>();
        for (int i = 0; i < size; i++) {
            priorityQueue.offer(i);
        }
        long priorityQueueTime = System.currentTimeMillis() - start;
        
        System.out.println("LinkedListæ·»åŠ " + size + "ä¸ªå…ƒç´ è€—æ—¶: " + linkedListTime + "ms");
        System.out.println("PriorityQueueæ·»åŠ " + size + "ä¸ªå…ƒç´ è€—æ—¶: " + priorityQueueTime + "ms");
    }
    
    /**
     * å¹¶å‘æµ‹è¯•ç¤ºä¾‹
     */
    public static void concurrentTestExample() {
        BlockingQueue<String> queue = new ArrayBlockingQueue<>(100);
        int producerCount = 3;
        int consumerCount = 2;
        
        // ç”Ÿäº§è€…çº¿ç¨‹
        for (int i = 0; i < producerCount; i++) {
            final int producerId = i;
            new Thread(() -> {
                try {
                    for (int j = 0; j < 100; j++) {
                        queue.put("Producer" + producerId + "-Item" + j);
                        Thread.sleep(10);
                    }
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }).start();
        }
        
        // æ¶ˆè´¹è€…çº¿ç¨‹
        for (int i = 0; i < consumerCount; i++) {
            final int consumerId = i;
            new Thread(() -> {
                try {
                    for (int j = 0; j < 150; j++) {
                        String item = queue.take();
                        System.out.println("Consumer" + consumerId + " å¤„ç†: " + item);
                        Thread.sleep(20);
                    }
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }).start();
        }
    }
}
```

## 7. æ€»ç»“

Queueæ¥å£ä½œä¸ºJavaé›†åˆæ¡†æ¶çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæä¾›äº†ä¸°å¯Œå¤šæ ·çš„é˜Ÿåˆ—å®ç°ï¼Œæ»¡è¶³äº†ä¸åŒåœºæ™¯ä¸‹çš„éœ€æ±‚ã€‚é€šè¿‡æ·±å…¥ç†è§£å„ç§Queueå®ç°ç±»çš„ç‰¹æ€§å’Œä½¿ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå‡ºé«˜æ•ˆã€å¯é çš„å¹¶å‘åº”ç”¨ç¨‹åºã€‚

åœ¨å®é™…å¼€å‘ä¸­ï¼Œéœ€è¦ç»¼åˆè€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
- **åŠŸèƒ½éœ€æ±‚**ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„é˜Ÿåˆ—ç±»å‹
- **æ€§èƒ½è¦æ±‚**ï¼šè€ƒè™‘æ’å…¥åˆ é™¤æ€§èƒ½ã€å†…å­˜ä½¿ç”¨æ•ˆç‡
- **å¹¶å‘å®‰å…¨**ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹é€‰æ‹©åˆé€‚çš„çº¿ç¨‹å®‰å…¨å®ç°
- **èµ„æºç®¡ç†**ï¼šåˆç†è®¾ç½®é˜Ÿåˆ—å®¹é‡ï¼Œé¿å…å†…å­˜æº¢å‡º
- **é”™è¯¯å¤„ç†**ï¼šæ­£ç¡®å¤„ç†é˜»å¡æ“ä½œå’Œå¼‚å¸¸æƒ…å†µ

é€šè¿‡åˆç†ä½¿ç”¨Queueé›†åˆï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå‡ºé«˜æ•ˆã€å¯é çš„Javaåº”ç”¨ç¨‹åºã€‚

## 8. é¢è¯•é¢˜ç²¾é€‰

### 8.1 åŸºç¡€æ¦‚å¿µé¢˜

**Q: Queueå’ŒStackçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ**

A: ä¸»è¦åŒºåˆ«åŒ…æ‹¬ï¼š
- **å¤„ç†é¡ºåº**ï¼šQueueæ˜¯å…ˆè¿›å…ˆå‡º(FIFO)ï¼ŒStackæ˜¯åè¿›å…ˆå‡º(LIFO)
- **ç»§æ‰¿å…³ç³»**ï¼šQueueç»§æ‰¿è‡ªCollectionï¼ŒStackç»§æ‰¿è‡ªVector
- **é˜»å¡æ“ä½œ**ï¼šQueueçš„æŸäº›å®ç°ç±»æ”¯æŒé˜»å¡æ“ä½œï¼ŒStackä¸æ”¯æŒ
- **ä½¿ç”¨åœºæ™¯**ï¼šQueueé€‚åˆä»»åŠ¡è°ƒåº¦ï¼ŒStacké€‚åˆå‡½æ•°è°ƒç”¨æ ˆ

**Q: PriorityQueueçš„å·¥ä½œåŸç†æ˜¯æ€æ ·çš„ï¼Ÿ**

A: PriorityQueueå·¥ä½œåŸç†ï¼š
- **åº•å±‚ç»“æ„**ï¼šåŸºäºæ•°ç»„å®ç°çš„äºŒå‰å †
- **æ’åºæœºåˆ¶**ï¼šä½¿ç”¨è‡ªç„¶é¡ºåºæˆ–è‡ªå®šä¹‰æ¯”è¾ƒå™¨æ’åº
- **æ’å…¥æ“ä½œ**ï¼šO(log n)ï¼Œéœ€è¦ä¸Šæµ®æ“ä½œè°ƒæ•´å †ç»“æ„
- **åˆ é™¤æ“ä½œ**ï¼šO(log n)ï¼Œéœ€è¦ä¸‹æ²‰æ“ä½œè°ƒæ•´å †ç»“æ„
- **å †æ€§è´¨**ï¼šä¿è¯æ ¹èŠ‚ç‚¹æ˜¯ä¼˜å…ˆçº§æœ€é«˜ï¼ˆæˆ–æœ€ä½ï¼‰çš„å…ƒç´ 

### 8.2 æ€§èƒ½ä¼˜åŒ–é¢˜

**Q: å¦‚ä½•ä¼˜åŒ–Queueçš„æ€§èƒ½ï¼Ÿ**

A: ä¸»è¦ä¼˜åŒ–ç­–ç•¥ï¼š
- **é¢„åˆ†é…å®¹é‡**ï¼šä½¿ç”¨å¸¦åˆå§‹å®¹é‡çš„æ„é€ å‡½æ•°
- **æ‰¹é‡æ“ä½œ**ï¼šä½¿ç”¨addAll()è€Œéå¾ªç¯add()
- **é€‰æ‹©åˆé€‚çš„å®ç°ç±»**ï¼šæ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©æœ€åˆé€‚çš„é˜Ÿåˆ—
- **é¿å…é¢‘ç¹æ‰©å®¹**ï¼šåˆç†è®¾ç½®åˆå§‹å®¹é‡
- **ä½¿ç”¨è¶…æ—¶æ“ä½œ**ï¼šé¿å…æ— é™é˜»å¡

**Q: ä»€ä¹ˆåœºæ™¯ä¸‹é€‰æ‹©é˜»å¡é˜Ÿåˆ—ï¼Ÿ**

A: é˜»å¡é˜Ÿåˆ—é€‚ç”¨åœºæ™¯ï¼š
- ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼
- çº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ—
- éœ€è¦çº¿ç¨‹é—´åè°ƒçš„åœºæ™¯
- éœ€è¦æ§åˆ¶å¹¶å‘åº¦çš„åœºæ™¯
- å¼‚æ­¥ä»»åŠ¡å¤„ç†

### 8.3 å®è·µåº”ç”¨é¢˜

**Q: å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨çš„Queueæ“ä½œï¼Ÿ**

A: çº¿ç¨‹å®‰å…¨æ–¹æ¡ˆï¼š
- **ä½¿ç”¨é˜»å¡é˜Ÿåˆ—**ï¼šArrayBlockingQueueã€LinkedBlockingQueueç­‰
- **Collections.synchronizedQueue()**ï¼šåŒ…è£…ç°æœ‰Queue
- **å¤–éƒ¨åŒæ­¥**ï¼šä½¿ç”¨synchronizedæˆ–Lock
- **å¹¶å‘é›†åˆ**ï¼šè€ƒè™‘ä½¿ç”¨ConcurrentLinkedQueueç­‰

**Q: å¦‚ä½•å¤„ç†Queueä¸­çš„é˜»å¡æ“ä½œï¼Ÿ**

A: å¤„ç†æ–¹æ¡ˆï¼š
- **ä½¿ç”¨è¶…æ—¶ç‰ˆæœ¬**ï¼šoffer(e, timeout, unit)ã€poll(timeout, unit)
- **å¼‚å¸¸å¤„ç†**ï¼šæ­£ç¡®å¤„ç†InterruptedException
- **ä¸­æ–­å¤„ç†**ï¼šå“åº”çº¿ç¨‹ä¸­æ–­ä¿¡å·
- **æ›¿ä»£æ–¹æ¡ˆ**ï¼šä½¿ç”¨éé˜»å¡æ–¹æ³•é…åˆè½®è¯¢

**Q: PriorityQueueçš„æ’åºè§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ**

A: æ’åºè§„åˆ™ï¼š
- **è‡ªç„¶é¡ºåº**ï¼šå…ƒç´ å¿…é¡»å®ç°Comparableæ¥å£
- **è‡ªå®šä¹‰æ¯”è¾ƒå™¨**ï¼šé€šè¿‡ComparatoræŒ‡å®šæ’åºè§„åˆ™
- **æœ€å°å †**ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œæ ¹èŠ‚ç‚¹æ˜¯æœ€å°å…ƒç´ 
- **æœ€å¤§å †**ï¼šå¯ä»¥é€šè¿‡æ¯”è¾ƒå™¨å®ç°æœ€å¤§å †
- **ç¨³å®šæ€§**ï¼šç›¸åŒä¼˜å…ˆçº§çš„å…ƒç´ é¡ºåºä¸ç¡®å®š

### 8.4 é«˜çº§åº”ç”¨é¢˜

**Q: å¦‚ä½•å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„é˜»å¡é˜Ÿåˆ—ï¼Ÿ**

A: å®ç°æ­¥éª¤ï¼š
- **ç»§æ‰¿AbstractQueue**ï¼šå®ç°åŸºæœ¬çš„é˜Ÿåˆ—æ“ä½œ
- **ä½¿ç”¨ReentrantLock**ï¼šä¿è¯çº¿ç¨‹å®‰å…¨
- **ä½¿ç”¨Condition**ï¼šå®ç°é˜»å¡å’Œå”¤é†’æœºåˆ¶
- **å®ç°put/takeæ–¹æ³•**ï¼šæä¾›é˜»å¡æ“ä½œ
- **å¤„ç†è¾¹ç•Œæ¡ä»¶**ï¼šé˜Ÿåˆ—æ»¡/ç©ºæ—¶çš„å¤„ç†

**Q: DelayQueueçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ**

A: åº”ç”¨åœºæ™¯ï¼š
- **å®šæ—¶ä»»åŠ¡è°ƒåº¦**ï¼šå»¶è¿Ÿæ‰§è¡Œä»»åŠ¡
- **ç¼“å­˜è¿‡æœŸ**ï¼šå»¶è¿Ÿæ¸…ç†è¿‡æœŸæ•°æ®
- **è¶…æ—¶å¤„ç†**ï¼šå»¶è¿Ÿå¤„ç†è¶…æ—¶è¯·æ±‚
- **é‡è¯•æœºåˆ¶**ï¼šå»¶è¿Ÿé‡è¯•å¤±è´¥çš„æ“ä½œ
- **äº‹ä»¶å¤„ç†**ï¼šå»¶è¿Ÿå¤„ç†æŸäº›äº‹ä»¶

**Q: SynchronousQueueçš„ç‰¹ç‚¹å’Œç”¨é€”ï¼Ÿ**

A: ç‰¹ç‚¹å’Œç”¨é€”ï¼š
- **é›¶å®¹é‡**ï¼šä¸å­˜å‚¨ä»»ä½•å…ƒç´ 
- **ç›´æ¥ä¼ é€’**ï¼šç”Ÿäº§è€…ç›´æ¥ä¼ é€’ç»™æ¶ˆè´¹è€…
- **é«˜æ€§èƒ½**ï¼šé¿å…äº†æ•°æ®å¤åˆ¶å’Œå­˜å‚¨å¼€é”€
- **å…¬å¹³æ€§**ï¼šæ”¯æŒå…¬å¹³å’Œéå…¬å¹³æ¨¡å¼
- **ç”¨é€”**ï¼šçº¿ç¨‹é—´ç›´æ¥æ•°æ®ä¼ é€’ã€äº‹ä»¶å¤„ç†

:::tip é¢è¯•è¦ç‚¹
1. **ç†è§£åº•å±‚å®ç°**ï¼šæŒæ¡å„ç§Queueçš„å†…éƒ¨ç»“æ„å’Œå·¥ä½œåŸç†
2. **æ€§èƒ½åˆ†æ**ï¼šèƒ½å¤Ÿåˆ†æä¸åŒæ“ä½œçš„æ—¶é—´å¤æ‚åº¦
3. **åœºæ™¯é€‰æ‹©**ï¼šæ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„Queueå®ç°
4. **å¹¶å‘å®‰å…¨**ï¼šç†è§£çº¿ç¨‹å®‰å…¨å’Œå¹¶å‘æ§åˆ¶æœºåˆ¶
5. **æœ€ä½³å®è·µ**ï¼šäº†è§£å¸¸è§é™·é˜±å’Œä¼˜åŒ–ç­–ç•¥
:::

---

é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†Java Queueé›†åˆçš„æ ¸å¿ƒæ¦‚å¿µã€å®ç°åŸç†å’Œæœ€ä½³å®è·µã€‚Queueæ˜¯Javaå¹¶å‘ç¼–ç¨‹å’Œå¼‚æ­¥å¤„ç†çš„é‡è¦åŸºç¡€ï¼Œæ·±å…¥ç†è§£å…¶ç‰¹æ€§å’Œä½¿ç”¨åœºæ™¯ï¼Œå¯¹äºç¼–å†™é«˜æ•ˆã€å¯é çš„Javaç¨‹åºè‡³å…³é‡è¦ã€‚ 