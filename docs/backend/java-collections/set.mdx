---
sidebar_position: 3
title: Java Seté›†åˆè¯¦è§£
description: å…¨é¢ä»‹ç»Java Setæ¥å£åŠå…¶å®ç°ç±»ã€æ ¸å¿ƒç‰¹æ€§ã€æ€§èƒ½åˆ†æä¸æœ€ä½³å®è·µ
authors: [Laby]
last_update:
  date: 2025-08-07
  author: Laby
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Java Set é›†åˆè¯¦è§£

Setæ˜¯Javaé›†åˆæ¡†æ¶ä¸­ç”¨äºå­˜å‚¨ä¸é‡å¤å…ƒç´ çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒç»§æ‰¿è‡ªCollectionæ¥å£ï¼Œæä¾›äº†å…ƒç´ å”¯ä¸€æ€§çš„ä¿è¯ã€‚åœ¨Javaå¼€å‘ä¸­ï¼ŒSeté›†åˆè¢«å¹¿æ³›åº”ç”¨äºå»é‡ã€é›†åˆè¿ç®—ã€ç¼“å­˜å®ç°ç­‰å„ç§åœºæ™¯ï¼Œæ˜¯æ•°æ®å¤„ç†å’Œç®—æ³•å®ç°çš„é‡è¦åŸºç¡€ã€‚

:::tip æ ¸å¿ƒç‰¹æ€§
**Setæ¥å£ = å…ƒç´ å”¯ä¸€æ€§ + æ— åºæ€§ + é›†åˆè¿ç®— + é«˜æ€§èƒ½æŸ¥æ‰¾ + å»é‡èƒ½åŠ›**
- ğŸ” **å…ƒç´ å”¯ä¸€æ€§**ï¼šé›†åˆä¸­æ¯ä¸ªå…ƒç´ åªèƒ½å‡ºç°ä¸€æ¬¡ï¼Œè‡ªåŠ¨æ‹’ç»é‡å¤å…ƒç´ 
- ğŸ”€ **æ— åºæ€§**ï¼šå¤§å¤šæ•°å®ç°ä¸ä¿è¯å…ƒç´ çš„å­˜å‚¨é¡ºåºï¼ˆLinkedHashSetä¾‹å¤–ï¼‰
- ğŸ”¢ **é›†åˆè¿ç®—**ï¼šæ”¯æŒå¹¶é›†(âˆª)ã€äº¤é›†(âˆ©)ã€å·®é›†(-)ç­‰æ•°å­¦é›†åˆæ“ä½œ
- âš¡ **é«˜æ€§èƒ½æŸ¥æ‰¾**ï¼šå¤šæ•°å®ç°æä¾›O(1)æŸ¥æ‰¾æ€§èƒ½ï¼Œé€‚åˆé¢‘ç¹æ£€ç´¢
- ğŸ§¹ **å¤©ç„¶å»é‡**ï¼šæ·»åŠ é‡å¤å…ƒç´ æ—¶è‡ªåŠ¨å»é‡ï¼Œä¸æŠ›å¼‚å¸¸è€Œæ˜¯è¿”å›false
:::

## 1. Setæ¥å£åŸºç¡€æ¦‚å¿µ

### 1.1 ä»€ä¹ˆæ˜¯Setæ¥å£ï¼Ÿ

Setæ¥å£æ˜¯Javaé›†åˆæ¡†æ¶ä¸­çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒç»§æ‰¿è‡ªCollectionæ¥å£ï¼Œä¸ºä¸é‡å¤å…ƒç´ çš„é›†åˆæä¾›äº†å®Œæ•´çš„æŠ½è±¡ã€‚

```mermaid
classDiagram
    Iterable <|-- Collection
    Collection <|-- Set
    Set <|.. HashSet
    Set <|.. LinkedHashSet
    Set <|.. TreeSet
    Set <|.. EnumSet
    Set <|-- SortedSet
    SortedSet <|-- NavigableSet
    NavigableSet <|.. TreeSet
    HashSet <|-- LinkedHashSet
    
    class Set {
        +add(E) boolean
        +remove(Object) boolean
        +contains(Object) boolean
        +size() int
        +isEmpty() boolean
        +iterator() Iterator
    }
    
    class HashSet {
        -HashMap~E,Object~ map
        +HashSet()
        +HashSet(Collection)
    }
    
    class LinkedHashSet {
        -LinkedHashMap map
        +LinkedHashSet()
        +LinkedHashSet(Collection)
    }
    
    class TreeSet {
        -TreeMap~E,Object~ map
        +TreeSet()
        +TreeSet(Comparator)
        +TreeSet(Collection)
    }
    
    class EnumSet {
        +of(E) EnumSet
        +allOf(Class) EnumSet
        +noneOf(Class) EnumSet
    }
    
    class NavigableSet {
        +lower(E) E
        +floor(E) E
        +ceiling(E) E
        +higher(E) E
    }
    
    <<interface>> Iterable
    <<interface>> Collection
    <<interface>> Set
    <<interface>> SortedSet
    <<interface>> NavigableSet
```

Seté›†åˆå…·æœ‰ä»¥ä¸‹æ ¸å¿ƒç‰¹å¾ï¼š

- **å…ƒç´ å”¯ä¸€æ€§**ï¼šä¸å…è®¸å­˜å‚¨é‡å¤çš„å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ åœ¨é›†åˆä¸­åªèƒ½å‡ºç°ä¸€æ¬¡
- **æ— åºæ€§**ï¼šå¤§å¤šæ•°å®ç°ç±»ä¸ä¿è¯å…ƒç´ çš„å­˜å‚¨é¡ºåº
- **ç»§æ‰¿Collection**ï¼šå…·æœ‰Collectionæ¥å£çš„æ‰€æœ‰åŸºæœ¬æ–¹æ³•
- **æ— ç´¢å¼•è®¿é—®**ï¼šä¸æ”¯æŒé€šè¿‡ç´¢å¼•ç›´æ¥è®¿é—®å…ƒç´ 
- **é›†åˆè¿ç®—**ï¼šæ”¯æŒå¹¶é›†ã€äº¤é›†ã€å·®é›†ç­‰é›†åˆè¿ç®—

### 1.2 Setæ¥å£çš„é‡è¦æ€§

| é‡è¦æ€§ | å…·ä½“ä½“ç° | ä¸šåŠ¡ä»·å€¼ |
|--------|----------|----------|
| **æ•°æ®å»é‡** | è‡ªåŠ¨å»é™¤é‡å¤å…ƒç´  | ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å’Œå‡†ç¡®æ€§ |
| **å¿«é€ŸæŸ¥æ‰¾** | åŸºäºå“ˆå¸Œçš„O(1)æŸ¥æ‰¾ | æé«˜æ•°æ®æ£€ç´¢æ•ˆç‡ |
| **é›†åˆè¿ç®—** | æ”¯æŒå¤æ‚çš„é›†åˆæ“ä½œ | ç®€åŒ–æ•°æ®å¤„ç†é€»è¾‘ |
| **ç¼“å­˜å®ç°** | å¤©ç„¶é€‚åˆç¼“å­˜æ•°æ®ç»“æ„ | æ”¯æŒé«˜æ•ˆçš„ç¼“å­˜ç®¡ç† |

### 1.3 Setæ¥å£è®¾è®¡åŸåˆ™

Setæ¥å£çš„è®¾è®¡éµå¾ªä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒåŸåˆ™ï¼š

#### å”¯ä¸€æ€§åŸåˆ™
ä¿è¯é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„å”¯ä¸€æ€§ï¼Œé¿å…é‡å¤æ•°æ®

#### æ— åºæ€§åŸåˆ™  
å¤§å¤šæ•°å®ç°ç±»ä¸ä¿è¯å…ƒç´ çš„å­˜å‚¨é¡ºåºï¼Œæé«˜æ€§èƒ½

#### é›†åˆè¿ç®—åŸåˆ™
æ”¯æŒå®Œæ•´çš„é›†åˆè¿ç®—ï¼Œæ»¡è¶³æ•°å­¦é›†åˆè®ºçš„éœ€æ±‚

#### é«˜æ€§èƒ½åŸåˆ™
æä¾›é«˜æ•ˆçš„æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤æ“ä½œ

```java title="Setæ¥å£æ ¸å¿ƒæ–¹æ³•ç¤ºä¾‹"
public interface Set<E> extends Collection<E> {
    
    // ========== åŸºæœ¬æ“ä½œ ==========
    boolean add(E e);                          // æ·»åŠ å…ƒç´ ï¼Œé‡å¤æ—¶è¿”å›false
    boolean remove(Object o);                  // åˆ é™¤æŒ‡å®šå…ƒç´ 
    boolean contains(Object o);                // æ£€æŸ¥æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ 
    
    // ========== é›†åˆè¿ç®— ==========
    boolean addAll(Collection<? extends E> c); // æ·»åŠ é›†åˆï¼ˆå¹¶é›†ï¼‰
    boolean removeAll(Collection<?> c);        // åˆ é™¤é›†åˆï¼ˆå·®é›†ï¼‰
    boolean retainAll(Collection<?> c);        // ä¿ç•™é›†åˆï¼ˆäº¤é›†ï¼‰
    void clear();                              // æ¸…ç©ºé›†åˆ
    
    // ========== æŸ¥è¯¢æ“ä½œ ==========
    int size();                                // è·å–å…ƒç´ ä¸ªæ•°
    boolean isEmpty();                         // åˆ¤æ–­æ˜¯å¦ä¸ºç©º
    
    // ========== è¿­ä»£å™¨ ==========
    Iterator<E> iterator();                    // è·å–è¿­ä»£å™¨
}
```

### 1.4 Setæ¥å£æ–¹æ³•åˆ†ç±»è¯¦è§£

Setæ¥å£æä¾›äº†ä¸°å¯Œçš„æ–¹æ³•æ¥æ“ä½œä¸é‡å¤å…ƒç´ çš„é›†åˆï¼Œè¿™äº›æ–¹æ³•å¯ä»¥åˆ†ä¸ºå‡ ä¸ªä¸»è¦ç±»åˆ«ï¼š

```mermaid
graph TD
    A["Setæ ¸å¿ƒæ–¹æ³•"] --> B["åŸºæœ¬æ“ä½œ"]
    A --> C["é›†åˆè¿ç®—"]
    A --> D["è¿­ä»£æ“ä½œ"]
    A --> E["è½¬æ¢æ“ä½œ"]
    
    B --> B1["add"]
    B --> B2["remove"]
    B --> B3["contains"]
    
    C --> C1["addAll"]
    C --> C2["removeAll"]
    C --> C3["retainAll"]
    
    D --> D1["iterator"]
    D --> D2["forEach"]
    
    E --> E1["toArray"]
    E --> E2["Streamæ“ä½œ"]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B,C,D,E fill:#bbf,stroke:#333,stroke-width:1px
```

<Tabs>
<TabItem value="basic" label="åŸºæœ¬æ“ä½œæ–¹æ³•">

```java title="SetåŸºæœ¬æ“ä½œæ–¹æ³•"
public interface Set<E> extends Collection<E> {
    
    // æ·»åŠ å’Œåˆ é™¤å…ƒç´ 
    boolean add(E e);                          // æ·»åŠ å…ƒç´ ï¼Œé‡å¤æ—¶è¿”å›false
    boolean remove(Object o);                  // åˆ é™¤æŒ‡å®šå…ƒç´ 
    boolean contains(Object o);                // æ£€æŸ¥æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ 
    
    // é›†åˆä¿¡æ¯
    int size();                                // è·å–é›†åˆå¤§å°
    boolean isEmpty();                         // åˆ¤æ–­æ˜¯å¦ä¸ºç©º
    void clear();                              // æ¸…ç©ºé›†åˆ
}
```

| æ–¹æ³• | æè¿° | è¿”å›å€¼ | ç‰¹æ®Šè¡Œä¸º |
|------|------|--------|----------|
| `add(E e)` | æ·»åŠ å…ƒç´ åˆ°é›†åˆ | æˆåŠŸæ·»åŠ è¿”å›trueï¼Œå…ƒç´ å·²å­˜åœ¨è¿”å›false | æ·»åŠ é‡å¤å…ƒç´ ä¸ä¼šæŠ›å¼‚å¸¸ |
| `remove(Object o)` | ä»é›†åˆç§»é™¤å…ƒç´  | å­˜åœ¨å¹¶ç§»é™¤è¿”å›trueï¼Œä¸å­˜åœ¨è¿”å›false | æ€§èƒ½å› å®ç°ç±»è€Œå¼‚ |
| `contains(Object o)` | æ£€æŸ¥å…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­ | å­˜åœ¨è¿”å›trueï¼Œä¸å­˜åœ¨è¿”å›false | HashSetä¸ºO(1)ï¼ŒTreeSetä¸ºO(log n) |

</TabItem>
<TabItem value="collection-ops" label="é›†åˆè¿ç®—æ–¹æ³•">
```java title="Seté›†åˆè¿ç®—æ–¹æ³•"
public interface Set<E> extends Collection<E> {
    
    // å¹¶é›†æ“ä½œ
    boolean addAll(Collection<? extends E> c); // æ·»åŠ å¦ä¸€ä¸ªé›†åˆçš„æ‰€æœ‰å…ƒç´ 
    
    // å·®é›†æ“ä½œ
    boolean removeAll(Collection<?> c);        // åˆ é™¤å¦ä¸€ä¸ªé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ 
    
    // äº¤é›†æ“ä½œ
    boolean retainAll(Collection<?> c);        // åªä¿ç•™å¦ä¸€ä¸ªé›†åˆä¸­å­˜åœ¨çš„å…ƒç´ 
}
```

| æ–¹æ³• | æè¿° | æ•°å­¦è¡¨ç¤º | åº”ç”¨åœºæ™¯ |
|------|------|----------|----------|
| `addAll(Collection<? extends E> c)` | æ·»åŠ å¦ä¸€ä¸ªé›†åˆçš„æ‰€æœ‰å…ƒç´ ï¼ˆå¹¶é›†ï¼‰ | A âˆª B | åˆå¹¶ä¸¤ä¸ªåˆ†ç±»é›†åˆ |
| `retainAll(Collection<?> c)` | åªä¿ç•™ä¹Ÿåœ¨æŒ‡å®šé›†åˆä¸­çš„å…ƒç´ ï¼ˆäº¤é›†ï¼‰ | A âˆ© B | æŸ¥æ‰¾å…±åŒå…ƒç´  |
| `removeAll(Collection<?> c)` | ç§»é™¤æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼ˆå·®é›†ï¼‰ | A - B | ä»ä¸€ä¸ªé›†åˆä¸­å‰”é™¤ç‰¹å®šå…ƒç´  |

```java title="é›†åˆè¿ç®—ç¤ºä¾‹"
public void setOperationsExample() {
    Set<String> set1 = new HashSet<>(Arrays.asList("A", "B", "C"));
    Set<String> set2 = new HashSet<>(Arrays.asList("B", "C", "D"));
    
    // å¹¶é›†ï¼šset1 â† set1 âˆª set2 = {A, B, C, D}
    set1.addAll(set2);
    
    // äº¤é›†ï¼šset1 â† set1 âˆ© set2 = {B, C}
    set1.retainAll(set2);
    
    // å·®é›†ï¼šset1 â† set1 - set2 = {A}
    set1.removeAll(set2);
}
```

</TabItem>
<TabItem value="iterator" label="è¿­ä»£å™¨æ–¹æ³•">
```java title="Setè¿­ä»£å™¨æ–¹æ³•"
public interface Set<E> extends Collection<E> {
    
    // è·å–è¿­ä»£å™¨
    Iterator<E> iterator();                    // è·å–é›†åˆçš„è¿­ä»£å™¨
    
    // ç»§æ‰¿è‡ªCollectionçš„å…¶ä»–è¿­ä»£æ–¹æ³•
    // forEach(Consumer<? super E> action)     // Java 8+ çš„forEachæ–¹æ³•
    // spliterator()                           // Java 8+ çš„å¹¶è¡Œè¿­ä»£å™¨
}
```

| æ–¹æ³• | æè¿° | è¿”å›å€¼ | ç‰¹æ€§ |
|------|------|--------|------|
| `iterator()` | è·å–è¿­ä»£å™¨ | Iteratorå¯¹è±¡ | å…è®¸éå†å¹¶å¯é€‰æ‹©æ€§åˆ é™¤å…ƒç´  |
| `forEach(Consumer)` | å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ“ä½œ | void | ç®€åŒ–è¿­ä»£ä»£ç ï¼ŒJava 8+ |

:::info è¿­ä»£ä¸éå†
éå†Seté›†åˆçš„4ç§æ–¹å¼ï¼š
1. **for-eachå¾ªç¯**ï¼š`for (E element : set) { ... }`
2. **Iterator**ï¼š`Iterator<E> it = set.iterator(); while(it.hasNext()) { ... }`
3. **Lambda forEach**ï¼š`set.forEach(e -> System.out.println(e));`
4. **Stream API**ï¼š`set.stream().forEach(e -> System.out.println(e));`
:::

```java title="Setè¿­ä»£ç¤ºä¾‹"
public void iterationExample() {
    Set<String> set = new HashSet<>(Arrays.asList("A", "B", "C"));
    
    // æ–¹å¼1ï¼šfor-eachå¾ªç¯
    for (String element : set) {
        System.out.println(element);
    }
    
    // æ–¹å¼2ï¼šIterator (æ”¯æŒåˆ é™¤)
    Iterator<String> it = set.iterator();
    while (it.hasNext()) {
        String element = it.next();
        if (element.equals("B")) {
            it.remove();  // å®‰å…¨åˆ é™¤å…ƒç´ 
        }
    }
    
    // æ–¹å¼3ï¼šLambda forEach (Java 8+)
    set.forEach(element -> System.out.println(element));
}
```

</TabItem>
</Tabs>

### 1.5 Setæ¥å£æ–¹æ³•å¯¹æ¯”åˆ†æ

| æ“ä½œç±»å‹ | æ–¹æ³•å | è¿”å›å€¼ | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|----------|--------|--------|------|----------|
| **æ·»åŠ æ“ä½œ** | add(E) | boolean | æ·»åŠ å…ƒç´ ï¼Œé‡å¤æ—¶è¿”å›false | åŸºæœ¬å…ƒç´ æ·»åŠ  |
| **åˆ é™¤æ“ä½œ** | remove(Object) | boolean | åˆ é™¤å…ƒç´ ï¼Œä¸å­˜åœ¨æ—¶è¿”å›false | åŸºæœ¬å…ƒç´ åˆ é™¤ |
| **æŸ¥æ‰¾æ“ä½œ** | contains(Object) | boolean | æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ | å…ƒç´ å­˜åœ¨æ€§æ£€æŸ¥ |
| **é›†åˆè¿ç®—** | addAll(Collection) | boolean | å¹¶é›†æ“ä½œ | åˆå¹¶ä¸¤ä¸ªé›†åˆ |
| **é›†åˆè¿ç®—** | removeAll(Collection) | boolean | å·®é›†æ“ä½œ | ä»é›†åˆä¸­ç§»é™¤å…ƒç´  |
| **é›†åˆè¿ç®—** | retainAll(Collection) | boolean | äº¤é›†æ“ä½œ | ä¿ç•™å…±åŒå…ƒç´  |

:::tip æ–¹æ³•ä½¿ç”¨å»ºè®®
- **æ·»åŠ å…ƒç´ **ï¼šä½¿ç”¨add()æ–¹æ³•ï¼Œæ³¨æ„å¤„ç†é‡å¤å…ƒç´ çš„æƒ…å†µ
- **åˆ é™¤å…ƒç´ **ï¼šä½¿ç”¨remove()æ–¹æ³•ï¼Œæ³¨æ„å¤„ç†å…ƒç´ ä¸å­˜åœ¨çš„æƒ…å†µ
- **é›†åˆè¿ç®—**ï¼šä½¿ç”¨addAll()ã€removeAll()ã€retainAll()è¿›è¡Œå¤æ‚æ“ä½œ
- **æ€§èƒ½è€ƒè™‘**ï¼šcontains()æ“ä½œåœ¨HashSetä¸­ä¸ºO(1)ï¼Œåœ¨TreeSetä¸­ä¸ºO(log n)
:::

## 2. Set å®ç°ç±»è¯¦è§£

```mermaid
graph TD
    subgraph æ€§èƒ½æ¯”è¾ƒ
        A["Setå®ç°ç±»"] --> B["HashSet (æŸ¥æ‰¾å¿«)"]
        A --> C["LinkedHashSet (ä¿æŒé¡ºåº)"]
        A --> D["TreeSet (æœ‰åº)"]
        A --> E["EnumSet (æšä¸¾é›†åˆ)"]
    end
    
    subgraph æ—¶é—´å¤æ‚åº¦
        B --> B1["æŸ¥æ‰¾/æ·»åŠ /åˆ é™¤: O(1)"]
        B --> B2["æ— åº"]
        
        C --> C1["æŸ¥æ‰¾/æ·»åŠ /åˆ é™¤: O(1)"]
        C --> C2["ä¿æŒæ’å…¥é¡ºåº"]
        
        D --> D1["æŸ¥æ‰¾/æ·»åŠ /åˆ é™¤: O(log n)"]
        D --> D2["è‡ªç„¶æ’åºæˆ–æ¯”è¾ƒå™¨æ’åº"]
        
        E --> E1["æŸ¥æ‰¾/æ·»åŠ /åˆ é™¤: O(1)"]
        E --> E2["åªèƒ½å­˜å‚¨åŒä¸€æšä¸¾ç±»å‹"]
    end
    
    classDef default fill:#f9f9f9,stroke:#333,stroke-width:1px;
    classDef fast fill:#d1f0d1,stroke:#333,stroke-width:1px;
    classDef slow fill:#f0d1d1,stroke:#333,stroke-width:1px;
    
    class B1,C1,E1 fast;
    class D1 slow;
```

<Tabs>
<TabItem value="hashset" label="HashSet">

### 2.1 HashSet æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
HashSetæ˜¯Setæ¥å£æœ€å¸¸ç”¨çš„å®ç°ç±»ï¼ŒåŸºäºHashMapå®ç°ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- ğŸ” **åŸºäºHashMap**ï¼šåº•å±‚ä½¿ç”¨HashMapå­˜å‚¨å…ƒç´ 
- ğŸ”€ **æ— åºæ€§**ï¼šä¸ä¿è¯å…ƒç´ çš„å­˜å‚¨é¡ºåº
- âš¡ **é«˜æ€§èƒ½**ï¼šæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤æ“ä½œå¹³å‡æ—¶é—´å¤æ‚åº¦O(1)
- âšª **å…è®¸null**ï¼šæ”¯æŒnullå…ƒç´ 
- âš ï¸ **çº¿ç¨‹ä¸å®‰å…¨**ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦å¤–éƒ¨åŒæ­¥
:::

#### é€‚ç”¨åœºæ™¯
- éœ€è¦å¿«é€ŸæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤çš„åœºæ™¯
- æ•°æ®å»é‡å¤„ç†
- ç¼“å­˜å®ç°
- é›†åˆè¿ç®—
- å¯¹å…ƒç´ é¡ºåºæ²¡æœ‰è¦æ±‚çš„åœºæ™¯

### 2.2 HashSet å†…éƒ¨ç»“æ„

HashSetåŸºäºHashMapå®ç°ï¼Œé€šè¿‡HashMapçš„é”®æ¥å­˜å‚¨Setçš„å…ƒç´ ï¼Œå€¼ä½¿ç”¨ä¸€ä¸ªå›ºå®šçš„è™šæ‹Ÿå¯¹è±¡ã€‚

#### æ ¸å¿ƒå­—æ®µ

```java title="HashSetæ ¸å¿ƒå­—æ®µ"
public class HashSet<E> extends AbstractSet<E>
    implements Set<E>, Cloneable, java.io.Serializable {
    
    // åº•å±‚ä½¿ç”¨HashMapå­˜å‚¨å…ƒç´ 
    private transient HashMap<E,Object> map;
    
    // è™šæ‹Ÿå€¼ï¼Œç”¨äºHashMapçš„å€¼éƒ¨åˆ†
    private static final Object PRESENT = new Object();
}
```

#### æ„é€ æ–¹æ³•

```java title="HashSetæ„é€ æ–¹æ³•"
public class HashSet<E> extends AbstractSet<E> {
    
    /**
     * æ„é€ ä¸€ä¸ªé»˜è®¤åˆå§‹å®¹é‡çš„ç©ºHashSet
     */
    public HashSet() {
        map = new HashMap<>();
    }
    
    /**
     * æ„é€ ä¸€ä¸ªæŒ‡å®šåˆå§‹å®¹é‡çš„ç©ºHashSet
     */
    public HashSet(int initialCapacity) {
        map = new HashMap<>(initialCapacity);
    }
    
    /**
     * æ„é€ ä¸€ä¸ªæŒ‡å®šåˆå§‹å®¹é‡å’Œè´Ÿè½½å› å­çš„ç©ºHashSet
     */
    public HashSet(int initialCapacity, float loadFactor) {
        map = new HashMap<>(initialCapacity, loadFactor);
    }
    
    /**
     * æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆå…ƒç´ çš„HashSet
     */
    public HashSet(Collection<? extends E> c) {
        map = new HashMap<>(Math.max((int) (c.size()/.75f) + 1, 16));
        addAll(c);
    }
}
```

#### å†…å­˜å¸ƒå±€ç¤ºæ„å›¾

```
HashSet å®ä¾‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ map: HashMap<E,Object>                  â”‚
â”‚ â”œâ”€â”€ "Java" â†’ PRESENT                    â”‚
â”‚ â”œâ”€â”€ "Python" â†’ PRESENT                  â”‚
â”‚ â”œâ”€â”€ "C++" â†’ PRESENT                     â”‚
â”‚ â””â”€â”€ null â†’ PRESENT                      â”‚
â”‚                                         â”‚
â”‚ PRESENT: Object (è™šæ‹Ÿå€¼)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 HashSet æ ¸å¿ƒæ–¹æ³•å®ç°

#### 2.3.1 æ·»åŠ å…ƒç´ 

```java title="HashSetæ·»åŠ å…ƒç´ å®ç°"
public class HashSet<E> extends AbstractSet<E> {
    
    /**
     * æ·»åŠ å…ƒç´ åˆ°HashSet
     * æ—¶é—´å¤æ‚åº¦ï¼šå¹³å‡O(1)ï¼Œæœ€åæƒ…å†µO(n)
     */
    public boolean add(E e) {
        // ä½¿ç”¨HashMapçš„putæ–¹æ³•ï¼Œå¦‚æœé”®ä¸å­˜åœ¨åˆ™è¿”å›null
        return map.put(e, PRESENT) == null;
    }
    
    /**
     * æ‰¹é‡æ·»åŠ å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œnä¸ºè¦æ·»åŠ çš„å…ƒç´ ä¸ªæ•°
     */
    public boolean addAll(Collection<? extends E> c) {
        boolean modified = false;
        for (E e : c) {
            if (add(e)) {
                modified = true;
            }
        }
        return modified;
    }
}
```

#### 2.3.2 åˆ é™¤å…ƒç´ 

```java title="HashSetåˆ é™¤å…ƒç´ å®ç°"
public class HashSet<E> extends AbstractSet<E> {
    
    /**
     * ä»HashSetä¸­åˆ é™¤æŒ‡å®šå…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šå¹³å‡O(1)ï¼Œæœ€åæƒ…å†µO(n)
     */
    public boolean remove(Object o) {
        // ä½¿ç”¨HashMapçš„removeæ–¹æ³•ï¼Œå¦‚æœé”®å­˜åœ¨åˆ™è¿”å›å¯¹åº”çš„å€¼
        return map.remove(o) == PRESENT;
    }
    
    /**
     * æ‰¹é‡åˆ é™¤å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œnä¸ºè¦åˆ é™¤çš„å…ƒç´ ä¸ªæ•°
     */
    public boolean removeAll(Collection<?> c) {
        boolean modified = false;
        for (Object o : c) {
            if (remove(o)) {
                modified = true;
            }
        }
        return modified;
    }
}
```

#### 2.3.3 æŸ¥æ‰¾å…ƒç´ 

```java title="HashSetæŸ¥æ‰¾å…ƒç´ å®ç°"
public class HashSet<E> extends AbstractSet<E> {
    
    /**
     * æ£€æŸ¥HashSetæ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šå¹³å‡O(1)ï¼Œæœ€åæƒ…å†µO(n)
     */
    public boolean contains(Object o) {
        // ä½¿ç”¨HashMapçš„containsKeyæ–¹æ³•
        return map.containsKey(o);
    }
    
    /**
     * æ£€æŸ¥HashSetæ˜¯å¦åŒ…å«æŒ‡å®šé›†åˆçš„æ‰€æœ‰å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œnä¸ºæŒ‡å®šé›†åˆçš„å¤§å°
     */
    public boolean containsAll(Collection<?> c) {
        for (Object o : c) {
            if (!contains(o)) {
                return false;
            }
        }
        return true;
    }
}
```

#### 2.3.4 é›†åˆè¿ç®—

```java title="HashSeté›†åˆè¿ç®—å®ç°"
public class HashSet<E> extends AbstractSet<E> {
    
    /**
     * ä¿ç•™äº¤é›†ï¼šåªä¿ç•™åœ¨æŒ‡å®šé›†åˆä¸­ä¹Ÿå­˜åœ¨çš„å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œnä¸ºæŒ‡å®šé›†åˆçš„å¤§å°
     */
    public boolean retainAll(Collection<?> c) {
        boolean modified = false;
        Iterator<E> it = iterator();
        while (it.hasNext()) {
            if (!c.contains(it.next())) {
                it.remove();
                modified = true;
            }
        }
        return modified;
    }
    
    /**
     * æ¸…ç©ºHashSet
     * æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œnä¸ºé›†åˆå¤§å°
     */
    public void clear() {
        map.clear();
    }
}
```

### 2.4 HashSet æ€§èƒ½åˆ†æ

#### 2.4.1 æ—¶é—´å¤æ‚åº¦å¯¹æ¯”

| æ“ä½œ | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜ |
|------|------------|------|
| **æ·»åŠ å…ƒç´ ** | å¹³å‡O(1) | åŸºäºå“ˆå¸Œå€¼ç›´æ¥å®šä½ |
| **åˆ é™¤å…ƒç´ ** | å¹³å‡O(1) | åŸºäºå“ˆå¸Œå€¼ç›´æ¥å®šä½ |
| **æŸ¥æ‰¾å…ƒç´ ** | å¹³å‡O(1) | åŸºäºå“ˆå¸Œå€¼ç›´æ¥å®šä½ |
| **éå†å…ƒç´ ** | O(n) | éœ€è¦éå†æ‰€æœ‰å…ƒç´  |
| **é›†åˆè¿ç®—** | O(n) | éœ€è¦éå†é›†åˆå…ƒç´  |

#### 2.4.2 ç©ºé—´å¤æ‚åº¦

- **å­˜å‚¨å¼€é”€**ï¼šæ¯ä¸ªå…ƒç´ å ç”¨ä¸€ä¸ªHashMapèŠ‚ç‚¹
- **å“ˆå¸Œè¡¨å¼€é”€**ï¼šéœ€è¦é¢å¤–çš„å“ˆå¸Œè¡¨æ•°ç»„ç©ºé—´
- **è´Ÿè½½å› å­**ï¼šå½±å“ç©ºé—´ä½¿ç”¨æ•ˆç‡ï¼Œé»˜è®¤0.75

#### 2.4.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®

```java title="HashSetæ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹"
public class HashSetOptimization {
    
    /**
     * é¢„åˆ†é…å®¹é‡ä¼˜åŒ–
     */
    public static void capacityOptimization() {
        // çŸ¥é“å¤§æ¦‚å…ƒç´ æ•°é‡æ—¶ï¼Œé¢„åˆ†é…å®¹é‡
        int expectedSize = 1000;
        Set<String> optimizedSet = new HashSet<>(expectedSize);
        
        // é¿å…é¢‘ç¹æ‰©å®¹
        for (int i = 0; i < expectedSize; i++) {
            optimizedSet.add("item" + i);
        }
    }
    
    /**
     * æ‰¹é‡æ“ä½œä¼˜åŒ–
     */
    public static void batchOperationOptimization() {
        Set<String> set1 = new HashSet<>();
        Set<String> set2 = new HashSet<>();
        
        // æ‰¹é‡æ·»åŠ ï¼Œæ¯”å¾ªç¯addæ•ˆç‡é«˜
        set1.addAll(set2);
        
        // æ‰¹é‡åˆ é™¤
        set1.removeAll(set2);
        
        // ä¿ç•™äº¤é›†
        set1.retainAll(set2);
    }
    
    /**
     * å…ƒç´ ç±»å‹ä¼˜åŒ–
     */
    public static void elementTypeOptimization() {
        // æ¨èï¼šä½¿ç”¨ä¸å¯å˜å¯¹è±¡
        Set<String> goodSet = new HashSet<>();
        
        // ä¸æ¨èï¼šä½¿ç”¨å¯å˜å¯¹è±¡
        Set<StringBuilder> badSet = new HashSet<>();
    }
}
```

### 2.5 HashSet ä½¿ç”¨ç¤ºä¾‹

#### 2.5.1 åŸºæœ¬æ“ä½œç¤ºä¾‹

```java title="HashSetåŸºæœ¬æ“ä½œç¤ºä¾‹"
public class HashSetBasicExample {
    
    public static void main(String[] args) {
        // åˆ›å»ºHashSet
        Set<String> set = new HashSet<>();
        
        // æ·»åŠ å…ƒç´ 
        set.add("Java");
        set.add("Python");
        set.add("C++");
        set.add("JavaScript");
        
        // å°è¯•æ·»åŠ é‡å¤å…ƒç´ 
        boolean added = set.add("Java");
        System.out.println("æ·»åŠ é‡å¤å…ƒç´ Java: " + added); // false
        
        System.out.println("Setå¤§å°: " + set.size()); // 4
        
        // æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨
        boolean contains = set.contains("Python");
        System.out.println("æ˜¯å¦åŒ…å«Python: " + contains); // true
        
        // åˆ é™¤å…ƒç´ 
        boolean removed = set.remove("C++");
        System.out.println("åˆ é™¤C++: " + removed); // true
        
        // éå†å…ƒç´ 
        System.out.println("Setä¸­çš„å…ƒç´ :");
        for (String item : set) {
            System.out.println(item);
        }
        
        // æ¸…ç©ºé›†åˆ
        set.clear();
        System.out.println("æ¸…ç©ºåå¤§å°: " + set.size()); // 0
    }
}
```

#### 2.5.2 é›†åˆè¿ç®—ç¤ºä¾‹

```java title="HashSeté›†åˆè¿ç®—ç¤ºä¾‹"
public class HashSetSetOperationsExample {
    
    public static void main(String[] args) {
        // åˆ›å»ºä¸¤ä¸ªSet
        Set<String> set1 = new HashSet<>();
        set1.add("Java");
        set1.add("Python");
        set1.add("C++");
        set1.add("JavaScript");
        
        Set<String> set2 = new HashSet<>();
        set2.add("Python");
        set2.add("C++");
        set2.add("Go");
        set2.add("Rust");
        
        System.out.println("Set1: " + set1);
        System.out.println("Set2: " + set2);
        
        // å¹¶é›†æ“ä½œ
        Set<String> union = new HashSet<>(set1);
        union.addAll(set2);
        System.out.println("å¹¶é›†: " + union);
        
        // äº¤é›†æ“ä½œ
        Set<String> intersection = new HashSet<>(set1);
        intersection.retainAll(set2);
        System.out.println("äº¤é›†: " + intersection);
        
        // å·®é›†æ“ä½œ
        Set<String> difference = new HashSet<>(set1);
        difference.removeAll(set2);
        System.out.println("å·®é›†(Set1 - Set2): " + difference);
        
        // å¯¹ç§°å·®é›†
        Set<String> symmetricDifference = new HashSet<>(union);
        symmetricDifference.removeAll(intersection);
        System.out.println("å¯¹ç§°å·®é›†: " + symmetricDifference);
    }
}
```

#### 2.5.3 å»é‡ç¤ºä¾‹

```java title="HashSetå»é‡ç¤ºä¾‹"
public class HashSetDeduplicationExample {
    
    public static void main(String[] args) {
        // æ•°ç»„å»é‡
        String[] array = {"Java", "Python", "Java", "C++", "Python", "JavaScript"};
        Set<String> uniqueSet = new HashSet<>(Arrays.asList(array));
        String[] uniqueArray = uniqueSet.toArray(new String[0]);
        
        System.out.println("åŸå§‹æ•°ç»„: " + Arrays.toString(array));
        System.out.println("å»é‡å: " + Arrays.toString(uniqueArray));
        
        // åˆ—è¡¨å»é‡
        List<Integer> list = Arrays.asList(1, 2, 3, 2, 4, 1, 5, 3, 6);
        Set<Integer> uniqueNumbers = new HashSet<>(list);
        List<Integer> uniqueList = new ArrayList<>(uniqueNumbers);
        
        System.out.println("åŸå§‹åˆ—è¡¨: " + list);
        System.out.println("å»é‡å: " + uniqueList);
        
        // å¯¹è±¡å»é‡
        List<Person> people = Arrays.asList(
            new Person("Alice", 25),
            new Person("Bob", 30),
            new Person("Alice", 25), // é‡å¤
            new Person("Charlie", 35)
        );
        
        Set<Person> uniquePeople = new HashSet<>(people);
        System.out.println("å»é‡åçš„äººæ•°: " + uniquePeople.size());
        uniquePeople.forEach(System.out::println);
    }
    
    // Personç±»
    static class Person {
        private String name;
        private int age;
        
        public Person(String name, int age) {
            this.name = name;
            this.age = age;
        }
        
        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;
            Person person = (Person) o;
            return age == person.age && Objects.equals(name, person.name);
        }
        
        @Override
        public int hashCode() {
            return Objects.hash(name, age);
        }
        
        @Override
        public String toString() {
            return "Person{name='" + name + "', age=" + age + "}";
        }
    }
}
```

</TabItem>
<TabItem value="linkedhashset" label="LinkedHashSet">

### 3.1 LinkedHashSet æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
LinkedHashSetæ˜¯HashSetçš„å­ç±»ï¼Œåœ¨HashSetçš„åŸºç¡€ä¸Šç»´æŠ¤äº†æ’å…¥é¡ºåºï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- ğŸ”„ **ç»§æ‰¿HashSet**ï¼šåŸºäºHashSetå®ç°ï¼Œå…·æœ‰HashSetçš„æ‰€æœ‰ç‰¹æ€§
- ğŸ“ **ç»´æŠ¤é¡ºåº**ï¼šé€šè¿‡åŒå‘é“¾è¡¨ç»´æŠ¤å…ƒç´ çš„æ’å…¥é¡ºåº
- âš–ï¸ **æ€§èƒ½å¹³è¡¡**ï¼šåœ¨HashSeté«˜æ€§èƒ½çš„åŸºç¡€ä¸Šå¢åŠ äº†é¡ºåºç»´æŠ¤
- âšª **å…è®¸null**ï¼šæ”¯æŒnullå…ƒç´ 
- âš ï¸ **çº¿ç¨‹ä¸å®‰å…¨**ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦å¤–éƒ¨åŒæ­¥
:::

#### é€‚ç”¨åœºæ™¯
- éœ€è¦ä¿æŒå…ƒç´ æ’å…¥é¡ºåºçš„åœºæ™¯
- éœ€è¦å»é‡ä¸”ä¿æŒé¡ºåºçš„åœºæ™¯
- LRUç¼“å­˜å®ç°
- éœ€è¦æŒ‰æ’å…¥é¡ºåºéå†çš„åœºæ™¯

### 3.2 LinkedHashSet å†…éƒ¨ç»“æ„

LinkedHashSetç»§æ‰¿è‡ªHashSetï¼Œé€šè¿‡é‡å†™HashSetçš„æ„é€ æ–¹æ³•æ¥å®ç°é¡ºåºç»´æŠ¤ã€‚

#### æ ¸å¿ƒå­—æ®µ

```java title="LinkedHashSetæ ¸å¿ƒå­—æ®µ"
public class LinkedHashSet<E> extends HashSet<E>
    implements Set<E>, Cloneable, java.io.Serializable {
    
    // ç»§æ‰¿è‡ªHashSetçš„å­—æ®µ
    // private transient HashMap<E,Object> map;
    // private static final Object PRESENT = new Object();
    
    // é€šè¿‡è°ƒç”¨HashSetçš„ç‰¹å®šæ„é€ æ–¹æ³•æ¥ç»´æŠ¤é¡ºåº
    // è¿™ä¸ªæ„é€ æ–¹æ³•ä¼šåˆ›å»ºLinkedHashMapè€Œä¸æ˜¯HashMap
}
```

#### æ„é€ æ–¹æ³•

```java title="LinkedHashSetæ„é€ æ–¹æ³•"
public class LinkedHashSet<E> extends HashSet<E> {
    
    /**
     * æ„é€ ä¸€ä¸ªé»˜è®¤åˆå§‹å®¹é‡çš„ç©ºLinkedHashSet
     */
    public LinkedHashSet() {
        super(16, .75f, true);  // è°ƒç”¨HashSetçš„ç‰¹å®šæ„é€ æ–¹æ³•
    }
    
    /**
     * æ„é€ ä¸€ä¸ªæŒ‡å®šåˆå§‹å®¹é‡çš„ç©ºLinkedHashSet
     */
    public LinkedHashSet(int initialCapacity) {
        super(initialCapacity, .75f, true);
    }
    
    /**
     * æ„é€ ä¸€ä¸ªæŒ‡å®šåˆå§‹å®¹é‡å’Œè´Ÿè½½å› å­çš„ç©ºLinkedHashSet
     */
    public LinkedHashSet(int initialCapacity, float loadFactor) {
        super(initialCapacity, loadFactor, true);
    }
    
    /**
     * æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆå…ƒç´ çš„LinkedHashSet
     */
    public LinkedHashSet(Collection<? extends E> c) {
        super(Math.max(2*c.size(), 11), .75f, true);
        addAll(c);
    }
}
```

#### å†…å­˜å¸ƒå±€ç¤ºæ„å›¾

```
LinkedHashSet å®ä¾‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ map: LinkedHashMap<E,Object>            â”‚
â”‚ â”œâ”€â”€ "Java" â†’ PRESENT                    â”‚
â”‚ â”œâ”€â”€ "Python" â†’ PRESENT                  â”‚
â”‚ â”œâ”€â”€ "C++" â†’ PRESENT                     â”‚
â”‚ â””â”€â”€ "JavaScript" â†’ PRESENT              â”‚
â”‚                                         â”‚
â”‚ åŒå‘é“¾è¡¨ç»´æŠ¤æ’å…¥é¡ºåº:                   â”‚
â”‚ Java â†â†’ Python â†â†’ C++ â†â†’ JavaScript    â”‚
â”‚                                         â”‚
â”‚ PRESENT: Object (è™šæ‹Ÿå€¼)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 LinkedHashSet æ ¸å¿ƒç‰¹æ€§

#### 3.3.1 é¡ºåºç»´æŠ¤æœºåˆ¶

```java title="LinkedHashSeté¡ºåºç»´æŠ¤"
public class LinkedHashSet<E> extends HashSet<E> {
    
    /**
     * LinkedHashSeté€šè¿‡è°ƒç”¨HashSetçš„ç‰¹å®šæ„é€ æ–¹æ³•æ¥å®ç°é¡ºåºç»´æŠ¤
     * è¯¥æ„é€ æ–¹æ³•ä¼šåˆ›å»ºLinkedHashMapè€Œä¸æ˜¯HashMap
     */
    
    // HashSetä¸­çš„ç‰¹å®šæ„é€ æ–¹æ³•ï¼ˆåŒ…ç§æœ‰ï¼‰
    HashSet(int initialCapacity, float loadFactor, boolean dummy) {
        map = new LinkedHashMap<>(initialCapacity, loadFactor);
    }
}
```

#### 3.3.2 æ€§èƒ½ç‰¹ç‚¹

| æ“ä½œ | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜ |
|------|------------|------|
| **æ·»åŠ å…ƒç´ ** | å¹³å‡O(1) | åŸºäºå“ˆå¸Œå€¼å®šä½ + é“¾è¡¨ç»´æŠ¤ |
| **åˆ é™¤å…ƒç´ ** | å¹³å‡O(1) | åŸºäºå“ˆå¸Œå€¼å®šä½ + é“¾è¡¨ç»´æŠ¤ |
| **æŸ¥æ‰¾å…ƒç´ ** | å¹³å‡O(1) | åŸºäºå“ˆå¸Œå€¼ç›´æ¥å®šä½ |
| **éå†å…ƒç´ ** | O(n) | æŒ‰æ’å…¥é¡ºåºéå† |
| **é¡ºåºè®¿é—®** | O(1) | é€šè¿‡é“¾è¡¨ç›´æ¥è®¿é—® |

### 3.4 LinkedHashSet ä½¿ç”¨ç¤ºä¾‹

#### 3.4.1 åŸºæœ¬æ“ä½œç¤ºä¾‹

```java title="LinkedHashSetåŸºæœ¬æ“ä½œç¤ºä¾‹"
public class LinkedHashSetBasicExample {
    
    public static void main(String[] args) {
        // åˆ›å»ºLinkedHashSet
        Set<String> linkedHashSet = new LinkedHashSet<>();
        
        // æ·»åŠ å…ƒç´ 
        linkedHashSet.add("Java");
        linkedHashSet.add("Python");
        linkedHashSet.add("C++");
        linkedHashSet.add("JavaScript");
        
        System.out.println("LinkedHashSetæŒ‰æ’å…¥é¡ºåº:");
        for (String item : linkedHashSet) {
            System.out.println(item);
        }
        
        // ä¸HashSetå¯¹æ¯”
        Set<String> hashSet = new HashSet<>();
        hashSet.add("Java");
        hashSet.add("Python");
        hashSet.add("C++");
        hashSet.add("JavaScript");
        
        System.out.println("\nHashSeté¡ºåºï¼ˆå¯èƒ½ä¸åŒï¼‰:");
        for (String item : hashSet) {
            System.out.println(item);
        }
        
        // åˆ é™¤å…ƒç´ åé¡ºåºä¿æŒä¸å˜
        linkedHashSet.remove("Python");
        System.out.println("\nåˆ é™¤Pythonå:");
        for (String item : linkedHashSet) {
            System.out.println(item);
        }
    }
}
```

#### 3.4.2 å»é‡ä¿æŒé¡ºåºç¤ºä¾‹

```java title="LinkedHashSetå»é‡ä¿æŒé¡ºåºç¤ºä¾‹"
public class LinkedHashSetDeduplicationExample {
    
    public static void main(String[] args) {
        // ä½¿ç”¨LinkedHashSetè¿›è¡Œå»é‡å¹¶ä¿æŒé¡ºåº
        List<String> list = Arrays.asList("Java", "Python", "Java", "C++", "Python", "JavaScript");
        
        // ä½¿ç”¨LinkedHashSetå»é‡
        Set<String> uniqueSet = new LinkedHashSet<>(list);
        List<String> uniqueList = new ArrayList<>(uniqueSet);
        
        System.out.println("åŸå§‹åˆ—è¡¨: " + list);
        System.out.println("å»é‡åä¿æŒé¡ºåº: " + uniqueList);
        
        // ä¸HashSetå¯¹æ¯”
        Set<String> hashSet = new HashSet<>(list);
        List<String> hashSetList = new ArrayList<>(hashSet);
        
        System.out.println("HashSetå»é‡ï¼ˆé¡ºåºå¯èƒ½ä¸åŒï¼‰: " + hashSetList);
    }
}
```

#### 3.4.3 LRUç¼“å­˜å®ç°ç¤ºä¾‹

```java title="LinkedHashSetå®ç°LRUç¼“å­˜ç¤ºä¾‹"
public class LinkedHashSetLRUCacheExample {
    
    // ç®€å•çš„LRUç¼“å­˜å®ç°
    static class LRUCache<K, V> {
        private final int capacity;
        private final LinkedHashMap<K, V> cache;
        
        public LRUCache(int capacity) {
            this.capacity = capacity;
            this.cache = new LinkedHashMap<K, V>(capacity, 0.75f, true) {
                @Override
                protected boolean removeEldestEntry(Map.Entry<K, V> eldest) {
                    return size() > capacity;
                }
            };
        }
        
        public V get(K key) {
            return cache.get(key);
        }
        
        public void put(K key, V value) {
            cache.put(key, value);
        }
        
        public void remove(K key) {
            cache.remove(key);
        }
        
        public int size() {
            return cache.size();
        }
        
        public Set<K> keySet() {
            return cache.keySet();
        }
    }
    
    public static void main(String[] args) {
        // åˆ›å»ºLRUç¼“å­˜
        LRUCache<String, String> cache = new LRUCache<>(3);
        
        // æ·»åŠ å…ƒç´ 
        cache.put("key1", "value1");
        cache.put("key2", "value2");
        cache.put("key3", "value3");
        
        System.out.println("ç¼“å­˜é”®é›†åˆ: " + cache.keySet());
        
        // è®¿é—®key1ï¼Œä½¿å…¶æˆä¸ºæœ€è¿‘ä½¿ç”¨çš„
        cache.get("key1");
        
        // æ·»åŠ æ–°å…ƒç´ ï¼Œä¼šæ·˜æ±°æœ€ä¹…æœªä½¿ç”¨çš„
        cache.put("key4", "value4");
        
        System.out.println("æ·»åŠ key4å: " + cache.keySet());
    }
}
```

</TabItem>
<TabItem value="treeset" label="TreeSet">

### 4.1 TreeSet æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
TreeSetæ˜¯åŸºäºTreeMapå®ç°çš„æœ‰åºSetï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- ğŸŒ³ **åŸºäºTreeMap**ï¼šåº•å±‚ä½¿ç”¨TreeMapå­˜å‚¨å…ƒç´ 
- ğŸ“Š **æœ‰åºæ€§**ï¼šå…ƒç´ æŒ‰ç…§è‡ªç„¶é¡ºåºæˆ–è‡ªå®šä¹‰æ¯”è¾ƒå™¨æ’åº
- â›” **ä¸å…è®¸null**ï¼šä¸æ”¯æŒnullå…ƒç´ 
- âš ï¸ **çº¿ç¨‹ä¸å®‰å…¨**ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦å¤–éƒ¨åŒæ­¥
- ğŸ“‰ **æ€§èƒ½ç‰¹ç‚¹**ï¼šæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤æ“ä½œæ—¶é—´å¤æ‚åº¦O(log n)
:::

#### é€‚ç”¨åœºæ™¯
- éœ€è¦å…ƒç´ æœ‰åºçš„åœºæ™¯
- éœ€è¦èŒƒå›´æŸ¥è¯¢çš„åœºæ™¯
- éœ€è¦è·å–æœ€å¤§æœ€å°å…ƒç´ çš„åœºæ™¯
- éœ€è¦æŒ‰é¡ºåºéå†çš„åœºæ™¯

### 4.2 TreeSet å†…éƒ¨ç»“æ„

TreeSetåŸºäºTreeMapå®ç°ï¼Œé€šè¿‡TreeMapçš„é”®æ¥å­˜å‚¨Setçš„å…ƒç´ ï¼Œå€¼ä½¿ç”¨ä¸€ä¸ªå›ºå®šçš„è™šæ‹Ÿå¯¹è±¡ã€‚

#### æ ¸å¿ƒå­—æ®µ

```java title="TreeSetæ ¸å¿ƒå­—æ®µ"
public class TreeSet<E> extends AbstractSet<E>
    implements NavigableSet<E>, Cloneable, java.io.Serializable {
    
    // åº•å±‚ä½¿ç”¨NavigableMapå­˜å‚¨å…ƒç´ 
    private transient NavigableMap<E,Object> m;
    
    // è™šæ‹Ÿå€¼ï¼Œç”¨äºNavigableMapçš„å€¼éƒ¨åˆ†
    private static final Object PRESENT = new Object();
}
```

#### æ„é€ æ–¹æ³•

```java title="TreeSetæ„é€ æ–¹æ³•"
public class TreeSet<E> extends AbstractSet<E> {
    
    /**
     * æ„é€ ä¸€ä¸ªä½¿ç”¨è‡ªç„¶é¡ºåºçš„ç©ºTreeSet
     */
    public TreeSet() {
        this(new TreeMap<E,Object>());
    }
    
    /**
     * æ„é€ ä¸€ä¸ªä½¿ç”¨æŒ‡å®šæ¯”è¾ƒå™¨çš„ç©ºTreeSet
     */
    public TreeSet(Comparator<? super E> comparator) {
        this(new TreeMap<>(comparator));
    }
    
    /**
     * æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆå…ƒç´ çš„TreeSet
     */
    public TreeSet(Collection<? extends E> c) {
        this();
        addAll(c);
    }
    
    /**
     * æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šSortedSetå…ƒç´ çš„TreeSet
     */
    public TreeSet(SortedSet<E> s) {
        this(s.comparator());
        addAll(s);
    }
    
    /**
     * åŒ…ç§æœ‰æ„é€ æ–¹æ³•ï¼Œç”¨äºå†…éƒ¨å®ç°
     */
    TreeSet(NavigableMap<E,Object> m) {
        this.m = m;
    }
}
```

#### å†…å­˜å¸ƒå±€ç¤ºæ„å›¾

```
TreeSet å®ä¾‹ (çº¢é»‘æ ‘)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ m: TreeMap<E,Object>                    â”‚
â”‚                                         â”‚
â”‚ çº¢é»‘æ ‘ç»“æ„:                             â”‚
â”‚        C++                              â”‚
â”‚       /   \                             â”‚
â”‚    Java   Python                        â”‚
â”‚           /                             â”‚
â”‚      JavaScript                         â”‚
â”‚                                         â”‚
â”‚ æ¯ä¸ªèŠ‚ç‚¹: key â†’ PRESENT                 â”‚
â”‚ PRESENT: Object (è™šæ‹Ÿå€¼)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 TreeSet æ ¸å¿ƒæ–¹æ³•å®ç°

#### 4.3.1 æ·»åŠ å…ƒç´ 

```java title="TreeSetæ·»åŠ å…ƒç´ å®ç°"
public class TreeSet<E> extends AbstractSet<E> {
    
    /**
     * æ·»åŠ å…ƒç´ åˆ°TreeSet
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    public boolean add(E e) {
        // ä½¿ç”¨TreeMapçš„putæ–¹æ³•ï¼Œå¦‚æœé”®ä¸å­˜åœ¨åˆ™è¿”å›null
        return m.put(e, PRESENT) == null;
    }
    
    /**
     * æ‰¹é‡æ·»åŠ å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(n log n)ï¼Œnä¸ºè¦æ·»åŠ çš„å…ƒç´ ä¸ªæ•°
     */
    public boolean addAll(Collection<? extends E> c) {
        boolean modified = false;
        for (E e : c) {
            if (add(e)) {
                modified = true;
            }
        }
        return modified;
    }
}
```

#### 4.3.2 åˆ é™¤å…ƒç´ 

```java title="TreeSetåˆ é™¤å…ƒç´ å®ç°"
public class TreeSet<E> extends AbstractSet<E> {
    
    /**
     * ä»TreeSetä¸­åˆ é™¤æŒ‡å®šå…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    public boolean remove(Object o) {
        // ä½¿ç”¨TreeMapçš„removeæ–¹æ³•ï¼Œå¦‚æœé”®å­˜åœ¨åˆ™è¿”å›å¯¹åº”çš„å€¼
        return m.remove(o) == PRESENT;
    }
    
    /**
     * æ¸…ç©ºTreeSet
     * æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œnä¸ºé›†åˆå¤§å°
     */
    public void clear() {
        m.clear();
    }
}
```

#### 4.3.3 æŸ¥æ‰¾å…ƒç´ 

```java title="TreeSetæŸ¥æ‰¾å…ƒç´ å®ç°"
public class TreeSet<E> extends AbstractSet<E> {
    
    /**
     * æ£€æŸ¥TreeSetæ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    public boolean contains(Object o) {
        // ä½¿ç”¨TreeMapçš„containsKeyæ–¹æ³•
        return m.containsKey(o);
    }
    
    /**
     * è·å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆæœ€å°å…ƒç´ ï¼‰
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    public E first() {
        return m.firstKey();
    }
    
    /**
     * è·å–æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆæœ€å¤§å…ƒç´ ï¼‰
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    public E last() {
        return m.lastKey();
    }
}
```

#### 4.3.4 å¯¼èˆªæ–¹æ³•

```java title="TreeSetå¯¼èˆªæ–¹æ³•å®ç°"
public class TreeSet<E> extends AbstractSet<E> {
    
    /**
     * è·å–å°äºæŒ‡å®šå…ƒç´ çš„æœ€å¤§å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    public E lower(E e) {
        return m.lowerKey(e);
    }
    
    /**
     * è·å–å°äºç­‰äºæŒ‡å®šå…ƒç´ çš„æœ€å¤§å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    public E floor(E e) {
        return m.floorKey(e);
    }
    
    /**
     * è·å–å¤§äºç­‰äºæŒ‡å®šå…ƒç´ çš„æœ€å°å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    public E ceiling(E e) {
        return m.ceilingKey(e);
    }
    
    /**
     * è·å–å¤§äºæŒ‡å®šå…ƒç´ çš„æœ€å°å…ƒç´ 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     */
    public E higher(E e) {
        return m.higherKey(e);
    }
}
```

### 4.4 TreeSet æ€§èƒ½åˆ†æ

#### 4.4.1 æ—¶é—´å¤æ‚åº¦å¯¹æ¯”

| æ“ä½œ | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜ |
|------|------------|------|
| **æ·»åŠ å…ƒç´ ** | O(log n) | éœ€è¦ç»´æŠ¤çº¢é»‘æ ‘å¹³è¡¡ |
| **åˆ é™¤å…ƒç´ ** | O(log n) | éœ€è¦ç»´æŠ¤çº¢é»‘æ ‘å¹³è¡¡ |
| **æŸ¥æ‰¾å…ƒç´ ** | O(log n) | åŸºäºçº¢é»‘æ ‘æŸ¥æ‰¾ |
| **è·å–æœ€å¤§æœ€å°** | O(log n) | åŸºäºçº¢é»‘æ ‘æŸ¥æ‰¾ |
| **éå†å…ƒç´ ** | O(n) | ä¸­åºéå†çº¢é»‘æ ‘ |
| **èŒƒå›´æŸ¥è¯¢** | O(log n + k) | kä¸ºç»“æœé›†å¤§å° |

#### 4.4.2 ç©ºé—´å¤æ‚åº¦

- **å­˜å‚¨å¼€é”€**ï¼šæ¯ä¸ªå…ƒç´ å ç”¨ä¸€ä¸ªçº¢é»‘æ ‘èŠ‚ç‚¹
- **æ ‘ç»“æ„å¼€é”€**ï¼šéœ€è¦é¢å¤–çš„æ ‘èŠ‚ç‚¹å¼•ç”¨
- **å¹³è¡¡å¼€é”€**ï¼šç»´æŠ¤çº¢é»‘æ ‘å¹³è¡¡çš„é¢å¤–å¼€é”€

### 4.5 TreeSet ä½¿ç”¨ç¤ºä¾‹

#### 4.5.1 åŸºæœ¬æ“ä½œç¤ºä¾‹

```java title="TreeSetåŸºæœ¬æ“ä½œç¤ºä¾‹"
public class TreeSetBasicExample {
    
    public static void main(String[] args) {
        // è‡ªç„¶é¡ºåºæ’åº
        Set<String> naturalOrderSet = new TreeSet<>();
        naturalOrderSet.add("Java");
        naturalOrderSet.add("Python");
        naturalOrderSet.add("C++");
        naturalOrderSet.add("JavaScript");
        
        System.out.println("è‡ªç„¶é¡ºåº:");
        for (String item : naturalOrderSet) {
            System.out.println(item);
        }
        
        // è‡ªå®šä¹‰æ¯”è¾ƒå™¨ï¼ˆé€†åºï¼‰
        Set<String> customOrderSet = new TreeSet<>((s1, s2) -> s2.compareTo(s1));
        customOrderSet.add("Java");
        customOrderSet.add("Python");
        customOrderSet.add("C++");
        customOrderSet.add("JavaScript");
        
        System.out.println("\nè‡ªå®šä¹‰é¡ºåºï¼ˆé€†åºï¼‰:");
        for (String item : customOrderSet) {
            System.out.println(item);
        }
        
        // æ•°å­—æ’åº
        Set<Integer> numberSet = new TreeSet<>();
        numberSet.add(5);
        numberSet.add(2);
        numberSet.add(8);
        numberSet.add(1);
        numberSet.add(3);
        
        System.out.println("\næ•°å­—æ’åº:");
        for (Integer num : numberSet) {
            System.out.println(num);
        }
    }
}
```

#### 4.5.2 å¯¼èˆªæ–¹æ³•ç¤ºä¾‹

```java title="TreeSetå¯¼èˆªæ–¹æ³•ç¤ºä¾‹"
public class TreeSetNavigationExample {
    
    public static void main(String[] args) {
        // åˆ›å»ºTreeSet
        TreeSet<String> treeSet = new TreeSet<>();
        treeSet.add("Alice");
        treeSet.add("Bob");
        treeSet.add("Charlie");
        treeSet.add("David");
        treeSet.add("Eve");
        treeSet.add("Frank");
        
        System.out.println("TreeSet: " + treeSet);
        
        // è·å–ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå…ƒç´ 
        String first = treeSet.first();
        String last = treeSet.last();
        System.out.println("ç¬¬ä¸€ä¸ªå…ƒç´ : " + first);
        System.out.println("æœ€åä¸€ä¸ªå…ƒç´ : " + last);
        
        // å¯¼èˆªæ–¹æ³•
        String target = "Charlie";
        String lower = treeSet.lower(target);
        String floor = treeSet.floor(target);
        String ceiling = treeSet.ceiling(target);
        String higher = treeSet.higher(target);
        
        System.out.println("\nå¯¼èˆªæ–¹æ³•ç¤ºä¾‹ï¼ˆç›®æ ‡: " + target + "ï¼‰:");
        System.out.println("lower: " + lower);      // å°äºCharlieçš„æœ€å¤§å…ƒç´ 
        System.out.println("floor: " + floor);      // å°äºç­‰äºCharlieçš„æœ€å¤§å…ƒç´ 
        System.out.println("ceiling: " + ceiling);  // å¤§äºç­‰äºCharlieçš„æœ€å°å…ƒç´ 
        System.out.println("higher: " + higher);    // å¤§äºCharlieçš„æœ€å°å…ƒç´ 
        
        // å­é›†æ“ä½œ
        SortedSet<String> subSet = treeSet.subSet("Bob", "Eve");
        System.out.println("\nå­é›† [Bob, Eve): " + subSet);
        
        SortedSet<String> headSet = treeSet.headSet("David");
        System.out.println("å¤´é›† [å¼€å§‹, David): " + headSet);
        
        SortedSet<String> tailSet = treeSet.tailSet("David");
        System.out.println("å°¾é›† [David, ç»“æŸ): " + tailSet);
    }
}
```

#### 4.5.3 è‡ªå®šä¹‰å¯¹è±¡æ’åºç¤ºä¾‹

```java title="TreeSetè‡ªå®šä¹‰å¯¹è±¡æ’åºç¤ºä¾‹"
public class TreeSetCustomObjectExample {
    
    // å­¦ç”Ÿç±»
    static class Student implements Comparable<Student> {
        private String name;
        private int age;
        private double score;
        
        public Student(String name, int age, double score) {
            this.name = name;
            this.age = age;
            this.score = score;
        }
        
        @Override
        public int compareTo(Student other) {
            // é¦–å…ˆæŒ‰åˆ†æ•°æ’åºï¼ˆé™åºï¼‰ï¼Œåˆ†æ•°ç›¸åŒæ—¶æŒ‰å¹´é¾„æ’åºï¼ˆå‡åºï¼‰
            int scoreCompare = Double.compare(other.score, this.score);
            if (scoreCompare != 0) {
                return scoreCompare;
            }
            return Integer.compare(this.age, other.age);
        }
        
        @Override
        public String toString() {
            return "Student{name='" + name + "', age=" + age + ", score=" + score + "}";
        }
    }
    
    public static void main(String[] args) {
        // ä½¿ç”¨è‡ªç„¶é¡ºåºçš„TreeSet
        Set<Student> studentSet = new TreeSet<>();
        studentSet.add(new Student("Alice", 20, 85.5));
        studentSet.add(new Student("Bob", 22, 90.0));
        studentSet.add(new Student("Charlie", 21, 85.5));
        studentSet.add(new Student("David", 23, 88.0));
        
        System.out.println("æŒ‰åˆ†æ•°é™åºã€å¹´é¾„å‡åºæ’åˆ—:");
        for (Student student : studentSet) {
            System.out.println(student);
        }
        
        // ä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå™¨çš„TreeSet
        Set<Student> ageSet = new TreeSet<>((s1, s2) -> Integer.compare(s1.age, s2.age));
        ageSet.addAll(studentSet);
        
        System.out.println("\næŒ‰å¹´é¾„å‡åºæ’åˆ—:");
        for (Student student : ageSet) {
            System.out.println(student);
        }
    }
}
``` 

## 5. å…¶ä»–Setå®ç°ç±»è¯¦è§£

### 5.1 CopyOnWriteArraySet å®ç°ç±»è¯¦è§£

#### 5.1.1 CopyOnWriteArraySet æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
CopyOnWriteArraySetæ˜¯åŸºäºCopyOnWriteArrayListå®ç°çš„çº¿ç¨‹å®‰å…¨Setï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- **åŸºäºCopyOnWriteArrayList**ï¼šåº•å±‚ä½¿ç”¨CopyOnWriteArrayListå­˜å‚¨å…ƒç´ 
- **çº¿ç¨‹å®‰å…¨**ï¼šæ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„
- **å†™æ—¶å¤åˆ¶**ï¼šä¿®æ”¹æ“ä½œä¼šåˆ›å»ºæ–°çš„æ•°ç»„å‰¯æœ¬
- **è¯»å¤šå†™å°‘**ï¼šé€‚åˆè¯»å¤šå†™å°‘çš„åœºæ™¯
- **æ€§èƒ½ç‰¹ç‚¹**ï¼šè¯»æ“ä½œæ€§èƒ½å¥½ï¼Œå†™æ“ä½œæ€§èƒ½è¾ƒå·®
:::

#### 5.1.2 CopyOnWriteArraySet ä½¿ç”¨ç¤ºä¾‹

```java title="CopyOnWriteArraySetä½¿ç”¨ç¤ºä¾‹"
public class CopyOnWriteArraySetExample {
    
    public static void main(String[] args) {
        // åˆ›å»ºçº¿ç¨‹å®‰å…¨çš„Set
        Set<String> set = new CopyOnWriteArraySet<>();
        
        // å¤šçº¿ç¨‹å®‰å…¨æ“ä½œ
        Thread t1 = new Thread(() -> {
            for (int i = 0; i < 1000; i++) {
                set.add("Thread1-" + i);
            }
        });
        
        Thread t2 = new Thread(() -> {
            for (int i = 0; i < 1000; i++) {
                set.add("Thread2-" + i);
            }
        });
        
        t1.start();
        t2.start();
        
        try {
            t1.join();
            t2.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        
        System.out.println("æœ€ç»ˆå¤§å°: " + set.size());
        
        // éå†æ“ä½œï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰
        for (String item : set) {
            // éå†è¿‡ç¨‹ä¸­å¯ä»¥å®‰å…¨åœ°ä¿®æ”¹é›†åˆ
            set.add("new-item");
        }
    }
}
```

</TabItem>
<TabItem value="enumset" label="EnumSet">

#### 5.2.1 EnumSet æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
EnumSetæ˜¯ä¸“é—¨ä¸ºæšä¸¾ç±»å‹è®¾è®¡çš„é«˜æ•ˆSetå®ç°ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- ğŸ”  **ä¸“é—¨ä¸ºæšä¸¾è®¾è®¡**ï¼šåªèƒ½å­˜å‚¨æšä¸¾ç±»å‹çš„å…ƒç´ 
- âš¡ **é«˜æ€§èƒ½**ï¼šåŸºäºä½å‘é‡å®ç°ï¼Œæ€§èƒ½æé«˜
- ğŸ“Š **å†…å­˜æ•ˆç‡**ï¼šä½¿ç”¨ä½è¿ç®—ï¼Œå†…å­˜å ç”¨æå°
- âš ï¸ **çº¿ç¨‹ä¸å®‰å…¨**ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦å¤–éƒ¨åŒæ­¥
- â›” **ä¸å…è®¸null**ï¼šä¸æ”¯æŒnullå…ƒç´ 
:::

</TabItem>
</Tabs>

#### 5.2.2 EnumSet ä½¿ç”¨ç¤ºä¾‹

```java title="EnumSetä½¿ç”¨ç¤ºä¾‹"
public class EnumSetExample {
    
    // é¢œè‰²æšä¸¾
    enum Color {
        RED, GREEN, BLUE, YELLOW, BLACK, WHITE
    }
    
    // æƒé™æšä¸¾
    enum Permission {
        READ, WRITE, EXECUTE, DELETE
    }
    
    public static void main(String[] args) {
        // åˆ›å»ºåŒ…å«æ‰€æœ‰å…ƒç´ çš„EnumSet
        EnumSet<Color> allColors = EnumSet.allOf(Color.class);
        System.out.println("æ‰€æœ‰é¢œè‰²: " + allColors);
        
        // åˆ›å»ºç©ºçš„EnumSet
        EnumSet<Color> emptyColors = EnumSet.noneOf(Color.class);
        emptyColors.add(Color.RED);
        emptyColors.add(Color.GREEN);
        System.out.println("éƒ¨åˆ†é¢œè‰²: " + emptyColors);
        
        // åˆ›å»ºæŒ‡å®šèŒƒå›´çš„EnumSet
        EnumSet<Color> rangeColors = EnumSet.range(Color.RED, Color.BLUE);
        System.out.println("èŒƒå›´é¢œè‰²: " + rangeColors);
        
        // åˆ›å»ºæŒ‡å®šå…ƒç´ çš„EnumSet
        EnumSet<Color> specificColors = EnumSet.of(Color.RED, Color.BLUE, Color.WHITE);
        System.out.println("æŒ‡å®šé¢œè‰²: " + specificColors);
        
        // æƒé™ç®¡ç†ç¤ºä¾‹
        EnumSet<Permission> userPermissions = EnumSet.of(Permission.READ, Permission.WRITE);
        System.out.println("ç”¨æˆ·æƒé™: " + userPermissions);
        
        // æ£€æŸ¥æƒé™
        boolean canRead = userPermissions.contains(Permission.READ);
        boolean canExecute = userPermissions.contains(Permission.EXECUTE);
        System.out.println("å¯ä»¥è¯»å–: " + canRead);
        System.out.println("å¯ä»¥æ‰§è¡Œ: " + canExecute);
        
        // æ·»åŠ æƒé™
        userPermissions.add(Permission.EXECUTE);
        System.out.println("æ·»åŠ æ‰§è¡Œæƒé™å: " + userPermissions);
        
        // ç§»é™¤æƒé™
        userPermissions.remove(Permission.WRITE);
        System.out.println("ç§»é™¤å†™æƒé™å: " + userPermissions);
    }
}
```

### 5.3 ConcurrentSkipListSet å®ç°ç±»è¯¦è§£

#### 5.3.1 ConcurrentSkipListSet æ¦‚è¿°

:::tip æ ¸å¿ƒç‰¹ç‚¹
ConcurrentSkipListSetæ˜¯åŸºäºConcurrentSkipListMapå®ç°çš„çº¿ç¨‹å®‰å…¨æœ‰åºSetï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- **åŸºäºè·³è¡¨**ï¼šåº•å±‚ä½¿ç”¨è·³è¡¨æ•°æ®ç»“æ„
- **çº¿ç¨‹å®‰å…¨**ï¼šæ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„
- **æœ‰åºæ€§**ï¼šå…ƒç´ æŒ‰ç…§è‡ªç„¶é¡ºåºæˆ–è‡ªå®šä¹‰æ¯”è¾ƒå™¨æ’åº
- **é«˜æ€§èƒ½**ï¼šæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤æ“ä½œæ—¶é—´å¤æ‚åº¦O(log n)
- **ä¸å…è®¸null**ï¼šä¸æ”¯æŒnullå…ƒç´ 
:::

#### 5.3.2 ConcurrentSkipListSet ä½¿ç”¨ç¤ºä¾‹

```java title="ConcurrentSkipListSetä½¿ç”¨ç¤ºä¾‹"
public class ConcurrentSkipListSetExample {
    
    public static void main(String[] args) {
        // åˆ›å»ºçº¿ç¨‹å®‰å…¨çš„æœ‰åºSet
        Set<String> set = new ConcurrentSkipListSet<>();
        
        // å¤šçº¿ç¨‹å¹¶å‘æ·»åŠ å…ƒç´ 
        Thread t1 = new Thread(() -> {
            for (int i = 0; i < 100; i++) {
                set.add("Thread1-" + i);
            }
        });
        
        Thread t2 = new Thread(() -> {
            for (int i = 0; i < 100; i++) {
                set.add("Thread2-" + i);
            }
        });
        
        t1.start();
        t2.start();
        
        try {
            t1.join();
            t2.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        
        System.out.println("æœ€ç»ˆå¤§å°: " + set.size());
        
        // æœ‰åºéå†
        System.out.println("å‰10ä¸ªå…ƒç´ :");
        int count = 0;
        for (String item : set) {
            if (count++ < 10) {
                System.out.println(item);
            } else {
                break;
            }
        }
        
        // æ•°å­—æ’åºç¤ºä¾‹
        Set<Integer> numberSet = new ConcurrentSkipListSet<>();
        numberSet.add(5);
        numberSet.add(2);
        numberSet.add(8);
        numberSet.add(1);
        numberSet.add(3);
        
        System.out.println("æœ‰åºæ•°å­—: " + numberSet);
    }
}
```

## 6. å®é™…åº”ç”¨åœºæ™¯

```mermaid
graph TD
    subgraph åº”ç”¨åœºæ™¯
        S1["Setåº”ç”¨åœºæ™¯"] --> D1["æ•°æ®å»é‡"]
        S1 --> C1["é›†åˆè¿ç®—"]
        S1 --> M1["æˆå‘˜å…³ç³»"]
        S1 --> P1["æ€§èƒ½ä¼˜åŒ–"]
    end
    
    D1 --> D11["ç”¨æˆ·IDå»é‡"]
    D1 --> D12["æ—¥å¿—äº‹ä»¶å»é‡"]
    D1 --> D13["æ•°æ®é‡‡é›†å»é‡"]
    
    C1 --> C11["æƒé™è®¡ç®—"]
    C1 --> C12["æ•°æ®æ¯”è¾ƒ"]
    C1 --> C13["å…±åŒå…ƒç´ æŸ¥æ‰¾"]
    
    M1 --> M11["æƒé™æ£€æŸ¥"]
    M1 --> M12["ç¼“å­˜é”®æ£€æŸ¥"]
    M1 --> M13["çŠ¶æ€æ ‡è®°"]
    
    subgraph å®ç°ç±»é€‰æ‹©
        A["å®ç°ç±»é€‰æ‹©"] --> B1["HashSet"]
        A --> B2["LinkedHashSet"]
        A --> B3["TreeSet"]
        A --> B4["EnumSet"]
        
        B1 --> X1["ä¸€èˆ¬å»é‡åœºæ™¯"]
        B2 --> X2["éœ€è¦è®°ä½é¡ºåº"]
        B3 --> X3["éœ€è¦æ’åº"]
        B4 --> X4["æšä¸¾ç±»å‹é›†åˆ"]
    end
    
    style S1 fill:#f9f,stroke:#333,stroke-width:2px
    style A fill:#bbf,stroke:#333,stroke-width:1px
```

### 6.1 æ•°æ®å»é‡å¤„ç†

```java title="æ•°æ®å»é‡å¤„ç†ç¤ºä¾‹"
public class DataDeduplicationExample {
    
    public static void main(String[] args) {
        // ç”¨æˆ·IDå»é‡
        List<String> userIds = Arrays.asList("user1", "user2", "user1", "user3", "user2", "user4");
        Set<String> uniqueUserIds = new HashSet<>(userIds);
        System.out.println("å»é‡åçš„ç”¨æˆ·ID: " + uniqueUserIds);
        
        // ä¿æŒæ’å…¥é¡ºåºçš„å»é‡
        List<String> orderedIds = Arrays.asList("user1", "user2", "user1", "user3", "user2", "user4");
        Set<String> orderedUniqueIds = new LinkedHashSet<>(orderedIds);
        System.out.println("ä¿æŒé¡ºåºçš„å»é‡: " + orderedUniqueIds);
        
        // å¯¹è±¡å»é‡
        List<Employee> employees = Arrays.asList(
            new Employee("Alice", "IT"),
            new Employee("Bob", "HR"),
            new Employee("Alice", "IT"), // é‡å¤
            new Employee("Charlie", "Finance")
        );
        
        Set<Employee> uniqueEmployees = new HashSet<>(employees);
        System.out.println("å»é‡åçš„å‘˜å·¥: " + uniqueEmployees);
    }
    
    static class Employee {
        private String name;
        private String department;
        
        public Employee(String name, String department) {
            this.name = name;
            this.department = department;
        }
        
        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;
            Employee employee = (Employee) o;
            return Objects.equals(name, employee.name) && 
                   Objects.equals(department, employee.department);
        }
        
        @Override
        public int hashCode() {
            return Objects.hash(name, department);
        }
        
        @Override
        public String toString() {
            return "Employee{name='" + name + "', department='" + department + "'}";
        }
    }
}
```

### 6.2 é›†åˆè¿ç®—åº”ç”¨

```java title="é›†åˆè¿ç®—åº”ç”¨ç¤ºä¾‹"
public class SetOperationsApplicationExample {

    public static void main(String[] args) {
        // ç”¨æˆ·æƒé™ç®¡ç†
        Set<String> adminPermissions = new HashSet<>(Arrays.asList("read", "write", "delete", "admin"));
        Set<String> userPermissions = new HashSet<>(Arrays.asList("read", "write"));
        Set<String> guestPermissions = new HashSet<>(Arrays.asList("read"));
        
        // è®¡ç®—æƒé™å·®å¼‚
        Set<String> adminOnlyPermissions = new HashSet<>(adminPermissions);
        adminOnlyPermissions.removeAll(userPermissions);
        System.out.println("ç®¡ç†å‘˜ç‹¬æœ‰æƒé™: " + adminOnlyPermissions);
        
        // è®¡ç®—å…±åŒæƒé™
        Set<String> commonPermissions = new HashSet<>(userPermissions);
        commonPermissions.retainAll(guestPermissions);
        System.out.println("ç”¨æˆ·å’Œè®¿å®¢å…±åŒæƒé™: " + commonPermissions);
        
        // æƒé™å‡çº§
        Set<String> upgradedPermissions = new HashSet<>(userPermissions);
        upgradedPermissions.addAll(Arrays.asList("delete"));
        System.out.println("å‡çº§åçš„ç”¨æˆ·æƒé™: " + upgradedPermissions);
        
        // æ ‡ç­¾ç³»ç»Ÿ
        Set<String> user1Tags = new HashSet<>(Arrays.asList("java", "spring", "database"));
        Set<String> user2Tags = new HashSet<>(Arrays.asList("python", "spring", "machine-learning"));
        
        // å…±åŒå…´è¶£
        Set<String> commonInterests = new HashSet<>(user1Tags);
        commonInterests.retainAll(user2Tags);
        System.out.println("å…±åŒå…´è¶£: " + commonInterests);
        
        // æ¨èæ ‡ç­¾
        Set<String> recommendedTags = new HashSet<>(user2Tags);
        recommendedTags.removeAll(user1Tags);
        System.out.println("æ¨èç»™ç”¨æˆ·1çš„æ ‡ç­¾: " + recommendedTags);
    }
}
```

### 6.3 ç¼“å­˜å®ç°

```java title="ç¼“å­˜å®ç°ç¤ºä¾‹"
public class CacheImplementationExample {
    
    // ç®€å•ç¼“å­˜å®ç°
    static class SimpleCache<K, V> {
        private final Map<K, V> cache = new HashMap<>();
        private final Set<K> accessedKeys = new LinkedHashSet<>();
        private final int maxSize;
        
        public SimpleCache(int maxSize) {
            this.maxSize = maxSize;
        }
        
        public V get(K key) {
            V value = cache.get(key);
            if (value != null) {
                // è®°å½•è®¿é—®é¡ºåº
                accessedKeys.remove(key);
                accessedKeys.add(key);
            }
            return value;
        }
        
        public void put(K key, V value) {
            if (cache.size() >= maxSize && !cache.containsKey(key)) {
                // ç§»é™¤æœ€ä¹…æœªè®¿é—®çš„å…ƒç´ 
                K oldestKey = accessedKeys.iterator().next();
                accessedKeys.remove(oldestKey);
                cache.remove(oldestKey);
            }
            
            cache.put(key, value);
            accessedKeys.remove(key);
            accessedKeys.add(key);
        }
        
        public void remove(K key) {
            cache.remove(key);
            accessedKeys.remove(key);
        }
        
        public int size() {
            return cache.size();
        }
        
        public Set<K> keySet() {
            return new HashSet<>(cache.keySet());
        }
    }
    
    public static void main(String[] args) {
        // åˆ›å»ºç¼“å­˜
        SimpleCache<String, String> cache = new SimpleCache<>(3);
        
        // æ·»åŠ å…ƒç´ 
        cache.put("key1", "value1");
        cache.put("key2", "value2");
        cache.put("key3", "value3");
        
        System.out.println("ç¼“å­˜å¤§å°: " + cache.size());
        System.out.println("ç¼“å­˜é”®: " + cache.keySet());
        
        // è®¿é—®å…ƒç´ 
        cache.get("key1");
        
        // æ·»åŠ æ–°å…ƒç´ ï¼Œä¼šæ·˜æ±°æœ€ä¹…æœªè®¿é—®çš„
        cache.put("key4", "value4");
        
        System.out.println("æ·»åŠ key4å: " + cache.keySet());
        
        // ä½¿ç”¨TreeSetå®ç°æœ‰åºç¼“å­˜
        Set<String> sortedCache = new TreeSet<>();
        sortedCache.add("item3");
        sortedCache.add("item1");
        sortedCache.add("item2");
        
        System.out.println("æœ‰åºç¼“å­˜: " + sortedCache);
    }
}
```

### 6.4 é»‘åå•/ç™½åå•ç³»ç»Ÿ

```java title="é»‘åå•ç™½åå•ç³»ç»Ÿç¤ºä¾‹"
public class BlacklistWhitelistExample {
    
    // é»‘åå•ç³»ç»Ÿ
    static class BlacklistSystem {
        private final Set<String> blacklist = new HashSet<>();
        private final Set<String> whitelist = new HashSet<>();
        
        public void addToBlacklist(String item) {
            blacklist.add(item);
            whitelist.remove(item); // ä»ç™½åå•ä¸­ç§»é™¤
        }
        
        public void addToWhitelist(String item) {
            whitelist.add(item);
            blacklist.remove(item); // ä»é»‘åå•ä¸­ç§»é™¤
        }
        
        public boolean isAllowed(String item) {
            // å¦‚æœåœ¨é»‘åå•ä¸­ï¼Œåˆ™ä¸å…è®¸
            if (blacklist.contains(item)) {
                return false;
            }
            // å¦‚æœç™½åå•ä¸ºç©ºï¼Œåˆ™å…è®¸æ‰€æœ‰éé»‘åå•é¡¹ç›®
            if (whitelist.isEmpty()) {
                return true;
            }
            // å¦åˆ™åªå…è®¸ç™½åå•ä¸­çš„é¡¹ç›®
            return whitelist.contains(item);
        }
        
        public void removeFromBlacklist(String item) {
            blacklist.remove(item);
        }
        
        public void removeFromWhitelist(String item) {
            whitelist.remove(item);
        }
        
        public Set<String> getBlacklist() {
            return new HashSet<>(blacklist);
        }
        
        public Set<String> getWhitelist() {
            return new HashSet<>(whitelist);
        }
    }
    
    public static void main(String[] args) {
        BlacklistSystem system = new BlacklistSystem();
        
        // æ·»åŠ é»‘åå•
        system.addToBlacklist("spam@example.com");
        system.addToBlacklist("malware.com");
        
        // æ·»åŠ ç™½åå•
        system.addToWhitelist("trusted@company.com");
        system.addToWhitelist("partner.com");
        
        // æµ‹è¯•è®¿é—®æ§åˆ¶
        System.out.println("spam@example.com å…è®¸: " + system.isAllowed("spam@example.com"));
        System.out.println("trusted@company.com å…è®¸: " + system.isAllowed("trusted@company.com"));
        System.out.println("unknown@example.com å…è®¸: " + system.isAllowed("unknown@example.com"));
        
        // ç§»é™¤é»‘åå•é¡¹ç›®
        system.removeFromBlacklist("spam@example.com");
        System.out.println("ç§»é™¤é»‘åå•å spam@example.com å…è®¸: " + system.isAllowed("spam@example.com"));
    }
}
```

## 7. æœ€ä½³å®è·µæ€»ç»“

### 7.1 Setå®ç°ç±»é€‰æ‹©ç­–ç•¥

:::tip é€‰æ‹©å»ºè®®
é€‰æ‹©åˆé€‚çš„Setå®ç°ç±»éœ€è¦è€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š
- **æ€§èƒ½è¦æ±‚**ï¼šæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤çš„æ€§èƒ½éœ€æ±‚
- **é¡ºåºè¦æ±‚**ï¼šæ˜¯å¦éœ€è¦ä¿æŒå…ƒç´ é¡ºåº
- **çº¿ç¨‹å®‰å…¨**ï¼šæ˜¯å¦åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨
- **å†…å­˜çº¦æŸ**ï¼šå†…å­˜ä½¿ç”¨é™åˆ¶
- **åŠŸèƒ½éœ€æ±‚**ï¼šæ˜¯å¦éœ€è¦ç‰¹æ®ŠåŠŸèƒ½ï¼ˆå¦‚å¯¼èˆªæ–¹æ³•ï¼‰
:::

| å®ç°ç±» | é€‚ç”¨åœºæ™¯ | ä¼˜åŠ¿ | åŠ£åŠ¿ |
|--------|----------|------|------|
| **HashSet** | ä¸€èˆ¬ç”¨é€”ã€å»é‡ | æ€§èƒ½æœ€å¥½ã€å†…å­˜æ•ˆç‡é«˜ | æ— åºã€çº¿ç¨‹ä¸å®‰å…¨ |
| **LinkedHashSet** | éœ€è¦ä¿æŒæ’å…¥é¡ºåº | ä¿æŒé¡ºåºã€æ€§èƒ½å¥½ | å†…å­˜å¼€é”€ç¨å¤§ |
| **TreeSet** | éœ€è¦æœ‰åºã€èŒƒå›´æŸ¥è¯¢ | æœ‰åºã€æ”¯æŒå¯¼èˆªæ–¹æ³• | æ€§èƒ½è¾ƒå·®ã€å†…å­˜å¼€é”€å¤§ |
| **CopyOnWriteArraySet** | è¯»å¤šå†™å°‘ã€çº¿ç¨‹å®‰å…¨ | çº¿ç¨‹å®‰å…¨ã€è¯»æ€§èƒ½å¥½ | å†™æ€§èƒ½å·®ã€å†…å­˜å¼€é”€å¤§ |
| **EnumSet** | æšä¸¾ç±»å‹ | æ€§èƒ½æé«˜ã€å†…å­˜æ•ˆç‡æœ€é«˜ | åªèƒ½å­˜å‚¨æšä¸¾ |
| **ConcurrentSkipListSet** | å¹¶å‘æœ‰åºSet | çº¿ç¨‹å®‰å…¨ã€æœ‰åº | æ€§èƒ½ä¸­ç­‰ |

### 7.2 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

```java title="Setæ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹"
public class SetPerformanceOptimization {
    
    /**
     * é¢„åˆ†é…å®¹é‡ä¼˜åŒ–
     */
    public static void capacityOptimization() {
        // çŸ¥é“å¤§æ¦‚å…ƒç´ æ•°é‡æ—¶ï¼Œé¢„åˆ†é…å®¹é‡
        int expectedSize = 1000;
        Set<String> optimizedSet = new HashSet<>(expectedSize);
        
        // é¿å…é¢‘ç¹æ‰©å®¹
        for (int i = 0; i < expectedSize; i++) {
            optimizedSet.add("item" + i);
        }
    }
    
    /**
     * æ‰¹é‡æ“ä½œä¼˜åŒ–
     */
    public static void batchOperationOptimization() {
        Set<String> set1 = new HashSet<>();
        Set<String> set2 = new HashSet<>();
        
        // æ‰¹é‡æ·»åŠ ï¼Œæ¯”å¾ªç¯addæ•ˆç‡é«˜
        set1.addAll(set2);
        
        // æ‰¹é‡åˆ é™¤
        set1.removeAll(set2);
        
        // ä¿ç•™äº¤é›†
        set1.retainAll(set2);
    }
    
    /**
     * å…ƒç´ ç±»å‹ä¼˜åŒ–
     */
    public static void elementTypeOptimization() {
        // æ¨èï¼šä½¿ç”¨ä¸å¯å˜å¯¹è±¡
        Set<String> goodSet = new HashSet<>();
        
        // ä¸æ¨èï¼šä½¿ç”¨å¯å˜å¯¹è±¡
        Set<StringBuilder> badSet = new HashSet<>();
    }
    
    /**
     * éå†ä¼˜åŒ–
     */
    public static void iterationOptimization() {
        Set<String> set = new HashSet<>();
        
        // æ¨èï¼šä½¿ç”¨å¢å¼ºforå¾ªç¯
for (String item : set) {
    System.out.println(item);
}

        // æ¨èï¼šä½¿ç”¨forEachæ–¹æ³•
        set.forEach(System.out::println);
        
        // ä¸æ¨èï¼šä½¿ç”¨è¿­ä»£å™¨ï¼ˆé™¤ééœ€è¦åˆ é™¤å…ƒç´ ï¼‰
Iterator<String> iterator = set.iterator();
while (iterator.hasNext()) {
            String item = iterator.next();
            System.out.println(item);
        }
    }
}
```

### 7.3 å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ

:::caution æ³¨æ„äº‹é¡¹
1. **equalså’ŒhashCodeä¸€è‡´æ€§**ï¼šè‡ªå®šä¹‰å¯¹è±¡å¿…é¡»æ­£ç¡®å®ç°equalså’ŒhashCodeæ–¹æ³•
2. **å¯å˜å¯¹è±¡é—®é¢˜**ï¼šé¿å…ä½¿ç”¨å¯å˜å¯¹è±¡ä½œä¸ºSetå…ƒç´ 
3. **çº¿ç¨‹å®‰å…¨é—®é¢˜**ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹é€‰æ‹©åˆé€‚çš„çº¿ç¨‹å®‰å…¨å®ç°
4. **nullå€¼å¤„ç†**ï¼šæŸäº›Setå®ç°ä¸æ”¯æŒnullå€¼
5. **æ€§èƒ½è€ƒè™‘**ï¼šæ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„å®ç°ç±»
:::

```java title="å¸¸è§é™·é˜±ç¤ºä¾‹"
public class SetCommonTraps {
    
    /**
     * equalså’ŒhashCodeä¸ä¸€è‡´é™·é˜±
     */
    public static void equalsHashCodeTrap() {
        // é”™è¯¯ï¼šequalså’ŒhashCodeä¸ä¸€è‡´
        Set<BadPerson> badSet = new HashSet<>();
        BadPerson p1 = new BadPerson("Alice", 25);
        BadPerson p2 = new BadPerson("Alice", 25);
        
        badSet.add(p1);
        badSet.add(p2); // å¯èƒ½æ·»åŠ æˆåŠŸï¼Œå› ä¸ºhashCodeä¸åŒ
        
        System.out.println("BadSetå¤§å°: " + badSet.size()); // å¯èƒ½æ˜¯2
        
        // æ­£ç¡®ï¼šequalså’ŒhashCodeä¸€è‡´
        Set<GoodPerson> goodSet = new HashSet<>();
        GoodPerson p3 = new GoodPerson("Alice", 25);
        GoodPerson p4 = new GoodPerson("Alice", 25);
        
        goodSet.add(p3);
        goodSet.add(p4); // ä¸ä¼šæ·»åŠ ï¼Œå› ä¸ºequalsè¿”å›true
        
        System.out.println("GoodSetå¤§å°: " + goodSet.size()); // 1
    }
    
    /**
     * å¯å˜å¯¹è±¡é™·é˜±
     */
    public static void mutableObjectTrap() {
        Set<StringBuilder> set = new HashSet<>();
        StringBuilder sb = new StringBuilder("Hello");
        set.add(sb);
        
        System.out.println("æ·»åŠ å‰: " + set.contains(sb)); // true
        
        // ä¿®æ”¹å¯¹è±¡å†…å®¹
        sb.append(" World");
        
        System.out.println("ä¿®æ”¹å: " + set.contains(sb)); // false
        System.out.println("Setå†…å®¹: " + set);
    }
    
    /**
     * çº¿ç¨‹å®‰å…¨é™·é˜±
     */
    public static void threadSafetyTrap() {
        Set<String> set = new HashSet<>(); // çº¿ç¨‹ä¸å®‰å…¨
        
        // é”™è¯¯ï¼šå¤šçº¿ç¨‹è®¿é—®
        Thread t1 = new Thread(() -> {
            for (int i = 0; i < 1000; i++) {
                set.add("Thread1-" + i);
            }
        });
        
        Thread t2 = new Thread(() -> {
            for (int i = 0; i < 1000; i++) {
                set.add("Thread2-" + i);
            }
        });
        
        // æ­£ç¡®ï¼šä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„Set
        Set<String> safeSet = new CopyOnWriteArraySet<>();
        // æˆ–è€…ä½¿ç”¨ Collections.synchronizedSet(new HashSet<>())
    }
    
    static class BadPerson {
        private String name;
        private int age;
        
        public BadPerson(String name, int age) {
            this.name = name;
            this.age = age;
        }
        
        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;
            BadPerson that = (BadPerson) o;
            return age == that.age && Objects.equals(name, that.name);
        }
        
        // é”™è¯¯ï¼šhashCodeä¸equalsä¸ä¸€è‡´
        @Override
        public int hashCode() {
            return Objects.hash(name); // åªä½¿ç”¨name
        }
    }
    
    static class GoodPerson {
        private String name;
        private int age;
        
        public GoodPerson(String name, int age) {
            this.name = name;
            this.age = age;
        }
        
        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;
            GoodPerson that = (GoodPerson) o;
            return age == that.age && Objects.equals(name, that.name);
        }
        
        // æ­£ç¡®ï¼šhashCodeä¸equalsä¸€è‡´
        @Override
        public int hashCode() {
            return Objects.hash(name, age); // ä½¿ç”¨æ‰€æœ‰å­—æ®µ
        }
    }
}
```

### 7.4 æµ‹è¯•å’Œè°ƒè¯•å»ºè®®

```java title="Setæµ‹è¯•è°ƒè¯•ç¤ºä¾‹"
public class SetTestingDebugging {
    
    /**
     * å•å…ƒæµ‹è¯•ç¤ºä¾‹
     */
    public static void unitTestExample() {
        Set<String> set = new HashSet<>();
        
        // æµ‹è¯•æ·»åŠ æ“ä½œ
        assert set.isEmpty();
        set.add("test");
        assert set.size() == 1;
        assert set.contains("test");
        
        // æµ‹è¯•åˆ é™¤æ“ä½œ
        set.remove("test");
        assert set.isEmpty();
        
        System.out.println("æ‰€æœ‰æµ‹è¯•é€šè¿‡");
    }
    
    /**
     * æ€§èƒ½æµ‹è¯•ç¤ºä¾‹
     */
    public static void performanceTestExample() {
        int size = 100000;
        
        // HashSetæ€§èƒ½æµ‹è¯•
        long start = System.currentTimeMillis();
        Set<Integer> hashSet = new HashSet<>();
        for (int i = 0; i < size; i++) {
            hashSet.add(i);
        }
        long hashSetTime = System.currentTimeMillis() - start;
        
        // TreeSetæ€§èƒ½æµ‹è¯•
        start = System.currentTimeMillis();
        Set<Integer> treeSet = new TreeSet<>();
        for (int i = 0; i < size; i++) {
            treeSet.add(i);
        }
        long treeSetTime = System.currentTimeMillis() - start;
        
        System.out.println("HashSetæ·»åŠ " + size + "ä¸ªå…ƒç´ è€—æ—¶: " + hashSetTime + "ms");
        System.out.println("TreeSetæ·»åŠ " + size + "ä¸ªå…ƒç´ è€—æ—¶: " + treeSetTime + "ms");
    }
    
    /**
     * å¹¶å‘æµ‹è¯•ç¤ºä¾‹
     */
    public static void concurrentTestExample() {
        Set<String> set = new CopyOnWriteArraySet<>();
        int threadCount = 10;
        int operationsPerThread = 1000;
        
        // åˆ›å»ºå¤šä¸ªçº¿ç¨‹å¹¶å‘æ“ä½œ
        Thread[] threads = new Thread[threadCount];
        for (int i = 0; i < threadCount; i++) {
            final int threadId = i;
            threads[i] = new Thread(() -> {
                for (int j = 0; j < operationsPerThread; j++) {
                    set.add("Thread" + threadId + "-Item" + j);
                }
            });
        }
        
        // å¯åŠ¨æ‰€æœ‰çº¿ç¨‹
        for (Thread thread : threads) {
            thread.start();
        }
        
        // ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
        for (Thread thread : threads) {
            try {
                thread.join();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        
        System.out.println("æœ€ç»ˆSetå¤§å°: " + set.size());
        System.out.println("æœŸæœ›å¤§å°: " + (threadCount * operationsPerThread));
    }
}
```

## 8. æ€»ç»“

Setæ¥å£ä½œä¸ºJavaé›†åˆæ¡†æ¶çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæä¾›äº†ä¸°å¯Œå¤šæ ·çš„ä¸é‡å¤å…ƒç´ é›†åˆå®ç°ï¼Œæ»¡è¶³äº†ä¸åŒåœºæ™¯ä¸‹çš„éœ€æ±‚ã€‚é€šè¿‡æ·±å…¥ç†è§£å„ç§Setå®ç°ç±»çš„ç‰¹æ€§å’Œä½¿ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå‡ºé«˜æ•ˆã€å¯é çš„æ•°æ®å¤„ç†åº”ç”¨ç¨‹åºã€‚

åœ¨å®é™…å¼€å‘ä¸­ï¼Œéœ€è¦ç»¼åˆè€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
- **åŠŸèƒ½éœ€æ±‚**ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„Setç±»å‹
- **æ€§èƒ½è¦æ±‚**ï¼šè€ƒè™‘æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤æ€§èƒ½
- **å†…å­˜çº¦æŸ**ï¼šè€ƒè™‘å†…å­˜ä½¿ç”¨æ•ˆç‡
- **çº¿ç¨‹å®‰å…¨**ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹é€‰æ‹©åˆé€‚çš„å®ç°
- **é¡ºåºè¦æ±‚**ï¼šæ˜¯å¦éœ€è¦ä¿æŒå…ƒç´ é¡ºåº

é€šè¿‡åˆç†ä½¿ç”¨Seté›†åˆï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå‡ºé«˜æ•ˆã€å¯é çš„Javaåº”ç”¨ç¨‹åºã€‚

## 9. é¢è¯•é¢˜ç²¾é€‰

### 9.1 åŸºç¡€æ¦‚å¿µé¢˜

**Q: HashSetå’ŒTreeSetçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ**

A: ä¸»è¦åŒºåˆ«åŒ…æ‹¬ï¼š
- **åº•å±‚å®ç°**ï¼šHashSetåŸºäºHashMapï¼ŒTreeSetåŸºäºTreeMap
- **å…ƒç´ é¡ºåº**ï¼šHashSetæ— åºï¼ŒTreeSetæœ‰åº
- **æ€§èƒ½ç‰¹ç‚¹**ï¼šHashSet O(1)ï¼ŒTreeSet O(log n)
- **nullå€¼æ”¯æŒ**ï¼šHashSetå…è®¸nullï¼ŒTreeSetä¸å…è®¸null
- **ä½¿ç”¨åœºæ™¯**ï¼šHashSeté€‚åˆä¸€èˆ¬ç”¨é€”ï¼ŒTreeSeté€‚åˆéœ€è¦æ’åºçš„åœºæ™¯

**Q: HashSetå¦‚ä½•ä¿è¯å…ƒç´ å”¯ä¸€æ€§ï¼Ÿ**

A: HashSetä¿è¯å…ƒç´ å”¯ä¸€æ€§çš„æœºåˆ¶ï¼š
- **å“ˆå¸Œç®—æ³•**ï¼šè®¡ç®—å…ƒç´ çš„å“ˆå¸Œå€¼ç¡®å®šå­˜å‚¨ä½ç½®
- **equalsæ¯”è¾ƒ**ï¼šå“ˆå¸Œå€¼ç›¸åŒæ—¶ä½¿ç”¨equalsæ–¹æ³•æ¯”è¾ƒ
- **ä¸æ·»åŠ é‡å¤**ï¼šå¦‚æœå…ƒç´ å·²å­˜åœ¨åˆ™ä¸æ·»åŠ 
- **ä¾èµ–å®ç°**ï¼šè¦æ±‚å…ƒç´ æ­£ç¡®å®ç°equalså’ŒhashCodeæ–¹æ³•

### 9.2 æ€§èƒ½ä¼˜åŒ–é¢˜

**Q: å¦‚ä½•ä¼˜åŒ–Setçš„æ€§èƒ½ï¼Ÿ**

A: ä¸»è¦ä¼˜åŒ–ç­–ç•¥ï¼š
- **é¢„åˆ†é…å®¹é‡**ï¼šä½¿ç”¨å¸¦åˆå§‹å®¹é‡çš„æ„é€ å‡½æ•°
- **æ‰¹é‡æ“ä½œ**ï¼šä½¿ç”¨addAll()è€Œéå¾ªç¯add()
- **é€‰æ‹©åˆé€‚çš„å®ç°ç±»**ï¼šæ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©æœ€åˆé€‚çš„Set
- **é¿å…é¢‘ç¹æ‰©å®¹**ï¼šåˆç†è®¾ç½®åˆå§‹å®¹é‡
- **ä½¿ç”¨ä¸å¯å˜å¯¹è±¡**ï¼šé¿å…ä½¿ç”¨å¯å˜å¯¹è±¡ä½œä¸ºå…ƒç´ 

**Q: ä»€ä¹ˆåœºæ™¯ä¸‹é€‰æ‹©TreeSetï¼Ÿ**

A: TreeSeté€‚ç”¨åœºæ™¯ï¼š
- éœ€è¦å…ƒç´ æœ‰åºçš„åœºæ™¯
- éœ€è¦èŒƒå›´æŸ¥è¯¢çš„åœºæ™¯
- éœ€è¦è·å–æœ€å¤§æœ€å°å…ƒç´ çš„åœºæ™¯
- éœ€è¦æŒ‰é¡ºåºéå†çš„åœºæ™¯
- éœ€è¦å¯¼èˆªæ–¹æ³•çš„åœºæ™¯

### 9.3 å®è·µåº”ç”¨é¢˜

**Q: å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨çš„Setæ“ä½œï¼Ÿ**

A: çº¿ç¨‹å®‰å…¨æ–¹æ¡ˆï¼š
- **ä½¿ç”¨CopyOnWriteArraySet**ï¼šè¯»å¤šå†™å°‘åœºæ™¯
- **ä½¿ç”¨ConcurrentSkipListSet**ï¼šéœ€è¦æœ‰åºçš„å¹¶å‘åœºæ™¯
- **Collections.synchronizedSet()**ï¼šåŒ…è£…ç°æœ‰Set
- **å¤–éƒ¨åŒæ­¥**ï¼šä½¿ç”¨synchronizedæˆ–Lock
- **å¹¶å‘é›†åˆ**ï¼šè€ƒè™‘ä½¿ç”¨ConcurrentHashMap.keySet()

**Q: å¦‚ä½•å¤„ç†Setä¸­çš„è‡ªå®šä¹‰å¯¹è±¡ï¼Ÿ**

A: å¤„ç†æ–¹æ¡ˆï¼š
- **æ­£ç¡®å®ç°equalså’ŒhashCode**ï¼šä¿è¯ä¸€è‡´æ€§
- **ä½¿ç”¨ä¸å¯å˜å¯¹è±¡**ï¼šé¿å…å¯å˜å¯¹è±¡é—®é¢˜
- **å®ç°Comparableæ¥å£**ï¼šç”¨äºTreeSetæ’åº
- **æä¾›Comparator**ï¼šè‡ªå®šä¹‰æ’åºè§„åˆ™
- **è€ƒè™‘æ€§èƒ½å½±å“**ï¼šå¤æ‚å¯¹è±¡çš„æ¯”è¾ƒå¼€é”€

**Q: Setçš„éå†æ–¹å¼æœ‰å“ªäº›ï¼Ÿ**

A: éå†æ–¹å¼ï¼š
- **å¢å¼ºforå¾ªç¯**ï¼š`for (E item : set)`
- **è¿­ä»£å™¨**ï¼š`Iterator<E> iterator = set.iterator()`
- **forEachæ–¹æ³•**ï¼š`set.forEach(System.out::println)`
- **Stream API**ï¼š`set.stream().forEach(System.out::println)`
- **å¹¶è¡Œæµ**ï¼š`set.parallelStream().forEach(System.out::println)`

### 9.4 é«˜çº§åº”ç”¨é¢˜

**Q: å¦‚ä½•å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„Setï¼Ÿ**

A: å®ç°æ­¥éª¤ï¼š
- **ç»§æ‰¿AbstractSet**ï¼šå®ç°åŸºæœ¬çš„Setæ“ä½œ
- **å®ç°æ ¸å¿ƒæ–¹æ³•**ï¼šaddã€removeã€containsã€sizeç­‰
- **ä¿è¯å…ƒç´ å”¯ä¸€æ€§**ï¼šå®ç°å»é‡é€»è¾‘
- **è€ƒè™‘æ€§èƒ½ä¼˜åŒ–**ï¼šé€‰æ‹©åˆé€‚çš„åº•å±‚æ•°æ®ç»“æ„
- **å®ç°è¿­ä»£å™¨**ï¼šæ”¯æŒéå†æ“ä½œ

**Q: EnumSetçš„ä¼˜åŠ¿å’Œåº”ç”¨åœºæ™¯ï¼Ÿ**

A: ä¼˜åŠ¿å’Œåœºæ™¯ï¼š
- **æ€§èƒ½æé«˜**ï¼šåŸºäºä½å‘é‡å®ç°
- **å†…å­˜æ•ˆç‡**ï¼šä½¿ç”¨ä½è¿ç®—ï¼Œå†…å­˜å ç”¨æå°
- **ç±»å‹å®‰å…¨**ï¼šåªèƒ½å­˜å‚¨æšä¸¾ç±»å‹
- **åº”ç”¨åœºæ™¯**ï¼šæƒé™ç®¡ç†ã€çŠ¶æ€æ ‡è®°ã€é…ç½®é€‰é¡¹
- **åˆ›å»ºæ–¹å¼**ï¼šallOfã€noneOfã€rangeã€ofç­‰æ–¹æ³•

**Q: LinkedHashSetçš„å®ç°åŸç†ï¼Ÿ**

A: å®ç°åŸç†ï¼š
- **ç»§æ‰¿HashSet**ï¼šå¤ç”¨HashSetçš„æ‰€æœ‰åŠŸèƒ½
- **LinkedHashMap**ï¼šåº•å±‚ä½¿ç”¨LinkedHashMapè€ŒéHashMap
- **åŒå‘é“¾è¡¨**ï¼šç»´æŠ¤å…ƒç´ çš„æ’å…¥é¡ºåº
- **æ€§èƒ½å¹³è¡¡**ï¼šåœ¨HashSeté«˜æ€§èƒ½åŸºç¡€ä¸Šå¢åŠ é¡ºåºç»´æŠ¤
- **æ„é€ æ–¹æ³•**ï¼šè°ƒç”¨HashSetçš„ç‰¹å®šæ„é€ æ–¹æ³•

:::tip é¢è¯•è¦ç‚¹
1. **ç†è§£åº•å±‚å®ç°**ï¼šæŒæ¡å„ç§Setçš„å†…éƒ¨ç»“æ„å’Œå·¥ä½œåŸç†
2. **æ€§èƒ½åˆ†æ**ï¼šèƒ½å¤Ÿåˆ†æä¸åŒæ“ä½œçš„æ—¶é—´å¤æ‚åº¦
3. **åœºæ™¯é€‰æ‹©**ï¼šæ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„Setå®ç°
4. **çº¿ç¨‹å®‰å…¨**ï¼šç†è§£çº¿ç¨‹å®‰å…¨å’Œå¹¶å‘æ§åˆ¶æœºåˆ¶
5. **æœ€ä½³å®è·µ**ï¼šäº†è§£å¸¸è§é™·é˜±å’Œä¼˜åŒ–ç­–ç•¥
:::

---

é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†Java Seté›†åˆçš„æ ¸å¿ƒæ¦‚å¿µã€å®ç°åŸç†å’Œæœ€ä½³å®è·µã€‚Setæ˜¯Javaæ•°æ®å¤„ç†å’Œç®—æ³•å®ç°çš„é‡è¦åŸºç¡€ï¼Œæ·±å…¥ç†è§£å…¶ç‰¹æ€§å’Œä½¿ç”¨åœºæ™¯ï¼Œå¯¹äºç¼–å†™é«˜æ•ˆã€å¯é çš„Javaç¨‹åºè‡³å…³é‡è¦ã€‚ 