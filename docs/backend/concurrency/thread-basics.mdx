---
sidebar_position: 1
title: "Javaçº¿ç¨‹åŸºç¡€è¯¦è§£"
description: "å…¨é¢ä»‹ç»Javaçº¿ç¨‹åŸºç¡€çŸ¥è¯†ã€åˆ›å»ºæ–¹å¼ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†ä¸æœ€ä½³å®è·µ"
authors: [Laby]
last_update:
  date: 2025-01-07
  author: Laby
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import TOCInline from '@theme/TOCInline';

# Java çº¿ç¨‹åŸºç¡€è¯¦è§£

çº¿ç¨‹æ˜¯Javaå¹¶å‘ç¼–ç¨‹çš„åŸºç¡€ï¼Œç†è§£çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€åˆ›å»ºæ–¹å¼ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†å¯¹äºæŒæ¡å¹¶å‘ç¼–ç¨‹è‡³å…³é‡è¦ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»Javaçº¿ç¨‹çš„æ ¸å¿ƒçŸ¥è¯†ã€‚

:::info æœ¬æ–‡å†…å®¹æ¦‚è§ˆ
<TOCInline toc={toc} />
:::

:::tip æ ¸å¿ƒä»·å€¼
**Javaçº¿ç¨‹ = è½»é‡çº§å¤„ç†å•å…ƒ + å¹¶å‘æ‰§è¡Œ + èµ„æºå…±äº« + é«˜æ•ˆé€šä¿¡ + å¯é æ€§ä¿éšœ**
- ğŸš€ **è½»é‡çº§å¤„ç†**ï¼šæ¯”è¿›ç¨‹åˆ›å»ºæ›´è½»é‡ï¼Œç³»ç»Ÿå¼€é”€å°
- ğŸ‘¥ **å¹¶å‘æ‰§è¡Œ**ï¼šå¤šçº¿ç¨‹å¹¶è¡Œå¤„ç†ä»»åŠ¡ï¼Œæé«˜CPUåˆ©ç”¨ç‡
- ğŸ”„ **èµ„æºå…±äº«**ï¼šå…±äº«è¿›ç¨‹å†…å­˜ç©ºé—´ï¼Œå‡å°‘é€šä¿¡å¼€é”€
- âš¡ **å“åº”æ€§èƒ½**ï¼šæé«˜åº”ç”¨å“åº”æ€§èƒ½ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹
- ğŸ›¡ï¸ **éš”ç¦»æ€§**ï¼šå„çº¿ç¨‹ç‹¬ç«‹æ‰§è¡Œï¼Œäº’ä¸å¹²æ‰°
:::

## 1. çº¿ç¨‹æ¦‚è¿°

### 1.1 ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ

```mermaid
graph TD
    A[è¿›ç¨‹] --> B[çº¿ç¨‹1]
    A --> C[çº¿ç¨‹2]
    A --> D[çº¿ç¨‹3]
    B --> E[æ‰§è¡Œæ ˆ]
    B --> F[PCå¯„å­˜å™¨]
    B --> G[æœ¬åœ°å˜é‡]
    C --> H[æ‰§è¡Œæ ˆ]
    C --> I[PCå¯„å­˜å™¨]
    C --> J[æœ¬åœ°å˜é‡]
    A --> K[å…±äº«å†…å­˜]
    A --> L[å…±äº«æ–‡ä»¶èµ„æº]
```

:::tip æ ¸å¿ƒæ¦‚å¿µ
çº¿ç¨‹æ˜¯ç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½ï¼Œæ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•å…ƒã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜ç©ºé—´ï¼Œä½†æ‹¥æœ‰ç‹¬ç«‹çš„æ‰§è¡Œæ ˆã€‚
:::

### 1.2 çº¿ç¨‹ä¸è¿›ç¨‹çš„å…³ç³»

<div className="card">
<div className="card__body">

| ç‰¹æ€§ | è¿›ç¨‹ | çº¿ç¨‹ |
|------|------|------|
| **èµ„æºåˆ†é…** | æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºçš„åŸºæœ¬å•ä½ | å…±äº«è¿›ç¨‹çš„èµ„æº |
| **å†…å­˜ç©ºé—´** | ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ | å…±äº«è¿›ç¨‹çš„å†…å­˜ç©ºé—´ |
| **åˆ›å»ºå¼€é”€** | è¾ƒå¤§ | è¾ƒå° |
| **é€šä¿¡æ–¹å¼** | è¿›ç¨‹é—´é€šä¿¡(IPC) | ç›´æ¥å…±äº«å†…å­˜ |
| **åˆ‡æ¢å¼€é”€** | è¾ƒå¤§ | è¾ƒå° |
| **å¹¶å‘æ€§** | è¿›ç¨‹çº§å¹¶å‘ | çº¿ç¨‹çº§å¹¶å‘ |
| **ç¨³å®šæ€§** | ä¸€ä¸ªè¿›ç¨‹å´©æºƒä¸å½±å“å…¶ä»–è¿›ç¨‹ | ä¸€ä¸ªçº¿ç¨‹å´©æºƒå¯èƒ½å¯¼è‡´æ•´ä¸ªè¿›ç¨‹å´©æºƒ |

</div>
</div>

### 1.3 çº¿ç¨‹çš„ä¼˜åŠ¿

<Tabs>
  <TabItem value="responsive" label="æé«˜å“åº”æ€§" default>
  ```java
  // ä¸»çº¿ç¨‹ä¿æŒUIå“åº”
  SwingUtilities.invokeLater(() -> {
      // UIç›¸å…³æ“ä½œ
      frame.setVisible(true);
  });
        
  // å·¥ä½œçº¿ç¨‹å¤„ç†è€—æ—¶æ“ä½œ
  new Thread(() -> {
      // å¤„ç†è€—æ—¶çš„æ•°æ®åŠ è½½
      loadLargeDataset();
      
      // å®Œæˆåæ›´æ–°UI
      SwingUtilities.invokeLater(() -> {
          updateUIWithResults();
      });
  }).start();
  ```
  </TabItem>
  <TabItem value="resource" label="èµ„æºå…±äº«">
  ```java
  // å…±äº«æ•°æ®
  SharedData sharedData = new SharedData();
    
  // å¤šä¸ªçº¿ç¨‹è®¿é—®å…±äº«æ•°æ®
  Thread thread1 = new Thread(() -> {
      sharedData.increment();
      System.out.println("çº¿ç¨‹1: " + sharedData.getValue());
  });
    
  Thread thread2 = new Thread(() -> {
      sharedData.increment();
      System.out.println("çº¿ç¨‹2: " + sharedData.getValue());
  });
    
  thread1.start();
  thread2.start();
  ```
  </TabItem>
  <TabItem value="efficient" label="ç»æµæ€§">
  ```java
  // åˆ›å»ºå¤šä¸ªçº¿ç¨‹å¤„ç†ä»»åŠ¡ï¼Œæ¯”åˆ›å»ºå¤šä¸ªè¿›ç¨‹å¼€é”€å°
  for (int i = 0; i < 10; i++) {
      final int taskId = i;
      Thread thread = new Thread(() -> {
          System.out.println("å¤„ç†ä»»åŠ¡: " + taskId);
          processTask(taskId);
      });
      thread.start();
  }
  ```
  </TabItem>
</Tabs>

## 2. çº¿ç¨‹åˆ›å»ºæ–¹å¼è¯¦è§£

<details>
<summary><strong>çº¿ç¨‹åˆ›å»ºæ–¹æ³•å¯¹æ¯”</strong></summary>

```mermaid
graph LR
    A[çº¿ç¨‹åˆ›å»ºæ–¹å¼] --> B[ç»§æ‰¿Thread]
    A --> C[å®ç°Runnable]
    A --> D[å®ç°Callable]
    
    B --> B1["ä¼˜ç‚¹: ç®€å•ç›´æ¥\nç¼ºç‚¹: å•ç»§æ‰¿é™åˆ¶"]
    C --> C1["ä¼˜ç‚¹: é¿å…å•ç»§æ‰¿\nç¼ºç‚¹: æ— æ³•ç›´æ¥è®¿é—®Threadæ–¹æ³•"]
    D --> D1["ä¼˜ç‚¹: å¯è¿”å›å€¼ã€æŠ›å¼‚å¸¸\nç¼ºç‚¹: ä½¿ç”¨è¾ƒå¤æ‚"]
```

| åˆ›å»ºæ–¹å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---------|------|------|----------|
| **ç»§æ‰¿Thread** | ç®€å•ç›´æ¥ï¼Œå¯è®¿é—®çº¿ç¨‹æ–¹æ³• | å•ç»§æ‰¿é™åˆ¶ï¼Œä¸èƒ½ç»§æ‰¿å…¶ä»–ç±» | ç®€å•ä»»åŠ¡ï¼Œéœ€è¦ç›´æ¥æ“ä½œçº¿ç¨‹ |
| **å®ç°Runnable** | é¿å…å•ç»§æ‰¿é™åˆ¶ï¼Œæ›´çµæ´» | ä¸èƒ½ç›´æ¥è®¿é—®çº¿ç¨‹æ–¹æ³• | å¤§å¤šæ•°åœºæ™¯ä¸‹çš„é¦–é€‰æ–¹å¼ |
| **å®ç°Callable** | å¯è¿”å›ç»“æœï¼Œå¯æŠ›å‡ºå¼‚å¸¸ | ä½¿ç”¨ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦Future | éœ€è¦è¿”å›å€¼æˆ–å¼‚å¸¸å¤„ç†çš„ä»»åŠ¡ |

</details>

### 2.1 ç»§æ‰¿Threadç±»

<Tabs>
  <TabItem value="code" label="ä»£ç å®ç°" default>
  ```java
  // è‡ªå®šä¹‰çº¿ç¨‹ç±»
  public class CustomThread extends Thread {
      private String threadName;
      
      public CustomThread(String threadName) {
          this.threadName = threadName;
      }
      
      @Override
      public void run() {
          System.out.println("çº¿ç¨‹ " + threadName + " å¼€å§‹æ‰§è¡Œ");
          // çº¿ç¨‹ä»»åŠ¡ä»£ç ...
          System.out.println("çº¿ç¨‹ " + threadName + " æ‰§è¡Œå®Œæˆ");
      }
  }
  
  // ä½¿ç”¨æ–¹å¼
  CustomThread thread = new CustomThread("å·¥ä½œçº¿ç¨‹");
  thread.start(); // å¯åŠ¨çº¿ç¨‹
  ```
  </TabItem>
  <TabItem value="features" label="ç‰¹ç‚¹åˆ†æ">
  <div className="card">
  <div className="card__header">
  <h4>ç»§æ‰¿Threadç±»ç‰¹ç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li><strong>ä¼˜ç‚¹</strong>ï¼šç›´æ¥è®¿é—®Threadçš„æ–¹æ³•ï¼ˆå¦‚getName(), getPriority()ç­‰ï¼‰</li>
  <li><strong>ç¼ºç‚¹</strong>ï¼šJavaå•ç»§æ‰¿é™åˆ¶ï¼Œæ— æ³•å†ç»§æ‰¿å…¶ä»–ç±»</li>
  <li><strong>æ§åˆ¶</strong>ï¼šå¯ä»¥ç›´æ¥æ§åˆ¶çº¿ç¨‹çš„è¡Œä¸º</li>
  <li><strong>è€¦åˆåº¦</strong>ï¼šä»»åŠ¡é€»è¾‘ä¸çº¿ç¨‹æ§åˆ¶è€¦åˆåœ¨ä¸€èµ·</li>
  </ul>
  </div>
  </div>
  </TabItem>
  <TabItem value="usage" label="ä½¿ç”¨ç¤ºä¾‹">
  ```java
  public class ThreadExample {
      public static void main(String[] args) {
          // åˆ›å»ºçº¿ç¨‹å®ä¾‹
          CustomThread thread1 = new CustomThread("å·¥ä½œçº¿ç¨‹1");
          CustomThread thread2 = new CustomThread("å·¥ä½œçº¿ç¨‹2");
          
          // è®¾ç½®çº¿ç¨‹å±æ€§
          thread1.setPriority(Thread.MAX_PRIORITY); // æœ€é«˜ä¼˜å…ˆçº§
          thread2.setPriority(Thread.MIN_PRIORITY); // æœ€ä½ä¼˜å…ˆçº§
          
          // å¯åŠ¨çº¿ç¨‹
          thread1.start();
          thread2.start();
          
          try {
              thread1.join(); // ç­‰å¾…thread1å®Œæˆ
              thread2.join(); // ç­‰å¾…thread2å®Œæˆ
          } catch (InterruptedException e) {
              Thread.currentThread().interrupt();
          }
      }
  }
  ```
  </TabItem>
</Tabs>

### 2.2 å®ç°Runnableæ¥å£

<Tabs>
  <TabItem value="basic" label="åŸºæœ¬å®ç°" default>
  ```java
  // å®ç°Runnableæ¥å£
  public class TaskRunnable implements Runnable {
      private String taskName;
      
      public TaskRunnable(String taskName) {
          this.taskName = taskName;
      }
      
      @Override
      public void run() {
          System.out.println("ä»»åŠ¡ " + taskName + " å¼€å§‹æ‰§è¡Œ");
          // ä»»åŠ¡ä»£ç ...
          System.out.println("ä»»åŠ¡ " + taskName + " æ‰§è¡Œå®Œæˆ");
      }
  }
  
  // ä½¿ç”¨æ–¹å¼
  TaskRunnable task = new TaskRunnable("æ•°æ®å¤„ç†");
  Thread thread = new Thread(task);
  thread.start();
  ```
  </TabItem>
  <TabItem value="lambda" label="Lambdaè¡¨è¾¾å¼">
  ```java
  // ä½¿ç”¨Lambdaè¡¨è¾¾å¼åˆ›å»ºçº¿ç¨‹
  Thread thread = new Thread(() -> {
      System.out.println("Lambdaçº¿ç¨‹å¼€å§‹æ‰§è¡Œ");
      // ä»»åŠ¡ä»£ç ...
      System.out.println("Lambdaçº¿ç¨‹æ‰§è¡Œå®Œæˆ");
  });
  
  thread.start();
  ```
  </TabItem>
  <TabItem value="method" label="æ–¹æ³•å¼•ç”¨">
  ```java
  public class RunnableExample {
      // ä»»åŠ¡æ–¹æ³•
      public static void performTask() {
          System.out.println("æ–¹æ³•å¼•ç”¨ä»»åŠ¡å¼€å§‹æ‰§è¡Œ");
          // ä»»åŠ¡ä»£ç ...
          System.out.println("æ–¹æ³•å¼•ç”¨ä»»åŠ¡æ‰§è¡Œå®Œæˆ");
      }
      
      public static void main(String[] args) {
          // ä½¿ç”¨æ–¹æ³•å¼•ç”¨
          Thread thread = new Thread(RunnableExample::performTask);
          thread.start();
      }
  }
  ```
  </TabItem>
  <TabItem value="features" label="ç‰¹ç‚¹åˆ†æ">
  <div className="card">
  <div className="card__header">
  <h4>Runnableæ¥å£ç‰¹ç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li><strong>ä¼˜ç‚¹</strong>ï¼šé¿å…å•ç»§æ‰¿é™åˆ¶ï¼Œå¯ä»¥ç»§æ‰¿å…¶ä»–ç±»</li>
  <li><strong>çµæ´»æ€§</strong>ï¼šåŒä¸€ä¸ªRunnableå¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹ä½¿ç”¨</li>
  <li><strong>åˆ†ç¦»å…³æ³¨ç‚¹</strong>ï¼šå°†ä»»åŠ¡é€»è¾‘ä¸çº¿ç¨‹æ§åˆ¶åˆ†ç¦»</li>
  <li><strong>å‡½æ•°å¼é£æ ¼</strong>ï¼šæ”¯æŒLambdaè¡¨è¾¾å¼ï¼Œä»£ç æ›´ç®€æ´</li>
  <li><strong>ç¼ºç‚¹</strong>ï¼šæ— æ³•ç›´æ¥è®¿é—®Threadçš„æ–¹æ³•ï¼Œéœ€è¦é€šè¿‡Thread.currentThread()</li>
  </ul>
  </div>
  </div>
  </TabItem>
</Tabs>

:::tip æœ€ä½³å®è·µ
åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ç°Runnableæ¥å£æ˜¯åˆ›å»ºçº¿ç¨‹çš„æ¨èæ–¹å¼ï¼Œå®ƒæä¾›äº†æ›´å¥½çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚
:::

### 2.3 å®ç°Callableæ¥å£

<Tabs>
  <TabItem value="basic" label="åŸºæœ¬å®ç°" default>
  ```java
  import java.util.concurrent.Callable;
  import java.util.concurrent.FutureTask;
  
  // å®ç°Callableæ¥å£
  public class CalculationTask implements Callable<Integer> {
      private int number;
      
      public CalculationTask(int number) {
          this.number = number;
      }
      
      @Override
      public Integer call() throws Exception {
          System.out.println("è®¡ç®—ä»»åŠ¡å¼€å§‹");
          if (number < 0) {
              throw new IllegalArgumentException("è´Ÿæ•°ä¸æ”¯æŒ");
          }
          int result = number * number;
          System.out.println("è®¡ç®—ç»“æœ: " + result);
          return result;
      }
  }
  
  // ä½¿ç”¨æ–¹å¼
  CalculationTask task = new CalculationTask(10);
  FutureTask<Integer> futureTask = new FutureTask<>(task);
  Thread thread = new Thread(futureTask);
  thread.start();
  
  // è·å–ç»“æœ
  try {
      Integer result = futureTask.get(); // é˜»å¡ç­‰å¾…ç»“æœ
      System.out.println("è·å–åˆ°è®¡ç®—ç»“æœ: " + result);
  } catch (Exception e) {
      e.printStackTrace();
  }
  ```
  </TabItem>
  <TabItem value="lambda" label="Lambdaè¡¨è¾¾å¼">
  ```java
  import java.util.concurrent.Callable;
  import java.util.concurrent.FutureTask;
  
  // ä½¿ç”¨Lambdaè¡¨è¾¾å¼åˆ›å»ºCallable
  Callable<String> callable = () -> {
      System.out.println("Callableä»»åŠ¡å¼€å§‹æ‰§è¡Œ");
      Thread.sleep(2000); // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
      return "ä»»åŠ¡æ‰§è¡Œç»“æœ";
  };
  
  FutureTask<String> futureTask = new FutureTask<>(callable);
  Thread thread = new Thread(futureTask);
  thread.start();
  
  // è·å–ç»“æœ
  try {
      String result = futureTask.get();
      System.out.println("ç»“æœ: " + result);
  } catch (Exception e) {
      e.printStackTrace();
  }
  ```
  </TabItem>
  <TabItem value="timeout" label="è¶…æ—¶å¤„ç†">
  ```java
  import java.util.concurrent.Callable;
  import java.util.concurrent.FutureTask;
  import java.util.concurrent.TimeUnit;
  import java.util.concurrent.TimeoutException;
  
  // é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡
  Callable<String> longTask = () -> {
      Thread.sleep(10000); // 10ç§’
      return "é•¿æ—¶é—´ä»»åŠ¡å®Œæˆ";
  };
  
  FutureTask<String> futureTask = new FutureTask<>(longTask);
  Thread thread = new Thread(futureTask);
  thread.start();
  
  try {
      // è®¾ç½®5ç§’è¶…æ—¶
      String result = futureTask.get(5, TimeUnit.SECONDS);
      System.out.println("ä»»åŠ¡ç»“æœ: " + result);
  } catch (TimeoutException e) {
      System.out.println("ä»»åŠ¡è¶…æ—¶");
      thread.interrupt(); // ä¸­æ–­çº¿ç¨‹
  } catch (Exception e) {
      e.printStackTrace();
  }
  ```
  </TabItem>
  <TabItem value="features" label="ç‰¹ç‚¹åˆ†æ">
  <div className="card">
  <div className="card__header">
  <h4>Callableæ¥å£ç‰¹ç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li><strong>è¿”å›å€¼</strong>ï¼šå¯ä»¥è¿”å›ä»»åŠ¡æ‰§è¡Œç»“æœ</li>
  <li><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šå¯ä»¥æŠ›å‡ºæ£€æŸ¥å‹å¼‚å¸¸</li>
  <li><strong>Futureæ”¯æŒ</strong>ï¼šæ”¯æŒè·å–ç»“æœã€å–æ¶ˆä»»åŠ¡ã€æ£€æŸ¥å®ŒæˆçŠ¶æ€</li>
  <li><strong>è¶…æ—¶æœºåˆ¶</strong>ï¼šæ”¯æŒè®¾ç½®ç­‰å¾…ç»“æœçš„è¶…æ—¶æ—¶é—´</li>
  <li><strong>ç¼ºç‚¹</strong>ï¼šä½¿ç”¨è¾ƒå¤æ‚ï¼Œéœ€è¦é€šè¿‡FutureTaskåŒ…è£…</li>
  </ul>
  </div>
  </div>
  </TabItem>
</Tabs>

## 3. çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸè¯¦è§£

### 3.1 çº¿ç¨‹çŠ¶æ€æ¦‚è¿°

<Tabs>
  <TabItem value="states" label="çº¿ç¨‹çŠ¶æ€" default>
    <div className="card">
    <div className="card__header">
    <h4>Javaçº¿ç¨‹çš„6ç§çŠ¶æ€</h4>
    </div>
    <div className="card__body">
    <ol>
    <li><strong>NEW</strong>ï¼šæ–°åˆ›å»ºçš„çº¿ç¨‹ï¼Œå°šæœªå¯åŠ¨</li>
    <li><strong>RUNNABLE</strong>ï¼šå¯è¿è¡ŒçŠ¶æ€ï¼Œå¯èƒ½æ­£åœ¨è¿è¡Œä¹Ÿå¯èƒ½åœ¨ç­‰å¾…CPUèµ„æº</li>
    <li><strong>BLOCKED</strong>ï¼šé˜»å¡çŠ¶æ€ï¼Œç­‰å¾…è·å–ç›‘è§†å™¨é”</li>
    <li><strong>WAITING</strong>ï¼šç­‰å¾…çŠ¶æ€ï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹æ‰§è¡Œç‰¹å®šæ“ä½œ</li>
    <li><strong>TIMED_WAITING</strong>ï¼šè¶…æ—¶ç­‰å¾…çŠ¶æ€ï¼ŒæŒ‡å®šæ—¶é—´å†…ç­‰å¾…å…¶ä»–çº¿ç¨‹</li>
    <li><strong>TERMINATED</strong>ï¼šç»ˆæ­¢çŠ¶æ€ï¼Œçº¿ç¨‹æ‰§è¡Œå®Œæ¯•</li>
    </ol>
    </div>
    </div>
  </TabItem>
  <TabItem value="code" label="çŠ¶æ€æ£€æŸ¥">
  ```java
  Thread thread = new Thread(() -> {
      try {
          Thread.sleep(2000);
      } catch (InterruptedException e) {
          Thread.currentThread().interrupt();
      }
  });
  
  System.out.println("åˆå§‹çŠ¶æ€: " + thread.getState()); // NEW
  
  thread.start();
  System.out.println("å¯åŠ¨åçŠ¶æ€: " + thread.getState()); // RUNNABLE
  
  try {
      Thread.sleep(1000); // è®©çº¿ç¨‹è¿›å…¥ç¡çœ çŠ¶æ€
      System.out.println("ç¡çœ ä¸­çŠ¶æ€: " + thread.getState()); // TIMED_WAITING
      
      thread.join(); // ç­‰å¾…çº¿ç¨‹ç»“æŸ
      System.out.println("ç»“æŸåçŠ¶æ€: " + thread.getState()); // TERMINATED
  } catch (InterruptedException e) {
      Thread.currentThread().interrupt();
  }
  ```
  </TabItem>
  <TabItem value="table" label="çŠ¶æ€è½¬æ¢">
  | å½“å‰çŠ¶æ€ | è§¦å‘æ¡ä»¶ | ç›®æ ‡çŠ¶æ€ |
  |---------|----------|---------|
  | **NEW** | è°ƒç”¨start()æ–¹æ³• | RUNNABLE |
  | **RUNNABLE** | è·å–synchronizedé”å¤±è´¥ | BLOCKED |
  | **RUNNABLE** | è°ƒç”¨wait()æ–¹æ³• | WAITING |
  | **RUNNABLE** | è°ƒç”¨sleep(time)æˆ–wait(time)æ–¹æ³• | TIMED_WAITING |
  | **BLOCKED** | è·å¾—é” | RUNNABLE |
  | **WAITING** | è°ƒç”¨notify/notifyAll | RUNNABLE/BLOCKED |
  | **TIMED_WAITING** | è¶…æ—¶æˆ–è¢«å”¤é†’ | RUNNABLE/BLOCKED |
  | **RUNNABLE** | æ‰§è¡Œå®Œæˆ | TERMINATED |
  </TabItem>
</Tabs>

### 3.2 çº¿ç¨‹çŠ¶æ€è½¬æ¢å›¾

```mermaid
stateDiagram-v2
    [*] --> NEW: åˆ›å»ºçº¿ç¨‹
    NEW --> RUNNABLE: start()
    RUNNABLE --> BLOCKED: ç­‰å¾…é”
    BLOCKED --> RUNNABLE: è·å¾—é”
    RUNNABLE --> WAITING: wait()/join()
    WAITING --> RUNNABLE: notify()/notifyAll()
    RUNNABLE --> TIMED_WAITING: sleep(time)/wait(time)
    TIMED_WAITING --> RUNNABLE: è¶…æ—¶/è¢«å”¤é†’
    RUNNABLE --> [*]: æ‰§è¡Œå®Œæ¯•
    
    note right of NEW: çº¿ç¨‹è¢«åˆ›å»ºæœªå¯åŠ¨
    note right of RUNNABLE: çº¿ç¨‹æ­£åœ¨è¿è¡Œæˆ–ç­‰å¾…CPU
    note right of BLOCKED: çº¿ç¨‹ç­‰å¾…ç›‘è§†å™¨é”
    note right of WAITING: æ— é™æœŸç­‰å¾…
    note right of TIMED_WAITING: é™æ—¶ç­‰å¾…
```

### 3.3 çº¿ç¨‹çŠ¶æ€ç¤ºä¾‹

<details>
<summary><strong>BLOCKEDçŠ¶æ€ç¤ºä¾‹</strong></summary>

```java
public class BlockedStateExample {
    private static final Object lock = new Object();
    
    public static void main(String[] args) throws InterruptedException {
        Thread thread1 = new Thread(() -> {
            synchronized (lock) {
                System.out.println("çº¿ç¨‹1è·å¾—é”");
                try {
                    Thread.sleep(5000); // æŒæœ‰é”5ç§’
                } catch (InterruptedException e) {
                    Thread.currentThread().interrupt();
                }
            }
        });
        
        // çº¿ç¨‹2å°†è¢«é˜»å¡
        Thread thread2 = new Thread(() -> {
            synchronized (lock) {
                System.out.println("çº¿ç¨‹2è·å¾—é”");
            }
        });
        
        thread1.start();
        Thread.sleep(100); // ç¡®ä¿çº¿ç¨‹1å…ˆå¯åŠ¨
        
        thread2.start();
        Thread.sleep(1000); // ç»™çº¿ç¨‹2æ—¶é—´è¿›å…¥BLOCKEDçŠ¶æ€
        
        System.out.println("çº¿ç¨‹2çŠ¶æ€: " + thread2.getState()); // è¾“å‡ºBLOCKED
    }
}
```
</details>

<details>
<summary><strong>WAITINGçŠ¶æ€ç¤ºä¾‹</strong></summary>

```java
public class WaitingStateExample {
    private static final Object lock = new Object();
    
    public static void main(String[] args) throws InterruptedException {
        Thread waitingThread = new Thread(() -> {
            synchronized (lock) {
                try {
                    System.out.println("ç­‰å¾…çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€");
                    lock.wait(); // è¿›å…¥WAITINGçŠ¶æ€
                    System.out.println("ç­‰å¾…çº¿ç¨‹è¢«å”¤é†’");
                } catch (InterruptedException e) {
                    Thread.currentThread().interrupt();
                }
            }
        });
        
        Thread notifyThread = new Thread(() -> {
            try {
                Thread.sleep(2000); // ç­‰å¾…2ç§’
                synchronized (lock) {
                    System.out.println("é€šçŸ¥çº¿ç¨‹å”¤é†’ç­‰å¾…çº¿ç¨‹");
                    lock.notify();
                }
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
        });
        
        waitingThread.start();
        Thread.sleep(500); // ç¡®ä¿ç­‰å¾…çº¿ç¨‹å…ˆæ‰§è¡Œ
        System.out.println("ç­‰å¾…çº¿ç¨‹çŠ¶æ€: " + waitingThread.getState()); // è¾“å‡ºWAITING
        
        notifyThread.start();
    }
}
```
</details>

<details>
<summary><strong>TIMED_WAITINGçŠ¶æ€ç¤ºä¾‹</strong></summary>

```java
public class TimedWaitingStateExample {
    public static void main(String[] args) throws InterruptedException {
        Thread sleepingThread = new Thread(() -> {
            try {
                System.out.println("çº¿ç¨‹å¼€å§‹ç¡çœ 5ç§’");
                Thread.sleep(5000);
                System.out.println("çº¿ç¨‹ç¡çœ ç»“æŸ");
            } catch (InterruptedException e) {
                System.out.println("çº¿ç¨‹ç¡çœ è¢«ä¸­æ–­");
                Thread.currentThread().interrupt();
            }
        });
        
        sleepingThread.start();
        Thread.sleep(1000); // ç»™çº¿ç¨‹æ—¶é—´è¿›å…¥TIMED_WAITINGçŠ¶æ€
        
        System.out.println("çº¿ç¨‹çŠ¶æ€: " + sleepingThread.getState()); // è¾“å‡ºTIMED_WAITING
    }
}
```
</details>

## 4. çº¿ç¨‹æ§åˆ¶æ–¹æ³•è¯¦è§£

### 4.1 çº¿ç¨‹æ§åˆ¶æ ¸å¿ƒæ–¹æ³•

<div className="card">
<div className="card__body">

| æ§åˆ¶æ–¹æ³• | æè¿° | æ³¨æ„äº‹é¡¹ |
|---------|------|---------|
| **start()** | å¯åŠ¨çº¿ç¨‹ï¼Œä½¿çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ | ä¸èƒ½å¤šæ¬¡è°ƒç”¨åŒä¸€çº¿ç¨‹çš„start() |
| **join()** | ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢ | å¯èƒ½å¯¼è‡´è°ƒç”¨çº¿ç¨‹é˜»å¡ |
| **join(long)** | ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢ï¼Œæœ‰è¶…æ—¶æ—¶é—´ | è¶…æ—¶åç»§ç»­æ‰§è¡Œï¼Œä¸ç®¡çº¿ç¨‹æ˜¯å¦å®Œæˆ |
| **sleep(long)** | å½“å‰çº¿ç¨‹ä¼‘çœ æŒ‡å®šæ—¶é—´ | ä¸ä¼šé‡Šæ”¾å¯¹è±¡é” |
| **yield()** | æç¤ºçº¿ç¨‹è°ƒåº¦å™¨è®©å‡ºCPUæ‰§è¡Œæƒ | åªæ˜¯æç¤ºï¼Œè°ƒåº¦å™¨å¯èƒ½å¿½ç•¥ |
| **interrupt()** | ä¸­æ–­çº¿ç¨‹ | è®¾ç½®çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ |
| **isInterrupted()** | æ£€æŸ¥çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ | ä¸ä¼šæ¸…é™¤ä¸­æ–­çŠ¶æ€ |
| **interrupted()** | æ£€æŸ¥å½“å‰çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ | ä¼šæ¸…é™¤ä¸­æ–­çŠ¶æ€ |

</div>
</div>

### 4.2 çº¿ç¨‹ä¸­æ–­æœºåˆ¶

<Tabs>
  <TabItem value="basic" label="åŸºæœ¬ä¸­æ–­" default>
  ```java
  // å¯ä¸­æ–­çš„çº¿ç¨‹ä»»åŠ¡
  Thread thread = new Thread(() -> {
      while (!Thread.currentThread().isInterrupted()) {
          try {
              System.out.println("çº¿ç¨‹å·¥ä½œä¸­...");
              Thread.sleep(1000);
          } catch (InterruptedException e) {
              System.out.println("çº¿ç¨‹è¢«ä¸­æ–­");
              // é‡æ–°è®¾ç½®ä¸­æ–­çŠ¶æ€ï¼ˆå› ä¸ºInterruptedExceptionä¼šæ¸…é™¤ä¸­æ–­çŠ¶æ€ï¼‰
              Thread.currentThread().interrupt();
              break;
          }
      }
      System.out.println("çº¿ç¨‹é€€å‡º");
  });
  
  thread.start();
  
  // ç­‰å¾…ä¸€æ®µæ—¶é—´åä¸­æ–­çº¿ç¨‹
  try {
      Thread.sleep(3000);
      thread.interrupt(); // ä¸­æ–­çº¿ç¨‹
  } catch (InterruptedException e) {
      Thread.currentThread().interrupt();
  }
  ```
  </TabItem>
  <TabItem value="polling" label="è½®è¯¢ä¸­æ–­çŠ¶æ€">
  ```java
  Thread thread = new Thread(() -> {
      // å¾ªç¯æ£€æŸ¥ä¸­æ–­çŠ¶æ€
      while (!Thread.currentThread().isInterrupted()) {
          // æ‰§è¡Œä¸€æ®µéé˜»å¡æ“ä½œ
          System.out.println("æ‰§è¡Œè®¡ç®—ä»»åŠ¡...");
          
          // æ¨¡æ‹Ÿè®¡ç®—å·¥ä½œ
          long sum = 0;
          for (int i = 0; i < 1000000; i++) {
              sum += i;
          }
          
          // åœ¨é€‚å½“çš„æ£€æŸ¥ç‚¹æ£€æŸ¥ä¸­æ–­
          if (Thread.currentThread().isInterrupted()) {
              System.out.println("æ£€æµ‹åˆ°ä¸­æ–­ï¼Œå‡†å¤‡é€€å‡º");
              break;
          }
      }
      System.out.println("çº¿ç¨‹æ­£å¸¸é€€å‡º");
  });
  
  thread.start();
  thread.interrupt(); // ä¸­æ–­çº¿ç¨‹
  ```
  </TabItem>
  <TabItem value="flag" label="è‡ªå®šä¹‰æ ‡å¿—">
  ```java
  public class ControlledThread extends Thread {
      private volatile boolean running = true;
      
      public void stopThread() {
          running = false;
      }
      
      @Override
      public void run() {
          while (running) {
              System.out.println("çº¿ç¨‹è¿è¡Œä¸­...");
              try {
                  Thread.sleep(500);
              } catch (InterruptedException e) {
                  System.out.println("ç¡çœ è¢«ä¸­æ–­");
              }
          }
          System.out.println("çº¿ç¨‹åœæ­¢");
      }
  }
  
  // ä½¿ç”¨æ–¹å¼
  ControlledThread thread = new ControlledThread();
  thread.start();
  
  // ç­‰å¾…ä¸€æ®µæ—¶é—´ååœæ­¢çº¿ç¨‹
  try {
      Thread.sleep(2000);
      thread.stopThread(); // ä¼˜é›…åœæ­¢
  } catch (InterruptedException e) {
      Thread.currentThread().interrupt();
  }
  ```
  </TabItem>
</Tabs>

:::caution æ³¨æ„äº‹é¡¹
1. æ°¸è¿œä¸è¦ä½¿ç”¨å·²åºŸå¼ƒçš„`Thread.stop()`ã€`Thread.suspend()`å’Œ`Thread.resume()`æ–¹æ³•
2. ä¸­æ–­æ˜¯ä¸€ç§**åä½œæœºåˆ¶**ï¼Œä¸ä¼šå¼ºåˆ¶ç»ˆæ­¢çº¿ç¨‹
3. çº¿ç¨‹åœ¨`InterruptedException`å¼‚å¸¸å¤„ç†ä¸­åº”å½“é‡æ–°è®¾ç½®ä¸­æ–­çŠ¶æ€æˆ–ä¼ é€’å¼‚å¸¸
:::

### 4.3 çº¿ç¨‹ç­‰å¾…ä¸é€šçŸ¥

<details>
<summary><strong>wait/notifyæœºåˆ¶è¯¦è§£</strong></summary>

```mermaid
sequenceDiagram
    participant çº¿ç¨‹A as çº¿ç¨‹A
    participant å¯¹è±¡é” as å…±äº«å¯¹è±¡é”
    participant çº¿ç¨‹B as çº¿ç¨‹B
    
    çº¿ç¨‹A->>å¯¹è±¡é”: è·å–é”(synchronized)
    çº¿ç¨‹B-->>å¯¹è±¡é”: å°è¯•è·å–é”(è¢«é˜»å¡)
    çº¿ç¨‹A->>å¯¹è±¡é”: è°ƒç”¨wait()
    Note over çº¿ç¨‹A,å¯¹è±¡é”: çº¿ç¨‹Aé‡Šæ”¾é”å¹¶è¿›å…¥ç­‰å¾…é˜Ÿåˆ—
    çº¿ç¨‹B->>å¯¹è±¡é”: è·å¾—é”å¹¶æ‰§è¡Œ
    çº¿ç¨‹B->>å¯¹è±¡é”: è°ƒç”¨notify()
    Note over å¯¹è±¡é”,çº¿ç¨‹A: çº¿ç¨‹Aè¢«å”¤é†’ï¼Œç­‰å¾…é‡æ–°è·å–é”
    çº¿ç¨‹B->>å¯¹è±¡é”: æ‰§è¡Œå®Œæ¯•ï¼Œé‡Šæ”¾é”
    çº¿ç¨‹A->>å¯¹è±¡é”: é‡æ–°è·å¾—é”ï¼Œä»wait()è¿”å›ç»§ç»­æ‰§è¡Œ
```

**é‡è¦è¯´æ˜ï¼š**
1. `wait()`ã€`notify()`å’Œ`notifyAll()`æ–¹æ³•å¿…é¡»åœ¨**åŒæ­¥ä»£ç å—**æˆ–**åŒæ­¥æ–¹æ³•**ä¸­è°ƒç”¨
2. è¿™äº›æ–¹æ³•æ˜¯`Object`ç±»çš„æ–¹æ³•ï¼Œä¸æ˜¯`Thread`ç±»çš„æ–¹æ³•
3. `wait()`ä¼šé‡Šæ”¾é”ï¼Œè€Œ`sleep()`ä¸ä¼šé‡Šæ”¾é”
4. è°ƒç”¨`notify()`åï¼Œè¢«é€šçŸ¥çš„çº¿ç¨‹ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯éœ€è¦ç­‰å¾…å½“å‰çº¿ç¨‹é‡Šæ”¾é”

</details>

```java title="ç­‰å¾…/é€šçŸ¥ç¤ºä¾‹"
public class WaitNotifyExample {
    private static final Object lock = new Object();
    private static boolean dataReady = false;
    private static String data = null;
    
    public static void main(String[] args) {
        // æ¶ˆè´¹è€…çº¿ç¨‹
        Thread consumer = new Thread(() -> {
            synchronized (lock) {
                System.out.println("æ¶ˆè´¹è€…ç­‰å¾…æ•°æ®...");
                while (!dataReady) { // ä½¿ç”¨å¾ªç¯æ£€æŸ¥æ¡ä»¶é˜²æ­¢è™šå‡å”¤é†’
                    try {
                        lock.wait(); // é‡Šæ”¾é”å¹¶ç­‰å¾…
                    } catch (InterruptedException e) {
                        Thread.currentThread().interrupt();
                        return;
                    }
                }
                System.out.println("æ¶ˆè´¹è€…æ¶ˆè´¹æ•°æ®: " + data);
            }
        });
        
        // ç”Ÿäº§è€…çº¿ç¨‹
        Thread producer = new Thread(() -> {
            try {
                Thread.sleep(2000); // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
                return;
            }
            
            synchronized (lock) {
                data = "é‡è¦æ•°æ®";
                dataReady = true;
                System.out.println("ç”Ÿäº§è€…å‡†å¤‡æ•°æ®: " + data);
                lock.notify(); // é€šçŸ¥ç­‰å¾…çš„æ¶ˆè´¹è€…
            }
        });
        
        consumer.start();
        producer.start();
    }
}
```

### 4.4 çº¿ç¨‹ä¼˜å…ˆçº§å’Œå®ˆæŠ¤çº¿ç¨‹

<Tabs>
  <TabItem value="priority" label="çº¿ç¨‹ä¼˜å…ˆçº§" default>
  ```java
  public class ThreadPriorityExample {
      public static void main(String[] args) {
          // åˆ›å»ºä¸‰ä¸ªä¼˜å…ˆçº§ä¸åŒçš„çº¿ç¨‹
          Thread lowPriority = new Thread(() -> {
              for (int i = 0; i < 5; i++) {
                  System.out.println("ä½ä¼˜å…ˆçº§çº¿ç¨‹: " + i);
                  Thread.yield(); // æç¤ºå¯ä»¥è®©å‡ºCPU
              }
          });
          
          Thread normalPriority = new Thread(() -> {
              for (int i = 0; i < 5; i++) {
                  System.out.println("æ™®é€šä¼˜å…ˆçº§çº¿ç¨‹: " + i);
                  Thread.yield();
              }
          });
          
          Thread highPriority = new Thread(() -> {
              for (int i = 0; i < 5; i++) {
                  System.out.println("é«˜ä¼˜å…ˆçº§çº¿ç¨‹: " + i);
                  Thread.yield();
              }
          });
          
          // è®¾ç½®ä¼˜å…ˆçº§
          lowPriority.setPriority(Thread.MIN_PRIORITY); // 1
          normalPriority.setPriority(Thread.NORM_PRIORITY); // 5
          highPriority.setPriority(Thread.MAX_PRIORITY); // 10
          
          // å¯åŠ¨çº¿ç¨‹
          lowPriority.start();
          normalPriority.start();
          highPriority.start();
      }
  }
  ```
  </TabItem>
  <TabItem value="daemon" label="å®ˆæŠ¤çº¿ç¨‹">
  ```java
  public class DaemonThreadExample {
      public static void main(String[] args) {
          // åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹
          Thread daemonThread = new Thread(() -> {
              while (true) {
                  try {
                      System.out.println("å®ˆæŠ¤çº¿ç¨‹è¿è¡Œä¸­...");
                      Thread.sleep(1000);
                  } catch (InterruptedException e) {
                      break;
                  }
              }
          });
          
          // è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼ˆå¿…é¡»åœ¨startå‰è®¾ç½®ï¼‰
          daemonThread.setDaemon(true);
          daemonThread.start();
          
          // ä¸»çº¿ç¨‹ï¼ˆç”¨æˆ·çº¿ç¨‹ï¼‰
          try {
              System.out.println("ä¸»çº¿ç¨‹è¿è¡Œ3ç§’åé€€å‡º");
              Thread.sleep(3000);
          } catch (InterruptedException e) {
              Thread.currentThread().interrupt();
          }
          
          System.out.println("ä¸»çº¿ç¨‹é€€å‡ºï¼Œå®ˆæŠ¤çº¿ç¨‹å°†è‡ªåŠ¨ç»ˆæ­¢");
      }
  }
  ```
  </TabItem>
</Tabs>

:::tip å®ˆæŠ¤çº¿ç¨‹ç‰¹ç‚¹
1. å®ˆæŠ¤çº¿ç¨‹çš„ä¼˜å…ˆçº§è¾ƒä½ï¼Œä½†å…·ä½“è°ƒåº¦å–å†³äºæ“ä½œç³»ç»Ÿ
2. å½“JVMä¸­åªå‰©ä¸‹å®ˆæŠ¤çº¿ç¨‹æ—¶ï¼ŒJVMå°†é€€å‡º
3. å…¸å‹çš„å®ˆæŠ¤çº¿ç¨‹å¦‚åƒåœ¾å›æ”¶å™¨ã€JITç¼–è¯‘å™¨çº¿ç¨‹
4. å®ˆæŠ¤çº¿ç¨‹åˆ›å»ºçš„çº¿ç¨‹ä¹Ÿæ˜¯å®ˆæŠ¤çº¿ç¨‹
:::

## 5. å®é™…åº”ç”¨åœºæ™¯

### 5.1 å¹¶è¡Œè®¡ç®—

<Tabs>
  <TabItem value="calculation" label="å¹¶è¡Œæ•°ç»„è®¡ç®—" default>
  ```java
  public class ParallelCalculation {
      public static void main(String[] args) {
          int[] numbers = new int[10_000_000]; // ä¸€åƒä¸‡ä¸ªæ•°
          // åˆå§‹åŒ–æ•°ç»„
          for (int i = 0; i < numbers.length; i++) {
              numbers[i] = i + 1;
          }
          
          // ä½¿ç”¨å¤šçº¿ç¨‹å¹¶è¡Œè®¡ç®—
          int processors = Runtime.getRuntime().availableProcessors();
          System.out.println("CPUæ ¸å¿ƒæ•°: " + processors);
          
          // åˆ›å»ºçº¿ç¨‹æ± 
          ParallelCalculator[] calculators = new ParallelCalculator[processors];
          Thread[] threads = new Thread[processors];
          int segmentSize = numbers.length / processors;
          
          long startTime = System.currentTimeMillis();
          
          // åˆ†é…ä»»åŠ¡å¹¶å¯åŠ¨çº¿ç¨‹
          for (int i = 0; i < processors; i++) {
              int startIndex = i * segmentSize;
              int endIndex = (i == processors - 1) ? numbers.length : (i + 1) * segmentSize;
              
              calculators[i] = new ParallelCalculator(numbers, startIndex, endIndex);
              threads[i] = new Thread(calculators[i]);
              threads[i].start();
          }
          
          // ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆå¹¶åˆå¹¶ç»“æœ
          long sum = 0;
          for (int i = 0; i < processors; i++) {
              try {
                  threads[i].join();
                  sum += calculators[i].getResult();
              } catch (InterruptedException e) {
                  Thread.currentThread().interrupt();
              }
          }
          
          long endTime = System.currentTimeMillis();
          System.out.println("å¹¶è¡Œè®¡ç®—ç»“æœ: " + sum);
          System.out.println("è€—æ—¶: " + (endTime - startTime) + "ms");
      }
      
      static class ParallelCalculator implements Runnable {
          private final int[] numbers;
          private final int startIndex;
          private final int endIndex;
          private long result = 0;
          
          public ParallelCalculator(int[] numbers, int startIndex, int endIndex) {
              this.numbers = numbers;
              this.startIndex = startIndex;
              this.endIndex = endIndex;
          }
          
          @Override
          public void run() {
              for (int i = startIndex; i < endIndex; i++) {
                  result += numbers[i];
              }
          }
          
          public long getResult() {
              return result;
          }
      }
  }
  ```
  </TabItem>
  <TabItem value="processing" label="å¹¶è¡Œæ–‡ä»¶å¤„ç†">
  ```java
  import java.io.*;
  import java.nio.file.*;
  import java.util.concurrent.*;
  
  public class ParallelFileProcessor {
      public static void main(String[] args) {
          final Path directory = Paths.get("./data");
          final String searchKeyword = "important";
          
          try {
              // è·å–ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶
              if (!Files.exists(directory)) {
                  System.err.println("ç›®å½•ä¸å­˜åœ¨: " + directory);
                  return;
              }
              
              File[] files = directory.toFile().listFiles();
              if (files == null || files.length == 0) {
                  System.out.println("æ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶");
                  return;
              }
              
              // åˆ›å»ºçº¿ç¨‹æ± å¹¶è¡Œå¤„ç†æ–‡ä»¶
              int threadCount = Math.min(files.length, Runtime.getRuntime().availableProcessors());
              ExecutorService executor = Executors.newFixedThreadPool(threadCount);
              CountDownLatch latch = new CountDownLatch(files.length);
              
              // æäº¤æœç´¢ä»»åŠ¡
              for (File file : files) {
                  if (file.isFile()) {
                      executor.submit(() -> {
                          try {
                              long occurrences = searchInFile(file, searchKeyword);
                              System.out.println("æ–‡ä»¶ " + file.getName() + 
                                               " ä¸­æ‰¾åˆ° " + occurrences + " ä¸ªåŒ¹é…é¡¹");
                          } finally {
                              latch.countDown();
                          }
                      });
                  } else {
                      latch.countDown();
                  }
              }
              
              // ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
              latch.await();
              System.out.println("æ‰€æœ‰æ–‡ä»¶å¤„ç†å®Œæˆ");
              
              // å…³é—­çº¿ç¨‹æ± 
              executor.shutdown();
              
          } catch (IOException | InterruptedException e) {
              e.printStackTrace();
          }
      }
      
      private static long searchInFile(File file, String keyword) throws IOException {
          long count = 0;
          try (BufferedReader reader = new BufferedReader(new FileReader(file))) {
              String line;
              while ((line = reader.readLine()) != null) {
                  if (line.contains(keyword)) {
                      count++;
                  }
              }
          }
          return count;
      }
  }
  ```
  </TabItem>
</Tabs>

### 5.2 å¼‚æ­¥ä»»åŠ¡å¤„ç†

<div className="code-with-callout">

```java
import java.util.concurrent.*;
import java.util.ArrayList;
import java.util.List;

public class AsyncTaskProcessing {
    private final int MAX_TASKS = 10;
    private final BlockingQueue<Runnable> taskQueue = new LinkedBlockingQueue<>();
    private final List<WorkerThread> workers = new ArrayList<>();
    private volatile boolean isRunning = true;
    
    public AsyncTaskProcessing(int workerCount) {
        // åˆ›å»ºå¹¶å¯åŠ¨å·¥ä½œçº¿ç¨‹
        for (int i = 0; i < workerCount; i++) {
            WorkerThread worker = new WorkerThread("Worker-" + i);
            workers.add(worker);
            worker.start();
        }
    }
    
    // æäº¤ä»»åŠ¡
    public void submitTask(Runnable task) throws InterruptedException {
        if (!isRunning) {
            throw new RejectedExecutionException("ä»»åŠ¡å¤„ç†å™¨å·²å…³é—­");
        }
        taskQueue.put(task);
    }
    
    // å…³é—­ä»»åŠ¡å¤„ç†å™¨
    public void shutdown() {
        isRunning = false;
        for (WorkerThread worker : workers) {
            worker.interrupt();
        }
    }
    
    // å·¥ä½œçº¿ç¨‹
    private class WorkerThread extends Thread {
        public WorkerThread(String name) {
            super(name);
        }
        
        @Override
        public void run() {
            while (isRunning || !taskQueue.isEmpty()) {
                try {
                    Runnable task = taskQueue.poll(1, TimeUnit.SECONDS);
                    if (task != null) {
                        System.out.println(getName() + " å¤„ç†ä»»åŠ¡...");
                        task.run();
                    }
                } catch (InterruptedException e) {
                    System.out.println(getName() + " è¢«ä¸­æ–­");
                    Thread.currentThread().interrupt();
                    break;
                } catch (Exception e) {
                    System.err.println(getName() + " æ‰§è¡Œä»»åŠ¡æ—¶å‡ºé”™: " + e.getMessage());
                }
            }
            System.out.println(getName() + " å·²ç»ˆæ­¢");
        }
    }
    
    // ä½¿ç”¨ç¤ºä¾‹
    public static void main(String[] args) {
        AsyncTaskProcessing processor = new AsyncTaskProcessing(3);
        
        try {
            // æäº¤å¤šä¸ªä»»åŠ¡
            for (int i = 0; i < 10; i++) {
                final int taskId = i;
                processor.submitTask(() -> {
                    try {
                        System.out.println("æ‰§è¡Œä»»åŠ¡ " + taskId);
                        Thread.sleep((long) (Math.random() * 1000));
                        System.out.println("ä»»åŠ¡ " + taskId + " å®Œæˆ");
                    } catch (InterruptedException e) {
                        Thread.currentThread().interrupt();
                    }
                });
            }
            
            // ç­‰å¾…ä¸€æ®µæ—¶é—´åå…³é—­å¤„ç†å™¨
            Thread.sleep(5000);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        } finally {
            processor.shutdown();
        }
    }
}
```

:::info å¼‚æ­¥ä»»åŠ¡å¤„ç†çš„ä¼˜åŠ¿
1. **éé˜»å¡æ“ä½œ**ï¼šæäº¤ä»»åŠ¡åç«‹å³è¿”å›ï¼Œä¸ç­‰å¾…ä»»åŠ¡å®Œæˆ
2. **å¹¶å‘å¤„ç†**ï¼šå¯åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œæé«˜ååé‡
3. **èµ„æºæ§åˆ¶**ï¼šé€šè¿‡å·¥ä½œçº¿ç¨‹æ•°é‡é™åˆ¶å¹¶å‘é‡
4. **ä¼˜é›…å…³é—­**ï¼šæ”¯æŒå®Œæˆå·²æäº¤ä»»åŠ¡åå…³é—­
:::

</div>

### 5.3 å®æ—¶äº‹ä»¶å¤„ç†

<details>
<summary><strong>å®æ—¶äº‹ä»¶å¤„ç†æ¶æ„</strong></summary>

```mermaid
graph TD
    A[äº‹ä»¶æº] -->|äº§ç”Ÿäº‹ä»¶| B[äº‹ä»¶é˜Ÿåˆ—]
    B -->|åˆ†å‘äº‹ä»¶| C[äº‹ä»¶åˆ†å‘å™¨çº¿ç¨‹]
    C -->|å¤„ç†| D[äº‹ä»¶å¤„ç†å™¨1]
    C -->|å¤„ç†| E[äº‹ä»¶å¤„ç†å™¨2]
    C -->|å¤„ç†| F[äº‹ä»¶å¤„ç†å™¨3]
    D --> G[ç»“æœå¤„ç†]
    E --> G
    F --> G
```

**å…³é”®ç»„ä»¶ï¼š**
1. **äº‹ä»¶æº**ï¼šäº§ç”Ÿéœ€è¦å¤„ç†çš„äº‹ä»¶
2. **äº‹ä»¶é˜Ÿåˆ—**ï¼šå­˜å‚¨å¾…å¤„ç†çš„äº‹ä»¶
3. **äº‹ä»¶åˆ†å‘å™¨**ï¼šç‹¬ç«‹çº¿ç¨‹ï¼Œä»é˜Ÿåˆ—å–å‡ºäº‹ä»¶å¹¶åˆ†å‘
4. **äº‹ä»¶å¤„ç†å™¨**ï¼šå¤„ç†ç‰¹å®šç±»å‹çš„äº‹ä»¶
5. **ç»“æœå¤„ç†**ï¼šæ±‡æ€»å¤„ç†ç»“æœ

</details>

```java
public class EventProcessor {
    private final BlockingQueue<Event> eventQueue = new LinkedBlockingQueue<>();
    private final Map<EventType, EventHandler> handlers = new HashMap<>();
    private final Thread dispatcherThread;
    private volatile boolean running = true;
    
    public EventProcessor() {
        // æ³¨å†Œäº‹ä»¶å¤„ç†å™¨
        handlers.put(EventType.USER_ACTION, new UserActionHandler());
        handlers.put(EventType.SYSTEM_ALERT, new SystemAlertHandler());
        handlers.put(EventType.DATA_CHANGE, new DataChangeHandler());
        
        // åˆ›å»ºåˆ†å‘çº¿ç¨‹
        dispatcherThread = new Thread(() -> {
            while (running) {
                try {
                    Event event = eventQueue.take();
                    processEvent(event);
                } catch (InterruptedException e) {
                    Thread.currentThread().interrupt();
                    break;
                }
            }
        }, "EventDispatcher");
        
        dispatcherThread.start();
    }
    
    public void submitEvent(Event event) {
        try {
            eventQueue.put(event);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
    
    private void processEvent(Event event) {
        EventHandler handler = handlers.get(event.getType());
        if (handler != null) {
            try {
                handler.handle(event);
            } catch (Exception e) {
                System.err.println("å¤„ç†äº‹ä»¶æ—¶å‡ºé”™: " + e.getMessage());
            }
        } else {
            System.out.println("æœªæ‰¾åˆ°äº‹ä»¶å¤„ç†å™¨: " + event.getType());
        }
    }
    
    public void shutdown() {
        running = false;
        dispatcherThread.interrupt();
    }
    
    // äº‹ä»¶ç±»å‹å’Œå¤„ç†å™¨æ¥å£ (ä¸ºç®€åŒ–ç¤ºä¾‹ä»…å±•ç¤ºéª¨æ¶)
    enum EventType { USER_ACTION, SYSTEM_ALERT, DATA_CHANGE }
    
    static class Event {
        private final EventType type;
        private final Object data;
        
        public Event(EventType type, Object data) {
            this.type = type;
            this.data = data;
        }
        
        public EventType getType() { return type; }
        public Object getData() { return data; }
    }
    
    interface EventHandler {
        void handle(Event event);
    }
    
    // å…·ä½“å¤„ç†å™¨å®ç°
    static class UserActionHandler implements EventHandler {
        @Override
        public void handle(Event event) {
            System.out.println("å¤„ç†ç”¨æˆ·åŠ¨ä½œ: " + event.getData());
        }
    }
    
    static class SystemAlertHandler implements EventHandler {
        @Override
        public void handle(Event event) {
            System.out.println("å¤„ç†ç³»ç»Ÿè­¦æŠ¥: " + event.getData());
        }
    }
    
    static class DataChangeHandler implements EventHandler {
        @Override
        public void handle(Event event) {
            System.out.println("å¤„ç†æ•°æ®å˜æ›´: " + event.getData());
        }
    }
}
```

## 6. çº¿ç¨‹å®‰å…¨å’Œæœ€ä½³å®è·µ

### 6.1 çº¿ç¨‹å®‰å…¨é—®é¢˜

<Tabs>
  <TabItem value="problem" label="ç«æ€æ¡ä»¶é—®é¢˜" default>
  ```java
  // éçº¿ç¨‹å®‰å…¨çš„è®¡æ•°å™¨
  public class UnsafeCounter {
      private int count = 0;
      
      public void increment() {
          count++; // éåŸå­æ“ä½œï¼Œå¯èƒ½å¯¼è‡´ç«æ€æ¡ä»¶
      }
      
      public int getCount() {
          return count;
      }
      
      public static void main(String[] args) throws InterruptedException {
          UnsafeCounter counter = new UnsafeCounter();
          
          // åˆ›å»ºå¤šä¸ªçº¿ç¨‹åŒæ—¶é€’å¢è®¡æ•°å™¨
          Thread[] threads = new Thread[1000];
          for (int i = 0; i < threads.length; i++) {
              threads[i] = new Thread(() -> {
                  for (int j = 0; j < 1000; j++) {
                      counter.increment();
                  }
              });
              threads[i].start();
          }
          
          // ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
          for (Thread thread : threads) {
              thread.join();
          }
          
          // ç†è®ºä¸Šç»“æœåº”è¯¥æ˜¯1,000,000ï¼Œä½†å®é™…å¯èƒ½å°äºè¿™ä¸ªå€¼
          System.out.println("è®¡æ•°å™¨æœ€ç»ˆå€¼: " + counter.getCount());
      }
  }
  ```
  </TabItem>
  <TabItem value="solution" label="çº¿ç¨‹å®‰å…¨è§£å†³æ–¹æ¡ˆ">
  ```java
  import java.util.concurrent.atomic.AtomicInteger;
  
  // çº¿ç¨‹å®‰å…¨çš„è®¡æ•°å™¨ï¼šä½¿ç”¨synchronized
  public class ThreadSafeCounter {
      private int syncCount = 0;
      private final AtomicInteger atomicCount = new AtomicInteger(0);
      
      // æ–¹æ¡ˆ1: ä½¿ç”¨synchronized
      public synchronized void incrementSync() {
          syncCount++;
      }
      
      public synchronized int getSyncCount() {
          return syncCount;
      }
      
      // æ–¹æ¡ˆ2: ä½¿ç”¨AtomicInteger
      public void incrementAtomic() {
          atomicCount.incrementAndGet();
      }
      
      public int getAtomicCount() {
          return atomicCount.get();
      }
      
      public static void main(String[] args) throws InterruptedException {
          ThreadSafeCounter counter = new ThreadSafeCounter();
          
          // åˆ›å»ºå¤šä¸ªçº¿ç¨‹
          Thread[] threads = new Thread[1000];
          for (int i = 0; i < threads.length; i++) {
              threads[i] = new Thread(() -> {
                  for (int j = 0; j < 1000; j++) {
                      counter.incrementSync();
                      counter.incrementAtomic();
                  }
              });
              threads[i].start();
          }
          
          // ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
          for (Thread thread : threads) {
              thread.join();
          }
          
          System.out.println("synchronizedè®¡æ•°å™¨: " + counter.getSyncCount());
          System.out.println("AtomicIntegerè®¡æ•°å™¨: " + counter.getAtomicCount());
      }
  }
  ```
  </TabItem>
</Tabs>

### 6.2 çº¿ç¨‹å®‰å…¨æ€§ç­–ç•¥

<div className="card">
<div className="card__header">
<h4>ç¡®ä¿çº¿ç¨‹å®‰å…¨çš„ç­–ç•¥</h4>
</div>
<div className="card__body">

1. **ä¸å¯å˜æ€§**ï¼šä½¿ç”¨ä¸å¯å˜å¯¹è±¡é¿å…çŠ¶æ€å˜åŒ–
2. **çº¿ç¨‹å°é—­**ï¼šå°†æ•°æ®é™åˆ¶åœ¨å•ä¸ªçº¿ç¨‹å†…ä½¿ç”¨
3. **åŒæ­¥æœºåˆ¶**ï¼š
   - ä½¿ç”¨synchronizedåŒæ­¥è®¿é—®å…±äº«æ•°æ®
   - ä½¿ç”¨æ˜¾å¼é”(ReentrantLockç­‰)ç®¡ç†è®¿é—®
   - volatileå˜é‡ç¡®ä¿å¯è§æ€§
   - åŸå­ç±»é¿å…å¤åˆæ“ä½œé—®é¢˜
4. **çº¿ç¨‹å®‰å…¨é›†åˆ**ï¼šä½¿ç”¨å¹¶å‘å®¹å™¨(ConcurrentHashMapç­‰)
5. **å®‰å…¨å‘å¸ƒ**ï¼šç¡®ä¿å¯¹è±¡å®‰å…¨åœ°åœ¨çº¿ç¨‹ä¹‹é—´ä¼ é€’

</div>
</div>

### 6.3 çº¿ç¨‹æ± æœ€ä½³å®è·µ

:::tip çº¿ç¨‹æ± ä½¿ç”¨å»ºè®®
1. **åˆç†è®¾ç½®å¤§å°**ï¼šçº¿ç¨‹æ± å¤§å° = CPUæ ¸å¿ƒæ•° * (1 + ç­‰å¾…æ—¶é—´/è®¡ç®—æ—¶é—´)
2. **åŒºåˆ†ä»»åŠ¡ç±»å‹**ï¼šCPUå¯†é›†å‹ä»»åŠ¡æ± åº”å°ä¸€äº›ï¼ŒIOå¯†é›†å‹ä»»åŠ¡æ± å¯ä»¥å¤§ä¸€äº›
3. **ä½¿ç”¨å·¥å‚æ–¹æ³•**ï¼šä½¿ç”¨ThreadFactoryä¸ºçº¿ç¨‹æ± åˆ›å»ºçš„çº¿ç¨‹è®¾ç½®æœ‰æ„ä¹‰çš„åç§°
4. **å¤„ç†å¼‚å¸¸**ï¼šæ•è·å¹¶å¤„ç†æäº¤ä»»åŠ¡å†…çš„æ‰€æœ‰å¼‚å¸¸
5. **ä¼˜é›…å…³é—­**ï¼šä½¿ç”¨shutdown()è€ŒéshutdownNow()ï¼Œç¡®ä¿ä»»åŠ¡å®Œæˆ
6. **ç›‘æ§çº¿ç¨‹æ± **ï¼šè·Ÿè¸ªæ´»åŠ¨çº¿ç¨‹æ•°ã€å®Œæˆä»»åŠ¡æ•°ã€é˜Ÿåˆ—å¤§å°ç­‰æŒ‡æ ‡
:::

### 6.4 é¿å…æ­»é”çš„å»ºè®®

```java
public class DeadlockAvoidance {
    // è§„åˆ™1: æŒ‰å›ºå®šé¡ºåºè·å–é”
    public void correctResourceAccess(Object resource1, Object resource2) {
        // æ€»æ˜¯å…ˆè·å–resource1ï¼Œå†è·å–resource2
        synchronized (resource1) {
            System.out.println("è·å–ç¬¬ä¸€ä¸ªé”");
            synchronized (resource2) {
                System.out.println("è·å–ç¬¬äºŒä¸ªé”");
                // ä½¿ç”¨èµ„æº...
            }
        }
    }
    
    // è§„åˆ™2: ä½¿ç”¨è¶…æ—¶è·å–é”
    public boolean tryResourceAccess(Lock lock1, Lock lock2) {
        try {
            // å°è¯•è·å–é”ï¼Œä½†ä¸æ°¸è¿œç­‰å¾…
            if (lock1.tryLock(1, TimeUnit.SECONDS)) {
                try {
                    if (lock2.tryLock(1, TimeUnit.SECONDS)) {
                        try {
                            // ä½¿ç”¨èµ„æº...
                            return true;
                        } finally {
                            lock2.unlock();
                        }
                    }
                } finally {
                    lock1.unlock();
                }
            }
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
        return false; // æœªèƒ½è·å–æ‰€æœ‰é”
    }
    
    // è§„åˆ™3: é¿å…åœ¨æŒæœ‰é”æ—¶è°ƒç”¨å¤–éƒ¨æ–¹æ³•
    public void avoidNestedLocking(Object lock) {
        synchronized (lock) {
            // ä¸è¦åœ¨è¿™é‡Œè°ƒç”¨å¯èƒ½è·å–å…¶ä»–é”çš„æ–¹æ³•
            safeOperation(); // åªè°ƒç”¨ä¸è·å–é”çš„å®‰å…¨æ–¹æ³•
        }
    }
    
    private void safeOperation() {
        // ä¸è·å–ä»»ä½•é”çš„æ“ä½œ
    }
}
```

## 7. æ€»ç»“

### 7.1 çº¿ç¨‹æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“

<div className="card">
<div className="card__body">

- **çº¿ç¨‹åˆ›å»º**ï¼šç»§æ‰¿Threadã€å®ç°Runnableã€å®ç°Callable
- **çº¿ç¨‹çŠ¶æ€**ï¼šNEWã€RUNNABLEã€BLOCKEDã€WAITINGã€TIMED_WAITINGã€TERMINATED
- **çº¿ç¨‹æ§åˆ¶**ï¼šstart()ã€join()ã€sleep()ã€yield()ã€interrupt()
- **çº¿ç¨‹é€šä¿¡**ï¼šwait()ã€notify()ã€notifyAll()
- **çº¿ç¨‹å®‰å…¨**ï¼šåŒæ­¥ã€é”ã€åŸå­å˜é‡ã€çº¿ç¨‹å®‰å…¨é›†åˆ
- **åº”ç”¨åœºæ™¯**ï¼šå¹¶è¡Œè®¡ç®—ã€å¼‚æ­¥ä»»åŠ¡ã€å®æ—¶äº‹ä»¶å¤„ç†

</div>
</div>

### 7.2 å­¦ä¹ è·¯å¾„ä¸æ·±å…¥æ–¹å‘

```mermaid
mindmap
  root((Javaçº¿ç¨‹å­¦ä¹ è·¯å¾„))
    åŸºç¡€æ¦‚å¿µ
      çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ
      çº¿ç¨‹çŠ¶æ€è½¬æ¢
      çº¿ç¨‹ä¼˜å…ˆçº§
    åˆ›å»ºä¸æ§åˆ¶
      åˆ›å»ºæ–¹å¼
      æ§åˆ¶æ–¹æ³•
      ä¸­æ–­æœºåˆ¶
    çº¿ç¨‹å®‰å…¨
      åŒæ­¥æœºåˆ¶
      é”æœºåˆ¶
      çº¿ç¨‹é€šä¿¡
    å¹¶å‘å·¥å…·
      çº¿ç¨‹æ± 
      å¹¶å‘å®¹å™¨
      åŒæ­¥å·¥å…·
    é«˜çº§ç‰¹æ€§
      ThreadLocal
      åç¨‹/çº¤ç¨‹
      å¹¶å‘ç¼–ç¨‹æ¨¡å‹
```

### 7.3 æ€§èƒ½ä¸è°ƒè¯•å»ºè®®

1. **é€‚é‡åˆ›å»ºçº¿ç¨‹**ï¼šçº¿ç¨‹æ•°ä¸åº”è¿œè¶…CPUæ ¸å¿ƒæ•°
2. **é¿å…è¿‡åº¦åŒæ­¥**ï¼šä»…åœ¨å¿…è¦æ—¶è¿›è¡ŒåŒæ­¥
3. **ä½¿ç”¨çº¿ç¨‹æ ˆ**ï¼šåˆ©ç”¨çº¿ç¨‹æ ˆå¿«é€Ÿå®šä½é—®é¢˜
4. **å–„ç”¨JVMå‚æ•°**ï¼šè°ƒæ•´çº¿ç¨‹æ ˆå¤§å°(`-Xss`)
5. **ä½¿ç”¨çº¿ç¨‹è½¬å‚¨**ï¼šé€šè¿‡`jstack`è·å–çº¿ç¨‹è½¬å‚¨åˆ†ææ­»é”
6. **æ€§èƒ½åˆ†æ**ï¼šä½¿ç”¨JVisualVMã€YourKitç­‰å·¥å…·ç›‘æ§çº¿ç¨‹æ€§èƒ½ 