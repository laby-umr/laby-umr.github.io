---
sidebar_position: 2
title: åˆ›å»ºå‹æ¨¡å¼è¯¦è§£
description: æ·±å…¥ç†è§£å•ä¾‹ã€å·¥å‚ã€å»ºé€ è€…ã€åŸå‹ç­‰åˆ›å»ºå‹æ¨¡å¼çš„åŸç†ä¸åº”ç”¨
authors: [Laby]
tags: [è®¾è®¡æ¨¡å¼, åˆ›å»ºå‹æ¨¡å¼, å•ä¾‹, å·¥å‚, å»ºé€ è€…, åŸå‹]
last_update:
  date: 2025-08-07
  author: Laby
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

# åˆ›å»ºå‹æ¨¡å¼è¯¦è§£

åˆ›å»ºå‹æ¨¡å¼å…³æ³¨å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼Œå°†å¯¹è±¡çš„åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»ï¼Œæä¾›çµæ´»çš„å¯¹è±¡åˆ›å»ºæœºåˆ¶ã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨äº”ç§åˆ›å»ºå‹æ¨¡å¼çš„åŸç†ã€å®ç°æ–¹å¼å’Œå®é™…åº”ç”¨ã€‚

:::tip æ ¸å¿ƒä»·å€¼
**åˆ›å»ºå‹æ¨¡å¼ = å°è£…å¯¹è±¡åˆ›å»º + çµæ´»å®ä¾‹åŒ– + åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»**
- ğŸ” **éšè—å®ç°ç»†èŠ‚**ï¼šå±è”½å¯¹è±¡çš„å®ä¾‹åŒ–è¿‡ç¨‹ï¼Œä½¿ç³»ç»Ÿæ›´ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘
- ğŸ”„ **æé«˜å¯æ‰©å±•æ€§**ï¼šåœ¨ä¸ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç çš„æƒ…å†µä¸‹å¼•å…¥æ–°çš„å…·ä½“ç±»å‹
- ğŸ› ï¸ **å¢å¼ºä»£ç å¤ç”¨**ï¼šé¿å…ä»£ç é‡å¤ï¼Œæé«˜ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§
- ğŸ§© **é™ä½ç³»ç»Ÿè€¦åˆåº¦**ï¼šå‡å°‘ç³»ç»Ÿå„éƒ¨åˆ†çš„ç›¸äº’ä¾èµ–
:::

## åˆ›å»ºå‹æ¨¡å¼æ¦‚è§ˆ

```mermaid
graph TB
    A[åˆ›å»ºå‹æ¨¡å¼] --> B[å•ä¾‹æ¨¡å¼]
    A --> C[å·¥å‚æ–¹æ³•æ¨¡å¼]
    A --> D[æŠ½è±¡å·¥å‚æ¨¡å¼]
    A --> E[å»ºé€ è€…æ¨¡å¼]
    A --> F[åŸå‹æ¨¡å¼]
    
    B --> B1[ç¡®ä¿ç±»åªæœ‰ä¸€ä¸ªå®ä¾‹]
    C --> C1[å®šä¹‰åˆ›å»ºå¯¹è±¡çš„æ¥å£]
    D --> D1[åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³äº§å“]
    E --> E1[åˆ†æ­¥éª¤æ„å»ºå¤æ‚å¯¹è±¡]
    F --> F1[é€šè¿‡å¤åˆ¶åˆ›å»ºå¯¹è±¡]
    
    style A fill:#f9f9f9,stroke:#333,stroke-width:2px
    style B fill:#e6f7ff,stroke:#1890ff
    style C fill:#e6f7ff,stroke:#1890ff
    style D fill:#e6f7ff,stroke:#1890ff
    style E fill:#e6f7ff,stroke:#1890ff
    style F fill:#e6f7ff,stroke:#1890ff
```

## 1. å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰

### 1.1 æ¨¡å¼å®šä¹‰

å•ä¾‹æ¨¡å¼ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚

```mermaid
graph TB
    A[å®¢æˆ·ç«¯] -->|è·å–å®ä¾‹| B[å•ä¾‹ç±»]
    B -->|"return instance"| A
    B -->|åˆ›å»º| C[å”¯ä¸€å®ä¾‹]
    
    style B fill:#e6f7ff,stroke:#1890ff
    style C fill:#f6ffed,stroke:#52c41a
```

<Tabs>
<TabItem value="when-to-use" label="é€‚ç”¨åœºæ™¯">

- **èµ„æºå…±äº«**ï¼šå½“éœ€è¦å…±äº«æ˜‚è´µçš„èµ„æºæ—¶ï¼ˆå¦‚æ•°æ®åº“è¿æ¥æ± ï¼‰
- **å…¨å±€çŠ¶æ€ç®¡ç†**ï¼šéœ€è¦ç»´æŠ¤å…¨å±€çŠ¶æ€æˆ–é…ç½®æ—¶
- **åè°ƒæ“ä½œ**ï¼šéœ€è¦åè°ƒç³»ç»Ÿè¡Œä¸ºçš„åœºæ™¯ï¼ˆå¦‚æ—¥å¿—è®°å½•å™¨ï¼‰

</TabItem>
<TabItem value="benefits" label="ä¼˜ç‚¹">

- **èŠ‚çœèµ„æº**ï¼šé¿å…é‡å¤åˆ›å»ºå¯¹è±¡ï¼Œå‡å°‘å†…å­˜å ç”¨
- **å…¨å±€è®¿é—®ç‚¹**ï¼šæä¾›ç»Ÿä¸€çš„è®¿é—®å…¥å£
- **åè°ƒè¡Œä¸º**ï¼šå¯ä»¥åè°ƒç³»ç»Ÿä¸­çš„è¡Œä¸ºå’Œèµ„æº

</TabItem>
<TabItem value="drawbacks" label="ç¼ºç‚¹">

- **å…¨å±€çŠ¶æ€**ï¼šå¯èƒ½é€ æˆå…¨å±€çŠ¶æ€éš¾ä»¥è°ƒè¯•å’Œæµ‹è¯•
- **å•ä¸€èŒè´£è¿å**ï¼šæ—¢è¦ç®¡ç†è‡ªèº«å®ä¾‹ï¼Œåˆè¦å®Œæˆä¸šåŠ¡é€»è¾‘
- **éšè—ä¾èµ–**ï¼šå®¢æˆ·ç«¯ä¸å•ä¾‹å­˜åœ¨éšå¼ä¾èµ–ï¼Œä¸åˆ©äºä¾èµ–æ³¨å…¥

</TabItem>
</Tabs>

### 1.2 å®ç°æ–¹å¼

#### é¥¿æ±‰å¼å•ä¾‹
```java title="é¥¿æ±‰å¼å•ä¾‹"
public class EagerSingleton {
    // ç±»åŠ è½½æ—¶å°±åˆå§‹åŒ–ï¼Œçº¿ç¨‹å®‰å…¨
    private static final EagerSingleton instance = new EagerSingleton();
    
    // ç§æœ‰æ„é€ å‡½æ•°
    private EagerSingleton() {
        // é˜²æ­¢åå°„æ”»å‡»
        if (instance != null) {
            throw new RuntimeException("å•ä¾‹æ¨¡å¼ä¸å…è®¸åˆ›å»ºå¤šä¸ªå®ä¾‹");
        }
    }
    
    // å…¨å±€è®¿é—®ç‚¹
    public static EagerSingleton getInstance() {
        return instance;
    }
    
    // ä¸šåŠ¡æ–¹æ³•
    public void doSomething() {
        System.out.println("é¥¿æ±‰å¼å•ä¾‹æ‰§è¡Œæ“ä½œ");
    }
}
```

#### æ‡’æ±‰å¼å•ä¾‹
```java title="æ‡’æ±‰å¼å•ä¾‹"
public class LazySingleton {
    // å»¶è¿Ÿåˆå§‹åŒ–
    private static volatile LazySingleton instance;
    
    private LazySingleton() {}
    
    // åŒé‡æ£€æŸ¥é”å®šï¼ˆDouble-Checked Lockingï¼‰
    public static LazySingleton getInstance() {
        if (instance == null) {
            synchronized (LazySingleton.class) {
                if (instance == null) {
                    instance = new LazySingleton();
                }
            }
        }
        return instance;
    }
    
    public void doSomething() {
        System.out.println("æ‡’æ±‰å¼å•ä¾‹æ‰§è¡Œæ“ä½œ");
    }
}
```

#### é™æ€å†…éƒ¨ç±»å•ä¾‹
```java title="é™æ€å†…éƒ¨ç±»å•ä¾‹"
public class StaticInnerSingleton {
    private StaticInnerSingleton() {}
    
    // é™æ€å†…éƒ¨ç±»
    private static class SingletonHolder {
        private static final StaticInnerSingleton INSTANCE = new StaticInnerSingleton();
    }
    
    public static StaticInnerSingleton getInstance() {
        return SingletonHolder.INSTANCE;
    }
    
    public void doSomething() {
        System.out.println("é™æ€å†…éƒ¨ç±»å•ä¾‹æ‰§è¡Œæ“ä½œ");
    }
}
```

#### æšä¸¾å•ä¾‹ï¼ˆæ¨èï¼‰
```java title="æšä¸¾å•ä¾‹"
public enum EnumSingleton {
    INSTANCE;
    
    public void doSomething() {
        System.out.println("æšä¸¾å•ä¾‹æ‰§è¡Œæ“ä½œ");
    }
    
    // å¯ä»¥æ·»åŠ å…¶ä»–æ–¹æ³•
    public void anotherMethod() {
        System.out.println("æšä¸¾å•ä¾‹çš„å…¶ä»–æ–¹æ³•");
    }
}
```

### 1.3 å•ä¾‹æ¨¡å¼å®ç°å¯¹æ¯”

| å®ç°æ–¹å¼ | çº¿ç¨‹å®‰å…¨ | å»¶è¿ŸåŠ è½½ | åºåˆ—åŒ–å®‰å…¨ | é˜²åå°„æ”»å‡» | JVMä¿è¯ | æ¨èæŒ‡æ•° |
|---------|---------|---------|-----------|----------|--------|---------|
| **é¥¿æ±‰å¼** | âœ… | âŒ | âŒ | âœ… | âœ… | â­â­â­ |
| **æ‡’æ±‰å¼** | âœ… | âœ… | âŒ | âŒ | âŒ | â­â­ |
| **é™æ€å†…éƒ¨ç±»** | âœ… | âœ… | âŒ | âŒ | âœ… | â­â­â­â­ |
| **æšä¸¾æ–¹å¼** | âœ… | âŒ | âœ… | âœ… | âœ… | â­â­â­â­â­ |

### 1.4 åº”ç”¨åœºæ™¯

<Tabs>
<TabItem value="config" label="é…ç½®ç®¡ç†å™¨">

```java title="é…ç½®ç®¡ç†å™¨"
public class ConfigurationManager {
    private static volatile ConfigurationManager instance;
    private Properties properties;
    
    private ConfigurationManager() {
        loadConfiguration();
    }
    
    public static ConfigurationManager getInstance() {
        if (instance == null) {
            synchronized (ConfigurationManager.class) {
                if (instance == null) {
                    instance = new ConfigurationManager();
                }
            }
        }
        return instance;
    }
    
    private void loadConfiguration() {
        properties = new Properties();
        try (InputStream input = getClass().getClassLoader()
                .getResourceAsStream("config.properties")) {
            properties.load(input);
        } catch (IOException e) {
            throw new RuntimeException("Failed to load configuration", e);
        }
    }
    
    public String getProperty(String key) {
        return properties.getProperty(key);
    }
}
```

</TabItem>
<TabItem value="db-pool" label="æ•°æ®åº“è¿æ¥æ± ">

```java title="æ•°æ®åº“è¿æ¥æ± "
public class DatabaseConnectionPool {
    private static DatabaseConnectionPool instance;
    private final Queue<Connection> connectionPool;
    private final int maxConnections;
    
    private DatabaseConnectionPool(int maxConnections) {
        this.maxConnections = maxConnections;
        this.connectionPool = new LinkedList<>();
        initializePool();
    }
    
    public static synchronized DatabaseConnectionPool getInstance() {
        if (instance == null) {
            instance = new DatabaseConnectionPool(10);
        }
        return instance;
    }
    
    private void initializePool() {
        for (int i = 0; i < maxConnections; i++) {
            connectionPool.offer(createConnection());
        }
    }
    
    private Connection createConnection() {
        // åˆ›å»ºæ•°æ®åº“è¿æ¥çš„é€»è¾‘
        return null; // ç®€åŒ–ç¤ºä¾‹
    }
    
    public Connection getConnection() {
        return connectionPool.poll();
    }
    
    public void releaseConnection(Connection connection) {
        if (connectionPool.size() < maxConnections) {
            connectionPool.offer(connection);
        }
    }
}
```

</TabItem>
<TabItem value="logger" label="æ—¥å¿—è®°å½•å™¨">

```java title="æ—¥å¿—è®°å½•å™¨"
public class LoggerSingleton {
    private static final LoggerSingleton INSTANCE = new LoggerSingleton();
    private final BufferedWriter writer;
    
    private LoggerSingleton() {
        try {
            writer = new BufferedWriter(new FileWriter("application.log", true));
        } catch (IOException e) {
            throw new RuntimeException("æ— æ³•åˆå§‹åŒ–æ—¥å¿—æ–‡ä»¶", e);
        }
    }
    
    public static LoggerSingleton getInstance() {
        return INSTANCE;
    }
    
    public void log(String message) {
        try {
            writer.write(LocalDateTime.now() + ": " + message);
            writer.newLine();
            writer.flush();
        } catch (IOException e) {
            System.err.println("æ—¥å¿—å†™å…¥å¤±è´¥: " + e.getMessage());
        }
    }
    
    // ç¡®ä¿èµ„æºé‡Šæ”¾
    @Override
    protected void finalize() throws Throwable {
        writer.close();
        super.finalize();
    }
}
```

</TabItem>
</Tabs>

### 1.5 å®ç°æ³¨æ„äº‹é¡¹

:::warning å¤šçº¿ç¨‹å®‰å…¨æ€§
å•ä¾‹æ¨¡å¼åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å®ç°æ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š
- **æ‡’æ±‰å¼**éœ€è¦ä½¿ç”¨åŒé‡æ£€æŸ¥é”å®šå¹¶åŠ ä¸Š`volatile`å…³é”®å­—
- **é¥¿æ±‰å¼**å’Œ**æšä¸¾æ–¹å¼**å¤©ç”Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„
- é¿å…ä½¿ç”¨æ²¡æœ‰åŒæ­¥æªæ–½çš„æ‡’åŠ è½½æ–¹å¼
:::

:::tip æœ€ä½³å®è·µ
- **æ¨èä¼˜å…ˆä½¿ç”¨æšä¸¾å®ç°å•ä¾‹**ï¼Œç®€æ´ä¸”æœ‰JVMä¿è¯çš„çº¿ç¨‹å’Œåºåˆ—åŒ–å®‰å…¨
- éœ€è¦å»¶è¿ŸåŠ è½½æ—¶ï¼Œä½¿ç”¨é™æ€å†…éƒ¨ç±»æ–¹å¼
- è€ƒè™‘ä½¿ç”¨ä¾èµ–æ³¨å…¥æ¡†æ¶æ¥ç®¡ç†å•ä¾‹ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨å®ç°
:::

## 2. å·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFactory Methodï¼‰

### 2.1 æ¨¡å¼å®šä¹‰

å·¥å‚æ–¹æ³•æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œä½†ç”±å­ç±»å†³å®šå®ä¾‹åŒ–çš„ç±»æ˜¯å“ªä¸€ä¸ªã€‚å·¥å‚æ–¹æ³•å°†ç±»çš„å®ä¾‹åŒ–æ¨è¿Ÿåˆ°å­ç±»ä¸­è¿›è¡Œã€‚

```mermaid
graph TD
    A[æŠ½è±¡å·¥å‚] -->|ç»§æ‰¿| B[å…·ä½“å·¥å‚A]
    A -->|ç»§æ‰¿| C[å…·ä½“å·¥å‚B]
    D[æŠ½è±¡äº§å“] -->|å®ç°| E[å…·ä½“äº§å“A]
    D -->|å®ç°| F[å…·ä½“äº§å“B]
    B -->|åˆ›å»º| E
    C -->|åˆ›å»º| F
    
    style A fill:#f9f9f9,stroke:#333,stroke-width:2px
    style D fill:#f9f9f9,stroke:#333,stroke-width:2px
    style B fill:#e6f7ff,stroke:#1890ff
    style C fill:#e6f7ff,stroke:#1890ff
    style E fill:#f6ffed,stroke:#52c41a
    style F fill:#f6ffed,stroke:#52c41a
```

<Tabs>
<TabItem value="when-to-use" label="é€‚ç”¨åœºæ™¯">

- **åˆ›å»ºé€»è¾‘å¤æ‚**ï¼šå½“å¯¹è±¡çš„åˆ›å»ºé€»è¾‘è¾ƒä¸ºå¤æ‚æ—¶
- **ç±»å‹å¤šå˜**ï¼šå½“éœ€è¦åˆ›å»ºçš„å¯¹è±¡ç±»å‹å¯èƒ½åœ¨è¿è¡Œæ—¶å˜åŒ–æ—¶
- **ä¾èµ–å€’ç½®**ï¼šæƒ³ä¾èµ–æŠ½è±¡è€Œéå…·ä½“ç±»æ—¶
- **æ¡†æ¶è®¾è®¡**ï¼šæ¡†æ¶éœ€è¦ä¸ºç”¨æˆ·æä¾›æ‰©å±•ç‚¹æ—¶

</TabItem>
<TabItem value="benefits" label="ä¼˜ç‚¹">

- **è§£è€¦**ï¼šå°†äº§å“çš„åˆ›å»ºä¸ä½¿ç”¨è§£è€¦
- **å•ä¸€èŒè´£**ï¼šå°†åˆ›å»ºé€»è¾‘é›†ä¸­åˆ°ä¸“é—¨çš„å·¥å‚ç±»
- **å¼€é—­åŸåˆ™**ï¼šå¯ä»¥å¼•å…¥æ–°çš„äº§å“ç±»è€Œæ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç 
- **å¯å®šåˆ¶**ï¼šå­ç±»å¯ä»¥æ”¹å˜å·¥å‚æ–¹æ³•çš„è¿”å›ç±»å‹

</TabItem>
<TabItem value="drawbacks" label="ç¼ºç‚¹">

- **ç±»çˆ†ç‚¸**ï¼šæ¯æ·»åŠ ä¸€ä¸ªäº§å“å°±éœ€è¦æ·»åŠ ä¸€ä¸ªå…·ä½“å·¥å‚ç±»
- **å¤æ‚åº¦**ï¼šå¼•å…¥äº†é¢å¤–çš„æŠ½è±¡å±‚ï¼Œå¢åŠ äº†ç†è§£éš¾åº¦
- **ç»§æ‰¿çº¦æŸ**ï¼šé€šå¸¸éœ€è¦åˆ›å»ºå­ç±»æ¥ä½¿ç”¨å·¥å‚æ–¹æ³•

</TabItem>
</Tabs>

### 2.2 å®ç°æ–¹å¼

#### åŸºæœ¬å·¥å‚æ–¹æ³•æ¨¡å¼

```java title="å·¥å‚æ–¹æ³•æ¨¡å¼"
// æŠ½è±¡äº§å“
public interface Product {
    void operation();
}

// å…·ä½“äº§å“A
public class ConcreteProductA implements Product {
    @Override
    public void operation() {
        System.out.println("äº§å“Açš„æ“ä½œ");
    }
}

// å…·ä½“äº§å“B
public class ConcreteProductB implements Product {
    @Override
    public void operation() {
        System.out.println("äº§å“Bçš„æ“ä½œ");
    }
}

// æŠ½è±¡å·¥å‚
public abstract class Creator {
    // å·¥å‚æ–¹æ³•
    public abstract Product createProduct();
    
    // æ¨¡æ¿æ–¹æ³•
    public void someOperation() {
        Product product = createProduct();
        product.operation();
    }
}

// å…·ä½“å·¥å‚A
public class ConcreteCreatorA extends Creator {
    @Override
    public Product createProduct() {
        return new ConcreteProductA();
    }
}

// å…·ä½“å·¥å‚B
public class ConcreteCreatorB extends Creator {
    @Override
    public Product createProduct() {
        return new ConcreteProductB();
    }
}
```

#### å‚æ•°åŒ–å·¥å‚æ–¹æ³•

```java title="å‚æ•°åŒ–å·¥å‚æ–¹æ³•"
public abstract class Creator {
    public Product createProduct(String type) {
        Product product = createProductImpl(type);
        // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é€šç”¨çš„åˆå§‹åŒ–é€»è¾‘
        return product;
    }
    
    protected abstract Product createProductImpl(String type);
}

public class ConcreteCreator extends Creator {
    @Override
    protected Product createProductImpl(String type) {
        switch (type) {
            case "A":
                return new ConcreteProductA();
            case "B":
                return new ConcreteProductB();
            default:
                throw new IllegalArgumentException("Unknown product type: " + type);
        }
    }
}
```

### 2.3 å·¥å‚æ–¹æ³•æ¨¡å¼å˜ä½“

<Tabs>
<TabItem value="simple-factory" label="ç®€å•å·¥å‚">

```java title="ç®€å•å·¥å‚ï¼ˆéGoFè®¾è®¡æ¨¡å¼ï¼‰"
public class SimpleFactory {
    public static Product createProduct(String type) {
        switch (type) {
            case "A":
                return new ConcreteProductA();
            case "B":
                return new ConcreteProductB();
            default:
                throw new IllegalArgumentException("Unknown product type: " + type);
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
public class Client {
    public void doSomething() {
        Product product = SimpleFactory.createProduct("A");
        product.operation();
    }
}
```

ç®€å•å·¥å‚ä¸å±äºGoFè®¾è®¡æ¨¡å¼ï¼Œä½†å¸¸ä½œä¸ºå·¥å‚æ–¹æ³•çš„ç®€åŒ–ç‰ˆæœ¬ä½¿ç”¨ã€‚

</TabItem>
<TabItem value="static-factory" label="é™æ€å·¥å‚æ–¹æ³•">

```java title="é™æ€å·¥å‚æ–¹æ³•"
public class Product {
    private Product() { }
    
    public void operation() {
        System.out.println("äº§å“æ“ä½œ");
    }
    
    // é™æ€å·¥å‚æ–¹æ³•
    public static Product createProductA() {
        return new Product();
    }
    
    public static Product createProductWithName(String name) {
        Product product = new Product();
        // è®¾ç½®äº§å“åç§°
        return product;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
public class Client {
    public void doSomething() {
        Product product = Product.createProductA();
        product.operation();
    }
}
```

é™æ€å·¥å‚æ–¹æ³•æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­å¸¸è§çš„å®ç°æŠ€å·§ï¼Œé€šå¸¸åœ¨ä¸€ä¸ªç±»ä¸­æä¾›é™æ€æ–¹æ³•æ¥åˆ›å»ºå¯¹è±¡ã€‚

</TabItem>
</Tabs>

### 2.4 å·¥å‚æ–¹æ³•vsç®€å•å·¥å‚

| ç‰¹æ€§ | å·¥å‚æ–¹æ³• | ç®€å•å·¥å‚ |
|------|----------|---------|
| **ç±»å‹** | GoFè®¾è®¡æ¨¡å¼ | ç¼–ç¨‹ä¹ æƒ¯ |
| **åˆ›å»ºæ–¹å¼** | é€šè¿‡ç»§æ‰¿ | é€šè¿‡æ¡ä»¶åˆ¤æ–­ |
| **æ‰©å±•æ–¹å¼** | æ·»åŠ æ–°çš„å·¥å‚å­ç±» | ä¿®æ”¹å·¥å‚ç±»ä»£ç  |
| **å¼€é—­åŸåˆ™** | ç¬¦åˆ | ä¸å®Œå…¨ç¬¦åˆ |
| **å¤æ‚åº¦** | è¾ƒé«˜ | è¾ƒä½ |
| **çµæ´»æ€§** | æ›´çµæ´» | è¾ƒç®€å• |
| **é€‚ç”¨åœºæ™¯** | å¤æ‚å¯¹è±¡åˆ›å»ºã€æ¡†æ¶è®¾è®¡ | ç®€å•å¯¹è±¡åˆ›å»ºã€å°å‹åº”ç”¨ |

### 2.5 åº”ç”¨åœºæ™¯

<Tabs>
<TabItem value="db-connection" label="æ•°æ®åº“è¿æ¥">

```java title="æ•°æ®åº“è¿æ¥å·¥å‚"
// æ•°æ®åº“è¿æ¥æ¥å£
public interface DatabaseConnection {
    void connect();
    void disconnect();
}

// MySQLè¿æ¥å®ç°
public class MySQLConnection implements DatabaseConnection {
    @Override
    public void connect() {
        System.out.println("è¿æ¥MySQLæ•°æ®åº“");
    }
    
    @Override
    public void disconnect() {
        System.out.println("æ–­å¼€MySQLæ•°æ®åº“è¿æ¥");
    }
}

// PostgreSQLè¿æ¥å®ç°
public class PostgreSQLConnection implements DatabaseConnection {
    @Override
    public void connect() {
        System.out.println("è¿æ¥PostgreSQLæ•°æ®åº“");
    }
    
    @Override
    public void disconnect() {
        System.out.println("æ–­å¼€PostgreSQLæ•°æ®åº“è¿æ¥");
    }
}

// æ•°æ®åº“è¿æ¥å·¥å‚æ¥å£
public abstract class DatabaseConnectionFactory {
    public abstract DatabaseConnection createConnection();
    
    public DatabaseConnection getConnection() {
        DatabaseConnection connection = createConnection();
        // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ è¿æ¥æ± ç®¡ç†é€»è¾‘
        return connection;
    }
}

// MySQLè¿æ¥å·¥å‚
public class MySQLConnectionFactory extends DatabaseConnectionFactory {
    @Override
    public DatabaseConnection createConnection() {
        return new MySQLConnection();
    }
}

// PostgreSQLè¿æ¥å·¥å‚
public class PostgreSQLConnectionFactory extends DatabaseConnectionFactory {
    @Override
    public DatabaseConnection createConnection() {
        return new PostgreSQLConnection();
    }
}
```

</TabItem>
<TabItem value="logger-factory" label="æ—¥å¿—è®°å½•å™¨">

```java title="æ—¥å¿—è®°å½•å·¥å‚"
// æ—¥å¿—æ¥å£
public interface Logger {
    void log(String message);
}

// æ§åˆ¶å°æ—¥å¿—
public class ConsoleLogger implements Logger {
    @Override
    public void log(String message) {
        System.out.println("æ§åˆ¶å°æ—¥å¿—: " + message);
    }
}

// æ–‡ä»¶æ—¥å¿—
public class FileLogger implements Logger {
    private String filePath;
    
    public FileLogger(String filePath) {
        this.filePath = filePath;
    }
    
    @Override
    public void log(String message) {
        System.out.println("å†™å…¥æ–‡ä»¶æ—¥å¿—: " + filePath + " - " + message);
    }
}

// æ—¥å¿—å·¥å‚
public abstract class LoggerFactory {
    public abstract Logger createLogger();
}

// æ§åˆ¶å°æ—¥å¿—å·¥å‚
public class ConsoleLoggerFactory extends LoggerFactory {
    @Override
    public Logger createLogger() {
        return new ConsoleLogger();
    }
}

// æ–‡ä»¶æ—¥å¿—å·¥å‚
public class FileLoggerFactory extends LoggerFactory {
    private String filePath;
    
    public FileLoggerFactory(String filePath) {
        this.filePath = filePath;
    }
    
    @Override
    public Logger createLogger() {
        return new FileLogger(filePath);
    }
}
```

</TabItem>
<TabItem value="ui-elements" label="UIå…ƒç´ åˆ›å»º">

```java title="UIå…ƒç´ å·¥å‚"
// UIå…ƒç´ æ¥å£
public interface UIElement {
    void render();
}

// æŒ‰é’®å…ƒç´ 
public class Button implements UIElement {
    @Override
    public void render() {
        System.out.println("æ¸²æŸ“æŒ‰é’®");
    }
}

// æ–‡æœ¬æ¡†å…ƒç´ 
public class TextField implements UIElement {
    @Override
    public void render() {
        System.out.println("æ¸²æŸ“æ–‡æœ¬æ¡†");
    }
}

// UIå…ƒç´ å·¥å‚
public abstract class UIElementFactory {
    public abstract UIElement createElement();
}

// æŒ‰é’®å·¥å‚
public class ButtonFactory extends UIElementFactory {
    @Override
    public UIElement createElement() {
        return new Button();
    }
}

// æ–‡æœ¬æ¡†å·¥å‚
public class TextFieldFactory extends UIElementFactory {
    @Override
    public UIElement createElement() {
        return new TextField();
    }
}
```

</TabItem>
</Tabs>

:::tip å·¥å‚æ–¹æ³•æ¨¡å¼æœ€ä½³å®è·µ
1. **å‘½åæ¸…æ™°**ï¼šä¸ºå·¥å‚æ–¹æ³•ä½¿ç”¨æè¿°æ€§åç§°ï¼Œå¦‚`createXXX`ã€`newXXX`ã€`getXXX`
2. **é¢„åˆå§‹åŒ–**ï¼šå¯ä»¥åœ¨å·¥å‚æ–¹æ³•ä¸­å¯¹åˆ›å»ºçš„å¯¹è±¡è¿›è¡Œé¢„åˆå§‹åŒ–æˆ–éªŒè¯
3. **å±‚æ¬¡å¹³è¡¡**ï¼šé¿å…åˆ›å»ºè¿‡æ·±çš„å·¥å‚ç»§æ‰¿å±‚æ¬¡
4. **å•ä¸€èŒè´£**ï¼šä¸€ä¸ªå·¥å‚ç±»åªè´Ÿè´£åˆ›å»ºä¸€ç§ç±»å‹çš„äº§å“
5. **å‚æ•°æ§åˆ¶**ï¼šæ ¹æ®éœ€è¦é€‰æ‹©ä½¿ç”¨å‚æ•°åŒ–å·¥å‚æ–¹æ³•æˆ–ä¸“ç”¨å·¥å‚å­ç±»
:::

## 3. æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factoryï¼‰

### 3.1 æ¨¡å¼å®šä¹‰

æŠ½è±¡å·¥å‚æ¨¡å¼æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬çš„å…·ä½“ç±»ã€‚å®ƒæ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ‰©å±•ï¼Œç”¨äºåˆ›å»ºäº§å“æ—ã€‚

```mermaid
graph TD
    A[å®¢æˆ·ç«¯] -->|ä½¿ç”¨| B[æŠ½è±¡å·¥å‚]
    B -->|ç»§æ‰¿| C[å…·ä½“å·¥å‚1]
    B -->|ç»§æ‰¿| D[å…·ä½“å·¥å‚2]
    E[æŠ½è±¡äº§å“A] -->|å®ç°| G[å…·ä½“äº§å“A1]
    E -->|å®ç°| H[å…·ä½“äº§å“A2]
    F[æŠ½è±¡äº§å“B] -->|å®ç°| I[å…·ä½“äº§å“B1]
    F -->|å®ç°| J[å…·ä½“äº§å“B2]
    C -->|åˆ›å»º| G
    C -->|åˆ›å»º| I
    D -->|åˆ›å»º| H
    D -->|åˆ›å»º| J
    
    style B fill:#f9f9f9,stroke:#333,stroke-width:2px
    style E fill:#f9f9f9,stroke:#333,stroke-width:2px
    style F fill:#f9f9f9,stroke:#333,stroke-width:2px
    style C fill:#e6f7ff,stroke:#1890ff
    style D fill:#e6f7ff,stroke:#1890ff
    style G fill:#f6ffed,stroke:#52c41a
    style H fill:#f6ffed,stroke:#52c41a
    style I fill:#f6ffed,stroke:#52c41a
    style J fill:#f6ffed,stroke:#52c41a
```

<Tabs>
<TabItem value="when-to-use" label="é€‚ç”¨åœºæ™¯">

- **äº§å“æ—åˆ›å»º**ï¼šéœ€è¦åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³äº§å“æ—¶
- **ä¸€è‡´æ€§ä¿è¯**ï¼šéœ€è¦ç¡®ä¿åˆ›å»ºçš„äº§å“å½¼æ­¤å…¼å®¹
- **å¹³å°ç‹¬ç«‹**ï¼šç³»ç»Ÿéœ€è¦ä¸å¤šä¸ªå¹³å°æˆ–æŠ€æœ¯é›†æˆ
- **éš”ç¦»å˜åŒ–**ï¼šéš”ç¦»äº§å“åˆ›å»ºçš„å…·ä½“ç»†èŠ‚

</TabItem>
<TabItem value="benefits" label="ä¼˜ç‚¹">

- **ä¸€è‡´æ€§**ï¼šä¿è¯äº†ä¸€ç³»åˆ—ç›¸å…³äº§å“çš„å…¼å®¹æ€§
- **éš”ç¦»å…·ä½“ç±»**ï¼šå®¢æˆ·ç«¯ä¸å…·ä½“äº§å“è§£è€¦
- **æ˜“äºåˆ‡æ¢**ï¼šå¯ä»¥æ•´ä½“åˆ‡æ¢äº§å“æ—
- **å¼€é—­åŸåˆ™**ï¼šå¢åŠ æ–°çš„äº§å“æ—ä¸éœ€è¦ä¿®æ”¹å·²æœ‰ä»£ç 

</TabItem>
<TabItem value="drawbacks" label="ç¼ºç‚¹">

- **éš¾ä»¥æ‰©å±•äº§å“ç§ç±»**ï¼šæ·»åŠ æ–°äº§å“ç±»å‹éœ€è¦ä¿®æ”¹æŠ½è±¡å·¥å‚æ¥å£
- **å¤æ‚åº¦**ï¼šå¼•å…¥äº†å¤§é‡çš„æ¥å£å’Œç±»
- **äº§å“æ—çº¦æŸ**ï¼šæ‰€æœ‰äº§å“å¿…é¡»åŒæ—¶è¢«æ”¯æŒ

</TabItem>
</Tabs>

### 3.2 å®ç°ç¤ºä¾‹

```java title="æŠ½è±¡å·¥å‚æ¨¡å¼"
// æŠ½è±¡äº§å“A
public interface AbstractProductA {
    void operationA();
}

// æŠ½è±¡äº§å“B
public interface AbstractProductB {
    void operationB();
}

// å…·ä½“äº§å“A1
public class ConcreteProductA1 implements AbstractProductA {
    @Override
    public void operationA() {
        System.out.println("äº§å“A1çš„æ“ä½œ");
    }
}

// å…·ä½“äº§å“A2
public class ConcreteProductA2 implements AbstractProductA {
    @Override
    public void operationA() {
        System.out.println("äº§å“A2çš„æ“ä½œ");
    }
}

// å…·ä½“äº§å“B1
public class ConcreteProductB1 implements AbstractProductB {
    @Override
    public void operationB() {
        System.out.println("äº§å“B1çš„æ“ä½œ");
    }
}

// å…·ä½“äº§å“B2
public class ConcreteProductB2 implements AbstractProductB {
    @Override
    public void operationB() {
        System.out.println("äº§å“B2çš„æ“ä½œ");
    }
}

// æŠ½è±¡å·¥å‚
public interface AbstractFactory {
    AbstractProductA createProductA();
    AbstractProductB createProductB();
}

// å…·ä½“å·¥å‚1
public class ConcreteFactory1 implements AbstractFactory {
    @Override
    public AbstractProductA createProductA() {
        return new ConcreteProductA1();
    }
    
    @Override
    public AbstractProductB createProductB() {
        return new ConcreteProductB1();
    }
}

// å…·ä½“å·¥å‚2
public class ConcreteFactory2 implements AbstractFactory {
    @Override
    public AbstractProductA createProductA() {
        return new ConcreteProductA2();
    }
    
    @Override
    public AbstractProductB createProductB() {
        return new ConcreteProductB2();
    }
}
```

### 3.3 æŠ½è±¡å·¥å‚ä¸å·¥å‚æ–¹æ³•å¯¹æ¯”

| ç‰¹æ€§ | æŠ½è±¡å·¥å‚ | å·¥å‚æ–¹æ³• |
|------|----------|----------|
| **ç›®çš„** | åˆ›å»ºäº§å“æ— | åˆ›å»ºå•ä¸ªäº§å“ |
| **æ¥å£** | å¤šä¸ªåˆ›å»ºæ–¹æ³• | å•ä¸ªåˆ›å»ºæ–¹æ³• |
| **æ‰©å±•äº§å“æ—** | å®¹æ˜“ï¼ˆå¢åŠ å·¥å‚ç±»ï¼‰ | ä¸é€‚ç”¨ |
| **æ‰©å±•äº§å“ç§ç±»** | å›°éš¾ï¼ˆä¿®æ”¹æ¥å£ï¼‰ | å®¹æ˜“ï¼ˆå¢åŠ äº§å“ç±»ï¼‰ |
| **æŠ½è±¡å±‚æ¬¡** | æ›´é«˜ | è¾ƒä½ |
| **å¤æ‚åº¦** | æ›´å¤æ‚ | è¾ƒç®€å• |
| **é€‚ç”¨åœºæ™¯** | å¤šç³»åˆ—äº§å“é›†æˆ | å•ä¸€äº§å“åˆ›å»º |

### 3.4 åº”ç”¨åœºæ™¯

<Tabs>
<TabItem value="ui-components" label="UIç»„ä»¶">

```java title="UIç»„ä»¶æŠ½è±¡å·¥å‚"
// æŒ‰é’®æ¥å£
public interface Button {
    void render();
    void onClick();
}

// å¤é€‰æ¡†æ¥å£
public interface Checkbox {
    void render();
    boolean isChecked();
}

// Windowsé£æ ¼æŒ‰é’®
public class WindowsButton implements Button {
    @Override
    public void render() {
        System.out.println("æ¸²æŸ“Windowsé£æ ¼æŒ‰é’®");
}

    @Override
    public void onClick() {
        System.out.println("WindowsæŒ‰é’®ç‚¹å‡»äº‹ä»¶");
    }
}

// Windowsé£æ ¼å¤é€‰æ¡†
public class WindowsCheckbox implements Checkbox {
    private boolean checked = false;
    
    @Override
    public void render() {
        System.out.println("æ¸²æŸ“Windowsé£æ ¼å¤é€‰æ¡†");
    }
    
    @Override
    public boolean isChecked() {
        return checked;
    }
}

// macOSé£æ ¼æŒ‰é’®
public class MacButton implements Button {
    @Override
    public void render() {
        System.out.println("æ¸²æŸ“macOSé£æ ¼æŒ‰é’®");
    }
    
    @Override
    public void onClick() {
        System.out.println("macOSæŒ‰é’®ç‚¹å‡»äº‹ä»¶");
    }
}

// macOSé£æ ¼å¤é€‰æ¡†
public class MacCheckbox implements Checkbox {
    private boolean checked = false;
    
    @Override
    public void render() {
        System.out.println("æ¸²æŸ“macOSé£æ ¼å¤é€‰æ¡†");
    }
    
    @Override
    public boolean isChecked() {
        return checked;
    }
}

// UIå·¥å‚æ¥å£
public interface UIFactory {
    Button createButton();
    Checkbox createCheckbox();
}

// Windows UIå·¥å‚
public class WindowsUIFactory implements UIFactory {
    @Override
    public Button createButton() {
        return new WindowsButton();
    }
    
    @Override
    public Checkbox createCheckbox() {
        return new WindowsCheckbox();
    }
}

// macOS UIå·¥å‚
public class MacUIFactory implements UIFactory {
    @Override
    public Button createButton() {
        return new MacButton();
    }
    
    @Override
    public Checkbox createCheckbox() {
        return new MacCheckbox();
    }
}

// å®¢æˆ·ç«¯åº”ç”¨
public class Application {
    private Button button;
    private Checkbox checkbox;
    
    public Application(UIFactory factory) {
        button = factory.createButton();
        checkbox = factory.createCheckbox();
    }
    
    public void render() {
        button.render();
        checkbox.render();
    }
}

// æ ¹æ®æ“ä½œç³»ç»Ÿé€‰æ‹©å·¥å‚
public class ApplicationRunner {
    public static void main(String[] args) {
        UIFactory factory;
        String osName = System.getProperty("os.name").toLowerCase();
        
        if (osName.contains("windows")) {
            factory = new WindowsUIFactory();
        } else {
            factory = new MacUIFactory();
        }
        
        Application app = new Application(factory);
        app.render();
    }
}
```

</TabItem>
<TabItem value="db-connections" label="æ•°æ®åº“è¿æ¥">

```java title="æ•°æ®åº“æŠ½è±¡å·¥å‚"
// æ•°æ®åº“è¿æ¥æ¥å£
public interface Connection {
    void open();
    void close();
    void executeQuery(String query);
}

// äº‹åŠ¡æ¥å£
public interface Transaction {
    void begin();
    void commit();
    void rollback();
}

// MySQLè¿æ¥
public class MySQLConnection implements Connection {
    @Override
    public void open() {
        System.out.println("æ‰“å¼€MySQLè¿æ¥");
    }
    
    @Override
    public void close() {
        System.out.println("å…³é—­MySQLè¿æ¥");
    }
    
    @Override
    public void executeQuery(String query) {
        System.out.println("MySQLæ‰§è¡ŒæŸ¥è¯¢: " + query);
    }
}

// MySQLäº‹åŠ¡
public class MySQLTransaction implements Transaction {
    @Override
    public void begin() {
        System.out.println("å¼€å§‹MySQLäº‹åŠ¡");
    }
    
    @Override
    public void commit() {
        System.out.println("æäº¤MySQLäº‹åŠ¡");
    }
    
    @Override
    public void rollback() {
        System.out.println("å›æ»šMySQLäº‹åŠ¡");
    }
}

// PostgreSQLè¿æ¥
public class PostgreSQLConnection implements Connection {
    @Override
    public void open() {
        System.out.println("æ‰“å¼€PostgreSQLè¿æ¥");
    }
    
    @Override
    public void close() {
        System.out.println("å…³é—­PostgreSQLè¿æ¥");
    }
    
    @Override
    public void executeQuery(String query) {
        System.out.println("PostgreSQLæ‰§è¡ŒæŸ¥è¯¢: " + query);
    }
}

// PostgreSQLäº‹åŠ¡
public class PostgreSQLTransaction implements Transaction {
    @Override
    public void begin() {
        System.out.println("å¼€å§‹PostgreSQLäº‹åŠ¡");
    }
    
    @Override
    public void commit() {
        System.out.println("æäº¤PostgreSQLäº‹åŠ¡");
    }
    
    @Override
    public void rollback() {
        System.out.println("å›æ»šPostgreSQLäº‹åŠ¡");
    }
}

// æ•°æ®åº“æŠ½è±¡å·¥å‚
public interface DatabaseFactory {
    Connection createConnection();
    Transaction createTransaction();
}

// MySQLå·¥å‚
public class MySQLFactory implements DatabaseFactory {
    @Override
    public Connection createConnection() {
        return new MySQLConnection();
    }
    
    @Override
    public Transaction createTransaction() {
        return new MySQLTransaction();
    }
}

// PostgreSQLå·¥å‚
public class PostgreSQLFactory implements DatabaseFactory {
    @Override
    public Connection createConnection() {
        return new PostgreSQLConnection();
    }
    
    @Override
    public Transaction createTransaction() {
        return new PostgreSQLTransaction();
    }
}
```

</TabItem>
</Tabs>

### 3.5 æŠ½è±¡å·¥å‚æ¨¡å¼çš„å˜ä½“

#### å¸¦æœ‰å·¥å‚æ–¹æ³•çš„æŠ½è±¡å·¥å‚

```java title="å¸¦æœ‰å·¥å‚æ–¹æ³•çš„æŠ½è±¡å·¥å‚"
public abstract class AbstractFactory {
    public abstract Button createButton();
    public abstract Checkbox createCheckbox();
    
    // é™æ€å·¥å‚æ–¹æ³•
    public static AbstractFactory getFactory(String type) {
        if ("windows".equalsIgnoreCase(type)) {
            return new WindowsUIFactory();
        } else if ("mac".equalsIgnoreCase(type)) {
            return new MacUIFactory();
        } else {
            throw new IllegalArgumentException("Unknown UI type: " + type);
        }
    }
}
```

#### ä½¿ç”¨åå°„çš„æŠ½è±¡å·¥å‚

```java title="ä½¿ç”¨åå°„çš„æŠ½è±¡å·¥å‚"
public class ReflectiveFactory implements AbstractFactory {
    private Class<?> buttonClass;
    private Class<?> checkboxClass;
    
    public ReflectiveFactory(String buttonClassName, String checkboxClassName) 
            throws ClassNotFoundException {
        this.buttonClass = Class.forName(buttonClassName);
        this.checkboxClass = Class.forName(checkboxClassName);
    }
    
    @Override
    public Button createButton() {
        try {
            return (Button) buttonClass.newInstance();
        } catch (Exception e) {
            throw new RuntimeException("Cannot create button", e);
        }
    }
    
    @Override
    public Checkbox createCheckbox() {
        try {
            return (Checkbox) checkboxClass.newInstance();
        } catch (Exception e) {
            throw new RuntimeException("Cannot create checkbox", e);
        }
    }
}
```

:::tip æŠ½è±¡å·¥å‚æœ€ä½³å®è·µ
1. **äº§å“æ—åˆ’åˆ†**ï¼šæŒ‰ç…§äº§å“ä¹‹é—´çš„å…³è”æ€§å’Œä¸€è‡´æ€§è¿›è¡Œåˆç†åˆ’åˆ†
2. **æ¥å£è®¾è®¡**ï¼šè®¾è®¡æ¸…æ™°ã€å†…èšçš„æ¥å£ï¼Œé¿å…è¿‡äºè‡ƒè‚¿çš„æŠ½è±¡å·¥å‚æ¥å£
3. **å·¥å‚æ‰©å±•**ï¼šè€ƒè™‘ä½¿ç”¨å·¥å‚æ–¹æ³•æˆ–ç®€å•å·¥å‚æ¥åˆ›å»ºæŠ½è±¡å·¥å‚å®ä¾‹
4. **äº§å“æ‰©å±•**ï¼šé¢„ç•™äº§å“ç§ç±»æ‰©å±•çš„æœºåˆ¶ï¼Œä¾‹å¦‚ä½¿ç”¨é»˜è®¤å®ç°æˆ–å¯é€‰æ–¹æ³•
5. **é…ç½®é©±åŠ¨**ï¼šè€ƒè™‘ä½¿ç”¨é…ç½®æ–‡ä»¶æˆ–åå°„æœºåˆ¶æ¥åŠ¨æ€é€‰æ‹©å·¥å‚å®ç°
:::

## 4. å»ºé€ è€…æ¨¡å¼ï¼ˆBuilderï¼‰

### 4.1 æ¨¡å¼å®šä¹‰

å»ºé€ è€…æ¨¡å¼å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚å®ƒå…è®¸æˆ‘ä»¬åˆ†æ­¥éª¤åˆ›å»ºå¤æ‚å¯¹è±¡ï¼Œå¹¶èƒ½è½»æ¾æ§åˆ¶åˆ›å»ºè¿‡ç¨‹ã€‚

```mermaid
graph TD
    A[å®¢æˆ·ç«¯] -->|ä½¿ç”¨| B[æŒ‡å¯¼è€…<br>Director]
    A -->|ç›´æ¥ä½¿ç”¨| C[å»ºé€ è€…<br>Builder]
    B -->|ä½¿ç”¨| C
    C -->|åˆ›å»º| D[äº§å“<br>Product]
    C -->|ç»§æ‰¿| E[å…·ä½“å»ºé€ è€…<br>ConcreteBuilder]
    E -->|åˆ›å»º| D
    
    style B fill:#f9f9f9,stroke:#333,stroke-width:2px
    style C fill:#f9f9f9,stroke:#333,stroke-width:2px
    style E fill:#e6f7ff,stroke:#1890ff
    style D fill:#f6ffed,stroke:#52c41a
```

<Tabs>
<TabItem value="when-to-use" label="é€‚ç”¨åœºæ™¯">

- **å¤æ‚å¯¹è±¡åˆ›å»º**ï¼šå¯¹è±¡å…·æœ‰å¤æ‚çš„å†…éƒ¨ç»“æ„æˆ–å¤šä¸ªç»„æˆéƒ¨åˆ†
- **ä¸åŒè¡¨ç¤º**ï¼šåŒä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒåœºæ™¯ä¸‹æœ‰ä¸åŒçš„è¡¨ç¤ºå½¢å¼
- **åˆ†æ­¥æ„å»º**ï¼šéœ€è¦å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹å¯æ§ä¸”çµæ´»
- **å‚æ•°æ ¡éªŒ**ï¼šéœ€è¦åœ¨å¯¹è±¡åˆ›å»ºæ—¶è¿›è¡Œå¤æ‚çš„å‚æ•°æ ¡éªŒ

</TabItem>
<TabItem value="benefits" label="ä¼˜ç‚¹">

- **åˆ†æ­¥åˆ›å»º**ï¼šå°†å¤æ‚å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹åˆ†è§£ä¸ºå¤šä¸ªæ­¥éª¤
- **é“¾å¼è°ƒç”¨**ï¼šæ”¯æŒæµå¼æ¥å£ï¼Œæé«˜å¯è¯»æ€§
- **å°è£…ç»†èŠ‚**ï¼šéšè—äº§å“çš„å†…éƒ¨ç»“æ„å’Œç»„è£…ç»†èŠ‚
- **ä»£ç å¤ç”¨**ï¼šç›¸åŒçš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“è¡¨ç¤º

</TabItem>
<TabItem value="drawbacks" label="ç¼ºç‚¹">

- **ä»£ç é‡å¢åŠ **ï¼šéœ€è¦åˆ›å»ºå¤šä¸ªæ–°çš„ç±»
- **ç‰¹å®šåœºæ™¯**ï¼šä»…é€‚ç”¨äºå¯¹è±¡ç›¸å¯¹å¤æ‚ä¸”åˆ›å»ºè¿‡ç¨‹ç¨³å®šçš„æƒ…å†µ
- **è€¦åˆé£é™©**ï¼šå…·ä½“å»ºé€ è€…å¯èƒ½ä¸äº§å“ç±»å­˜åœ¨è¾ƒå¼ºçš„è€¦åˆ

</TabItem>
</Tabs>

### 4.2 å®ç°æ–¹å¼

#### åŸºæœ¬å»ºé€ è€…æ¨¡å¼

```java title="å»ºé€ è€…æ¨¡å¼"
// äº§å“ç±»
public class Computer {
    private String cpu;
    private String memory;
    private String storage;
    private String graphics;
    private String motherboard;
    
    // ç§æœ‰æ„é€ å‡½æ•°
    private Computer() {}
    
    // Getteræ–¹æ³•
    public String getCpu() { return cpu; }
    public String getMemory() { return memory; }
    public String getStorage() { return storage; }
    public String getGraphics() { return graphics; }
    public String getMotherboard() { return motherboard; }
    
    @Override
    public String toString() {
        return String.format("Computer{cpu='%s', memory='%s', storage='%s', graphics='%s', motherboard='%s'}", 
                           cpu, memory, storage, graphics, motherboard);
    }
    
    // é™æ€å†…éƒ¨å»ºé€ è€…ç±»
    public static class Builder {
        private Computer computer = new Computer();
        
        public Builder cpu(String cpu) {
            computer.cpu = cpu;
            return this;
        }
        
        public Builder memory(String memory) {
            computer.memory = memory;
            return this;
        }
        
        public Builder storage(String storage) {
            computer.storage = storage;
            return this;
        }
        
        public Builder graphics(String graphics) {
            computer.graphics = graphics;
            return this;
        }
        
        public Builder motherboard(String motherboard) {
            computer.motherboard = motherboard;
            return this;
        }
        
        public Computer build() {
            // å‚æ•°æ ¡éªŒ
            validate();
            return computer;
        }
        
        private void validate() {
            if (computer.cpu == null) {
                throw new IllegalArgumentException("CPUä¸èƒ½ä¸ºç©º");
            }
            if (computer.memory == null) {
                throw new IllegalArgumentException("å†…å­˜ä¸èƒ½ä¸ºç©º");
            }
            if (computer.storage == null) {
                throw new IllegalArgumentException("å­˜å‚¨ä¸èƒ½ä¸ºç©º");
            }
        }
    }
}
```

#### ä½¿ç”¨æŒ‡å¯¼è€…çš„å»ºé€ è€…æ¨¡å¼

```java title="å¸¦æŒ‡å¯¼è€…çš„å»ºé€ è€…æ¨¡å¼"
// äº§å“ç±»
public class House {
    private String foundation;
    private String structure;
    private String roof;
    private String interior;
    
    public void setFoundation(String foundation) {
        this.foundation = foundation;
    }
    
    public void setStructure(String structure) {
        this.structure = structure;
    }
    
    public void setRoof(String roof) {
        this.roof = roof;
    }
    
    public void setInterior(String interior) {
        this.interior = interior;
    }
    
    @Override
    public String toString() {
        return String.format("House{foundation='%s', structure='%s', roof='%s', interior='%s'}", 
                           foundation, structure, roof, interior);
    }
}

// æŠ½è±¡å»ºé€ è€…
public interface HouseBuilder {
    void buildFoundation();
    void buildStructure();
    void buildRoof();
    void buildInterior();
    House getResult();
}

// å…·ä½“å»ºé€ è€… - ç –æˆ¿
public class BrickHouseBuilder implements HouseBuilder {
    private House house = new House();
    
    @Override
    public void buildFoundation() {
        house.setFoundation("æ··å‡åœŸåœ°åŸº");
    }
    
    @Override
    public void buildStructure() {
        house.setStructure("ç –å¢™ç»“æ„");
    }
    
    @Override
    public void buildRoof() {
        house.setRoof("å¹³å±‹é¡¶");
    }
    
    @Override
    public void buildInterior() {
        house.setInterior("æ ‡å‡†å†…éƒ¨è£…ä¿®");
    }
    
    @Override
    public House getResult() {
        return house;
    }
}

// å…·ä½“å»ºé€ è€… - æœ¨æˆ¿
public class WoodenHouseBuilder implements HouseBuilder {
    private House house = new House();
    
    @Override
    public void buildFoundation() {
        house.setFoundation("æ¡å½¢åœ°åŸº");
    }
    
    @Override
    public void buildStructure() {
        house.setStructure("æœ¨è´¨æ¡†æ¶ç»“æ„");
    }
    
    @Override
    public void buildRoof() {
        house.setRoof("å¡å±‹é¡¶");
    }
    
    @Override
    public void buildInterior() {
        house.setInterior("æœ¨è´¨å†…éƒ¨è£…ä¿®");
    }
    
    @Override
    public House getResult() {
        return house;
    }
}

// æŒ‡å¯¼è€…
public class HouseDirector {
    private HouseBuilder builder;
    
    public HouseDirector(HouseBuilder builder) {
        this.builder = builder;
    }
    
    public void changeBuilder(HouseBuilder builder) {
        this.builder = builder;
    }
    
    // æ„å»ºå®Œæ•´çš„æˆ¿å­
    public House buildFullFeaturedHouse() {
        builder.buildFoundation();
        builder.buildStructure();
        builder.buildRoof();
        builder.buildInterior();
        return builder.getResult();
    }
    
    // æ„å»ºç®€æ˜“çš„æˆ¿å­
    public House buildMinimalHouse() {
        builder.buildFoundation();
        builder.buildStructure();
        builder.buildRoof();
        return builder.getResult();
    }
}

// å®¢æˆ·ç«¯ä»£ç 
public class BuilderPatternDemo {
    public static void main(String[] args) {
        HouseBuilder brickBuilder = new BrickHouseBuilder();
        HouseBuilder woodenBuilder = new WoodenHouseBuilder();
        
        HouseDirector director = new HouseDirector(brickBuilder);
        
        // æ„å»ºç –æˆ¿
        House brickHouse = director.buildFullFeaturedHouse();
        System.out.println("ç –æˆ¿: " + brickHouse);
        
        // åˆ‡æ¢å»ºé€ è€…ï¼Œæ„å»ºæœ¨æˆ¿
        director.changeBuilder(woodenBuilder);
        House woodenHouse = director.buildMinimalHouse();
        System.out.println("ç®€æ˜“æœ¨æˆ¿: " + woodenHouse);
    }
}
```

### 4.3 å»ºé€ è€…æ¨¡å¼å˜ä½“

#### æµå¼å»ºé€ è€…æ¨¡å¼ï¼ˆé“¾å¼è°ƒç”¨ï¼‰

```java title="æµå¼å»ºé€ è€…"
// ä½¿ç”¨ç¤ºä¾‹
public class BuilderExample {
    public static void main(String[] args) {
        // æ„å»ºé«˜æ€§èƒ½ç”µè„‘
        Computer gamingComputer = new Computer.Builder()
                .cpu("Intel i9-12900K")
                .memory("32GB DDR5")
                .storage("2TB NVMe SSD")
                .graphics("RTX 4090")
                .motherboard("Z690")
                .build();
        
        System.out.println("æ¸¸æˆç”µè„‘: " + gamingComputer);
        
        // æ„å»ºåŠå…¬ç”µè„‘
        Computer officeComputer = new Computer.Builder()
                .cpu("Intel i5-12400")
                .memory("16GB DDR4")
                .storage("512GB SSD")
                .graphics("é›†æˆæ˜¾å¡")
                .motherboard("B660")
                .build();
        
        System.out.println("åŠå…¬ç”µè„‘: " + officeComputer);
    }
}
```

#### æ­¥è¿›å¼å»ºé€ è€…æ¨¡å¼

```java title="æ­¥è¿›å¼å»ºé€ è€…"
public class StepBuilder {
    // æ­¥è¿›æ¥å£
    public interface CpuStep {
        MemoryStep cpu(String cpu);
    }
    
    public interface MemoryStep {
        StorageStep memory(String memory);
    }
    
    public interface StorageStep {
        OptionalStep storage(String storage);
    }
    
    public interface OptionalStep {
        OptionalStep graphics(String graphics);
        OptionalStep motherboard(String motherboard);
        Computer build();
    }
    
    // å®ç°ç±»
    public static class ComputerBuilder implements CpuStep, MemoryStep, StorageStep, OptionalStep {
        private Computer computer = new Computer();
        
        private ComputerBuilder() {}
        
        public static CpuStep newBuilder() {
            return new ComputerBuilder();
        }
        
        @Override
        public MemoryStep cpu(String cpu) {
            computer.setCpu(cpu);
            return this;
        }
        
        @Override
        public StorageStep memory(String memory) {
            computer.setMemory(memory);
            return this;
        }
        
        @Override
        public OptionalStep storage(String storage) {
            computer.setStorage(storage);
            return this;
        }
        
        @Override
        public OptionalStep graphics(String graphics) {
            computer.setGraphics(graphics);
            return this;
        }
        
        @Override
        public OptionalStep motherboard(String motherboard) {
            computer.setMotherboard(motherboard);
            return this;
        }
        
        @Override
        public Computer build() {
            return computer;
        }
    }
}

// ä½¿ç”¨æ­¥è¿›å¼å»ºé€ è€…
Computer computer = StepBuilder.ComputerBuilder.newBuilder()
    .cpu("Intel i7")      // å¿…é¡»çš„
    .memory("16GB DDR4")  // å¿…é¡»çš„
    .storage("1TB SSD")   // å¿…é¡»çš„
    .graphics("RTX 3080") // å¯é€‰çš„
    .build();
```

### 4.4 åº”ç”¨åœºæ™¯

<Tabs>
<TabItem value="config" label="æ•°æ®åº“é…ç½®æ„å»ºå™¨">

```java title="æ•°æ®åº“é…ç½®å»ºé€ è€…"
public class DatabaseConfig {
    private String host;
    private int port;
    private String database;
    private String username;
    private String password;
    private int maxConnections;
    private int timeout;
    
    private DatabaseConfig() {}
    
    // Getteræ–¹æ³•...
    
    public static class Builder {
        private DatabaseConfig config = new DatabaseConfig();
        
        public Builder host(String host) {
            config.host = host;
            return this;
        }
        
        public Builder port(int port) {
            config.port = port;
            return this;
        }
        
        public Builder database(String database) {
            config.database = database;
            return this;
        }
        
        public Builder username(String username) {
            config.username = username;
            return this;
        }
        
        public Builder password(String password) {
            config.password = password;
            return this;
        }
        
        public Builder maxConnections(int maxConnections) {
            config.maxConnections = maxConnections;
            return this;
        }
        
        public Builder timeout(int timeout) {
            config.timeout = timeout;
            return this;
        }
        
        public DatabaseConfig build() {
            // è®¾ç½®é»˜è®¤å€¼
            if (config.port == 0) {
                config.port = 3306;
            }
            if (config.maxConnections == 0) {
                config.maxConnections = 10;
            }
            if (config.timeout == 0) {
                config.timeout = 30;
            }
            
            validate();
            return config;
        }
        
        private void validate() {
            if (config.host == null || config.host.trim().isEmpty()) {
                throw new IllegalArgumentException("ä¸»æœºåœ°å€ä¸èƒ½ä¸ºç©º");
            }
            if (config.database == null || config.database.trim().isEmpty()) {
                throw new IllegalArgumentException("æ•°æ®åº“åä¸èƒ½ä¸ºç©º");
            }
            if (config.username == null || config.username.trim().isEmpty()) {
                throw new IllegalArgumentException("ç”¨æˆ·åä¸èƒ½ä¸ºç©º");
            }
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
DatabaseConfig config = new DatabaseConfig.Builder()
    .host("localhost")
    .port(3306)
    .database("mydb")
    .username("user")
    .password("pass")
    .maxConnections(20)
    .build();
```

</TabItem>
<TabItem value="http-client" label="HTTPå®¢æˆ·ç«¯æ„å»ºå™¨">

```java title="HTTPå®¢æˆ·ç«¯æ„å»ºå™¨"
public class HttpClient {
    private String baseUrl;
    private int connectionTimeout;
    private int readTimeout;
    private Map<String, String> headers;
    private String authToken;
    private boolean followRedirects;
    private int maxRetries;
    
    private HttpClient() {
        this.headers = new HashMap<>();
    }
    
    // é™æ€å†…éƒ¨å»ºé€ è€…ç±»
    public static class Builder {
        private HttpClient client = new HttpClient();
        
        public Builder baseUrl(String baseUrl) {
            client.baseUrl = baseUrl;
            return this;
        }
        
        public Builder connectionTimeout(int connectionTimeout) {
            client.connectionTimeout = connectionTimeout;
            return this;
        }
        
        public Builder readTimeout(int readTimeout) {
            client.readTimeout = readTimeout;
            return this;
        }
        
        public Builder header(String key, String value) {
            client.headers.put(key, value);
            return this;
        }
        
        public Builder authToken(String authToken) {
            client.authToken = authToken;
            return this;
        }
        
        public Builder followRedirects(boolean followRedirects) {
            client.followRedirects = followRedirects;
            return this;
        }
        
        public Builder maxRetries(int maxRetries) {
            client.maxRetries = maxRetries;
            return this;
        }
        
        public HttpClient build() {
            // è®¾ç½®é»˜è®¤å€¼
            if (client.connectionTimeout == 0) {
                client.connectionTimeout = 5000;
            }
            if (client.readTimeout == 0) {
                client.readTimeout = 10000;
            }
            
            // éªŒè¯å¿…è¦å‚æ•°
            validate();
            
            return client;
        }
        
        private void validate() {
            if (client.baseUrl == null || client.baseUrl.trim().isEmpty()) {
                throw new IllegalArgumentException("åŸºç¡€URLä¸èƒ½ä¸ºç©º");
            }
        }
    }
    
    public void execute(String path, String method) {
        System.out.println("æ‰§è¡ŒHTTPè¯·æ±‚ï¼š" + method + " " + baseUrl + path);
        System.out.println("è¿æ¥è¶…æ—¶ï¼š" + connectionTimeout + "msï¼Œè¯»å–è¶…æ—¶ï¼š" + readTimeout + "ms");
        System.out.println("å¤´éƒ¨ä¿¡æ¯ï¼š" + headers);
        if (authToken != null) {
            System.out.println("æˆæƒä»¤ç‰Œï¼š" + authToken);
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
HttpClient client = new HttpClient.Builder()
    .baseUrl("https://api.example.com")
    .connectionTimeout(3000)
    .readTimeout(5000)
    .header("Content-Type", "application/json")
    .header("Accept", "application/json")
    .authToken("my-auth-token")
    .followRedirects(true)
    .maxRetries(3)
    .build();

client.execute("/users", "GET");
```

</TabItem>
<TabItem value="document-builder" label="æ–‡æ¡£æ„å»ºå™¨">

```java title="æ–‡æ¡£æ„å»ºå™¨"
public class Document {
    private String title;
    private String header;
    private String content;
    private String footer;
    private List<String> sections;
    private String author;
    private LocalDate creationDate;
    
    private Document() {
        this.sections = new ArrayList<>();
        this.creationDate = LocalDate.now();
    }
    
    // Getteræ–¹æ³•...
    
    public static class Builder {
        private Document document = new Document();
        
        public Builder title(String title) {
            document.title = title;
            return this;
        }
        
        public Builder header(String header) {
            document.header = header;
            return this;
        }
        
        public Builder content(String content) {
            document.content = content;
            return this;
        }
        
        public Builder footer(String footer) {
            document.footer = footer;
            return this;
        }
        
        public Builder addSection(String section) {
            document.sections.add(section);
            return this;
        }
        
        public Builder author(String author) {
            document.author = author;
            return this;
        }
        
        public Builder creationDate(LocalDate creationDate) {
            document.creationDate = creationDate;
            return this;
        }
        
        public Document build() {
            validate();
            return document;
        }
        
        private void validate() {
            if (document.title == null || document.title.trim().isEmpty()) {
                throw new IllegalArgumentException("æ–‡æ¡£æ ‡é¢˜ä¸èƒ½ä¸ºç©º");
            }
            if (document.content == null || document.content.trim().isEmpty()) {
                throw new IllegalArgumentException("æ–‡æ¡£å†…å®¹ä¸èƒ½ä¸ºç©º");
            }
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
Document report = new Document.Builder()
    .title("å­£åº¦é”€å”®æŠ¥å‘Š")
    .header("2023å¹´ç¬¬ä¸‰å­£åº¦")
    .content("é”€å”®é¢è¾¾åˆ°1000ä¸‡å…ƒ...")
    .addSection("é”€å”®åˆ†æ")
    .addSection("å¸‚åœºè¶‹åŠ¿")
    .addSection("æœªæ¥å±•æœ›")
    .footer("æŠ¥å‘Šç»“æŸ")
    .author("å¼ ä¸‰")
    .build();
```

</TabItem>
</Tabs>

### 4.5 å»ºé€ è€…æ¨¡å¼ä¸å…¶ä»–æ¨¡å¼çš„å¯¹æ¯”

| ç‰¹æ€§ | å»ºé€ è€…æ¨¡å¼ | å·¥å‚æ–¹æ³• | æŠ½è±¡å·¥å‚ |
|-----|----------|---------|---------|
| **ç›®çš„** | åˆ†æ­¥åˆ›å»ºå¤æ‚å¯¹è±¡ | åˆ›å»ºå•ä¸ªäº§å“ | åˆ›å»ºäº§å“æ— |
| **å…³æ³¨ç‚¹** | åˆ›å»ºè¿‡ç¨‹å’Œæ­¥éª¤ | äº§å“ç±»å‹ | äº§å“æ—å’Œå…¼å®¹æ€§ |
| **å¯æ§æ€§** | é«˜ï¼ˆåˆ†æ­¥æ„å»ºï¼‰ | ä½ï¼ˆä¸€æ¬¡åˆ›å»ºï¼‰ | ä¸­ï¼ˆå…³è”åˆ›å»ºï¼‰ |
| **å¤æ‚åº¦** | ä¸­ç­‰ | è¾ƒä½ | é«˜ |
| **é“¾å¼API** | æ”¯æŒ | é€šå¸¸ä¸æ”¯æŒ | é€šå¸¸ä¸æ”¯æŒ |
| **å‚æ•°æ ¡éªŒ** | é›†ä¸­å¤„ç† | åˆ†æ•£å¤„ç† | åˆ†æ•£å¤„ç† |

:::tip å»ºé€ è€…æ¨¡å¼æœ€ä½³å®è·µ
1. **é€‚å½“çš„å°è£…**ï¼šä½¿ç”¨ç§æœ‰æ„é€ å‡½æ•°å¼ºåˆ¶é€šè¿‡å»ºé€ è€…åˆ›å»ºå¯¹è±¡
2. **å‚æ•°æ ¡éªŒ**ï¼šåœ¨`build()`æ–¹æ³•ä¸­é›†ä¸­è¿›è¡Œå‚æ•°éªŒè¯
3. **é»˜è®¤å€¼å¤„ç†**ï¼šä¸ºéå¿…é¡»å‚æ•°æä¾›åˆç†çš„é»˜è®¤å€¼
4. **æ–¹æ³•å‘½å**ï¼šä½¿ç”¨æè¿°æ€§çš„æ–¹æ³•åï¼Œä½¿æ„å»ºè¿‡ç¨‹æ›´æ˜“è¯»
5. **å»ºé€ è€…å†…ç½®**ï¼šè€ƒè™‘å°†å»ºé€ è€…ç±»è®¾è®¡ä¸ºäº§å“ç±»çš„å†…éƒ¨ç±»
6. **æµå¼æ¥å£**ï¼šæ”¯æŒæ–¹æ³•é“¾ï¼ˆé“¾å¼è°ƒç”¨ï¼‰ä»¥æé«˜ä»£ç å¯è¯»æ€§
:::

## 5. åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰

### 5.1 æ¨¡å¼å®šä¹‰

åŸå‹æ¨¡å¼é€šè¿‡å¤åˆ¶ç°æœ‰å¯¹è±¡æ¥åˆ›å»ºæ–°å¯¹è±¡ï¼Œè€Œä¸æ˜¯é€šè¿‡å®ä¾‹åŒ–ç±»ã€‚å½“åˆ›å»ºå¯¹è±¡çš„æˆæœ¬è¾ƒé«˜ï¼Œä¸”å¯¹è±¡ä¹‹é—´å­˜åœ¨ç›¸ä¼¼æ€§æ—¶ï¼Œä½¿ç”¨åŸå‹æ¨¡å¼å¯ä»¥æé«˜æ€§èƒ½å¹¶ç®€åŒ–å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ã€‚

```mermaid
graph TD
    A[å®¢æˆ·ç«¯] -->|å…‹éš†| B[åŸå‹æ¥å£<br>Prototype]
    B -->|ç»§æ‰¿| C[å…·ä½“åŸå‹A<br>ConcretePrototypeA]
    B -->|ç»§æ‰¿| D[å…·ä½“åŸå‹B<br>ConcretePrototypeB]
    C -->|"clone()"| E[Açš„å¤åˆ¶å“]
    D -->|"clone()"| F[Bçš„å¤åˆ¶å“]
    
    style B fill:#f9f9f9,stroke:#333,stroke-width:2px
    style C fill:#e6f7ff,stroke:#1890ff
    style D fill:#e6f7ff,stroke:#1890ff
    style E fill:#f6ffed,stroke:#52c41a
    style F fill:#f6ffed,stroke:#52c41a
```

<Tabs>
<TabItem value="when-to-use" label="é€‚ç”¨åœºæ™¯">

- **åˆ›å»ºæˆæœ¬é«˜**ï¼šå½“å¯¹è±¡åˆ›å»ºè¿‡ç¨‹å¤æ‚æˆ–ä»£ä»·é«˜æ˜‚æ—¶
- **é¿å…ç»§æ‰¿**ï¼šå½“ç³»ç»Ÿåº”è¯¥ç‹¬ç«‹äºäº§å“åˆ›å»ºã€ç»„åˆå’Œè¡¨ç¤ºæ—¶
- **åŠ¨æ€é…ç½®**ï¼šè¿è¡Œæ—¶éœ€è¦åŠ¨æ€æ·»åŠ å’Œç§»é™¤äº§å“æ—¶
- **é¿å…é‡å¤åˆå§‹åŒ–**ï¼šéœ€è¦åˆ›å»ºä¸ç°æœ‰å¯¹è±¡ç›¸ä¼¼çš„å¯¹è±¡æ—¶

</TabItem>
<TabItem value="benefits" label="ä¼˜ç‚¹">

- **æ€§èƒ½ä¼˜åŒ–**ï¼šé¿å…äº†é‡å¤çš„åˆå§‹åŒ–è¿‡ç¨‹
- **åŠ¨æ€åˆ›å»º**ï¼šåœ¨è¿è¡Œæ—¶æŒ‡å®šåˆ›å»ºçš„å¯¹è±¡
- **å¯¹è±¡å¤åˆ¶**ï¼šå¤åˆ¶å¯¹è±¡è€Œä¸ä¾èµ–å…·ä½“ç±»
- **åˆ›å»ºé¢„é…ç½®å¯¹è±¡**ï¼šå¯ä»¥åˆ›å»ºé¢„é…ç½®çš„å¯¹è±¡æ¨¡æ¿

</TabItem>
<TabItem value="drawbacks" label="ç¼ºç‚¹">

- **æ·±æ‹·è´å¤æ‚**ï¼šåŒ…å«å¾ªç¯å¼•ç”¨æˆ–å¤æ‚å¯¹è±¡çš„æ·±æ‹·è´å®ç°å›°éš¾
- **æ„é€ å‡½æ•°é™åˆ¶**ï¼šå…‹éš†è¿‡ç¨‹ç»•è¿‡äº†æ„é€ å‡½æ•°
- **çŠ¶æ€ä¸€è‡´æ€§**ï¼šéš¾ä»¥ç»´æŠ¤å¯¹è±¡é—´çš„å…³è”å’ŒçŠ¶æ€ä¸€è‡´æ€§

</TabItem>
</Tabs>

### 5.2 å®ç°æ–¹å¼

#### åŸºæœ¬åŸå‹æ¨¡å¼

```java title="åŸå‹æ¨¡å¼"
// åŸå‹æ¥å£
public interface Prototype extends Cloneable {
    Prototype clone();
    void display();
}

// å…·ä½“åŸå‹
public class ConcretePrototype implements Prototype {
    private String name;
    private List<String> attributes = new ArrayList<>();
    
    public ConcretePrototype(String name) {
        this.name = name;
        this.attributes.add("å±æ€§1");
        this.attributes.add("å±æ€§2");
    }
    
    @Override
    public Prototype clone() {
        try {
            ConcretePrototype clone = (ConcretePrototype) super.clone();
            // æ·±æ‹·è´
            clone.attributes = new ArrayList<>(this.attributes);
            return clone;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    @Override
    public void display() {
        System.out.println("åŸå‹åç§°: " + name);
        System.out.println("å±æ€§: " + attributes);
    }
    
    public void addAttribute(String attribute) {
        this.attributes.add(attribute);
    }
    
    public void setName(String name) {
        this.name = name;
    }
}
```

#### åŸå‹ç®¡ç†å™¨

```java title="åŸå‹ç®¡ç†å™¨"
public class PrototypeManager {
    private Map<String, Prototype> prototypes = new HashMap<>();
    
    public void addPrototype(String key, Prototype prototype) {
        prototypes.put(key, prototype);
    }
    
    public Prototype getPrototype(String key) {
        Prototype prototype = prototypes.get(key);
        if (prototype != null) {
            return prototype.clone();
        }
        return null;
    }
    
    public void removePrototype(String key) {
        prototypes.remove(key);
    }
}

// ä½¿ç”¨ç¤ºä¾‹
public class PrototypeExample {
    public static void main(String[] args) {
        PrototypeManager manager = new PrototypeManager();
        
        // æ·»åŠ åŸå‹
        ConcretePrototype prototype1 = new ConcretePrototype("åŸå‹1");
        manager.addPrototype("type1", prototype1);
        
        // å…‹éš†åŸå‹
        Prototype clone1 = manager.getPrototype("type1");
        Prototype clone2 = manager.getPrototype("type1");
        
        // ä¿®æ”¹å…‹éš†å¯¹è±¡
        if (clone1 instanceof ConcretePrototype) {
            ((ConcretePrototype) clone1).setName("å…‹éš†1");
            ((ConcretePrototype) clone1).addAttribute("æ–°å±æ€§");
        }
        
        // æ˜¾ç¤ºç»“æœ
        prototype1.display();
        clone1.display();
        clone2.display();
    }
}
```

### 5.3 æ·±æ‹·è´ä¸æµ…æ‹·è´

<Tabs>
<TabItem value="shallow" label="æµ…æ‹·è´">

```java title="æµ…æ‹·è´å®ç°"
public class ShallowCopy implements Cloneable {
    private String name;
    private List<String> items;
    
    public ShallowCopy(String name) {
        this.name = name;
        this.items = new ArrayList<>();
    }
    
    public void addItem(String item) {
        items.add(item);
    }
    
    @Override
    public ShallowCopy clone() {
        try {
            // æµ…æ‹·è´ï¼šå¼•ç”¨ç±»å‹æˆå‘˜å˜é‡å…±äº«å¼•ç”¨
            return (ShallowCopy) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    @Override
    public String toString() {
        return "ShallowCopy{name='" + name + "', items=" + items + "}";
    }
    
    // Getterå’ŒSetteræ–¹æ³•
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    public List<String> getItems() { return items; }
}

// ä½¿ç”¨ç¤ºä¾‹
ShallowCopy original = new ShallowCopy("åŸå§‹å¯¹è±¡");
original.addItem("æ¡ç›®1");
original.addItem("æ¡ç›®2");

ShallowCopy clone = original.clone();
clone.setName("å…‹éš†å¯¹è±¡");
clone.getItems().add("æ¡ç›®3"); // ä¿®æ”¹å…‹éš†å¯¹è±¡çš„åˆ—è¡¨

System.out.println("åŸå§‹å¯¹è±¡: " + original); // è¾“å‡ºä¹ŸåŒ…å«"æ¡ç›®3"
System.out.println("å…‹éš†å¯¹è±¡: " + clone);
```

</TabItem>
<TabItem value="deep" label="æ·±æ‹·è´">

```java title="æ·±æ‹·è´å®ç°"
public class DeepCopy implements Cloneable {
    private String name;
    private List<String> items;
    
    public DeepCopy(String name) {
        this.name = name;
        this.items = new ArrayList<>();
    }
    
    public void addItem(String item) {
        items.add(item);
    }
    
    @Override
    public DeepCopy clone() {
        try {
            DeepCopy clone = (DeepCopy) super.clone();
            // æ·±æ‹·è´ï¼šåˆ›å»ºå¼•ç”¨ç±»å‹æˆå‘˜å˜é‡çš„æ–°å®ä¾‹
            clone.items = new ArrayList<>(this.items);
            return clone;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    @Override
    public String toString() {
        return "DeepCopy{name='" + name + "', items=" + items + "}";
    }
    
    // Getterå’ŒSetteræ–¹æ³•
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    public List<String> getItems() { return items; }
}

// ä½¿ç”¨ç¤ºä¾‹
DeepCopy original = new DeepCopy("åŸå§‹å¯¹è±¡");
original.addItem("æ¡ç›®1");
original.addItem("æ¡ç›®2");

DeepCopy clone = original.clone();
clone.setName("å…‹éš†å¯¹è±¡");
clone.getItems().add("æ¡ç›®3"); // ä¿®æ”¹å…‹éš†å¯¹è±¡çš„åˆ—è¡¨

System.out.println("åŸå§‹å¯¹è±¡: " + original); // ä¸åŒ…å«"æ¡ç›®3"
System.out.println("å…‹éš†å¯¹è±¡: " + clone);
```

</TabItem>
<TabItem value="serialization" label="åºåˆ—åŒ–å®ç°æ·±æ‹·è´">

```java title="é€šè¿‡åºåˆ—åŒ–å®ç°æ·±æ‹·è´"
public class SerializableDeepCopy implements Serializable {
    private static final long serialVersionUID = 1L;
    
    private String name;
    private List<String> items;
    
    public SerializableDeepCopy(String name) {
        this.name = name;
        this.items = new ArrayList<>();
    }
    
    public void addItem(String item) {
        items.add(item);
    }
    
    // é€šè¿‡åºåˆ—åŒ–å®ç°æ·±æ‹·è´
    public SerializableDeepCopy deepCopy() {
        try {
            ByteArrayOutputStream bos = new ByteArrayOutputStream();
            ObjectOutputStream oos = new ObjectOutputStream(bos);
            oos.writeObject(this);
            
            ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray());
            ObjectInputStream ois = new ObjectInputStream(bis);
            return (SerializableDeepCopy) ois.readObject();
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
    
    @Override
    public String toString() {
        return "SerializableDeepCopy{name='" + name + "', items=" + items + "}";
    }
    
    // Getterå’ŒSetteræ–¹æ³•
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    public List<String> getItems() { return items; }
}
```

</TabItem>
</Tabs>

### 5.4 åº”ç”¨åœºæ™¯

<Tabs>
<TabItem value="document-template" label="æ–‡æ¡£æ¨¡æ¿ç³»ç»Ÿ">

```java title="æ–‡æ¡£æ¨¡æ¿ç³»ç»Ÿ"
public abstract class Document implements Cloneable {
    protected String title;
    protected String content;
    protected List<String> sections = new ArrayList<>();
    
    public abstract void display();
    
    @Override
    public Document clone() {
        try {
            Document clone = (Document) super.clone();
            // æ·±æ‹·è´
            clone.sections = new ArrayList<>(this.sections);
            return clone;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    public void setTitle(String title) {
        this.title = title;
    }
    
    public void setContent(String content) {
        this.content = content;
    }
    
    public void addSection(String section) {
        this.sections.add(section);
    }
}

public class ReportDocument extends Document {
    @Override
    public void display() {
        System.out.println("æŠ¥å‘Šæ–‡æ¡£: " + title);
        System.out.println("å†…å®¹: " + content);
        System.out.println("ç« èŠ‚: " + sections);
    }
}

public class ProposalDocument extends Document {
    @Override
    public void display() {
        System.out.println("ææ¡ˆæ–‡æ¡£: " + title);
        System.out.println("å†…å®¹: " + content);
        System.out.println("ç« èŠ‚: " + sections);
    }
}

// æ–‡æ¡£æ¨¡æ¿ç®¡ç†å™¨
public class DocumentTemplateManager {
    private Map<String, Document> templates = new HashMap<>();
    
    public void addTemplate(String name, Document template) {
        templates.put(name, template);
    }
    
    public Document createDocument(String templateName) {
        Document template = templates.get(templateName);
        if (template != null) {
            return template.clone();
        }
        return null;
    }
}
```

</TabItem>
<TabItem value="configuration" label="é…ç½®å¤åˆ¶">

```java title="é…ç½®å¤åˆ¶ç³»ç»Ÿ"
public class AppConfig implements Cloneable {
    private Map<String, Object> settings = new HashMap<>();
    private List<String> features = new ArrayList<>();
    
    // åˆå§‹åŒ–é»˜è®¤é…ç½®
    public AppConfig() {
        settings.put("timeout", 3000);
        settings.put("maxConnections", 100);
        settings.put("cacheEnabled", true);
        
        features.add("basic");
    }
    
    public void addSetting(String key, Object value) {
        settings.put(key, value);
    }
    
    public Object getSetting(String key) {
        return settings.get(key);
    }
    
    public void enableFeature(String feature) {
        features.add(feature);
    }
    
    @Override
    public AppConfig clone() {
        try {
            AppConfig clone = (AppConfig) super.clone();
            // æ·±æ‹·è´
            clone.settings = new HashMap<>(this.settings);
            clone.features = new ArrayList<>(this.features);
            return clone;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    @Override
    public String toString() {
        return "AppConfig{settings=" + settings + ", features=" + features + "}";
    }
}

// ä½¿ç”¨ç¤ºä¾‹
public class ConfigExample {
    public static void main(String[] args) {
        // åˆ›å»ºåŸºæœ¬é…ç½®
        AppConfig baseConfig = new AppConfig();
        
        // åˆ›å»ºå¼€å‘ç¯å¢ƒé…ç½®
        AppConfig devConfig = baseConfig.clone();
        devConfig.addSetting("debugEnabled", true);
        devConfig.enableFeature("development");
        
        // åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®
        AppConfig prodConfig = baseConfig.clone();
        prodConfig.addSetting("debugEnabled", false);
        prodConfig.addSetting("timeout", 1000);
        prodConfig.enableFeature("monitoring");
        
        System.out.println("å¼€å‘ç¯å¢ƒé…ç½®: " + devConfig);
        System.out.println("ç”Ÿäº§ç¯å¢ƒé…ç½®: " + prodConfig);
    }
}
```

</TabItem>
<TabItem value="gui-shapes" label="å›¾å½¢ç¼–è¾‘å™¨">

```java title="å›¾å½¢ç¼–è¾‘å™¨"
public abstract class Shape implements Cloneable {
    private int x;
    private int y;
    private String color;
    
    public Shape(int x, int y, String color) {
        this.x = x;
        this.y = y;
        this.color = color;
    }
    
    public abstract void draw();
    
    @Override
    public Shape clone() {
        try {
            return (Shape) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // Getterå’ŒSetteræ–¹æ³•
    public int getX() { return x; }
    public void setX(int x) { this.x = x; }
    public int getY() { return y; }
    public void setY(int y) { this.y = y; }
    public String getColor() { return color; }
    public void setColor(String color) { this.color = color; }
}

public class Circle extends Shape {
    private int radius;
    
    public Circle(int x, int y, String color, int radius) {
        super(x, y, color);
        this.radius = radius;
    }
    
    @Override
    public void draw() {
        System.out.println("ç»˜åˆ¶åœ†å½¢: åæ ‡(" + getX() + "," + getY() + 
                         "), é¢œè‰²=" + getColor() + ", åŠå¾„=" + radius);
    }
    
    public int getRadius() { return radius; }
    public void setRadius(int radius) { this.radius = radius; }
}

public class Rectangle extends Shape {
    private int width;
    private int height;
    
    public Rectangle(int x, int y, String color, int width, int height) {
        super(x, y, color);
        this.width = width;
        this.height = height;
    }
    
    @Override
    public void draw() {
        System.out.println("ç»˜åˆ¶çŸ©å½¢: åæ ‡(" + getX() + "," + getY() + 
                         "), é¢œè‰²=" + getColor() + 
                         ", å®½=" + width + ", é«˜=" + height);
    }
    
    public int getWidth() { return width; }
    public void setWidth(int width) { this.width = width; }
    public int getHeight() { return height; }
    public void setHeight(int height) { this.height = height; }
}

// å›¾å½¢ç¼–è¾‘å™¨
public class GraphicEditor {
    private Map<String, Shape> shapeTemplates = new HashMap<>();
    
    public GraphicEditor() {
        // åˆå§‹åŒ–å½¢çŠ¶æ¨¡æ¿
        shapeTemplates.put("circle", new Circle(0, 0, "red", 10));
        shapeTemplates.put("rectangle", new Rectangle(0, 0, "blue", 20, 10));
    }
    
    public Shape createShape(String type) {
        Shape template = shapeTemplates.get(type);
        if (template != null) {
            return template.clone();
        }
        return null;
    }
}
```

</TabItem>
</Tabs>

### 5.5 åŸå‹æ¨¡å¼ä¸å…¶ä»–æ¨¡å¼å¯¹æ¯”

| ç‰¹æ€§ | åŸå‹æ¨¡å¼ | å·¥å‚æ–¹æ³• | å»ºé€ è€…æ¨¡å¼ |
|------|---------|---------|-----------|
| **åˆ›å»ºæœºåˆ¶** | å…‹éš†ç°æœ‰å¯¹è±¡ | åˆ›å»ºæ–°å¯¹è±¡ | åˆ†æ­¥æ„å»ºå¯¹è±¡ |
| **å¤æ‚åº¦** | ä½ï¼ˆç›´æ¥å¤åˆ¶ï¼‰ | ä¸­ç­‰ | é«˜ï¼ˆå¤šæ­¥éª¤ï¼‰ |
| **ä½¿ç”¨æ—¶æœº** | é¿å…é‡å¤åˆå§‹åŒ– | å°è£…åˆ›å»ºé€»è¾‘ | å¤æ‚å¯¹è±¡æ„å»º |
| **å®ç°æ–¹æ³•** | å®ç°clone()æ–¹æ³• | å­ç±»åŒ–åˆ›å»ºè€… | æ„å»ºå™¨æˆ–æŒ‡å¯¼è€… |
| **ä¼˜åŠ¿** | æ€§èƒ½å¥½ï¼Œé¿å…åˆå§‹åŒ– | æ‰©å±•æ€§å¥½ | çµæ´»æ€§é«˜ï¼Œå‚æ•°æ§åˆ¶ |
| **åŠ£åŠ¿** | æ·±æ‹·è´å¤æ‚ | ç±»çˆ†ç‚¸ | ä»£ç é‡å¢åŠ  |

:::tip åŸå‹æ¨¡å¼æœ€ä½³å®è·µ
1. **ä¼˜å…ˆä½¿ç”¨æ·±æ‹·è´**ï¼šç¡®ä¿å¯¹è±¡åŠå…¶å†…éƒ¨å¯¹è±¡éƒ½è¢«æ­£ç¡®å…‹éš†
2. **å¤„ç†ç‰¹æ®Šå¼•ç”¨**ï¼šæ³¨æ„å¤„ç†å¾ªç¯å¼•ç”¨å’Œä¸å¯å…‹éš†çš„å¯¹è±¡
3. **ä½¿ç”¨åºåˆ—åŒ–**ï¼šå¯¹äºå¤æ‚å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨åºåˆ—åŒ–å®ç°æ·±æ‹·è´
4. **é¿å…å‰¯ä½œç”¨**ï¼šç¡®ä¿å…‹éš†æ“ä½œä¸ä¼šå¯¹åŸå¯¹è±¡äº§ç”Ÿå‰¯ä½œç”¨
5. **æ¨¡æ¿æ³¨å†Œä¸­å¿ƒ**ï¼šä½¿ç”¨åŸå‹ç®¡ç†å™¨æ³¨å†Œå’Œç®¡ç†åŸå‹å¯¹è±¡
:::

## 6. åˆ›å»ºå‹æ¨¡å¼å¯¹æ¯”

### 6.1 æ¨¡å¼é€‰æ‹©æŒ‡å—

```mermaid
graph TD
    A[éœ€è¦åˆ›å»ºå¯¹è±¡] --> B{å•ä¸€å¯¹è±¡?}
    B -->|æ˜¯| C{å…¨å±€å”¯ä¸€?}
    B -->|å¦| D{äº§å“æ—?}
    
    C -->|æ˜¯| E[å•ä¾‹æ¨¡å¼]
    C -->|å¦| F{å¯¹è±¡å¤æ‚?}
    
    D -->|æ˜¯| G[æŠ½è±¡å·¥å‚]
    D -->|å¦| H{å¤šä¸ªå˜ä½“?}
    
    F -->|æ˜¯| I[å»ºé€ è€…æ¨¡å¼]
    F -->|å¦| J{å¯å¤åˆ¶?}
    
    H -->|æ˜¯| K[å·¥å‚æ–¹æ³•]
    H -->|å¦| L[ç®€å•å·¥å‚]
    
    J -->|æ˜¯| M[åŸå‹æ¨¡å¼]
    J -->|å¦| N[ç›´æ¥new]
    
    style E fill:#e6f7ff,stroke:#1890ff
    style G fill:#e6f7ff,stroke:#1890ff
    style I fill:#e6f7ff,stroke:#1890ff
    style K fill:#e6f7ff,stroke:#1890ff
    style M fill:#e6f7ff,stroke:#1890ff
```

| æ¨¡å¼ | é€‚ç”¨åœºæ™¯ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|----------|------|------|
| **å•ä¾‹æ¨¡å¼** | å…¨å±€å”¯ä¸€å®ä¾‹ | èŠ‚çœå†…å­˜ï¼Œå…¨å±€è®¿é—® | å¯èƒ½æˆä¸ºå…¨å±€çŠ¶æ€ |
| **å·¥å‚æ–¹æ³•** | å»¶è¿Ÿå®ä¾‹åŒ–ï¼Œæ‰©å±•äº§å“ | ç¬¦åˆå¼€é—­åŸåˆ™ | å¢åŠ ç±»çš„æ•°é‡ |
| **æŠ½è±¡å·¥å‚** | äº§å“æ—åˆ›å»º | ä¿è¯äº§å“å…¼å®¹æ€§ | æ‰©å±•æ–°äº§å“æ—å›°éš¾ |
| **å»ºé€ è€…** | å¤æ‚å¯¹è±¡æ„å»º | å‚æ•°æ ¡éªŒï¼Œé“¾å¼è°ƒç”¨ | å¢åŠ ä»£ç å¤æ‚åº¦ |
| **åŸå‹** | å¯¹è±¡å…‹éš† | é¿å…é‡å¤åˆå§‹åŒ– | æ·±æ‹·è´å¼€é”€ |

### 6.2 æ€§èƒ½è€ƒè™‘

åˆ›å»ºå‹æ¨¡å¼åœ¨æ€§èƒ½ä¸Šå„æœ‰ä¼˜åŠ£ï¼Œé€‰æ‹©åˆé€‚çš„æ¨¡å¼éœ€è¦è€ƒè™‘åº”ç”¨åœºæ™¯å’Œæ€§èƒ½éœ€æ±‚ï¼š

```java title="æ€§èƒ½å¯¹æ¯”ç¤ºä¾‹"
// å•ä¾‹æ¨¡å¼ - å†…å­˜å ç”¨æœ€å°
public class SingletonExample {
    private static SingletonExample instance;
    
    public static SingletonExample getInstance() {
        if (instance == null) {
            instance = new SingletonExample();
        }
        return instance;
    }
}

// å·¥å‚æ¨¡å¼ - å¯¹è±¡åˆ›å»ºå¼€é”€
public class FactoryExample {
    public Product createProduct(String type) {
        // æ¯æ¬¡è°ƒç”¨éƒ½å¯èƒ½åˆ›å»ºæ–°å¯¹è±¡
        switch (type) {
            case "A": return new ProductA();
            case "B": return new ProductB();
            default: throw new IllegalArgumentException();
        }
    }
}

// åŸå‹æ¨¡å¼ - å…‹éš†å¼€é”€
public class PrototypeExample implements Cloneable {
    private List<String> data = new ArrayList<>();
    
    @Override
    public PrototypeExample clone() {
        try {
            PrototypeExample clone = (PrototypeExample) super.clone();
            // æ·±æ‹·è´å¼€é”€
            clone.data = new ArrayList<>(this.data);
            return clone;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
}
```

<Tabs>
<TabItem value="memory" label="å†…å­˜ä½¿ç”¨">

| æ¨¡å¼ | å†…å­˜ä½¿ç”¨ | æè¿° |
|------|---------|------|
| å•ä¾‹ | â­â­â­â­â­ | æœ€ä¼˜ï¼ˆåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼‰ |
| å·¥å‚æ–¹æ³• | â­â­â­ | ä¸­ç­‰ï¼ˆæ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡ï¼‰ |
| æŠ½è±¡å·¥å‚ | â­â­â­ | ä¸­ç­‰ï¼ˆæ¯ä¸ªäº§å“æ—åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼‰ |
| å»ºé€ è€… | â­â­ | è¾ƒé«˜ï¼ˆä¸­é—´çŠ¶æ€å ç”¨å†…å­˜ï¼‰ |
| åŸå‹ | â­â­â­â­ | è‰¯å¥½ï¼ˆå¤ç”¨ç°æœ‰å¯¹è±¡ç»“æ„ï¼‰ |

</TabItem>
<TabItem value="cpu" label="CPUä½¿ç”¨">

| æ¨¡å¼ | CPUä½¿ç”¨ | æè¿° |
|------|--------|------|
| å•ä¾‹ | â­â­â­â­â­ | æœ€ä¼˜ï¼ˆä»…åˆå§‹åŒ–ä¸€æ¬¡ï¼‰ |
| å·¥å‚æ–¹æ³• | â­â­â­ | ä¸­ç­‰ï¼ˆæ¯æ¬¡åˆ›å»ºéœ€åˆå§‹åŒ–ï¼‰ |
| æŠ½è±¡å·¥å‚ | â­â­â­ | ä¸­ç­‰ï¼ˆåˆ›å»ºå¤šä¸ªç›¸å…³å¯¹è±¡ï¼‰ |
| å»ºé€ è€… | â­â­ | è¾ƒé«˜ï¼ˆå¤šæ­¥éª¤åˆ›å»ºï¼‰ |
| åŸå‹ | â­â­â­â­ | è‰¯å¥½ï¼ˆé¿å…é‡å¤åˆå§‹åŒ–ï¼‰ |

</TabItem>
<TabItem value="complexity" label="ä»£ç å¤æ‚åº¦">

| æ¨¡å¼ | ä»£ç å¤æ‚åº¦ | æè¿° |
|------|-----------|------|
| å•ä¾‹ | â­â­â­â­â­ | æœ€ç®€å•ï¼ˆå®ç°ç®€æ´ï¼‰ |
| å·¥å‚æ–¹æ³• | â­â­â­ | ä¸­ç­‰ï¼ˆéœ€è¦æŠ½è±¡å·¥å‚å’Œå­ç±»ï¼‰ |
| æŠ½è±¡å·¥å‚ | â­â­ | å¤æ‚ï¼ˆéœ€è¦å¤šä¸ªæŠ½è±¡äº§å“å’Œå®ç°ï¼‰ |
| å»ºé€ è€… | â­â­â­ | ä¸­ç­‰ï¼ˆéœ€è¦builderç±»å’Œå¤šä¸ªæ–¹æ³•ï¼‰ |
| åŸå‹ | â­â­â­â­ | è¾ƒç®€å•ï¼ˆä¸»è¦å¤„ç†å…‹éš†é€»è¾‘ï¼‰ |

</TabItem>
</Tabs>

### 6.3 è®¾è®¡æ¨¡å¼ç»„åˆä½¿ç”¨

åˆ›å»ºå‹æ¨¡å¼å¸¸å¸¸ç»„åˆä½¿ç”¨ä»¥è·å–æ›´å¥½çš„è®¾è®¡æ•ˆæœï¼š

1. **å·¥å‚æ–¹æ³•+å•ä¾‹**ï¼šå·¥å‚æœ¬èº«æ˜¯å•ä¾‹ï¼Œç¡®ä¿å·¥å‚å…¨å±€å”¯ä¸€
2. **æŠ½è±¡å·¥å‚+å·¥å‚æ–¹æ³•**ï¼šç”¨å·¥å‚æ–¹æ³•å®ç°æŠ½è±¡å·¥å‚
3. **å»ºé€ è€…+åŸå‹**ï¼šç”¨åŸå‹æ¨¡å¼å¤åˆ¶å»ºé€ è€…åˆ›å»ºçš„åŸºç¡€å¯¹è±¡
4. **å•ä¾‹+åŸå‹**ï¼šå•ä¾‹ç®¡ç†å™¨å­˜å‚¨åŸå‹å¯¹è±¡
5. **æŠ½è±¡å·¥å‚+å»ºé€ è€…**ï¼šå·¥å‚åˆ›å»ºå»ºé€ è€…å¯¹è±¡

```java title="ç»„åˆæ¨¡å¼ç¤ºä¾‹"
// å•ä¾‹å·¥å‚ç¤ºä¾‹
public class SingletonFactory {
    private static SingletonFactory instance = new SingletonFactory();
    private Map<String, Product> products = new HashMap<>();
    
    private SingletonFactory() {
        // æ³¨å†Œäº§å“åŸå‹
        products.put("default", new ConcreteProduct());
    }
    
    public static SingletonFactory getInstance() {
        return instance;
    }
    
    public Product createProduct(String type) {
        Product prototype = products.get(type);
        if (prototype == null) {
            prototype = products.get("default");
        }
        // ä½¿ç”¨åŸå‹æ¨¡å¼åˆ›å»ºäº§å“
        return prototype.clone();
    }
}
```

:::tip åˆ›å»ºå‹æ¨¡å¼é€‰æ‹©åŸåˆ™
1. **å•ä¾‹æ¨¡å¼**ï¼šéœ€è¦å…¨å±€å”¯ä¸€å®ä¾‹æ—¶ä½¿ç”¨
2. **å·¥å‚æ–¹æ³•**ï¼šéœ€è¦å»¶è¿Ÿå®ä¾‹åŒ–æ—¶ä½¿ç”¨
3. **æŠ½è±¡å·¥å‚**ï¼šéœ€è¦åˆ›å»ºäº§å“æ—æ—¶ä½¿ç”¨
4. **å»ºé€ è€…æ¨¡å¼**ï¼šéœ€è¦æ„å»ºå¤æ‚å¯¹è±¡æ—¶ä½¿ç”¨
5. **åŸå‹æ¨¡å¼**ï¼šéœ€è¦å¯¹è±¡å…‹éš†æ—¶ä½¿ç”¨
:::

---

é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†äº”ç§åˆ›å»ºå‹æ¨¡å¼çš„åŸç†ã€å®ç°æ–¹å¼å’Œåº”ç”¨åœºæ™¯ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¦æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„åˆ›å»ºå‹æ¨¡å¼ï¼Œå¹¶æ³¨æ„çº¿ç¨‹å®‰å…¨å’Œæ€§èƒ½ä¼˜åŒ–é—®é¢˜ã€‚
