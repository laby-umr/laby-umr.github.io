---
sidebar_position: 2
title: "é«˜æ€§èƒ½ç³»ç»Ÿè®¾è®¡"
description: "æ·±å…¥ç†è§£é«˜æ€§èƒ½ç³»ç»Ÿè®¾è®¡åŸç†ã€ä¼˜åŒ–ç­–ç•¥ä¸æœ€ä½³å®è·µ"
authors: [Laby]
last_update:
  date: 2025-08-07
  author: Laby
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import TOCInline from '@theme/TOCInline';

# é«˜æ€§èƒ½ç³»ç»Ÿè®¾è®¡

é«˜æ€§èƒ½ç³»ç»Ÿè®¾è®¡æ˜¯æ„å»ºå¿«é€Ÿå“åº”ã€é«˜ååé‡ç³»ç»Ÿçš„æ ¸å¿ƒæŠ€æœ¯ã€‚é€šè¿‡åˆç†çš„æ¶æ„è®¾è®¡ã€ç®—æ³•ä¼˜åŒ–ã€ç¼“å­˜ç­–ç•¥å’Œèµ„æºç®¡ç†ï¼Œå¯ä»¥æ„å»ºå‡ºé«˜æ€§èƒ½çš„ç³»ç»Ÿã€‚

:::info æœ¬æ–‡å†…å®¹æ¦‚è§ˆ
<TOCInline toc={toc} />
:::

:::tip æ ¸å¿ƒä»·å€¼
**é«˜æ€§èƒ½ = ç®—æ³•ä¼˜åŒ– + ç¼“å­˜ç­–ç•¥ + å¹¶å‘å¤„ç† + èµ„æºç®¡ç† + ç›‘æ§è°ƒä¼˜**
- ğŸ§® **ç®—æ³•ä¼˜åŒ–**ï¼šé€‰æ‹©åˆé€‚çš„ç®—æ³•å’Œæ•°æ®ç»“æ„ï¼Œé™ä½æ—¶é—´å¤æ‚åº¦
- ğŸ’¾ **ç¼“å­˜ç­–ç•¥**ï¼šå‡å°‘é‡å¤è®¡ç®—å’ŒI/Oæ“ä½œï¼Œæé«˜æ•°æ®è®¿é—®é€Ÿåº¦
- ğŸ”„ **å¹¶å‘å¤„ç†**ï¼šå……åˆ†åˆ©ç”¨å¤šæ ¸CPUï¼Œæé«˜ç³»ç»Ÿååé‡
- ğŸ“Š **èµ„æºç®¡ç†**ï¼šåˆç†åˆ†é…å’Œä½¿ç”¨CPUã€å†…å­˜ã€I/Oç­‰èµ„æº
- ğŸ“ˆ **ç›‘æ§è°ƒä¼˜**ï¼šæŒç»­ç›‘æ§ç³»ç»Ÿæ€§èƒ½ï¼ŒåŠæ—¶å‘ç°å’Œè§£å†³é—®é¢˜
:::

## 1. æ€§èƒ½ä¼˜åŒ–åŸºç¡€

### 1.1 æ€§èƒ½æŒ‡æ ‡

```mermaid
graph TD
    A[æ€§èƒ½æŒ‡æ ‡] --> B[å“åº”æ—¶é—´]
    A --> C[ååé‡]
    A --> D[å¹¶å‘æ•°]
    A --> E[èµ„æºåˆ©ç”¨ç‡]
    A --> F[å»¶è¿Ÿ]
    
    B --> B1[ç”¨æˆ·è¯·æ±‚åˆ°å“åº”çš„æ—¶é—´]
    C --> C1[å•ä½æ—¶é—´å¤„ç†çš„è¯·æ±‚æ•°]
    D --> D1[ç³»ç»ŸåŒæ—¶å¤„ç†çš„è¯·æ±‚æ•°]
    E --> E1[ç³»ç»Ÿèµ„æºçš„ä½¿ç”¨æ•ˆç‡]
    F --> F1[è¯·æ±‚åœ¨ç³»ç»Ÿå†…çš„ä¼ è¾“æ—¶é—´]
    
    style B fill:#f9f,stroke:#333,stroke-width:2px
    style C fill:#bbf,stroke:#333,stroke-width:2px
```

é«˜æ€§èƒ½ç³»ç»Ÿçš„æ ¸å¿ƒæŒ‡æ ‡ï¼š

| æŒ‡æ ‡ | è¯´æ˜ | ä¼˜åŒ–ç›®æ ‡ | è¡¡é‡æ–¹å¼ |
|------|------|----------|---------|
| **å“åº”æ—¶é—´ (Response Time)** | è¯·æ±‚å¤„ç†æ—¶é—´ | é™ä½å»¶è¿Ÿ | æ¯«ç§’/ç§’çº§ |
| **ååé‡ (Throughput)** | å•ä½æ—¶é—´å¤„ç†è¯·æ±‚æ•° | æé«˜QPS | è¯·æ±‚/ç§’ |
| **å¹¶å‘æ•° (Concurrency)** | åŒæ—¶å¤„ç†çš„è¯·æ±‚æ•° | æé«˜å¹¶å‘èƒ½åŠ› | ç”¨æˆ·æ•°/è¿æ¥æ•° |
| **èµ„æºåˆ©ç”¨ç‡ (Resource Utilization)** | CPUã€å†…å­˜ã€ç½‘ç»œä½¿ç”¨ç‡ | æé«˜æ•ˆç‡ | ç™¾åˆ†æ¯” |
| **å»¶è¿Ÿ (Latency)** | è¯·æ±‚åœ¨ç³»ç»Ÿå†…ä¼ è¾“æ—¶é—´ | å‡å°‘å»¶è¿Ÿ | æ¯«ç§’çº§ |

<details>
<summary>ä¸åŒåœºæ™¯ä¸‹çš„æ€§èƒ½ä¼˜åŒ–é‡ç‚¹</summary>

1. **Webåº”ç”¨**ï¼š
   - å“åº”æ—¶é—´ï¼šä¸€èˆ¬æ§åˆ¶åœ¨200msä»¥å†…
   - ååé‡ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼Œä¸­å°å‹åº”ç”¨é€šå¸¸1000-5000 QPS
   - å¹¶å‘æ•°ï¼šä¸­å°å‹åº”ç”¨é€šå¸¸å‡ ç™¾è‡³å‡ åƒå¹¶å‘è¿æ¥

2. **APIæœåŠ¡**ï¼š
   - å“åº”æ—¶é—´ï¼šä¸€èˆ¬æ§åˆ¶åœ¨50msä»¥å†…
   - ååé‡ï¼šé€šå¸¸è¦æ±‚æ›´é«˜ï¼Œå¯è¾¾æ•°ä¸‡QPS
   - ä½å»¶è¿Ÿï¼šå¯¹æ—¶é—´æ•æ„Ÿçš„APIè¦æ±‚æ›´ä½çš„å»¶è¿Ÿ

3. **æ•°æ®åˆ†æç³»ç»Ÿ**ï¼š
   - èµ„æºåˆ©ç”¨ç‡ï¼šCPUå’Œå†…å­˜ä½¿ç”¨æ•ˆç‡æ›´ä¸ºé‡è¦
   - æ‰¹å¤„ç†èƒ½åŠ›ï¼šå•æ‰¹æ¬¡å¤„ç†æ•°æ®é‡å’Œé€Ÿåº¦
   - å¯æ‰©å±•æ€§ï¼šéšæ•°æ®å¢é•¿æ‰©å±•èƒ½åŠ›

4. **å®æ—¶å¤„ç†ç³»ç»Ÿ**ï¼š
   - å»¶è¿Ÿï¼šæ¯«ç§’ç”šè‡³å¾®ç§’çº§çš„å»¶è¿Ÿè¦æ±‚
   - ç¨³å®šæ€§ï¼šé¿å…å»¶è¿Ÿå³°å€¼å’ŒæŠ–åŠ¨
   - ååé‡ï¼šåœ¨ä¿è¯ä½å»¶è¿Ÿå‰æä¸‹çš„å¤„ç†èƒ½åŠ›

</details>

<Tabs>
  <TabItem value="monitor" label="æ€§èƒ½ç›‘æ§" default>
  ```java
  @Component
  public class PerformanceMonitor {
      
      private final MeterRegistry meterRegistry;
      
      public PerformanceMonitor(MeterRegistry meterRegistry) {
          this.meterRegistry = meterRegistry;
      }
      
      @Around("@annotation(org.springframework.web.bind.annotation.RequestMapping)")
      public Object monitorPerformance(ProceedingJoinPoint joinPoint) throws Throwable {
          Timer.Sample sample = Timer.start(meterRegistry);
          String methodName = joinPoint.getSignature().getName();
          
          try {
              Object result = joinPoint.proceed();
              
              // è®°å½•æˆåŠŸè¯·æ±‚
              sample.stop(Timer.builder("http.server.requests")
                  .tag("method", methodName)
                  .tag("status", "success")
                  .register(meterRegistry));
              
              return result;
          } catch (Exception e) {
              // è®°å½•å¤±è´¥è¯·æ±‚
              sample.stop(Timer.builder("http.server.requests")
                  .tag("method", methodName)
                  .tag("status", "error")
                  .register(meterRegistry));
              
              Counter.builder("error.count")
                  .tag("method", methodName)
                  .tag("exception", e.getClass().getSimpleName())
                  .register(meterRegistry)
                  .increment();
              
              throw e;
          }
      }
  }
  ```
  </TabItem>
  <TabItem value="metrics" label="æŒ‡æ ‡æ”¶é›†">
  ```java
  @RestController
  @RequestMapping("/metrics")
  public class MetricsController {
      
      private final MeterRegistry meterRegistry;
      
      public MetricsController(MeterRegistry meterRegistry) {
          this.meterRegistry = meterRegistry;
          
          // æ³¨å†ŒJVMæŒ‡æ ‡
          new JvmMemoryMetrics().bindTo(meterRegistry);
          new JvmGcMetrics().bindTo(meterRegistry);
          new JvmThreadMetrics().bindTo(meterRegistry);
          new ClassLoaderMetrics().bindTo(meterRegistry);
          
          // æ³¨å†Œç³»ç»ŸæŒ‡æ ‡
          new ProcessorMetrics().bindTo(meterRegistry);
          new UptimeMetrics().bindTo(meterRegistry);
      }
      
      @GetMapping("/custom")
      public Map<String, Double> getCustomMetrics() {
          Map<String, Double> metrics = new HashMap<>();
          
          // æå–å…³é”®æŒ‡æ ‡
          metrics.put("response.time.avg", getTimerMetric("response.time", "avg"));
          metrics.put("response.time.max", getTimerMetric("response.time", "max"));
          metrics.put("throughput", getCounterRate("http.server.requests"));
          metrics.put("error.rate", calculateErrorRate());
          
          return metrics;
      }
      
      private double getTimerMetric(String name, String type) {
          Timer timer = meterRegistry.find(name).timer();
          if (timer == null) return 0.0;
          
          return "avg".equals(type) ? timer.mean(TimeUnit.MILLISECONDS) : timer.max(TimeUnit.MILLISECONDS);
      }
      
      private double getCounterRate(String name) {
          return meterRegistry.find(name).counter().count() / getUptime();
      }
      
      private double calculateErrorRate() {
          double total = meterRegistry.find("http.server.requests").counters().stream()
              .mapToDouble(Counter::count).sum();
          
          double errors = meterRegistry.find("http.server.requests")
              .tag("status", "error").counter().count();
              
          return total == 0 ? 0 : (errors / total) * 100;
      }
      
      private double getUptime() {
          return ManagementFactory.getRuntimeMXBean().getUptime() / 1000.0;
      }
  }
  ```
  </TabItem>
</Tabs>

### 1.2 æ€§èƒ½ç“¶é¢ˆåˆ†æ

æ€§èƒ½ç“¶é¢ˆåˆ†ææ˜¯å‘ç°ç³»ç»Ÿæ€§èƒ½çŸ­æ¿çš„é‡è¦æ­¥éª¤ï¼Œå¯ä»¥é€šè¿‡ç›‘æ§å·¥å…·å’Œæ€§èƒ½åˆ†æç¡®å®šç³»ç»Ÿä¸­çš„ç“¶é¢ˆç‚¹ã€‚

```mermaid
flowchart TD
    A[æ€§èƒ½ç“¶é¢ˆåˆ†æ] --> B[CPUç“¶é¢ˆ]
    A --> C[å†…å­˜ç“¶é¢ˆ]
    A --> D[ç£ç›˜I/Oç“¶é¢ˆ]
    A --> E[ç½‘ç»œç“¶é¢ˆ]
    A --> F[ä»£ç ç“¶é¢ˆ]
    
    B --> B1[é«˜CPUä½¿ç”¨ç‡]
    B --> B2[çº¿ç¨‹äº‰ç”¨]
    
    C --> C1[å†…å­˜æ³„æ¼]
    C --> C2[é¢‘ç¹GC]
    C --> C3[å†…å­˜ç¢ç‰‡]
    
    D --> D1[ç£ç›˜è¯»å†™é¢‘ç¹]
    D --> D2[éšæœºI/Oå¤š]
    
    E --> E1[ç½‘ç»œå»¶è¿Ÿé«˜]
    E --> E2[å¸¦å®½å—é™]
    
    F --> F1[ç®—æ³•ä½æ•ˆ]
    F --> F2[é”ç«äº‰]
    F --> F3[èµ„æºæµªè´¹]
```

<div className="card">
<div className="card__header">
<h4>æ€§èƒ½ç“¶é¢ˆè¯†åˆ«æ–¹æ³•</h4>
</div>
<div className="card__body">

| ç“¶é¢ˆç±»å‹ | ç—‡çŠ¶ | å¸¸è§åŸå›  | åˆ†æå·¥å…· |
|---------|------|---------|---------|
| **CPUç“¶é¢ˆ** | CPUä½¿ç”¨ç‡é«˜ï¼Œçº¿ç¨‹æ’é˜Ÿ | è®¡ç®—å¯†é›†å‹æ“ä½œï¼Œæ­»å¾ªç¯ï¼Œçº¿ç¨‹äº‰ç”¨ | JVisualVMï¼Œtopï¼Œjstack |
| **å†…å­˜ç“¶é¢ˆ** | GCé¢‘ç¹ï¼ŒOOMå¼‚å¸¸ | å†…å­˜æ³„æ¼ï¼Œå¤§å¯¹è±¡åˆ›å»ºï¼ŒEdenåŒºè¿‡å° | JProfilerï¼Œjmapï¼ŒMAT |
| **ç£ç›˜I/Oç“¶é¢ˆ** | ç£ç›˜è¯»å†™é¢‘ç¹ï¼Œå“åº”æ…¢ | æ—¥å¿—é¢‘ç¹å†™å…¥ï¼Œæ•°æ®åº“ç´¢å¼•ä¸å½“ | iostatï¼Œiotop |
| **ç½‘ç»œç“¶é¢ˆ** | ç½‘ç»œå»¶è¿Ÿé«˜ï¼Œä¸¢åŒ… | å¸¦å®½ä¸è¶³ï¼Œç½‘ç»œæ‹¥å¡ï¼Œè¿æ¥è¿‡å¤š | netstatï¼Œpingï¼Œwireshark |
| **ä»£ç ç“¶é¢ˆ** | çƒ­ç‚¹æ–¹æ³•æ‰§è¡Œæ…¢ | ç®—æ³•ä½æ•ˆï¼Œé”ç«äº‰ï¼Œèµ„æºæ³„æ¼ | JProfilerï¼ŒYourKit |

</div>
</div>

<Tabs>
  <TabItem value="analyzer" label="æ€§èƒ½åˆ†æå™¨" default>
  ```java
  @Component
  public class PerformanceAnalyzer {
      
      private final ThreadMXBean threadMXBean = ManagementFactory.getThreadMXBean();
      private final MemoryMXBean memoryMXBean = ManagementFactory.getMemoryMXBean();
      
      public PerformanceReport analyzePerformance() {
          PerformanceReport report = new PerformanceReport();
          
          // CPUä½¿ç”¨ç‡åˆ†æ
          report.setCpuUsage(analyzeCpuUsage());
          
          // å†…å­˜ä½¿ç”¨æƒ…å†µ
          report.setMemoryUsage(analyzeMemoryUsage());
          
          // çº¿ç¨‹çŠ¶æ€åˆ†æ
          report.setThreadInfo(analyzeThreadInfo());
          
          // GCæƒ…å†µåˆ†æ
          report.setGcInfo(analyzeGcInfo());
          
          return report;
      }
      
      private double analyzeCpuUsage() {
          OperatingSystemMXBean osBean = ManagementFactory.getOperatingSystemMXBean();
          if (osBean instanceof com.sun.management.OperatingSystemMXBean) {
              return ((com.sun.management.OperatingSystemMXBean) osBean).getCpuLoad() * 100;
          }
          return 0.0;
      }
      
      private MemoryUsage analyzeMemoryUsage() {
          return memoryMXBean.getHeapMemoryUsage();
      }
      
      private ThreadInfo[] analyzeThreadInfo() {
          return threadMXBean.dumpAllThreads(false, false);
      }
      
      private List<GarbageCollectorMXBean> analyzeGcInfo() {
          return ManagementFactory.getGarbageCollectorMXBeans();
      }
  }
  ```
  </TabItem>
  <TabItem value="hotspot" label="çƒ­ç‚¹åˆ†æ">
  ```java
  @Component
  public class HotspotAnalyzer {
      
      private final MeterRegistry meterRegistry;
      private final Map<String, Timer> methodTimers = new ConcurrentHashMap<>();
      
      public HotspotAnalyzer(MeterRegistry meterRegistry) {
          this.meterRegistry = meterRegistry;
      }
      
      @Around("execution(* com.example.service.*.*(..))")
      public Object analyzeMethodPerformance(ProceedingJoinPoint joinPoint) throws Throwable {
          String methodName = joinPoint.getSignature().toShortString();
          Timer timer = methodTimers.computeIfAbsent(methodName, 
              k -> Timer.builder("method.execution")
                  .tag("method", methodName)
                  .register(meterRegistry));
          
          return timer.recordCallable(() -> {
              try {
                  return joinPoint.proceed();
              } catch (Throwable t) {
                  if (t instanceof RuntimeException) {
                      throw (RuntimeException) t;
                  }
                  throw new RuntimeException(t);
              }
          });
      }
      
      public List<MethodPerformance> getTopSlowMethods(int limit) {
          return methodTimers.entrySet().stream()
              .map(entry -> new MethodPerformance(
                  entry.getKey(),
                  entry.getValue().count(),
                  entry.getValue().totalTime(TimeUnit.MILLISECONDS),
                  entry.getValue().mean(TimeUnit.MILLISECONDS),
                  entry.getValue().max(TimeUnit.MILLISECONDS)
              ))
              .sorted(Comparator.comparingDouble(MethodPerformance::getAvgTime).reversed())
              .limit(limit)
              .collect(Collectors.toList());
      }
      
      public static class MethodPerformance {
          private final String methodName;
          private final long invocationCount;
          private final double totalTime;
          private final double avgTime;
          private final double maxTime;
          
          // Constructor, getters
          // ...
      }
  }
  ```
  </TabItem>
</Tabs>

:::caution æ€§èƒ½åˆ†ææ³¨æ„äº‹é¡¹
1. **ç”Ÿäº§ç¯å¢ƒå½±å“**ï¼šæ€§èƒ½åˆ†æå·¥å…·ä¼šå¯¹ç³»ç»Ÿæ€§èƒ½äº§ç”Ÿå½±å“ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨éœ€è°¨æ…
2. **é‡‡æ ·é¢‘ç‡**ï¼šé«˜é¢‘é‡‡æ ·ä¼šæä¾›æ›´ç²¾ç¡®çš„æ•°æ®ï¼Œä½†ä¹Ÿä¼šäº§ç”Ÿæ›´å¤§çš„æ€§èƒ½å¼€é”€
3. **å…¨å±€è§†è§’**ï¼šå…³æ³¨å…¨å±€æ€§èƒ½æŒ‡æ ‡ï¼Œé¿å…åªä¼˜åŒ–å±€éƒ¨æ€§èƒ½
4. **ç³»ç»ŸçŠ¶æ€**ï¼šåœ¨ä¸åŒè´Ÿè½½æ¡ä»¶ä¸‹è¿›è¡Œæ€§èƒ½åˆ†æï¼Œç‰¹åˆ«æ˜¯å³°å€¼è´Ÿè½½æ—¶
5. **æŒç»­ç›‘æ§**ï¼šå»ºç«‹æŒç»­æ€§èƒ½ç›‘æ§æœºåˆ¶ï¼ŒåŠæ—¶å‘ç°æ€§èƒ½é€€åŒ–
:::

## 2. ç®—æ³•ä¼˜åŒ–

### 2.1 æ•°æ®ç»“æ„ä¼˜åŒ–

é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„å¯¹ç³»ç»Ÿæ€§èƒ½æœ‰ç€è‡³å…³é‡è¦çš„å½±å“ï¼Œç‰¹åˆ«æ˜¯åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ã€‚

```mermaid
graph TD
    A[æ•°æ®ç»“æ„é€‰æ‹©] --> B[æ•°ç»„]
    A --> C[é“¾è¡¨]
    A --> D[å“ˆå¸Œè¡¨]
    A --> E[æ ‘ç»“æ„]
    A --> F[å †]
    
    B --> B1["éšæœºè®¿é—®O(1)"]
    B --> B2["æ’å…¥/åˆ é™¤O(n)"]
    
    C --> C1["æ’å…¥/åˆ é™¤O(1)"]
    C --> C2["æŸ¥æ‰¾O(n)"]
    
    D --> D1["å¹³å‡æŸ¥æ‰¾/æ’å…¥/åˆ é™¤O(1)"]
    D --> D2["æœ€åO(n)"]
    
    E --> E1["å¹³è¡¡æ ‘æŸ¥æ‰¾O(log n)"]
    E --> E2["æœ‰åºéå†"]
    
    F --> F1["ä¼˜å…ˆçº§é˜Ÿåˆ—"]
    F --> F2["æ’å…¥/åˆ é™¤O(log n)"]
```

<Tabs>
  <TabItem value="data-structure" label="é«˜æ•ˆæ•°æ®ç»“æ„" default>
  ```java
  @Service
  public class DataStructureOptimization {
      
      // ä½¿ç”¨HashMapä¼˜åŒ–æŸ¥æ‰¾
      private Map<String, User> userCache = new ConcurrentHashMap<>();
      
      public User getUserById(String id) {
          return userCache.get(id);
      }
      
      // ä½¿ç”¨TreeSetä¼˜åŒ–æ’åº
      private TreeSet<Integer> sortedNumbers = new TreeSet<>();
      
      public void addNumber(int number) {
          sortedNumbers.add(number);
      }
      
      public int findClosestNumber(int target) {
          Integer ceiling = sortedNumbers.ceiling(target);
          Integer floor = sortedNumbers.floor(target);
          
          if (ceiling == null) return floor;
          if (floor == null) return ceiling;
          
          return Math.abs(ceiling - target) < Math.abs(floor - target) ? ceiling : floor;
      }
      
      // ä½¿ç”¨LinkedHashMapå®ç°LRUç¼“å­˜
      private Map<String, String> lruCache = new LinkedHashMap<String, String>(100, 0.75f, true) {
          @Override
          protected boolean removeEldestEntry(Map.Entry<String, String> eldest) {
              return size() > 100;
          }
      };
      
      public String getValue(String key) {
          return lruCache.get(key);
      }
      
      public void putValue(String key, String value) {
          lruCache.put(key, value);
      }
  }
  ```
  </TabItem>
  <TabItem value="comparision" label="æ•°æ®ç»“æ„å¯¹æ¯”">
  ```java
  @Service
  public class DataStructureBenchmark {
      
      public void compareListPerformance() {
          // å‡†å¤‡æµ‹è¯•æ•°æ®
          int dataSize = 100000;
          Random random = new Random();
          
          // ArrayListæ€§èƒ½æµ‹è¯•
          List<Integer> arrayList = new ArrayList<>(dataSize);
          long startTime = System.nanoTime();
          
          for (int i = 0; i < dataSize; i++) {
              arrayList.add(random.nextInt());
          }
          
          long arrayListInsertTime = System.nanoTime() - startTime;
          
          // LinkedListæ€§èƒ½æµ‹è¯•
          List<Integer> linkedList = new LinkedList<>();
          startTime = System.nanoTime();
          
          for (int i = 0; i < dataSize; i++) {
              linkedList.add(random.nextInt());
          }
          
          long linkedListInsertTime = System.nanoTime() - startTime;
          
          // éšæœºè®¿é—®æ€§èƒ½æµ‹è¯•
          startTime = System.nanoTime();
          for (int i = 0; i < 10000; i++) {
              arrayList.get(random.nextInt(dataSize));
          }
          long arrayListAccessTime = System.nanoTime() - startTime;
          
          startTime = System.nanoTime();
          for (int i = 0; i < 10000; i++) {
              linkedList.get(random.nextInt(dataSize));
          }
          long linkedListAccessTime = System.nanoTime() - startTime;
          
          // è¾“å‡ºç»“æœ
          System.out.println("ArrayListæ’å…¥æ—¶é—´: " + arrayListInsertTime + "ns");
          System.out.println("LinkedListæ’å…¥æ—¶é—´: " + linkedListInsertTime + "ns");
          System.out.println("ArrayListéšæœºè®¿é—®æ—¶é—´: " + arrayListAccessTime + "ns");
          System.out.println("LinkedListéšæœºè®¿é—®æ—¶é—´: " + linkedListAccessTime + "ns");
      }
  }
  ```
  </TabItem>
</Tabs>

### 2.2 ç®—æ³•æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–

ä¼˜åŒ–ç®—æ³•æ—¶é—´å¤æ‚åº¦æ˜¯æé«˜ç³»ç»Ÿæ€§èƒ½çš„å…³é”®æ‰‹æ®µï¼Œé€šè¿‡é€‰æ‹©æ›´é«˜æ•ˆçš„ç®—æ³•å¯ä»¥æ˜¾è‘—æå‡ç³»ç»Ÿå¤„ç†èƒ½åŠ›ã€‚

```mermaid
graph LR
    A[ç®—æ³•å¤æ‚åº¦] --> B["O(1) å¸¸æ•°æ—¶é—´"]
    A --> C["O(log n) å¯¹æ•°æ—¶é—´"]
    A --> D["O(n) çº¿æ€§æ—¶é—´"]
    A --> E["O(n log n) çº¿æ€§å¯¹æ•°æ—¶é—´"]
    A --> F["O(nÂ²) å¹³æ–¹æ—¶é—´"]
    A --> G["O(2â¿) æŒ‡æ•°æ—¶é—´"]
    
    B -.-> B1["å“ˆå¸Œè¡¨æŸ¥æ‰¾"]
    C -.-> C1["äºŒåˆ†æŸ¥æ‰¾ã€å¹³è¡¡æ ‘"]
    D -.-> D1["çº¿æ€§æ‰«æ"]
    E -.-> E1["é«˜æ•ˆæ’åºç®—æ³•"]
    F -.-> F1["ç®€å•æ’åºç®—æ³•"]
    G -.-> G1["æš´åŠ›ç ´è§£ç®—æ³•"]
    
    style B fill:#c3e6cb,stroke:#333
    style C fill:#d1ecf1,stroke:#333
    style D fill:#d1ecf1,stroke:#333
    style E fill:#fff3cd,stroke:#333
    style F fill:#f8d7da,stroke:#333
    style G fill:#f8d7da,stroke:#333
```

<div className="card">
<div className="card__body">

ä¼˜åŒ–ç®—æ³•æ—¶é—´å¤æ‚åº¦çš„å¸¸è§ç­–ç•¥ï¼š

1. **å‡å°‘åµŒå¥—å¾ªç¯**ï¼šå°†O(nÂ²)ä¼˜åŒ–ä¸ºO(n)æˆ–O(n log n)
2. **ä½¿ç”¨å“ˆå¸Œè¡¨**ï¼šå°†æŸ¥æ‰¾å¤æ‚åº¦ä»O(n)é™è‡³O(1)
3. **ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾**ï¼šå°†æœ‰åºæ•°ç»„æŸ¥æ‰¾ä»O(n)é™è‡³O(log n)
4. **åŠ¨æ€è§„åˆ’**ï¼šé¿å…é‡å¤è®¡ç®—ï¼Œä¼˜åŒ–é€’å½’ç®—æ³•
5. **è´ªå¿ƒç®—æ³•**ï¼šåœ¨é€‚å½“åœºæ™¯ç”¨å±€éƒ¨æœ€ä¼˜è§£æ›¿ä»£å…¨å±€æœ€ä¼˜è§£
6. **ç©ºé—´æ¢æ—¶é—´**ï¼šåˆ©ç”¨é¢å¤–ç©ºé—´é™ä½æ—¶é—´å¤æ‚åº¦

</div>
</div>

<Tabs>
  <TabItem value="before" label="ä¼˜åŒ–å‰" default>
  ```java
  // O(nÂ²)å¤æ‚åº¦ - æŸ¥æ‰¾ä¸¤æ•°ä¹‹å’Œ
  public int[] findTwoSum(int[] nums, int target) {
      for (int i = 0; i < nums.length; i++) {
          for (int j = i + 1; j < nums.length; j++) {
              if (nums[i] + nums[j] == target) {
                  return new int[] {i, j};
              }
          }
      }
      return null;
  }
  ```
  </TabItem>
  <TabItem value="after" label="ä¼˜åŒ–å">
  ```java
  // O(n)å¤æ‚åº¦ - ä½¿ç”¨å“ˆå¸Œè¡¨ä¼˜åŒ–æŸ¥æ‰¾ä¸¤æ•°ä¹‹å’Œ
  public int[] findTwoSumOptimized(int[] nums, int target) {
      Map<Integer, Integer> numMap = new HashMap<>();
      for (int i = 0; i < nums.length; i++) {
          int complement = target - nums[i];
          if (numMap.containsKey(complement)) {
              return new int[] {numMap.get(complement), i};
          }
          numMap.put(nums[i], i);
      }
      return null;
  }
  ```
  </TabItem>
  <TabItem value="comparison" label="æ€§èƒ½å¯¹æ¯”">
  ```java
  @Service
  public class AlgorithmBenchmark {
      
      public void compareTwoSumAlgorithms() {
          // å‡†å¤‡æµ‹è¯•æ•°æ®
          int[] nums = new int[10000];
          Random random = new Random();
          
          for (int i = 0; i < nums.length; i++) {
              nums[i] = random.nextInt(10000);
          }
          
          int target = nums[random.nextInt(nums.length)] + nums[random.nextInt(nums.length)];
          
          // æµ‹è¯•O(nÂ²)ç®—æ³•
          long startTime = System.nanoTime();
          findTwoSum(nums, target);
          long bruteForceTime = System.nanoTime() - startTime;
          
          // æµ‹è¯•O(n)ç®—æ³•
          startTime = System.nanoTime();
          findTwoSumOptimized(nums, target);
          long optimizedTime = System.nanoTime() - startTime;
          
          // è¾“å‡ºç»“æœ
          System.out.println("O(nÂ²)ç®—æ³•æ‰§è¡Œæ—¶é—´: " + bruteForceTime + "ns");
          System.out.println("O(n)ç®—æ³•æ‰§è¡Œæ—¶é—´: " + optimizedTime + "ns");
          System.out.println("æ€§èƒ½æå‡: " + (bruteForceTime / optimizedTime) + "å€");
      }
  }
  ```
  </TabItem>
</Tabs>

### 2.3 ç©ºé—´å¤æ‚åº¦ä¼˜åŒ–

åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç©ºé—´å¤æ‚åº¦å’Œæ—¶é—´å¤æ‚åº¦ä¹‹é—´è¿›è¡Œæƒè¡¡ï¼Œç‰¹åˆ«æ˜¯åœ¨å†…å­˜å—é™çš„ç¯å¢ƒä¸­ã€‚

<details>
<summary>ç©ºé—´å¤æ‚åº¦ä¸æ—¶é—´å¤æ‚åº¦çš„æƒè¡¡</summary>

1. **ç©ºé—´æ¢æ—¶é—´**ï¼š
   - é¢„è®¡ç®—ç»“æœå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼ˆå¦‚ç¼“å­˜ã€æŸ¥æ‰¾è¡¨ï¼‰
   - ä½¿ç”¨é¢å¤–æ•°æ®ç»“æ„åŠ é€Ÿå¤„ç†ï¼ˆå“ˆå¸Œè¡¨ã€æ ‘ç­‰ï¼‰
   - é€‚ç”¨äºå†…å­˜å……è¶³ã€æ€§èƒ½è¦æ±‚é«˜çš„åœºæ™¯

2. **æ—¶é—´æ¢ç©ºé—´**ï¼š
   - ä½¿ç”¨è¿­ä»£æ›¿ä»£é€’å½’é¿å…æ ˆç©ºé—´æ¶ˆè€—
   - ä½¿ç”¨ä½æ“ä½œèŠ‚çœç©ºé—´
   - é€‚ç”¨äºå†…å­˜å—é™åœºæ™¯

3. **æƒè¡¡å› ç´ **ï¼š
   - ç¡¬ä»¶é™åˆ¶ï¼šå†…å­˜å¤§å°ã€CPUæ€§èƒ½
   - å¹¶å‘ç”¨æˆ·æ•°ï¼šå½±å“æ€»å†…å­˜éœ€æ±‚
   - æ•°æ®è§„æ¨¡ï¼šå¤„ç†æ•°æ®é‡çš„å¤§å°
   - è®¿é—®é¢‘ç‡ï¼šé«˜é¢‘è®¿é—®é€‚åˆç©ºé—´æ¢æ—¶é—´

</details>

```java title="ç©ºé—´ä¼˜åŒ–ç¤ºä¾‹"
// ä¼˜åŒ–å‰ï¼šç©ºé—´å¤æ‚åº¦O(n)
public int fibonacci(int n) {
    int[] fib = new int[n + 1];
    fib[0] = 0;
    fib[1] = 1;
    for (int i = 2; i <= n; i++) {
        fib[i] = fib[i - 1] + fib[i - 2];
    }
    return fib[n];
}

// ä¼˜åŒ–åï¼šç©ºé—´å¤æ‚åº¦O(1)
public int fibonacciOptimized(int n) {
    if (n <= 1) return n;
    
    int prev = 0;
    int curr = 1;
    for (int i = 2; i <= n; i++) {
        int next = prev + curr;
        prev = curr;
        curr = next;
    }
    return curr;
}
```

## 3. ç¼“å­˜ä¼˜åŒ–

ç¼“å­˜æ˜¯æå‡ç³»ç»Ÿæ€§èƒ½æœ€æœ‰æ•ˆçš„æ‰‹æ®µä¹‹ä¸€ï¼Œé€šè¿‡å°†é¢‘ç¹è®¿é—®çš„æ•°æ®å­˜å‚¨åœ¨æ›´å¿«çš„ä»‹è´¨ä¸­ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘è®¿é—®å»¶è¿Ÿã€‚

### 3.1 æœ¬åœ°ç¼“å­˜

```mermaid
graph TD
    A[è¯·æ±‚] --> B{ç¼“å­˜å‘½ä¸­?}
    B -- æ˜¯ --> C[è¿”å›ç¼“å­˜æ•°æ®]
    B -- å¦ --> D[è®¿é—®æ•°æ®æº]
    D --> E[æ›´æ–°ç¼“å­˜]
    E --> F[è¿”å›æ•°æ®]
```

<Tabs>
  <TabItem value="caffeine" label="Caffeineç¼“å­˜" default>
  ```java
  @Configuration
  public class CaffeineConfig {
      
      @Bean
      public Cache<String, Object> caffeineCache() {
          return Caffeine.newBuilder()
              .maximumSize(10_000)
              .expireAfterWrite(Duration.ofMinutes(5))
              .recordStats()
              .build();
      }
  }
  
  @Service
  public class CaffeineCacheService {
      
      @Autowired
      private Cache<String, Object> caffeineCache;
      
      @Autowired
      private DataRepository repository;
      
      public Object getData(String key) {
          // ä»ç¼“å­˜è·å–
          Object value = caffeineCache.getIfPresent(key);
          if (value != null) {
              return value;
          }
          
          // ç¼“å­˜æœªå‘½ä¸­ï¼Œä»æ•°æ®æºè·å–
          value = repository.findByKey(key);
          if (value != null) {
              // æ›´æ–°ç¼“å­˜
              caffeineCache.put(key, value);
          }
          
          return value;
      }
      
      public Map<String, Object> getCacheStats() {
          Map<String, Object> stats = new HashMap<>();
          stats.put("hitCount", caffeineCache.stats().hitCount());
          stats.put("missCount", caffeineCache.stats().missCount());
          stats.put("hitRate", caffeineCache.stats().hitRate());
          stats.put("evictionCount", caffeineCache.stats().evictionCount());
          stats.put("estimatedSize", caffeineCache.estimatedSize());
          return stats;
      }
  }
  ```
  </TabItem>
  <TabItem value="guava" label="Guavaç¼“å­˜">
  ```java
  @Configuration
  public class GuavaCacheConfig {
      
      @Bean
      public LoadingCache<String, Object> guavaCache() {
          return CacheBuilder.newBuilder()
              .maximumSize(10_000)
              .expireAfterWrite(5, TimeUnit.MINUTES)
              .recordStats()
              .build(new CacheLoader<String, Object>() {
                  @Override
                  public Object load(String key) throws Exception {
                      // è¿™é‡Œå®ç°ä»æ•°æ®æºåŠ è½½æ•°æ®çš„é€»è¾‘
                      return loadFromDataSource(key);
                  }
              });
      }
      
      private Object loadFromDataSource(String key) {
          // ä»æ•°æ®æºåŠ è½½æ•°æ®çš„å®ç°
          return null;
      }
  }
  
  @Service
  public class GuavaCacheService {
      
      @Autowired
      private LoadingCache<String, Object> guavaCache;
      
      public Object getData(String key) {
          try {
              // è‡ªåŠ¨å¤„ç†ç¼“å­˜æœªå‘½ä¸­æƒ…å†µ
              return guavaCache.get(key);
          } catch (ExecutionException e) {
              log.error("è·å–æ•°æ®å¤±è´¥", e);
              return null;
          }
      }
      
      public Map<String, Object> getCacheStats() {
          CacheStats stats = guavaCache.stats();
          Map<String, Object> statsMap = new HashMap<>();
          statsMap.put("hitCount", stats.hitCount());
          statsMap.put("missCount", stats.missCount());
          statsMap.put("hitRate", stats.hitRate());
          statsMap.put("evictionCount", stats.evictionCount());
          statsMap.put("totalLoadTime", stats.totalLoadTime());
          statsMap.put("averageLoadPenalty", stats.averageLoadPenalty());
          return statsMap;
      }
  }
  ```
  </TabItem>
  <TabItem value="ehcache" label="EhCache">
  ```java
  @Configuration
  @EnableCaching
  public class EhCacheConfig {
      
      @Bean
      public CacheManager cacheManager() {
          CacheConfiguration<Object, Object> cacheConfiguration = CacheConfigurationBuilder
              .newCacheConfigurationBuilder(Object.class, Object.class,
                  ResourcePoolsBuilder.heap(10000))
              .withExpiry(ExpiryPolicyBuilder.timeToLiveExpiration(Duration.ofMinutes(5)))
              .build();
              
          EhcacheCachingProvider provider = (EhcacheCachingProvider) Caching.getCachingProvider();
          org.ehcache.config.Configuration configuration = new DefaultConfiguration(provider.getDefaultClassLoader());
          
          EhcacheCacheManager ehCacheManager = new EhcacheCacheManager(CacheManagerBuilder
              .newCacheManagerBuilder()
              .withCache("default", cacheConfiguration)
              .build(true));
              
          return ehCacheManager;
      }
  }
  
  @Service
  public class EhCacheService {
      
      @Autowired
      private CacheManager cacheManager;
      
      @Autowired
      private DataRepository repository;
      
      @Cacheable(value = "default", key = "#key")
      public Object getData(String key) {
          // ç¼“å­˜æœªå‘½ä¸­æ—¶æ‰§è¡Œ
          return repository.findByKey(key);
      }
      
      @CacheEvict(value = "default", key = "#key")
      public void invalidateCache(String key) {
          // æ–¹æ³•ä½“å¯ä»¥ä¸ºç©ºï¼Œæ³¨è§£ä¼šå¤„ç†ç¼“å­˜å¤±æ•ˆ
      }
  }
  ```
  </TabItem>
</Tabs>

:::caution æœ¬åœ°ç¼“å­˜æ³¨æ„äº‹é¡¹
1. **å†…å­˜å‹åŠ›**ï¼šè®¾ç½®åˆç†çš„æœ€å¤§å¤§å°ï¼Œé¿å…å ç”¨è¿‡å¤šå†…å­˜
2. **è¿‡æœŸç­–ç•¥**ï¼šé€‰æ‹©åˆé€‚çš„è¿‡æœŸç­–ç•¥ï¼ˆLRUã€LFUã€FIFOç­‰ï¼‰
3. **ç¼“å­˜ä¸€è‡´æ€§**ï¼šå¤šå®ä¾‹åœºæ™¯ä¸‹çš„ç¼“å­˜æ•°æ®ä¸€è‡´æ€§é—®é¢˜
4. **ç¼“å­˜ç©¿é€**ï¼šå¯¹ä¸å­˜åœ¨çš„keyè¿›è¡Œé‡å¤æŸ¥è¯¢å¯¼è‡´ç¼“å­˜å¤±æ•ˆ
5. **ç¼“å­˜å‡»ç©¿**ï¼šçƒ­ç‚¹keyè¿‡æœŸç¬é—´å¯¼è‡´å¤§é‡è¯·æ±‚ç›´è¾¾æ•°æ®åº“
6. **ç¼“å­˜é›ªå´©**ï¼šå¤§é‡ç¼“å­˜åŒæ—¶å¤±æ•ˆå¯¼è‡´ç³»ç»Ÿå‹åŠ›çªå¢
:::

### 3.2 åˆ†å¸ƒå¼ç¼“å­˜

åˆ†å¸ƒå¼ç¼“å­˜è§£å†³äº†æœ¬åœ°ç¼“å­˜åœ¨å¤šå®ä¾‹åœºæ™¯ä¸‹çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Œå¯ä»¥ä½œä¸ºå¤šä¸ªåº”ç”¨å®ä¾‹çš„å…±äº«ç¼“å­˜ã€‚

```mermaid
graph TD
    A[åº”ç”¨å®ä¾‹1] --> C[åˆ†å¸ƒå¼ç¼“å­˜]
    B[åº”ç”¨å®ä¾‹2] --> C
    D[åº”ç”¨å®ä¾‹3] --> C
    C --> E[æ•°æ®åº“]
```

<div className="card">
<div className="card__header">
<h4>åˆ†å¸ƒå¼ç¼“å­˜ç‰¹ç‚¹</h4>
</div>
<div className="card__body">

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **æ•°æ®ä¸€è‡´æ€§** | å¤šä¸ªåº”ç”¨å®ä¾‹è®¿é—®ç›¸åŒçš„ç¼“å­˜æ•°æ®ï¼Œé¿å…æ•°æ®ä¸ä¸€è‡´ |
| **æ°´å¹³æ‰©å±•** | å¯ä»¥é€šè¿‡å¢åŠ èŠ‚ç‚¹æå‡ç¼“å­˜å®¹é‡å’Œååé‡ |
| **æ•…éšœè½¬ç§»** | æ”¯æŒèŠ‚ç‚¹æ•…éšœæ—¶çš„è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼Œæé«˜å¯ç”¨æ€§ |
| **æ•°æ®åˆ†åŒº** | é€šè¿‡å“ˆå¸Œæˆ–ä¸€è‡´æ€§å“ˆå¸Œç­‰ç®—æ³•å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºå­˜å‚¨ |
| **ç¼“å­˜åè®®** | æ”¯æŒå¤šç§ç¼“å­˜è®¿é—®åè®®ï¼Œå¦‚Memcachedã€Redisåè®®ç­‰ |

</div>
</div>

<Tabs>
  <TabItem value="redis" label="Redisç¼“å­˜" default>
  ```java
  @Configuration
  public class RedisConfig {
      
      @Bean
      public RedisConnectionFactory redisConnectionFactory() {
          LettuceConnectionFactory factory = new LettuceConnectionFactory();
          factory.setHostName("localhost");
          factory.setPort(6379);
          factory.afterPropertiesSet();
          return factory;
      }
      
      @Bean
      public RedisTemplate<String, Object> redisTemplate() {
          RedisTemplate<String, Object> template = new RedisTemplate<>();
          template.setConnectionFactory(redisConnectionFactory());
          template.setKeySerializer(new StringRedisSerializer());
          template.setValueSerializer(new Jackson2JsonRedisSerializer<>(Object.class));
          template.afterPropertiesSet();
          return template;
      }
      
      @Bean
      public RedisCacheManager cacheManager() {
          RedisCacheConfiguration cacheConfig = RedisCacheConfiguration.defaultCacheConfig()
              .entryTtl(Duration.ofMinutes(10))
              .serializeKeysWith(RedisSerializationContext.SerializationPair
                  .fromSerializer(new StringRedisSerializer()))
              .serializeValuesWith(RedisSerializationContext.SerializationPair
                  .fromSerializer(new GenericJackson2JsonRedisSerializer()));
                  
          return RedisCacheManager.builder(redisConnectionFactory())
              .cacheDefaults(cacheConfig)
              .build();
      }
  }
  
  @Service
  public class RedisCacheService {
      
      @Autowired
      private RedisTemplate<String, Object> redisTemplate;
      
      @Autowired
      private DataRepository repository;
      
      public Object getData(String key) {
          // ä»Redisè·å–æ•°æ®
          Object value = redisTemplate.opsForValue().get(key);
          if (value != null) {
              return value;
          }
          
          // ç¼“å­˜æœªå‘½ä¸­ï¼Œä»æ•°æ®åº“è·å–
          value = repository.findByKey(key);
          if (value != null) {
              // æ›´æ–°ç¼“å­˜ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´
              redisTemplate.opsForValue().set(key, value, Duration.ofMinutes(10));
          }
          
          return value;
      }
      
      public void deleteData(String key) {
          // åˆ é™¤æ•°æ®åº“è®°å½•
          repository.deleteByKey(key);
          
          // åˆ é™¤ç¼“å­˜
          redisTemplate.delete(key);
      }
  }
  ```
  </TabItem>
  <TabItem value="redis-cluster" label="Redisé›†ç¾¤">
  ```java
  @Configuration
  public class RedisClusterConfig {
      
      @Bean
      public RedisConnectionFactory redisConnectionFactory() {
          RedisClusterConfiguration clusterConfig = new RedisClusterConfiguration();
          clusterConfig.addClusterNode(new RedisNode("redis-1", 6379));
          clusterConfig.addClusterNode(new RedisNode("redis-2", 6379));
          clusterConfig.addClusterNode(new RedisNode("redis-3", 6379));
          
          return new LettuceConnectionFactory(clusterConfig);
      }
      
      @Bean
      public RedisTemplate<String, Object> redisTemplate() {
          RedisTemplate<String, Object> template = new RedisTemplate<>();
          template.setConnectionFactory(redisConnectionFactory());
          template.setKeySerializer(new StringRedisSerializer());
          template.setValueSerializer(new GenericJackson2JsonRedisSerializer());
          template.afterPropertiesSet();
          return template;
      }
  }
  ```
  </TabItem>
  <TabItem value="redis-sentinel" label="Rediså“¨å…µ">
  ```java
  @Configuration
  public class RedisSentinelConfig {
      
      @Bean
      public RedisConnectionFactory redisConnectionFactory() {
          RedisSentinelConfiguration sentinelConfig = new RedisSentinelConfiguration()
              .master("mymaster")
              .sentinel("redis-sentinel-1", 26379)
              .sentinel("redis-sentinel-2", 26379)
              .sentinel("redis-sentinel-3", 26379);
              
          return new LettuceConnectionFactory(sentinelConfig);
      }
      
      @Bean
      public RedisTemplate<String, Object> redisTemplate() {
          RedisTemplate<String, Object> template = new RedisTemplate<>();
          template.setConnectionFactory(redisConnectionFactory());
          template.setKeySerializer(new StringRedisSerializer());
          template.setValueSerializer(new GenericJackson2JsonRedisSerializer());
          template.afterPropertiesSet();
          return template;
      }
  }
  ```
  </TabItem>
</Tabs>

### 3.3 ç¼“å­˜ç­–ç•¥

ç¼“å­˜ç­–ç•¥å†³å®šäº†ç¼“å­˜çš„ä½¿ç”¨æ–¹å¼å’Œæ•ˆæœï¼Œé€‰æ‹©åˆé€‚çš„ç¼“å­˜ç­–ç•¥å¯¹ç³»ç»Ÿæ€§èƒ½è‡³å…³é‡è¦ã€‚

<details>
<summary>å¸¸è§ç¼“å­˜ç­–ç•¥</summary>

1. **Cache-Asideï¼ˆæ—è·¯ç¼“å­˜ï¼‰**ï¼š
   - åº”ç”¨ç¨‹åºè´Ÿè´£åŒæ—¶ç»´æŠ¤ç¼“å­˜å’Œæ•°æ®åº“
   - è¯»å–æ•°æ®æ—¶å…ˆæŸ¥ç¼“å­˜ï¼Œç¼“å­˜æœªå‘½ä¸­å†æŸ¥æ•°æ®åº“å¹¶æ›´æ–°ç¼“å­˜
   - å†™å…¥æ•°æ®æ—¶å…ˆæ›´æ–°æ•°æ®åº“ï¼Œç„¶åæ›´æ–°æˆ–å¤±æ•ˆç¼“å­˜
   
2. **Read-Through**ï¼š
   - ç¼“å­˜å±‚è´Ÿè´£ä»æ•°æ®æºåŠ è½½æ•°æ®
   - åº”ç”¨ç¨‹åºåªä¸ç¼“å­˜å±‚äº¤äº’ï¼Œæ— éœ€å…³å¿ƒæ•°æ®æº
   - ç¼“å­˜æœªå‘½ä¸­æ—¶è‡ªåŠ¨ä»æ•°æ®æºåŠ è½½
   
3. **Write-Through**ï¼š
   - å†™å…¥æ•°æ®æ—¶å…ˆå†™å…¥ç¼“å­˜ï¼Œç„¶åç”±ç¼“å­˜åŒæ­¥å†™å…¥æ•°æ®åº“
   - ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œä½†å†™å…¥æ€§èƒ½è¾ƒå·®
   
4. **Write-Behind/Write-Back**ï¼š
   - å†™å…¥æ•°æ®æ—¶åªæ›´æ–°ç¼“å­˜ï¼Œç„¶åå¼‚æ­¥æ›´æ–°æ•°æ®åº“
   - æé«˜å†™å…¥æ€§èƒ½ï¼Œä½†å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±
   
5. **Write-Around**ï¼š
   - å†™å…¥æ•°æ®æ—¶åªæ›´æ–°æ•°æ®åº“ï¼Œä¸æ›´æ–°ç¼“å­˜
   - é¿å…å†™å…¥æ“ä½œæ±¡æŸ“ç¼“å­˜ï¼Œé€‚ç”¨äºè¯»å¤šå†™å°‘åœºæ™¯

</details>

```mermaid
sequenceDiagram
    participant A as åº”ç”¨
    participant C as ç¼“å­˜
    participant D as æ•°æ®åº“
    
    %% è¯»å–æ“ä½œ - Cache-Aside
    A->>C: è¯»å–æ•°æ®
    alt ç¼“å­˜å‘½ä¸­
        C-->>A: è¿”å›æ•°æ®
    else ç¼“å­˜æœªå‘½ä¸­
        C-->>A: æœªå‘½ä¸­
        A->>D: æŸ¥è¯¢æ•°æ®åº“
        D-->>A: è¿”å›æ•°æ®
        A->>C: æ›´æ–°ç¼“å­˜
    end
    
    %% å†™å…¥æ“ä½œ - Cache-Aside
    A->>D: å†™å…¥æ•°æ®åº“
    D-->>A: å†™å…¥æˆåŠŸ
    A->>C: åˆ é™¤ç¼“å­˜
    C-->>A: åˆ é™¤å®Œæˆ
```

<Tabs>
  <TabItem value="cache-aside" label="Cache-Aside" default>
  ```java
  @Service
  public class CacheAsideService {
      
      @Autowired
      private RedisTemplate<String, Object> redisTemplate;
      
      @Autowired
      private UserRepository userRepository;
      
      // è¯»å–æ“ä½œ
      public User getUser(Long id) {
          String key = "user:" + id;
          
          // 1. ä»ç¼“å­˜è¯»å–
          User user = (User) redisTemplate.opsForValue().get(key);
          if (user != null) {
              return user;
          }
          
          // 2. ç¼“å­˜æœªå‘½ä¸­ï¼Œä»æ•°æ®åº“è¯»å–
          user = userRepository.findById(id).orElse(null);
          if (user != null) {
              // 3. æ›´æ–°ç¼“å­˜
              redisTemplate.opsForValue().set(key, user, Duration.ofMinutes(30));
          }
          
          return user;
      }
      
      // å†™å…¥æ“ä½œ
      @Transactional
      public void updateUser(User user) {
          // 1. æ›´æ–°æ•°æ®åº“
          userRepository.save(user);
          
          // 2. åˆ é™¤ç¼“å­˜
          redisTemplate.delete("user:" + user.getId());
      }
  }
  ```
  </TabItem>
  <TabItem value="write-through" label="Write-Through">
  ```java
  @Service
  public class WriteThroughService {
      
      @Autowired
      private RedisTemplate<String, Object> redisTemplate;
      
      @Autowired
      private UserRepository userRepository;
      
      // å†™å…¥æ“ä½œ
      @Transactional
      public void updateUser(User user) {
          // 1. æ›´æ–°æ•°æ®åº“
          userRepository.save(user);
          
          // 2. æ›´æ–°ç¼“å­˜
          String key = "user:" + user.getId();
          redisTemplate.opsForValue().set(key, user, Duration.ofMinutes(30));
      }
  }
  ```
  </TabItem>
  <TabItem value="write-behind" label="Write-Behind">
  ```java
  @Service
  public class WriteBehindService {
      
      @Autowired
      private RedisTemplate<String, Object> redisTemplate;
      
      @Autowired
      private UserRepository userRepository;
      
      @Autowired
      private KafkaTemplate<String, User> kafkaTemplate;
      
      // å†™å…¥æ“ä½œ
      public void updateUser(User user) {
          // 1. æ›´æ–°ç¼“å­˜
          String key = "user:" + user.getId();
          redisTemplate.opsForValue().set(key, user, Duration.ofMinutes(30));
          
          // 2. å¼‚æ­¥æ›´æ–°æ•°æ®åº“
          kafkaTemplate.send("user-updates", user);
      }
      
      // æ¶ˆè´¹è€…å¤„ç†æ•°æ®åº“æ›´æ–°
      @KafkaListener(topics = "user-updates")
      public void processUserUpdate(User user) {
          userRepository.save(user);
      }
  }
  ```
  </TabItem>
</Tabs>

## 4. æ•°æ®åº“ä¼˜åŒ–

æ•°æ®åº“å¾€å¾€æ˜¯ç³»ç»Ÿæ€§èƒ½çš„ç“¶é¢ˆï¼Œä¼˜åŒ–æ•°æ®åº“è®¿é—®å¯¹æå‡æ•´ä½“æ€§èƒ½è‡³å…³é‡è¦ã€‚

### 4.1 ç´¢å¼•ä¼˜åŒ–

ç´¢å¼•æ˜¯æå‡æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½çš„å…³é”®æŠ€æœ¯ï¼Œåˆç†çš„ç´¢å¼•è®¾è®¡å¯ä»¥å¤§å¹…æå‡æŸ¥è¯¢é€Ÿåº¦ã€‚

```mermaid
graph TD
    A[ç´¢å¼•ç±»å‹] --> B[B-Treeç´¢å¼•]
    A --> C[å“ˆå¸Œç´¢å¼•]
    A --> D[ä½å›¾ç´¢å¼•]
    A --> E[å…¨æ–‡ç´¢å¼•]
    A --> F[ç©ºé—´ç´¢å¼•]
    
    B --> B1[é€‚ç”¨äºèŒƒå›´æŸ¥è¯¢]
    C --> C1[é€‚ç”¨äºç²¾ç¡®åŒ¹é…]
    D --> D1[é€‚ç”¨äºä½åŸºæ•°åˆ—]
    E --> E1[é€‚ç”¨äºæ–‡æœ¬æœç´¢]
    F --> F1[é€‚ç”¨äºåœ°ç†æ•°æ®]
```

<div className="card">
<div className="card__body">

ç´¢å¼•è®¾è®¡çš„æ ¸å¿ƒåŸåˆ™ï¼š

1. **é«˜é€‰æ‹©æ€§ä¼˜å…ˆ**ï¼šä¸ºé€‰æ‹©æ€§é«˜çš„åˆ—åˆ›å»ºç´¢å¼•ï¼ˆå¦‚ä¸»é”®ã€å”¯ä¸€çº¦æŸåˆ—ï¼‰
2. **ç»„åˆç´¢å¼•é¡ºåº**ï¼šæœ€å·¦åŒ¹é…åŸåˆ™ï¼Œå¸¸ç”¨åˆ—æ”¾åœ¨å‰é¢
3. **é¿å…è¿‡åº¦ç´¢å¼•**ï¼šç´¢å¼•ä¹Ÿéœ€è¦ç»´æŠ¤æˆæœ¬ï¼Œè¿‡å¤šç´¢å¼•ä¼šå½±å“å†™æ€§èƒ½
4. **è¦†ç›–ç´¢å¼•**ï¼šä½¿ç”¨åŒ…å«æ‰€æœ‰æŸ¥è¯¢æ‰€éœ€å­—æ®µçš„ç´¢å¼•ï¼ˆç´¢å¼•è¦†ç›–ï¼‰
5. **ç´¢å¼•åˆ—ä¼˜åŒ–**ï¼šé¿å…å¯¹ç´¢å¼•åˆ—è¿›è¡Œå‡½æ•°æ“ä½œï¼Œå¦‚`WHERE UPPER(name) = 'ABC'`
6. **ç´¢å¼•ç»´æŠ¤**ï¼šå®šæœŸåˆ†æå’Œä¼˜åŒ–ç´¢å¼•ï¼Œåˆ é™¤æœªä½¿ç”¨çš„ç´¢å¼•

</div>
</div>

<Tabs>
  <TabItem value="index-design" label="ç´¢å¼•è®¾è®¡" default>
  ```sql
  -- åˆ›å»ºåŸºæœ¬ç´¢å¼•
  CREATE INDEX idx_user_email ON users (email);
  
  -- åˆ›å»ºç»„åˆç´¢å¼•
  CREATE INDEX idx_user_name_city ON users (name, city);
  
  -- åˆ›å»ºå”¯ä¸€ç´¢å¼•
  CREATE UNIQUE INDEX idx_user_username ON users (username);
  
  -- åˆ›å»ºéƒ¨åˆ†ç´¢å¼• (PostgreSQL)
  CREATE INDEX idx_active_users ON users (created_at) WHERE active = true;
  
  -- åˆ›å»ºå‡½æ•°ç´¢å¼• (PostgreSQL)
  CREATE INDEX idx_user_email_lower ON users (LOWER(email));
  
  -- åˆ›å»ºå…¨æ–‡ç´¢å¼• (MySQL)
  CREATE FULLTEXT INDEX idx_article_content ON articles (title, content);
  ```
  </TabItem>
  <TabItem value="index-best-practices" label="ç´¢å¼•æœ€ä½³å®è·µ">
  ```java
  @Repository
  public interface UserRepository extends JpaRepository<User, Long> {
      
      // ä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢
      @Query("SELECT u FROM User u WHERE u.email = :email")
      Optional<User> findByEmail(String email);
      
      // ç»„åˆç´¢å¼•æŸ¥è¯¢ - åˆ©ç”¨idx_user_name_city
      @Query("SELECT u FROM User u WHERE u.name = :name AND u.city = :city")
      List<User> findByNameAndCity(String name, String city);
      
      // èŒƒå›´æŸ¥è¯¢ - ä½¿ç”¨ç´¢å¼•çš„æœ€å·¦å‰ç¼€
      @Query("SELECT u FROM User u WHERE u.name = :name ORDER BY u.city")
      List<User> findByNameOrderByCity(String name);
      
      // é¿å…çš„æŸ¥è¯¢æ¨¡å¼ - å¯¹ç´¢å¼•åˆ—ä½¿ç”¨å‡½æ•°
      @Query("SELECT u FROM User u WHERE LOWER(u.email) = LOWER(:email)")
      Optional<User> findByEmailIgnoreCase(String email);
      
      // æ›´å¥½çš„æ›¿ä»£æ–¹æ¡ˆ
      @Query(nativeQuery = true,
          value = "SELECT * FROM users WHERE email = :email COLLATE NOCASE")
      Optional<User> findByEmailCaseInsensitive(String email);
  }
  ```
  </TabItem>
  <TabItem value="index-analysis" label="ç´¢å¼•åˆ†æ">
  ```sql
  -- MySQLç´¢å¼•åˆ†æ
  EXPLAIN SELECT * FROM users WHERE email = 'user@example.com';
  
  -- PostgreSQLç´¢å¼•åˆ†æ
  EXPLAIN ANALYZE SELECT * FROM users WHERE email = 'user@example.com';
  
  -- æ£€æŸ¥ç´¢å¼•ä½¿ç”¨æƒ…å†µ (MySQL)
  SELECT
      INDEX_NAME,
      TABLE_NAME,
      SEQ_IN_INDEX,
      COLUMN_NAME,
      CARDINALITY
  FROM
      INFORMATION_SCHEMA.STATISTICS
  WHERE
      TABLE_SCHEMA = 'your_database'
      AND TABLE_NAME = 'users'
  ORDER BY
      INDEX_NAME,
      SEQ_IN_INDEX;
      
  -- æ£€æŸ¥æœªä½¿ç”¨çš„ç´¢å¼• (MySQL)
  SELECT
      objects.name AS table_name,
      indexes.name AS index_name,
      dm_db_index_usage_stats.user_seeks,
      dm_db_index_usage_stats.user_scans,
      dm_db_index_usage_stats.user_lookups
  FROM
      sys.dm_db_index_usage_stats
      INNER JOIN sys.indexes ON dm_db_index_usage_stats.object_id = indexes.object_id
          AND dm_db_index_usage_stats.index_id = indexes.index_id
      INNER JOIN sys.objects ON indexes.object_id = objects.object_id
  WHERE
      dm_db_index_usage_stats.user_seeks = 0
      AND dm_db_index_usage_stats.user_scans = 0
      AND dm_db_index_usage_stats.user_lookups = 0
      AND objects.name = 'users';
  ```
  </TabItem>
</Tabs>

### 4.2 æŸ¥è¯¢ä¼˜åŒ–

ä¼˜åŒ–SQLæŸ¥è¯¢æ˜¯æå‡æ•°æ®åº“æ€§èƒ½çš„é‡è¦æ‰‹æ®µï¼Œé€šè¿‡ä¼˜åŒ–æŸ¥è¯¢è¯­å¥ã€é¿å…å¸¸è§é™·é˜±ï¼Œå¯ä»¥æ˜¾è‘—æå‡æŸ¥è¯¢æ€§èƒ½ã€‚

<details>
<summary>æŸ¥è¯¢ä¼˜åŒ–æ ¸å¿ƒåŸåˆ™</summary>

1. **åªæŸ¥è¯¢éœ€è¦çš„åˆ—**ï¼šé¿å…`SELECT *`ï¼ŒåªæŸ¥è¯¢éœ€è¦çš„åˆ—
2. **å‡å°‘ç»“æœé›†å¤§å°**ï¼šä½¿ç”¨`LIMIT`/`TOP`ç­‰é™åˆ¶ç»“æœé›†å¤§å°
3. **ä¼˜åŒ–JOIN**ï¼šå‡å°‘JOINçš„è¡¨æ•°é‡ï¼Œé€‰æ‹©æ­£ç¡®çš„JOINç±»å‹
4. **åˆ†é¡µä¼˜åŒ–**ï¼šä½¿ç”¨åŸºäºä¸»é”®çš„åˆ†é¡µï¼Œé¿å…`OFFSET`
5. **é¿å…å­æŸ¥è¯¢**ï¼šå°½å¯èƒ½ä½¿ç”¨JOINæ›¿ä»£å­æŸ¥è¯¢
6. **é¿å…å…¨è¡¨æ‰«æ**ï¼šç¡®ä¿æŸ¥è¯¢æ¡ä»¶èƒ½å¤Ÿä½¿ç”¨ç´¢å¼•
7. **é€‚å½“åèŒƒå¼åŒ–**ï¼šä¸ºäº†æ€§èƒ½è€ƒè™‘ï¼Œé€‚å½“å†—ä½™å­˜å‚¨éƒ¨åˆ†æ•°æ®
8. **æ‰¹é‡æ“ä½œ**ï¼šä½¿ç”¨æ‰¹é‡æ’å…¥/æ›´æ–°æ›¿ä»£å•æ¡æ“ä½œ

</details>

<Tabs>
  <TabItem value="query-optimization" label="æŸ¥è¯¢ä¼˜åŒ–ç¤ºä¾‹" default>
  ```sql
  -- ä¼˜åŒ–å‰ï¼šæŸ¥è¯¢æ‰€æœ‰åˆ—ï¼Œå¯èƒ½ä¸å¿…è¦
  SELECT * FROM orders WHERE customer_id = 123;
  
  -- ä¼˜åŒ–åï¼šåªæŸ¥è¯¢éœ€è¦çš„åˆ—
  SELECT order_id, order_date, total_amount 
  FROM orders 
  WHERE customer_id = 123;
  
  -- ä¼˜åŒ–å‰ï¼šå­æŸ¥è¯¢
  SELECT * 
  FROM orders 
  WHERE customer_id IN (SELECT id FROM customers WHERE region = 'Europe');
  
  -- ä¼˜åŒ–åï¼šä½¿ç”¨JOIN
  SELECT o.* 
  FROM orders o 
  JOIN customers c ON o.customer_id = c.id 
  WHERE c.region = 'Europe';
  
  -- ä¼˜åŒ–å‰ï¼šOFFSETåˆ†é¡µ
  SELECT * FROM products 
  ORDER BY created_at 
  LIMIT 20 OFFSET 1000;
  
  -- ä¼˜åŒ–åï¼šåŸºäºIDåˆ†é¡µ
  SELECT * FROM products 
  WHERE id > 1000 
  ORDER BY id 
  LIMIT 20;
  
  -- ä¼˜åŒ–å‰ï¼šä½¿ç”¨å‡½æ•°åœ¨WHEREå­å¥
  SELECT * FROM users 
  WHERE YEAR(registration_date) = 2023;
  
  -- ä¼˜åŒ–åï¼šé¿å…åœ¨ç´¢å¼•åˆ—ä¸Šä½¿ç”¨å‡½æ•°
  SELECT * FROM users 
  WHERE registration_date >= '2023-01-01' 
  AND registration_date < '2024-01-01';
  ```
  </TabItem>
  <TabItem value="orm-query" label="ORMæŸ¥è¯¢ä¼˜åŒ–">
  ```java
  @Repository
  public class OrderRepository {
      
      @PersistenceContext
      private EntityManager entityManager;
      
      // ä¼˜åŒ–å‰ï¼šè·å–æ‰€æœ‰å­—æ®µ
      public List<Order> findByCustomerId(Long customerId) {
          return entityManager.createQuery(
              "SELECT o FROM Order o WHERE o.customer.id = :customerId", Order.class)
              .setParameter("customerId", customerId)
              .getResultList();
      }
      
      // ä¼˜åŒ–åï¼šä»…æŸ¥è¯¢éœ€è¦çš„å­—æ®µ
      public List<OrderProjection> findOrderProjectionsByCustomerId(Long customerId) {
          return entityManager.createQuery(
              "SELECT new com.example.OrderProjection(o.id, o.orderDate, o.totalAmount) " +
              "FROM Order o WHERE o.customer.id = :customerId", OrderProjection.class)
              .setParameter("customerId", customerId)
              .getResultList();
      }
      
      // ä¼˜åŒ–å‰ï¼šä½¿ç”¨JOIN FETCHåŠ è½½æ‰€æœ‰å…³è”
      public List<Order> findOrdersWithDetails(Long customerId) {
          return entityManager.createQuery(
              "SELECT o FROM Order o " +
              "JOIN FETCH o.items " +
              "JOIN FETCH o.customer " +
              "WHERE o.customer.id = :customerId", Order.class)
              .setParameter("customerId", customerId)
              .getResultList();
      }
      
      // ä¼˜åŒ–åï¼šä½¿ç”¨åˆ†é¡µå’Œæ‡’åŠ è½½
      public List<Order> findOrdersWithPagination(Long customerId, int page, int size) {
          return entityManager.createQuery(
              "SELECT o FROM Order o " +
              "WHERE o.customer.id = :customerId", Order.class)
              .setParameter("customerId", customerId)
              .setFirstResult(page * size)
              .setMaxResults(size)
              .getResultList();
      }
  }
  ```
  </TabItem>
  <TabItem value="batch-operations" label="æ‰¹é‡æ“ä½œ">
  ```java
  @Service
  @Transactional
  public class BatchOperationService {
      
      @PersistenceContext
      private EntityManager entityManager;
      
      // æ‰¹é‡æ’å…¥
      public void batchInsert(List<User> users) {
          final int batchSize = 100;
          
          for (int i = 0; i < users.size(); i++) {
              entityManager.persist(users.get(i));
              
              if (i % batchSize == 0 && i > 0) {
                  // æ¯æ’å…¥batchSizeæ¡æ•°æ®ï¼Œåˆ·æ–°å¹¶æ¸…ç†EntityManager
                  entityManager.flush();
                  entityManager.clear();
              }
          }
          entityManager.flush();
          entityManager.clear();
      }
      
      // æ‰¹é‡æ›´æ–°
      public void batchUpdate(List<UserUpdateDTO> updates) {
          final int batchSize = 100;
          
          Query query = entityManager.createQuery(
              "UPDATE User u SET u.status = :status WHERE u.id = :id");
              
          for (int i = 0; i < updates.size(); i++) {
              UserUpdateDTO update = updates.get(i);
              query.setParameter("status", update.getStatus())
                  .setParameter("id", update.getId())
                  .executeUpdate();
                  
              if (i % batchSize == 0 && i > 0) {
                  entityManager.flush();
                  entityManager.clear();
              }
          }
          entityManager.flush();
          entityManager.clear();
      }
      
      // JDBCæ‰¹é‡æ’å…¥
      public void jdbcBatchInsert(List<User> users) {
          JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);
          
          jdbcTemplate.batchUpdate(
              "INSERT INTO users (name, email, status) VALUES (?, ?, ?)",
              new BatchPreparedStatementSetter() {
                  @Override
                  public void setValues(PreparedStatement ps, int i) throws SQLException {
                      User user = users.get(i);
                      ps.setString(1, user.getName());
                      ps.setString(2, user.getEmail());
                      ps.setString(3, user.getStatus());
                  }
                  
                  @Override
                  public int getBatchSize() {
                      return users.size();
                  }
              });
      }
  }
  ```
  </TabItem>
</Tabs>

### 4.3 è¿æ¥æ± ä¼˜åŒ–

æ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–æ˜¯æå‡æ•°æ®åº“è®¿é—®æ€§èƒ½çš„é‡è¦æ‰‹æ®µï¼Œè¿æ¥æ± é¿å…äº†é¢‘ç¹åˆ›å»ºå’Œé”€æ¯æ•°æ®åº“è¿æ¥çš„å¼€é”€ã€‚

```mermaid
graph LR
    A[åº”ç”¨ç¨‹åº] --> B[è¿æ¥æ± ]
    B --> C[æ•°æ®åº“]
    
    subgraph è¿æ¥æ± ç®¡ç†
        B --> D[ç©ºé—²è¿æ¥]
        B --> E[æ­£åœ¨ä½¿ç”¨çš„è¿æ¥]
        B --> F[æœ€å¤§è¿æ¥æ•°]
        B --> G[æœ€å°è¿æ¥æ•°]
        B --> H[è¶…æ—¶æ—¶é—´]
    end
```

<Tabs>
  <TabItem value="hikari" label="HikariCPé…ç½®" default>
  ```java
  @Configuration
  public class HikariConfig {
      
      @Bean
      public DataSource dataSource() {
          com.zaxxer.hikari.HikariConfig config = new com.zaxxer.hikari.HikariConfig();
          config.setJdbcUrl("jdbc:mysql://localhost:3306/mydb");
          config.setUsername("user");
          config.setPassword("password");
          config.setDriverClassName("com.mysql.cj.jdbc.Driver");
          
          // è¿æ¥æ± æ ¸å¿ƒå‚æ•°
          config.setMaximumPoolSize(20);
          config.setMinimumIdle(5);
          config.setIdleTimeout(30000);
          config.setConnectionTimeout(10000);
          config.setMaxLifetime(1800000);
          
          // æ€§èƒ½ä¼˜åŒ–å‚æ•°
          config.addDataSourceProperty("cachePrepStmts", "true");
          config.addDataSourceProperty("prepStmtCacheSize", "250");
          config.addDataSourceProperty("prepStmtCacheSqlLimit", "2048");
          config.addDataSourceProperty("useServerPrepStmts", "true");
          
          return new HikariDataSource(config);
      }
  }
  ```
  </TabItem>
  <TabItem value="dbcp2" label="DBCP2é…ç½®">
  ```java
  @Configuration
  public class Dbcp2Config {
      
      @Bean
      public DataSource dataSource() {
          BasicDataSource dataSource = new BasicDataSource();
          dataSource.setDriverClassName("com.mysql.cj.jdbc.Driver");
          dataSource.setUrl("jdbc:mysql://localhost:3306/mydb");
          dataSource.setUsername("user");
          dataSource.setPassword("password");
          
          // è¿æ¥æ± å¤§å°
          dataSource.setInitialSize(5);
          dataSource.setMaxTotal(20);
          dataSource.setMaxIdle(10);
          dataSource.setMinIdle(5);
          
          // è¿æ¥æœ‰æ•ˆæ€§æ£€æŸ¥
          dataSource.setTestOnBorrow(true);
          dataSource.setValidationQuery("SELECT 1");
          dataSource.setValidationQueryTimeout(5);
          
          // è¿æ¥å›æ”¶å‚æ•°
          dataSource.setMaxWaitMillis(10000);
          dataSource.setRemoveAbandonedTimeout(60);
          dataSource.setRemoveAbandonedOnBorrow(true);
          dataSource.setRemoveAbandonedOnMaintenance(true);
          
          return dataSource;
      }
  }
  ```
  </TabItem>
  <TabItem value="monitoring" label="è¿æ¥æ± ç›‘æ§">
  ```java
  @Component
  @ManagedResource(objectName = "com.example:type=ConnectionPool")
  public class ConnectionPoolMonitor {
      
      private final HikariDataSource dataSource;
      
      public ConnectionPoolMonitor(DataSource dataSource) {
          this.dataSource = (HikariDataSource) dataSource;
      }
      
      @ManagedAttribute
      public int getTotalConnections() {
          return dataSource.getHikariPoolMXBean().getTotalConnections();
      }
      
      @ManagedAttribute
      public int getActiveConnections() {
          return dataSource.getHikariPoolMXBean().getActiveConnections();
      }
      
      @ManagedAttribute
      public int getIdleConnections() {
          return dataSource.getHikariPoolMXBean().getIdleConnections();
      }
      
      @ManagedAttribute
      public int getThreadsAwaitingConnection() {
          return dataSource.getHikariPoolMXBean().getThreadsAwaitingConnection();
      }
      
      @Scheduled(fixedRate = 60000)
      public void logPoolStats() {
          log.info("Connection Pool Stats - Total: {}, Active: {}, Idle: {}, Waiting: {}",
              getTotalConnections(), getActiveConnections(), getIdleConnections(), 
              getThreadsAwaitingConnection());
      }
  }
  ```
  </TabItem>
</Tabs>

:::caution è¿æ¥æ± ä¼˜åŒ–æ³¨æ„äº‹é¡¹
1. **è¿æ¥æ± å¤§å°**ï¼šæ ¹æ®ç¡¬ä»¶èµ„æºå’Œå¹¶å‘é‡åˆç†è®¾ç½®ï¼Œé€šå¸¸`è¿æ¥æ•° = ((CPUæ ¸å¿ƒæ•° * 2) + æœ‰æ•ˆç£ç›˜æ•°)`
2. **æœ€å°ç©ºé—²è¿æ¥**ï¼šä¿æŒä¸€å®šæ•°é‡çš„ç©ºé—²è¿æ¥ï¼Œå‡å°‘è¿æ¥åˆ›å»ºå¼€é”€
3. **è¿æ¥è¶…æ—¶**ï¼šè®¾ç½®åˆç†çš„è¿æ¥è·å–è¶…æ—¶æ—¶é—´ï¼Œé¿å…çº¿ç¨‹é•¿æ—¶é—´ç­‰å¾…
4. **è¿æ¥æœ‰æ•ˆæ€§æ£€æŸ¥**ï¼šå®šæœŸæ£€æŸ¥è¿æ¥æœ‰æ•ˆæ€§ï¼Œä½†ä¸è¦è¿‡äºé¢‘ç¹
5. **é¢„ç¼–è¯‘è¯­å¥ç¼“å­˜**ï¼šå¯ç”¨é¢„ç¼–è¯‘è¯­å¥ç¼“å­˜ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½
6. **ç›‘æ§ä¸å‘Šè­¦**ï¼šå®æ—¶ç›‘æ§è¿æ¥æ± çŠ¶æ€ï¼ŒåŠæ—¶å‘ç°é—®é¢˜
:::

## 5. ä»£ç å±‚é¢ä¼˜åŒ–

### 5.1 å¼‚æ­¥ç¼–ç¨‹

å¼‚æ­¥ç¼–ç¨‹æ˜¯æå‡ç³»ç»Ÿååé‡çš„é‡è¦æ‰‹æ®µï¼Œé€šè¿‡å°†é˜»å¡æ“ä½œå¼‚æ­¥åŒ–ï¼Œå¯ä»¥æé«˜ç³»ç»Ÿèµ„æºåˆ©ç”¨ç‡ã€‚

```mermaid
sequenceDiagram
    participant Client
    participant Server
    participant Service1
    participant Service2
    
    Client->>Server: è¯·æ±‚
    activate Server
    Server->>+Service1: å¼‚æ­¥è°ƒç”¨
    Server->>+Service2: å¼‚æ­¥è°ƒç”¨
    Server-->>Client: ç«‹å³å“åº”
    deactivate Server
    
    Service1->>Service1: å¤„ç†ä¸­
    Service2->>Service2: å¤„ç†ä¸­
    Service1-->>-Server: å¤„ç†å®Œæˆ
    Service2-->>-Server: å¤„ç†å®Œæˆ
```

<Tabs>
  <TabItem value="completable-future" label="CompletableFuture" default>
  ```java
  @Service
  public class AsyncService {
      
      @Autowired
      private RestTemplate restTemplate;
      
      @Autowired
      private Executor executor;
      
      @Async
      public CompletableFuture<UserInfo> getUserInfo(Long userId) {
          return CompletableFuture.supplyAsync(() -> {
              // æ¨¡æ‹Ÿè¿œç¨‹è°ƒç”¨
              return restTemplate.getForObject(
                  "https://api.example.com/users/{id}", UserInfo.class, userId);
          }, executor);
      }
      
      @Async
      public CompletableFuture<List<Order>> getUserOrders(Long userId) {
          return CompletableFuture.supplyAsync(() -> {
              // æ¨¡æ‹Ÿè¿œç¨‹è°ƒç”¨
              return restTemplate.getForObject(
                  "https://api.example.com/users/{id}/orders", 
                  new ParameterizedTypeReference<List<Order>>() {}, 
                  userId);
          }, executor);
      }
      
      public CompletableFuture<UserDetails> getUserDetails(Long userId) {
          CompletableFuture<UserInfo> userInfoFuture = getUserInfo(userId);
          CompletableFuture<List<Order>> ordersFuture = getUserOrders(userId);
          
          return CompletableFuture.allOf(userInfoFuture, ordersFuture)
              .thenApply(v -> {
                  UserInfo userInfo = userInfoFuture.join();
                  List<Order> orders = ordersFuture.join();
                  return new UserDetails(userInfo, orders);
              });
      }
  }
  ```
  </TabItem>
  <TabItem value="reactive" label="Spring WebFlux">
  ```java
  @RestController
  @RequestMapping("/api/users")
  public class UserController {
      
      @Autowired
      private UserService userService;
      
      @GetMapping("/{id}")
      public Mono<UserDetails> getUserDetails(@PathVariable Long id) {
          Mono<UserInfo> userInfo = userService.getUserInfo(id);
          Mono<List<Order>> orders = userService.getUserOrders(id);
          
          return Mono.zip(userInfo, orders, UserDetails::new);
      }
  }
  
  @Service
  public class UserService {
      
      @Autowired
      private WebClient webClient;
      
      public Mono<UserInfo> getUserInfo(Long userId) {
          return webClient.get()
              .uri("https://api.example.com/users/{id}", userId)
              .retrieve()
              .bodyToMono(UserInfo.class);
      }
      
      public Mono<List<Order>> getUserOrders(Long userId) {
          return webClient.get()
              .uri("https://api.example.com/users/{id}/orders", userId)
              .retrieve()
              .bodyToFlux(Order.class)
              .collectList();
      }
  }
  ```
  </TabItem>
  <TabItem value="virtual-threads" label="Javaè™šæ‹Ÿçº¿ç¨‹">
  ```java
  @Service
  public class VirtualThreadService {
      
      @Autowired
      private UserRepository userRepository;
      
      @Autowired
      private OrderRepository orderRepository;
      
      // ä½¿ç”¨Java 19+çš„è™šæ‹Ÿçº¿ç¨‹
      public UserDetails getUserDetails(Long userId) throws ExecutionException, InterruptedException {
          try (var executor = Executors.newVirtualThreadPerTaskExecutor()) {
              Future<User> userFuture = executor.submit(() -> userRepository.findById(userId).orElse(null));
              Future<List<Order>> ordersFuture = executor.submit(() -> orderRepository.findByUserId(userId));
              
              User user = userFuture.get();
              List<Order> orders = ordersFuture.get();
              
              return new UserDetails(user, orders);
          }
      }
      
      // å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚
      public void processRequests(List<Long> userIds) {
          try (var executor = Executors.newVirtualThreadPerTaskExecutor()) {
              List<Future<UserDetails>> futures = userIds.stream()
                  .map(id -> executor.submit(() -> getUserDetailsBlocking(id)))
                  .collect(Collectors.toList());
                  
              for (Future<UserDetails> future : futures) {
                  UserDetails details = future.get();
                  processUserDetails(details);
              }
          }
      }
      
      private UserDetails getUserDetailsBlocking(Long userId) {
          User user = userRepository.findById(userId).orElse(null);
          List<Order> orders = orderRepository.findByUserId(userId);
          return new UserDetails(user, orders);
      }
      
      private void processUserDetails(UserDetails details) {
          // å¤„ç†ç”¨æˆ·è¯¦æƒ…
      }
  }
  ```
  </TabItem>
</Tabs>

### 5.2 å¹¶è¡Œå¤„ç†

å¹¶è¡Œå¤„ç†æ˜¯å……åˆ†åˆ©ç”¨å¤šæ ¸CPUèµ„æºçš„é‡è¦æ–¹å¼ï¼Œé€šè¿‡å°†ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªå­ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œï¼Œå¯ä»¥æé«˜å¤„ç†é€Ÿåº¦ã€‚

```mermaid
graph TD
    A[å¤§ä»»åŠ¡] --> B[å­ä»»åŠ¡1]
    A --> C[å­ä»»åŠ¡2]
    A --> D[å­ä»»åŠ¡3]
    A --> E[å­ä»»åŠ¡4]
    
    B --> F[ç»“æœåˆå¹¶]
    C --> F
    D --> F
    E --> F
    
    F --> G[æœ€ç»ˆç»“æœ]
```

<Tabs>
  <TabItem value="parallel-stream" label="å¹¶è¡Œæµ" default>
  ```java
  @Service
  public class ParallelProcessingService {
      
      // å¹¶è¡Œå¤„ç†é›†åˆ
      public List<ProcessedData> processDataParallel(List<RawData> dataList) {
          return dataList.parallelStream()
              .map(this::processData)
              .collect(Collectors.toList());
      }
      
      // å¹¶è¡Œè®¡ç®—ç»Ÿè®¡ä¿¡æ¯
      public Map<String, Double> calculateStatistics(List<SalesRecord> records) {
          DoubleSummaryStatistics stats = records.parallelStream()
              .mapToDouble(SalesRecord::getAmount)
              .summaryStatistics();
              
          Map<String, Double> result = new HashMap<>();
          result.put("sum", stats.getSum());
          result.put("average", stats.getAverage());
          result.put("max", stats.getMax());
          result.put("min", stats.getMin());
          
          return result;
      }
      
      // åˆ†ç»„å¤„ç†
      public Map<String, List<Product>> groupProductsByCategory(List<Product> products) {
          return products.parallelStream()
              .collect(Collectors.groupingByConcurrent(Product::getCategory));
      }
      
      private ProcessedData processData(RawData data) {
          // å¤„ç†å•ä¸ªæ•°æ®é¡¹çš„é€»è¾‘
          return new ProcessedData(data);
      }
  }
  ```
  </TabItem>
  <TabItem value="fork-join" label="Fork/Joinæ¡†æ¶">
  ```java
  @Component
  public class DataProcessingTask extends RecursiveTask<List<ProcessedData>> {
      
      private static final int THRESHOLD = 100;
      private final List<RawData> dataList;
      private final int start;
      private final int end;
      
      public DataProcessingTask(List<RawData> dataList, int start, int end) {
          this.dataList = dataList;
          this.start = start;
          this.end = end;
      }
      
      @Override
      protected List<ProcessedData> compute() {
          int length = end - start;
          
          if (length <= THRESHOLD) {
              // å°ä»»åŠ¡ç›´æ¥å¤„ç†
              return processSequentially();
          }
          
          // å¤§ä»»åŠ¡åˆ†è§£ä¸ºå­ä»»åŠ¡
          int middle = start + length / 2;
          
          DataProcessingTask leftTask = new DataProcessingTask(dataList, start, middle);
          DataProcessingTask rightTask = new DataProcessingTask(dataList, middle, end);
          
          // åˆ†å‰æ‰§è¡Œå­ä»»åŠ¡
          leftTask.fork();
          List<ProcessedData> rightResult = rightTask.compute();
          List<ProcessedData> leftResult = leftTask.join();
          
          // åˆå¹¶ç»“æœ
          List<ProcessedData> result = new ArrayList<>(leftResult);
          result.addAll(rightResult);
          return result;
      }
      
      private List<ProcessedData> processSequentially() {
          List<ProcessedData> result = new ArrayList<>();
          for (int i = start; i < end; i++) {
              result.add(processData(dataList.get(i)));
          }
          return result;
      }
      
      private ProcessedData processData(RawData data) {
          // å¤„ç†å•ä¸ªæ•°æ®é¡¹çš„é€»è¾‘
          return new ProcessedData(data);
      }
  }
  
  @Service
  public class ForkJoinService {
      
      private final ForkJoinPool forkJoinPool = new ForkJoinPool();
      
      public List<ProcessedData> processDataParallel(List<RawData> dataList) {
          return forkJoinPool.invoke(new DataProcessingTask(dataList, 0, dataList.size()));
      }
  }
  ```
  </TabItem>
  <TabItem value="completable-future-batch" label="æ‰¹é‡å¼‚æ­¥å¤„ç†">
  ```java
  @Service
  public class BatchProcessingService {
      
      @Autowired
      private Executor executor;
      
      public List<ProcessedData> processDataInBatches(List<RawData> dataList, int batchSize) {
          // åˆ†æ‰¹å¤„ç†
          List<List<RawData>> batches = splitIntoBatches(dataList, batchSize);
          
          // åˆ›å»ºæ¯æ‰¹æ•°æ®çš„CompletableFuture
          List<CompletableFuture<List<ProcessedData>>> futures = batches.stream()
              .map(batch -> CompletableFuture.supplyAsync(() -> processBatch(batch), executor))
              .collect(Collectors.toList());
              
          // ç­‰å¾…æ‰€æœ‰æ‰¹æ¬¡å®Œæˆå¹¶åˆå¹¶ç»“æœ
          return CompletableFuture.allOf(futures.toArray(new CompletableFuture[0]))
              .thenApply(v -> futures.stream()
                  .flatMap(future -> future.join().stream())
                  .collect(Collectors.toList()))
              .join();
      }
      
      private List<ProcessedData> processBatch(List<RawData> batch) {
          return batch.stream()
              .map(this::processData)
              .collect(Collectors.toList());
      }
      
      private List<List<RawData>> splitIntoBatches(List<RawData> dataList, int batchSize) {
          List<List<RawData>> batches = new ArrayList<>();
          for (int i = 0; i < dataList.size(); i += batchSize) {
              int endIndex = Math.min(i + batchSize, dataList.size());
              batches.add(dataList.subList(i, endIndex));
          }
          return batches;
      }
      
      private ProcessedData processData(RawData data) {
          // å¤„ç†å•ä¸ªæ•°æ®é¡¹çš„é€»è¾‘
          return new ProcessedData(data);
      }
  }
  ```
  </TabItem>
</Tabs>

### 5.3 å†…å­˜ä¼˜åŒ–

å†…å­˜ä¼˜åŒ–æ˜¯æé«˜ç³»ç»Ÿæ€§èƒ½å’Œç¨³å®šæ€§çš„é‡è¦æ–¹é¢ï¼Œé€šè¿‡åˆç†ç®¡ç†å†…å­˜ä½¿ç”¨ï¼Œå¯ä»¥é¿å…å†…å­˜æ³„æ¼å’ŒOOMé”™è¯¯ã€‚

<div className="card">
<div className="card__body">

å†…å­˜ä¼˜åŒ–çš„æ ¸å¿ƒåŸåˆ™ï¼š

1. **å¯¹è±¡é‡ç”¨**ï¼šé¿å…é¢‘ç¹åˆ›å»ºå’Œé”€æ¯å¯¹è±¡ï¼Œå°¤å…¶æ˜¯å¤§å¯¹è±¡
2. **å¯¹è±¡æ± åŒ–**ï¼šä½¿ç”¨å¯¹è±¡æ± é‡ç”¨æ˜‚è´µçš„å¯¹è±¡ï¼Œå¦‚è¿æ¥ã€çº¿ç¨‹ç­‰
3. **åˆç†ç¼“å­˜**ï¼šç¼“å­˜å¸¸ç”¨æ•°æ®ï¼Œä½†è¦è®¾ç½®åˆç†çš„ç¼“å­˜å¤§å°
4. **é¿å…å†…å­˜æ³„æ¼**ï¼šæ­£ç¡®å…³é—­èµ„æºï¼Œé¿å…å¼ºå¼•ç”¨æŒæœ‰ä¸å†ä½¿ç”¨çš„å¯¹è±¡
5. **å†…å­˜åˆ†é…ä¼˜åŒ–**ï¼šå‡å°‘å¤§å¯¹è±¡åˆ†é…ï¼Œé¿å…é¢‘ç¹GC
6. **å­—ç¬¦ä¸²ä¼˜åŒ–**ï¼šåˆç†ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œé¿å…é¢‘ç¹å­—ç¬¦ä¸²æ‹¼æ¥

</div>
</div>

<Tabs>
  <TabItem value="object-pool" label="å¯¹è±¡æ± åŒ–" default>
  ```java
  @Configuration
  public class ObjectPoolConfig {
      
      @Bean
      public GenericObjectPool<ExpensiveObject> expensiveObjectPool() {
          GenericObjectPoolConfig<ExpensiveObject> config = new GenericObjectPoolConfig<>();
          config.setMaxTotal(20);
          config.setMaxIdle(10);
          config.setMinIdle(5);
          config.setTestOnBorrow(true);
          
          return new GenericObjectPool<>(new ExpensiveObjectFactory(), config);
      }
  }
  
  @Component
  public class ExpensiveObjectFactory extends BasePooledObjectFactory<ExpensiveObject> {
      
      @Override
      public ExpensiveObject create() {
          return new ExpensiveObject();
      }
      
      @Override
      public PooledObject<ExpensiveObject> wrap(ExpensiveObject obj) {
          return new DefaultPooledObject<>(obj);
      }
      
      @Override
      public void passivateObject(PooledObject<ExpensiveObject> p) {
          p.getObject().reset();
      }
      
      @Override
      public boolean validateObject(PooledObject<ExpensiveObject> p) {
          return p.getObject().isValid();
      }
  }
  
  @Service
  public class ObjectPoolService {
      
      @Autowired
      private GenericObjectPool<ExpensiveObject> objectPool;
      
      public void processWithPooledObject() {
          ExpensiveObject obj = null;
          try {
              obj = objectPool.borrowObject();
              obj.doSomething();
          } catch (Exception e) {
              log.error("Error borrowing object from pool", e);
          } finally {
              if (obj != null) {
                  objectPool.returnObject(obj);
              }
          }
      }
  }
  ```
  </TabItem>
  <TabItem value="string-optimization" label="å­—ç¬¦ä¸²ä¼˜åŒ–">
  ```java
  @Service
  public class StringOptimizationService {
      
      // ä¼˜åŒ–å‰ï¼šä½¿ç”¨+æ‹¼æ¥å­—ç¬¦ä¸²
      public String concatenateBad(List<String> strings) {
          String result = "";
          for (String s : strings) {
              result = result + s;
          }
          return result;
      }
      
      // ä¼˜åŒ–åï¼šä½¿ç”¨StringBuilder
      public String concatenateGood(List<String> strings) {
          StringBuilder sb = new StringBuilder(strings.size() * 16); // é¢„ä¼°å¤§å°
          for (String s : strings) {
              sb.append(s);
          }
          return sb.toString();
      }
      
      // ä¼˜åŒ–åï¼šä½¿ç”¨StringJoiner
      public String joinStrings(List<String> strings, String delimiter) {
          StringJoiner joiner = new StringJoiner(delimiter);
          for (String s : strings) {
              joiner.add(s);
          }
          return joiner.toString();
      }
      
      // ä¼˜åŒ–åï¼šä½¿ç”¨String.join
      public String joinWithApi(List<String> strings, String delimiter) {
          return String.join(delimiter, strings);
      }
      
      // ä¼˜åŒ–åï¼šä½¿ç”¨æµå¼API
      public String joinWithStream(List<String> strings, String delimiter) {
          return strings.stream().collect(Collectors.joining(delimiter));
      }
  }
  ```
  </TabItem>
  <TabItem value="memory-leaks" label="å†…å­˜æ³„æ¼é¿å…">
  ```java
  @Service
  public class MemoryLeakPreventionService {
      
      // ä½¿ç”¨WeakHashMapé˜²æ­¢å†…å­˜æ³„æ¼
      private final Map<Object, Object> cache = Collections.synchronizedMap(new WeakHashMap<>());
      
      // ä½¿ç”¨è½¯å¼•ç”¨ç¼“å­˜
      private final Map<String, SoftReference<byte[]>> dataCache = new ConcurrentHashMap<>();
      
      // ç¼“å­˜æ•°æ®ï¼Œä½¿ç”¨è½¯å¼•ç”¨
      public void cacheData(String key, byte[] data) {
          dataCache.put(key, new SoftReference<>(data));
      }
      
      // è·å–ç¼“å­˜æ•°æ®ï¼Œå¤„ç†å¼•ç”¨è¢«å›æ”¶çš„æƒ…å†µ
      public byte[] getData(String key) {
          SoftReference<byte[]> reference = dataCache.get(key);
          if (reference == null) {
              return null;
          }
          
          byte[] data = reference.get();
          if (data == null) {
              // å¼•ç”¨å·²è¢«å›æ”¶ï¼Œä»æ•°æ®æºé‡æ–°åŠ è½½
              dataCache.remove(key);
              return null;
          }
          
          return data;
      }
      
      // ä½¿ç”¨try-with-resourcesè‡ªåŠ¨å…³é—­èµ„æº
      public String readFile(Path path) {
          try (BufferedReader reader = Files.newBufferedReader(path)) {
              return reader.lines().collect(Collectors.joining("\n"));
          } catch (IOException e) {
              log.error("Error reading file", e);
              return null;
          }
      }
      
      // æ³¨æ„æ¸…ç†ThreadLocalå˜é‡
      private static final ThreadLocal<UserContext> userContext = ThreadLocal.withInitial(UserContext::new);
      
      public void processRequest() {
          try {
              userContext.get().setUser(getCurrentUser());
              // å¤„ç†è¯·æ±‚
          } finally {
              // æ¸…ç†ThreadLocalå˜é‡ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
              userContext.remove();
          }
      }
  }
  ```
  </TabItem>
</Tabs>

## 6. é¢è¯•é¢˜ç²¾é€‰

<details>
<summary>**Q: å¦‚ä½•æå‡ç³»ç»Ÿçš„å“åº”æ—¶é—´ï¼Ÿ**</summary>

**A:** æå‡ç³»ç»Ÿå“åº”æ—¶é—´çš„æ–¹æ³•åŒ…æ‹¬ï¼š

1. **ç¼“å­˜ä¼˜åŒ–**ï¼š
   - ä½¿ç”¨å¤šçº§ç¼“å­˜ï¼ˆæœ¬åœ°ç¼“å­˜ã€åˆ†å¸ƒå¼ç¼“å­˜ï¼‰
   - é¢„çƒ­ç¼“å­˜ï¼Œé¿å…å†·å¯åŠ¨
   - ç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼Œå‡å°‘æ•°æ®åº“è®¿é—®

2. **æ•°æ®åº“ä¼˜åŒ–**ï¼š
   - ä¼˜åŒ–ç´¢å¼•è®¾è®¡ï¼Œç¡®ä¿æŸ¥è¯¢ä½¿ç”¨ç´¢å¼•
   - ä¼˜åŒ–SQLæŸ¥è¯¢ï¼Œé¿å…å…¨è¡¨æ‰«æå’Œå¤æ‚è¿æ¥
   - è¯»å†™åˆ†ç¦»ï¼Œå‡è½»ä¸»åº“è´Ÿæ‹…

3. **ä»£ç å±‚é¢ä¼˜åŒ–**ï¼š
   - å¼‚æ­¥å¤„ç†éå®æ—¶æ“ä½œ
   - ä¼˜åŒ–ç®—æ³•ï¼Œé™ä½æ—¶é—´å¤æ‚åº¦
   - ä½¿ç”¨æ‰¹å¤„ç†ä»£æ›¿å•æ¡å¤„ç†

4. **ç½‘ç»œä¼˜åŒ–**ï¼š
   - ä½¿ç”¨CDNåŠ é€Ÿé™æ€èµ„æº
   - å‡å°‘HTTPè¯·æ±‚æ•°é‡å’Œå¤§å°
   - å¯ç”¨HTTP/2å’Œå‹ç¼©

5. **JVMä¼˜åŒ–**ï¼š
   - è°ƒæ•´GCç­–ç•¥ï¼Œå‡å°‘åœé¡¿æ—¶é—´
   - é€‚å½“å¢åŠ å †å†…å­˜ï¼Œå‡å°‘GCé¢‘ç‡
   - ä½¿ç”¨JITç¼–è¯‘ä¼˜åŒ–çƒ­ç‚¹ä»£ç 
</details>

<details>
<summary>**Q: å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜æ€§èƒ½çš„ç¼“å­˜ç³»ç»Ÿï¼Ÿ**</summary>

**A:** è®¾è®¡é«˜æ€§èƒ½ç¼“å­˜ç³»ç»Ÿçš„å…³é”®ç‚¹ï¼š

1. **å¤šçº§ç¼“å­˜æ¶æ„**ï¼š
   - L1ï¼šæœ¬åœ°å†…å­˜ç¼“å­˜ï¼ˆCaffeineã€Guavaï¼‰
   - L2ï¼šåˆ†å¸ƒå¼ç¼“å­˜ï¼ˆRedisã€Memcachedï¼‰
   - L3ï¼šæŒä¹…åŒ–å­˜å‚¨ï¼ˆæ•°æ®åº“ï¼‰

2. **ç¼“å­˜ç­–ç•¥**ï¼š
   - æ•°æ®ä¸€è‡´æ€§ç­–ç•¥ï¼šCache-Asideã€Read-Throughã€Write-Throughç­‰
   - è¿‡æœŸç­–ç•¥ï¼šTTLã€LRUã€LFUç­‰
   - é¢„åŠ è½½ç­–ç•¥ï¼šç³»ç»Ÿå¯åŠ¨æ—¶é¢„çƒ­ç¼“å­˜

3. **ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©é˜²æŠ¤**ï¼š
   - å¸ƒéš†è¿‡æ»¤å™¨é¢„é˜²ç¼“å­˜ç©¿é€
   - äº’æ–¥é”é¢„é˜²ç¼“å­˜å‡»ç©¿
   - éšæœºè¿‡æœŸæ—¶é—´é¢„é˜²ç¼“å­˜é›ªå´©

4. **ç›‘æ§ä¸ç»´æŠ¤**ï¼š
   - ç¼“å­˜å‘½ä¸­ç‡ç›‘æ§
   - ç¼“å­˜å®¹é‡å’Œå†…å­˜ä½¿ç”¨ç›‘æ§
   - ç¼“å­˜è‡ªåŠ¨æ‰©å®¹å’Œæ”¶ç¼©æœºåˆ¶

5. **åˆ†å¸ƒå¼åœºæ™¯è€ƒè™‘**ï¼š
   - ä¸€è‡´æ€§å“ˆå¸Œåˆ†ç‰‡
   - ä¸»ä»å¤åˆ¶å’Œæ•…éšœè½¬ç§»
   - è·¨åŒºåŸŸæ•°æ®åŒæ­¥
</details>

<details>
<summary>**Q: ä»€ä¹ˆæ˜¯JVMæ€§èƒ½è°ƒä¼˜ï¼Ÿå¦‚ä½•è¿›è¡Œï¼Ÿ**</summary>

**A:** JVMæ€§èƒ½è°ƒä¼˜æ˜¯ä¼˜åŒ–Javaè™šæ‹Ÿæœºè¿è¡Œå‚æ•°ä»¥æé«˜åº”ç”¨æ€§èƒ½çš„è¿‡ç¨‹ï¼š

1. **å†…å­˜åˆ†é…è°ƒä¼˜**ï¼š
   - è®¾ç½®åˆé€‚çš„å †å†…å­˜å¤§å°ï¼ˆ-Xmsã€-Xmxï¼‰
   - è°ƒæ•´æ–°ç”Ÿä»£å’Œè€å¹´ä»£æ¯”ä¾‹ï¼ˆ-XX:NewRatioï¼‰
   - è°ƒæ•´EdenåŒºå’ŒSurvivoråŒºæ¯”ä¾‹ï¼ˆ-XX:SurvivorRatioï¼‰

2. **åƒåœ¾å›æ”¶è°ƒä¼˜**ï¼š
   - é€‰æ‹©åˆé€‚çš„åƒåœ¾æ”¶é›†å™¨ï¼ˆSerialã€Parallelã€CMSã€G1ï¼‰
   - è°ƒæ•´GCè§¦å‘é˜ˆå€¼å’Œé¢‘ç‡
   - è®¾ç½®GCæ—¥å¿—å’Œç›‘æ§

3. **JITç¼–è¯‘ä¼˜åŒ–**ï¼š
   - å¯ç”¨æ–¹æ³•å†…è”ï¼ˆ-XX:+Inlineï¼‰
   - ä¼˜åŒ–é€ƒé€¸åˆ†æï¼ˆ-XX:+DoEscapeAnalysisï¼‰
   - è°ƒæ•´ä»£ç ç¼“å­˜å¤§å°ï¼ˆ-XX:ReservedCodeCacheSizeï¼‰

4. **è°ƒä¼˜æ­¥éª¤**ï¼š
   - æ”¶é›†æ€§èƒ½æ•°æ®ï¼šJVMå †è½¬å‚¨ã€GCæ—¥å¿—ã€çº¿ç¨‹å¿«ç…§
   - åˆ†æé—®é¢˜ï¼šå†…å­˜æ³„æ¼ã€GCé¢‘ç¹ã€çº¿ç¨‹é˜»å¡ç­‰
   - è°ƒæ•´å‚æ•°ï¼šæ ¹æ®åˆ†æç»“æœè°ƒæ•´JVMå‚æ•°
   - éªŒè¯æ•ˆæœï¼šæ€§èƒ½æµ‹è¯•å¯¹æ¯”è°ƒä¼˜å‰åå·®å¼‚
   - æŒç»­ä¼˜åŒ–ï¼šæ ¹æ®å®é™…è¿è¡Œæƒ…å†µæŒç»­è°ƒä¼˜

5. **å¸¸ç”¨å·¥å…·**ï¼š
   - JVisualVMï¼šå†…å­˜åˆ†æã€çº¿ç¨‹åˆ†æ
   - JMCï¼ˆJava Mission Controlï¼‰ï¼šå®æ—¶ç›‘æ§
   - MATï¼ˆMemory Analyzer Toolï¼‰ï¼šå †è½¬å‚¨åˆ†æ
   - GCViewerï¼šGCæ—¥å¿—åˆ†æ
</details>

<details>
<summary>**Q: å¦‚ä½•å¤„ç†ç³»ç»Ÿçš„æ€§èƒ½ç“¶é¢ˆï¼Ÿ**</summary>

**A:** å¤„ç†ç³»ç»Ÿæ€§èƒ½ç“¶é¢ˆçš„æ­¥éª¤ï¼š

1. **ç“¶é¢ˆè¯†åˆ«**ï¼š
   - ç›‘æ§ç³»ç»Ÿå„é¡¹æŒ‡æ ‡ï¼ˆCPUã€å†…å­˜ã€ç£ç›˜I/Oã€ç½‘ç»œI/Oç­‰ï¼‰
   - åˆ†ææ…¢æŸ¥è¯¢æ—¥å¿—å’Œæ€§èƒ½è¿½è¸ªæ•°æ®
   - é€šè¿‡å‹åŠ›æµ‹è¯•å‘ç°ç³»ç»Ÿå®¹é‡æé™

2. **CPUç“¶é¢ˆ**ï¼š
   - ä¼˜åŒ–ç®—æ³•ï¼Œé™ä½æ—¶é—´å¤æ‚åº¦
   - ä½¿ç”¨å¹¶è¡Œå¤„ç†æé«˜CPUåˆ©ç”¨ç‡
   - å¼•å…¥ç¼“å­˜å‡å°‘é‡å¤è®¡ç®—
   - å¼‚æ­¥å¤„ç†éå®æ—¶ä»»åŠ¡

3. **å†…å­˜ç“¶é¢ˆ**ï¼š
   - æ£€æŸ¥å¹¶ä¿®å¤å†…å­˜æ³„æ¼
   - ä¼˜åŒ–å¯¹è±¡åˆ›å»ºå’Œé”€æ¯ï¼Œä½¿ç”¨å¯¹è±¡æ± 
   - è°ƒæ•´JVMå †å†…å­˜é…ç½®
   - ä½¿ç”¨å¼±å¼•ç”¨å’Œè½¯å¼•ç”¨ç®¡ç†ç¼“å­˜

4. **ç£ç›˜I/Oç“¶é¢ˆ**ï¼š
   - ä½¿ç”¨ç¼“å­˜å‡å°‘ç£ç›˜è¯»å–
   - æ‰¹é‡å¤„ç†æ–‡ä»¶æ“ä½œ
   - ä½¿ç”¨å¼‚æ­¥I/Oå’Œå†…å­˜æ˜ å°„æ–‡ä»¶
   - è€ƒè™‘ä½¿ç”¨SSDæˆ–åˆ†å¸ƒå¼å­˜å‚¨

5. **ç½‘ç»œI/Oç“¶é¢ˆ**ï¼š
   - å‡å°‘ç½‘ç»œå¾€è¿”æ¬¡æ•°
   - ä½¿ç”¨è¿æ¥æ± å¤ç”¨è¿æ¥
   - å‹ç¼©ä¼ è¾“æ•°æ®
   - ä½¿ç”¨å¼‚æ­¥éé˜»å¡I/O

6. **æ•°æ®åº“ç“¶é¢ˆ**ï¼š
   - ä¼˜åŒ–ç´¢å¼•å’ŒSQLæŸ¥è¯¢
   - å®æ–½è¯»å†™åˆ†ç¦»å’Œåˆ†åº“åˆ†è¡¨
   - ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± 
   - å¼•å…¥ç¼“å­˜å‡å°‘æ•°æ®åº“è®¿é—®

7. **æ°´å¹³æ‰©å±•**ï¼š
   - å¢åŠ æ›´å¤šæœåŠ¡å™¨å®ä¾‹
   - å®æ–½è´Ÿè½½å‡è¡¡
   - ä½¿ç”¨åˆ†å¸ƒå¼æ¶æ„
   - å¼•å…¥æœåŠ¡ç½‘æ ¼å’Œå®¹å™¨ç¼–æ’
</details>

:::tip é«˜æ€§èƒ½ç³»ç»Ÿè®¾è®¡è¦ç‚¹
1. **å…¨é¢ç›‘æ§**ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§ç³»ç»Ÿï¼ŒåŠæ—¶å‘ç°æ€§èƒ½é—®é¢˜
2. **ç®—æ³•ä¼˜åŒ–**ï¼šé€‰æ‹©åˆé€‚çš„ç®—æ³•å’Œæ•°æ®ç»“æ„ï¼Œé™ä½æ—¶é—´å¤æ‚åº¦
3. **ç¼“å­˜ç­–ç•¥**ï¼šåˆç†ä½¿ç”¨å¤šçº§ç¼“å­˜ï¼Œå‡å°‘é‡å¤è®¡ç®—å’ŒI/Oæ“ä½œ
4. **å¹¶å‘å¤„ç†**ï¼šå……åˆ†åˆ©ç”¨å¤šæ ¸CPUï¼Œæé«˜ç³»ç»Ÿååé‡
5. **æ•°æ®åº“ä¼˜åŒ–**ï¼šç´¢å¼•è®¾è®¡ã€æŸ¥è¯¢ä¼˜åŒ–ã€åˆ†åº“åˆ†è¡¨ç­‰ç­–ç•¥
6. **èµ„æºç®¡ç†**ï¼šè¿æ¥æ± ã€çº¿ç¨‹æ± ã€å¯¹è±¡æ± ç­‰èµ„æºå¤ç”¨æœºåˆ¶
7. **å†…å­˜ç®¡ç†**ï¼šé¿å…å†…å­˜æ³„æ¼ï¼Œä¼˜åŒ–å¯¹è±¡åˆ›å»ºå’Œé”€æ¯
8. **å¼‚æ­¥å¤„ç†**ï¼šä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼Œæé«˜ç³»ç»Ÿå“åº”æ€§èƒ½
:::

---

é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†é«˜æ€§èƒ½ç³»ç»Ÿè®¾è®¡çš„æ ¸å¿ƒæ¦‚å¿µå’Œä¼˜åŒ–ç­–ç•¥ã€‚é«˜æ€§èƒ½ç³»ç»Ÿè®¾è®¡æ˜¯ä¸€ä¸ªæŒç»­ä¼˜åŒ–çš„è¿‡ç¨‹ï¼Œéœ€è¦ä¸æ–­ç›‘æ§ã€åˆ†æå’Œæ”¹è¿›ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œåº”æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–æ–¹æ³•ï¼Œåœ¨æ€§èƒ½ã€å¯ç”¨æ€§ã€å¯ç»´æŠ¤æ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹ã€‚
