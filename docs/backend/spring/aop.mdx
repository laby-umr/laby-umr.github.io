---
sidebar_position: 2
title: "Spring AOPè¯¦è§£"
description: "æ·±å…¥ç†è§£Springé¢å‘åˆ‡é¢ç¼–ç¨‹åŸç†ä¸å®è·µ"
authors: [Laby]
last_update:
  date: 2025-08-07
  author: Laby
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import TOCInline from '@theme/TOCInline';

# Spring AOP è¯¦è§£

AOPï¼ˆAspect-Oriented Programmingï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰æ˜¯Springæ¡†æ¶çš„é‡è¦ç‰¹æ€§ï¼Œå®ƒå…è®¸å¼€å‘è€…å°†æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆå¦‚æ—¥å¿—ã€äº‹åŠ¡ã€å®‰å…¨ç­‰ï¼‰ä»ä¸šåŠ¡é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå®ç°å…³æ³¨ç‚¹çš„æ¨¡å—åŒ–ã€‚

:::info æœ¬æ–‡å†…å®¹æ¦‚è§ˆ
<TOCInline toc={toc} />
:::

:::tip æ ¸å¿ƒä»·å€¼
**Spring AOP = å…³æ³¨ç‚¹åˆ†ç¦» + ä»£ç å¤ç”¨ + æ¨¡å—åŒ–è®¾è®¡ + åŠ¨æ€ä»£ç†**
- ğŸ” **å…³æ³¨ç‚¹åˆ†ç¦»**ï¼šå°†æ¨ªåˆ‡å…³æ³¨ç‚¹ä¸ä¸šåŠ¡é€»è¾‘è§£è€¦
- ğŸ”„ **ä»£ç å¤ç”¨**ï¼šæ¶ˆé™¤é‡å¤ä»£ç ï¼Œæé«˜å¯ç»´æŠ¤æ€§
- ğŸ“¦ **æ¨¡å—åŒ–è®¾è®¡**ï¼šç‹¬ç«‹ç®¡ç†é€šç”¨åŠŸèƒ½ï¼Œæ˜“äºæ‰©å±•
- ğŸ”§ **åŠ¨æ€ä»£ç†**ï¼šè¿è¡Œæ—¶åŠ¨æ€å¢å¼ºï¼Œæ— ä¾µå…¥æ€§
:::

## 1. AOPåŸºç¡€æ¦‚å¿µ

### 1.1 ä»€ä¹ˆæ˜¯AOPï¼Ÿ

AOPæ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå®ƒé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤ã€‚AOPçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ¨ªåˆ‡å…³æ³¨ç‚¹ä»ä¸»ä¸šåŠ¡é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ã€‚

```mermaid
flowchart LR
    A[ä¼ ç»Ÿç¼–ç¨‹] --> B{ä¸šåŠ¡æ–¹æ³•}
    B --> C[æ—¥å¿—è®°å½•]
    B --> D[äº‹åŠ¡ç®¡ç†]
    B --> E[å®‰å…¨æ£€æŸ¥]
    B --> F[ä¸šåŠ¡é€»è¾‘]
    
    G[AOPç¼–ç¨‹] --> H{ä»£ç†å¯¹è±¡}
    H --> I[ä¸šåŠ¡æ–¹æ³•]
    I --> J[çº¯ä¸šåŠ¡é€»è¾‘]
    H -.-> K[åˆ‡é¢]
    K -.-> L[æ—¥å¿—åˆ‡é¢]
    K -.-> M[äº‹åŠ¡åˆ‡é¢]
    K -.-> N[å®‰å…¨åˆ‡é¢]
    
    style A fill:#ffcccc
    style G fill:#ccffcc
    style K fill:#ccccff
```

#### ä¼ ç»Ÿç¼–ç¨‹ vs AOPç¼–ç¨‹

<Tabs>
  <TabItem value="traditional" label="ä¼ ç»Ÿç¼–ç¨‹æ–¹å¼" default>
  ```java title="ä¼ ç»Ÿç¼–ç¨‹æ–¹å¼"
  // ä¼ ç»Ÿæ–¹å¼ - ä¸šåŠ¡é€»è¾‘å’Œæ¨ªåˆ‡å…³æ³¨ç‚¹æ··åˆ
  public class UserService {
      public void createUser(User user) {
          // æ—¥å¿—è®°å½•
          System.out.println("å¼€å§‹åˆ›å»ºç”¨æˆ·: " + user.getName());
          
          // ä¸šåŠ¡é€»è¾‘
          userRepository.save(user);
          
          // æ—¥å¿—è®°å½•
          System.out.println("ç”¨æˆ·åˆ›å»ºå®Œæˆ: " + user.getName());
      }
      
      public void updateUser(User user) {
          // æ—¥å¿—è®°å½•
          System.out.println("å¼€å§‹æ›´æ–°ç”¨æˆ·: " + user.getName());
          
          // ä¸šåŠ¡é€»è¾‘
          userRepository.update(user);
          
          // æ—¥å¿—è®°å½•
          System.out.println("ç”¨æˆ·æ›´æ–°å®Œæˆ: " + user.getName());
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>ä¼ ç»Ÿæ–¹å¼çš„ç¼ºç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>æ¨ªåˆ‡å…³æ³¨ç‚¹ä»£ç ä¸ä¸šåŠ¡é€»è¾‘æ··åˆ</li>
  <li>ä»£ç é‡å¤ï¼Œéš¾ä»¥ç»´æŠ¤</li>
  <li>èŒè´£ä¸æ˜ç¡®ï¼Œè¿åå•ä¸€èŒè´£åŸåˆ™</li>
  <li>ä¿®æ”¹æ¨ªåˆ‡é€»è¾‘éœ€è¦ä¿®æ”¹å¤šå¤„ä»£ç </li>
  </ul>
  </div>
  </div>
  </TabItem>
  
  <TabItem value="aop" label="AOPç¼–ç¨‹æ–¹å¼">
  ```java title="AOPç¼–ç¨‹æ–¹å¼"
  // AOPæ–¹å¼ - åˆ†ç¦»å…³æ³¨ç‚¹
  @Service
  public class UserService {
      public void createUser(User user) {
          // çº¯ä¸šåŠ¡é€»è¾‘
          userRepository.save(user);
      }
      
      public void updateUser(User user) {
          // çº¯ä¸šåŠ¡é€»è¾‘
          userRepository.update(user);
      }
  }
  
  @Aspect
  @Component
  public class LoggingAspect {
      @Around("execution(* com.example.service.*.*(..))")
      public Object logAround(ProceedingJoinPoint joinPoint) throws Throwable {
          System.out.println("å¼€å§‹æ‰§è¡Œ: " + joinPoint.getSignature().getName());
          Object result = joinPoint.proceed();
          System.out.println("æ‰§è¡Œå®Œæˆ: " + joinPoint.getSignature().getName());
          return result;
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>AOPæ–¹å¼çš„ä¼˜ç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>å…³æ³¨ç‚¹åˆ†ç¦»ï¼Œä¸šåŠ¡é€»è¾‘æ›´çº¯ç²¹</li>
  <li>é¿å…ä»£ç é‡å¤ï¼Œæé«˜å¯ç»´æŠ¤æ€§</li>
  <li>é›†ä¸­ç®¡ç†æ¨ªåˆ‡å…³æ³¨ç‚¹</li>
  <li>éä¾µå…¥å¼ï¼Œä¸ä¿®æ”¹åŸæœ‰ä¸šåŠ¡ä»£ç </li>
  </ul>
  </div>
  </div>
  </TabItem>
</Tabs>

### 1.2 AOPæ ¸å¿ƒæ¦‚å¿µ

```mermaid
classDiagram
    class Aspect {
        <<åˆ‡é¢>>
        +åˆ‡ç‚¹è¡¨è¾¾å¼
        +é€šçŸ¥æ–¹æ³•
    }
    class Pointcut {
        <<åˆ‡ç‚¹>>
        +è¡¨è¾¾å¼
    }
    class Advice {
        <<é€šçŸ¥>>
        +å‰ç½®é€šçŸ¥
        +åç½®é€šçŸ¥
        +ç¯ç»•é€šçŸ¥
    }
    class JoinPoint {
        <<è¿æ¥ç‚¹>>
        +æ–¹æ³•æ‰§è¡Œ
        +å¼‚å¸¸å¤„ç†
    }
    class Target {
        <<ç›®æ ‡å¯¹è±¡>>
        +ä¸šåŠ¡æ–¹æ³•
    }
    class Proxy {
        <<ä»£ç†å¯¹è±¡>>
        +å¢å¼ºæ–¹æ³•
    }
    
    Aspect --> Pointcut : å®šä¹‰
    Aspect --> Advice : åŒ…å«
    Pointcut --> JoinPoint : åŒ¹é…
    Target --> JoinPoint : æä¾›
    Proxy --> Target : ä»£ç†
    Advice --> Proxy : å¢å¼º
```

<div className="card">
<div className="card__header">
<h4>AOPæ ¸å¿ƒæ¦‚å¿µ</h4>
</div>
<div className="card__body">

| æ¦‚å¿µ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **Aspectï¼ˆåˆ‡é¢ï¼‰** | æ¨ªåˆ‡å…³æ³¨ç‚¹çš„æ¨¡å—åŒ– | `@Aspect`æ³¨è§£çš„ç±» |
| **Join Pointï¼ˆè¿æ¥ç‚¹ï¼‰** | ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸ªç‰¹å®šç‚¹ | æ–¹æ³•è°ƒç”¨ã€å¼‚å¸¸æŠ›å‡º |
| **Pointcutï¼ˆåˆ‡ç‚¹ï¼‰** | åŒ¹é…è¿æ¥ç‚¹çš„è¡¨è¾¾å¼ | `execution(* com.example.service.*.*(..))` |
| **Adviceï¼ˆé€šçŸ¥ï¼‰** | åœ¨åˆ‡ç‚¹å¤„è¦æ‰§è¡Œçš„ä»£ç  | `@Before`ã€`@After`ã€`@Around` |
| **Target Objectï¼ˆç›®æ ‡å¯¹è±¡ï¼‰** | è¢«ä»£ç†çš„å¯¹è±¡ | ä¸šåŠ¡æœåŠ¡ç±» |
| **Proxyï¼ˆä»£ç†ï¼‰** | AOPæ¡†æ¶åˆ›å»ºçš„å¯¹è±¡ | Springè‡ªåŠ¨åˆ›å»º |
| **Weavingï¼ˆç»‡å…¥ï¼‰** | å°†åˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡çš„è¿‡ç¨‹ | ç¼–è¯‘æ—¶ã€ç±»åŠ è½½æ—¶ã€è¿è¡Œæ—¶ |

</div>
</div>

<details>
<summary>AOPæ¦‚å¿µç¤ºä¾‹ä»£ç </summary>

```java title="AOPæ¦‚å¿µç¤ºä¾‹"
// 1. Aspectï¼ˆåˆ‡é¢ï¼‰
@Aspect
@Component
public class LoggingAspect {
    // åˆ‡é¢å®ç°
}

// 2. Pointcutï¼ˆåˆ‡ç‚¹ï¼‰
@Pointcut("execution(* com.example.service.*.*(..))")
public void serviceMethods() {}

// 3. Adviceï¼ˆé€šçŸ¥ï¼‰
@Before("serviceMethods()")
public void beforeAdvice() {
    System.out.println("æ–¹æ³•æ‰§è¡Œå‰");
}

// 4. Target Objectï¼ˆç›®æ ‡å¯¹è±¡ï¼‰
@Service
public class UserService {
    // ç›®æ ‡å¯¹è±¡
}
```
</details>

## 2. AOPå®ç°åŸç†

### 2.1 åŠ¨æ€ä»£ç†æœºåˆ¶

Spring AOPåŸºäºåŠ¨æ€ä»£ç†å®ç°ï¼Œæ”¯æŒJDKåŠ¨æ€ä»£ç†å’ŒCGLIBä»£ç†ï¼š

```mermaid
flowchart TD
    A[Spring AOP] --> B{ç›®æ ‡ç±»æ˜¯å¦å®ç°æ¥å£?}
    B -->|æ˜¯| C[JDKåŠ¨æ€ä»£ç†]
    B -->|å¦| D[CGLIBä»£ç†]
    
    C --> E[ç”Ÿæˆæ¥å£å®ç°ç±»]
    D --> F[ç”Ÿæˆå­ç±»]
    
    E --> G[æ–¹æ³•è°ƒç”¨]
    F --> G
    G --> H[æ‹¦æˆªå™¨é“¾]
    H --> I[å‰ç½®é€šçŸ¥]
    I --> J[ç›®æ ‡æ–¹æ³•]
    J --> K[åç½®é€šçŸ¥]
    K --> L[è¿”å›ç»“æœ]
```

<Tabs>
  <TabItem value="jdk" label="JDKåŠ¨æ€ä»£ç†" default>
  ```java title="JDKåŠ¨æ€ä»£ç†ç¤ºä¾‹"
  public class JdkDynamicProxyExample {
      
      public static void main(String[] args) {
          UserService userService = new UserService();
          
          // åˆ›å»ºä»£ç†å¯¹è±¡
          UserService proxy = (UserService) Proxy.newProxyInstance(
              UserService.class.getClassLoader(),
              new Class<?>[]{UserService.class},
              new LoggingInvocationHandler(userService)
          );
          
          // è°ƒç”¨ä»£ç†æ–¹æ³•
          proxy.createUser(new User("å¼ ä¸‰"));
      }
  }
  
  class LoggingInvocationHandler implements InvocationHandler {
      private final Object target;
      
      public LoggingInvocationHandler(Object target) {
          this.target = target;
      }
      
      @Override
      public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
          System.out.println("æ–¹æ³•æ‰§è¡Œå‰: " + method.getName());
          Object result = method.invoke(target, args);
          System.out.println("æ–¹æ³•æ‰§è¡Œå: " + method.getName());
          return result;
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>JDKåŠ¨æ€ä»£ç†ç‰¹ç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>è¦æ±‚ç›®æ ‡ç±»å¿…é¡»å®ç°æ¥å£</li>
  <li>åŸºäºJavaåå°„æœºåˆ¶</li>
  <li>ç”Ÿæˆçš„ä»£ç†ç±»å®ç°äº†ç›¸åŒçš„æ¥å£</li>
  <li>é€šè¿‡InvocationHandleræ‹¦æˆªæ–¹æ³•è°ƒç”¨</li>
  </ul>
  </div>
  </div>
  </TabItem>
  
  <TabItem value="cglib" label="CGLIBä»£ç†">
  ```java title="CGLIBä»£ç†ç¤ºä¾‹"
  public class CglibProxyExample {
      
      public static void main(String[] args) {
          Enhancer enhancer = new Enhancer();
          enhancer.setSuperclass(UserService.class);
          enhancer.setCallback(new LoggingMethodInterceptor());
          
          UserService proxy = (UserService) enhancer.create();
          proxy.createUser(new User("æå››"));
      }
  }
  
  class LoggingMethodInterceptor implements MethodInterceptor {
      
      @Override
      public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable {
          System.out.println("æ–¹æ³•æ‰§è¡Œå‰: " + method.getName());
          Object result = proxy.invokeSuper(obj, args);
          System.out.println("æ–¹æ³•æ‰§è¡Œå: " + method.getName());
          return result;
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>CGLIBä»£ç†ç‰¹ç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>ä¸è¦æ±‚ç›®æ ‡ç±»å®ç°æ¥å£</li>
  <li>åŸºäºASMå­—èŠ‚ç æ“ä½œæ¡†æ¶</li>
  <li>ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»ä½œä¸ºä»£ç†</li>
  <li>é€šè¿‡è¦†ç›–çˆ¶ç±»æ–¹æ³•å®ç°ä»£ç†</li>
  <li>æ— æ³•ä»£ç†finalç±»å’Œfinalæ–¹æ³•</li>
  </ul>
  </div>
  </div>
  </TabItem>
</Tabs>

### 2.2 ä»£ç†é€‰æ‹©æœºåˆ¶

Spring AOPæ ¹æ®ç›®æ ‡å¯¹è±¡ç±»å‹è‡ªåŠ¨é€‰æ‹©ä»£ç†æ–¹å¼ï¼š

```mermaid
flowchart TD
    A[ç›®æ ‡å¯¹è±¡] --> B{æ˜¯å¦å®ç°æ¥å£?}
    B -->|æ˜¯| C[ä½¿ç”¨JDKåŠ¨æ€ä»£ç†]
    B -->|å¦| D[ä½¿ç”¨CGLIBä»£ç†]
    C --> E[ç”Ÿæˆæ¥å£å®ç°ç±»]
    D --> F[ç”Ÿæˆå­ç±»]
    E --> G[è¿”å›ä»£ç†å¯¹è±¡]
    F --> G
```

<div className="card">
<div className="card__body">

```java title="ä»£ç†é€‰æ‹©é€»è¾‘"
public class ProxySelectionLogic {
    
    public static Object createProxy(Object target) {
        // å¦‚æœç›®æ ‡å¯¹è±¡å®ç°äº†æ¥å£ï¼Œä½¿ç”¨JDKåŠ¨æ€ä»£ç†
        if (target.getClass().getInterfaces().length > 0) {
            return createJdkProxy(target);
        } else {
            // å¦åˆ™ä½¿ç”¨CGLIBä»£ç†
            return createCglibProxy(target);
        }
    }
    
    private static Object createJdkProxy(Object target) {
        // JDKåŠ¨æ€ä»£ç†å®ç°
        return Proxy.newProxyInstance(
            target.getClass().getClassLoader(),
            target.getClass().getInterfaces(),
            new LoggingInvocationHandler(target)
        );
    }
    
    private static Object createCglibProxy(Object target) {
        // CGLIBä»£ç†å®ç°
        Enhancer enhancer = new Enhancer();
        enhancer.setSuperclass(target.getClass());
        enhancer.setCallback(new LoggingMethodInterceptor());
        return enhancer.create();
    }
}
```

</div>
</div>

## 3. åˆ‡ç‚¹è¡¨è¾¾å¼

### 3.1 åˆ‡ç‚¹è¡¨è¾¾å¼è¯­æ³•

Spring AOPä½¿ç”¨AspectJåˆ‡ç‚¹è¡¨è¾¾å¼è¯­è¨€ï¼š

```mermaid
graph TD
    A[åˆ‡ç‚¹è¡¨è¾¾å¼è¯­æ³•] --> B[execution]
    A --> C[within]
    A --> D[this]
    A --> E[target]
    A --> F[args]
    A --> G["annotation"]
    A --> H["withinæ³¨è§£"]
    A --> I["targetæ³¨è§£"]
    A --> J["argsæ³¨è§£"]
    
    B --> B1["æ–¹æ³•æ‰§è¡ŒåŒ¹é…<br>execution(* com.example.service.*.*(..))"]
    C --> C1["ç±»å‹åŒ¹é…<br>within(com.example.service.*)"]
    D --> D1["ä»£ç†å¯¹è±¡åŒ¹é…<br>this(com.example.service.UserService)"]
    E --> E1["ç›®æ ‡å¯¹è±¡åŒ¹é…<br>target(com.example.service.UserService)"]
    F --> F1["å‚æ•°åŒ¹é…<br>args(String, int)"]
    G --> G1["æ³¨è§£åŒ¹é…<br>@annotationæ³¨è§£åŒ¹é…"]
```

<Tabs>
  <TabItem value="basic" label="åŸºç¡€è¡¨è¾¾å¼" default>
  ```java title="åŸºç¡€åˆ‡ç‚¹è¡¨è¾¾å¼ç¤ºä¾‹"
  @Aspect
  @Component
  public class BasicPointcutExamples {
      
      // 1. æ–¹æ³•æ‰§è¡Œåˆ‡ç‚¹ - åŒ¹é…serviceåŒ…ä¸‹æ‰€æœ‰ç±»çš„æ‰€æœ‰æ–¹æ³•
      @Pointcut("execution(* com.example.service.*.*(..))")
      public void serviceMethods() {}
      
      // 2. æ–¹æ³•å‚æ•°åˆ‡ç‚¹ - åŒ¹é…æœ‰ä¸¤ä¸ªå‚æ•°(Stringå’Œint)çš„æ–¹æ³•
      @Pointcut("execution(* *.*(String, int))")
      public void methodsWithStringAndInt() {}
      
      // 3. è¿”å›ç±»å‹åˆ‡ç‚¹ - åŒ¹é…è¿”å›ç±»å‹ä¸ºvoidçš„æ–¹æ³•
      @Pointcut("execution(void *.*(..))")
      public void voidMethods() {}
      
      // 4. åŒ…åˆ‡ç‚¹ - åŒ¹é…serviceåŒ…åŠå­åŒ…ä¸­çš„æ‰€æœ‰æ–¹æ³•
      @Pointcut("execution(* com.example.service..*.*(..))")
      public void servicePackageAndSubpackages() {}
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>æ‰§è¡Œè¡¨è¾¾å¼æ ¼å¼</h4>
  </div>
  <div className="card__body">
  <code>execution(modifiers-pattern? return-type-pattern declaring-type-pattern? method-name-pattern(parameter-pattern) throws-pattern?)</code>
  
  - **modifiers-pattern**ï¼šè®¿é—®ä¿®é¥°ç¬¦æ¨¡å¼ï¼Œå¦‚publicã€protectedï¼ˆå¯é€‰ï¼‰
  - **return-type-pattern**ï¼šè¿”å›ç±»å‹æ¨¡å¼ï¼Œå¦‚voidã€Stringã€*ï¼ˆå¿…é€‰ï¼‰
  - **declaring-type-pattern**ï¼šå£°æ˜ç±»å‹æ¨¡å¼ï¼Œå¦‚com.example.service.*ï¼ˆå¯é€‰ï¼‰
  - **method-name-pattern**ï¼šæ–¹æ³•åæ¨¡å¼ï¼Œå¦‚get*ã€saveã€*ï¼ˆå¿…é€‰ï¼‰
  - **parameter-pattern**ï¼šå‚æ•°æ¨¡å¼ï¼Œå¦‚(..)è¡¨ç¤ºä»»æ„å‚æ•°ã€(String)è¡¨ç¤ºä¸€ä¸ªStringå‚æ•°ï¼ˆå¿…é€‰ï¼‰
  - **throws-pattern**ï¼šå¼‚å¸¸æ¨¡å¼ï¼ˆå¯é€‰ï¼‰
  
  </div>
  </div>
  </TabItem>
  
  <TabItem value="annotation" label="æ³¨è§£è¡¨è¾¾å¼">
  ```java title="æ³¨è§£åˆ‡ç‚¹è¡¨è¾¾å¼ç¤ºä¾‹"
  @Aspect
  @Component
  public class AnnotationPointcutExamples {
      
      // 1. æ³¨è§£åˆ‡ç‚¹ - åŒ¹é…å¸¦æœ‰@Transactionalæ³¨è§£çš„æ–¹æ³•
      @Pointcut("@annotation(org.springframework.transaction.annotation.Transactional)")
      public void transactionalMethods() {}
      
      // 2. ç±»å‹æ³¨è§£åˆ‡ç‚¹ - åŒ¹é…å¸¦æœ‰@Serviceæ³¨è§£çš„ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•
      @Pointcut("@within(org.springframework.stereotype.Service)")
      public void serviceClassMethods() {}
      
      // 3. å‚æ•°æ³¨è§£åˆ‡ç‚¹ - åŒ¹é…è‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°å¸¦æœ‰@Validæ³¨è§£çš„æ–¹æ³•
      @Pointcut("@args(javax.validation.Valid)")
      public void methodsWithValidatedParams() {}
      
      // 4. è‡ªå®šä¹‰æ³¨è§£ç¤ºä¾‹
      @Pointcut("@annotation(com.example.annotation.LogExecutionTime)")
      public void logExecutionTimeMethods() {}
  }
  ```
  </TabItem>
  
  <TabItem value="combined" label="ç»„åˆè¡¨è¾¾å¼">
  ```java title="ç»„åˆåˆ‡ç‚¹è¡¨è¾¾å¼ç¤ºä¾‹"
  @Aspect
  @Component
  public class CombinedPointcutExamples {
      
      // 1. ANDç»„åˆ - åŒ¹é…serviceåŒ…ä¸‹ä¸”æœ‰@Transactionalæ³¨è§£çš„æ–¹æ³•
      @Pointcut("execution(* com.example.service.*.*(..)) && @annotation(org.springframework.transaction.annotation.Transactional)")
      public void serviceTransactionalMethods() {}
      
      // 2. ORç»„åˆ - åŒ¹é…ä»»ä½•æ§åˆ¶å™¨æˆ–æœåŠ¡æ–¹æ³•
      @Pointcut("within(com.example.controller.*) || within(com.example.service.*)")
      public void controllerOrServiceMethods() {}
      
      // 3. NOTç»„åˆ - åŒ¹é…serviceåŒ…ä¸‹éç§æœ‰æ–¹æ³•
      @Pointcut("execution(* com.example.service.*.*(..)) && !execution(private * *.*(..))")
      public void nonPrivateServiceMethods() {}
      
      // 4. å¤æ‚ç»„åˆ - åŒ¹é…æœ‰@Transactionalæ³¨è§£çš„égetterã€setteræ–¹æ³•
      @Pointcut("@annotation(org.springframework.transaction.annotation.Transactional) && !execution(* get*()) && !execution(* set*(*))")
      public void transactionalNonAccessorMethods() {}
  }
  ```
  </TabItem>
</Tabs>

### 3.2 å¸¸ç”¨åˆ‡ç‚¹è¡¨è¾¾å¼

<div className="card">
<div className="card__body">

| è¡¨è¾¾å¼ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `execution(* *.*(..))` | æ‰€æœ‰æ–¹æ³•æ‰§è¡Œ | åŒ¹é…æ‰€æœ‰æ–¹æ³• |
| `execution(* com.example.service.*.*(..))` | æŒ‡å®šåŒ…ä¸‹çš„æ–¹æ³• | åŒ¹é…serviceåŒ…ä¸‹æ‰€æœ‰æ–¹æ³• |
| `execution(* *.*(String, int))` | æŒ‡å®šå‚æ•°çš„æ–¹æ³• | åŒ¹é…æœ‰ä¸¤ä¸ªå‚æ•°çš„æ–¹æ³• |
| `@annotation(Transactional)` | æ³¨è§£æ–¹æ³• | åŒ¹é…æœ‰@Transactionalæ³¨è§£çš„æ–¹æ³• |
| `within(com.example.service.*)` | æŒ‡å®šåŒ…å†…çš„è¿æ¥ç‚¹ | åŒ¹é…serviceåŒ…å†…çš„æ‰€æœ‰è¿æ¥ç‚¹ |
| `this(com.example.service.UserService)` | ä»£ç†å¯¹è±¡ç±»å‹ | åŒ¹é…ä»£ç†å¯¹è±¡ä¸ºUserServiceçš„è¿æ¥ç‚¹ |
| `target(com.example.service.UserService)` | ç›®æ ‡å¯¹è±¡ç±»å‹ | åŒ¹é…ç›®æ ‡å¯¹è±¡ä¸ºUserServiceçš„è¿æ¥ç‚¹ |
| `args(String, ..)` | å‚æ•°ç±»å‹åŒ¹é… | åŒ¹é…ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºStringçš„æ–¹æ³• |

</div>
</div>

## 4. é€šçŸ¥ç±»å‹

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant Proxy as ä»£ç†å¯¹è±¡
    participant Target as ç›®æ ‡å¯¹è±¡
    
    Client->>Proxy: è°ƒç”¨æ–¹æ³•
    
    Note over Proxy: @Before å‰ç½®é€šçŸ¥
    
    opt try å—
        Note over Proxy: @Around ç¯ç»•é€šçŸ¥å¼€å§‹
        Proxy->>Target: è°ƒç”¨ç›®æ ‡æ–¹æ³•
        Target-->>Proxy: è¿”å›ç»“æœ
        Note over Proxy: @AfterReturning è¿”å›é€šçŸ¥
    end
    
    opt catch å—
        Note over Proxy: @AfterThrowing å¼‚å¸¸é€šçŸ¥
    end
    
    opt finally å—
        Note over Proxy: @After åç½®é€šçŸ¥
    end
    
    Note over Proxy: @Around ç¯ç»•é€šçŸ¥ç»“æŸ
    
    Proxy-->>Client: è¿”å›ç»“æœ
```

<Tabs>
  <TabItem value="before" label="å‰ç½®é€šçŸ¥(@Before)" default>
  ```java title="å‰ç½®é€šçŸ¥ç¤ºä¾‹"
  @Aspect
  @Component
  public class BeforeAdviceExample {
      
      @Before("execution(* com.example.service.*.*(..))")
      public void beforeAdvice(JoinPoint joinPoint) {
          String methodName = joinPoint.getSignature().getName();
          Object[] args = joinPoint.getArgs();
          
          System.out.println("æ–¹æ³•æ‰§è¡Œå‰: " + methodName);
          System.out.println("å‚æ•°: " + Arrays.toString(args));
      }
      
      @Before("@annotation(org.springframework.transaction.annotation.Transactional)")
      public void beforeTransactional(JoinPoint joinPoint) {
          System.out.println("äº‹åŠ¡æ–¹æ³•æ‰§è¡Œå‰: " + joinPoint.getSignature().getName());
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>å‰ç½®é€šçŸ¥ç‰¹ç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œ</li>
  <li>æ— æ³•é˜»æ­¢æ–¹æ³•æ‰§è¡Œï¼ˆé™¤éæŠ›å‡ºå¼‚å¸¸ï¼‰</li>
  <li>å¯ä»¥è®¿é—®æ–¹æ³•å‚æ•°ï¼Œä½†ä¸èƒ½ä¿®æ”¹è¿”å›å€¼</li>
  <li>é€‚ç”¨åœºæ™¯ï¼šå‚æ•°æ ¡éªŒã€æƒé™æ£€æŸ¥ã€æ—¥å¿—è®°å½•</li>
  </ul>
  </div>
  </div>
  </TabItem>
  
  <TabItem value="after" label="åç½®é€šçŸ¥(@After)">
  ```java title="åç½®é€šçŸ¥ç¤ºä¾‹"
  @Aspect
  @Component
  public class AfterAdviceExample {
      
      @After("execution(* com.example.service.*.*(..))")
      public void afterAdvice(JoinPoint joinPoint) {
          String methodName = joinPoint.getSignature().getName();
          System.out.println("æ–¹æ³•æ‰§è¡Œå: " + methodName);
      }
      
      @After("execution(* com.example.repository.*.*(..))")
      public void afterRepositoryMethod(JoinPoint joinPoint) {
          String methodName = joinPoint.getSignature().getName();
          System.out.println("æ•°æ®æ“ä½œå®Œæˆ: " + methodName);
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>åç½®é€šçŸ¥ç‰¹ç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œåæ‰§è¡Œï¼ˆæ— è®ºæ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼‰</li>
  <li>ç±»ä¼¼äºfinallyå—</li>
  <li>æ— æ³•è®¿é—®æ–¹æ³•è¿”å›å€¼</li>
  <li>é€‚ç”¨åœºæ™¯ï¼šèµ„æºæ¸…ç†ã€é‡Šæ”¾è¿æ¥ã€è®°å½•æ–¹æ³•æ‰§è¡Œæ—¶é—´</li>
  </ul>
  </div>
  </div>
  </TabItem>
  
  <TabItem value="around" label="ç¯ç»•é€šçŸ¥(@Around)">
  ```java title="ç¯ç»•é€šçŸ¥ç¤ºä¾‹"
  @Aspect
  @Component
  public class AroundAdviceExample {
      
      @Around("execution(* com.example.service.*.*(..))")
      public Object aroundAdvice(ProceedingJoinPoint joinPoint) throws Throwable {
          String methodName = joinPoint.getSignature().getName();
          long startTime = System.currentTimeMillis();
          
          try {
              // æ‰§è¡Œç›®æ ‡æ–¹æ³•
              Object result = joinPoint.proceed();
              
              long endTime = System.currentTimeMillis();
              System.out.println("æ–¹æ³• " + methodName + " æ‰§è¡Œæ—¶é—´: " + (endTime - startTime) + "ms");
              
              return result;
          } catch (Exception e) {
              System.out.println("æ–¹æ³• " + methodName + " æ‰§è¡Œå¼‚å¸¸: " + e.getMessage());
              throw e;
          }
      }
      
      @Around("@annotation(com.example.annotation.LogExecutionTime)")
      public Object logExecutionTime(ProceedingJoinPoint joinPoint) throws Throwable {
          long start = System.currentTimeMillis();
          Object result = joinPoint.proceed();
          long executionTime = System.currentTimeMillis() - start;
          
          System.out.println(joinPoint.getSignature() + " executed in " + executionTime + "ms");
          return result;
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>ç¯ç»•é€šçŸ¥ç‰¹ç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>å¯ä»¥åœ¨æ–¹æ³•æ‰§è¡Œå‰åæ·»åŠ è‡ªå®šä¹‰è¡Œä¸º</li>
  <li>å®Œå…¨æ§åˆ¶ç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œï¼ˆå†³å®šæ˜¯å¦æ‰§è¡Œã€ä½•æ—¶æ‰§è¡Œï¼‰</li>
  <li>å¯ä»¥ä¿®æ”¹æ–¹æ³•çš„è¿”å›å€¼æˆ–æŠ›å‡ºçš„å¼‚å¸¸</li>
  <li>éœ€è¦æ‰‹åŠ¨è°ƒç”¨joinPoint.proceed()æ‰§è¡Œç›®æ ‡æ–¹æ³•</li>
  <li>æœ€å¼ºå¤§ä½†ä¹Ÿæœ€å¤æ‚çš„é€šçŸ¥ç±»å‹</li>
  <li>é€‚ç”¨åœºæ™¯ï¼šäº‹åŠ¡ç®¡ç†ã€æ€§èƒ½ç›‘æ§ã€ç¼“å­˜ã€é‡è¯•é€»è¾‘</li>
  </ul>
  </div>
  </div>
  </TabItem>
  
  <TabItem value="afterReturning" label="è¿”å›é€šçŸ¥(@AfterReturning)">
  ```java title="è¿”å›é€šçŸ¥ç¤ºä¾‹"
  @Aspect
  @Component
  public class AfterReturningAdviceExample {
      
      @AfterReturning(
          pointcut = "execution(* com.example.service.*.*(..))",
          returning = "result"
      )
      public void afterReturningAdvice(JoinPoint joinPoint, Object result) {
          String methodName = joinPoint.getSignature().getName();
          System.out.println("æ–¹æ³• " + methodName + " æ­£å¸¸è¿”å›: " + result);
      }
      
      @AfterReturning(
          pointcut = "execution(java.util.List com.example.service.*.*(..))",
          returning = "resultList"
      )
      public void afterReturningList(JoinPoint joinPoint, List<?> resultList) {
          System.out.println("è¿”å›åˆ—è¡¨å¤§å°: " + resultList.size());
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>è¿”å›é€šçŸ¥ç‰¹ç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>åœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œåæ‰§è¡Œ</li>
  <li>å¯ä»¥è®¿é—®æ–¹æ³•çš„è¿”å›å€¼ï¼Œä½†ä¸èƒ½ä¿®æ”¹</li>
  <li>ä»…åœ¨æ–¹æ³•æ­£å¸¸è¿”å›æ—¶æ‰§è¡Œï¼ˆæ²¡æœ‰æŠ›å‡ºå¼‚å¸¸ï¼‰</li>
  <li>é€‚ç”¨åœºæ™¯ï¼šæ—¥å¿—è®°å½•ã€ç»Ÿè®¡åˆ†æã€è¿”å›å€¼å¤„ç†</li>
  </ul>
  </div>
  </div>
  </TabItem>
  
  <TabItem value="afterThrowing" label="å¼‚å¸¸é€šçŸ¥(@AfterThrowing)">
  ```java title="å¼‚å¸¸é€šçŸ¥ç¤ºä¾‹"
  @Aspect
  @Component
  public class AfterThrowingAdviceExample {
      
      @AfterThrowing(
          pointcut = "execution(* com.example.service.*.*(..))",
          throwing = "ex"
      )
      public void afterThrowingAdvice(JoinPoint joinPoint, Exception ex) {
          String methodName = joinPoint.getSignature().getName();
          System.out.println("æ–¹æ³• " + methodName + " æŠ›å‡ºå¼‚å¸¸: " + ex.getMessage());
          
          // è®°å½•å¼‚å¸¸æ—¥å¿—
          // å‘é€å¼‚å¸¸é€šçŸ¥
          // æ¸…ç†èµ„æº
      }
      
      @AfterThrowing(
          pointcut = "execution(* com.example.repository.*.*(..))",
          throwing = "dataEx"
      )
      public void afterThrowingDataException(JoinPoint joinPoint, DataAccessException dataEx) {
          // å¤„ç†æ•°æ®è®¿é—®å¼‚å¸¸
          System.out.println("æ•°æ®è®¿é—®å¼‚å¸¸: " + dataEx.getMessage());
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>å¼‚å¸¸é€šçŸ¥ç‰¹ç‚¹</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>åœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸æ—¶æ‰§è¡Œ</li>
  <li>å¯ä»¥è®¿é—®æŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡</li>
  <li>ä¸èƒ½é˜»æ­¢å¼‚å¸¸ä¼ æ’­ï¼ˆé™¤éä½¿ç”¨ç¯ç»•é€šçŸ¥ï¼‰</li>
  <li>é€‚ç”¨åœºæ™¯ï¼šå¼‚å¸¸æ—¥å¿—ã€é”™è¯¯é€šçŸ¥ã€èµ„æºæ¸…ç†</li>
  </ul>
  </div>
  </div>
  </TabItem>
</Tabs>

### 4.1 é€šçŸ¥ç±»å‹å¯¹æ¯”

<div className="card">
<div className="card__body">

| é€šçŸ¥ç±»å‹ | æ³¨è§£ | æ‰§è¡Œæ—¶æœº | èƒ½å¦æ§åˆ¶æ–¹æ³•æ‰§è¡Œ | èƒ½å¦è®¿é—®è¿”å›å€¼ | èƒ½å¦è®¿é—®å¼‚å¸¸ | é€‚ç”¨åœºæ™¯ |
|---------|------|----------|--------------|------------|-----------|----------|
| **å‰ç½®é€šçŸ¥** | @Before | æ–¹æ³•æ‰§è¡Œå‰ | âŒ | âŒ | âŒ | å‚æ•°æ ¡éªŒã€æƒé™æ£€æŸ¥ |
| **åç½®é€šçŸ¥** | @After | æ–¹æ³•æ‰§è¡Œå(finally) | âŒ | âŒ | âŒ | èµ„æºæ¸…ç†ã€æ—¥å¿—è®°å½• |
| **è¿”å›é€šçŸ¥** | @AfterReturning | æ–¹æ³•æ­£å¸¸è¿”å›å | âŒ | âœ…(åªè¯») | âŒ | ç»“æœå¤„ç†ã€æ—¥å¿—è®°å½• |
| **å¼‚å¸¸é€šçŸ¥** | @AfterThrowing | æ–¹æ³•æŠ›å‡ºå¼‚å¸¸æ—¶ | âŒ | âŒ | âœ… | å¼‚å¸¸å¤„ç†ã€é”™è¯¯é€šçŸ¥ |
| **ç¯ç»•é€šçŸ¥** | @Around | æ–¹æ³•å‰åéƒ½å¯ | âœ… | âœ…(å¯ä¿®æ”¹) | âœ…(å¯å¤„ç†) | äº‹åŠ¡ç®¡ç†ã€æ€§èƒ½ç›‘æ§ |

</div>
</div>

## 5. å®é™…åº”ç”¨åœºæ™¯

```mermaid
graph TD
    A[AOPåº”ç”¨åœºæ™¯] --> B[æ—¥å¿—è®°å½•]
    A --> C[æ€§èƒ½ç›‘æ§]
    A --> D[äº‹åŠ¡ç®¡ç†]
    A --> E[å®‰å…¨æ§åˆ¶]
    A --> F[ç¼“å­˜ç®¡ç†]
    A --> G[é‡è¯•æœºåˆ¶]
    A --> H[æ•°æ®å®¡è®¡]
    
    B --> B1["è®°å½•æ–¹æ³•è°ƒç”¨<br>å‚æ•°å’Œè¿”å›å€¼"]
    C --> C1["æµ‹é‡æ–¹æ³•æ‰§è¡Œæ—¶é—´<br>è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ"]
    D --> D1["è‡ªåŠ¨å¼€å¯/æäº¤/å›æ»šäº‹åŠ¡"]
    E --> E1["æƒé™æ ¡éªŒ<br>è®¤è¯æˆæƒ"]
    F --> F1["æ–¹æ³•ç»“æœç¼“å­˜<br>ç¼“å­˜å¤±æ•ˆ"]
    G --> G1["å¤±è´¥è‡ªåŠ¨é‡è¯•<br>è¶…æ—¶å¤„ç†"]
    H --> H1["è®°å½•æ•°æ®å˜æ›´<br>æ“ä½œå®¡è®¡"]
```

### 5.1 æ—¥å¿—åˆ‡é¢

<Tabs>
  <TabItem value="log" label="æ—¥å¿—åˆ‡é¢" default>
  ```java title="æ—¥å¿—åˆ‡é¢"
  @Aspect
  @Component
  @Slf4j
  public class LoggingAspect {
      
      @Around("@annotation(com.example.annotation.LogExecutionTime)")
      public Object logExecutionTime(ProceedingJoinPoint joinPoint) throws Throwable {
          String methodName = joinPoint.getSignature().getName();
          String className = joinPoint.getTarget().getClass().getSimpleName();
          
          log.info("å¼€å§‹æ‰§è¡Œæ–¹æ³•: {}.{}", className, methodName);
          long startTime = System.currentTimeMillis();
          
          try {
              Object result = joinPoint.proceed();
              long endTime = System.currentTimeMillis();
              log.info("æ–¹æ³• {}.{} æ‰§è¡Œå®Œæˆï¼Œè€—æ—¶: {}ms", className, methodName, endTime - startTime);
              return result;
          } catch (Exception e) {
              log.error("æ–¹æ³• {}.{} æ‰§è¡Œå¼‚å¸¸: {}", className, methodName, e.getMessage());
              throw e;
          }
      }
      
      @Before("@annotation(com.example.annotation.LogParameters)")
      public void logParameters(JoinPoint joinPoint) {
          String methodName = joinPoint.getSignature().getName();
          Object[] args = joinPoint.getArgs();
          
          log.info("æ–¹æ³• {} çš„å‚æ•°: {}", methodName, Arrays.toString(args));
      }
  }
  ```
  </TabItem>
  
  <TabItem value="log-annotation" label="è‡ªå®šä¹‰æ—¥å¿—æ³¨è§£">
  <details>
  <summary>è‡ªå®šä¹‰æ—¥å¿—æ³¨è§£ç¤ºä¾‹</summary>
  
  ```java title="LogExecutionTimeæ³¨è§£"
  @Target({ElementType.METHOD})
  @Retention(RetentionPolicy.RUNTIME)
  public @interface LogExecutionTime {
      String value() default "";
  }
  
  @Target({ElementType.METHOD})
  @Retention(RetentionPolicy.RUNTIME)
  public @interface LogParameters {
      String value() default "";
  }
  ```
  </details>
  
  <div className="card">
  <div className="card__header">
  <h4>æ—¥å¿—åˆ‡é¢åŠŸèƒ½</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>æ–¹æ³•è°ƒç”¨è®°å½•ï¼šè®°å½•æ–¹æ³•çš„è°ƒç”¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–¹æ³•åã€å‚æ•°ç­‰</li>
  <li>æ‰§è¡Œæ—¶é—´ç»Ÿè®¡ï¼šè®°å½•æ–¹æ³•çš„æ‰§è¡Œæ—¶é•¿ï¼Œç”¨äºæ€§èƒ½åˆ†æ</li>
  <li>å¼‚å¸¸æ•è·ï¼šè®°å½•æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å¼‚å¸¸ä¿¡æ¯</li>
  <li>ç»“æœè·Ÿè¸ªï¼šè®°å½•æ–¹æ³•çš„è¿”å›å€¼</li>
  <li>è°ƒç”¨é“¾è·Ÿè¸ªï¼šè·Ÿè¸ªå®Œæ•´çš„æ–¹æ³•è°ƒç”¨é“¾</li>
  </ul>
  </div>
  </div>
  </TabItem>
</Tabs>

### 5.2 ç¼“å­˜åˆ‡é¢

<Tabs>
  <TabItem value="cache" label="ç¼“å­˜åˆ‡é¢" default>
  ```java title="ç¼“å­˜åˆ‡é¢"
  @Aspect
  @Component
  public class CacheAspect {
      
      @Autowired
      private RedisTemplate<String, Object> redisTemplate;
      
      @Around("@annotation(com.example.annotation.Cacheable)")
      public Object cache(ProceedingJoinPoint joinPoint) throws Throwable {
          String key = generateCacheKey(joinPoint);
          
          // å°è¯•ä»ç¼“å­˜è·å–
          Object cachedValue = redisTemplate.opsForValue().get(key);
          if (cachedValue != null) {
              return cachedValue;
          }
          
          // æ‰§è¡Œæ–¹æ³•å¹¶ç¼“å­˜ç»“æœ
          Object result = joinPoint.proceed();
          redisTemplate.opsForValue().set(key, result, Duration.ofMinutes(30));
          
          return result;
      }
      
      @AfterReturning("@annotation(com.example.annotation.CacheEvict)")
      public void evictCache(JoinPoint joinPoint) {
          String key = generateCacheKey(joinPoint);
          redisTemplate.delete(key);
      }
      
      private String generateCacheKey(JoinPoint joinPoint) {
          String methodName = joinPoint.getSignature().getName();
          Object[] args = joinPoint.getArgs();
          return methodName + ":" + Arrays.toString(args);
      }
  }
  ```
  </TabItem>
  
  <TabItem value="cache-usage" label="ç¼“å­˜ä½¿ç”¨ç¤ºä¾‹">
  ```java title="ç¼“å­˜ä½¿ç”¨ç¤ºä¾‹"
  @Service
  public class UserService {
      
      @Autowired
      private UserRepository userRepository;
      
      @Cacheable
      public User getUserById(Long id) {
          // è¿™ä¸ªæ–¹æ³•çš„ç»“æœä¼šè¢«ç¼“å­˜
          return userRepository.findById(id).orElse(null);
      }
      
      @CacheEvict
      public void updateUser(User user) {
          // æ›´æ–°ç”¨æˆ·åï¼Œç›¸å…³ç¼“å­˜ä¼šè¢«æ¸…é™¤
          userRepository.save(user);
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>ç¼“å­˜åˆ‡é¢ä¼˜åŠ¿</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>å‡å°‘æ•°æ®åº“è´Ÿè½½ï¼šé¿å…é‡å¤æŸ¥è¯¢ç›¸åŒæ•°æ®</li>
  <li>æé«˜å“åº”é€Ÿåº¦ï¼šç›´æ¥ä»ç¼“å­˜è¿”å›ç»“æœ</li>
  <li>é€æ˜å®ç°ï¼šä¸šåŠ¡ä»£ç æ— æ„ŸçŸ¥ç¼“å­˜æ“ä½œ</li>
  <li>é›†ä¸­ç®¡ç†ï¼šç¼“å­˜ç­–ç•¥é›†ä¸­é…ç½®</li>
  </ul>
  </div>
  </div>
  </TabItem>
</Tabs>

### 5.3 äº‹åŠ¡åˆ‡é¢

<Tabs>
  <TabItem value="transaction" label="äº‹åŠ¡åˆ‡é¢" default>
  ```java title="äº‹åŠ¡åˆ‡é¢"
  @Aspect
  @Component
  public class TransactionAspect {
      
      @Autowired
      private PlatformTransactionManager transactionManager;
      
      @Around("@annotation(com.example.annotation.Transactional)")
      public Object handleTransaction(ProceedingJoinPoint joinPoint) throws Throwable {
          TransactionStatus status = null;
          
          try {
              // å¼€å¯äº‹åŠ¡
              DefaultTransactionDefinition def = new DefaultTransactionDefinition();
              status = transactionManager.getTransaction(def);
              
              // æ‰§è¡Œç›®æ ‡æ–¹æ³•
              Object result = joinPoint.proceed();
              
              // æäº¤äº‹åŠ¡
              transactionManager.commit(status);
              
              return result;
          } catch (Exception e) {
              // å›æ»šäº‹åŠ¡
              if (status != null) {
                  transactionManager.rollback(status);
              }
              throw e;
          }
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>äº‹åŠ¡åˆ‡é¢åŠŸèƒ½</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>è‡ªåŠ¨äº‹åŠ¡ç®¡ç†ï¼šæ— éœ€æ‰‹åŠ¨å¼€å¯/æäº¤/å›æ»šäº‹åŠ¡</li>
  <li>å£°æ˜å¼äº‹åŠ¡ï¼šä½¿ç”¨æ³¨è§£å³å¯å¯ç”¨äº‹åŠ¡</li>
  <li>äº‹åŠ¡ä¼ æ’­ï¼šæ”¯æŒä¸åŒçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º</li>
  <li>äº‹åŠ¡éš”ç¦»ï¼šæ”¯æŒä¸åŒçš„äº‹åŠ¡éš”ç¦»çº§åˆ«</li>
  <li>å¼‚å¸¸å¤„ç†ï¼šè‡ªåŠ¨æ ¹æ®å¼‚å¸¸ç±»å‹å›æ»šäº‹åŠ¡</li>
  </ul>
  </div>
  </div>
  </TabItem>
  
  <TabItem value="transaction-usage" label="äº‹åŠ¡ä½¿ç”¨ç¤ºä¾‹">
  ```java title="äº‹åŠ¡ä½¿ç”¨ç¤ºä¾‹"
  @Service
  public class OrderService {
      
      @Autowired
      private OrderRepository orderRepository;
      
      @Autowired
      private PaymentService paymentService;
      
      @Transactional
      public Order createOrder(Order order) {
          // ä¿å­˜è®¢å•
          Order savedOrder = orderRepository.save(order);
          
          // å¤„ç†æ”¯ä»˜ï¼Œå¦‚æœæ”¯ä»˜å¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡ä¼šå›æ»š
          paymentService.processPayment(order.getPayment());
          
          return savedOrder;
      }
  }
  ```
  </TabItem>
</Tabs>

### 5.4 æƒé™åˆ‡é¢

<Tabs>
  <TabItem value="security" label="æƒé™åˆ‡é¢" default>
  ```java title="æƒé™åˆ‡é¢"
  @Aspect
  @Component
  public class SecurityAspect {
      
      @Autowired
      private SecurityService securityService;
      
      @Before("@annotation(com.example.annotation.RequiresPermission)")
      public void checkPermission(JoinPoint joinPoint) {
          MethodSignature signature = (MethodSignature) joinPoint.getSignature();
          RequiresPermission annotation = signature.getMethod().getAnnotation(RequiresPermission.class);
          String permission = annotation.value();
          
          if (!securityService.hasPermission(permission)) {
              throw new AccessDeniedException("æƒé™ä¸è¶³: " + permission);
          }
      }
      
      @Before("@annotation(com.example.annotation.RequiresRole)")
      public void checkRole(JoinPoint joinPoint) {
          MethodSignature signature = (MethodSignature) joinPoint.getSignature();
          RequiresRole annotation = signature.getMethod().getAnnotation(RequiresRole.class);
          String role = annotation.value();
          
          if (!securityService.hasRole(role)) {
              throw new AccessDeniedException("è§’è‰²ä¸è¶³: " + role);
          }
      }
  }
  ```
  </TabItem>
  
  <TabItem value="security-usage" label="æƒé™ä½¿ç”¨ç¤ºä¾‹">
  ```java title="æƒé™ä½¿ç”¨ç¤ºä¾‹"
  @RestController
  @RequestMapping("/api/admin")
  public class AdminController {
      
      @RequiresRole("ADMIN")
      @GetMapping("/users")
      public List<User> getAllUsers() {
          // åªæœ‰ADMINè§’è‰²æ‰èƒ½è®¿é—®
          return userService.findAll();
      }
      
      @RequiresPermission("user:delete")
      @DeleteMapping("/users/{id}")
      public void deleteUser(@PathVariable Long id) {
          // åªæœ‰æ‹¥æœ‰user:deleteæƒé™æ‰èƒ½åˆ é™¤ç”¨æˆ·
          userService.deleteById(id);
      }
  }
  ```
  
  <div className="card">
  <div className="card__header">
  <h4>æƒé™åˆ‡é¢ä¼˜åŠ¿</h4>
  </div>
  <div className="card__body">
  <ul>
  <li>å£°æ˜å¼å®‰å…¨æ§åˆ¶ï¼šé€šè¿‡æ³¨è§£å£°æ˜æƒé™éœ€æ±‚</li>
  <li>ç»†ç²’åº¦æƒé™æ§åˆ¶ï¼šç²¾ç¡®åˆ°æ–¹æ³•çº§åˆ«</li>
  <li>é›†ä¸­ç®¡ç†ï¼šå®‰å…¨é€»è¾‘ä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»</li>
  <li>å¯æ‰©å±•æ€§ï¼šæ˜“äºæ·»åŠ æ–°çš„æƒé™ç±»å‹</li>
  <li>ä¸€è‡´æ€§ï¼šç»Ÿä¸€çš„æƒé™æ§åˆ¶æœºåˆ¶</li>
  </ul>
  </div>
  </div>
  </TabItem>
</Tabs>

## 6. æ€§èƒ½ç›‘æ§åˆ‡é¢

### 6.1 æ–¹æ³•æ‰§è¡Œæ—¶é—´ç›‘æ§

<div className="card">
<div className="card__body">

```java title="æ€§èƒ½ç›‘æ§åˆ‡é¢"
@Aspect
@Component
public class PerformanceMonitorAspect {
    
    private final MeterRegistry meterRegistry;
    
    public PerformanceMonitorAspect(MeterRegistry meterRegistry) {
        this.meterRegistry = meterRegistry;
    }
    
    @Around("execution(* com.example.service.*.*(..))")
    public Object monitorPerformance(ProceedingJoinPoint joinPoint) throws Throwable {
        String methodName = joinPoint.getSignature().getName();
        String className = joinPoint.getTarget().getClass().getSimpleName();
        String metricName = className + "." + methodName;
        
        Timer.Sample sample = Timer.start(meterRegistry);
        
        try {
            Object result = joinPoint.proceed();
            sample.stop(Timer.builder("method.execution.time")
                .tag("class", className)
                .tag("method", methodName)
                .tag("status", "success")
                .register(meterRegistry));
            return result;
        } catch (Exception e) {
            sample.stop(Timer.builder("method.execution.time")
                .tag("class", className)
                .tag("method", methodName)
                .tag("status", "error")
                .register(meterRegistry));
            
            // è®°å½•å¼‚å¸¸è®¡æ•°
            meterRegistry.counter("method.execution.errors",
                "class", className,
                "method", methodName,
                "exception", e.getClass().getSimpleName()).increment();
            
            throw e;
        }
    }
}
```

</div>
</div>

```mermaid
graph TD
    A[æ€§èƒ½ç›‘æ§åˆ‡é¢] --> B[æ–¹æ³•æ‰§è¡Œæ—¶é—´]
    A --> C[è°ƒç”¨é¢‘ç‡]
    A --> D[å¼‚å¸¸ç›‘æ§]
    A --> E[èµ„æºä½¿ç”¨]
    
    B --> B1["TimeræŒ‡æ ‡"]
    C --> C1["CounteræŒ‡æ ‡"]
    D --> D1["å¼‚å¸¸è®¡æ•°å™¨"]
    E --> E1["GaugeæŒ‡æ ‡"]
    
    B1 --> F[Prometheus]
    C1 --> F
    D1 --> F
    E1 --> F
    
    F --> G[Grafana]
    G --> H[æ€§èƒ½ç›‘æ§ä»ªè¡¨ç›˜]
```

## 7. é¢è¯•é¢˜ç²¾é€‰

### 7.1 åŸºç¡€æ¦‚å¿µé¢˜

<Tabs>
  <TabItem value="q1" label="ä»€ä¹ˆæ˜¯AOP" default>
  <div className="card">
  <div className="card__header">
  <h4>Q: ä»€ä¹ˆæ˜¯AOPï¼Ÿå®ƒçš„æ ¸å¿ƒæ¦‚å¿µæœ‰å“ªäº›ï¼Ÿ</h4>
  </div>
  <div className="card__body">
  <p><strong>A:</strong> AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œç”¨äºå°†æ¨ªåˆ‡å…³æ³¨ç‚¹ä»ä¸»ä¸šåŠ¡é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ã€‚æ ¸å¿ƒæ¦‚å¿µåŒ…æ‹¬ï¼š</p>
  <ul>
  <li><strong>Aspectï¼ˆåˆ‡é¢ï¼‰</strong>ï¼šæ¨ªåˆ‡å…³æ³¨ç‚¹çš„æ¨¡å—åŒ–</li>
  <li><strong>Join Pointï¼ˆè¿æ¥ç‚¹ï¼‰</strong>ï¼šç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸ªç‰¹å®šç‚¹</li>
  <li><strong>Pointcutï¼ˆåˆ‡ç‚¹ï¼‰</strong>ï¼šåŒ¹é…è¿æ¥ç‚¹çš„è¡¨è¾¾å¼</li>
  <li><strong>Adviceï¼ˆé€šçŸ¥ï¼‰</strong>ï¼šåœ¨åˆ‡ç‚¹å¤„è¦æ‰§è¡Œçš„ä»£ç </li>
  <li><strong>Target Objectï¼ˆç›®æ ‡å¯¹è±¡ï¼‰</strong>ï¼šè¢«ä»£ç†çš„å¯¹è±¡</li>
  <li><strong>Proxyï¼ˆä»£ç†ï¼‰</strong>ï¼šAOPæ¡†æ¶åˆ›å»ºçš„å¯¹è±¡</li>
  <li><strong>Weavingï¼ˆç»‡å…¥ï¼‰</strong>ï¼šå°†åˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡çš„è¿‡ç¨‹</li>
  </ul>
  </div>
  </div>
  </TabItem>
  
  <TabItem value="q2" label="AOPå®ç°åŸç†">
  <div className="card">
  <div className="card__header">
  <h4>Q: Spring AOPçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h4>
  </div>
  <div className="card__body">
  <p><strong>A:</strong> Spring AOPåŸºäºåŠ¨æ€ä»£ç†å®ç°ï¼š</p>
  <ul>
  <li><strong>JDKåŠ¨æ€ä»£ç†</strong>ï¼šé€‚ç”¨äºå®ç°äº†æ¥å£çš„ç›®æ ‡å¯¹è±¡</li>
  <li><strong>CGLIBä»£ç†</strong>ï¼šé€‚ç”¨äºæ²¡æœ‰å®ç°æ¥å£çš„ç›®æ ‡å¯¹è±¡</li>
  <li>Springæ ¹æ®ç›®æ ‡å¯¹è±¡ç±»å‹è‡ªåŠ¨é€‰æ‹©ä»£ç†æ–¹å¼</li>
  <li>é€šè¿‡ä»£ç†å¯¹è±¡æ‹¦æˆªæ–¹æ³•è°ƒç”¨ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œå‰åæ’å…¥æ¨ªåˆ‡é€»è¾‘</li>
  </ul>
  <p>å®ç°æµç¨‹ï¼š</p>
  <ol>
  <li>è§£æåˆ‡é¢åŠåˆ‡ç‚¹è¡¨è¾¾å¼</li>
  <li>åˆ›å»ºç›®æ ‡å¯¹è±¡çš„ä»£ç†</li>
  <li>è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œé€šè¿‡æ‹¦æˆªå™¨é“¾æ‰§è¡Œé€šçŸ¥å’Œç›®æ ‡æ–¹æ³•</li>
  </ol>
  </div>
  </div>
  </TabItem>
  
  <TabItem value="q3" label="åˆ‡ç‚¹è¡¨è¾¾å¼">
  <div className="card">
  <div className="card__header">
  <h4>Q: å¸¸ç”¨çš„åˆ‡ç‚¹è¡¨è¾¾å¼æœ‰å“ªäº›ï¼Ÿ</h4>
  </div>
  <div className="card__body">
  <p><strong>A:</strong> å¸¸ç”¨çš„åˆ‡ç‚¹è¡¨è¾¾å¼åŒ…æ‹¬ï¼š</p>
  <ul>
  <li><code>execution(* com.example.service.*.*(..))</code>ï¼šåŒ¹é…serviceåŒ…ä¸­çš„æ‰€æœ‰æ–¹æ³•</li>
  <li><code>@annotation(org.springframework.transaction.annotation.Transactional)</code>ï¼šåŒ¹é…å¸¦æœ‰@Transactionalæ³¨è§£çš„æ–¹æ³•</li>
  <li><code>within(com.example.service.*)</code>ï¼šåŒ¹é…serviceåŒ…ä¸­æ‰€æœ‰ç±»çš„æ‰€æœ‰æ–¹æ³•</li>
  <li><code>this(com.example.service.UserService)</code>ï¼šåŒ¹é…ä»£ç†å¯¹è±¡ä¸ºUserServiceçš„è¿æ¥ç‚¹</li>
  <li><code>target(com.example.service.UserService)</code>ï¼šåŒ¹é…ç›®æ ‡å¯¹è±¡ä¸ºUserServiceçš„è¿æ¥ç‚¹</li>
  <li><code>args(String, int)</code>ï¼šåŒ¹é…æ¥å—Stringå’Œintå‚æ•°çš„æ–¹æ³•</li>
  </ul>
  <p>è¿™äº›è¡¨è¾¾å¼å¯ä»¥é€šè¿‡&&ï¼ˆandï¼‰ã€||ï¼ˆorï¼‰ã€!ï¼ˆnotï¼‰ç»„åˆä½¿ç”¨ï¼Œå½¢æˆæ›´å¤æ‚çš„åŒ¹é…è§„åˆ™ã€‚</p>
  </div>
  </div>
  </TabItem>
</Tabs>

### 7.2 å®è·µé¢˜

<Tabs>
  <TabItem value="q4" label="æ—¥å¿—åˆ‡é¢" default>
  <div className="card">
  <div className="card__header">
  <h4>Q: å¦‚ä½•å®ç°ä¸€ä¸ªæ—¥å¿—åˆ‡é¢ï¼Ÿ</h4>
  </div>
  <div className="card__body">
  <p><strong>A:</strong> å®ç°æ—¥å¿—åˆ‡é¢çš„æ­¥éª¤ï¼š</p>
  <ol>
  <li>åˆ›å»ºåˆ‡é¢ç±»å¹¶ä½¿ç”¨<code>@Aspect</code>æ³¨è§£</li>
  <li>å®šä¹‰åˆ‡ç‚¹è¡¨è¾¾å¼</li>
  <li>ä½¿ç”¨é€šçŸ¥æ³¨è§£ï¼ˆå¦‚<code>@Around</code>ï¼‰å®ç°æ—¥å¿—é€»è¾‘</li>
  <li>åœ¨åˆ‡é¢ä¸­è®°å½•æ–¹æ³•æ‰§è¡Œæ—¶é—´ã€å‚æ•°ã€è¿”å›å€¼ç­‰ä¿¡æ¯</li>
  </ol>
  <p><strong>æ ¸å¿ƒä»£ç ç¤ºä¾‹ï¼š</strong></p>
  ```java
@Aspect
@Component
public class LoggingAspect {
    @Around("execution(* com.example.service.*.*(..))")
    public Object logMethod(ProceedingJoinPoint joinPoint) throws Throwable {
        String methodName = joinPoint.getSignature().getName();
        log.info("å¼€å§‹æ‰§è¡Œ: {}", methodName);
        long start = System.currentTimeMillis();
        try {
            Object result = joinPoint.proceed();
            log.info("æ‰§è¡Œå®Œæˆ: {}, è€—æ—¶: {}ms", methodName, System.currentTimeMillis() - start);
            return result;
        } catch (Exception e) {
            log.error("æ‰§è¡Œå¼‚å¸¸: {}, å¼‚å¸¸: {}", methodName, e.getMessage());
            throw e;
        }
    }
}
  ```
  </div>
  </div>
  </TabItem>
  
  <TabItem value="q5" label="AOPé€šçŸ¥ç±»å‹">
  <div className="card">
  <div className="card__header">
  <h4>Q: AOPæœ‰å“ªäº›é€šçŸ¥ç±»å‹ï¼Ÿ</h4>
  </div>
  <div className="card__body">
  <p><strong>A:</strong> Spring AOPæä¾›äº”ç§é€šçŸ¥ç±»å‹ï¼š</p>
  <ul>
  <li><strong>@Before</strong>ï¼šå‰ç½®é€šçŸ¥ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œ</li>
  <li><strong>@After</strong>ï¼šåç½®é€šçŸ¥ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œåæ‰§è¡Œ</li>
  <li><strong>@Around</strong>ï¼šç¯ç»•é€šçŸ¥ï¼Œå¯ä»¥æ§åˆ¶æ–¹æ³•æ‰§è¡Œ</li>
  <li><strong>@AfterReturning</strong>ï¼šè¿”å›é€šçŸ¥ï¼Œåœ¨æ–¹æ³•æ­£å¸¸è¿”å›åæ‰§è¡Œ</li>
  <li><strong>@AfterThrowing</strong>ï¼šå¼‚å¸¸é€šçŸ¥ï¼Œåœ¨æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åæ‰§è¡Œ</li>
  </ul>
  <p><strong>é€šçŸ¥ç±»å‹é€‰æ‹©åŸåˆ™ï¼š</strong></p>
  <ul>
  <li>éœ€è¦åœ¨æ–¹æ³•æ‰§è¡Œå‰åéƒ½æ·»åŠ é€»è¾‘ï¼Œé€‰æ‹©ç¯ç»•é€šçŸ¥</li>
  <li>åªéœ€è¦åœ¨æ–¹æ³•æ‰§è¡Œå‰æ·»åŠ é€»è¾‘ï¼Œé€‰æ‹©å‰ç½®é€šçŸ¥</li>
  <li>åªéœ€è¦åœ¨æ–¹æ³•æ‰§è¡Œåæ·»åŠ é€»è¾‘ï¼Œé€‰æ‹©åç½®é€šçŸ¥æˆ–è¿”å›é€šçŸ¥</li>
  <li>éœ€è¦å¤„ç†æ–¹æ³•æ‰§è¡Œå¼‚å¸¸ï¼Œé€‰æ‹©å¼‚å¸¸é€šçŸ¥æˆ–ç¯ç»•é€šçŸ¥</li>
  <li>ä¼˜å…ˆä½¿ç”¨æœ€ç®€å•çš„é€šçŸ¥ç±»å‹ï¼Œé¿å…ä½¿ç”¨è¿‡äºå¤æ‚çš„ç¯ç»•é€šçŸ¥</li>
  </ul>
  </div>
  </div>
  </TabItem>
</Tabs>

### 7.3 é«˜çº§é¢˜

<Tabs>
  <TabItem value="q6" label="Spring AOP vs AspectJ" default>
  <div className="card">
  <div className="card__header">
  <h4>Q: Spring AOPå’ŒAspectJæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4>
  </div>
  <div className="card__body">
  <p><strong>A:</strong> ä¸»è¦åŒºåˆ«åŒ…æ‹¬ï¼š</p>
  <table>
  <thead>
  <tr>
  <th>æ¯”è¾ƒé¡¹</th>
  <th>Spring AOP</th>
  <th>AspectJ</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td>å®ç°æ–¹å¼</td>
  <td>åŸºäºåŠ¨æ€ä»£ç†</td>
  <td>åŸºäºå­—èŠ‚ç å¢å¼º</td>
  </tr>
  <tr>
  <td>ç»‡å…¥æ—¶æœº</td>
  <td>è¿è¡Œæ—¶ç»‡å…¥</td>
  <td>ç¼–è¯‘æ—¶ã€ç¼–è¯‘åã€åŠ è½½æ—¶ç»‡å…¥</td>
  </tr>
  <tr>
  <td>æ€§èƒ½</td>
  <td>è¾ƒæ…¢</td>
  <td>æ›´å¥½</td>
  </tr>
  <tr>
  <td>åŠŸèƒ½</td>
  <td>æœ‰é™</td>
  <td>æ›´å¼ºå¤§</td>
  </tr>
  <tr>
  <td>åˆ‡ç‚¹è¡¨è¾¾å¼</td>
  <td>æ”¯æŒéƒ¨åˆ†AspectJè¡¨è¾¾å¼</td>
  <td>æ”¯æŒå®Œæ•´çš„åˆ‡ç‚¹è¡¨è¾¾å¼è¯­è¨€</td>
  </tr>
  <tr>
  <td>è¿æ¥ç‚¹ç±»å‹</td>
  <td>ä»…æ–¹æ³•æ‰§è¡Œ</td>
  <td>æ–¹æ³•è°ƒç”¨ã€å­—æ®µè®¿é—®ã€æ„é€ å™¨è°ƒç”¨ç­‰</td>
  </tr>
  <tr>
  <td>æ˜“ç”¨æ€§</td>
  <td>ç®€å•æ˜“ç”¨</td>
  <td>æ›´å¤æ‚ä½†åŠŸèƒ½å¼ºå¤§</td>
  </tr>
  <tr>
  <td>åº”ç”¨åœºæ™¯</td>
  <td>ç®€å•åº”ç”¨</td>
  <td>å¤æ‚åº”ç”¨</td>
  </tr>
  </tbody>
  </table>
  </div>
  </div>
  </TabItem>
  
  <TabItem value="q7" label="AOPè‡ªè°ƒç”¨é—®é¢˜">
  <div className="card">
  <div className="card__header">
  <h4>Q: å¦‚ä½•è§£å†³AOPä¸­çš„è‡ªè°ƒç”¨é—®é¢˜ï¼Ÿ</h4>
  </div>
  <div className="card__body">
  <p><strong>A:</strong> è‡ªè°ƒç”¨é—®é¢˜æ˜¯æŒ‡åŒä¸€ä¸ªç±»ä¸­çš„æ–¹æ³•è°ƒç”¨ä¸ä¼šç»è¿‡ä»£ç†ã€‚è§£å†³æ–¹æ¡ˆï¼š</p>
  
  <p><strong>1. ä½¿ç”¨AopContext</strong></p>
  
  ```java
@Service
public class UserService {
    public void createUser(User user) {
        userRepository.save(user);
        // ä½¿ç”¨AopContextè·å–ä»£ç†å¯¹è±¡
        ((UserService) AopContext.currentProxy()).sendEmail(user);
    }
    
    @Transactional
    public void sendEmail(User user) {
        // å‘é€é‚®ä»¶çš„äº‹åŠ¡æ–¹æ³•
    }
}
  ```
  
  <p>æ³¨æ„ï¼šéœ€è¦åœ¨é…ç½®ä¸­å¯ç”¨<code>@EnableAspectJAutoProxy(exposeProxy = true)</code></p>
  
  <p><strong>2. æ³¨å…¥è‡ªèº«ä»£ç†</strong></p>
  
  ```java
@Service
public class UserService {
    @Autowired
    private UserService self; // æ³¨å…¥çš„æ˜¯ä»£ç†å¯¹è±¡
    
    public void createUser(User user) {
        userRepository.save(user);
        self.sendEmail(user); // é€šè¿‡ä»£ç†è°ƒç”¨
    }
    
    @Transactional
    public void sendEmail(User user) {
        // å‘é€é‚®ä»¶çš„äº‹åŠ¡æ–¹æ³•
    }
}
  ```
  
  <p><strong>3. æ–¹æ³•æŠ½å–</strong>ï¼šå°†æ–¹æ³•ç§»åˆ°å¦ä¸€ä¸ªç±»ä¸­</p>
  <p><strong>4. ä½¿ç”¨AspectJ</strong>ï¼šä½¿ç”¨AspectJçš„ç¼–è¯‘æ—¶æˆ–åŠ è½½æ—¶ç»‡å…¥ï¼Œå¯ä»¥è§£å†³è‡ªè°ƒç”¨é—®é¢˜</p>
  
  </div>
  </div>
  </TabItem>
</Tabs>

:::tip AOPå­¦ä¹ è¦ç‚¹
1. **ç†è§£æ ¸å¿ƒæ¦‚å¿µ**ï¼šæŒæ¡Aspectã€Pointcutã€Adviceç­‰æ¦‚å¿µ
2. **ç†Ÿæ‚‰åˆ‡ç‚¹è¡¨è¾¾å¼**ï¼šå­¦ä¼šç¼–å†™å„ç§åˆ‡ç‚¹è¡¨è¾¾å¼
3. **æŒæ¡é€šçŸ¥ç±»å‹**ï¼šäº†è§£äº”ç§é€šçŸ¥çš„ä½¿ç”¨åœºæ™¯
4. **å­¦ä¼šå®é™…åº”ç”¨**ï¼šæŒæ¡æ—¥å¿—ã€ç¼“å­˜ã€äº‹åŠ¡ç­‰åˆ‡é¢å®ç°
5. **äº†è§£æ€§èƒ½ä¼˜åŒ–**ï¼šå­¦ä¼šæ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–æŠ€å·§
:::

```mermaid
mindmap
  root((Spring AOP))
    æ ¸å¿ƒæ¦‚å¿µ
      åˆ‡é¢(Aspect)
      è¿æ¥ç‚¹(Join Point)
      åˆ‡ç‚¹(Pointcut)
      é€šçŸ¥(Advice)
      ä»£ç†(Proxy)
      ç»‡å…¥(Weaving)
    å®ç°åŸç†
      JDKåŠ¨æ€ä»£ç†
      CGLIBä»£ç†
      ä»£ç†é€‰æ‹©é€»è¾‘
      æ‹¦æˆªå™¨é“¾
    åˆ‡ç‚¹è¡¨è¾¾å¼
      execution
      within
      this/target
      args
      @annotation
      ç»„åˆè¡¨è¾¾å¼
    é€šçŸ¥ç±»å‹
      å‰ç½®é€šçŸ¥(@Before)
      åç½®é€šçŸ¥(@After)
      ç¯ç»•é€šçŸ¥(@Around)
      è¿”å›é€šçŸ¥(@AfterReturning)
      å¼‚å¸¸é€šçŸ¥(@AfterThrowing)
    åº”ç”¨åœºæ™¯
      æ—¥å¿—è®°å½•
      æ€§èƒ½ç›‘æ§
      äº‹åŠ¡ç®¡ç†
      å®‰å…¨æ§åˆ¶
      ç¼“å­˜ç®¡ç†
    é«˜çº§ç‰¹æ€§
      è‡ªè°ƒç”¨é—®é¢˜
      Spring AOP vs AspectJ
      åˆ‡é¢ä¼˜å…ˆçº§
      ä»£ç†é™åˆ¶
```

---

é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†Spring AOPçš„æ ¸å¿ƒæ¦‚å¿µã€å®ç°åŸç†å’Œå®é™…åº”ç”¨ã€‚AOPæ˜¯Springæ¡†æ¶çš„é‡è¦ç‰¹æ€§ï¼ŒæŒæ¡AOPå¯ä»¥å¸®åŠ©ä½ ç¼–å†™æ›´åŠ æ¨¡å—åŒ–ã€å¯ç»´æŠ¤çš„ä»£ç ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œåˆç†ä½¿ç”¨AOPå¯ä»¥å¤§å¤§å‡å°‘é‡å¤ä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚

## 8. å®ç”¨ç¤ºä¾‹

### 8.1 æ€§èƒ½æ—¥å¿—è®°å½•å™¨

```java title="æ€§èƒ½æ—¥å¿—è®°å½•å™¨"
@Aspect
@Component
@Slf4j
public class LoggingAspect {
    @Around("execution(* com.example.service.*.*(..))")
    public Object logMethod(ProceedingJoinPoint joinPoint) throws Throwable {
        String methodName = joinPoint.getSignature().getName();
        log.info("å¼€å§‹æ‰§è¡Œ: {}", methodName);
        long start = System.currentTimeMillis();
        try {
            Object result = joinPoint.proceed();
            log.info("æ‰§è¡Œå®Œæˆ: {}, è€—æ—¶: {}ms", methodName, System.currentTimeMillis() - start);
            return result;
        } catch (Exception e) {
            log.error("æ‰§è¡Œå¼‚å¸¸: {}, å¼‚å¸¸: {}", methodName, e.getMessage());
            throw e;
        }
    }
}
```
