"use strict";(self.webpackChunkfullstack_dev_blog=self.webpackChunkfullstack_dev_blog||[]).push([["46694"],{84277:function(e,n,t){t.r(n),t.d(n,{metadata:()=>r,default:()=>u,frontMatter:()=>o,contentTitle:()=>d,toc:()=>p,assets:()=>c});var r=JSON.parse('{"id":"backend/network-programming/netty","title":"Netty\u7F51\u7EDC\u7F16\u7A0B\u6846\u67B6\u8BE6\u89E3","description":"\u6DF1\u5165\u7406\u89E3Netty\u67B6\u6784\u8BBE\u8BA1\u3001\u6838\u5FC3\u7EC4\u4EF6\u3001\u7EBF\u7A0B\u6A21\u578B\u4E0E\u9AD8\u6027\u80FD\u7F51\u7EDC\u7F16\u7A0B\u5B9E\u8DF5","source":"@site/docs/backend/network-programming/netty.mdx","sourceDirName":"backend/network-programming","slug":"/backend/network-programming/netty","permalink":"/docs/backend/network-programming/netty","draft":false,"unlisted":false,"editUrl":"https://github.com/MasterLiu93/blog-web/tree/main/docs/backend/network-programming/netty.mdx","tags":[{"inline":true,"label":"Netty","permalink":"/docs/tags/netty"},{"inline":true,"label":"\u7F51\u7EDC\u6846\u67B6","permalink":"/docs/tags/\u7F51\u7EDC\u6846\u67B6"},{"inline":true,"label":"EventLoop","permalink":"/docs/tags/event-loop"},{"inline":true,"label":"Pipeline","permalink":"/docs/tags/pipeline"},{"inline":true,"label":"ByteBuf","permalink":"/docs/tags/byte-buf"},{"inline":true,"label":"\u9AD8\u6027\u80FD","permalink":"/docs/tags/\u9AD8\u6027\u80FD"}],"version":"current","lastUpdatedBy":"Laby","lastUpdatedAt":1755216000000,"sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Netty\u7F51\u7EDC\u7F16\u7A0B\u6846\u67B6\u8BE6\u89E3","description":"\u6DF1\u5165\u7406\u89E3Netty\u67B6\u6784\u8BBE\u8BA1\u3001\u6838\u5FC3\u7EC4\u4EF6\u3001\u7EBF\u7A0B\u6A21\u578B\u4E0E\u9AD8\u6027\u80FD\u7F51\u7EDC\u7F16\u7A0B\u5B9E\u8DF5","authors":["Laby"],"tags":["Netty","\u7F51\u7EDC\u6846\u67B6","EventLoop","Pipeline","ByteBuf","\u9AD8\u6027\u80FD"],"last_update":{"date":"2025-08-15T00:00:00.000Z","author":"Laby"}},"sidebar":"tutorialSidebar","previous":{"title":"Socket\u7F51\u7EDC\u7F16\u7A0B\u8BE6\u89E3","permalink":"/docs/backend/network-programming/socket"},"next":{"title":"\u4EE3\u7801\u8D28\u91CF\u4E0E\u8BBE\u8BA1\u6A21\u5F0F\u8BE6\u89E3","permalink":"/docs/backend/design-patterns/code-quality-intro"}}'),l=t(74848),i=t(28453),s=t(78010),a=t(57250);let o={sidebar_position:5,title:"Netty\u7F51\u7EDC\u7F16\u7A0B\u6846\u67B6\u8BE6\u89E3",description:"\u6DF1\u5165\u7406\u89E3Netty\u67B6\u6784\u8BBE\u8BA1\u3001\u6838\u5FC3\u7EC4\u4EF6\u3001\u7EBF\u7A0B\u6A21\u578B\u4E0E\u9AD8\u6027\u80FD\u7F51\u7EDC\u7F16\u7A0B\u5B9E\u8DF5",authors:["Laby"],tags:["Netty","\u7F51\u7EDC\u6846\u67B6","EventLoop","Pipeline","ByteBuf","\u9AD8\u6027\u80FD"],last_update:{date:new Date("2025-08-15T00:00:00.000Z"),author:"Laby"}},d="Netty\u7F51\u7EDC\u7F16\u7A0B\u6846\u67B6\u8BE6\u89E3",c={},p=[{value:"1. Netty\u67B6\u6784\u8BBE\u8BA1",id:"1-netty\u67B6\u6784\u8BBE\u8BA1",level:2},{value:"1.1 \u6838\u5FC3\u7EC4\u4EF6\u67B6\u6784",id:"11-\u6838\u5FC3\u7EC4\u4EF6\u67B6\u6784",level:3},{value:"1.2 Reactor\u7EBF\u7A0B\u6A21\u578B",id:"12-reactor\u7EBF\u7A0B\u6A21\u578B",level:3},{value:"2. Netty\u6838\u5FC3\u7EC4\u4EF6\u8BE6\u89E3",id:"2-netty\u6838\u5FC3\u7EC4\u4EF6\u8BE6\u89E3",level:2},{value:"2.1 Bootstrap\u542F\u52A8\u5668",id:"21-bootstrap\u542F\u52A8\u5668",level:3},{value:"2.2 ChannelPipeline\u5904\u7406\u94FE",id:"22-channelpipeline\u5904\u7406\u94FE",level:3},{value:"2.3 ByteBuf\u7F13\u51B2\u533A",id:"23-bytebuf\u7F13\u51B2\u533A",level:3},{value:"3. \u7F16\u89E3\u7801\u5668\u8BE6\u89E3",id:"3-\u7F16\u89E3\u7801\u5668\u8BE6\u89E3",level:2},{value:"3.1 \u5185\u7F6E\u7F16\u89E3\u7801\u5668",id:"31-\u5185\u7F6E\u7F16\u89E3\u7801\u5668",level:3},{value:"4. \u5E38\u89C1\u9762\u8BD5\u95EE\u9898\u4E0E\u89E3\u7B54",id:"4-\u5E38\u89C1\u9762\u8BD5\u95EE\u9898\u4E0E\u89E3\u7B54",level:2},{value:"4.1 \u57FA\u7840\u6982\u5FF5\u95EE\u9898",id:"41-\u57FA\u7840\u6982\u5FF5\u95EE\u9898",level:3},{value:"4.2 \u5B9E\u9645\u5E94\u7528\u95EE\u9898",id:"42-\u5B9E\u9645\u5E94\u7528\u95EE\u9898",level:3}];function h(e){let n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"netty\u7F51\u7EDC\u7F16\u7A0B\u6846\u67B6\u8BE6\u89E3",children:"Netty\u7F51\u7EDC\u7F16\u7A0B\u6846\u67B6\u8BE6\u89E3"})}),"\n",(0,l.jsx)(n.p,{children:"Netty\u662F\u4E00\u4E2A\u9AD8\u6027\u80FD\u3001\u5F02\u6B65\u4E8B\u4EF6\u9A71\u52A8\u7684\u7F51\u7EDC\u5E94\u7528\u6846\u67B6\uFF0C\u7528\u4E8E\u5FEB\u901F\u5F00\u53D1\u53EF\u7EF4\u62A4\u7684\u9AD8\u6027\u80FD\u534F\u8BAE\u670D\u52A1\u5668\u548C\u5BA2\u6237\u7AEF\u3002\u5B83\u7B80\u5316\u4E86\u7F51\u7EDC\u7F16\u7A0B\u7684\u590D\u6742\u6027\uFF0C\u662F\u6784\u5EFA\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u91CD\u8981\u57FA\u7840\u8BBE\u65BD\u3002"}),"\n",(0,l.jsxs)(n.admonition,{title:"\u6838\u5FC3\u4EF7\u503C",type:"tip",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Netty = \u9AD8\u6027\u80FD\u7F51\u7EDC\u6846\u67B6 + \u5F02\u6B65\u4E8B\u4EF6\u9A71\u52A8 + \u4E30\u5BCC\u7684\u7F16\u89E3\u7801\u5668 + \u751F\u4EA7\u7EA7\u7279\u6027"})}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u{1F680} ",(0,l.jsx)(n.strong,{children:"\u9AD8\u6027\u80FD"}),"\uFF1A\u57FA\u4E8ENIO\u7684Reactor\u6A21\u5F0F\uFF0C\u652F\u6301\u767E\u4E07\u7EA7\u5E76\u53D1\u8FDE\u63A5"]}),"\n",(0,l.jsxs)(n.li,{children:["\u{1F3AF} ",(0,l.jsx)(n.strong,{children:"\u6613\u7528\u6027"}),"\uFF1A\u7B80\u5316\u7F51\u7EDC\u7F16\u7A0B\u590D\u6742\u6027\uFF0C\u63D0\u4F9B\u4E30\u5BCC\u7684\u5F00\u7BB1\u5373\u7528\u7EC4\u4EF6"]}),"\n",(0,l.jsxs)(n.li,{children:["\u{1F527} ",(0,l.jsx)(n.strong,{children:"\u53EF\u6269\u5C55"}),"\uFF1A\u7075\u6D3B\u7684Pipeline\u8BBE\u8BA1\uFF0C\u652F\u6301\u81EA\u5B9A\u4E49\u534F\u8BAE\u548C\u7F16\u89E3\u7801\u5668"]}),"\n",(0,l.jsxs)(n.li,{children:["\u{1F6E1}\uFE0F ",(0,l.jsx)(n.strong,{children:"\u751F\u4EA7\u7EA7"}),"\uFF1A\u5185\u5B58\u7BA1\u7406\u3001\u6D41\u91CF\u63A7\u5236\u3001\u5FC3\u8DF3\u68C0\u6D4B\u7B49\u4F01\u4E1A\u7EA7\u7279\u6027"]}),"\n",(0,l.jsxs)(n.li,{children:["\u{1F310} ",(0,l.jsx)(n.strong,{children:"\u5E7F\u6CDB\u5E94\u7528"}),"\uFF1ADubbo\u3001Spring Cloud Gateway\u3001Elasticsearch\u7B49\u77E5\u540D\u9879\u76EE\u7684\u7F51\u7EDC\u5C42\u57FA\u7840"]}),"\n"]})]}),"\n",(0,l.jsx)(n.h2,{id:"1-netty\u67B6\u6784\u8BBE\u8BA1",children:"1. Netty\u67B6\u6784\u8BBE\u8BA1"}),"\n",(0,l.jsx)(n.h3,{id:"11-\u6838\u5FC3\u7EC4\u4EF6\u67B6\u6784",children:"1.1 \u6838\u5FC3\u7EC4\u4EF6\u67B6\u6784"}),"\n",(0,l.jsx)(n.mermaid,{value:"graph TB\n    A[Netty\u67B6\u6784] --\x3e B[Bootstrap\u542F\u52A8\u5668]\n    A --\x3e C[EventLoopGroup\u4E8B\u4EF6\u5FAA\u73AF\u7EC4]\n    A --\x3e D[Channel\u901A\u9053]\n    A --\x3e E[ChannelPipeline\u5904\u7406\u94FE]\n    A --\x3e F[ChannelHandler\u5904\u7406\u5668]\n    A --\x3e G[ByteBuf\u7F13\u51B2\u533A]\n    \n    B --\x3e B1[ServerBootstrap]\n    B --\x3e B2[Bootstrap]\n    \n    C --\x3e C1[BossGroup]\n    C --\x3e C2[WorkerGroup]\n    \n    D --\x3e D1[NioServerSocketChannel]\n    D --\x3e D2[NioSocketChannel]\n    \n    E --\x3e E1[Inbound\u5904\u7406\u94FE]\n    E --\x3e E2[Outbound\u5904\u7406\u94FE]\n    \n    F --\x3e F1[ChannelInboundHandler]\n    F --\x3e F2[ChannelOutboundHandler]\n    \n    G --\x3e G1[\u5806\u5185\u5B58]\n    G --\x3e G2[\u76F4\u63A5\u5185\u5B58]\n    G --\x3e G3[\u5185\u5B58\u6C60]"}),"\n",(0,l.jsx)(n.h3,{id:"12-reactor\u7EBF\u7A0B\u6A21\u578B",children:"1.2 Reactor\u7EBF\u7A0B\u6A21\u578B"}),"\n",(0,l.jsxs)(s.A,{children:[(0,l.jsxs)(a.A,{value:"reactor-model",label:"Reactor\u6A21\u578B",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Netty\u7EBF\u7A0B\u6A21\u578B\u6F14\u8FDB"})}),(0,l.jsx)(n.mermaid,{value:'graph TB\n    subgraph "\u5355Reactor\u5355\u7EBF\u7A0B"\n        A1[Reactor] --\x3e A2[Acceptor]\n        A1 --\x3e A3[Handler1]\n        A1 --\x3e A4[Handler2]\n    end\n    \n    subgraph "\u5355Reactor\u591A\u7EBF\u7A0B"\n        B1[Reactor] --\x3e B2[Acceptor]\n        B1 --\x3e B3[Handler Pool]\n        B3 --\x3e B4[Handler1]\n        B3 --\x3e B5[Handler2]\n        B3 --\x3e B6[HandlerN]\n    end\n    \n    subgraph "\u4E3B\u4ECEReactor\u591A\u7EBF\u7A0B"\n        C1[MainReactor] --\x3e C2[Acceptor]\n        C1 --\x3e C3[SubReactor1]\n        C1 --\x3e C4[SubReactor2]\n        C3 --\x3e C5[Handler1]\n        C3 --\x3e C6[Handler2]\n        C4 --\x3e C7[Handler3]\n        C4 --\x3e C8[Handler4]\n    end'}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Netty\u7EBF\u7A0B\u6A21\u578B\u7279\u70B9"})}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"BossGroup"}),"\uFF1A\u5904\u7406\u5BA2\u6237\u7AEF\u8FDE\u63A5\u8BF7\u6C42"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"WorkerGroup"}),"\uFF1A\u5904\u7406IO\u8BFB\u5199\u64CD\u4F5C"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"EventLoop"}),"\uFF1A\u5355\u7EBF\u7A0B\u6267\u884C\u5668\uFF0C\u5904\u7406Channel\u7684\u6240\u6709IO\u4E8B\u4EF6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7EBF\u7A0B\u5B89\u5168"}),"\uFF1A\u540C\u4E00\u4E2AChannel\u7684\u6240\u6709\u64CD\u4F5C\u90FD\u5728\u540C\u4E00\u4E2AEventLoop\u4E2D\u6267\u884C"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"eventloop",label:"EventLoop\u8BE6\u89E3",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"EventLoop\u5DE5\u4F5C\u539F\u7406"})}),(0,l.jsx)(n.mermaid,{value:"graph LR\n    A[EventLoop] --\x3e B[\u4EFB\u52A1\u961F\u5217]\n    A --\x3e C[\u5B9A\u65F6\u4EFB\u52A1\u961F\u5217]\n    A --\x3e D[IO\u4E8B\u4EF6\u5904\u7406]\n    \n    B --\x3e B1[\u666E\u901A\u4EFB\u52A1]\n    B --\x3e B2[\u7CFB\u7EDF\u4EFB\u52A1]\n    \n    C --\x3e C1[\u5EF6\u65F6\u4EFB\u52A1]\n    C --\x3e C2[\u5468\u671F\u4EFB\u52A1]\n    \n    D --\x3e D1[Accept\u4E8B\u4EF6]\n    D --\x3e D2[Read\u4E8B\u4EF6]\n    D --\x3e D3[Write\u4E8B\u4EF6]"}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"EventLoop\u6838\u5FC3\u7279\u6027"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="EventLoop\u7279\u6027\u793A\u4F8B"',children:'// 1. \u7EBF\u7A0B\u5B89\u5168\uFF1A\u540C\u4E00\u4E2AChannel\u7684\u64CD\u4F5C\u90FD\u5728\u540C\u4E00\u4E2AEventLoop\u4E2D\nChannel channel = ...;\nEventLoop eventLoop = channel.eventLoop();\n\n// 2. \u4EFB\u52A1\u63D0\u4EA4\uFF1A\u53EF\u4EE5\u63D0\u4EA4\u4EFB\u52A1\u5230EventLoop\u6267\u884C\neventLoop.execute(() -> {\n    // \u5728EventLoop\u7EBF\u7A0B\u4E2D\u6267\u884C\n    System.out.println("Task executed in EventLoop");\n});\n\n// 3. \u5B9A\u65F6\u4EFB\u52A1\uFF1A\u652F\u6301\u5EF6\u65F6\u548C\u5468\u671F\u6027\u4EFB\u52A1\neventLoop.schedule(() -> {\n    System.out.println("Scheduled task");\n}, 5, TimeUnit.SECONDS);\n\n// 4. \u5224\u65AD\u662F\u5426\u5728EventLoop\u7EBF\u7A0B\u4E2D\nif (eventLoop.inEventLoop()) {\n    // \u76F4\u63A5\u6267\u884C\n    doSomething();\n} else {\n    // \u63D0\u4EA4\u5230EventLoop\u6267\u884C\n    eventLoop.execute(() -> doSomething());\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"thread-model-comparison",label:"\u7EBF\u7A0B\u6A21\u578B\u5BF9\u6BD4",children:[(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u6A21\u578B"}),(0,l.jsx)(n.th,{children:"\u4F18\u70B9"}),(0,l.jsx)(n.th,{children:"\u7F3A\u70B9"}),(0,l.jsx)(n.th,{children:"\u9002\u7528\u573A\u666F"}),(0,l.jsx)(n.th,{children:"Netty\u5B9E\u73B0"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5355Reactor\u5355\u7EBF\u7A0B"}),(0,l.jsx)(n.td,{children:"\u7B80\u5355\uFF0C\u65E0\u7EBF\u7A0B\u7ADE\u4E89"}),(0,l.jsx)(n.td,{children:"\u6027\u80FD\u6709\u9650\uFF0C\u5355\u70B9\u6545\u969C"}),(0,l.jsx)(n.td,{children:"\u8FDE\u63A5\u6570\u5C11\uFF0C\u5904\u7406\u7B80\u5355"}),(0,l.jsx)(n.td,{children:"EventLoopGroup(1)"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5355Reactor\u591A\u7EBF\u7A0B"}),(0,l.jsx)(n.td,{children:"\u5145\u5206\u5229\u7528\u591A\u6838CPU"}),(0,l.jsx)(n.td,{children:"Reactor\u6210\u4E3A\u74F6\u9888"}),(0,l.jsx)(n.td,{children:"\u4E2D\u7B49\u5E76\u53D1\uFF0CCPU\u5BC6\u96C6"}),(0,l.jsx)(n.td,{children:"EventLoopGroup(1) + \u4E1A\u52A1\u7EBF\u7A0B\u6C60"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u4E3B\u4ECEReactor\u591A\u7EBF\u7A0B"}),(0,l.jsx)(n.td,{children:"\u9AD8\u5E76\u53D1\uFF0C\u804C\u8D23\u5206\u79BB"}),(0,l.jsx)(n.td,{children:"\u5B9E\u73B0\u590D\u6742"}),(0,l.jsx)(n.td,{children:"\u9AD8\u5E76\u53D1\u573A\u666F"}),(0,l.jsx)(n.td,{children:"BossGroup + WorkerGroup"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u591AReactor\u591A\u7EBF\u7A0B"}),(0,l.jsx)(n.td,{children:"\u6700\u9AD8\u6027\u80FD"}),(0,l.jsx)(n.td,{children:"\u6700\u590D\u6742"}),(0,l.jsx)(n.td,{children:"\u8D85\u9AD8\u5E76\u53D1"}),(0,l.jsx)(n.td,{children:"\u591A\u4E2AEventLoopGroup"})]})]})]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Netty\u63A8\u8350\u914D\u7F6E"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u7EBF\u7A0B\u6A21\u578B\u6700\u4F73\u5B9E\u8DF5"',children:"// \u63A8\u8350\u914D\u7F6E\uFF1ACPU\u6838\u5FC3\u6570\u76841-2\u500D\nint bossThreads = 1; // \u901A\u5E381\u4E2A\u7EBF\u7A0B\u8DB3\u591F\u5904\u7406\u8FDE\u63A5\nint workerThreads = Runtime.getRuntime().availableProcessors() * 2;\n\nEventLoopGroup bossGroup = new NioEventLoopGroup(bossThreads);\nEventLoopGroup workerGroup = new NioEventLoopGroup(workerThreads);\n\n// \u4E1A\u52A1\u5904\u7406\u7EBF\u7A0B\u6C60\uFF08\u907F\u514D\u963B\u585EEventLoop\uFF09\nExecutorService businessExecutor = Executors.newFixedThreadPool(\n    Runtime.getRuntime().availableProcessors() * 4);\n"})})]})]}),"\n",(0,l.jsx)(n.h2,{id:"2-netty\u6838\u5FC3\u7EC4\u4EF6\u8BE6\u89E3",children:"2. Netty\u6838\u5FC3\u7EC4\u4EF6\u8BE6\u89E3"}),"\n",(0,l.jsx)(n.h3,{id:"21-bootstrap\u542F\u52A8\u5668",children:"2.1 Bootstrap\u542F\u52A8\u5668"}),"\n",(0,l.jsxs)(s.A,{children:[(0,l.jsx)(a.A,{value:"server-bootstrap",label:"\u670D\u52A1\u7AEF\u542F\u52A8",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="Netty\u670D\u52A1\u7AEF\u5B8C\u6574\u793A\u4F8B"',children:'import io.netty.bootstrap.ServerBootstrap;\nimport io.netty.channel.*;\nimport io.netty.channel.nio.NioEventLoopGroup;\nimport io.netty.channel.socket.SocketChannel;\nimport io.netty.channel.socket.nio.NioServerSocketChannel;\nimport io.netty.handler.codec.string.StringDecoder;\nimport io.netty.handler.codec.string.StringEncoder;\nimport io.netty.handler.codec.DelimiterBasedFrameDecoder;\nimport io.netty.handler.codec.Delimiters;\nimport io.netty.handler.logging.LogLevel;\nimport io.netty.handler.logging.LoggingHandler;\n\npublic class NettyServer {\n    private final int port;\n    \n    public NettyServer(int port) {\n        this.port = port;\n    }\n    \n    public void start() throws InterruptedException {\n        // \u521B\u5EFAEventLoopGroup\n        EventLoopGroup bossGroup = new NioEventLoopGroup(1);\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        \n        try {\n            ServerBootstrap bootstrap = new ServerBootstrap();\n            bootstrap.group(bossGroup, workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .option(ChannelOption.SO_BACKLOG, 1024)\n                    .option(ChannelOption.SO_REUSEADDR, true)\n                    .childOption(ChannelOption.SO_KEEPALIVE, true)\n                    .childOption(ChannelOption.TCP_NODELAY, true)\n                    .handler(new LoggingHandler(LogLevel.INFO))\n                    .childHandler(new ChannelInitializer<SocketChannel>() {\n                        @Override\n                        protected void initChannel(SocketChannel ch) {\n                            ChannelPipeline pipeline = ch.pipeline();\n                            \n                            // \u6DFB\u52A0\u7F16\u89E3\u7801\u5668\n                            pipeline.addLast(new DelimiterBasedFrameDecoder(\n                                8192, Delimiters.lineDelimiter()));\n                            pipeline.addLast(new StringDecoder());\n                            pipeline.addLast(new StringEncoder());\n                            \n                            // \u6DFB\u52A0\u4E1A\u52A1\u5904\u7406\u5668\n                            pipeline.addLast(new ServerHandler());\n                        }\n                    });\n            \n            // \u7ED1\u5B9A\u7AEF\u53E3\u5E76\u542F\u52A8\u670D\u52A1\u5668\n            ChannelFuture future = bootstrap.bind(port).sync();\n            System.out.println("Netty\u670D\u52A1\u5668\u542F\u52A8\u6210\u529F\uFF0C\u76D1\u542C\u7AEF\u53E3: " + port);\n            \n            // \u7B49\u5F85\u670D\u52A1\u5668\u5173\u95ED\n            future.channel().closeFuture().sync();\n            \n        } finally {\n            // \u4F18\u96C5\u5173\u95ED\n            bossGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n    \n    public static void main(String[] args) throws InterruptedException {\n        new NettyServer(8080).start();\n    }\n}\n\n/**\n * \u670D\u52A1\u7AEF\u4E1A\u52A1\u5904\u7406\u5668\n */\nclass ServerHandler extends ChannelInboundHandlerAdapter {\n    \n    @Override\n    public void channelActive(ChannelHandlerContext ctx) {\n        System.out.println("\u5BA2\u6237\u7AEF\u8FDE\u63A5: " + ctx.channel().remoteAddress());\n    }\n    \n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) {\n        String message = (String) msg;\n        System.out.println("\u6536\u5230\u6D88\u606F: " + message);\n        \n        // \u56DE\u663E\u6D88\u606F\n        ctx.writeAndFlush("Echo: " + message + "\\n");\n    }\n    \n    @Override\n    public void channelInactive(ChannelHandlerContext ctx) {\n        System.out.println("\u5BA2\u6237\u7AEF\u65AD\u5F00: " + ctx.channel().remoteAddress());\n    }\n    \n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {\n        System.err.println("\u5904\u7406\u5F02\u5E38: " + cause.getMessage());\n        ctx.close();\n    }\n}\n'})})}),(0,l.jsx)(a.A,{value:"client-bootstrap",label:"\u5BA2\u6237\u7AEF\u542F\u52A8",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="Netty\u5BA2\u6237\u7AEF\u5B8C\u6574\u793A\u4F8B"',children:'import io.netty.bootstrap.Bootstrap;\nimport io.netty.channel.*;\nimport io.netty.channel.nio.NioEventLoopGroup;\nimport io.netty.channel.socket.SocketChannel;\nimport io.netty.channel.socket.nio.NioSocketChannel;\nimport io.netty.handler.codec.string.StringDecoder;\nimport io.netty.handler.codec.string.StringEncoder;\nimport io.netty.handler.codec.DelimiterBasedFrameDecoder;\nimport io.netty.handler.codec.Delimiters;\n\nimport java.util.Scanner;\n\npublic class NettyClient {\n    private final String host;\n    private final int port;\n    \n    public NettyClient(String host, int port) {\n        this.host = host;\n        this.port = port;\n    }\n    \n    public void start() throws InterruptedException {\n        EventLoopGroup group = new NioEventLoopGroup();\n        \n        try {\n            Bootstrap bootstrap = new Bootstrap();\n            bootstrap.group(group)\n                    .channel(NioSocketChannel.class)\n                    .option(ChannelOption.SO_KEEPALIVE, true)\n                    .option(ChannelOption.TCP_NODELAY, true)\n                    .handler(new ChannelInitializer<SocketChannel>() {\n                        @Override\n                        protected void initChannel(SocketChannel ch) {\n                            ChannelPipeline pipeline = ch.pipeline();\n                            \n                            // \u6DFB\u52A0\u7F16\u89E3\u7801\u5668\n                            pipeline.addLast(new DelimiterBasedFrameDecoder(\n                                8192, Delimiters.lineDelimiter()));\n                            pipeline.addLast(new StringDecoder());\n                            pipeline.addLast(new StringEncoder());\n                            \n                            // \u6DFB\u52A0\u4E1A\u52A1\u5904\u7406\u5668\n                            pipeline.addLast(new ClientHandler());\n                        }\n                    });\n            \n            // \u8FDE\u63A5\u670D\u52A1\u5668\n            ChannelFuture future = bootstrap.connect(host, port).sync();\n            System.out.println("\u8FDE\u63A5\u670D\u52A1\u5668\u6210\u529F: " + host + ":" + port);\n            \n            Channel channel = future.channel();\n            \n            // \u7528\u6237\u8F93\u5165\u5904\u7406\n            Scanner scanner = new Scanner(System.in);\n            System.out.println("\u8F93\u5165\u6D88\u606F\uFF08\u8F93\u5165\'quit\'\u9000\u51FA\uFF09:");\n            \n            String input;\n            while ((input = scanner.nextLine()) != null) {\n                if ("quit".equalsIgnoreCase(input)) {\n                    break;\n                }\n                \n                channel.writeAndFlush(input + "\\n");\n            }\n            \n        } finally {\n            group.shutdownGracefully();\n        }\n    }\n    \n    public static void main(String[] args) throws InterruptedException {\n        new NettyClient("localhost", 8080).start();\n    }\n}\n\n/**\n * \u5BA2\u6237\u7AEF\u4E1A\u52A1\u5904\u7406\u5668\n */\nclass ClientHandler extends ChannelInboundHandlerAdapter {\n    \n    @Override\n    public void channelActive(ChannelHandlerContext ctx) {\n        System.out.println("\u8FDE\u63A5\u5EFA\u7ACB\u6210\u529F");\n    }\n    \n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) {\n        String response = (String) msg;\n        System.out.println("\u670D\u52A1\u5668\u54CD\u5E94: " + response);\n    }\n    \n    @Override\n    public void channelInactive(ChannelHandlerContext ctx) {\n        System.out.println("\u8FDE\u63A5\u65AD\u5F00");\n    }\n    \n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {\n        System.err.println("\u5BA2\u6237\u7AEF\u5F02\u5E38: " + cause.getMessage());\n        ctx.close();\n    }\n}\n'})})}),(0,l.jsxs)(a.A,{value:"bootstrap-options",label:"\u542F\u52A8\u53C2\u6570\u914D\u7F6E",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u91CD\u8981\u7684Channel\u9009\u9879"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="Channel\u9009\u9879\u8BE6\u89E3"',children:"// \u670D\u52A1\u7AEF\u9009\u9879\nServerBootstrap bootstrap = new ServerBootstrap();\nbootstrap\n    // TCP\u8FDE\u63A5\u961F\u5217\u5927\u5C0F\n    .option(ChannelOption.SO_BACKLOG, 1024)\n    \n    // \u5730\u5740\u91CD\u7528\n    .option(ChannelOption.SO_REUSEADDR, true)\n    \n    // \u63A5\u6536\u7F13\u51B2\u533A\u5927\u5C0F\n    .option(ChannelOption.SO_RCVBUF, 32 * 1024)\n    \n    // \u5B50Channel\u9009\u9879\n    .childOption(ChannelOption.SO_KEEPALIVE, true)    // \u4FDD\u6D3B\u673A\u5236\n    .childOption(ChannelOption.TCP_NODELAY, true)     // \u7981\u7528Nagle\u7B97\u6CD5\n    .childOption(ChannelOption.SO_SNDBUF, 32 * 1024) // \u53D1\u9001\u7F13\u51B2\u533A\n    .childOption(ChannelOption.SO_RCVBUF, 32 * 1024) // \u63A5\u6536\u7F13\u51B2\u533A\n    \n    // Netty\u7279\u6709\u9009\u9879\n    .childOption(ChannelOption.WRITE_BUFFER_WATER_MARK, \n        new WriteBufferWaterMark(8 * 1024, 32 * 1024)) // \u5199\u7F13\u51B2\u533A\u6C34\u4F4D\u7EBF\n    .childOption(ChannelOption.ALLOCATOR, PooledByteBufAllocator.DEFAULT); // \u5185\u5B58\u5206\u914D\u5668\n"})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5BA2\u6237\u7AEF\u9009\u9879"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5BA2\u6237\u7AEF\u9009\u9879\u914D\u7F6E"',children:"Bootstrap bootstrap = new Bootstrap();\nbootstrap\n    .option(ChannelOption.SO_KEEPALIVE, true)\n    .option(ChannelOption.TCP_NODELAY, true)\n    .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, 5000) // \u8FDE\u63A5\u8D85\u65F6\n    .option(ChannelOption.SO_TIMEOUT, 10000);           // \u8BFB\u53D6\u8D85\u65F6\n"})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u6027\u80FD\u8C03\u4F18\u53C2\u6570"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u6027\u80FD\u8C03\u4F18\u914D\u7F6E"',children:"// 1. \u5185\u5B58\u5206\u914D\u5668\n.option(ChannelOption.ALLOCATOR, PooledByteBufAllocator.DEFAULT)\n\n// 2. \u5199\u7F13\u51B2\u533A\u6C34\u4F4D\u7EBF\n.option(ChannelOption.WRITE_BUFFER_WATER_MARK, \n    new WriteBufferWaterMark(32 * 1024, 64 * 1024))\n\n// 3. \u63A5\u6536\u5B57\u8282\u7F13\u51B2\u533A\u5206\u914D\u5668\n.option(ChannelOption.RCVBUF_ALLOCATOR, \n    new AdaptiveRecvByteBufAllocator(64, 1024, 65536))\n\n// 4. \u6D88\u606F\u5927\u5C0F\u4F30\u7B97\u5668\n.option(ChannelOption.MESSAGE_SIZE_ESTIMATOR, \n    DefaultMessageSizeEstimator.DEFAULT)\n"})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"22-channelpipeline\u5904\u7406\u94FE",children:"2.2 ChannelPipeline\u5904\u7406\u94FE"}),"\n",(0,l.jsxs)(s.A,{children:[(0,l.jsxs)(a.A,{value:"pipeline-concept",label:"Pipeline\u6982\u5FF5",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Pipeline\u5904\u7406\u6D41\u7A0B"})}),(0,l.jsx)(n.mermaid,{value:'graph LR\n    A[\u5BA2\u6237\u7AEF\u6570\u636E] --\x3e B[Inbound Handler 1]\n    B --\x3e C[Inbound Handler 2]\n    C --\x3e D[Inbound Handler 3]\n    D --\x3e E[\u4E1A\u52A1\u5904\u7406]\n    \n    E --\x3e F[Outbound Handler 3]\n    F --\x3e G[Outbound Handler 2]\n    G --\x3e H[Outbound Handler 1]\n    H --\x3e I[\u7F51\u7EDC\u53D1\u9001]\n    \n    subgraph "\u5165\u7AD9\u5904\u7406\u94FE"\n        B\n        C\n        D\n    end\n    \n    subgraph "\u51FA\u7AD9\u5904\u7406\u94FE"\n        F\n        G\n        H\n    end'}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Pipeline\u6838\u5FC3\u7279\u6027"})}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u53CC\u5411\u94FE\u8868"}),"\uFF1AHandler\u6309\u987A\u5E8F\u7EC4\u7EC7\u6210\u53CC\u5411\u94FE\u8868"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5165\u7AD9\u5904\u7406"}),"\uFF1A\u6570\u636E\u4ECE\u7F51\u7EDC\u5230\u5E94\u7528\u7684\u5904\u7406\u94FE"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u51FA\u7AD9\u5904\u7406"}),"\uFF1A\u6570\u636E\u4ECE\u5E94\u7528\u5230\u7F51\u7EDC\u7684\u5904\u7406\u94FE"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u52A8\u6001\u4FEE\u6539"}),"\uFF1A\u8FD0\u884C\u65F6\u53EF\u4EE5\u52A8\u6001\u6DFB\u52A0\u3001\u5220\u9664Handler"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"handler-types",label:"Handler\u7C7B\u578B",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Handler\u5206\u7C7B"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u4E0D\u540C\u7C7B\u578B\u7684Handler"',children:'// 1. \u5165\u7AD9\u5904\u7406\u5668\npublic class MyInboundHandler extends ChannelInboundHandlerAdapter {\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) {\n        // \u5904\u7406\u5165\u7AD9\u6570\u636E\n        System.out.println("Inbound: " + msg);\n        \n        // \u4F20\u9012\u7ED9\u4E0B\u4E00\u4E2AHandler\n        ctx.fireChannelRead(msg);\n    }\n}\n\n// 2. \u51FA\u7AD9\u5904\u7406\u5668\npublic class MyOutboundHandler extends ChannelOutboundHandlerAdapter {\n    @Override\n    public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) {\n        // \u5904\u7406\u51FA\u7AD9\u6570\u636E\n        System.out.println("Outbound: " + msg);\n        \n        // \u4F20\u9012\u7ED9\u4E0B\u4E00\u4E2AHandler\n        ctx.write(msg, promise);\n    }\n}\n\n// 3. \u53CC\u5411\u5904\u7406\u5668\npublic class MyDuplexHandler extends ChannelDuplexHandler {\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) {\n        // \u5165\u7AD9\u5904\u7406\n        ctx.fireChannelRead(msg);\n    }\n    \n    @Override\n    public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) {\n        // \u51FA\u7AD9\u5904\u7406\n        ctx.write(msg, promise);\n    }\n}\n\n// 4. \u7B80\u5316\u7684\u5165\u7AD9\u5904\u7406\u5668\npublic class MySimpleHandler extends SimpleChannelInboundHandler<String> {\n    @Override\n    protected void channelRead0(ChannelHandlerContext ctx, String msg) {\n        // \u81EA\u52A8\u7C7B\u578B\u8F6C\u6362\u548C\u8D44\u6E90\u91CA\u653E\n        System.out.println("Message: " + msg);\n    }\n}\n'})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Handler\u751F\u547D\u5468\u671F"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="Handler\u751F\u547D\u5468\u671F\u65B9\u6CD5"',children:'public class LifecycleHandler extends ChannelInboundHandlerAdapter {\n    \n    @Override\n    public void handlerAdded(ChannelHandlerContext ctx) {\n        System.out.println("Handler\u6DFB\u52A0\u5230Pipeline");\n    }\n    \n    @Override\n    public void channelRegistered(ChannelHandlerContext ctx) {\n        System.out.println("Channel\u6CE8\u518C\u5230EventLoop");\n    }\n    \n    @Override\n    public void channelActive(ChannelHandlerContext ctx) {\n        System.out.println("Channel\u6FC0\u6D3B");\n    }\n    \n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) {\n        System.out.println("\u8BFB\u53D6\u6570\u636E: " + msg);\n        ctx.fireChannelRead(msg);\n    }\n    \n    @Override\n    public void channelReadComplete(ChannelHandlerContext ctx) {\n        System.out.println("\u8BFB\u53D6\u5B8C\u6210");\n        ctx.fireChannelReadComplete();\n    }\n    \n    @Override\n    public void channelInactive(ChannelHandlerContext ctx) {\n        System.out.println("Channel\u975E\u6FC0\u6D3B");\n    }\n    \n    @Override\n    public void channelUnregistered(ChannelHandlerContext ctx) {\n        System.out.println("Channel\u4ECEEventLoop\u6CE8\u9500");\n    }\n    \n    @Override\n    public void handlerRemoved(ChannelHandlerContext ctx) {\n        System.out.println("Handler\u4ECEPipeline\u79FB\u9664");\n    }\n    \n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {\n        System.err.println("\u5F02\u5E38\u5904\u7406: " + cause.getMessage());\n        ctx.close();\n    }\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"pipeline-operations",label:"Pipeline\u64CD\u4F5C",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u52A8\u6001\u4FEE\u6539Pipeline"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="Pipeline\u52A8\u6001\u64CD\u4F5C"',children:'public class DynamicPipelineHandler extends ChannelInboundHandlerAdapter {\n    \n    @Override\n    public void channelActive(ChannelHandlerContext ctx) {\n        ChannelPipeline pipeline = ctx.pipeline();\n        \n        // 1. \u6DFB\u52A0Handler\n        pipeline.addFirst("first", new FirstHandler());\n        pipeline.addLast("last", new LastHandler());\n        pipeline.addBefore("existing", "new", new NewHandler());\n        pipeline.addAfter("existing", "another", new AnotherHandler());\n        \n        // 2. \u66FF\u6362Handler\n        pipeline.replace("old", "new", new NewHandler());\n        \n        // 3. \u79FB\u9664Handler\n        pipeline.remove("unwanted");\n        pipeline.remove(UnwantedHandler.class);\n        \n        // 4. \u83B7\u53D6Handler\n        ChannelHandler handler = pipeline.get("handlerName");\n        FirstHandler first = pipeline.get(FirstHandler.class);\n        \n        // 5. \u68C0\u67E5Handler\u662F\u5426\u5B58\u5728\n        if (pipeline.names().contains("handlerName")) {\n            // Handler\u5B58\u5728\n        }\n        \n        ctx.fireChannelActive();\n    }\n}\n'})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u6761\u4EF6\u5316Pipeline\u914D\u7F6E"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u6761\u4EF6\u5316\u914D\u7F6E\u793A\u4F8B"',children:'public class ConditionalPipelineInitializer extends ChannelInitializer<SocketChannel> {\n    \n    private final boolean enableSsl;\n    private final boolean enableCompression;\n    \n    public ConditionalPipelineInitializer(boolean enableSsl, boolean enableCompression) {\n        this.enableSsl = enableSsl;\n        this.enableCompression = enableCompression;\n    }\n    \n    @Override\n    protected void initChannel(SocketChannel ch) {\n        ChannelPipeline pipeline = ch.pipeline();\n        \n        // SSL\u652F\u6301\n        if (enableSsl) {\n            SslContext sslContext = createSslContext();\n            pipeline.addLast("ssl", sslContext.newHandler(ch.alloc()));\n        }\n        \n        // \u538B\u7F29\u652F\u6301\n        if (enableCompression) {\n            pipeline.addLast("deflater", ZlibCodecFactory.newZlibEncoder(ZlibWrapper.GZIP));\n            pipeline.addLast("inflater", ZlibCodecFactory.newZlibDecoder(ZlibWrapper.GZIP));\n        }\n        \n        // \u57FA\u7840\u7F16\u89E3\u7801\u5668\n        pipeline.addLast("frameDecoder", new LengthFieldBasedFrameDecoder(1024, 0, 4, 0, 4));\n        pipeline.addLast("frameEncoder", new LengthFieldPrepender(4));\n        pipeline.addLast("stringDecoder", new StringDecoder());\n        pipeline.addLast("stringEncoder", new StringEncoder());\n        \n        // \u4E1A\u52A1\u5904\u7406\u5668\n        pipeline.addLast("businessHandler", new BusinessHandler());\n    }\n    \n    private SslContext createSslContext() {\n        // SSL\u4E0A\u4E0B\u6587\u521B\u5EFA\u903B\u8F91\n        return null;\n    }\n}\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"23-bytebuf\u7F13\u51B2\u533A",children:"2.3 ByteBuf\u7F13\u51B2\u533A"}),"\n",(0,l.jsxs)(s.A,{children:[(0,l.jsxs)(a.A,{value:"bytebuf-concept",label:"ByteBuf\u6982\u5FF5",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"ByteBuf vs ByteBuffer"})}),(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u7279\u6027"}),(0,l.jsx)(n.th,{children:"ByteBuf"}),(0,l.jsx)(n.th,{children:"ByteBuffer"}),(0,l.jsx)(n.th,{children:"\u4F18\u52BF"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u8BFB\u5199\u6307\u9488"}),(0,l.jsx)(n.td,{children:"\u72EC\u7ACB\u7684\u8BFB\u5199\u6307\u9488"}),(0,l.jsx)(n.td,{children:"\u5355\u4E00position\u6307\u9488"}),(0,l.jsx)(n.td,{children:"ByteBuf\u66F4\u7075\u6D3B\uFF0C\u65E0\u9700flip\u64CD\u4F5C"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5BB9\u91CF\u6269\u5C55"}),(0,l.jsx)(n.td,{children:"\u652F\u6301\u52A8\u6001\u6269\u5BB9"}),(0,l.jsx)(n.td,{children:"\u56FA\u5B9A\u5BB9\u91CF"}),(0,l.jsx)(n.td,{children:"ByteBuf\u53EF\u4EE5\u6839\u636E\u9700\u8981\u81EA\u52A8\u6269\u5BB9"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5185\u5B58\u7BA1\u7406"}),(0,l.jsx)(n.td,{children:"\u5F15\u7528\u8BA1\u6570"}),(0,l.jsx)(n.td,{children:"\u4F9D\u8D56GC"}),(0,l.jsx)(n.td,{children:"ByteBuf\u53EF\u4EE5\u7CBE\u786E\u63A7\u5236\u5185\u5B58\u91CA\u653E"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5185\u5B58\u7C7B\u578B"}),(0,l.jsx)(n.td,{children:"\u5806\u5185\u5B58/\u76F4\u63A5\u5185\u5B58"}),(0,l.jsx)(n.td,{children:"\u5806\u5185\u5B58/\u76F4\u63A5\u5185\u5B58"}),(0,l.jsx)(n.td,{children:"\u4E24\u8005\u90FD\u652F\u6301\u591A\u79CD\u5185\u5B58\u7C7B\u578B"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5185\u5B58\u6C60"}),(0,l.jsx)(n.td,{children:"\u652F\u6301\u5185\u5B58\u6C60"}),(0,l.jsx)(n.td,{children:"\u4E0D\u652F\u6301"}),(0,l.jsx)(n.td,{children:"ByteBuf\u53EF\u4EE5\u590D\u7528\u5185\u5B58\uFF0C\u51CF\u5C11GC\u538B\u529B"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u96F6\u62F7\u8D1D"}),(0,l.jsx)(n.td,{children:"\u652F\u6301"}),(0,l.jsx)(n.td,{children:"\u6709\u9650\u652F\u6301"}),(0,l.jsx)(n.td,{children:"ByteBuf\u63D0\u4F9B\u66F4\u597D\u7684\u96F6\u62F7\u8D1D\u652F\u6301"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"API\u8BBE\u8BA1"}),(0,l.jsx)(n.td,{children:"\u94FE\u5F0F\u8C03\u7528"}),(0,l.jsx)(n.td,{children:"\u4F20\u7EDFAPI"}),(0,l.jsx)(n.td,{children:"ByteBuf API\u66F4\u52A0\u53CB\u597D"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u6027\u80FD"}),(0,l.jsx)(n.td,{children:"\u66F4\u9AD8"}),(0,l.jsx)(n.td,{children:"\u8F83\u4F4E"}),(0,l.jsx)(n.td,{children:"ByteBuf\u5728\u5404\u65B9\u9762\u6027\u80FD\u90FD\u66F4\u4F18"})]})]})]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"ByteBuf\u7ED3\u6784"})}),(0,l.jsx)(n.mermaid,{value:"graph LR\n    A[0] --\x3e B[readerIndex]\n    B --\x3e C[writerIndex]\n    C --\x3e D[capacity]\n    D --\x3e E[maxCapacity]\n    \n    F[\u53EF\u4E22\u5F03\u5B57\u8282] --\x3e B\n    G[\u53EF\u8BFB\u5B57\u8282] --\x3e C\n    H[\u53EF\u5199\u5B57\u8282] --\x3e D\n    I[\u53EF\u6269\u5C55\u5B57\u8282] --\x3e E"})]}),(0,l.jsxs)(a.A,{value:"bytebuf-usage",label:"ByteBuf\u4F7F\u7528",children:[(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="ByteBuf\u57FA\u672C\u64CD\u4F5C"',children:'import io.netty.buffer.*;\n\npublic class ByteBufExample {\n    \n    public static void main(String[] args) {\n        // 1. \u521B\u5EFAByteBuf\n        ByteBuf buffer = Unpooled.buffer(10); // \u521D\u59CB\u5BB9\u91CF10\n        ByteBuf directBuffer = Unpooled.directBuffer(10); // \u76F4\u63A5\u5185\u5B58\n        ByteBuf pooledBuffer = PooledByteBufAllocator.DEFAULT.buffer(10); // \u6C60\u5316\n        \n        // 2. \u5199\u5165\u6570\u636E\n        buffer.writeInt(100);\n        buffer.writeBytes("Hello".getBytes());\n        buffer.writeBoolean(true);\n        \n        System.out.println("\u5199\u5165\u540E - \u53EF\u8BFB\u5B57\u8282\u6570: " + buffer.readableBytes());\n        System.out.println("\u5199\u5165\u540E - \u53EF\u5199\u5B57\u8282\u6570: " + buffer.writableBytes());\n        \n        // 3. \u8BFB\u53D6\u6570\u636E\n        int intValue = buffer.readInt();\n        byte[] bytes = new byte[5];\n        buffer.readBytes(bytes);\n        boolean boolValue = buffer.readBoolean();\n        \n        System.out.println("\u8BFB\u53D6\u7684int: " + intValue);\n        System.out.println("\u8BFB\u53D6\u7684\u5B57\u7B26\u4E32: " + new String(bytes));\n        System.out.println("\u8BFB\u53D6\u7684boolean: " + boolValue);\n        \n        // 4. \u6807\u8BB0\u548C\u91CD\u7F6E\n        buffer.markReaderIndex();\n        buffer.readInt(); // \u8BFB\u53D6\u4E00\u4E9B\u6570\u636E\n        buffer.resetReaderIndex(); // \u91CD\u7F6E\u5230\u6807\u8BB0\u4F4D\u7F6E\n        \n        // 5. \u5207\u7247\u64CD\u4F5C\uFF08\u96F6\u62F7\u8D1D\uFF09\n        ByteBuf slice = buffer.slice(0, 5); // \u521B\u5EFA\u5207\u7247\n        ByteBuf duplicate = buffer.duplicate(); // \u521B\u5EFA\u526F\u672C\n        \n        // 6. \u5F15\u7528\u8BA1\u6570\n        System.out.println("\u5F15\u7528\u8BA1\u6570: " + buffer.refCnt());\n        buffer.retain(); // \u589E\u52A0\u5F15\u7528\u8BA1\u6570\n        System.out.println("\u589E\u52A0\u540E\u5F15\u7528\u8BA1\u6570: " + buffer.refCnt());\n        \n        // 7. \u91CA\u653E\u5185\u5B58\n        buffer.release(); // \u51CF\u5C11\u5F15\u7528\u8BA1\u6570\n        buffer.release(); // \u5F53\u5F15\u7528\u8BA1\u6570\u4E3A0\u65F6\uFF0C\u91CA\u653E\u5185\u5B58\n    }\n}\n'})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"ByteBuf\u9AD8\u7EA7\u64CD\u4F5C"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="ByteBuf\u9AD8\u7EA7\u7279\u6027"',children:'public class AdvancedByteBufExample {\n    \n    public static void compositeByteBuf() {\n        // \u7EC4\u5408ByteBuf - \u96F6\u62F7\u8D1D\u5408\u5E76\u591A\u4E2AByteBuf\n        CompositeByteBuf composite = Unpooled.compositeBuffer();\n        \n        ByteBuf header = Unpooled.copiedBuffer("Header", CharsetUtil.UTF_8);\n        ByteBuf body = Unpooled.copiedBuffer("Body Content", CharsetUtil.UTF_8);\n        \n        composite.addComponents(true, header, body);\n        \n        // \u53EF\u4EE5\u50CF\u5355\u4E2AByteBuf\u4E00\u6837\u4F7F\u7528\n        System.out.println("\u7EC4\u5408\u540E\u5185\u5BB9: " + composite.toString(CharsetUtil.UTF_8));\n        \n        composite.release();\n    }\n    \n    public static void derivedByteBuf() {\n        ByteBuf original = Unpooled.copiedBuffer("Hello World", CharsetUtil.UTF_8);\n        \n        // \u5207\u7247 - \u5171\u4EAB\u5185\u5BB9\uFF0C\u72EC\u7ACB\u7D22\u5F15\n        ByteBuf slice = original.slice(0, 5);\n        System.out.println("\u5207\u7247\u5185\u5BB9: " + slice.toString(CharsetUtil.UTF_8));\n        \n        // \u526F\u672C - \u5171\u4EAB\u5185\u5BB9\uFF0C\u5171\u4EAB\u7D22\u5F15\n        ByteBuf duplicate = original.duplicate();\n        \n        // \u62F7\u8D1D - \u72EC\u7ACB\u5185\u5BB9\u548C\u7D22\u5F15\n        ByteBuf copy = original.copy();\n        \n        original.release();\n    }\n    \n    public static void byteBufAllocator() {\n        // \u4E0D\u540C\u7684\u5206\u914D\u5668\n        ByteBufAllocator allocator = PooledByteBufAllocator.DEFAULT;\n        \n        // \u5806\u5185\u5B58\n        ByteBuf heapBuffer = allocator.heapBuffer(1024);\n        \n        // \u76F4\u63A5\u5185\u5B58\n        ByteBuf directBuffer = allocator.directBuffer(1024);\n        \n        // \u7EC4\u5408\u7F13\u51B2\u533A\n        CompositeByteBuf composite = allocator.compositeBuffer();\n        \n        // \u6839\u636E\u5E73\u53F0\u9009\u62E9\u6700\u4F18\u7C7B\u578B\n        ByteBuf buffer = allocator.buffer(1024);\n        \n        // \u91CA\u653E\u8D44\u6E90\n        heapBuffer.release();\n        directBuffer.release();\n        composite.release();\n        buffer.release();\n    }\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"memory-management",label:"\u5185\u5B58\u7BA1\u7406",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5F15\u7528\u8BA1\u6570\u673A\u5236"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5F15\u7528\u8BA1\u6570\u6700\u4F73\u5B9E\u8DF5"',children:"public class ReferenceCountingExample {\n    \n    public void correctUsage(ChannelHandlerContext ctx, ByteBuf msg) {\n        try {\n            // \u5904\u7406\u6D88\u606F\n            processMessage(msg);\n            \n            // \u4F20\u9012\u7ED9\u4E0B\u4E00\u4E2AHandler\n            ctx.fireChannelRead(msg.retain()); // \u589E\u52A0\u5F15\u7528\u8BA1\u6570\n            \n        } finally {\n            // \u786E\u4FDD\u91CA\u653E\n            msg.release();\n        }\n    }\n    \n    public void simpleHandlerUsage() {\n        // \u4F7F\u7528SimpleChannelInboundHandler\u81EA\u52A8\u7BA1\u7406\u5F15\u7528\u8BA1\u6570\n        class AutoReleaseHandler extends SimpleChannelInboundHandler<ByteBuf> {\n            @Override\n            protected void channelRead0(ChannelHandlerContext ctx, ByteBuf msg) {\n                // \u65B9\u6CD5\u7ED3\u675F\u540E\u81EA\u52A8\u8C03\u7528msg.release()\n                processMessage(msg);\n            }\n        }\n    }\n    \n    public void manualManagement() {\n        ByteBuf buffer = Unpooled.buffer(1024);\n        \n        try {\n            // \u4F7F\u7528buffer\n            buffer.writeInt(42);\n            \n            // \u5982\u679C\u9700\u8981\u4F20\u9012\u7ED9\u5176\u4ED6\u5730\u65B9\u4F7F\u7528\n            ByteBuf retained = buffer.retain();\n            someAsyncMethod(retained); // \u5F02\u6B65\u65B9\u6CD5\u8D1F\u8D23\u91CA\u653E\n            \n        } finally {\n            // \u91CA\u653E\u5F53\u524D\u5F15\u7528\n            buffer.release();\n        }\n    }\n    \n    private void processMessage(ByteBuf msg) {\n        // \u5904\u7406\u6D88\u606F\u903B\u8F91\n    }\n    \n    private void someAsyncMethod(ByteBuf buffer) {\n        // \u5F02\u6B65\u5904\u7406\uFF0C\u5B8C\u6210\u540E\u9700\u8981\u8C03\u7528buffer.release()\n    }\n}\n"})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5185\u5B58\u6CC4\u6F0F\u68C0\u6D4B"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5185\u5B58\u6CC4\u6F0F\u68C0\u6D4B\u914D\u7F6E"',children:"// JVM\u542F\u52A8\u53C2\u6570\n// -Dio.netty.leakDetection.level=ADVANCED\n// -Dio.netty.leakDetectionTargetRecords=10\n\npublic class LeakDetectionExample {\n    \n    static {\n        // \u4EE3\u7801\u4E2D\u8BBE\u7F6E\u68C0\u6D4B\u7EA7\u522B\n        ResourceLeakDetector.setLevel(ResourceLeakDetector.Level.PARANOID);\n    }\n    \n    public void detectLeak() {\n        ByteBuf buffer = Unpooled.buffer(1024);\n        \n        // \u6A21\u62DF\u5185\u5B58\u6CC4\u6F0F - \u5FD8\u8BB0\u8C03\u7528release()\n        buffer.writeInt(42);\n        \n        // \u6B63\u786E\u505A\u6CD5\uFF1A\n        // buffer.release();\n    }\n}\n"})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5185\u5B58\u6C60\u914D\u7F6E"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5185\u5B58\u6C60\u4F18\u5316\u914D\u7F6E"',children:'// \u7CFB\u7EDF\u5C5E\u6027\u914D\u7F6E\nSystem.setProperty("io.netty.allocator.type", "pooled"); // \u4F7F\u7528\u6C60\u5316\u5206\u914D\u5668\nSystem.setProperty("io.netty.allocator.directMemoryCacheAlignment", "64"); // \u76F4\u63A5\u5185\u5B58\u5BF9\u9F50\nSystem.setProperty("io.netty.allocator.pageSize", "8192"); // \u9875\u5927\u5C0F\nSystem.setProperty("io.netty.allocator.maxOrder", "11"); // \u6700\u5927\u5757\u5927\u5C0F\n\n// \u4EE3\u7801\u914D\u7F6E\nPooledByteBufAllocator allocator = new PooledByteBufAllocator(\n    true,  // preferDirect - \u4F18\u5148\u4F7F\u7528\u76F4\u63A5\u5185\u5B58\n    2,     // nHeapArena - \u5806\u5185\u5B58\u533A\u57DF\u6570\u91CF\n    2,     // nDirectArena - \u76F4\u63A5\u5185\u5B58\u533A\u57DF\u6570\u91CF\n    8192,  // pageSize - \u9875\u5927\u5C0F\n    11     // maxOrder - \u6700\u5927\u5757\u5927\u5C0F\n);\n'})})]})]}),"\n",(0,l.jsx)(n.h2,{id:"3-\u7F16\u89E3\u7801\u5668\u8BE6\u89E3",children:"3. \u7F16\u89E3\u7801\u5668\u8BE6\u89E3"}),"\n",(0,l.jsx)(n.h3,{id:"31-\u5185\u7F6E\u7F16\u89E3\u7801\u5668",children:"3.1 \u5185\u7F6E\u7F16\u89E3\u7801\u5668"}),"\n",(0,l.jsxs)(s.A,{children:[(0,l.jsxs)(a.A,{value:"frame-decoders",label:"\u5E27\u89E3\u7801\u5668",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u89E3\u51B3\u7C98\u5305\u62C6\u5305\u95EE\u9898\u7684\u89E3\u7801\u5668"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5E38\u7528\u5E27\u89E3\u7801\u5668"',children:"// 1. \u56FA\u5B9A\u957F\u5EA6\u5E27\u89E3\u7801\u5668\nFixedLengthFrameDecoder fixedDecoder = new FixedLengthFrameDecoder(10);\n\n// 2. \u5206\u9694\u7B26\u5E27\u89E3\u7801\u5668\nDelimiterBasedFrameDecoder delimiterDecoder = new DelimiterBasedFrameDecoder(\n    1024, // \u6700\u5927\u5E27\u957F\u5EA6\n    Delimiters.lineDelimiter() // \u4F7F\u7528\u6362\u884C\u7B26\u4F5C\u4E3A\u5206\u9694\u7B26\n);\n\n// 3. \u957F\u5EA6\u5B57\u6BB5\u5E27\u89E3\u7801\u5668\nLengthFieldBasedFrameDecoder lengthDecoder = new LengthFieldBasedFrameDecoder(\n    1024,  // \u6700\u5927\u5E27\u957F\u5EA6\n    0,     // \u957F\u5EA6\u5B57\u6BB5\u504F\u79FB\u91CF\n    4,     // \u957F\u5EA6\u5B57\u6BB5\u957F\u5EA6\n    0,     // \u957F\u5EA6\u8C03\u6574\u503C\n    4      // \u8DF3\u8FC7\u7684\u5B57\u8282\u6570\n);\n\n// 4. \u884C\u89E3\u7801\u5668\nLineBasedFrameDecoder lineDecoder = new LineBasedFrameDecoder(1024);\n"})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u81EA\u5B9A\u4E49\u534F\u8BAE\u89E3\u7801\u5668"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u81EA\u5B9A\u4E49\u534F\u8BAE\u89E3\u7801\u5668"',children:"public class CustomProtocolDecoder extends ByteToMessageDecoder {\n    \n    private static final int HEADER_LENGTH = 8;\n    private static final int MAGIC_NUMBER = 0xCAFEBABE;\n    \n    @Override\n    protected void decode(ChannelHandlerContext ctx, ByteBuf in, List<Object> out) {\n        // \u68C0\u67E5\u662F\u5426\u6709\u8DB3\u591F\u7684\u5B57\u8282\u8BFB\u53D6\u5934\u90E8\n        if (in.readableBytes() < HEADER_LENGTH) {\n            return;\n        }\n        \n        // \u6807\u8BB0\u8BFB\u53D6\u4F4D\u7F6E\n        in.markReaderIndex();\n        \n        // \u8BFB\u53D6\u9B54\u6570\n        int magic = in.readInt();\n        if (magic != MAGIC_NUMBER) {\n            // \u9B54\u6570\u4E0D\u5339\u914D\uFF0C\u5173\u95ED\u8FDE\u63A5\n            ctx.close();\n            return;\n        }\n        \n        // \u8BFB\u53D6\u6D88\u606F\u957F\u5EA6\n        int length = in.readInt();\n        \n        // \u68C0\u67E5\u662F\u5426\u6709\u8DB3\u591F\u7684\u5B57\u8282\u8BFB\u53D6\u5B8C\u6574\u6D88\u606F\n        if (in.readableBytes() < length) {\n            // \u91CD\u7F6E\u8BFB\u53D6\u4F4D\u7F6E\uFF0C\u7B49\u5F85\u66F4\u591A\u6570\u636E\n            in.resetReaderIndex();\n            return;\n        }\n        \n        // \u8BFB\u53D6\u6D88\u606F\u4F53\n        ByteBuf messageBody = in.readBytes(length);\n        \n        // \u521B\u5EFA\u81EA\u5B9A\u4E49\u6D88\u606F\u5BF9\u8C61\n        CustomMessage message = new CustomMessage(magic, length, messageBody);\n        out.add(message);\n    }\n}\n\n// \u81EA\u5B9A\u4E49\u6D88\u606F\u7C7B\nclass CustomMessage {\n    private final int magic;\n    private final int length;\n    private final ByteBuf body;\n    \n    public CustomMessage(int magic, int length, ByteBuf body) {\n        this.magic = magic;\n        this.length = length;\n        this.body = body;\n    }\n    \n    // getter\u65B9\u6CD5...\n}\n"})})]}),(0,l.jsxs)(a.A,{value:"codec-examples",label:"\u7F16\u89E3\u7801\u5668\u793A\u4F8B",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5B57\u7B26\u4E32\u7F16\u89E3\u7801\u5668"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5B57\u7B26\u4E32\u7F16\u89E3\u7801\u5668\u4F7F\u7528"',children:'public class StringCodecExample {\n    \n    public void setupPipeline(ChannelPipeline pipeline) {\n        // \u5B57\u7B26\u4E32\u7F16\u89E3\u7801\u5668\n        pipeline.addLast("stringDecoder", new StringDecoder(CharsetUtil.UTF_8));\n        pipeline.addLast("stringEncoder", new StringEncoder(CharsetUtil.UTF_8));\n        \n        // \u4E1A\u52A1\u5904\u7406\u5668\n        pipeline.addLast("stringHandler", new SimpleChannelInboundHandler<String>() {\n            @Override\n            protected void channelRead0(ChannelHandlerContext ctx, String msg) {\n                System.out.println("\u6536\u5230\u5B57\u7B26\u4E32: " + msg);\n                ctx.writeAndFlush("Echo: " + msg);\n            }\n        });\n    }\n}\n'})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"JSON\u7F16\u89E3\u7801\u5668"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="JSON\u7F16\u89E3\u7801\u5668\u5B9E\u73B0"',children:"public class JsonEncoder extends MessageToByteEncoder<Object> {\n    \n    private final ObjectMapper objectMapper = new ObjectMapper();\n    \n    @Override\n    protected void encode(ChannelHandlerContext ctx, Object msg, ByteBuf out) throws Exception {\n        byte[] jsonBytes = objectMapper.writeValueAsBytes(msg);\n        out.writeInt(jsonBytes.length); // \u5199\u5165\u957F\u5EA6\n        out.writeBytes(jsonBytes);      // \u5199\u5165JSON\u6570\u636E\n    }\n}\n\npublic class JsonDecoder extends LengthFieldBasedFrameDecoder {\n    \n    private final ObjectMapper objectMapper = new ObjectMapper();\n    private final Class<?> targetClass;\n    \n    public JsonDecoder(Class<?> targetClass) {\n        super(1024, 0, 4, 0, 4); // \u957F\u5EA6\u5B57\u6BB5\u89E3\u7801\n        this.targetClass = targetClass;\n    }\n    \n    @Override\n    protected Object decode(ChannelHandlerContext ctx, ByteBuf in) throws Exception {\n        ByteBuf frame = (ByteBuf) super.decode(ctx, in);\n        if (frame == null) {\n            return null;\n        }\n        \n        try {\n            byte[] jsonBytes = new byte[frame.readableBytes()];\n            frame.readBytes(jsonBytes);\n            return objectMapper.readValue(jsonBytes, targetClass);\n        } finally {\n            frame.release();\n        }\n    }\n}\n"})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Protobuf\u7F16\u89E3\u7801\u5668"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="Protobuf\u7F16\u89E3\u7801\u5668\u4F7F\u7528"',children:'public class ProtobufCodecExample {\n    \n    public void setupPipeline(ChannelPipeline pipeline) {\n        // Protobuf\u7F16\u89E3\u7801\u5668\n        pipeline.addLast("frameDecoder", new ProtobufVarint32FrameDecoder());\n        pipeline.addLast("protobufDecoder", new ProtobufDecoder(MessageProto.Message.getDefaultInstance()));\n        \n        pipeline.addLast("frameEncoder", new ProtobufVarint32LengthFieldPrepender());\n        pipeline.addLast("protobufEncoder", new ProtobufEncoder());\n        \n        // \u4E1A\u52A1\u5904\u7406\u5668\n        pipeline.addLast("protobufHandler", new SimpleChannelInboundHandler<MessageProto.Message>() {\n            @Override\n            protected void channelRead0(ChannelHandlerContext ctx, MessageProto.Message msg) {\n                System.out.println("\u6536\u5230Protobuf\u6D88\u606F: " + msg.getContent());\n                \n                MessageProto.Message response = MessageProto.Message.newBuilder()\n                    .setContent("Echo: " + msg.getContent())\n                    .build();\n                \n                ctx.writeAndFlush(response);\n            }\n        });\n    }\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"custom-codec",label:"\u81EA\u5B9A\u4E49\u7F16\u89E3\u7801\u5668",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5B8C\u6574\u7684\u81EA\u5B9A\u4E49\u534F\u8BAE\u5B9E\u73B0"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u81EA\u5B9A\u4E49\u534F\u8BAE\u5B8C\u6574\u5B9E\u73B0"',children:'// \u534F\u8BAE\u683C\u5F0F\uFF1A\u9B54\u6570(4) + \u7248\u672C(1) + \u7C7B\u578B(1) + \u957F\u5EA6(4) + \u6570\u636E(N)\npublic class CustomProtocol {\n    public static final int MAGIC_NUMBER = 0xABCDEF00;\n    public static final byte VERSION = 1;\n    \n    public static class Message {\n        private byte version;\n        private byte type;\n        private byte[] data;\n        \n        // \u6784\u9020\u51FD\u6570\u548Cgetter/setter...\n    }\n}\n\n// \u7F16\u7801\u5668\npublic class CustomProtocolEncoder extends MessageToByteEncoder<CustomProtocol.Message> {\n    \n    @Override\n    protected void encode(ChannelHandlerContext ctx, CustomProtocol.Message msg, ByteBuf out) {\n        out.writeInt(CustomProtocol.MAGIC_NUMBER);  // \u9B54\u6570\n        out.writeByte(msg.getVersion());            // \u7248\u672C\n        out.writeByte(msg.getType());               // \u7C7B\u578B\n        out.writeInt(msg.getData().length);         // \u6570\u636E\u957F\u5EA6\n        out.writeBytes(msg.getData());              // \u6570\u636E\n    }\n}\n\n// \u89E3\u7801\u5668\npublic class CustomProtocolDecoder extends ByteToMessageDecoder {\n    \n    private static final int HEADER_LENGTH = 10; // 4 + 1 + 1 + 4\n    \n    @Override\n    protected void decode(ChannelHandlerContext ctx, ByteBuf in, List<Object> out) {\n        if (in.readableBytes() < HEADER_LENGTH) {\n            return;\n        }\n        \n        in.markReaderIndex();\n        \n        // \u9A8C\u8BC1\u9B54\u6570\n        int magic = in.readInt();\n        if (magic != CustomProtocol.MAGIC_NUMBER) {\n            in.resetReaderIndex();\n            ctx.close();\n            return;\n        }\n        \n        byte version = in.readByte();\n        byte type = in.readByte();\n        int dataLength = in.readInt();\n        \n        // \u68C0\u67E5\u6570\u636E\u662F\u5426\u5B8C\u6574\n        if (in.readableBytes() < dataLength) {\n            in.resetReaderIndex();\n            return;\n        }\n        \n        // \u8BFB\u53D6\u6570\u636E\n        byte[] data = new byte[dataLength];\n        in.readBytes(data);\n        \n        // \u521B\u5EFA\u6D88\u606F\u5BF9\u8C61\n        CustomProtocol.Message message = new CustomProtocol.Message();\n        message.setVersion(version);\n        message.setType(type);\n        message.setData(data);\n        \n        out.add(message);\n    }\n}\n\n// \u4F7F\u7528\u793A\u4F8B\npublic class CustomProtocolServer {\n    \n    public void start() throws InterruptedException {\n        EventLoopGroup bossGroup = new NioEventLoopGroup(1);\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        \n        try {\n            ServerBootstrap bootstrap = new ServerBootstrap();\n            bootstrap.group(bossGroup, workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .childHandler(new ChannelInitializer<SocketChannel>() {\n                        @Override\n                        protected void initChannel(SocketChannel ch) {\n                            ChannelPipeline pipeline = ch.pipeline();\n                            \n                            // \u6DFB\u52A0\u81EA\u5B9A\u4E49\u7F16\u89E3\u7801\u5668\n                            pipeline.addLast("decoder", new CustomProtocolDecoder());\n                            pipeline.addLast("encoder", new CustomProtocolEncoder());\n                            \n                            // \u6DFB\u52A0\u4E1A\u52A1\u5904\u7406\u5668\n                            pipeline.addLast("handler", new CustomProtocolHandler());\n                        }\n                    });\n            \n            ChannelFuture future = bootstrap.bind(8080).sync();\n            future.channel().closeFuture().sync();\n            \n        } finally {\n            bossGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n}\n'})})]})]}),"\n",(0,l.jsx)(n.h2,{id:"4-\u5E38\u89C1\u9762\u8BD5\u95EE\u9898\u4E0E\u89E3\u7B54",children:"4. \u5E38\u89C1\u9762\u8BD5\u95EE\u9898\u4E0E\u89E3\u7B54"}),"\n",(0,l.jsx)(n.h3,{id:"41-\u57FA\u7840\u6982\u5FF5\u95EE\u9898",children:"4.1 \u57FA\u7840\u6982\u5FF5\u95EE\u9898"}),"\n",(0,l.jsxs)(s.A,{children:[(0,l.jsxs)(a.A,{value:"basic-qa",label:"\u57FA\u7840\u95EE\u7B54",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q1: Netty\u7684\u6838\u5FC3\u7EC4\u4EF6\u6709\u54EA\u4E9B\uFF1F\u5B83\u4EEC\u7684\u4F5C\u7528\u662F\u4EC0\u4E48\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: Netty\u7684\u6838\u5FC3\u7EC4\u4EF6\u5305\u62EC\uFF1A"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Bootstrap/ServerBootstrap"}),"\uFF1A\u542F\u52A8\u5668\uFF0C\u7528\u4E8E\u914D\u7F6E\u548C\u542F\u52A8\u5BA2\u6237\u7AEF/\u670D\u52A1\u7AEF"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"EventLoopGroup"}),"\uFF1A\u4E8B\u4EF6\u5FAA\u73AF\u7EC4\uFF0C\u7BA1\u7406EventLoop\u7684\u751F\u547D\u5468\u671F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"EventLoop"}),"\uFF1A\u4E8B\u4EF6\u5FAA\u73AF\uFF0C\u5904\u7406IO\u4E8B\u4EF6\u548C\u4EFB\u52A1"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Channel"}),"\uFF1A\u7F51\u7EDC\u901A\u9053\uFF0C\u4EE3\u8868\u4E00\u4E2A\u7F51\u7EDC\u8FDE\u63A5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ChannelPipeline"}),"\uFF1A\u5904\u7406\u94FE\uFF0C\u7BA1\u7406ChannelHandler\u7684\u6267\u884C\u987A\u5E8F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ChannelHandler"}),"\uFF1A\u5904\u7406\u5668\uFF0C\u5904\u7406IO\u4E8B\u4EF6\u548C\u4E1A\u52A1\u903B\u8F91"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ByteBuf"}),"\uFF1A\u7F13\u51B2\u533A\uFF0CNetty\u7684\u6570\u636E\u5BB9\u5668"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q2: Netty\u7684\u7EBF\u7A0B\u6A21\u578B\u662F\u600E\u6837\u7684\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: Netty\u91C7\u7528Reactor\u7EBF\u7A0B\u6A21\u578B\uFF1A"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"BossGroup"}),"\uFF1A\u8D1F\u8D23\u63A5\u53D7\u5BA2\u6237\u7AEF\u8FDE\u63A5\uFF0C\u901A\u5E38\u53EA\u9700\u89811\u4E2A\u7EBF\u7A0B"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"WorkerGroup"}),"\uFF1A\u8D1F\u8D23\u5904\u7406IO\u8BFB\u5199\uFF0C\u7EBF\u7A0B\u6570\u901A\u5E38\u4E3ACPU\u6838\u5FC3\u6570\u76841-2\u500D"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"EventLoop"}),"\uFF1A\u5355\u7EBF\u7A0B\u6267\u884C\u5668\uFF0C\u4E00\u4E2AEventLoop\u53EF\u4EE5\u5904\u7406\u591A\u4E2AChannel"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7EBF\u7A0B\u5B89\u5168"}),"\uFF1A\u540C\u4E00\u4E2AChannel\u7684\u6240\u6709\u64CD\u4F5C\u90FD\u5728\u540C\u4E00\u4E2AEventLoop\u4E2D\u6267\u884C"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q3: ByteBuf\u76F8\u6BD4ByteBuffer\u6709\u4EC0\u4E48\u4F18\u52BF\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: ByteBuf\u7684\u4E3B\u8981\u4F18\u52BF\uFF1A"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u72EC\u7ACB\u7684\u8BFB\u5199\u6307\u9488"}),"\uFF1A\u65E0\u9700flip\u64CD\u4F5C\uFF0C\u4F7F\u7528\u66F4\u7B80\u5355"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u52A8\u6001\u6269\u5BB9"}),"\uFF1A\u53EF\u4EE5\u6839\u636E\u9700\u8981\u81EA\u52A8\u6269\u5C55\u5BB9\u91CF"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5F15\u7528\u8BA1\u6570"}),"\uFF1A\u7CBE\u786E\u63A7\u5236\u5185\u5B58\u91CA\u653E\uFF0C\u907F\u514D\u5185\u5B58\u6CC4\u6F0F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5185\u5B58\u6C60"}),"\uFF1A\u652F\u6301\u5185\u5B58\u6C60\u5316\uFF0C\u51CF\u5C11GC\u538B\u529B"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u96F6\u62F7\u8D1D"}),"\uFF1A\u63D0\u4F9B\u66F4\u597D\u7684\u96F6\u62F7\u8D1D\u652F\u6301"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u94FE\u5F0FAPI"}),"\uFF1A\u66F4\u53CB\u597D\u7684API\u8BBE\u8BA1"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"advanced-qa",label:"\u6DF1\u5165\u95EE\u7B54",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q4: Netty\u662F\u5982\u4F55\u89E3\u51B3\u7C98\u5305\u62C6\u5305\u95EE\u9898\u7684\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: Netty\u63D0\u4F9B\u4E86\u591A\u79CD\u89E3\u51B3\u65B9\u6848\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u56FA\u5B9A\u957F\u5EA6"}),"\uFF1AFixedLengthFrameDecoder"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5206\u9694\u7B26"}),"\uFF1ADelimiterBasedFrameDecoder"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u957F\u5EA6\u5B57\u6BB5"}),"\uFF1ALengthFieldBasedFrameDecoder"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u81EA\u5B9A\u4E49\u534F\u8BAE"}),"\uFF1A\u7EE7\u627FByteToMessageDecoder\u5B9E\u73B0"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q5: Netty\u7684\u96F6\u62F7\u8D1D\u662F\u5982\u4F55\u5B9E\u73B0\u7684\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: Netty\u7684\u96F6\u62F7\u8D1D\u5B9E\u73B0\uFF1A"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"DirectByteBuffer"}),"\uFF1A\u4F7F\u7528\u76F4\u63A5\u5185\u5B58\uFF0C\u907F\u514D\u7528\u6237\u6001\u548C\u5185\u6838\u6001\u7684\u6570\u636E\u62F7\u8D1D"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"CompositeByteBuf"}),"\uFF1A\u7EC4\u5408\u591A\u4E2AByteBuf\uFF0C\u907F\u514D\u5185\u5B58\u62F7\u8D1D"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"slice()\u548Cduplicate()"}),"\uFF1A\u521B\u5EFA\u89C6\u56FE\uFF0C\u5171\u4EAB\u5E95\u5C42\u6570\u636E"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"FileRegion"}),"\uFF1A\u6587\u4EF6\u4F20\u8F93\u65F6\u4F7F\u7528sendfile\u7CFB\u7EDF\u8C03\u7528"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q6: \u5982\u4F55\u5904\u7406Netty\u4E2D\u7684\u5185\u5B58\u6CC4\u6F0F\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: \u5185\u5B58\u6CC4\u6F0F\u5904\u7406\u7B56\u7565\uFF1A"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5F15\u7528\u8BA1\u6570"}),"\uFF1A\u6B63\u786E\u4F7F\u7528retain()\u548Crelease()"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"SimpleChannelInboundHandler"}),"\uFF1A\u81EA\u52A8\u7BA1\u7406\u5F15\u7528\u8BA1\u6570"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5185\u5B58\u6CC4\u6F0F\u68C0\u6D4B"}),"\uFF1A\u542F\u7528ResourceLeakDetector"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6700\u4F73\u5B9E\u8DF5"}),"\uFF1A\u5728finally\u5757\u4E2D\u91CA\u653E\u8D44\u6E90"]}),"\n"]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"42-\u5B9E\u9645\u5E94\u7528\u95EE\u9898",children:"4.2 \u5B9E\u9645\u5E94\u7528\u95EE\u9898"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Netty\u751F\u4EA7\u73AF\u5883\u6700\u4F73\u5B9E\u8DF5"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u7EBF\u7A0B\u914D\u7F6E"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"BossGroup\u7EBF\u7A0B\u6570\uFF1A1\u4E2A\u5373\u53EF"}),"\n",(0,l.jsx)(n.li,{children:"WorkerGroup\u7EBF\u7A0B\u6570\uFF1ACPU\u6838\u5FC3\u6570\u76841-2\u500D"}),"\n",(0,l.jsx)(n.li,{children:"\u4E1A\u52A1\u5904\u7406\u4F7F\u7528\u72EC\u7ACB\u7EBF\u7A0B\u6C60"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5185\u5B58\u7BA1\u7406"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u542F\u7528\u5185\u5B58\u6C60\uFF1APooledByteBufAllocator"}),"\n",(0,l.jsx)(n.li,{children:"\u8BBE\u7F6E\u5408\u7406\u7684\u6C34\u4F4D\u7EBF"}),"\n",(0,l.jsx)(n.li,{children:"\u76D1\u63A7\u5185\u5B58\u4F7F\u7528\u60C5\u51B5"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u6027\u80FD\u4F18\u5316"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u76F4\u63A5\u5185\u5B58"}),"\n",(0,l.jsx)(n.li,{children:"\u5408\u7406\u8BBE\u7F6EChannel\u9009\u9879"}),"\n",(0,l.jsx)(n.li,{children:"\u542F\u7528TCP_NODELAY"}),"\n",(0,l.jsx)(n.li,{children:"\u8BBE\u7F6E\u5408\u9002\u7684\u7F13\u51B2\u533A\u5927\u5C0F"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u76D1\u63A7\u548C\u8C03\u8BD5"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u542F\u7528\u5185\u5B58\u6CC4\u6F0F\u68C0\u6D4B"}),"\n",(0,l.jsx)(n.li,{children:"\u76D1\u63A7\u8FDE\u63A5\u6570\u548C\u541E\u5410\u91CF"}),"\n",(0,l.jsx)(n.li,{children:"\u8BB0\u5F55\u5173\u952E\u4E8B\u4EF6\u65E5\u5FD7"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u901A\u8FC7\u6DF1\u5165\u7406\u89E3Netty\u6846\u67B6\uFF0C\u4F60\u5C06\u80FD\u591F\uFF1A"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6784\u5EFA\u9AD8\u6027\u80FD\u7684\u7F51\u7EDC\u5E94\u7528"}),"\n",(0,l.jsx)(n.li,{children:"\u89E3\u51B3\u590D\u6742\u7684\u7F51\u7EDC\u7F16\u7A0B\u95EE\u9898"}),"\n",(0,l.jsx)(n.li,{children:"\u4F18\u5316\u7F51\u7EDC\u5E94\u7528\u7684\u6027\u80FD\u548C\u7A33\u5B9A\u6027"}),"\n",(0,l.jsx)(n.li,{children:"\u8BBE\u8BA1\u53EF\u6269\u5C55\u7684\u5206\u5E03\u5F0F\u7CFB\u7EDF\u67B6\u6784"}),"\n"]})]})}function u(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},57250:function(e,n,t){t.d(n,{A:()=>i});var r=t(74848);t(96540);var l=t(34164);function i({children:e,hidden:n,className:t}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,l.A)("tabItem_Ymn6",t),hidden:n,children:e})}},78010:function(e,n,t){t.d(n,{A:()=>f});var r=t(74848),l=t(96540),i=t(34164),s=t(88287),a=t(28584),o=t(56347),d=t(99989),c=t(96629),p=t(80618),h=t(41367);function u(e){return l.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,l.isValidElement)(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function x({value:e,tabValues:n}){return n.some(n=>n.value===e)}var j=t(19863);function g({className:e,block:n,selectedValue:t,selectValue:l,tabValues:s}){let o=[],{blockElementScrollPositionUntilNextRender:d}=(0,a.a_)(),c=e=>{let n=e.currentTarget,r=s[o.indexOf(n)].value;r!==t&&(d(n),l(r))},p=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{let t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{let t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1]}}n?.focus()};return(0,r.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:s.map(({value:e,label:n,attributes:l})=>(0,r.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{o.push(e)},onKeyDown:p,onClick:c,...l,className:(0,i.A)("tabs__item","tabItem_LNqP",l?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function m({lazy:e,children:n,selectedValue:t}){let s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){let e=s.find(e=>e.props.value===t);return e?(0,l.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,r.jsx)("div",{className:"margin-top--md",children:s.map((e,n)=>(0,l.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function b(e){let n=function(e){let n,{defaultValue:t,queryString:r=!1,groupId:i}=e,s=function(e){let{values:n,children:t}=e;return(0,l.useMemo)(()=>{let e=n??u(t).map(({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r})),r=(0,p.XI)(e,(e,n)=>e.value===n.value);if(r.length>0)throw Error(`Docusaurus error: Duplicate values "${r.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`);return e},[n,t])}(e),[a,j]=(0,l.useState)(()=>(function({defaultValue:e,tabValues:n}){if(0===n.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!x({value:e,tabValues:n}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}let t=n.find(e=>e.default)??n[0];if(!t)throw Error("Unexpected error: 0 tabValues");return t.value})({defaultValue:t,tabValues:s})),[g,m]=function({queryString:e=!1,groupId:n}){let t=(0,o.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(r),(0,l.useCallback)(e=>{if(!r)return;let n=new URLSearchParams(t.location.search);n.set(r,e),t.replace({...t.location,search:n.toString()})},[r,t])]}({queryString:r,groupId:i}),[b,f]=function({groupId:e}){let n=e?`docusaurus.tab.${e}`:null,[t,r]=(0,h.Dv)(n);return[t,(0,l.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:i}),y=x({value:n=g??b,tabValues:s})?n:null;return(0,d.A)(()=>{y&&j(y)},[y]),{selectedValue:a,selectValue:(0,l.useCallback)(e=>{if(!x({value:e,tabValues:s}))throw Error(`Can't select invalid tab value=${e}`);j(e),m(e),f(e)},[m,f,s]),tabValues:s}}(e);return(0,r.jsxs)("div",{className:(0,i.A)(s.G.tabs.container,"tabs-container","tabList__CuJ"),children:[(0,r.jsx)(g,{...n,...e}),(0,r.jsx)(m,{...n,...e})]})}function f(e){let n=(0,j.A)();return(0,r.jsx)(b,{...e,children:u(e.children)},String(n))}},28453:function(e,n,t){t.d(n,{R:()=>s,x:()=>a});var r=t(96540);let l={},i=r.createContext(l);function s(e){let n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);