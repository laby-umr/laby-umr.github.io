"use strict";(self.webpackChunkfullstack_dev_blog=self.webpackChunkfullstack_dev_blog||[]).push([["71705"],{39703:function(n,e,t){t.r(e),t.d(e,{metadata:()=>r,default:()=>h,frontMatter:()=>s,contentTitle:()=>d,toc:()=>u,assets:()=>m});var r=JSON.parse('{"id":"backend/concurrency/atomic-classes","title":"Java\u539F\u5B50\u7C7B\u8BE6\u89E3","description":"\u5168\u9762\u4ECB\u7ECDJava\u539F\u5B50\u7C7B\u3001CAS\u673A\u5236\u3001\u539F\u5B50\u64CD\u4F5C\u4E0E\u6700\u4F73\u5B9E\u8DF5","source":"@site/docs/backend/concurrency/atomic-classes.mdx","sourceDirName":"backend/concurrency","slug":"/backend/concurrency/atomic-classes","permalink":"/docs/backend/concurrency/atomic-classes","draft":false,"unlisted":false,"editUrl":"https://github.com/MasterLiu93/blog-web/tree/main/docs/backend/concurrency/atomic-classes.mdx","tags":[],"version":"current","lastUpdatedBy":"Laby","lastUpdatedAt":1736208000000,"sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"Java\u539F\u5B50\u7C7B\u8BE6\u89E3","description":"\u5168\u9762\u4ECB\u7ECDJava\u539F\u5B50\u7C7B\u3001CAS\u673A\u5236\u3001\u539F\u5B50\u64CD\u4F5C\u4E0E\u6700\u4F73\u5B9E\u8DF5","authors":["Laby"],"last_update":{"date":"2025-01-07T00:00:00.000Z","author":"Laby"}},"sidebar":"tutorialSidebar","previous":{"title":"Java\u5E76\u53D1\u5DE5\u5177\u7C7B\u8BE6\u89E3","permalink":"/docs/backend/concurrency/concurrent-utils"},"next":{"title":"Java\u7EBF\u7A0B\u6C60\u8BE6\u89E3","permalink":"/docs/backend/concurrency/thread-pool"}}'),i=t(74848),a=t(28453),c=t(78010),l=t(57250),o=t(19007);let s={sidebar_position:8,title:"Java\u539F\u5B50\u7C7B\u8BE6\u89E3",description:"\u5168\u9762\u4ECB\u7ECDJava\u539F\u5B50\u7C7B\u3001CAS\u673A\u5236\u3001\u539F\u5B50\u64CD\u4F5C\u4E0E\u6700\u4F73\u5B9E\u8DF5",authors:["Laby"],last_update:{date:new Date("2025-01-07T00:00:00.000Z"),author:"Laby"}},d="Java \u539F\u5B50\u7C7B\u8BE6\u89E3",m={},u=[{value:"1. \u539F\u5B50\u7C7B\u6982\u8FF0",id:"1-\u539F\u5B50\u7C7B\u6982\u8FF0",level:2},{value:"1.1 \u4EC0\u4E48\u662F\u539F\u5B50\u7C7B\uFF1F",id:"11-\u4EC0\u4E48\u662F\u539F\u5B50\u7C7B",level:3},{value:"1.2 CAS\u673A\u5236\u539F\u7406",id:"12-cas\u673A\u5236\u539F\u7406",level:3},{value:"1.3 \u539F\u5B50\u7C7B\u5206\u7C7B",id:"13-\u539F\u5B50\u7C7B\u5206\u7C7B",level:3},{value:"2. \u57FA\u672C\u7C7B\u578B\u539F\u5B50\u7C7B",id:"2-\u57FA\u672C\u7C7B\u578B\u539F\u5B50\u7C7B",level:2},{value:"2.1 AtomicInteger",id:"21-atomicinteger",level:3},{value:"2.2 AtomicLong",id:"22-atomiclong",level:3},{value:"2.3 AtomicBoolean",id:"23-atomicboolean",level:3},{value:"3. \u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B",id:"3-\u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B",level:2},{value:"3.1 AtomicReference",id:"31-atomicreference",level:3},{value:"3.2 AtomicStampedReference",id:"32-atomicstampedreference",level:3},{value:"3.3 AtomicMarkableReference",id:"33-atomicmarkablereference",level:3},{value:"4. \u6570\u7EC4\u539F\u5B50\u7C7B",id:"4-\u6570\u7EC4\u539F\u5B50\u7C7B",level:2},{value:"4.1 AtomicIntegerArray",id:"41-atomicintegerarray",level:3},{value:"5. \u5B57\u6BB5\u66F4\u65B0\u5668",id:"5-\u5B57\u6BB5\u66F4\u65B0\u5668",level:2},{value:"5.1 \u5B57\u6BB5\u66F4\u65B0\u5668\u6982\u8FF0",id:"51-\u5B57\u6BB5\u66F4\u65B0\u5668\u6982\u8FF0",level:3},{value:"6. \u539F\u5B50\u7C7B\u6700\u4F73\u5B9E\u8DF5",id:"6-\u539F\u5B50\u7C7B\u6700\u4F73\u5B9E\u8DF5",level:2},{value:"6.1 \u4F7F\u7528\u5EFA\u8BAE",id:"61-\u4F7F\u7528\u5EFA\u8BAE",level:3},{value:"6.2 \u6027\u80FD\u4F18\u5316",id:"62-\u6027\u80FD\u4F18\u5316",level:3},{value:"7. \u603B\u7ED3",id:"7-\u603B\u7ED3",level:2},{value:"7.1 \u5173\u952E\u8981\u70B9",id:"71-\u5173\u952E\u8981\u70B9",level:3},{value:"7.2 \u9009\u62E9\u5EFA\u8BAE",id:"72-\u9009\u62E9\u5EFA\u8BAE",level:3},{value:"7.3 \u5B66\u4E60\u5EFA\u8BAE",id:"73-\u5B66\u4E60\u5EFA\u8BAE",level:3}];function p(n){let e={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"java-\u539F\u5B50\u7C7B\u8BE6\u89E3",children:"Java \u539F\u5B50\u7C7B\u8BE6\u89E3"})}),"\n",(0,i.jsx)(e.p,{children:"\u539F\u5B50\u7C7B\u662FJava\u5E76\u53D1\u5305\u4E2D\u63D0\u4F9B\u7684\u4E00\u7EC4\u7EBF\u7A0B\u5B89\u5168\u7684\u5DE5\u5177\u7C7B\uFF0C\u5B83\u4EEC\u57FA\u4E8ECAS\uFF08Compare-And-Swap\uFF09\u64CD\u4F5C\u5B9E\u73B0\uFF0C\u65E0\u9700\u4F7F\u7528synchronized\u5173\u952E\u5B57\u3002\u672C\u6587\u5C06\u8BE6\u7EC6\u4ECB\u7ECDJava\u539F\u5B50\u7C7B\u7684\u539F\u7406\u3001\u4F7F\u7528\u65B9\u6CD5\u548C\u6700\u4F73\u5B9E\u8DF5\u3002"}),"\n",(0,i.jsx)(e.admonition,{title:"\u672C\u6587\u5185\u5BB9\u6982\u89C8",type:"info",children:(0,i.jsx)(o.A,{toc:u})}),"\n",(0,i.jsxs)(e.admonition,{title:"\u6838\u5FC3\u4EF7\u503C",type:"tip",children:[(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u539F\u5B50\u7C7B = \u65E0\u9501\u5E76\u53D1 + \u9AD8\u6027\u80FD + \u7EBF\u7A0B\u5B89\u5168\u6027 + \u7B80\u6D01API + \u5185\u5B58\u53EF\u89C1\u6027"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u{1F504} ",(0,i.jsx)(e.strong,{children:"\u65E0\u9501\u64CD\u4F5C"}),"\uFF1A\u57FA\u4E8ECAS\u673A\u5236\uFF0C\u907F\u514D\u4F20\u7EDF\u9501\u5E26\u6765\u7684\u4E0A\u4E0B\u6587\u5207\u6362\u5F00\u9500"]}),"\n",(0,i.jsxs)(e.li,{children:["\u{1F680} ",(0,i.jsx)(e.strong,{children:"\u9AD8\u6027\u80FD"}),"\uFF1A\u5728\u4F4E\u7ADE\u4E89\u73AF\u5883\u4E0B\u6027\u80FD\u4F18\u4E8E\u4F20\u7EDF\u540C\u6B65\u65B9\u5F0F"]}),"\n",(0,i.jsxs)(e.li,{children:["\u{1F6E1}\uFE0F ",(0,i.jsx)(e.strong,{children:"\u7EBF\u7A0B\u5B89\u5168"}),"\uFF1A\u4FDD\u8BC1\u64CD\u4F5C\u7684\u539F\u5B50\u6027\uFF0C\u907F\u514D\u5E76\u53D1\u95EE\u9898"]}),"\n",(0,i.jsxs)(e.li,{children:["\u{1F4CA} ",(0,i.jsx)(e.strong,{children:"\u7CBE\u7EC6\u63A7\u5236"}),"\uFF1A\u652F\u6301\u590D\u6742\u7684\u539F\u5B50\u6027\u6761\u4EF6\u66F4\u65B0\u64CD\u4F5C"]}),"\n",(0,i.jsxs)(e.li,{children:["\u{1F50D} ",(0,i.jsx)(e.strong,{children:"\u5185\u5B58\u53EF\u89C1\u6027"}),"\uFF1A\u4FDD\u8BC1\u591A\u7EBF\u7A0B\u95F4\u7684\u6570\u636E\u4E00\u81F4\u6027"]}),"\n"]})]}),"\n",(0,i.jsx)(e.h2,{id:"1-\u539F\u5B50\u7C7B\u6982\u8FF0",children:"1. \u539F\u5B50\u7C7B\u6982\u8FF0"}),"\n",(0,i.jsx)(e.h3,{id:"11-\u4EC0\u4E48\u662F\u539F\u5B50\u7C7B",children:"1.1 \u4EC0\u4E48\u662F\u539F\u5B50\u7C7B\uFF1F"}),"\n",(0,i.jsx)(e.mermaid,{value:"graph TD\n    A[\u539F\u5B50\u7C7B] --\x3e B[\u57FA\u4E8ECAS\u64CD\u4F5C]\n    A --\x3e C[\u7EBF\u7A0B\u5B89\u5168]\n    A --\x3e D[\u65E0\u9501\u7B97\u6CD5]\n    B --\x3e E[\u6BD4\u8F83\u5E76\u4EA4\u6362]\n    B --\x3e F[\u65E0\u9700synchronized]\n    C --\x3e G[\u539F\u5B50\u6027\u4FDD\u8BC1]\n    C --\x3e H[\u5185\u5B58\u53EF\u89C1\u6027]\n    D --\x3e I[\u907F\u514D\u7EBF\u7A0B\u963B\u585E]\n    D --\x3e J[\u63D0\u9AD8\u5E76\u53D1\u6027\u80FD]"}),"\n",(0,i.jsx)(e.admonition,{title:"\u6838\u5FC3\u6982\u5FF5",type:"tip",children:(0,i.jsx)(e.p,{children:"\u539F\u5B50\u7C7B\u662F\u57FA\u4E8ECAS\uFF08Compare-And-Swap\uFF09\u64CD\u4F5C\u5B9E\u73B0\u7684\u7EBF\u7A0B\u5B89\u5168\u5DE5\u5177\u7C7B\uFF0C\u5B83\u4EEC\u63D0\u4F9B\u539F\u5B50\u6027\u7684\u8BFB\u5199\u64CD\u4F5C\uFF0C\u65E0\u9700\u4F7F\u7528\u4F20\u7EDF\u7684\u540C\u6B65\u673A\u5236\uFF0C\u5177\u6709\u9AD8\u6027\u80FD\u3001\u65E0\u963B\u585E\u7684\u7279\u70B9\u3002"})}),"\n",(0,i.jsx)(e.h3,{id:"12-cas\u673A\u5236\u539F\u7406",children:"1.2 CAS\u673A\u5236\u539F\u7406"}),"\n",(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h4",{children:"CAS (Compare-And-Swap) \u5DE5\u4F5C\u539F\u7406"})}),(0,i.jsxs)("div",{className:"card__body",children:[(0,i.jsx)(e.p,{children:"CAS\u662F\u4E00\u79CD\u65E0\u9501\u7B97\u6CD5\uFF0C\u5176\u6838\u5FC3\u662F\u4E00\u6761CPU\u539F\u5B50\u6307\u4EE4\uFF0C\u6267\u884C\u8FC7\u7A0B\u5982\u4E0B\uFF1A"}),(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6BD4\u8F83(Compare)"}),"\uFF1A\u8BFB\u53D6\u5185\u5B58\u4E2D\u5F53\u524D\u503C\u5E76\u4E0E\u671F\u671B\u503C\u6BD4\u8F83"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u4EA4\u6362(Swap)"}),"\uFF1A\u5982\u679C\u5F53\u524D\u503C\u7B49\u4E8E\u671F\u671B\u503C\uFF0C\u5219\u5C06\u503C\u66F4\u65B0\u4E3A\u65B0\u503C\uFF1B\u5426\u5219\u4E0D\u66F4\u65B0"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u8FD4\u56DE\u7ED3\u679C"}),"\uFF1A\u8FD4\u56DE\u6BD4\u8F83\u7ED3\u679C\uFF0C\u8868\u660E\u64CD\u4F5C\u662F\u5426\u6210\u529F"]}),"\n"]}),(0,i.jsx)(e.p,{children:"CAS\u64CD\u4F5C\u5305\u542B\u4E09\u4E2A\u53C2\u6570\uFF1A"}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5185\u5B58\u4F4D\u7F6EV (Variable)"}),"\uFF1A\u8981\u66F4\u65B0\u7684\u53D8\u91CF"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u671F\u671B\u503CA (Expected)"}),"\uFF1A\u9884\u671F\u5F53\u524D\u503C"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u65B0\u503CB (New)"}),"\uFF1A\u8981\u8BBE\u7F6E\u7684\u65B0\u503C"]}),"\n"]}),(0,i.jsx)(e.p,{children:"CAS\u64CD\u4F5C\u4FDD\u8BC1\u4E86\u539F\u5B50\u6027\uFF1A\u8981\u4E48\u5B8C\u5168\u6210\u529F\uFF0C\u8981\u4E48\u5B8C\u5168\u5931\u8D25\uFF0C\u4E0D\u4F1A\u51FA\u73B0\u4E2D\u95F4\u72B6\u6001\u3002"})]})]}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(l.A,{value:"cas_code",label:"CAS\u6A21\u62DF\u5B9E\u73B0",default:!0,children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public boolean compareAndSet(AtomicInteger value, int expect, int update) {\n    // \u8FD9\u4E2A\u65B9\u6CD5\u662F\u4E00\u4E2A\u6A21\u62DF\uFF0C\u5B9E\u9645\u4E0ACAS\u662F\u7531CPU\u539F\u5B50\u6307\u4EE4\u5B9E\u73B0\u7684\n    // 1. \u8BFB\u53D6\u5F53\u524D\u503C\n    int current = value.get();\n    \n    // 2. \u6BD4\u8F83\u5F53\u524D\u503C\u4E0E\u671F\u671B\u503C\n    if (current == expect) {\n        // 3. \u5982\u679C\u76F8\u7B49\uFF0C\u5219\u66F4\u65B0\u4E3A\u65B0\u503C\n        value.set(update);\n        return true;\n    } else {\n        // 4. \u5982\u679C\u4E0D\u76F8\u7B49\uFF0C\u5219\u66F4\u65B0\u5931\u8D25\n        return false;\n    }\n}\n\n// \u4F7F\u7528CAS\u5B9E\u73B0\u81EA\u65CB\u9501\npublic void incrementUsingCAS(AtomicInteger value) {\n    int oldValue;\n    do {\n        // \u8BFB\u53D6\u5F53\u524D\u503C\n        oldValue = value.get();\n        // \u5C1D\u8BD5CAS\u64CD\u4F5C\uFF0C\u76F4\u5230\u6210\u529F\n    } while (!value.compareAndSet(oldValue, oldValue + 1));\n}\n"})})}),(0,i.jsx)(l.A,{value:"cas_diagram",label:"CAS\u6267\u884C\u6D41\u7A0B",children:(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant \u7EBF\u7A0B\n    participant CPU\n    participant \u5185\u5B58\n    \n    \u7EBF\u7A0B->>\u5185\u5B58: 1. \u8BFB\u53D6\u5F53\u524D\u503C(V)\n    \u5185\u5B58--\x3e>\u7EBF\u7A0B: \u8FD4\u56DE\u5F53\u524D\u503C\n    \u7EBF\u7A0B->>\u7EBF\u7A0B: 2. \u8BA1\u7B97\u65B0\u503C\n    \u7EBF\u7A0B->>CPU: 3. \u53D1\u51FACAS\u6307\u4EE4(V, A, B)\n    \n    alt \u5F53\u524D\u503C\u7B49\u4E8E\u671F\u671B\u503C\n        CPU->>\u5185\u5B58: 4a. \u66F4\u65B0\u503C\u4E3A\u65B0\u503CB\n        \u5185\u5B58--\x3e>CPU: \u66F4\u65B0\u6210\u529F\n        CPU--\x3e>\u7EBF\u7A0B: \u8FD4\u56DE\u6210\u529F(true)\n    else \u5F53\u524D\u503C\u4E0D\u7B49\u4E8E\u671F\u671B\u503C\n        CPU->>\u5185\u5B58: 4b. \u4E0D\u66F4\u65B0\n        \u5185\u5B58--\x3e>CPU: \u4E0D\u53D8\n        CPU--\x3e>\u7EBF\u7A0B: \u8FD4\u56DE\u5931\u8D25(false)\n    end\n    \n    Note over \u7EBF\u7A0B: 5. \u6839\u636ECAS\u7ED3\u679C<br/>\u51B3\u5B9A\u540E\u7EED\u64CD\u4F5C"})}),(0,i.jsx)(l.A,{value:"cas_benefits",label:"CAS\u4F18\u52BF",children:(0,i.jsx)("div",{className:"card",children:(0,i.jsx)("div",{className:"card__body",children:(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"\u907F\u514D\u9501\u5F00\u9500"}),"\uFF1A\u4E0D\u9700\u8981\u83B7\u53D6\u548C\u91CA\u653E\u9501\uFF0C\u51CF\u5C11\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u5207\u6362"]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"\u9AD8\u6027\u80FD"}),"\uFF1A\u5728\u4F4E\u7ADE\u4E89\u73AF\u5883\u4E0B\uFF0C\u6027\u80FD\u663E\u8457\u4F18\u4E8E\u4F20\u7EDF\u9501\u673A\u5236"]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"\u65E0\u963B\u585E"}),"\uFF1A\u7EBF\u7A0B\u53EF\u4EE5\u7ACB\u5373\u77E5\u9053\u66F4\u65B0\u662F\u5426\u6210\u529F\uFF0C\u800C\u4E0D\u662F\u88AB\u963B\u585E\u7B49\u5F85"]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"\u907F\u514D\u6B7B\u9501"}),"\uFF1A\u4E0D\u4F7F\u7528\u9501\uFF0C\u56E0\u6B64\u4E0D\u4F1A\u51FA\u73B0\u6B7B\u9501\u95EE\u9898"]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"\u9002\u5408\u8BFB\u591A\u5199\u5C11"}),"\uFF1A\u5728\u8BFB\u64CD\u4F5C\u8FDC\u591A\u4E8E\u5199\u64CD\u4F5C\u7684\u573A\u666F\u4E0B\u7279\u522B\u9AD8\u6548"]})]})})})}),(0,i.jsx)(l.A,{value:"cas_limitations",label:"CAS\u5C40\u9650\u6027",children:(0,i.jsx)("div",{className:"card",children:(0,i.jsx)("div",{className:"card__body",children:(0,i.jsxs)("ol",{children:[(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"ABA\u95EE\u9898"}),"\uFF1A\u503C\u4ECEA\u53D8\u4E3AB\u53C8\u53D8\u56DEA\uFF0CCAS\u65E0\u6CD5\u68C0\u6D4B\u5230\u8FD9\u79CD\u53D8\u5316"]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"\u53EA\u80FD\u4FDD\u8BC1\u5355\u4E2A\u53D8\u91CF\u64CD\u4F5C\u7684\u539F\u5B50\u6027"}),"\uFF1A\u4E0D\u652F\u6301\u591A\u4E2A\u53D8\u91CF\u7684\u539F\u5B50\u6027\u66F4\u65B0"]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"\u81EA\u65CB\u6D88\u8017CPU"}),"\uFF1ACAS\u5931\u8D25\u65F6\u901A\u5E38\u4F1A\u81EA\u65CB\u91CD\u8BD5\uFF0C\u53EF\u80FD\u6D88\u8017\u8F83\u591ACPU\u8D44\u6E90"]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"\u9AD8\u7ADE\u4E89\u4E0B\u6027\u80FD\u4E0B\u964D"}),"\uFF1A\u5F53\u591A\u4E2A\u7EBF\u7A0B\u9891\u7E41\u4E89\u7528\u540C\u4E00\u53D8\u91CF\u65F6\uFF0CCAS\u5931\u8D25\u7387\u9AD8"]})]})})})})]}),"\n",(0,i.jsx)(e.h3,{id:"13-\u539F\u5B50\u7C7B\u5206\u7C7B",children:"1.3 \u539F\u5B50\u7C7B\u5206\u7C7B"}),"\n",(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h4",{children:"Java\u539F\u5B50\u7C7B\u5BB6\u65CF"})}),(0,i.jsx)("div",{className:"card__body",children:(0,i.jsx)(e.mermaid,{value:"classDiagram\n    class AtomicClasses {\n        <<interface>>\n    }\n    \n    class BasicType {\n        AtomicInteger\n        AtomicLong\n        AtomicBoolean\n    }\n    \n    class ReferenceType {\n        AtomicReference~V~\n        AtomicStampedReference~V~\n        AtomicMarkableReference~V~\n    }\n    \n    class ArrayType {\n        AtomicIntegerArray\n        AtomicLongArray\n        AtomicReferenceArray~V~\n    }\n    \n    class FieldUpdaters {\n        AtomicIntegerFieldUpdater~T~\n        AtomicLongFieldUpdater~T~\n        AtomicReferenceFieldUpdater~T,V~\n    }\n    \n    class AdvancedAtomic {\n        LongAdder\n        LongAccumulator\n        DoubleAdder\n        DoubleAccumulator\n    }\n    \n    AtomicClasses <|-- BasicType\n    AtomicClasses <|-- ReferenceType\n    AtomicClasses <|-- ArrayType\n    AtomicClasses <|-- FieldUpdaters\n    AtomicClasses <|-- AdvancedAtomic"})})]}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(l.A,{value:"basic",label:"\u57FA\u672C\u7C7B\u578B\u539F\u5B50\u7C7B",default:!0,children:(0,i.jsx)("div",{className:"card",children:(0,i.jsxs)("div",{className:"card__body",children:[(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5305\u542B\u7C7B\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicInteger"}),"\uFF1A\u539F\u5B50\u6574\u578B\uFF0C\u63D0\u4F9B\u5BF9int\u503C\u7684\u539F\u5B50\u64CD\u4F5C"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicLong"}),"\uFF1A\u539F\u5B50\u957F\u6574\u578B\uFF0C\u63D0\u4F9B\u5BF9long\u503C\u7684\u539F\u5B50\u64CD\u4F5C"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicBoolean"}),"\uFF1A\u539F\u5B50\u5E03\u5C14\u578B\uFF0C\u63D0\u4F9B\u5BF9boolean\u503C\u7684\u539F\u5B50\u64CD\u4F5C"]}),"\n"]}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5E38\u7528\u573A\u666F\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8BA1\u6570\u5668"}),"\n",(0,i.jsx)(e.li,{children:"\u751F\u6210\u5E8F\u5217\u53F7"}),"\n",(0,i.jsx)(e.li,{children:"\u6807\u5FD7\u4F4D\u63A7\u5236"}),"\n",(0,i.jsx)(e.li,{children:"\u72B6\u6001\u5207\u6362"}),"\n"]})]})})}),(0,i.jsx)(l.A,{value:"reference",label:"\u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B",children:(0,i.jsx)("div",{className:"card",children:(0,i.jsxs)("div",{className:"card__body",children:[(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5305\u542B\u7C7B\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicReference"})," ",(0,i.jsx)(e.code,{children:"<V>"}),"\uFF1A\u539F\u5B50\u66F4\u65B0\u4E00\u4E2A\u5BF9\u8C61\u5F15\u7528"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicStampedReference"})," ",(0,i.jsx)(e.code,{children:"<V>"}),"\uFF1A\u5E26\u6709\u7248\u672C\u53F7\u7684\u539F\u5B50\u5F15\u7528\uFF0C\u89E3\u51B3ABA\u95EE\u9898"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicMarkableReference"})," ",(0,i.jsx)(e.code,{children:"<V>"}),"\uFF1A\u5E26\u6709\u6807\u8BB0\u7684\u539F\u5B50\u5F15\u7528\uFF0C\u7528\u4E8E\u6807\u8BB0\u5F15\u7528\u662F\u5426\u88AB\u66F4\u65B0\u8FC7"]}),"\n"]}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5E38\u7528\u573A\u666F\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u539F\u5B50\u66F4\u65B0\u5BF9\u8C61"}),"\n",(0,i.jsx)(e.li,{children:"\u89E3\u51B3CAS\u4E2D\u7684ABA\u95EE\u9898"}),"\n",(0,i.jsx)(e.li,{children:"\u72B6\u6001\u6807\u8BB0\u548C\u7248\u672C\u63A7\u5236"}),"\n"]})]})})}),(0,i.jsx)(l.A,{value:"array",label:"\u6570\u7EC4\u7C7B\u578B\u539F\u5B50\u7C7B",children:(0,i.jsx)("div",{className:"card",children:(0,i.jsxs)("div",{className:"card__body",children:[(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5305\u542B\u7C7B\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicIntegerArray"}),"\uFF1A\u539F\u5B50\u6574\u578B\u6570\u7EC4\uFF0C\u5BF9int[]\u6570\u7EC4\u5143\u7D20\u63D0\u4F9B\u539F\u5B50\u64CD\u4F5C"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicLongArray"}),"\uFF1A\u539F\u5B50\u957F\u6574\u578B\u6570\u7EC4\uFF0C\u5BF9long[]\u6570\u7EC4\u5143\u7D20\u63D0\u4F9B\u539F\u5B50\u64CD\u4F5C"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicReferenceArray"}),"\uFF1A\u539F\u5B50\u5F15\u7528\u6570\u7EC4\uFF0C\u5BF9\u5BF9\u8C61\u6570\u7EC4\u5143\u7D20\u63D0\u4F9B\u539F\u5B50\u64CD\u4F5C"]}),"\n"]}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5E38\u7528\u573A\u666F\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5E76\u53D1\u8BA1\u6570\u5668\u6570\u7EC4"}),"\n",(0,i.jsx)(e.li,{children:"\u72B6\u6001\u6570\u7EC4"}),"\n",(0,i.jsx)(e.li,{children:"\u9AD8\u5E76\u53D1\u73AF\u5883\u4E0B\u7684\u6570\u7EC4\u66F4\u65B0"}),"\n"]})]})})}),(0,i.jsx)(l.A,{value:"updater",label:"\u5B57\u6BB5\u66F4\u65B0\u5668",children:(0,i.jsx)("div",{className:"card",children:(0,i.jsxs)("div",{className:"card__body",children:[(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5305\u542B\u7C7B\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicIntegerFieldUpdater"}),"\uFF1A\u539F\u5B50\u66F4\u65B0\u5BF9\u8C61\u4E2Dint\u7C7B\u578B\u7684\u5B57\u6BB5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicLongFieldUpdater"}),"\uFF1A\u539F\u5B50\u66F4\u65B0\u5BF9\u8C61\u4E2Dlong\u7C7B\u578B\u7684\u5B57\u6BB5"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicReferenceFieldUpdater"}),"\uFF1A\u539F\u5B50\u66F4\u65B0\u5BF9\u8C61\u4E2D\u5F15\u7528\u7C7B\u578B\u7684\u5B57\u6BB5"]}),"\n"]}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5E38\u7528\u573A\u666F\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u907F\u514D\u521B\u5EFA\u989D\u5916\u7684\u539F\u5B50\u7C7B\u5B9E\u4F8B"}),"\n",(0,i.jsx)(e.li,{children:"\u4E3A\u5DF2\u6709\u7C7B\u6DFB\u52A0\u539F\u5B50\u6027\u64CD\u4F5C"}),"\n",(0,i.jsx)(e.li,{children:"\u51CF\u5C11\u5185\u5B58\u5360\u7528"}),"\n"]}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u9650\u5236\u6761\u4EF6\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5B57\u6BB5\u5FC5\u987B\u662Fvolatile\u4FEE\u9970"}),"\n",(0,i.jsx)(e.li,{children:"\u5B57\u6BB5\u5FC5\u987B\u662F\u5BF9\u66F4\u65B0\u5668\u53EF\u8BBF\u95EE\u7684"}),"\n",(0,i.jsx)(e.li,{children:"\u7C7B\u4E0D\u80FD\u88AB\u52A0\u8F7D\u5668\u9690\u85CF"}),"\n"]})]})})})]}),"\n",(0,i.jsx)(e.h2,{id:"2-\u57FA\u672C\u7C7B\u578B\u539F\u5B50\u7C7B",children:"2. \u57FA\u672C\u7C7B\u578B\u539F\u5B50\u7C7B"}),"\n",(0,i.jsx)(e.h3,{id:"21-atomicinteger",children:"2.1 AtomicInteger"}),"\n",(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h4",{children:"AtomicInteger\u6838\u5FC3API"})}),(0,i.jsx)("div",{className:"card__body",children:(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65B9\u6CD5"}),(0,i.jsx)(e.th,{children:"\u63CF\u8FF0"}),(0,i.jsx)(e.th,{children:"\u7B49\u4EF7\u540C\u6B65\u4EE3\u7801"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"get()"})}),(0,i.jsx)(e.td,{children:"\u83B7\u53D6\u5F53\u524D\u503C"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"return value;"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"set(int)"})}),(0,i.jsx)(e.td,{children:"\u8BBE\u7F6E\u65B0\u503C"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"value = newValue;"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"getAndSet(int)"})}),(0,i.jsx)(e.td,{children:"\u8BBE\u7F6E\u65B0\u503C\u5E76\u8FD4\u56DE\u65E7\u503C"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"int old = value; value = newValue; return old;"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"compareAndSet(int, int)"})}),(0,i.jsx)(e.td,{children:"\u6BD4\u8F83\u5E76\u8BBE\u7F6E"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"if(value==expect){value=update; return true;} else return false;"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"getAndIncrement()"})}),(0,i.jsx)(e.td,{children:"\u9012\u589E\u5E76\u8FD4\u56DE\u65E7\u503C"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"int old = value; value++; return old;"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"getAndDecrement()"})}),(0,i.jsx)(e.td,{children:"\u9012\u51CF\u5E76\u8FD4\u56DE\u65E7\u503C"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"int old = value; value--; return old;"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"incrementAndGet()"})}),(0,i.jsx)(e.td,{children:"\u9012\u589E\u5E76\u8FD4\u56DE\u65B0\u503C"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"return ++value;"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"decrementAndGet()"})}),(0,i.jsx)(e.td,{children:"\u9012\u51CF\u5E76\u8FD4\u56DE\u65B0\u503C"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"return --value;"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"getAndAdd(int)"})}),(0,i.jsx)(e.td,{children:"\u52A0\u4E0A\u6307\u5B9A\u503C\u5E76\u8FD4\u56DE\u65E7\u503C"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"int old = value; value += delta; return old;"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"addAndGet(int)"})}),(0,i.jsx)(e.td,{children:"\u52A0\u4E0A\u6307\u5B9A\u503C\u5E76\u8FD4\u56DE\u65B0\u503C"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"value += delta; return value;"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"updateAndGet(IntUnaryOp)"})}),(0,i.jsx)(e.td,{children:"\u5E94\u7528\u51FD\u6570\u5E76\u8FD4\u56DE\u65B0\u503C"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"value = updateFunction(value); return value;"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"getAndUpdate(IntUnaryOp)"})}),(0,i.jsx)(e.td,{children:"\u5E94\u7528\u51FD\u6570\u5E76\u8FD4\u56DE\u65E7\u503C"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"int old = value; value = updateFunction(value); return old;"})})]})]})]})})]}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(l.A,{value:"basic_ops",label:"\u57FA\u672C\u64CD\u4F5C",default:!0,children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicInteger;\n\n// \u521B\u5EFAAtomicInteger\nAtomicInteger counter = new AtomicInteger(); // \u9ED8\u8BA4\u503C\u4E3A0\nAtomicInteger initializedCounter = new AtomicInteger(100); // \u521D\u59CB\u503C\u4E3A100\n\n// \u83B7\u53D6\u5F53\u524D\u503C\nint current = counter.get(); // 0\n\n// \u8BBE\u7F6E\u503C\ncounter.set(50);\nSystem.out.println(counter.get()); // 50\n\n// \u539F\u5B50\u9012\u589E/\u9012\u51CF\nint prev = counter.getAndIncrement(); // \u8FD4\u56DE50\uFF0Ccounter\u53D8\u4E3A51\nint next = counter.incrementAndGet(); // counter\u53D8\u4E3A52\uFF0C\u8FD4\u56DE52\n\nint prev2 = counter.getAndDecrement(); // \u8FD4\u56DE52\uFF0Ccounter\u53D8\u4E3A51\nint next2 = counter.decrementAndGet(); // counter\u53D8\u4E3A50\uFF0C\u8FD4\u56DE50\n\n// \u539F\u5B50\u52A0\u6CD5/\u51CF\u6CD5\nint beforeAdd = counter.getAndAdd(15); // \u8FD4\u56DE50\uFF0Ccounter\u53D8\u4E3A65\nint afterAdd = counter.addAndGet(10); // counter\u53D8\u4E3A75\uFF0C\u8FD4\u56DE75\n\n// \u6BD4\u8F83\u5E76\u8BBE\u7F6E\nboolean success = counter.compareAndSet(75, 100); // \u5982\u679C\u5F53\u524D\u503C\u662F75\uFF0C\u5219\u8BBE\u4E3A100\nSystem.out.println(success + ", \u5F53\u524D\u503C: " + counter.get()); // true, \u5F53\u524D\u503C: 100\n'})})}),(0,i.jsx)(l.A,{value:"advanced_ops",label:"\u9AD8\u7EA7\u64CD\u4F5C",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicInteger;\nimport java.util.function.IntUnaryOperator;\n\nAtomicInteger value = new AtomicInteger(10);\n\n// \u4F7F\u7528\u51FD\u6570\u5F0F\u63A5\u53E3\u66F4\u65B0\n// \u76F8\u5F53\u4E8E\uFF1Avalue = value * 2\nint doubled = value.updateAndGet(x -> x * 2); \nSystem.out.println(doubled); // 20\n\n// \u76F8\u5F53\u4E8E\uFF1AoldValue = value; value = value + 5; return oldValue;\nint oldValue = value.getAndUpdate(x -> x + 5); \nSystem.out.println("\u65E7\u503C: " + oldValue + ", \u65B0\u503C: " + value.get()); // \u65E7\u503C: 20, \u65B0\u503C: 25\n\n// \u7D2F\u79EF\u64CD\u4F5C\n// \u76F8\u5F53\u4E8E\uFF1Avalue = value + 3 * 2\nint result = value.accumulateAndGet(3, (x, y) -> x + y * 2);\nSystem.out.println(result); // 31 (25 + 3*2)\n\n// \u81EA\u5B9A\u4E49\u51FD\u6570\nIntUnaryOperator powerOfTwo = x -> x * x;\nint squared = value.updateAndGet(powerOfTwo);\nSystem.out.println(squared); // 961 (31^2)\n'})})}),(0,i.jsx)(l.A,{value:"counter_example",label:"\u8BA1\u6570\u5668\u793A\u4F8B",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicInteger;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.TimeUnit;\n\npublic class AtomicCounter {\n    private final AtomicInteger count = new AtomicInteger(0);\n    \n    // \u7EBF\u7A0B\u5B89\u5168\u7684\u589E\u52A0\u65B9\u6CD5\n    public void increment() {\n        count.incrementAndGet();\n    }\n    \n    // \u7EBF\u7A0B\u5B89\u5168\u7684\u83B7\u53D6\u65B9\u6CD5\n    public int getCount() {\n        return count.get();\n    }\n    \n    public static void main(String[] args) throws InterruptedException {\n        final AtomicCounter counter = new AtomicCounter();\n        ExecutorService executor = Executors.newFixedThreadPool(10);\n        \n        // \u521B\u5EFA100\u4E2A\u4EFB\u52A1\uFF0C\u6BCF\u4E2A\u4EFB\u52A1\u589E\u52A0\u8BA1\u6570\u56681000\u6B21\n        for (int i = 0; i < 100; i++) {\n            executor.submit(() -> {\n                for (int j = 0; j < 1000; j++) {\n                    counter.increment();\n                }\n            });\n        }\n        \n        // \u5173\u95ED\u7EBF\u7A0B\u6C60\u5E76\u7B49\u5F85\u6240\u6709\u4EFB\u52A1\u5B8C\u6210\n        executor.shutdown();\n        executor.awaitTermination(10, TimeUnit.SECONDS);\n        \n        // \u8F93\u51FA\u6700\u7EC8\u8BA1\u6570\uFF0C\u5E94\u8BE5\u4E3A100,000\n        System.out.println("Final count: " + counter.getCount());\n    }\n}\n'})})}),(0,i.jsx)(l.A,{value:"cas_spin",label:"\u81EA\u65CBCAS",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"import java.util.concurrent.atomic.AtomicInteger;\n\npublic class CASExample {\n    private final AtomicInteger value = new AtomicInteger(0);\n    \n    // \u4F7F\u7528CAS\u624B\u52A8\u5B9E\u73B0\u81EA\u65CB\u9012\u589E\n    public void incrementWithCAS() {\n        int oldValue;\n        int newValue;\n        do {\n            // \u8BFB\u53D6\u5F53\u524D\u503C\n            oldValue = value.get();\n            newValue = oldValue + 1;\n            // \u5C1D\u8BD5CAS\u64CD\u4F5C\uFF0C\u5931\u8D25\u5219\u91CD\u8BD5\n        } while (!value.compareAndSet(oldValue, newValue));\n    }\n    \n    // \u6761\u4EF6\u66F4\u65B0 - \u53EA\u6709\u5F53\u503C\u4E3A\u5076\u6570\u65F6\u624D\u9012\u589E\n    public boolean incrementIfEven() {\n        while (true) {\n            int current = value.get();\n            if (current % 2 != 0) {\n                return false; // \u4E0D\u662F\u5076\u6570\uFF0C\u653E\u5F03\u64CD\u4F5C\n            }\n            \n            int next = current + 1;\n            if (value.compareAndSet(current, next)) {\n                return true; // CAS\u6210\u529F\n            }\n            // CAS\u5931\u8D25\uFF0C\u91CD\u8BD5\n        }\n    }\n}\n"})})})]}),"\n",(0,i.jsx)(e.h3,{id:"22-atomiclong",children:"2.2 AtomicLong"}),"\n",(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h4",{children:"AtomicLong\u7279\u6027"})}),(0,i.jsxs)("div",{className:"card__body",children:[(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6838\u5FC3\u7279\u70B9\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u63D0\u4F9B\u5BF9long\u7C7B\u578B\u53D8\u91CF\u7684\u539F\u5B50\u64CD\u4F5C"}),"\n",(0,i.jsx)(e.li,{children:"64\u4F4D\u539F\u5B50\u64CD\u4F5C\uFF0C\u89E3\u51B3\u572832\u4F4D\u7CFB\u7EDF\u4E0Along/double\u64CD\u4F5C\u975E\u539F\u5B50\u6027\u95EE\u9898"}),"\n",(0,i.jsx)(e.li,{children:"JDK 8\u540E\u5185\u90E8\u4F18\u5316\u4F7F\u7528\u4E86CPU\u7684CAS\u6307\u4EE4"}),"\n",(0,i.jsx)(e.li,{children:"\u9AD8\u5E76\u53D1\u573A\u666F\u53EF\u8003\u8651\u4F7F\u7528LongAdder\u66FF\u4EE3\u4EE5\u63D0\u9AD8\u6027\u80FD"}),"\n"]}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5E94\u7528\u573A\u666F\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5168\u5C40\u5E8F\u5217\u53F7\u751F\u6210"}),"\n",(0,i.jsx)(e.li,{children:"\u5927\u6570\u91CF\u8BA1\u6570"}),"\n",(0,i.jsx)(e.li,{children:"\u9AD8\u7CBE\u5EA6\u7EDF\u8BA1"}),"\n",(0,i.jsx)(e.li,{children:"ID\u751F\u6210\u5668"}),"\n"]})]})]}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(l.A,{value:"basic_long",label:"\u57FA\u672C\u7528\u6CD5",default:!0,children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"import java.util.concurrent.atomic.AtomicLong;\n\n// \u521B\u5EFAAtomicLong\nAtomicLong counter = new AtomicLong(0); // \u521D\u59CB\u503C\u4E3A0\nAtomicLong idGenerator = new AtomicLong(1000); // \u521D\u59CB\u503C\u4E3A1000\n\n// \u57FA\u672C\u64CD\u4F5C\nlong currentValue = counter.get(); // \u83B7\u53D6\u5F53\u524D\u503C\ncounter.set(100); // \u8BBE\u7F6E\u65B0\u503C\n\n// \u539F\u5B50\u589E\u51CF\nlong oldValue = counter.getAndIncrement(); // \u8FD4\u56DE0, counter\u53D8\u4E3A1\nlong newValue = counter.incrementAndGet(); // counter\u53D8\u4E3A2, \u8FD4\u56DE2\n\n// \u539F\u5B50\u66F4\u65B0\noldValue = counter.getAndAdd(10); // \u8FD4\u56DE2, counter\u53D8\u4E3A12\nnewValue = counter.addAndGet(8);  // counter\u53D8\u4E3A20, \u8FD4\u56DE20\n\n// CAS\u64CD\u4F5C\nboolean updated = counter.compareAndSet(20, 30); // true, counter\u53D8\u4E3A30\n"})})}),(0,i.jsx)(l.A,{value:"id_generator",label:"ID\u751F\u6210\u5668",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicLong;\n\n/**\n * \u7B80\u5355\u7684\u5206\u5E03\u5F0FID\u751F\u6210\u5668\n * - \u652F\u6301\u591A\u7EBF\u7A0B\u5B89\u5168\u5730\u751F\u6210\u552F\u4E00ID\n * - \u53EF\u6307\u5B9A\u8D77\u59CB\u503C\u548C\u6B65\u957F\n */\npublic class AtomicIdGenerator {\n    private final AtomicLong sequenceNumber;\n    private final String nodePrefix;\n    private final int step;\n    \n    /**\n     * \u521B\u5EFAID\u751F\u6210\u5668\n     * @param nodeId \u8282\u70B9ID (0-99)\n     * @param startValue \u8D77\u59CB\u503C\n     * @param step \u6B65\u957F\n     */\n    public AtomicIdGenerator(int nodeId, long startValue, int step) {\n        // \u4FDD\u8BC1\u8282\u70B9ID\u4E3A2\u4F4D\u6570\u5B57\n        this.nodePrefix = String.format("%02d", nodeId % 100);\n        this.sequenceNumber = new AtomicLong(startValue);\n        this.step = step;\n    }\n    \n    /**\n     * \u751F\u6210\u4E0B\u4E00\u4E2AID\n     * \u683C\u5F0F: \u8282\u70B9\u524D\u7F00 + \u5F53\u524D\u65F6\u95F4\u6233 + \u5E8F\u5217\u53F7\n     */\n    public String nextId() {\n        long timestamp = System.currentTimeMillis();\n        long sequence = sequenceNumber.getAndAdd(step);\n        return nodePrefix + timestamp + sequence;\n    }\n    \n    /**\n     * \u6279\u91CF\u751F\u6210ID\n     */\n    public String[] batchIds(int batchSize) {\n        String[] ids = new String[batchSize];\n        for (int i = 0; i < batchSize; i++) {\n            ids[i] = nextId();\n        }\n        return ids;\n    }\n    \n    /**\n     * \u83B7\u53D6\u5F53\u524D\u5E8F\u5217\u53F7\n     */\n    public long getCurrentSequence() {\n        return sequenceNumber.get();\n    }\n    \n    /**\n     * \u91CD\u7F6E\u5E8F\u5217\u53F7\n     */\n    public void reset(long newValue) {\n        sequenceNumber.set(newValue);\n    }\n}\n\n// \u4F7F\u7528\u793A\u4F8B\nAtomicIdGenerator idGen = new AtomicIdGenerator(1, 1000, 1);\nString id1 = idGen.nextId();\nString id2 = idGen.nextId();\nSystem.out.println("ID1: " + id1);\nSystem.out.println("ID2: " + id2);\n'})})}),(0,i.jsx)(l.A,{value:"perf_monitor",label:"\u6027\u80FD\u76D1\u63A7",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicLong;\nimport java.util.concurrent.TimeUnit;\n\n/**\n * \u9AD8\u6027\u80FD\u7EDF\u8BA1\u76D1\u63A7\u7C7B\n */\npublic class PerformanceMonitor {\n    private final AtomicLong requestCount = new AtomicLong(0);\n    private final AtomicLong errorCount = new AtomicLong(0);\n    private final AtomicLong totalResponseTime = new AtomicLong(0);\n    private final AtomicLong minResponseTime = new AtomicLong(Long.MAX_VALUE);\n    private final AtomicLong maxResponseTime = new AtomicLong(0);\n    private final AtomicLong startTime = new AtomicLong(System.currentTimeMillis());\n    \n    /**\n     * \u8BB0\u5F55\u8BF7\u6C42\n     */\n    public void recordRequest(long responseTimeMs, boolean isSuccess) {\n        requestCount.incrementAndGet();\n        totalResponseTime.addAndGet(responseTimeMs);\n        \n        // \u66F4\u65B0\u6700\u5C0F\u54CD\u5E94\u65F6\u95F4 (CAS\u81EA\u65CB\u65B9\u5F0F)\n        while (true) {\n            long currentMin = minResponseTime.get();\n            if (responseTimeMs >= currentMin) break; // \u5F53\u524D\u503C\u4E0D\u662F\u6700\u5C0F\u503C\n            if (minResponseTime.compareAndSet(currentMin, responseTimeMs)) break;\n        }\n        \n        // \u66F4\u65B0\u6700\u5927\u54CD\u5E94\u65F6\u95F4\n        while (true) {\n            long currentMax = maxResponseTime.get();\n            if (responseTimeMs <= currentMax) break; // \u5F53\u524D\u503C\u4E0D\u662F\u6700\u5927\u503C\n            if (maxResponseTime.compareAndSet(currentMax, responseTimeMs)) break;\n        }\n        \n        if (!isSuccess) {\n            errorCount.incrementAndGet();\n        }\n    }\n    \n    /**\n     * \u83B7\u53D6\u76D1\u63A7\u62A5\u544A\n     */\n    public MonitorReport getReport() {\n        long requests = requestCount.get();\n        long errors = errorCount.get();\n        long totalTime = totalResponseTime.get();\n        long minTime = minResponseTime.get();\n        long maxTime = maxResponseTime.get();\n        long uptime = System.currentTimeMillis() - startTime.get();\n        \n        return new MonitorReport(\n            requests,\n            errors,\n            requests > 0 ? totalTime / requests : 0,\n            minTime == Long.MAX_VALUE ? 0 : minTime,\n            maxTime,\n            uptime\n        );\n    }\n    \n    /**\n     * \u91CD\u7F6E\u7EDF\u8BA1\u6570\u636E\n     */\n    public void reset() {\n        requestCount.set(0);\n        errorCount.set(0);\n        totalResponseTime.set(0);\n        minResponseTime.set(Long.MAX_VALUE);\n        maxResponseTime.set(0);\n        startTime.set(System.currentTimeMillis());\n    }\n    \n    public static class MonitorReport {\n        public final long totalRequests;\n        public final long errorRequests;\n        public final long avgResponseTime;\n        public final long minResponseTime;\n        public final long maxResponseTime;\n        public final long uptime;\n        \n        public MonitorReport(\n                long totalRequests, long errorRequests, \n                long avgResponseTime, long minResponseTime, \n                long maxResponseTime, long uptime) {\n            this.totalRequests = totalRequests;\n            this.errorRequests = errorRequests;\n            this.avgResponseTime = avgResponseTime;\n            this.minResponseTime = minResponseTime;\n            this.maxResponseTime = maxResponseTime;\n            this.uptime = uptime;\n        }\n        \n        @Override\n        public String toString() {\n            return String.format(\n                "\u8BF7\u6C42\u603B\u6570: %d, \u9519\u8BEF: %d (%.2f%%), \u5E73\u5747\u54CD\u5E94\u65F6\u95F4: %dms, " +\n                "\u6700\u5C0F: %dms, \u6700\u5927: %dms, \u8FD0\u884C\u65F6\u95F4: %ds",\n                totalRequests,\n                errorRequests,\n                totalRequests > 0 ? (errorRequests * 100.0 / totalRequests) : 0.0,\n                avgResponseTime,\n                minResponseTime,\n                maxResponseTime,\n                TimeUnit.MILLISECONDS.toSeconds(uptime)\n            );\n        }\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(e.h3,{id:"23-atomicboolean",children:"2.3 AtomicBoolean"}),"\n",(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h4",{children:"AtomicBoolean\u7279\u6027\u4E0E\u5E94\u7528"})}),(0,i.jsxs)("div",{className:"card__body",children:[(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4E3B\u8981\u7279\u70B9\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u539F\u5B50\u6027\u5730\u66F4\u65B0boolean\u7C7B\u578B\u503C"}),"\n",(0,i.jsx)(e.li,{children:"\u9002\u5408\u72B6\u6001\u6807\u5FD7\u548C\u5F00\u5173\u63A7\u5236\u573A\u666F"}),"\n",(0,i.jsx)(e.li,{children:"\u7EBF\u7A0B\u5B89\u5168\u7684\u521D\u59CB\u5316\u6807\u8BB0"}),"\n",(0,i.jsx)(e.li,{children:"\u539F\u5B50\u5F00\u5173\u64CD\u4F5C"}),"\n"]}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5E38\u7528\u65B9\u6CD5\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"get()"}),": \u83B7\u53D6\u5F53\u524D\u503C"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"set(boolean)"}),": \u8BBE\u7F6E\u65B0\u503C"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"getAndSet(boolean)"}),": \u8BBE\u7F6E\u65B0\u503C\u5E76\u8FD4\u56DE\u65E7\u503C"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"compareAndSet(boolean, boolean)"}),": \u6BD4\u8F83\u5E76\u8BBE\u7F6E"]}),"\n"]}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5178\u578B\u5E94\u7528\u573A\u666F\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4E00\u6B21\u6027\u64CD\u4F5C\u6807\u5FD7"}),"\n",(0,i.jsx)(e.li,{children:"\u670D\u52A1\u5F00\u5173\u63A7\u5236"}),"\n",(0,i.jsx)(e.li,{children:"\u7EBF\u7A0B\u5B89\u5168\u7684\u521D\u59CB\u5316"}),"\n",(0,i.jsx)(e.li,{children:"\u72B6\u6001\u6807\u8BB0"}),"\n"]})]})]}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(l.A,{value:"basic_boolean",label:"\u57FA\u672C\u4F7F\u7528",default:!0,children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicBoolean;\n\n// \u521B\u5EFAAtomicBoolean\uFF0C\u9ED8\u8BA4false\nAtomicBoolean flag = new AtomicBoolean();\n\n// \u521B\u5EFA\u5E26\u521D\u59CB\u503C\u7684AtomicBoolean\nAtomicBoolean enabledFlag = new AtomicBoolean(true);\n\n// \u83B7\u53D6\u5F53\u524D\u503C\nboolean isEnabled = enabledFlag.get(); // true\n\n// \u8BBE\u7F6E\u65B0\u503C\nenabledFlag.set(false);\n\n// \u539F\u5B50\u5730\u83B7\u53D6\u65E7\u503C\u5E76\u8BBE\u7F6E\u65B0\u503C\nboolean oldValue = enabledFlag.getAndSet(true);\nSystem.out.println("\u65E7\u503C: " + oldValue + ", \u65B0\u503C: " + enabledFlag.get());\n// \u8F93\u51FA: \u65E7\u503C: false, \u65B0\u503C: true\n\n// CAS\u64CD\u4F5C\nboolean wasUpdated = enabledFlag.compareAndSet(true, false);\nSystem.out.println("\u66F4\u65B0\u6210\u529F: " + wasUpdated + ", \u5F53\u524D\u503C: " + enabledFlag.get());\n// \u8F93\u51FA: \u66F4\u65B0\u6210\u529F: true, \u5F53\u524D\u503C: false\n'})})}),(0,i.jsx)(l.A,{value:"onetime_action",label:"\u4E00\u6B21\u6027\u64CD\u4F5C",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicBoolean;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\n/**\n * \u4F7F\u7528AtomicBoolean\u786E\u4FDD\u67D0\u64CD\u4F5C\u53EA\u6267\u884C\u4E00\u6B21\n */\npublic class OneTimeAction {\n    private final AtomicBoolean initialized = new AtomicBoolean(false);\n    \n    /**\n     * \u786E\u4FDD\u53EA\u521D\u59CB\u5316\u4E00\u6B21\n     */\n    public void initialize() {\n        // compareAndSet\u65B9\u6CD5\u539F\u5B50\u6027\u5730\u68C0\u67E5\u548C\u66F4\u65B0\u503C\uFF0C\u786E\u4FDD\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u53EF\u4EE5\u6267\u884C\u521D\u59CB\u5316\n        if (initialized.compareAndSet(false, true)) {\n            try {\n                System.out.println("\u6267\u884C\u521D\u59CB\u5316\u64CD\u4F5C - \u7531\u7EBF\u7A0B " + \n                    Thread.currentThread().getName());\n                \n                // \u6A21\u62DF\u8017\u65F6\u7684\u521D\u59CB\u5316\u64CD\u4F5C\n                Thread.sleep(1000);\n                \n                System.out.println("\u521D\u59CB\u5316\u5B8C\u6210");\n            } catch (InterruptedException e) {\n                // \u5982\u679C\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u91CD\u7F6E\u6807\u5FD7\n                initialized.set(false);\n                Thread.currentThread().interrupt();\n            }\n        } else {\n            System.out.println("\u5DF2\u521D\u59CB\u5316 - \u7EBF\u7A0B " + \n                Thread.currentThread().getName() + " \u8DF3\u8FC7");\n        }\n    }\n    \n    /**\n     * \u68C0\u67E5\u662F\u5426\u5DF2\u521D\u59CB\u5316\n     */\n    public boolean isInitialized() {\n        return initialized.get();\n    }\n    \n    /**\n     * \u91CD\u7F6E\u521D\u59CB\u5316\u72B6\u6001\n     */\n    public void reset() {\n        initialized.set(false);\n    }\n    \n    public static void main(String[] args) {\n        final OneTimeAction action = new OneTimeAction();\n        ExecutorService executor = Executors.newFixedThreadPool(5);\n        \n        // \u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u5C1D\u8BD5\u521D\u59CB\u5316\n        for (int i = 0; i < 10; i++) {\n            executor.submit(action::initialize);\n        }\n        \n        executor.shutdown();\n    }\n}\n'})})}),(0,i.jsx)(l.A,{value:"circuit_breaker",label:"\u7194\u65AD\u5668\u5B9E\u73B0",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"import java.util.concurrent.atomic.AtomicBoolean;\nimport java.util.concurrent.atomic.AtomicInteger;\nimport java.util.concurrent.atomic.AtomicLong;\n\n/**\n * \u7B80\u5355\u7684\u7194\u65AD\u5668\u5B9E\u73B0\n */\npublic class CircuitBreaker {\n    private final AtomicBoolean open = new AtomicBoolean(false);\n    private final AtomicInteger failureCount = new AtomicInteger(0);\n    private final AtomicLong lastFailureTime = new AtomicLong(0);\n    \n    private final int failureThreshold;\n    private final long resetTimeoutMs;\n    \n    public CircuitBreaker(int failureThreshold, long resetTimeoutMs) {\n        this.failureThreshold = failureThreshold;\n        this.resetTimeoutMs = resetTimeoutMs;\n    }\n    \n    /**\n     * \u68C0\u67E5\u7194\u65AD\u5668\u662F\u5426\u6253\u5F00\n     */\n    public boolean isOpen() {\n        // \u5DF2\u7ECF\u6253\u5F00\u7684\u60C5\u51B5\u4E0B\uFF0C\u68C0\u67E5\u662F\u5426\u53EF\u4EE5\u5C1D\u8BD5\u5173\u95ED\n        if (open.get()) {\n            // \u8D85\u8FC7\u91CD\u7F6E\u65F6\u95F4\u540E\u5141\u8BB8\u5C1D\u8BD5\u6062\u590D\n            long currentTime = System.currentTimeMillis();\n            if (currentTime - lastFailureTime.get() > resetTimeoutMs) {\n                // \u91CD\u7F6E\u4E3A\u5173\u95ED\u72B6\u6001(\u534A\u5F00\u72B6\u6001)\n                open.compareAndSet(true, false);\n                return false;\n            }\n            return true;\n        }\n        return false;\n    }\n    \n    /**\n     * \u8BB0\u5F55\u6210\u529F\n     */\n    public void recordSuccess() {\n        // \u6210\u529F\u540E\u91CD\u7F6E\u5931\u8D25\u8BA1\u6570\n        failureCount.set(0);\n        // \u5982\u679C\u5904\u4E8E\u534A\u5F00\u72B6\u6001\uFF0C\u786E\u4FDD\u5173\u95ED\u7194\u65AD\u5668\n        open.set(false);\n    }\n    \n    /**\n     * \u8BB0\u5F55\u5931\u8D25\n     */\n    public void recordFailure() {\n        // \u8BB0\u5F55\u6700\u540E\u5931\u8D25\u65F6\u95F4\n        lastFailureTime.set(System.currentTimeMillis());\n        \n        // \u589E\u52A0\u5931\u8D25\u8BA1\u6570\n        int currentFailures = failureCount.incrementAndGet();\n        \n        // \u5982\u679C\u8FBE\u5230\u9608\u503C\uFF0C\u6253\u5F00\u7194\u65AD\u5668\n        if (currentFailures >= failureThreshold) {\n            open.set(true);\n        }\n    }\n    \n    /**\n     * \u6267\u884C\u53D7\u4FDD\u62A4\u7684\u4EE3\u7801\n     */\n    public <T> T execute(Supplier<T> supplier, T fallback) {\n        if (isOpen()) {\n            // \u7194\u65AD\u5668\u6253\u5F00\uFF0C\u76F4\u63A5\u8FD4\u56DE\u964D\u7EA7\u7ED3\u679C\n            return fallback;\n        }\n        \n        try {\n            // \u5C1D\u8BD5\u6267\u884C\u64CD\u4F5C\n            T result = supplier.get();\n            recordSuccess();\n            return result;\n        } catch (Exception e) {\n            recordFailure();\n            return fallback;\n        }\n    }\n    \n    // \u7B80\u5355\u7684Supplier\u63A5\u53E3\n    public interface Supplier<T> {\n        T get() throws Exception;\n    }\n}\n"})})})]}),"\n",(0,i.jsx)(e.h2,{id:"3-\u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B",children:"3. \u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B"}),"\n",(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h4",{children:"\u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B\u6982\u8FF0"})}),(0,i.jsxs)("div",{className:"card__body",children:[(0,i.jsx)(e.p,{children:"\u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B\u7528\u4E8E\u539F\u5B50\u6027\u5730\u66F4\u65B0\u5BF9\u8C61\u5F15\u7528\uFF0C\u4E3B\u8981\u5305\u62EC\u4EE5\u4E0B\u51E0\u4E2A\u7C7B\uFF1A"}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicReference"}),"\uFF1A\u539F\u5B50\u66F4\u65B0\u4E00\u4E2A\u5BF9\u8C61\u5F15\u7528"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicStampedReference"}),"\uFF1A\u5E26\u6709\u7248\u672C\u53F7\u7684\u539F\u5B50\u5F15\u7528\uFF0C\u89E3\u51B3ABA\u95EE\u9898"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicMarkableReference"}),"\uFF1A\u5E26\u6709\u6807\u8BB0\u7684\u539F\u5B50\u5F15\u7528\uFF0C\u7528\u4E8E\u6807\u8BB0\u5F15\u7528\u662F\u5426\u88AB\u66F4\u65B0\u8FC7"]}),"\n"]}),(0,i.jsx)(e.p,{children:"\u8FD9\u4E9B\u7C7B\u4F7F\u5F97\u5728\u4E0D\u4F7F\u7528\u9501\u7684\u60C5\u51B5\u4E0B\uFF0C\u5B89\u5168\u5730\u66F4\u65B0\u5BF9\u8C61\u5F15\u7528\u6210\u4E3A\u53EF\u80FD\uFF0C\u7279\u522B\u9002\u5408\u4E8E\u5B9E\u73B0\u65E0\u9501\u6570\u636E\u7ED3\u6784\u548C\u7B97\u6CD5\u3002"})]})]}),"\n",(0,i.jsx)(e.h3,{id:"31-atomicreference",children:"3.1 AtomicReference"}),"\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant Thread1 as \u7EBF\u7A0B1\n    participant AtomicRef as AtomicReference\n    participant Thread2 as \u7EBF\u7A0B2\n    \n    Note over AtomicRef: \u521D\u59CB\u503C: Object A\n    \n    Thread1->>AtomicRef: get() \u83B7\u53D6\u5F53\u524D\u503C\n    AtomicRef--\x3e>Thread1: \u8FD4\u56DE Object A\n    Thread1->>Thread1: \u8BA1\u7B97\u65B0\u503C Object B\n    \n    Thread2->>AtomicRef: get() \u83B7\u53D6\u5F53\u524D\u503C\n    AtomicRef--\x3e>Thread2: \u8FD4\u56DE Object A\n    Thread2->>AtomicRef: CAS(A\u2192B)\n    AtomicRef--\x3e>Thread2: \u6210\u529F\uFF0C\u8FD4\u56DEtrue\n    Note over AtomicRef: \u5F53\u524D\u503C: Object B\n    \n    Thread2->>AtomicRef: get() \u83B7\u53D6\u5F53\u524D\u503C\n    AtomicRef--\x3e>Thread2: \u8FD4\u56DE Object B\n    Thread2->>AtomicRef: CAS(B\u2192C)\n    AtomicRef--\x3e>Thread2: \u5931\u8D25\uFF0C\u8FD4\u56DEfalse\n    Note over Thread2: \u9700\u8981\u91CD\u8BD5\u6216\u5904\u7406\u5931\u8D25"}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(l.A,{value:"atomic_ref_basic",label:"\u57FA\u672C\u7528\u6CD5",default:!0,children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicReference;\n\n// \u521B\u5EFA\u5E26\u521D\u59CB\u503C\u7684AtomicReference\nAtomicReference<String> atomicString = new AtomicReference<>("\u521D\u59CB\u503C");\n\n// \u521B\u5EFA\u7A7A\u7684AtomicReference\nAtomicReference<User> atomicUser = new AtomicReference<>();\n\n// \u83B7\u53D6\u5F15\u7528\nString value = atomicString.get();\nSystem.out.println("\u5F53\u524D\u503C: " + value); // \u5F53\u524D\u503C: \u521D\u59CB\u503C\n\n// \u8BBE\u7F6E\u65B0\u503C\natomicString.set("\u65B0\u503C");\nSystem.out.println("\u66F4\u65B0\u540E: " + atomicString.get()); // \u66F4\u65B0\u540E: \u65B0\u503C\n\n// \u539F\u5B50\u65B9\u5F0F\u83B7\u53D6\u5E76\u8BBE\u7F6E\nString oldValue = atomicString.getAndSet("\u66F4\u65B0\u7684\u503C");\nSystem.out.println("\u65E7\u503C: " + oldValue + ", \u5F53\u524D\u503C: " + atomicString.get());\n// \u8F93\u51FA: \u65E7\u503C: \u65B0\u503C, \u5F53\u524D\u503C: \u66F4\u65B0\u7684\u503C\n\n// \u6BD4\u8F83\u5E76\u8BBE\u7F6E\nboolean wasUpdated = atomicString.compareAndSet("\u66F4\u65B0\u7684\u503C", "\u6700\u7EC8\u503C");\nSystem.out.println("\u66F4\u65B0\u662F\u5426\u6210\u529F: " + wasUpdated + ", \u5F53\u524D\u503C: " + atomicString.get());\n// \u8F93\u51FA: \u66F4\u65B0\u662F\u5426\u6210\u529F: true, \u5F53\u524D\u503C: \u6700\u7EC8\u503C\n\n// \u4F7F\u7528\u51FD\u6570\u66F4\u65B0\natomicString.updateAndGet(current -> current + " - \u9644\u52A0\u5185\u5BB9");\nSystem.out.println("\u51FD\u6570\u66F4\u65B0\u540E: " + atomicString.get());\n// \u8F93\u51FA: \u51FD\u6570\u66F4\u65B0\u540E: \u6700\u7EC8\u503C - \u9644\u52A0\u5185\u5BB9\n'})})}),(0,i.jsx)(l.A,{value:"atomic_ref_object",label:"\u5BF9\u8C61\u5F15\u7528",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicReference;\n\nclass User {\n    private final String name;\n    private final int age;\n    \n    public User(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n    \n    public User withAge(int newAge) {\n        return new User(this.name, newAge);\n    }\n    \n    @Override\n    public String toString() {\n        return "User{name=\'" + name + "\', age=" + age + "}";\n    }\n}\n\n// \u521B\u5EFA\u4E00\u4E2A\u7528\u6237\u7684\u539F\u5B50\u5F15\u7528\nAtomicReference<User> userRef = new AtomicReference<>(new User("\u5F20\u4E09", 20));\n\n// \u6253\u5370\u5F53\u524D\u7528\u6237\nSystem.out.println("\u5F53\u524D\u7528\u6237: " + userRef.get());\n\n// \u539F\u5B50\u5730\u66F4\u65B0\u7528\u6237\u5E74\u9F84 - \u4F7F\u7528CAS\u64CD\u4F5C\nUser user;\nUser newUser;\ndo {\n    user = userRef.get();\n    newUser = user.withAge(user.age + 1);\n} while (!userRef.compareAndSet(user, newUser));\n\nSystem.out.println("\u66F4\u65B0\u540E\u7528\u6237: " + userRef.get());\n\n// \u4F7F\u7528\u51FD\u6570\u5F0F\u66F4\u65B0\nuserRef.updateAndGet(u -> u.withAge(u.age + 5));\nSystem.out.println("\u51FD\u6570\u66F4\u65B0\u540E: " + userRef.get());\n'})})}),(0,i.jsx)(l.A,{value:"atomic_ref_state",label:"\u72B6\u6001\u7BA1\u7406",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicReference;\nimport java.util.concurrent.TimeUnit;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\n/**\n * \u4F7F\u7528AtomicReference\u5B9E\u73B0\u72B6\u6001\u673A\n */\npublic class StateMachine {\n    // \u5B9A\u4E49\u53EF\u80FD\u7684\u72B6\u6001\n    public enum State {\n        INITIALIZING, RUNNING, PAUSED, SHUTTING_DOWN, TERMINATED\n    }\n    \n    private final AtomicReference<State> state = \n        new AtomicReference<>(State.INITIALIZING);\n    \n    /**\n     * \u5C1D\u8BD5\u8F6C\u6362\u72B6\u6001\n     * @param from \u671F\u671B\u7684\u5F53\u524D\u72B6\u6001\n     * @param to \u76EE\u6807\u72B6\u6001\n     * @return \u662F\u5426\u8F6C\u6362\u6210\u529F\n     */\n    public boolean transitionState(State from, State to) {\n        return state.compareAndSet(from, to);\n    }\n    \n    /**\n     * \u83B7\u53D6\u5F53\u524D\u72B6\u6001\n     */\n    public State getState() {\n        return state.get();\n    }\n    \n    public static void main(String[] args) throws InterruptedException {\n        StateMachine machine = new StateMachine();\n        ExecutorService executor = Executors.newFixedThreadPool(2);\n        \n        // \u4EFB\u52A11: \u521D\u59CB\u5316\u540E\u8FD0\u884C\n        executor.submit(() -> {\n            if (machine.transitionState(State.INITIALIZING, State.RUNNING)) {\n                System.out.println("\u6210\u529F\u542F\u52A8!");\n            } else {\n                System.out.println("\u542F\u52A8\u5931\u8D25!");\n            }\n        });\n        \n        // \u7ED9\u4EFB\u52A11\u4E00\u70B9\u65F6\u95F4\u6267\u884C\n        TimeUnit.MILLISECONDS.sleep(100);\n        \n        // \u4EFB\u52A12: \u5C1D\u8BD5\u6682\u505C\n        executor.submit(() -> {\n            if (machine.transitionState(State.RUNNING, State.PAUSED)) {\n                System.out.println("\u6210\u529F\u6682\u505C!");\n            } else {\n                System.out.println("\u6682\u505C\u5931\u8D25!");\n            }\n        });\n        \n        executor.shutdown();\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(e.h3,{id:"32-atomicstampedreference",children:"3.2 AtomicStampedReference"}),"\n",(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h4",{children:"ABA \u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848"})}),(0,i.jsxs)("div",{className:"card__body",children:[(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"ABA\u95EE\u9898\u662F\u6307\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7EBF\u7A0B1\u8BFB\u53D6\u5171\u4EAB\u53D8\u91CF\u7684\u503C\u4E3AA"}),"\n",(0,i.jsx)(e.li,{children:"\u7EBF\u7A0B2\u5C06\u5171\u4EAB\u53D8\u91CF\u7684\u503C\u4FEE\u6539\u4E3AB\uFF0C\u7136\u540E\u53C8\u4FEE\u6539\u56DEA"}),"\n",(0,i.jsx)(e.li,{children:"\u7EBF\u7A0B1\u8FDB\u884CCAS\u64CD\u4F5C\uFF0C\u53D1\u73B0\u5171\u4EAB\u53D8\u91CF\u7684\u503C\u4ECD\u4E3AA\uFF0C\u8BA4\u4E3A\u6CA1\u6709\u88AB\u4FEE\u6539\u8FC7\uFF0C\u4F46\u5B9E\u9645\u4E0A\u5DF2\u7ECF\u7ECF\u5386\u4E86 A\u2192B\u2192A \u7684\u53D8\u5316"}),"\n"]}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"AtomicStampedReference\u901A\u8FC7\u6DFB\u52A0\u7248\u672C\u53F7\u89E3\u51B3ABA\u95EE\u9898\uFF1A"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6BCF\u6B21\u66F4\u65B0\u5F15\u7528\u7684\u540C\u65F6\u66F4\u65B0\u7248\u672C\u53F7"}),"\n",(0,i.jsx)(e.li,{children:"CAS\u64CD\u4F5C\u540C\u65F6\u68C0\u67E5\u5F15\u7528\u548C\u7248\u672C\u53F7"}),"\n",(0,i.jsx)(e.li,{children:"\u5373\u4F7F\u5F15\u7528\u503C\u76F8\u540C\uFF0C\u82E5\u7248\u672C\u53F7\u4E0D\u540C\uFF0CCAS\u64CD\u4F5C\u4E5F\u4F1A\u5931\u8D25"}),"\n"]})]})]}),"\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant Thread1 as \u7EBF\u7A0B1\n    participant ASR as AtomicStampedReference\n    participant Thread2 as \u7EBF\u7A0B2\n    \n    Note over ASR: \u521D\u59CB\u503C: A, \u7248\u672C: 1\n    \n    Thread1->>ASR: \u8BFB\u53D6\u5F53\u524D\u503C\u548C\u7248\u672C\u53F7\n    ASR--\x3e>Thread1: \u8FD4\u56DE A, \u7248\u672C1\n    Thread1->>Thread1: \u6682\u505C\u4E00\u6BB5\u65F6\u95F4\n    \n    Thread2->>ASR: \u8BFB\u53D6\u5F53\u524D\u503C\u548C\u7248\u672C\u53F7\n    ASR--\x3e>Thread2: \u8FD4\u56DE A, \u7248\u672C1\n    Thread2->>ASR: CAS(A\u2192B, \u7248\u672C1\u21922)\n    ASR--\x3e>Thread2: \u6210\u529F\uFF0C\u8FD4\u56DEtrue\n    Note over ASR: \u5F53\u524D\u503C: B, \u7248\u672C: 2\n    \n    Thread2->>ASR: \u8BFB\u53D6\u5F53\u524D\u503C\u548C\u7248\u672C\u53F7\n    ASR--\x3e>Thread2: \u8FD4\u56DE B, \u7248\u672C2\n    Thread2->>ASR: CAS(B\u2192A, \u7248\u672C2\u21923)\n    ASR--\x3e>Thread2: \u6210\u529F\uFF0C\u8FD4\u56DEtrue\n    Note over ASR: \u5F53\u524D\u503C: A, \u7248\u672C: 3\n    \n    Thread1->>ASR: CAS(A\u2192C, \u7248\u672C1\u21922)\n    ASR--\x3e>Thread1: \u5931\u8D25\uFF0C\u7248\u672C\u53F7\u4E0D\u5339\u914D\n    Note over Thread1: \u7248\u672C\u53F7\u4E0D\u5339\u914D\uFF0C\u68C0\u6D4B\u5230ABA\u95EE\u9898"}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(l.A,{value:"atomic_stamped_basic",label:"\u57FA\u672C\u7528\u6CD5",default:!0,children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicStampedReference;\n\n// \u521B\u5EFAAtomicStampedReference\uFF0C\u521D\u59CB\u5F15\u7528\u4E3A"A"\uFF0C\u521D\u59CB\u7248\u672C\u53F7\u4E3A1\nAtomicStampedReference<String> asr = \n    new AtomicStampedReference<>("A", 1);\n\n// \u8BFB\u53D6\u5F53\u524D\u5F15\u7528\u548C\u7248\u672C\u53F7\nint[] stampHolder = new int[1];\nString value = asr.get(stampHolder);\nint stamp = stampHolder[0];\n\nSystem.out.println("\u521D\u59CB\u503C: " + value + ", \u7248\u672C\u53F7: " + stamp);\n\n// \u66F4\u65B0\u5F15\u7528\u548C\u7248\u672C\u53F7\nboolean success = asr.compareAndSet("A", "B", stamp, stamp + 1);\nSystem.out.println("\u66F4\u65B0\u7ED3\u679C: " + success);\n\n// \u518D\u6B21\u83B7\u53D6\u65B0\u7684\u5F15\u7528\u548C\u7248\u672C\u53F7\nvalue = asr.get(stampHolder);\nstamp = stampHolder[0];\nSystem.out.println("\u66F4\u65B0\u540E\u503C: " + value + ", \u7248\u672C\u53F7: " + stamp);\n\n// \u5C1D\u8BD5\u4F7F\u7528\u8FC7\u671F\u7248\u672C\u53F7\u66F4\u65B0\uFF0C\u5C06\u4F1A\u5931\u8D25\nboolean outdatedSuccess = asr.compareAndSet("B", "C", 1, 2);\nSystem.out.println("\u4F7F\u7528\u65E7\u7248\u672C\u53F7\u66F4\u65B0\u7ED3\u679C: " + outdatedSuccess);\n\n// \u4F7F\u7528\u5F53\u524D\u7248\u672C\u53F7\u66F4\u65B0\uFF0C\u5C06\u4F1A\u6210\u529F\nboolean currentSuccess = asr.compareAndSet("B", "C", stamp, stamp + 1);\nSystem.out.println("\u4F7F\u7528\u5F53\u524D\u7248\u672C\u53F7\u66F4\u65B0\u7ED3\u679C: " + currentSuccess);\nSystem.out.println("\u6700\u7EC8\u503C: " + asr.getReference() + ", \u7248\u672C\u53F7: " + asr.getStamp());\n'})})}),(0,i.jsx)(l.A,{value:"aba_solution",label:"ABA\u95EE\u9898\u89E3\u51B3\u793A\u4F8B",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicStampedReference;\nimport java.util.concurrent.TimeUnit;\n\n/**\n * \u4F7F\u7528AtomicStampedReference\u89E3\u51B3ABA\u95EE\u9898\u7684\u793A\u4F8B\n */\npublic class ABAProblemSolution {\n    private static final AtomicStampedReference<Integer> atomicStampedRef = \n        new AtomicStampedReference<>(100, 0);\n\n    public static void main(String[] args) throws InterruptedException {\n        System.out.println("===== ABA\u95EE\u9898\u89E3\u51B3\u793A\u4F8B =====");\n        \n        // \u83B7\u53D6\u521D\u59CB\u7684\u7248\u672C\u53F7\n        int initialStamp = atomicStampedRef.getStamp();\n        Integer initialRef = atomicStampedRef.getReference();\n        System.out.println("\u521D\u59CB\u503C: " + initialRef + ", \u521D\u59CB\u7248\u672C: " + initialStamp);\n        \n        // \u7EBF\u7A0B1 - \u6A21\u62DF\u89E3\u51B3ABA\u95EE\u9898\n        Thread t1 = new Thread(() -> {\n            System.out.println("\u7EBF\u7A0B1\uFF1A\u8BFB\u53D6\u521D\u59CB\u503C\u548C\u7248\u672C\u53F7");\n            int stamp = atomicStampedRef.getStamp();\n            Integer ref = atomicStampedRef.getReference();\n            \n            try {\n                // \u7EBF\u7A0B1\u6682\u505C1\u79D2\uFF0C\u8BA9\u7EBF\u7A0B2\u5B8C\u6210ABA\u64CD\u4F5C\n                TimeUnit.SECONDS.sleep(1);\n            } catch (InterruptedException e) {\n                Thread.currentThread().interrupt();\n            }\n            \n            System.out.println("\u7EBF\u7A0B1\uFF1A\u5C1D\u8BD5\u66F4\u65B0 100 -> 101, \u7248\u672C:" + stamp + " -> " + (stamp + 1));\n            boolean success = atomicStampedRef.compareAndSet(\n                100, 101, stamp, stamp + 1);\n            \n            System.out.println("\u7EBF\u7A0B1\uFF1ACAS " + (success ? "\u6210\u529F" : "\u5931\u8D25") + \n                ", \u5F53\u524D\u503C: " + atomicStampedRef.getReference() + \n                ", \u5F53\u524D\u7248\u672C: " + atomicStampedRef.getStamp());\n        });\n        \n        // \u7EBF\u7A0B2 - \u6A21\u62DF\u9020\u6210ABA\u95EE\u9898\u7684\u64CD\u4F5C\n        Thread t2 = new Thread(() -> {\n            try {\n                // \u8BA9\u7EBF\u7A0B1\u5148\u8FD0\u884C\u5E76\u8BFB\u53D6\u503C\n                TimeUnit.MILLISECONDS.sleep(100);\n            } catch (InterruptedException e) {\n                Thread.currentThread().interrupt();\n            }\n            \n            int stamp = atomicStampedRef.getStamp();\n            System.out.println("\u7EBF\u7A0B2\uFF1A\u5F53\u524D\u7248\u672C " + stamp);\n            \n            // 100 -> 200 -> 100\uFF0C\u5236\u9020ABA\n            System.out.println("\u7EBF\u7A0B2\uFF1A100 -> 200");\n            atomicStampedRef.compareAndSet(100, 200, stamp, stamp + 1);\n            \n            System.out.println("\u7EBF\u7A0B2\uFF1A\u5F53\u524D\u7248\u672C " + atomicStampedRef.getStamp());\n            \n            // \u518D\u6539\u56DE100\n            System.out.println("\u7EBF\u7A0B2\uFF1A200 -> 100");\n            atomicStampedRef.compareAndSet(200, 100, \n                atomicStampedRef.getStamp(), atomicStampedRef.getStamp() + 1);\n            \n            System.out.println("\u7EBF\u7A0B2\uFF1A\u5F53\u524D\u7248\u672C " + atomicStampedRef.getStamp());\n        });\n        \n        t1.start();\n        t2.start();\n        \n        t1.join();\n        t2.join();\n        \n        System.out.println("\u6700\u7EC8\u503C: " + atomicStampedRef.getReference() + \n            ", \u6700\u7EC8\u7248\u672C: " + atomicStampedRef.getStamp());\n    }\n}\n'})})}),(0,i.jsx)(l.A,{value:"version_control",label:"\u7248\u672C\u63A7\u5236",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicStampedReference;\nimport java.util.concurrent.ConcurrentHashMap;\n\n/**\n * \u4F7F\u7528AtomicStampedReference\u5B9E\u73B0\u7B80\u5355\u7684\u7248\u672C\u63A7\u5236\u7F13\u5B58\n */\npublic class VersionedCache<K, V> {\n    private static class VersionedValue<V> {\n        final V value;\n        final long timestamp;\n        \n        VersionedValue(V value, long timestamp) {\n            this.value = value;\n            this.timestamp = timestamp;\n        }\n        \n        @Override\n        public String toString() {\n            return value + " (v" + timestamp + ")";\n        }\n    }\n    \n    private final ConcurrentHashMap<K, AtomicStampedReference<VersionedValue<V>>> cache = \n        new ConcurrentHashMap<>();\n    \n    /**\n     * \u83B7\u53D6\u7F13\u5B58\u503C\uFF0C\u8FD4\u56DE\u503C\u548C\u7248\u672C\u53F7\n     */\n    public V get(K key, int[] versionHolder) {\n        AtomicStampedReference<VersionedValue<V>> ref = cache.get(key);\n        if (ref == null) {\n            versionHolder[0] = 0;\n            return null;\n        }\n        \n        VersionedValue<V> versionedValue = ref.get(versionHolder);\n        return versionedValue != null ? versionedValue.value : null;\n    }\n    \n    /**\n     * \u66F4\u65B0\u7F13\u5B58\uFF0C\u4EC5\u5F53\u7248\u672C\u53F7\u5339\u914D\u65F6\n     * @return \u662F\u5426\u66F4\u65B0\u6210\u529F\n     */\n    public boolean put(K key, V value, int expectedVersion) {\n        long timestamp = System.currentTimeMillis();\n        VersionedValue<V> newVersionedValue = new VersionedValue<>(value, timestamp);\n        \n        AtomicStampedReference<VersionedValue<V>> ref = cache.get(key);\n        if (ref == null) {\n            if (expectedVersion != 0) {\n                return false;  // \u671F\u671B\u6709\u7248\u672C\u53F7\uFF0C\u4F46\u5B9E\u9645\u4E0D\u5B58\u5728\n            }\n            // \u9996\u6B21\u521B\u5EFA\uFF0C\u7248\u672C\u4E3A1\n            ref = new AtomicStampedReference<>(newVersionedValue, 1);\n            AtomicStampedReference<VersionedValue<V>> existing = \n                cache.putIfAbsent(key, ref);\n            return existing == null;\n        }\n        \n        // \u66F4\u65B0\u73B0\u6709\u503C\uFF0C\u7248\u672C\u53F7\u52A01\n        return ref.compareAndSet(\n            ref.getReference(), newVersionedValue, expectedVersion, expectedVersion + 1);\n    }\n    \n    /**\n     * \u5220\u9664\u7F13\u5B58\n     * @return \u662F\u5426\u5220\u9664\u6210\u529F\n     */\n    public boolean remove(K key, int expectedVersion) {\n        AtomicStampedReference<VersionedValue<V>> ref = cache.get(key);\n        if (ref == null) {\n            return false;\n        }\n        \n        int[] stampHolder = new int[1];\n        ref.get(stampHolder);\n        \n        if (stampHolder[0] != expectedVersion) {\n            return false;  // \u7248\u672C\u4E0D\u5339\u914D\n        }\n        \n        return cache.remove(key, ref);\n    }\n    \n    /**\n     * \u83B7\u53D6\u5F53\u524D\u952E\u503C\u6570\u91CF\n     */\n    public int size() {\n        return cache.size();\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(e.h3,{id:"33-atomicmarkablereference",children:"3.3 AtomicMarkableReference"}),"\n",(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h4",{children:"AtomicMarkableReference\u4E0EAtomicStampedReference\u7684\u5BF9\u6BD4"})}),(0,i.jsx)("div",{className:"card__body",children:(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u7279\u6027"}),(0,i.jsx)(e.th,{children:"AtomicMarkableReference"}),(0,i.jsx)(e.th,{children:"AtomicStampedReference"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u6807\u8BB0\u7C7B\u578B"}),(0,i.jsx)(e.td,{children:"\u5E03\u5C14\u503C\uFF08\u6807\u8BB0/\u672A\u6807\u8BB0\uFF09"}),(0,i.jsx)(e.td,{children:"\u6574\u6570\uFF08\u7248\u672C\u53F7\uFF09"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5185\u5B58\u5360\u7528"}),(0,i.jsx)(e.td,{children:"\u8F83\u5C0F"}),(0,i.jsx)(e.td,{children:"\u8F83\u5927"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u9002\u7528\u573A\u666F"}),(0,i.jsx)(e.td,{children:"\u53EA\u9700\u8981\u6807\u8BB0\u5BF9\u8C61\u662F\u5426\u88AB\u4FEE\u6539\u8FC7"}),(0,i.jsx)(e.td,{children:"\u9700\u8981\u5B8C\u6574\u7684\u7248\u672C\u5386\u53F2"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u89E3\u51B3ABA"}),(0,i.jsx)(e.td,{children:"\u90E8\u5206\u89E3\u51B3\uFF08\u53EA\u80FD\u68C0\u6D4B\u5230\u662F\u5426\u6709\u8FC7\u4FEE\u6539\uFF09"}),(0,i.jsx)(e.td,{children:"\u5B8C\u5168\u89E3\u51B3\uFF08\u901A\u8FC7\u7248\u672C\u53F7\u533A\u5206\uFF09"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"API\u590D\u6742\u5EA6"}),(0,i.jsx)(e.td,{children:"\u8F83\u7B80\u5355"}),(0,i.jsx)(e.td,{children:"\u8F83\u590D\u6742"})]})]})]})})]}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(l.A,{value:"markable_basic",label:"\u57FA\u672C\u7528\u6CD5",default:!0,children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicMarkableReference;\n\n// \u521B\u5EFAAtomicMarkableReference\uFF0C\u521D\u59CB\u5F15\u7528\u4E3A"\u6570\u636E"\uFF0C\u521D\u59CB\u6807\u8BB0\u4E3Afalse\nAtomicMarkableReference<String> amr = \n    new AtomicMarkableReference<>("\u6570\u636E", false);\n\n// \u83B7\u53D6\u5F53\u524D\u503C\u548C\u6807\u8BB0\nboolean[] markHolder = new boolean[1];\nString value = amr.get(markHolder);\nboolean mark = markHolder[0];\n\nSystem.out.println("\u521D\u59CB\u503C: " + value + ", \u6807\u8BB0: " + mark);\n\n// \u66F4\u65B0\u5F15\u7528\u5E76\u8BBE\u7F6E\u6807\u8BB0\nboolean success = amr.compareAndSet("\u6570\u636E", "\u65B0\u6570\u636E", false, true);\nSystem.out.println("\u66F4\u65B0\u7ED3\u679C: " + success);\n\n// \u518D\u6B21\u83B7\u53D6\u503C\u548C\u6807\u8BB0\nvalue = amr.get(markHolder);\nmark = markHolder[0];\nSystem.out.println("\u66F4\u65B0\u540E\u503C: " + value + ", \u6807\u8BB0: " + mark);\n\n// \u4EC5\u66F4\u65B0\u6807\u8BB0\uFF0C\u4E0D\u66F4\u65B0\u5F15\u7528\nsuccess = amr.attemptMark("\u65B0\u6570\u636E", false);\nSystem.out.println("\u4EC5\u66F4\u65B0\u6807\u8BB0\u7ED3\u679C: " + success);\nSystem.out.println("\u6807\u8BB0\u66F4\u65B0\u540E: " + amr.isMarked());\n'})})}),(0,i.jsx)(l.A,{value:"logical_deletion",label:"\u903B\u8F91\u5220\u9664",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicMarkableReference;\n\n/**\n * \u4F7F\u7528AtomicMarkableReference\u5B9E\u73B0\u94FE\u8868\u8282\u70B9\u7684\u903B\u8F91\u5220\u9664\n */\npublic class LogicalDeletionExample {\n    static class Node {\n        String item;\n        Node next;\n        \n        public Node(String item) {\n            this.item = item;\n        }\n        \n        @Override\n        public String toString() {\n            return item;\n        }\n    }\n    \n    /**\n     * \u94FE\u8868\u8282\u70B9\u7684\u5305\u88C5\uFF0C\u5E26\u6709\u903B\u8F91\u5220\u9664\u6807\u8BB0\n     */\n    static class MarkedNode {\n        private final AtomicMarkableReference<Node> reference;\n        \n        public MarkedNode(Node node) {\n            this.reference = new AtomicMarkableReference<>(node, false);\n        }\n        \n        /**\n         * \u83B7\u53D6\u8282\u70B9\uFF08\u5982\u679C\u672A\u88AB\u903B\u8F91\u5220\u9664\uFF09\n         */\n        public Node get() {\n            boolean[] marked = new boolean[1];\n            Node node = reference.get(marked);\n            return marked[0] ? null : node;  // \u5982\u679C\u5DF2\u6807\u8BB0\u5220\u9664\uFF0C\u8FD4\u56DEnull\n        }\n        \n        /**\n         * \u903B\u8F91\u5220\u9664\u8282\u70B9\n         */\n        public boolean delete() {\n            boolean[] marked = new boolean[1];\n            Node node = reference.get(marked);\n            \n            if (marked[0]) {\n                return false;  // \u5DF2\u7ECF\u88AB\u5220\u9664\n            }\n            \n            // \u6807\u8BB0\u4E3A\u5DF2\u5220\u9664\n            return reference.compareAndSet(node, node, false, true);\n        }\n        \n        /**\n         * \u68C0\u67E5\u662F\u5426\u5DF2\u5220\u9664\n         */\n        public boolean isDeleted() {\n            return reference.isMarked();\n        }\n        \n        /**\n         * \u6062\u590D\u5220\u9664\u7684\u8282\u70B9\uFF08\u53D6\u6D88\u5220\u9664\u6807\u8BB0\uFF09\n         */\n        public boolean undelete() {\n            boolean[] marked = new boolean[1];\n            Node node = reference.get(marked);\n            \n            if (!marked[0]) {\n                return false;  // \u6CA1\u6709\u88AB\u5220\u9664\uFF0C\u65E0\u9700\u6062\u590D\n            }\n            \n            // \u53D6\u6D88\u5220\u9664\u6807\u8BB0\n            return reference.compareAndSet(node, node, true, false);\n        }\n        \n        /**\n         * \u66F4\u65B0\u8282\u70B9\uFF08\u5982\u679C\u672A\u88AB\u5220\u9664\uFF09\n         */\n        public boolean updateIfNotDeleted(Node newNode) {\n            boolean[] marked = new boolean[1];\n            Node oldNode = reference.get(marked);\n            \n            if (marked[0]) {\n                return false;  // \u5DF2\u88AB\u5220\u9664\uFF0C\u4E0D\u80FD\u66F4\u65B0\n            }\n            \n            return reference.compareAndSet(oldNode, newNode, false, false);\n        }\n    }\n    \n    public static void main(String[] args) {\n        Node node = new Node("\u8282\u70B91");\n        MarkedNode markedNode = new MarkedNode(node);\n        \n        System.out.println("\u521D\u59CB\u8282\u70B9: " + markedNode.get());\n        System.out.println("\u5DF2\u5220\u9664? " + markedNode.isDeleted());\n        \n        // \u903B\u8F91\u5220\u9664\u8282\u70B9\n        boolean deleted = markedNode.delete();\n        System.out.println("\u5220\u9664\u6210\u529F? " + deleted);\n        System.out.println("\u5DF2\u5220\u9664? " + markedNode.isDeleted());\n        System.out.println("\u83B7\u53D6\u8282\u70B9: " + markedNode.get());\n        \n        // \u5C1D\u8BD5\u66F4\u65B0\u5DF2\u5220\u9664\u7684\u8282\u70B9\n        boolean updated = markedNode.updateIfNotDeleted(new Node("\u8282\u70B92"));\n        System.out.println("\u66F4\u65B0\u6210\u529F? " + updated);\n        \n        // \u6062\u590D\u8282\u70B9\n        boolean undeleted = markedNode.undelete();\n        System.out.println("\u6062\u590D\u6210\u529F? " + undeleted);\n        System.out.println("\u5DF2\u5220\u9664? " + markedNode.isDeleted());\n        System.out.println("\u83B7\u53D6\u8282\u70B9: " + markedNode.get());\n        \n        // \u66F4\u65B0\u5DF2\u6062\u590D\u7684\u8282\u70B9\n        updated = markedNode.updateIfNotDeleted(new Node("\u8282\u70B92"));\n        System.out.println("\u66F4\u65B0\u6210\u529F? " + updated);\n        System.out.println("\u66F4\u65B0\u540E\u8282\u70B9: " + markedNode.get());\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(e.h2,{id:"4-\u6570\u7EC4\u539F\u5B50\u7C7B",children:"4. \u6570\u7EC4\u539F\u5B50\u7C7B"}),"\n",(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h4",{children:"\u6570\u7EC4\u539F\u5B50\u7C7B\u6982\u8FF0"})}),(0,i.jsxs)("div",{className:"card__body",children:[(0,i.jsx)(e.p,{children:"\u6570\u7EC4\u539F\u5B50\u7C7B\u63D0\u4F9B\u5BF9\u6570\u7EC4\u5143\u7D20\u7684\u539F\u5B50\u64CD\u4F5C\uFF0C\u4E3B\u8981\u5305\u62EC\uFF1A"}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicIntegerArray"}),"\uFF1A\u539F\u5B50\u66F4\u65B0\u6574\u578B\u6570\u7EC4\u91CC\u7684\u5143\u7D20"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicLongArray"}),"\uFF1A\u539F\u5B50\u66F4\u65B0\u957F\u6574\u578B\u6570\u7EC4\u91CC\u7684\u5143\u7D20"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AtomicReferenceArray"}),"\uFF1A\u539F\u5B50\u66F4\u65B0\u5F15\u7528\u7C7B\u578B\u6570\u7EC4\u91CC\u7684\u5143\u7D20"]}),"\n"]}),(0,i.jsx)(e.p,{children:"\u6570\u7EC4\u539F\u5B50\u7C7B\u4FDD\u8BC1\u5BF9\u6570\u7EC4\u4E2D\u6BCF\u4E2A\u5143\u7D20\u7684\u64CD\u4F5C\u90FD\u662F\u539F\u5B50\u6027\u7684\uFF0C\u4F46\u4E0D\u4FDD\u8BC1\u5BF9\u6574\u4E2A\u6570\u7EC4\u7684\u64CD\u4F5C\u662F\u539F\u5B50\u6027\u7684\u3002"})]})]}),"\n",(0,i.jsx)(e.h3,{id:"41-atomicintegerarray",children:"4.1 AtomicIntegerArray"}),"\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant Thread1 as \u7EBF\u7A0B1\n    participant AtomicIntArray as AtomicIntegerArray\n    participant Thread2 as \u7EBF\u7A0B2\n    \n    Note over AtomicIntArray: \u521D\u59CB\u503C: [0, 0, 0, 0, 0]\n    \n    Thread1->>AtomicIntArray: get(0) \u83B7\u53D6\u5143\u7D20\n    AtomicIntArray--\x3e>Thread1: \u8FD4\u56DE 0\n    Thread1->>Thread1: \u8BA1\u7B97\u65B0\u503C 10\n    \n    Thread2->>AtomicIntArray: get(1) \u83B7\u53D6\u5143\u7D20\n    AtomicIntArray--\x3e>Thread2: \u8FD4\u56DE 0\n    Thread2->>AtomicIntArray: compareAndSet(0, 10, 0, 1)\n    AtomicIntArray--\x3e>Thread2: \u6210\u529F\uFF0C\u8FD4\u56DEtrue\n    Note over AtomicIntArray: \u5F53\u524D\u503C: [10, 10, 0, 0, 0]\n    \n    Thread2->>AtomicIntArray: get(1) \u83B7\u53D6\u5143\u7D20\n    AtomicIntArray--\x3e>Thread2: \u8FD4\u56DE 10\n    Thread2->>AtomicIntArray: compareAndSet(10, 20, 1, 2)\n    AtomicIntArray--\x3e>Thread2: \u6210\u529F\uFF0C\u8FD4\u56DEtrue\n    Note over AtomicIntArray: \u5F53\u524D\u503C: [10, 20, 0, 0, 0]\n    \n    Thread1->>AtomicIntArray: get(0) \u83B7\u53D6\u5143\u7D20\n    AtomicIntArray--\x3e>Thread1: \u8FD4\u56DE 10\n    Thread1->>AtomicIntArray: incrementAndGet(0)\n    AtomicIntArray--\x3e>Thread1: \u8FD4\u56DE 11\n    Note over AtomicIntArray: \u5F53\u524D\u503C: [11, 20, 0, 0, 0]\n    \n    Thread2->>AtomicIntArray: get(1) \u83B7\u53D6\u5143\u7D20\n    AtomicIntArray--\x3e>Thread2: \u8FD4\u56DE 20\n    Thread2->>AtomicIntArray: getAndDecrement(1)\n    AtomicIntArray--\x3e>Thread2: \u8FD4\u56DE 20\n    Note over AtomicIntArray: \u5F53\u524D\u503C: [11, 19, 0, 0, 0]\n    \n    Thread1->>AtomicIntArray: get(0) \u83B7\u53D6\u5143\u7D20\n    AtomicIntArray--\x3e>Thread1: \u8FD4\u56DE 11\n    Thread1->>AtomicIntArray: addAndGet(0, 10)\n    AtomicIntArray--\x3e>Thread1: \u8FD4\u56DE 21\n    Note over AtomicIntArray: \u5F53\u524D\u503C: [21, 19, 0, 0, 0]\n    \n    Thread2->>AtomicIntArray: get(0) \u83B7\u53D6\u5143\u7D20\n    AtomicIntArray--\x3e>Thread2: \u8FD4\u56DE 21\n    Thread2->>AtomicIntArray: getAndAdd(0, 10)\n    AtomicIntArray--\x3e>Thread2: \u8FD4\u56DE 21\n    Note over AtomicIntArray: \u5F53\u524D\u503C: [21, 19, 0, 0, 0]"}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(l.A,{value:"atomic_int_array_basic",label:"\u57FA\u672C\u64CD\u4F5C",default:!0,children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicIntegerArray;\n\n// \u521B\u5EFAAtomicIntegerArray\nAtomicIntegerArray array = new AtomicIntegerArray(5); // \u9ED8\u8BA4\u503C\u4E3A0\nAtomicIntegerArray initializedArray = new AtomicIntegerArray(new int[]{1, 2, 3, 4, 5}); // \u521D\u59CB\u503C\n\n// \u83B7\u53D6\u5143\u7D20\nint value = array.get(0); // 0\nSystem.out.println("array[0]: " + value);\n\n// \u8BBE\u7F6E\u5143\u7D20\narray.set(0, 10);\nSystem.out.println("array[0] after set: " + array.get(0)); // 10\n\n// \u539F\u5B50\u9012\u589E/\u9012\u51CF\nint prev = array.getAndIncrement(1); // \u8FD4\u56DE2, array[1]\u53D8\u4E3A3\nint next = array.incrementAndGet(1); // array[1]\u53D8\u4E3A4, \u8FD4\u56DE4\n\nprev = array.getAndDecrement(1); // \u8FD4\u56DE4, array[1]\u53D8\u4E3A3\nnext = array.decrementAndGet(1); // array[1]\u53D8\u4E3A2, \u8FD4\u56DE2\n\n// \u539F\u5B50\u52A0\u6CD5/\u51CF\u6CD5\nprev = array.getAndAdd(2, 15); // \u8FD4\u56DE3, array[2]\u53D8\u4E3A18\nnext = array.addAndGet(2, 10); // array[2]\u53D8\u4E3A28, \u8FD4\u56DE28\n\n// \u6BD4\u8F83\u5E76\u8BBE\u7F6E\nboolean success = array.compareAndSet(2, 28, 30); // \u5982\u679C\u5F53\u524D\u503C\u662F28\uFF0C\u5219\u8BBE\u4E3A30\nSystem.out.println("CAS\u6210\u529F: " + success + ", array[2]: " + array.get(2)); // true, array[2]: 30\n'})})}),(0,i.jsx)(l.A,{value:"atomic_int_array_batch",label:"\u6279\u91CF\u64CD\u4F5C",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicIntegerArray;\n\n// \u521B\u5EFAAtomicIntegerArray\nAtomicIntegerArray array = new AtomicIntegerArray(5);\n\n// \u6279\u91CF\u9012\u589E\narray.getAndAdd(0, 10); // array[0]\u53D8\u4E3A10\narray.getAndAdd(1, 20); // array[1]\u53D8\u4E3A20\narray.getAndAdd(2, 30); // array[2]\u53D8\u4E3A30\n\n// \u6279\u91CF\u9012\u51CF\narray.getAndDecrement(3); // array[3]\u53D8\u4E3A-1\narray.getAndDecrement(4); // array[4]\u53D8\u4E3A-2\n\n// \u6279\u91CF\u52A0\u6CD5\narray.addAndGet(0, 5); // array[0]\u53D8\u4E3A15\narray.addAndGet(1, 10); // array[1]\u53D8\u4E3A30\narray.addAndGet(2, 15); // array[2]\u53D8\u4E3A45\n\n// \u6279\u91CF\u6BD4\u8F83\u5E76\u8BBE\u7F6E\nboolean[] successFlags = new boolean[5];\nsuccessFlags[0] = array.compareAndSet(0, 15, 20); // false\nsuccessFlags[1] = array.compareAndSet(1, 30, 35); // true\nsuccessFlags[2] = array.compareAndSet(2, 45, 50); // true\nsuccessFlags[3] = array.compareAndSet(3, -1, 0); // true\nsuccessFlags[4] = array.compareAndSet(4, -2, -3); // true\n\nSystem.out.println("\u6279\u91CF\u64CD\u4F5C\u540E\u6570\u7EC4: " + array);\nfor (int i = 0; i < successFlags.length; i++) {\n    System.out.println("array[" + i + "] CAS\u6210\u529F: " + successFlags[i]);\n}\n'})})}),(0,i.jsx)(l.A,{value:"atomic_int_array_example",label:"\u8BA1\u6570\u5668\u6570\u7EC4\u793A\u4F8B",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicIntegerArray;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.TimeUnit;\n\n/**\n * \u4F7F\u7528AtomicIntegerArray\u5B9E\u73B0\u5E76\u53D1\u8BA1\u6570\u5668\u6570\u7EC4\n */\npublic class AtomicCounterArray {\n    private final AtomicIntegerArray counters;\n    \n    public AtomicCounterArray(int size) {\n        this.counters = new AtomicIntegerArray(size);\n    }\n    \n    /**\n     * \u9012\u589E\u6307\u5B9A\u7D22\u5F15\u7684\u8BA1\u6570\u5668\n     */\n    public void increment(int index) {\n        counters.incrementAndGet(index);\n    }\n    \n    /**\n     * \u83B7\u53D6\u6307\u5B9A\u7D22\u5F15\u7684\u8BA1\u6570\u5668\u503C\n     */\n    public int get(int index) {\n        return counters.get(index);\n    }\n    \n    /**\n     * \u6279\u91CF\u9012\u589E\u591A\u4E2A\u8BA1\u6570\u5668\n     */\n    public void batchIncrement(int[] indices, int increment) {\n        for (int i : indices) {\n            counters.addAndGet(i, increment);\n        }\n    }\n    \n    /**\n     * \u6279\u91CF\u83B7\u53D6\u591A\u4E2A\u8BA1\u6570\u5668\u503C\n     */\n    public int[] getBatch(int[] indices) {\n        int[] values = new int[indices.length];\n        for (int i = 0; i < indices.length; i++) {\n            values[i] = counters.get(indices[i]);\n        }\n        return values;\n    }\n    \n    /**\n     * \u91CD\u7F6E\u6307\u5B9A\u7D22\u5F15\u7684\u8BA1\u6570\u5668\n     */\n    public void reset(int index) {\n        counters.set(index, 0);\n    }\n    \n    /**\n     * \u6279\u91CF\u91CD\u7F6E\u591A\u4E2A\u8BA1\u6570\u5668\n     */\n    public void resetBatch(int[] indices) {\n        for (int i : indices) {\n            counters.set(i, 0);\n        }\n    }\n    \n    public static void main(String[] args) throws InterruptedException {\n        final AtomicCounterArray counterArray = new AtomicCounterArray(10);\n        ExecutorService executor = Executors.newFixedThreadPool(10);\n        \n        // \u521B\u5EFA10\u4E2A\u4EFB\u52A1\uFF0C\u6BCF\u4E2A\u4EFB\u52A1\u9012\u589E\u6570\u7EC4\u4E2D10\u4E2A\u968F\u673A\u7D22\u5F15\u7684\u8BA1\u6570\u56681000\u6B21\n        for (int i = 0; i < 10; i++) {\n            executor.submit(() -> {\n                int[] indices = new int[10];\n                for (int j = 0; j < indices.length; j++) {\n                    indices[j] = (int) (Math.random() * 10); // \u968F\u673A\u7D22\u5F15\n                }\n                for (int k = 0; k < 1000; k++) {\n                    counterArray.increment(indices[k % indices.length]); // \u9012\u589E\u968F\u673A\u7D22\u5F15\n                }\n            });\n        }\n        \n        executor.shutdown();\n        executor.awaitTermination(10, TimeUnit.SECONDS);\n        \n        // \u8F93\u51FA\u6700\u7EC8\u8BA1\u6570\n        System.out.println("\u6700\u7EC8\u8BA1\u6570\u6570\u7EC4: " + Arrays.toString(counterArray.getBatch(new int[]{0, 1, 2, 3, 4, 5, 6, 7, 8, 9})));\n    }\n}\n'})})}),(0,i.jsx)(l.A,{value:"atomic_int_array_bitmap",label:"\u4F4D\u56FE\u5B9E\u73B0",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicIntegerArray;\nimport java.util.Arrays;\n\n/**\n * \u4F7F\u7528AtomicIntegerArray\u5B9E\u73B0\u4F4D\u56FE\n */\npublic class AtomicBitmap {\n    private final AtomicIntegerArray bits;\n    private final int size;\n    \n    public AtomicBitmap(int size) {\n        this.size = size;\n        // \u786E\u4FDD\u6570\u7EC4\u5927\u5C0F\u662F32\u7684\u500D\u6570\uFF0C\u6216\u8005\u5411\u4E0A\u53D6\u6574\n        this.bits = new AtomicIntegerArray((size + 31) / 32 * 32);\n    }\n    \n    /**\n     * \u8BBE\u7F6E\u4F4D\n     */\n    public void set(int index) {\n        if (index < 0 || index >= size) {\n            throw new IndexOutOfBoundsException("Index out of bounds: " + index);\n        }\n        \n        int arrayIndex = index / 32;\n        int bitIndex = index % 32;\n        int mask = 1 << bitIndex;\n        \n        while (true) {\n            int current = bits.get(arrayIndex);\n            int updated = current | mask;\n            if (bits.compareAndSet(arrayIndex, current, updated)) {\n                break;\n            }\n        }\n    }\n    \n    /**\n     * \u6E05\u9664\u4F4D\n     */\n    public void clear(int index) {\n        if (index < 0 || index >= size) {\n            throw new IndexOutOfBoundsException("Index out of bounds: " + index);\n        }\n        \n        int arrayIndex = index / 32;\n        int bitIndex = index % 32;\n        int mask = ~(1 << bitIndex);\n        \n        while (true) {\n            int current = bits.get(arrayIndex);\n            int updated = current & mask;\n            if (bits.compareAndSet(arrayIndex, current, updated)) {\n                break;\n            }\n        }\n    }\n    \n    /**\n     * \u83B7\u53D6\u4F4D\n     */\n    public boolean get(int index) {\n        if (index < 0 || index >= size) {\n            throw new IndexOutOfBoundsException("Index out of bounds: " + index);\n        }\n        \n        int arrayIndex = index / 32;\n        int bitIndex = index % 32;\n        int mask = 1 << bitIndex;\n        \n        return (bits.get(arrayIndex) & mask) != 0;\n    }\n    \n    /**\n     * \u83B7\u53D6\u4F4D\u56FE\u5927\u5C0F\n     */\n    public int size() {\n        return size;\n    }\n    \n    /**\n     * \u83B7\u53D6\u4F4D\u56FE\u6570\u7EC4\n     */\n    public AtomicIntegerArray getBits() {\n        return bits;\n    }\n    \n    @Override\n    public String toString() {\n        StringBuilder sb = new StringBuilder();\n        for (int i = 0; i < size; i++) {\n            sb.append(get(i) ? 1 : 0);\n            if ((i + 1) % 8 == 0) sb.append(" ");\n            if ((i + 1) % 32 == 0) sb.append("\\n");\n        }\n        return sb.toString();\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(e.h2,{id:"5-\u5B57\u6BB5\u66F4\u65B0\u5668",children:"5. \u5B57\u6BB5\u66F4\u65B0\u5668"}),"\n",(0,i.jsx)(e.h3,{id:"51-\u5B57\u6BB5\u66F4\u65B0\u5668\u6982\u8FF0",children:"5.1 \u5B57\u6BB5\u66F4\u65B0\u5668\u6982\u8FF0"}),"\n",(0,i.jsx)(e.p,{children:"\u5B57\u6BB5\u66F4\u65B0\u5668\u5141\u8BB8\u539F\u5B50\u6027\u5730\u66F4\u65B0\u5BF9\u8C61\u7684volatile\u5B57\u6BB5\uFF0C\u65E0\u9700\u5C06\u6574\u4E2A\u5BF9\u8C61\u58F0\u660E\u4E3A\u539F\u5B50\u7C7B\u3002"}),"\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant Thread1 as \u7EBF\u7A0B1\n    participant AtomicFieldUpdater as AtomicFieldUpdater\n    participant TargetObject as \u76EE\u6807\u5BF9\u8C61\n    \n    Note over TargetObject: \u521D\u59CB\u503C: 100\n    \n    Thread1->>TargetObject: \u83B7\u53D6\u5F53\u524D\u503C\n    TargetObject--\x3e>Thread1: \u8FD4\u56DE 100\n    Thread1->>Thread1: \u8BA1\u7B97\u65B0\u503C 101\n    \n    Thread1->>AtomicFieldUpdater: compareAndSet(100, 101)\n    AtomicFieldUpdater--\x3e>Thread1: \u6210\u529F\uFF0C\u8FD4\u56DEtrue\n    Note over TargetObject: \u5F53\u524D\u503C: 101\n    \n    Thread1->>TargetObject: \u83B7\u53D6\u5F53\u524D\u503C\n    TargetObject--\x3e>Thread1: \u8FD4\u56DE 101\n    Thread1->>AtomicFieldUpdater: compareAndSet(101, 102)\n    AtomicFieldUpdater--\x3e>Thread1: \u6210\u529F\uFF0C\u8FD4\u56DEtrue\n    Note over TargetObject: \u5F53\u524D\u503C: 102\n    \n    Thread1->>TargetObject: \u83B7\u53D6\u5F53\u524D\u503C\n    TargetObject--\x3e>Thread1: \u8FD4\u56DE 102\n    Thread1->>AtomicFieldUpdater: compareAndSet(102, 103)\n    AtomicFieldUpdater--\x3e>Thread1: \u6210\u529F\uFF0C\u8FD4\u56DEtrue\n    Note over TargetObject: \u5F53\u524D\u503C: 103"}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(l.A,{value:"atomic_field_updater_basic",label:"\u57FA\u672C\u4F7F\u7528",default:!0,children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicIntegerFieldUpdater;\nimport java.util.concurrent.atomic.AtomicLongFieldUpdater;\nimport java.util.concurrent.atomic.AtomicReferenceFieldUpdater;\n\n// \u5047\u8BBE\u6709\u4E00\u4E2A\u7C7B\u9700\u8981\u539F\u5B50\u66F4\u65B0\u5176int\u5B57\u6BB5\npublic class AtomicFieldUpdaterExample {\n    public static class Counter {\n        public volatile int count = 0;\n        \n        // \u4F7F\u7528AtomicIntegerFieldUpdater\n        private static final AtomicIntegerFieldUpdater<Counter> UPDATER =\n            AtomicIntegerFieldUpdater.newUpdater(Counter.class, "count");\n        \n        public void increment() {\n            UPDATER.incrementAndGet(this);\n        }\n        \n        public int getCount() {\n            return UPDATER.get(this);\n        }\n        \n        public boolean compareAndSet(int expect, int update) {\n            return UPDATER.compareAndSet(this, expect, update);\n        }\n    }\n    \n    public static void main(String[] args) {\n        Counter counter = new Counter();\n        \n        // \u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u9012\u589E\u8BA1\u6570\u5668\n        for (int i = 0; i < 10; i++) {\n            new Thread(() -> {\n                for (int j = 0; j < 1000; j++) {\n                    counter.increment();\n                }\n            }).start();\n        }\n        \n        try {\n            Thread.sleep(1000); // \u7B49\u5F85\u6240\u6709\u7EBF\u7A0B\u5B8C\u6210\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt();\n        }\n        \n        System.out.println("\u6700\u7EC8\u8BA1\u6570: " + counter.getCount());\n    }\n}\n'})})}),(0,i.jsx)(l.A,{value:"atomic_field_updater_example",label:"\u793A\u4F8B",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicIntegerFieldUpdater;\nimport java.util.concurrent.atomic.AtomicLongFieldUpdater;\nimport java.util.concurrent.atomic.AtomicReferenceFieldUpdater;\n\n// \u5047\u8BBE\u6709\u4E00\u4E2A\u7C7B\u9700\u8981\u539F\u5B50\u66F4\u65B0\u5176int\u5B57\u6BB5\npublic class AtomicFieldUpdaterExample {\n    public static class Counter {\n        public volatile int count = 0;\n        \n        // \u4F7F\u7528AtomicIntegerFieldUpdater\n        private static final AtomicIntegerFieldUpdater<Counter> UPDATER =\n            AtomicIntegerFieldUpdater.newUpdater(Counter.class, "count");\n        \n        public void increment() {\n            UPDATER.incrementAndGet(this);\n        }\n        \n        public int getCount() {\n            return UPDATER.get(this);\n        }\n        \n        public boolean compareAndSet(int expect, int update) {\n            return UPDATER.compareAndSet(this, expect, update);\n        }\n    }\n    \n    public static void main(String[] args) {\n        Counter counter = new Counter();\n        \n        // \u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u9012\u589E\u8BA1\u6570\u5668\n        for (int i = 0; i < 10; i++) {\n            new Thread(() -> {\n                for (int j = 0; j < 1000; j++) {\n                    counter.increment();\n                }\n            }).start();\n        }\n        \n        try {\n            Thread.sleep(1000); // \u7B49\u5F85\u6240\u6709\u7EBF\u7A0B\u5B8C\u6210\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt();\n        }\n        \n        System.out.println("\u6700\u7EC8\u8BA1\u6570: " + counter.getCount());\n    }\n}\n'})})}),(0,i.jsx)(l.A,{value:"atomic_field_updater_limitations",label:"\u9650\u5236\u6761\u4EF6",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicIntegerFieldUpdater;\nimport java.util.concurrent.atomic.AtomicLongFieldUpdater;\nimport java.util.concurrent.atomic.AtomicReferenceFieldUpdater;\n\n// \u5047\u8BBE\u6709\u4E00\u4E2A\u7C7B\u9700\u8981\u539F\u5B50\u66F4\u65B0\u5176int\u5B57\u6BB5\npublic class AtomicFieldUpdaterExample {\n    public static class Counter {\n        public volatile int count = 0;\n        \n        // \u4F7F\u7528AtomicIntegerFieldUpdater\n        private static final AtomicIntegerFieldUpdater<Counter> UPDATER =\n            AtomicIntegerFieldUpdater.newUpdater(Counter.class, "count");\n        \n        public void increment() {\n            UPDATER.incrementAndGet(this);\n        }\n        \n        public int getCount() {\n            return UPDATER.get(this);\n        }\n        \n        public boolean compareAndSet(int expect, int update) {\n            return UPDATER.compareAndSet(this, expect, update);\n        }\n    }\n    \n    public static void main(String[] args) {\n        Counter counter = new Counter();\n        \n        // \u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u9012\u589E\u8BA1\u6570\u5668\n        for (int i = 0; i < 10; i++) {\n            new Thread(() -> {\n                for (int j = 0; j < 1000; j++) {\n                    counter.increment();\n                }\n            }).start();\n        }\n        \n        try {\n            Thread.sleep(1000); // \u7B49\u5F85\u6240\u6709\u7EBF\u7A0B\u5B8C\u6210\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt();\n        }\n        \n        System.out.println("\u6700\u7EC8\u8BA1\u6570: " + counter.getCount());\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(e.h2,{id:"6-\u539F\u5B50\u7C7B\u6700\u4F73\u5B9E\u8DF5",children:"6. \u539F\u5B50\u7C7B\u6700\u4F73\u5B9E\u8DF5"}),"\n",(0,i.jsx)(e.h3,{id:"61-\u4F7F\u7528\u5EFA\u8BAE",children:"6.1 \u4F7F\u7528\u5EFA\u8BAE"}),"\n",(0,i.jsxs)(e.admonition,{title:"\u6838\u5FC3\u539F\u5219",type:"tip",children:[(0,i.jsx)(e.p,{children:"\u4F7F\u7528\u539F\u5B50\u7C7B\u65F6\u9700\u8981\u8003\u8651\u4EE5\u4E0B\u56E0\u7D20\uFF1A"}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6027\u80FD\u8981\u6C42"}),"\uFF1A\u539F\u5B50\u7C7B\u9002\u5408\u9AD8\u5E76\u53D1\u3001\u4F4E\u7ADE\u4E89\u573A\u666F"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u529F\u80FD\u9700\u6C42"}),"\uFF1A\u6839\u636E\u5177\u4F53\u9700\u6C42\u9009\u62E9\u5408\u9002\u7684\u539F\u5B50\u7C7B"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"ABA\u95EE\u9898"}),"\uFF1A\u9700\u8981\u7248\u672C\u63A7\u5236\u65F6\u4F7F\u7528AtomicStampedReference"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5185\u5B58\u5F00\u9500"}),"\uFF1A\u539F\u5B50\u7C7B\u6BD4\u666E\u901A\u53D8\u91CF\u5360\u7528\u66F4\u591A\u5185\u5B58"]}),"\n"]})]}),"\n",(0,i.jsx)(e.h3,{id:"62-\u6027\u80FD\u4F18\u5316",children:"6.2 \u6027\u80FD\u4F18\u5316"}),"\n",(0,i.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant Thread1 as \u7EBF\u7A0B1\n    participant AtomicInteger as AtomicInteger\n    participant Thread2 as \u7EBF\u7A0B2\n    \n    Note over AtomicInteger: \u521D\u59CB\u503C: 100\n    \n    Thread1->>AtomicInteger: get() \u83B7\u53D6\u5F53\u524D\u503C\n    AtomicInteger--\x3e>Thread1: \u8FD4\u56DE 100\n    Thread1->>Thread1: \u8BA1\u7B97\u65B0\u503C 101\n    \n    Thread2->>AtomicInteger: get() \u83B7\u53D6\u5F53\u524D\u503C\n    AtomicInteger--\x3e>Thread2: \u8FD4\u56DE 100\n    Thread2->>AtomicInteger: compareAndSet(100, 101)\n    AtomicInteger--\x3e>Thread2: \u5931\u8D25\uFF0C\u8FD4\u56DEfalse\n    Note over Thread2: \u9700\u8981\u91CD\u8BD5\u6216\u5904\u7406\u5931\u8D25"}),"\n",(0,i.jsxs)(c.A,{children:[(0,i.jsx)(l.A,{value:"atomic_optimization_basic",label:"\u57FA\u672C\u4F18\u5316",default:!0,children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"import java.util.concurrent.atomic.AtomicInteger;\n\npublic class AtomicClassOptimization {\n    private final AtomicInteger counter = new AtomicInteger(0);\n    \n    /**\n     * \u51CF\u5C11CAS\u5931\u8D25\n     */\n    public void optimizedIncrement() {\n        while (true) {\n            int current = counter.get();\n            int next = current + 1;\n            if (counter.compareAndSet(current, next)) {\n                break;\n            }\n            // \u53EF\u4EE5\u6DFB\u52A0\u9000\u907F\u7B56\u7565\n            Thread.yield();\n        }\n    }\n    \n    /**\n     * \u907F\u514D\u8FC7\u5EA6\u4F7F\u7528\n     */\n    public static class AvoidOveruse {\n        // \u4E0D\u63A8\u8350\uFF1A\u8FC7\u5EA6\u4F7F\u7528\u539F\u5B50\u7C7B\n        private final AtomicInteger x = new AtomicInteger(0);\n        private final AtomicInteger y = new AtomicInteger(0);\n        private final AtomicInteger z = new AtomicInteger(0);\n        \n        // \u63A8\u8350\uFF1A\u4F7F\u7528\u590D\u5408\u5BF9\u8C61\n        public static class Point {\n            private volatile int x, y, z;\n            \n            public synchronized void setCoordinates(int x, int y, int z) {\n                this.x = x;\n                this.y = y;\n                this.z = z;\n            }\n            \n            public synchronized int[] getCoordinates() {\n                return new int[]{x, y, z};\n            }\n        }\n    }\n}\n"})})}),(0,i.jsx)(l.A,{value:"atomic_optimization_performance",label:"\u6027\u80FD\u4F18\u5316",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicInteger;\nimport java.util.concurrent.atomic.AtomicLong;\nimport java.util.concurrent.atomic.AtomicBoolean;\nimport java.util.concurrent.atomic.AtomicReference;\nimport java.util.concurrent.atomic.AtomicStampedReference;\nimport java.util.concurrent.atomic.AtomicMarkableReference;\nimport java.util.concurrent.atomic.AtomicIntegerArray;\nimport java.util.concurrent.atomic.AtomicLongArray;\nimport java.util.concurrent.atomic.AtomicReferenceArray;\nimport java.util.concurrent.atomic.AtomicIntegerFieldUpdater;\nimport java.util.concurrent.atomic.AtomicLongFieldUpdater;\nimport java.util.concurrent.atomic.AtomicReferenceFieldUpdater;\n\npublic class AtomicClassOptimization {\n    private final AtomicInteger counter = new AtomicInteger(0);\n    private final AtomicLong longCounter = new AtomicLong(0);\n    private final AtomicBoolean booleanFlag = new AtomicBoolean(false);\n    private final AtomicReference<String> stringRef = new AtomicReference<>("initial");\n    private final AtomicStampedReference<String> stampedRef = new AtomicStampedReference<>("A", 0);\n    private final AtomicMarkableReference<String> markableRef = new AtomicMarkableReference<>("data", false);\n    private final AtomicIntegerArray intArray = new AtomicIntegerArray(5);\n    private final AtomicLongArray longArray = new AtomicLongArray(5);\n    private final AtomicReferenceArray<String> refArray = new AtomicReferenceArray<>(5);\n    private final AtomicIntegerFieldUpdater<AtomicClassOptimization> intUpdater =\n        AtomicIntegerFieldUpdater.newUpdater(AtomicClassOptimization.class, "counter");\n    private final AtomicLongFieldUpdater<AtomicClassOptimization> longUpdater =\n        AtomicLongFieldUpdater.newUpdater(AtomicClassOptimization.class, "longCounter");\n    private final AtomicReferenceFieldUpdater<AtomicClassOptimization, String> refUpdater =\n        AtomicReferenceFieldUpdater.newUpdater(AtomicClassOptimization.class, String.class, "stringRef");\n    \n    /**\n     * \u51CF\u5C11CAS\u5931\u8D25\n     */\n    public void optimizedIncrement() {\n        while (true) {\n            int current = counter.get();\n            int next = current + 1;\n            if (counter.compareAndSet(current, next)) {\n                break;\n            }\n            // \u53EF\u4EE5\u6DFB\u52A0\u9000\u907F\u7B56\u7565\n            Thread.yield();\n        }\n    }\n    \n    /**\n     * \u907F\u514D\u8FC7\u5EA6\u4F7F\u7528\n     */\n    public static class AvoidOveruse {\n        // \u4E0D\u63A8\u8350\uFF1A\u8FC7\u5EA6\u4F7F\u7528\u539F\u5B50\u7C7B\n        private final AtomicInteger x = new AtomicInteger(0);\n        private final AtomicInteger y = new AtomicInteger(0);\n        private final AtomicInteger z = new AtomicInteger(0);\n        \n        // \u63A8\u8350\uFF1A\u4F7F\u7528\u590D\u5408\u5BF9\u8C61\n        public static class Point {\n            private volatile int x, y, z;\n            \n            public synchronized void setCoordinates(int x, int y, int z) {\n                this.x = x;\n                this.y = y;\n                this.z = z;\n            }\n            \n            public synchronized int[] getCoordinates() {\n                return new int[]{x, y, z};\n            }\n        }\n    }\n}\n'})})}),(0,i.jsx)(l.A,{value:"atomic_optimization_common_pitfalls",label:"\u5E38\u89C1\u9677\u9631",children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicInteger;\nimport java.util.concurrent.atomic.AtomicLong;\nimport java.util.concurrent.atomic.AtomicBoolean;\nimport java.util.concurrent.atomic.AtomicReference;\nimport java.util.concurrent.atomic.AtomicStampedReference;\nimport java.util.concurrent.atomic.AtomicMarkableReference;\nimport java.util.concurrent.atomic.AtomicIntegerArray;\nimport java.util.concurrent.atomic.AtomicLongArray;\nimport java.util.concurrent.atomic.AtomicReferenceArray;\nimport java.util.concurrent.atomic.AtomicIntegerFieldUpdater;\nimport java.util.concurrent.atomic.AtomicLongFieldUpdater;\nimport java.util.concurrent.atomic.AtomicReferenceFieldUpdater;\n\npublic class AtomicClassOptimization {\n    private final AtomicInteger counter = new AtomicInteger(0);\n    private final AtomicLong longCounter = new AtomicLong(0);\n    private final AtomicBoolean booleanFlag = new AtomicBoolean(false);\n    private final AtomicReference<String> stringRef = new AtomicReference<>("initial");\n    private final AtomicStampedReference<String> stampedRef = new AtomicStampedReference<>("A", 0);\n    private final AtomicMarkableReference<String> markableRef = new AtomicMarkableReference<>("data", false);\n    private final AtomicIntegerArray intArray = new AtomicIntegerArray(5);\n    private final AtomicLongArray longArray = new AtomicLongArray(5);\n    private final AtomicReferenceArray<String> refArray = new AtomicReferenceArray<>(5);\n    private final AtomicIntegerFieldUpdater<AtomicClassOptimization> intUpdater =\n        AtomicIntegerFieldUpdater.newUpdater(AtomicClassOptimization.class, "counter");\n    private final AtomicLongFieldUpdater<AtomicClassOptimization> longUpdater =\n        AtomicLongFieldUpdater.newUpdater(AtomicClassOptimization.class, "longCounter");\n    private final AtomicReferenceFieldUpdater<AtomicClassOptimization, String> refUpdater =\n        AtomicReferenceFieldUpdater.newUpdater(AtomicClassOptimization.class, String.class, "stringRef");\n    \n    /**\n     * \u51CF\u5C11CAS\u5931\u8D25\n     */\n    public void optimizedIncrement() {\n        while (true) {\n            int current = counter.get();\n            int next = current + 1;\n            if (counter.compareAndSet(current, next)) {\n                break;\n            }\n            // \u53EF\u4EE5\u6DFB\u52A0\u9000\u907F\u7B56\u7565\n            Thread.yield();\n        }\n    }\n    \n    /**\n     * \u907F\u514D\u8FC7\u5EA6\u4F7F\u7528\n     */\n    public static class AvoidOveruse {\n        // \u4E0D\u63A8\u8350\uFF1A\u8FC7\u5EA6\u4F7F\u7528\u539F\u5B50\u7C7B\n        private final AtomicInteger x = new AtomicInteger(0);\n        private final AtomicInteger y = new AtomicInteger(0);\n        private final AtomicInteger z = new AtomicInteger(0);\n        \n        // \u63A8\u8350\uFF1A\u4F7F\u7528\u590D\u5408\u5BF9\u8C61\n        public static class Point {\n            private volatile int x, y, z;\n            \n            public synchronized void setCoordinates(int x, int y, int z) {\n                this.x = x;\n                this.y = y;\n                this.z = z;\n            }\n            \n            public synchronized int[] getCoordinates() {\n                return new int[]{x, y, z};\n            }\n        }\n    }\n}\n'})})})]}),"\n",(0,i.jsx)(e.h2,{id:"7-\u603B\u7ED3",children:"7. \u603B\u7ED3"}),"\n",(0,i.jsx)(e.p,{children:"\u539F\u5B50\u7C7B\u662FJava\u5E76\u53D1\u7F16\u7A0B\u4E2D\u7684\u91CD\u8981\u5DE5\u5177\uFF0C\u5B83\u4EEC\u63D0\u4F9B\u4E86\u9AD8\u6027\u80FD\u3001\u65E0\u963B\u585E\u7684\u7EBF\u7A0B\u5B89\u5168\u64CD\u4F5C\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"71-\u5173\u952E\u8981\u70B9",children:"7.1 \u5173\u952E\u8981\u70B9"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"CAS\u673A\u5236"}),"\uFF1A\u6BD4\u8F83\u5E76\u4EA4\u6362\uFF0C\u65E0\u9501\u7B97\u6CD5\u7684\u57FA\u7840"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u539F\u5B50\u7C7B\u5206\u7C7B"}),"\uFF1A\u57FA\u672C\u7C7B\u578B\u3001\u5F15\u7528\u7C7B\u578B\u3001\u6570\u7EC4\u7C7B\u578B\u3001\u5B57\u6BB5\u66F4\u65B0\u5668"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"ABA\u95EE\u9898"}),"\uFF1A\u901A\u8FC7\u7248\u672C\u53F7\u6216\u6807\u8BB0\u89E3\u51B3"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6027\u80FD\u4F18\u5316"}),"\uFF1A\u51CF\u5C11CAS\u5931\u8D25\u3001\u907F\u514D\u8FC7\u5EA6\u4F7F\u7528"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"72-\u9009\u62E9\u5EFA\u8BAE",children:"7.2 \u9009\u62E9\u5EFA\u8BAE"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u573A\u666F"}),(0,i.jsx)(e.th,{children:"\u63A8\u8350\u539F\u5B50\u7C7B"}),(0,i.jsx)(e.th,{children:"\u539F\u56E0"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u7B80\u5355\u8BA1\u6570\u5668"})}),(0,i.jsx)(e.td,{children:"AtomicInteger/AtomicLong"}),(0,i.jsx)(e.td,{children:"\u6027\u80FD\u9AD8\uFF0C\u4F7F\u7528\u7B80\u5355"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u5BF9\u8C61\u5F15\u7528"})}),(0,i.jsx)(e.td,{children:"AtomicReference"}),(0,i.jsx)(e.td,{children:"\u652F\u6301\u6CDB\u578B\uFF0C\u529F\u80FD\u4E30\u5BCC"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u9700\u8981\u7248\u672C\u63A7\u5236"})}),(0,i.jsx)(e.td,{children:"AtomicStampedReference"}),(0,i.jsx)(e.td,{children:"\u89E3\u51B3ABA\u95EE\u9898"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u9700\u8981\u6807\u8BB0"})}),(0,i.jsx)(e.td,{children:"AtomicMarkableReference"}),(0,i.jsx)(e.td,{children:"\u652F\u6301\u5E03\u5C14\u6807\u8BB0"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u6570\u7EC4\u64CD\u4F5C"})}),(0,i.jsx)(e.td,{children:"AtomicIntegerArray\u7B49"}),(0,i.jsx)(e.td,{children:"\u539F\u5B50\u6570\u7EC4\u64CD\u4F5C"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u5B57\u6BB5\u66F4\u65B0"})}),(0,i.jsx)(e.td,{children:"\u5B57\u6BB5\u66F4\u65B0\u5668"}),(0,i.jsx)(e.td,{children:"\u65E0\u9700\u4FEE\u6539\u7C7B\u7ED3\u6784"})]})]})]}),"\n",(0,i.jsx)(e.h3,{id:"73-\u5B66\u4E60\u5EFA\u8BAE",children:"7.3 \u5B66\u4E60\u5EFA\u8BAE"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u7406\u89E3\u539F\u7406"}),"\uFF1A\u6DF1\u5165\u7406\u89E3CAS\u673A\u5236\u7684\u5DE5\u4F5C\u539F\u7406"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5B9E\u8DF5\u9A8C\u8BC1"}),"\uFF1A\u901A\u8FC7\u7F16\u5199\u4EE3\u7801\u9A8C\u8BC1\u4E0D\u540C\u539F\u5B50\u7C7B\u7684\u6548\u679C"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6027\u80FD\u6D4B\u8BD5"}),"\uFF1A\u5BF9\u6BD4\u539F\u5B50\u7C7B\u4E0E\u540C\u6B65\u673A\u5236\u7684\u6027\u80FD\u5DEE\u5F02"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u573A\u666F\u9009\u62E9"}),"\uFF1A\u6839\u636E\u5177\u4F53\u9700\u6C42\u9009\u62E9\u5408\u9002\u7684\u539F\u5B50\u7C7B"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u901A\u8FC7\u6DF1\u5165\u7406\u89E3\u548C\u719F\u7EC3\u8FD0\u7528\u8FD9\u4E9B\u539F\u5B50\u7C7B\u6280\u672F\uFF0C\u6211\u4EEC\u80FD\u591F\u6784\u5EFA\u51FA\u66F4\u52A0\u9AD8\u6548\u3001\u5065\u58EE\u548C\u53EF\u7EF4\u62A4\u7684Java\u5E76\u53D1\u5E94\u7528\u7A0B\u5E8F\u3002"})]})}function h(n={}){let{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(p,{...n})}):p(n)}}}]);