"use strict";(self.webpackChunkfullstack_dev_blog=self.webpackChunkfullstack_dev_blog||[]).push([["99283"],{41471:function(e,n,r){r.r(n),r.d(n,{metadata:()=>i,default:()=>d,frontMatter:()=>l,contentTitle:()=>s,toc:()=>u,assets:()=>c});var i=JSON.parse('{"id":"backend/microservices/circuit-breaker","title":"\u670D\u52A1\u7194\u65AD\u4E0E\u964D\u7EA7\u8BE6\u89E3","description":"\u6DF1\u5165\u7406\u89E3\u5FAE\u670D\u52A1\u7194\u65AD\u5668\u7684\u5DE5\u4F5C\u539F\u7406\u3001\u5B9E\u73B0\u65B9\u6848\u4E0E\u6700\u4F73\u5B9E\u8DF5","source":"@site/docs/backend/microservices/circuit-breaker.mdx","sourceDirName":"backend/microservices","slug":"/backend/microservices/circuit-breaker","permalink":"/docs/backend/microservices/circuit-breaker","draft":false,"unlisted":false,"editUrl":"https://github.com/MasterLiu93/blog-web/tree/main/docs/backend/microservices/circuit-breaker.mdx","tags":[],"version":"current","lastUpdatedBy":"Laby","lastUpdatedAt":1754524800000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"\u670D\u52A1\u7194\u65AD\u4E0E\u964D\u7EA7\u8BE6\u89E3","description":"\u6DF1\u5165\u7406\u89E3\u5FAE\u670D\u52A1\u7194\u65AD\u5668\u7684\u5DE5\u4F5C\u539F\u7406\u3001\u5B9E\u73B0\u65B9\u6848\u4E0E\u6700\u4F73\u5B9E\u8DF5","authors":["Laby"],"last_update":{"date":"2025-08-07T00:00:00.000Z","author":"Laby"}},"sidebar":"tutorialSidebar","previous":{"title":"API\u7F51\u5173\u8BE6\u89E3","permalink":"/docs/backend/microservices/api-gateway"},"next":{"title":"\u914D\u7F6E\u4E2D\u5FC3\u8BE6\u89E3","permalink":"/docs/backend/microservices/config-center"}}'),t=r(74848),a=r(28453);let l={sidebar_position:3,title:"\u670D\u52A1\u7194\u65AD\u4E0E\u964D\u7EA7\u8BE6\u89E3",description:"\u6DF1\u5165\u7406\u89E3\u5FAE\u670D\u52A1\u7194\u65AD\u5668\u7684\u5DE5\u4F5C\u539F\u7406\u3001\u5B9E\u73B0\u65B9\u6848\u4E0E\u6700\u4F73\u5B9E\u8DF5",authors:["Laby"],last_update:{date:new Date("2025-08-07T00:00:00.000Z"),author:"Laby"}},s="\u670D\u52A1\u7194\u65AD\u4E0E\u964D\u7EA7\u8BE6\u89E3",c={},u=[{value:"1. \u7194\u65AD\u5668\u57FA\u7840\u6982\u5FF5",id:"1-\u7194\u65AD\u5668\u57FA\u7840\u6982\u5FF5",level:2},{value:"1.1 \u4EC0\u4E48\u662F\u7194\u65AD\u5668\uFF1F",id:"11-\u4EC0\u4E48\u662F\u7194\u65AD\u5668",level:3},{value:"\u7194\u65AD\u5668\u7684\u6838\u5FC3\u601D\u60F3",id:"\u7194\u65AD\u5668\u7684\u6838\u5FC3\u601D\u60F3",level:4},{value:"1.2 \u7194\u65AD\u5668\u7684\u4E09\u79CD\u72B6\u6001",id:"12-\u7194\u65AD\u5668\u7684\u4E09\u79CD\u72B6\u6001",level:3},{value:"\u72B6\u6001\u8F6C\u6362\u56FE",id:"\u72B6\u6001\u8F6C\u6362\u56FE",level:4},{value:"\u72B6\u6001\u8BE6\u7EC6\u8BF4\u660E",id:"\u72B6\u6001\u8BE6\u7EC6\u8BF4\u660E",level:4},{value:"1.3 \u7194\u65AD\u5668\u7684\u4F18\u52BF\u4E0E\u6311\u6218",id:"13-\u7194\u65AD\u5668\u7684\u4F18\u52BF\u4E0E\u6311\u6218",level:3},{value:"\u6838\u5FC3\u4F18\u52BF",id:"\u6838\u5FC3\u4F18\u52BF",level:4},{value:"\u4E3B\u8981\u6311\u6218",id:"\u4E3B\u8981\u6311\u6218",level:4},{value:"2. Resilience4j \u6846\u67B6\u8BE6\u89E3",id:"2-resilience4j-\u6846\u67B6\u8BE6\u89E3",level:2},{value:"2.1 Resilience4j \u6838\u5FC3\u7EC4\u4EF6",id:"21-resilience4j-\u6838\u5FC3\u7EC4\u4EF6",level:3},{value:"\u6838\u5FC3\u7EC4\u4EF6\u67B6\u6784",id:"\u6838\u5FC3\u7EC4\u4EF6\u67B6\u6784",level:4},{value:"2.2 Resilience4j \u4F7F\u7528\u793A\u4F8B",id:"22-resilience4j-\u4F7F\u7528\u793A\u4F8B",level:3},{value:"\u57FA\u7840\u4F7F\u7528\u793A\u4F8B",id:"\u57FA\u7840\u4F7F\u7528\u793A\u4F8B",level:4},{value:"\u6CE8\u89E3\u65B9\u5F0F\u4F7F\u7528",id:"\u6CE8\u89E3\u65B9\u5F0F\u4F7F\u7528",level:4},{value:"2.3 Resilience4j \u914D\u7F6E\u8BE6\u89E3",id:"23-resilience4j-\u914D\u7F6E\u8BE6\u89E3",level:3},{value:"\u914D\u7F6E\u6587\u4EF6",id:"\u914D\u7F6E\u6587\u4EF6",level:4},{value:"\u914D\u7F6E\u7C7B",id:"\u914D\u7F6E\u7C7B",level:4},{value:"3. \u76D1\u63A7\u89C2\u6D4B\u4E0E\u6700\u4F73\u5B9E\u8DF5",id:"3-\u76D1\u63A7\u89C2\u6D4B\u4E0E\u6700\u4F73\u5B9E\u8DF5",level:2},{value:"3.1 \u76D1\u63A7\u89C2\u6D4B\u4F53\u7CFB",id:"31-\u76D1\u63A7\u89C2\u6D4B\u4F53\u7CFB",level:3},{value:"\u76D1\u63A7\u6307\u6807\u6536\u96C6",id:"\u76D1\u63A7\u6307\u6807\u6536\u96C6",level:4},{value:"Prometheus\u76D1\u63A7\u914D\u7F6E",id:"prometheus\u76D1\u63A7\u914D\u7F6E",level:4},{value:"3.2 \u6700\u4F73\u5B9E\u8DF5\u4E0E\u8BBE\u8BA1\u6A21\u5F0F",id:"32-\u6700\u4F73\u5B9E\u8DF5\u4E0E\u8BBE\u8BA1\u6A21\u5F0F",level:3},{value:"\u964D\u7EA7\u7B56\u7565\u8BBE\u8BA1",id:"\u964D\u7EA7\u7B56\u7565\u8BBE\u8BA1",level:4},{value:"\u914D\u7F6E\u6700\u4F73\u5B9E\u8DF5",id:"\u914D\u7F6E\u6700\u4F73\u5B9E\u8DF5",level:4},{value:"3.3 \u5E38\u89C1\u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848",id:"33-\u5E38\u89C1\u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848",level:3},{value:"\u95EE\u9898\u8BCA\u65AD\u4E0E\u89E3\u51B3",id:"\u95EE\u9898\u8BCA\u65AD\u4E0E\u89E3\u51B3",level:4},{value:"4. \u9762\u8BD5\u9898\u7CBE\u9009",id:"4-\u9762\u8BD5\u9898\u7CBE\u9009",level:2},{value:"4.1 \u57FA\u7840\u6982\u5FF5\u9898",id:"41-\u57FA\u7840\u6982\u5FF5\u9898",level:3},{value:"Q1: \u4EC0\u4E48\u662F\u7194\u65AD\u5668\u6A21\u5F0F\uFF1F\u5B83\u7684\u6838\u5FC3\u601D\u60F3\u662F\u4EC0\u4E48\uFF1F",id:"q1-\u4EC0\u4E48\u662F\u7194\u65AD\u5668\u6A21\u5F0F\u5B83\u7684\u6838\u5FC3\u601D\u60F3\u662F\u4EC0\u4E48",level:4},{value:"Q2: \u7194\u65AD\u5668\u7684\u4E09\u79CD\u72B6\u6001\u662F\u5982\u4F55\u8F6C\u6362\u7684\uFF1F",id:"q2-\u7194\u65AD\u5668\u7684\u4E09\u79CD\u72B6\u6001\u662F\u5982\u4F55\u8F6C\u6362\u7684",level:4},{value:"Q3: Resilience4j\u4E0EHystrix\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F",id:"q3-resilience4j\u4E0Ehystrix\u7684\u533A\u522B\u662F\u4EC0\u4E48",level:4},{value:"4.2 \u5B9E\u8DF5\u9898",id:"42-\u5B9E\u8DF5\u9898",level:3},{value:"Q4: \u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u5408\u9002\u7684\u964D\u7EA7\u7B56\u7565\uFF1F",id:"q4-\u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u5408\u9002\u7684\u964D\u7EA7\u7B56\u7565",level:4},{value:"Q5: \u5982\u4F55\u914D\u7F6E\u7194\u65AD\u5668\u53C2\u6570\uFF1F",id:"q5-\u5982\u4F55\u914D\u7F6E\u7194\u65AD\u5668\u53C2\u6570",level:4},{value:"4.3 \u6027\u80FD\u4F18\u5316\u9898",id:"43-\u6027\u80FD\u4F18\u5316\u9898",level:3},{value:"Q6: \u5982\u4F55\u4F18\u5316\u7194\u65AD\u5668\u7684\u6027\u80FD\uFF1F",id:"q6-\u5982\u4F55\u4F18\u5316\u7194\u65AD\u5668\u7684\u6027\u80FD",level:4},{value:"Q7: \u5982\u4F55\u5904\u7406\u7194\u65AD\u5668\u7684\u8BEF\u89E6\u53D1\u95EE\u9898\uFF1F",id:"q7-\u5982\u4F55\u5904\u7406\u7194\u65AD\u5668\u7684\u8BEF\u89E6\u53D1\u95EE\u9898",level:4},{value:"4.4 \u67B6\u6784\u8BBE\u8BA1\u9898",id:"44-\u67B6\u6784\u8BBE\u8BA1\u9898",level:3},{value:"Q8: \u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u9AD8\u53EF\u7528\u7684\u7194\u65AD\u5668\u7CFB\u7EDF\uFF1F",id:"q8-\u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u9AD8\u53EF\u7528\u7684\u7194\u65AD\u5668\u7CFB\u7EDF",level:4},{value:"Q9: \u7194\u65AD\u5668\u4E0E\u9650\u6D41\u5668\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F",id:"q9-\u7194\u65AD\u5668\u4E0E\u9650\u6D41\u5668\u7684\u533A\u522B\u662F\u4EC0\u4E48",level:4},{value:"4.5 \u76D1\u63A7\u8FD0\u7EF4\u9898",id:"45-\u76D1\u63A7\u8FD0\u7EF4\u9898",level:3},{value:"Q10: \u5982\u4F55\u76D1\u63A7\u7194\u65AD\u5668\u7684\u5065\u5EB7\u72B6\u51B5\uFF1F",id:"q10-\u5982\u4F55\u76D1\u63A7\u7194\u65AD\u5668\u7684\u5065\u5EB7\u72B6\u51B5",level:4}];function o(e){let n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"\u670D\u52A1\u7194\u65AD\u4E0E\u964D\u7EA7\u8BE6\u89E3",children:"\u670D\u52A1\u7194\u65AD\u4E0E\u964D\u7EA7\u8BE6\u89E3"})}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u5FAE\u670D\u52A1\u7CFB\u7EDF\u4E2D\uFF0C\u670D\u52A1\u95F4\u7684\u4F9D\u8D56\u5173\u7CFB\u590D\u6742\uFF0C\u5355\u4E2A\u670D\u52A1\u7684\u6545\u969C\u53EF\u80FD\u4F1A\u50CF\u96EA\u5D29\u4E00\u6837\u8FC5\u901F\u4F20\u64AD\u5230\u6574\u4E2A\u7CFB\u7EDF\u3002\u7194\u65AD\u5668\u6A21\u5F0F\u662F\u89E3\u51B3\u8FD9\u7C7B\u95EE\u9898\u7684\u6709\u6548\u624B\u6BB5\uFF0C\u5B83\u901A\u8FC7\u5FEB\u901F\u5931\u8D25\u548C\u964D\u7EA7\u7B56\u7565\u6765\u4FDD\u62A4\u7CFB\u7EDF\u514D\u53D7\u7EA7\u8054\u6545\u969C\u7684\u5F71\u54CD\u3002"}),"\n",(0,t.jsx)(n.admonition,{title:"\u6838\u5FC3\u4EF7\u503C",type:"tip",children:(0,t.jsx)(n.p,{children:"\u7194\u65AD\u5668 = \u5FEB\u901F\u5931\u8D25 + \u6545\u969C\u9694\u79BB + \u81EA\u52A8\u6062\u590D + \u964D\u7EA7\u4FDD\u62A4 + \u7CFB\u7EDF\u7A33\u5B9A"})}),"\n",(0,t.jsx)(n.h2,{id:"1-\u7194\u65AD\u5668\u57FA\u7840\u6982\u5FF5",children:"1. \u7194\u65AD\u5668\u57FA\u7840\u6982\u5FF5"}),"\n",(0,t.jsx)(n.h3,{id:"11-\u4EC0\u4E48\u662F\u7194\u65AD\u5668",children:"1.1 \u4EC0\u4E48\u662F\u7194\u65AD\u5668\uFF1F"}),"\n",(0,t.jsx)(n.p,{children:"\u7194\u65AD\u5668\u6A21\u5F0F\u6765\u6E90\u4E8E\u7535\u8DEF\u4E2D\u7684\u4FDD\u9669\u4E1D\u6982\u5FF5\uFF0C\u5F53\u7535\u8DEF\u8FC7\u8F7D\u65F6\uFF0C\u4FDD\u9669\u4E1D\u4F1A\u7194\u65AD\u4EE5\u4FDD\u62A4\u6574\u4E2A\u7535\u8DEF\u7CFB\u7EDF\u3002\u5728\u8F6F\u4EF6\u7CFB\u7EDF\u4E2D\uFF0C\u7194\u65AD\u5668\u540C\u6837\u8D77\u5230\u4FDD\u62A4\u4F5C\u7528\uFF0C\u5F53\u4F9D\u8D56\u7684\u670D\u52A1\u51FA\u73B0\u6545\u969C\u65F6\uFF0C\u7194\u65AD\u5668\u4F1A\u5FEB\u901F\u5931\u8D25\uFF0C\u907F\u514D\u6545\u969C\u4F20\u64AD\u3002"}),"\n",(0,t.jsx)(n.h4,{id:"\u7194\u65AD\u5668\u7684\u6838\u5FC3\u601D\u60F3",children:"\u7194\u65AD\u5668\u7684\u6838\u5FC3\u601D\u60F3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="\u7194\u65AD\u5668\u6838\u5FC3\u601D\u60F3\u793A\u4F8B"',children:'public class CircuitBreakerConcept {\n    /*\n     * \u7194\u65AD\u5668\u7684\u6838\u5FC3\u601D\u60F3\n     * 1. \u76D1\u63A7\uFF1A\u6301\u7EED\u76D1\u63A7\u4F9D\u8D56\u670D\u52A1\u7684\u8C03\u7528\u7ED3\u679C\n     * 2. \u5224\u65AD\uFF1A\u6839\u636E\u5931\u8D25\u7387\u3001\u54CD\u5E94\u65F6\u95F4\u7B49\u6307\u6807\u5224\u65AD\u670D\u52A1\u72B6\u6001\n     * 3. \u4FDD\u62A4\uFF1A\u5F53\u670D\u52A1\u5F02\u5E38\u65F6\uFF0C\u5FEB\u901F\u5931\u8D25\uFF0C\u907F\u514D\u8D44\u6E90\u6D6A\u8D39\n     * 4. \u6062\u590D\uFF1A\u5F53\u670D\u52A1\u6062\u590D\u65F6\uFF0C\u9010\u6B65\u6062\u590D\u6B63\u5E38\u8C03\u7528\n     * 5. \u964D\u7EA7\uFF1A\u63D0\u4F9B\u964D\u7EA7\u7B56\u7565\uFF0C\u4FDD\u8BC1\u7CFB\u7EDF\u53EF\u7528\u6027\n     */\n    \n    // \u7194\u65AD\u5668\u72B6\u6001\u679A\u4E3E\n    public enum CircuitBreakerState {\n        CLOSED,     // \u5173\u95ED\u72B6\u6001\uFF1A\u6B63\u5E38\u5904\u7406\u8BF7\u6C42\n        OPEN,       // \u5F00\u542F\u72B6\u6001\uFF1A\u5FEB\u901F\u5931\u8D25\n        HALF_OPEN   // \u534A\u5F00\u72B6\u6001\uFF1A\u5141\u8BB8\u90E8\u5206\u8BF7\u6C42\u901A\u8FC7\n    }\n    \n    // \u7194\u65AD\u5668\u57FA\u672C\u7ED3\u6784\n    public class CircuitBreaker {\n        private CircuitBreakerState state = CircuitBreakerState.CLOSED;\n        private int failureCount = 0;\n        private int successCount = 0;\n        private long lastFailureTime = 0;\n        \n        // \u914D\u7F6E\u53C2\u6570\n        private final int failureThreshold;      // \u5931\u8D25\u9608\u503C\n        private final int successThreshold;      // \u6210\u529F\u9608\u503C\n        private final long timeout;              // \u8D85\u65F6\u65F6\u95F4\n        private final long resetTimeout;         // \u91CD\u7F6E\u8D85\u65F6\u65F6\u95F4\n        \n        public CircuitBreaker(int failureThreshold, int successThreshold, \n                             long timeout, long resetTimeout) {\n            this.failureThreshold = failureThreshold;\n            this.successThreshold = successThreshold;\n            this.timeout = timeout;\n            this.resetTimeout = resetTimeout;\n        }\n        \n        // \u6267\u884C\u65B9\u6CD5\n        public <T> T execute(Supplier<T> supplier) {\n            if (isOpen()) {\n                throw new CircuitBreakerOpenException("Circuit breaker is open");\n            }\n            \n            try {\n                T result = supplier.get();\n                onSuccess();\n                return result;\n            } catch (Exception e) {\n                onFailure();\n                throw e;\n            }\n        }\n        \n        // \u5224\u65AD\u662F\u5426\u5F00\u542F\n        private boolean isOpen() {\n            if (state == CircuitBreakerState.OPEN) {\n                if (System.currentTimeMillis() - lastFailureTime > resetTimeout) {\n                    state = CircuitBreakerState.HALF_OPEN;\n                    successCount = 0;\n                    return false;\n                }\n                return true;\n            }\n            return false;\n        }\n        \n        // \u6210\u529F\u5904\u7406\n        private void onSuccess() {\n            if (state == CircuitBreakerState.HALF_OPEN) {\n                if (++successCount >= successThreshold) {\n                    state = CircuitBreakerState.CLOSED;\n                    failureCount = 0;\n                }\n            }\n        }\n        \n        // \u5931\u8D25\u5904\u7406\n        private void onFailure() {\n            lastFailureTime = System.currentTimeMillis();\n            \n            if (state == CircuitBreakerState.CLOSED) {\n                if (++failureCount >= failureThreshold) {\n                    state = CircuitBreakerState.OPEN;\n                }\n            } else if (state == CircuitBreakerState.HALF_OPEN) {\n                state = CircuitBreakerState.OPEN;\n                successCount = 0;\n            }\n        }\n    }\n    \n    // \u7194\u65AD\u5668\u5F02\u5E38\n    public class CircuitBreakerOpenException extends RuntimeException {\n        public CircuitBreakerOpenException(String message) {\n            super(message);\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"12-\u7194\u65AD\u5668\u7684\u4E09\u79CD\u72B6\u6001",children:"1.2 \u7194\u65AD\u5668\u7684\u4E09\u79CD\u72B6\u6001"}),"\n",(0,t.jsx)(n.h4,{id:"\u72B6\u6001\u8F6C\u6362\u56FE",children:"\u72B6\u6001\u8F6C\u6362\u56FE"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u7194\u65AD\u5668\u72B6\u6001\u8F6C\u6362:\n\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u5931\u8D25\u6B21\u6570\u8FBE\u5230\u9608\u503C    \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   CLOSED    \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25B6 \u2502    OPEN     \u2502\n\u2502  (\u5173\u95ED\u72B6\u6001)  \u2502                       \u2502  (\u5F00\u542F\u72B6\u6001)  \u2502\n\u2502             \u2502 \u25C0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502             \u2502\n\u2502 \u6B63\u5E38\u5904\u7406\u8BF7\u6C42 \u2502    \u8D85\u65F6\u65F6\u95F4\u5230\u8FBE        \u2502  \u5FEB\u901F\u5931\u8D25    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502                                       \u2502\n       \u2502 \u6210\u529F\u6B21\u6570\u8FBE\u5230\u9608\u503C                       \u2502\n       \u25BC                                       \u2502\n\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                               \u2502\n\u2502 HALF_OPEN   \u2502 \u25C0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502 (\u534A\u5F00\u72B6\u6001)   \u2502\n\u2502             \u2502\n\u2502 \u5141\u8BB8\u90E8\u5206\u8BF7\u6C42 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(n.h4,{id:"\u72B6\u6001\u8BE6\u7EC6\u8BF4\u660E",children:"\u72B6\u6001\u8BE6\u7EC6\u8BF4\u660E"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="\u7194\u65AD\u5668\u72B6\u6001\u8BF4\u660E"',children:'public class CircuitBreakerStates {\n    /*\n     * \u7194\u65AD\u5668\u4E09\u79CD\u72B6\u6001\u8BE6\u89E3\n     * \n     * 1. CLOSED\uFF08\u5173\u95ED\u72B6\u6001\uFF09\n     *    - \u6B63\u5E38\u72B6\u6001\uFF0C\u6240\u6709\u8BF7\u6C42\u90FD\u4F1A\u6B63\u5E38\u5904\u7406\n     *    - \u6301\u7EED\u76D1\u63A7\u5931\u8D25\u7387\uFF0C\u5F53\u5931\u8D25\u6B21\u6570\u8FBE\u5230\u9608\u503C\u65F6\u8F6C\u6362\u4E3AOPEN\u72B6\u6001\n     *    - \u5931\u8D25\u8BA1\u6570\u5668\u4F1A\u8BB0\u5F55\u6BCF\u6B21\u5931\u8D25\n     * \n     * 2. OPEN\uFF08\u5F00\u542F\u72B6\u6001\uFF09\n     *    - \u4FDD\u62A4\u72B6\u6001\uFF0C\u6240\u6709\u8BF7\u6C42\u90FD\u4F1A\u5FEB\u901F\u5931\u8D25\n     *    - \u907F\u514D\u5BF9\u6545\u969C\u670D\u52A1\u7684\u65E0\u6548\u8C03\u7528\uFF0C\u8282\u7701\u8D44\u6E90\n     *    - \u7ECF\u8FC7\u4E00\u5B9A\u65F6\u95F4\u540E\u81EA\u52A8\u8F6C\u6362\u4E3AHALF_OPEN\u72B6\u6001\n     * \n     * 3. HALF_OPEN\uFF08\u534A\u5F00\u72B6\u6001\uFF09\n     *    - \u8BD5\u63A2\u72B6\u6001\uFF0C\u5141\u8BB8\u5C11\u91CF\u8BF7\u6C42\u901A\u8FC7\n     *    - \u5982\u679C\u8FD9\u4E9B\u8BF7\u6C42\u6210\u529F\uFF0C\u5219\u8F6C\u6362\u4E3ACLOSED\u72B6\u6001\n     *    - \u5982\u679C\u8FD9\u4E9B\u8BF7\u6C42\u5931\u8D25\uFF0C\u5219\u8F6C\u6362\u56DEOPEN\u72B6\u6001\n     */\n    \n    // \u5173\u95ED\u72B6\u6001\u5904\u7406\n    public class ClosedStateHandler {\n        public <T> T handle(Supplier<T> supplier) {\n            try {\n                T result = supplier.get();\n                // \u6210\u529F\uFF0C\u91CD\u7F6E\u5931\u8D25\u8BA1\u6570\n                resetFailureCount();\n                return result;\n            } catch (Exception e) {\n                // \u5931\u8D25\uFF0C\u589E\u52A0\u5931\u8D25\u8BA1\u6570\n                incrementFailureCount();\n                \n                // \u68C0\u67E5\u662F\u5426\u8FBE\u5230\u5931\u8D25\u9608\u503C\n                if (getFailureCount() >= getFailureThreshold()) {\n                    transitionToOpenState();\n                }\n                \n                throw e;\n            }\n        }\n    }\n    \n    // \u5F00\u542F\u72B6\u6001\u5904\u7406\n    public class OpenStateHandler {\n        public <T> T handle(Supplier<T> supplier) {\n            // \u76F4\u63A5\u629B\u51FA\u5F02\u5E38\uFF0C\u4E0D\u8C03\u7528\u5B9E\u9645\u670D\u52A1\n            throw new CircuitBreakerOpenException("Circuit breaker is open");\n        }\n        \n        // \u68C0\u67E5\u662F\u5426\u53EF\u4EE5\u8F6C\u6362\u4E3A\u534A\u5F00\u72B6\u6001\n        public boolean canTransitionToHalfOpen() {\n            return System.currentTimeMillis() - getLastFailureTime() > getResetTimeout();\n        }\n    }\n    \n    // \u534A\u5F00\u72B6\u6001\u5904\u7406\n    public class HalfOpenStateHandler {\n        public <T> T handle(Supplier<T> supplier) {\n            try {\n                T result = supplier.get();\n                // \u6210\u529F\uFF0C\u589E\u52A0\u6210\u529F\u8BA1\u6570\n                incrementSuccessCount();\n                \n                // \u68C0\u67E5\u662F\u5426\u8FBE\u5230\u6210\u529F\u9608\u503C\n                if (getSuccessCount() >= getSuccessThreshold()) {\n                    transitionToClosedState();\n                }\n                \n                return result;\n            } catch (Exception e) {\n                // \u5931\u8D25\uFF0C\u7ACB\u5373\u8F6C\u6362\u56DE\u5F00\u542F\u72B6\u6001\n                transitionToOpenState();\n                throw e;\n            }\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"13-\u7194\u65AD\u5668\u7684\u4F18\u52BF\u4E0E\u6311\u6218",children:"1.3 \u7194\u65AD\u5668\u7684\u4F18\u52BF\u4E0E\u6311\u6218"}),"\n",(0,t.jsx)(n.h4,{id:"\u6838\u5FC3\u4F18\u52BF",children:"\u6838\u5FC3\u4F18\u52BF"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="\u7194\u65AD\u5668\u4F18\u52BF\u793A\u4F8B"',children:'public class CircuitBreakerAdvantages {\n    /*\n     * \u7194\u65AD\u5668\u7684\u6838\u5FC3\u4F18\u52BF\n     * 1. \u5FEB\u901F\u5931\u8D25\uFF1A\u907F\u514D\u957F\u65F6\u95F4\u7B49\u5F85\u6545\u969C\u670D\u52A1\u54CD\u5E94\n     * 2. \u6545\u969C\u9694\u79BB\uFF1A\u9632\u6B62\u6545\u969C\u5728\u670D\u52A1\u95F4\u4F20\u64AD\n     * 3. \u81EA\u52A8\u6062\u590D\uFF1A\u670D\u52A1\u6062\u590D\u540E\u81EA\u52A8\u6062\u590D\u6B63\u5E38\u8C03\u7528\n     * 4. \u8D44\u6E90\u4FDD\u62A4\uFF1A\u907F\u514D\u8D44\u6E90\u6D6A\u8D39\u5728\u65E0\u6548\u8C03\u7528\u4E0A\n     * 5. \u7CFB\u7EDF\u7A33\u5B9A\uFF1A\u63D0\u9AD8\u6574\u4F53\u7CFB\u7EDF\u7684\u53EF\u7528\u6027\u548C\u7A33\u5B9A\u6027\n     */\n    \n    // \u5FEB\u901F\u5931\u8D25\u793A\u4F8B\n    public class FastFailureExample {\n        private final CircuitBreaker circuitBreaker;\n        \n        public FastFailureExample() {\n            this.circuitBreaker = new CircuitBreaker(5, 3, 5000, 30000);\n        }\n        \n        public String callService() {\n            return circuitBreaker.execute(() -> {\n                // \u6A21\u62DF\u8C03\u7528\u53EF\u80FD\u5931\u8D25\u7684\u670D\u52A1\n                if (Math.random() < 0.3) {\n                    throw new RuntimeException("Service unavailable");\n                }\n                return "Service response";\n            });\n        }\n        \n        // \u5F53\u670D\u52A1\u6545\u969C\u65F6\uFF0C\u7194\u65AD\u5668\u4F1A\u5FEB\u901F\u5931\u8D25\uFF0C\u907F\u514D\u957F\u65F6\u95F4\u7B49\u5F85\n        public void demonstrateFastFailure() {\n            try {\n                String result = callService();\n                System.out.println("Success: " + result);\n            } catch (CircuitBreakerOpenException e) {\n                System.out.println("Fast failure: " + e.getMessage());\n                // \u53EF\u4EE5\u7ACB\u5373\u8FD4\u56DE\u964D\u7EA7\u7ED3\u679C\uFF0C\u800C\u4E0D\u662F\u7B49\u5F85\u8D85\u65F6\n            }\n        }\n    }\n    \n    // \u6545\u969C\u9694\u79BB\u793A\u4F8B\n    public class FaultIsolationExample {\n        private final Map<String, CircuitBreaker> circuitBreakers = new HashMap<>();\n        \n        public void callMultipleServices() {\n            // \u6BCF\u4E2A\u670D\u52A1\u90FD\u6709\u72EC\u7ACB\u7684\u7194\u65AD\u5668\n            String userResult = callServiceWithCircuitBreaker("user-service", this::callUserService);\n            String orderResult = callServiceWithCircuitBreaker("order-service", this::callOrderService);\n            String paymentResult = callServiceWithCircuitBreaker("payment-service", this::callPaymentService);\n            \n            // \u5373\u4F7F\u67D0\u4E2A\u670D\u52A1\u6545\u969C\uFF0C\u5176\u4ED6\u670D\u52A1\u4ECD\u80FD\u6B63\u5E38\u5DE5\u4F5C\n            System.out.println("User: " + userResult);\n            System.out.println("Order: " + orderResult);\n            System.out.println("Payment: " + paymentResult);\n        }\n        \n        private <T> T callServiceWithCircuitBreaker(String serviceName, Supplier<T> serviceCall) {\n            CircuitBreaker circuitBreaker = circuitBreakers.computeIfAbsent(serviceName, \n                k -> new CircuitBreaker(5, 3, 5000, 30000));\n            \n            try {\n                return circuitBreaker.execute(serviceCall);\n            } catch (CircuitBreakerOpenException e) {\n                return getFallbackResult(serviceName);\n            }\n        }\n        \n        private String getFallbackResult(String serviceName) {\n            // \u8FD4\u56DE\u964D\u7EA7\u7ED3\u679C\n            return "Fallback result for " + serviceName;\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"\u4E3B\u8981\u6311\u6218",children:"\u4E3B\u8981\u6311\u6218"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="\u7194\u65AD\u5668\u6311\u6218\u793A\u4F8B"',children:'public class CircuitBreakerChallenges {\n    /*\n     * \u7194\u65AD\u5668\u9762\u4E34\u7684\u4E3B\u8981\u6311\u6218\n     * 1. \u914D\u7F6E\u590D\u6742\uFF1A\u9700\u8981\u5408\u7406\u8BBE\u7F6E\u5404\u79CD\u9608\u503C\u53C2\u6570\n     * 2. \u72B6\u6001\u7BA1\u7406\uFF1A\u9700\u8981\u6B63\u786E\u7BA1\u7406\u7194\u65AD\u5668\u72B6\u6001\u8F6C\u6362\n     * 3. \u76D1\u63A7\u56F0\u96BE\uFF1A\u9700\u8981\u76D1\u63A7\u7194\u65AD\u5668\u7684\u72B6\u6001\u548C\u6027\u80FD\n     * 4. \u964D\u7EA7\u7B56\u7565\uFF1A\u9700\u8981\u8BBE\u8BA1\u5408\u9002\u7684\u964D\u7EA7\u7B56\u7565\n     * 5. \u6D4B\u8BD5\u56F0\u96BE\uFF1A\u96BE\u4EE5\u6A21\u62DF\u5404\u79CD\u6545\u969C\u573A\u666F\n     */\n    \n    // \u914D\u7F6E\u590D\u6742\u6027\n    public class ConfigurationComplexity {\n        /*\n         * \u7194\u65AD\u5668\u914D\u7F6E\u53C2\u6570\u4F17\u591A\uFF0C\u9700\u8981\u6839\u636E\u5B9E\u9645\u60C5\u51B5\u8C03\u6574\n         * - failureThreshold: \u5931\u8D25\u9608\u503C\uFF0C\u8BBE\u7F6E\u8FC7\u4F4E\u5BB9\u6613\u8BEF\u89E6\u53D1\uFF0C\u8BBE\u7F6E\u8FC7\u9AD8\u54CD\u5E94\u6162\n         * - successThreshold: \u6210\u529F\u9608\u503C\uFF0C\u5F71\u54CD\u6062\u590D\u901F\u5EA6\n         * - timeout: \u8D85\u65F6\u65F6\u95F4\uFF0C\u5F71\u54CD\u7528\u6237\u4F53\u9A8C\n         * - resetTimeout: \u91CD\u7F6E\u8D85\u65F6\u65F6\u95F4\uFF0C\u5F71\u54CD\u6545\u969C\u6062\u590D\n         */\n        \n        public CircuitBreaker createOptimizedCircuitBreaker(String serviceName) {\n            // \u6839\u636E\u670D\u52A1\u7279\u70B9\u8BBE\u7F6E\u4E0D\u540C\u7684\u914D\u7F6E\n            switch (serviceName) {\n                case "user-service":\n                    // \u7528\u6237\u670D\u52A1\uFF0C\u5BF9\u53EF\u7528\u6027\u8981\u6C42\u9AD8\uFF0C\u8BBE\u7F6E\u8F83\u4F4E\u7684\u5931\u8D25\u9608\u503C\n                    return new CircuitBreaker(3, 2, 3000, 20000);\n                case "order-service":\n                    // \u8BA2\u5355\u670D\u52A1\uFF0C\u5BF9\u4E00\u81F4\u6027\u8981\u6C42\u9AD8\uFF0C\u8BBE\u7F6E\u8F83\u9AD8\u7684\u5931\u8D25\u9608\u503C\n                    return new CircuitBreaker(5, 3, 5000, 30000);\n                case "payment-service":\n                    // \u652F\u4ED8\u670D\u52A1\uFF0C\u5BF9\u5B89\u5168\u6027\u8981\u6C42\u9AD8\uFF0C\u8BBE\u7F6E\u4E25\u683C\u7684\u914D\u7F6E\n                    return new CircuitBreaker(2, 1, 2000, 15000);\n                default:\n                    return new CircuitBreaker(5, 3, 5000, 30000);\n            }\n        }\n    }\n    \n    // \u72B6\u6001\u7BA1\u7406\u590D\u6742\u6027\n    public class StateManagementComplexity {\n        /*\n         * \u7194\u65AD\u5668\u72B6\u6001\u7BA1\u7406\u9700\u8981\u8003\u8651\u7684\u95EE\u9898\n         * 1. \u5E76\u53D1\u5B89\u5168\uFF1A\u591A\u7EBF\u7A0B\u73AF\u5883\u4E0B\u7684\u72B6\u6001\u8F6C\u6362\n         * 2. \u72B6\u6001\u6301\u4E45\u5316\uFF1A\u91CD\u542F\u540E\u72B6\u6001\u6062\u590D\n         * 3. \u5206\u5E03\u5F0F\u73AF\u5883\uFF1A\u591A\u5B9E\u4F8B\u95F4\u7684\u72B6\u6001\u540C\u6B65\n         * 4. \u76D1\u63A7\u544A\u8B66\uFF1A\u72B6\u6001\u53D8\u5316\u7684\u53CA\u65F6\u901A\u77E5\n         */\n        \n        // \u7EBF\u7A0B\u5B89\u5168\u7684\u7194\u65AD\u5668\n        public class ThreadSafeCircuitBreaker {\n            private volatile CircuitBreakerState state = CircuitBreakerState.CLOSED;\n            private final AtomicInteger failureCount = new AtomicInteger(0);\n            private final AtomicInteger successCount = new AtomicInteger(0);\n            private volatile long lastFailureTime = 0;\n            \n            public synchronized void transitionToOpenState() {\n                state = CircuitBreakerState.OPEN;\n                lastFailureTime = System.currentTimeMillis();\n                // \u901A\u77E5\u76D1\u63A7\u7CFB\u7EDF\n                notifyStateChange("OPEN");\n            }\n            \n            public synchronized void transitionToClosedState() {\n                state = CircuitBreakerState.CLOSED;\n                failureCount.set(0);\n                // \u901A\u77E5\u76D1\u63A7\u7CFB\u7EDF\n                notifyStateChange("CLOSED");\n            }\n            \n            private void notifyStateChange(String newState) {\n                // \u53D1\u9001\u72B6\u6001\u53D8\u5316\u901A\u77E5\n                System.out.println("Circuit breaker state changed to: " + newState);\n            }\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.admonition,{title:"\u7194\u65AD\u5668\u8BBE\u8BA1\u539F\u5219",type:"info",children:(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u5FEB\u901F\u5931\u8D25"}),"\uFF1A\u5F53\u4F9D\u8D56\u670D\u52A1\u6545\u969C\u65F6\uFF0C\u5E94\u8BE5\u5FEB\u901F\u5931\u8D25\u800C\u4E0D\u662F\u7B49\u5F85\u8D85\u65F6"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u81EA\u52A8\u6062\u590D"}),"\uFF1A\u5F53\u4F9D\u8D56\u670D\u52A1\u6062\u590D\u65F6\uFF0C\u5E94\u8BE5\u81EA\u52A8\u6062\u590D\u6B63\u5E38\u8C03\u7528"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u964D\u7EA7\u4FDD\u62A4"}),"\uFF1A\u63D0\u4F9B\u5408\u9002\u7684\u964D\u7EA7\u7B56\u7565\uFF0C\u4FDD\u8BC1\u7CFB\u7EDF\u53EF\u7528\u6027"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u76D1\u63A7\u544A\u8B66"}),"\uFF1A\u5EFA\u7ACB\u5B8C\u5584\u7684\u76D1\u63A7\u4F53\u7CFB\uFF0C\u53CA\u65F6\u53D1\u73B0\u548C\u5904\u7406\u95EE\u9898"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u914D\u7F6E\u7075\u6D3B"}),"\uFF1A\u652F\u6301\u52A8\u6001\u914D\u7F6E\uFF0C\u9002\u5E94\u4E0D\u540C\u7684\u4E1A\u52A1\u573A\u666F"]}),"\n"]})}),"\n",(0,t.jsx)(n.h2,{id:"2-resilience4j-\u6846\u67B6\u8BE6\u89E3",children:"2. Resilience4j \u6846\u67B6\u8BE6\u89E3"}),"\n",(0,t.jsx)(n.h3,{id:"21-resilience4j-\u6838\u5FC3\u7EC4\u4EF6",children:"2.1 Resilience4j \u6838\u5FC3\u7EC4\u4EF6"}),"\n",(0,t.jsx)(n.p,{children:"Resilience4j\u662F\u4E00\u4E2A\u8F7B\u91CF\u7EA7\u7684\u5BB9\u9519\u5E93\uFF0C\u4E13\u4E3AJava 8\u548C\u51FD\u6570\u5F0F\u7F16\u7A0B\u8BBE\u8BA1\u3002\u5B83\u63D0\u4F9B\u4E86\u591A\u79CD\u5BB9\u9519\u6A21\u5F0F\uFF0C\u5305\u62EC\u7194\u65AD\u5668\u3001\u9650\u6D41\u5668\u3001\u91CD\u8BD5\u3001\u8D85\u65F6\u7B49\u3002"}),"\n",(0,t.jsx)(n.h4,{id:"\u6838\u5FC3\u7EC4\u4EF6\u67B6\u6784",children:"\u6838\u5FC3\u7EC4\u4EF6\u67B6\u6784"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="Resilience4j\u6838\u5FC3\u7EC4\u4EF6"',children:"public class Resilience4jComponents {\n    /*\n     * Resilience4j\u6838\u5FC3\u7EC4\u4EF6\n     * 1. CircuitBreaker\uFF1A\u7194\u65AD\u5668\uFF0C\u9632\u6B62\u7EA7\u8054\u6545\u969C\n     * 2. RateLimiter\uFF1A\u9650\u6D41\u5668\uFF0C\u63A7\u5236\u8BF7\u6C42\u901F\u7387\n     * 3. Bulkhead\uFF1A\u8231\u58C1\u9694\u79BB\uFF0C\u9650\u5236\u5E76\u53D1\u8C03\u7528\n     * 4. Retry\uFF1A\u91CD\u8BD5\u673A\u5236\uFF0C\u5904\u7406\u4E34\u65F6\u6545\u969C\n     * 5. TimeLimiter\uFF1A\u8D85\u65F6\u63A7\u5236\uFF0C\u907F\u514D\u957F\u65F6\u95F4\u7B49\u5F85\n     * 6. Cache\uFF1A\u7F13\u5B58\u673A\u5236\uFF0C\u63D0\u9AD8\u54CD\u5E94\u901F\u5EA6\n     */\n    \n    // \u7194\u65AD\u5668\u914D\u7F6E\n    public class CircuitBreakerConfig {\n        private final int slidingWindowSize;           // \u6ED1\u52A8\u7A97\u53E3\u5927\u5C0F\n        private final double failureRateThreshold;     // \u5931\u8D25\u7387\u9608\u503C\n        private final Duration waitDurationInOpenState; // \u5F00\u542F\u72B6\u6001\u7B49\u5F85\u65F6\u95F4\n        private final int permittedNumberOfCallsInHalfOpenState; // \u534A\u5F00\u72B6\u6001\u5141\u8BB8\u8C03\u7528\u6570\n        private final boolean automaticTransitionFromOpenToHalfOpenEnabled; // \u81EA\u52A8\u8F6C\u6362\n        \n        public CircuitBreakerConfig(int slidingWindowSize, double failureRateThreshold,\n                                   Duration waitDurationInOpenState,\n                                   int permittedNumberOfCallsInHalfOpenState) {\n            this.slidingWindowSize = slidingWindowSize;\n            this.failureRateThreshold = failureRateThreshold;\n            this.waitDurationInOpenState = waitDurationInOpenState;\n            this.permittedNumberOfCallsInHalfOpenState = permittedNumberOfCallsInHalfOpenState;\n            this.automaticTransitionFromOpenToHalfOpenEnabled = true;\n        }\n    }\n    \n    // \u9650\u6D41\u5668\u914D\u7F6E\n    public class RateLimiterConfig {\n        private final int limitForPeriod;              // \u5468\u671F\u5185\u9650\u5236\n        private final Duration limitRefreshPeriod;     // \u9650\u5236\u5237\u65B0\u5468\u671F\n        private final Duration timeoutDuration;        // \u8D85\u65F6\u65F6\u95F4\n        \n        public RateLimiterConfig(int limitForPeriod, Duration limitRefreshPeriod,\n                                Duration timeoutDuration) {\n            this.limitForPeriod = limitForPeriod;\n            this.limitRefreshPeriod = limitRefreshPeriod;\n            this.timeoutDuration = timeoutDuration;\n        }\n    }\n    \n    // \u8231\u58C1\u9694\u79BB\u914D\u7F6E\n    public class BulkheadConfig {\n        private final int maxConcurrentCalls;          // \u6700\u5927\u5E76\u53D1\u8C03\u7528\u6570\n        private final Duration maxWaitDuration;        // \u6700\u5927\u7B49\u5F85\u65F6\u95F4\n        \n        public BulkheadConfig(int maxConcurrentCalls, Duration maxWaitDuration) {\n            this.maxConcurrentCalls = maxConcurrentCalls;\n            this.maxWaitDuration = maxWaitDuration;\n        }\n    }\n    \n    // \u91CD\u8BD5\u914D\u7F6E\n    public class RetryConfig {\n        private final int maxAttempts;                 // \u6700\u5927\u91CD\u8BD5\u6B21\u6570\n        private final Duration waitDuration;           // \u7B49\u5F85\u65F6\u95F4\n        private final List<Class<? extends Throwable>> retryExceptions; // \u91CD\u8BD5\u5F02\u5E38\u7C7B\u578B\n        \n        public RetryConfig(int maxAttempts, Duration waitDuration,\n                          List<Class<? extends Throwable>> retryExceptions) {\n            this.maxAttempts = maxAttempts;\n            this.waitDuration = waitDuration;\n            this.retryExceptions = retryExceptions;\n        }\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"22-resilience4j-\u4F7F\u7528\u793A\u4F8B",children:"2.2 Resilience4j \u4F7F\u7528\u793A\u4F8B"}),"\n",(0,t.jsx)(n.h4,{id:"\u57FA\u7840\u4F7F\u7528\u793A\u4F8B",children:"\u57FA\u7840\u4F7F\u7528\u793A\u4F8B"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="Resilience4j\u57FA\u7840\u4F7F\u7528"',children:'@Service\npublic class ProductService {\n    \n    private final CircuitBreaker circuitBreaker;\n    private final RateLimiter rateLimiter;\n    private final Bulkhead bulkhead;\n    private final Retry retry;\n    private final TimeLimiter timeLimiter;\n    \n    public ProductService() {\n        // \u521B\u5EFA\u7194\u65AD\u5668\n        CircuitBreakerConfig circuitBreakerConfig = CircuitBreakerConfig.custom()\n            .slidingWindowSize(10)\n            .failureRateThreshold(50.0f)\n            .waitDurationInOpenState(Duration.ofSeconds(30))\n            .permittedNumberOfCallsInHalfOpenState(3)\n            .build();\n        \n        this.circuitBreaker = CircuitBreaker.of("product-service", circuitBreakerConfig);\n        \n        // \u521B\u5EFA\u9650\u6D41\u5668\n        RateLimiterConfig rateLimiterConfig = RateLimiterConfig.custom()\n            .limitForPeriod(10)\n            .limitRefreshPeriod(Duration.ofSeconds(1))\n            .timeoutDuration(Duration.ofSeconds(5))\n            .build();\n        \n        this.rateLimiter = RateLimiter.of("product-service", rateLimiterConfig);\n        \n        // \u521B\u5EFA\u8231\u58C1\u9694\u79BB\n        BulkheadConfig bulkheadConfig = BulkheadConfig.custom()\n            .maxConcurrentCalls(20)\n            .maxWaitDuration(Duration.ofSeconds(5))\n            .build();\n        \n        this.bulkhead = Bulkhead.of("product-service", bulkheadConfig);\n        \n        // \u521B\u5EFA\u91CD\u8BD5\n        RetryConfig retryConfig = RetryConfig.custom()\n            .maxAttempts(3)\n            .waitDuration(Duration.ofSeconds(1))\n            .retryExceptions(Arrays.asList(RuntimeException.class))\n            .build();\n        \n        this.retry = Retry.of("product-service", retryConfig);\n        \n        // \u521B\u5EFA\u8D85\u65F6\u63A7\u5236\n        this.timeLimiter = TimeLimiter.of("product-service", \n            TimeLimiterConfig.custom().timeoutDuration(Duration.ofSeconds(5)).build());\n    }\n    \n    // \u4F7F\u7528\u7194\u65AD\u5668\n    public Product getProduct(String id) {\n        return circuitBreaker.executeSupplier(() -> {\n            // \u8C03\u7528\u4E0B\u6E38\u670D\u52A1\n            return callProductService(id);\n        });\n    }\n    \n    // \u4F7F\u7528\u9650\u6D41\u5668\n    public List<Product> searchProducts(String keyword) {\n        return rateLimiter.executeSupplier(() -> {\n            // \u641C\u7D22\u5546\u54C1\n            return searchProductService(keyword);\n        });\n    }\n    \n    // \u4F7F\u7528\u8231\u58C1\u9694\u79BB\n    public void updateProduct(String id, Product product) {\n        bulkhead.executeRunnable(() -> {\n            // \u66F4\u65B0\u5546\u54C1\n            updateProductService(id, product);\n        });\n    }\n    \n    // \u4F7F\u7528\u91CD\u8BD5\n    public void createProduct(Product product) {\n        retry.executeRunnable(() -> {\n            // \u521B\u5EFA\u5546\u54C1\n            createProductService(product);\n        });\n    }\n    \n    // \u4F7F\u7528\u8D85\u65F6\u63A7\u5236\n    public CompletableFuture<Product> getProductAsync(String id) {\n        return timeLimiter.executeCompletionStage(\n            () -> CompletableFuture.supplyAsync(() -> callProductService(id))\n        );\n    }\n    \n    // \u7EC4\u5408\u4F7F\u7528\u591A\u4E2A\u7EC4\u4EF6\n    public Product getProductWithAllProtection(String id) {\n        return circuitBreaker.executeSupplier(() ->\n            rateLimiter.executeSupplier(() ->\n                bulkhead.executeSupplier(() ->\n                    retry.executeSupplier(() -> callProductService(id))\n                )\n            )\n        );\n    }\n    \n    // \u6A21\u62DF\u670D\u52A1\u8C03\u7528\n    private Product callProductService(String id) {\n        // \u6A21\u62DF\u7F51\u7EDC\u8C03\u7528\n        if (Math.random() < 0.3) {\n            throw new RuntimeException("Service unavailable");\n        }\n        return new Product(id, "Product " + id, 100.0);\n    }\n    \n    private List<Product> searchProductService(String keyword) {\n        // \u6A21\u62DF\u641C\u7D22\u670D\u52A1\n        return Arrays.asList(\n            new Product("1", "Product 1", 100.0),\n            new Product("2", "Product 2", 200.0)\n        );\n    }\n    \n    private void updateProductService(String id, Product product) {\n        // \u6A21\u62DF\u66F4\u65B0\u670D\u52A1\n        System.out.println("Updating product: " + id);\n    }\n    \n    private void createProductService(Product product) {\n        // \u6A21\u62DF\u521B\u5EFA\u670D\u52A1\n        System.out.println("Creating product: " + product.getName());\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"\u6CE8\u89E3\u65B9\u5F0F\u4F7F\u7528",children:"\u6CE8\u89E3\u65B9\u5F0F\u4F7F\u7528"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="Resilience4j\u6CE8\u89E3\u4F7F\u7528"',children:'@Service\npublic class AnnotatedProductService {\n    \n    @CircuitBreaker(name = "product-service", fallbackMethod = "getProductFallback")\n    @RateLimiter(name = "product-service")\n    @Bulkhead(name = "product-service")\n    @Retry(name = "product-service", fallbackMethod = "getProductFallback")\n    @TimeLimiter(name = "product-service")\n    public CompletableFuture<Product> getProduct(String id) {\n        return CompletableFuture.supplyAsync(() -> {\n            // \u6A21\u62DF\u8C03\u7528\u4E0B\u6E38\u670D\u52A1\n            if (Math.random() < 0.3) {\n                throw new RuntimeException("Service unavailable");\n            }\n            return new Product(id, "Product " + id, 100.0);\n        });\n    }\n    \n    // \u7194\u65AD\u5668\u964D\u7EA7\u65B9\u6CD5\n    public CompletableFuture<Product> getProductFallback(String id, Throwable ex) {\n        return CompletableFuture.completedFuture(\n            new Product(id, "Fallback Product", 0.0)\n        );\n    }\n    \n    // \u91CD\u8BD5\u964D\u7EA7\u65B9\u6CD5\n    public Product getProductFallback(String id, RuntimeException ex) {\n        return new Product(id, "Retry Fallback Product", 0.0);\n    }\n    \n    // \u7EC4\u5408\u4F7F\u7528\u591A\u4E2A\u6CE8\u89E3\n    @CircuitBreaker(name = "order-service", fallbackMethod = "createOrderFallback")\n    @RateLimiter(name = "order-service")\n    @Bulkhead(name = "order-service")\n    public Order createOrder(OrderRequest request) {\n        // \u521B\u5EFA\u8BA2\u5355\u903B\u8F91\n        if (Math.random() < 0.2) {\n            throw new RuntimeException("Order service unavailable");\n        }\n        return new Order(UUID.randomUUID().toString(), request.getProductId(), \n                        request.getQuantity(), 100.0);\n    }\n    \n    public Order createOrderFallback(OrderRequest request, Throwable ex) {\n        // \u964D\u7EA7\u903B\u8F91\uFF1A\u8FD4\u56DE\u9ED8\u8BA4\u8BA2\u5355\n        return new Order("fallback-order", request.getProductId(), \n                        request.getQuantity(), 0.0);\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"23-resilience4j-\u914D\u7F6E\u8BE6\u89E3",children:"2.3 Resilience4j \u914D\u7F6E\u8BE6\u89E3"}),"\n",(0,t.jsx)(n.h4,{id:"\u914D\u7F6E\u6587\u4EF6",children:"\u914D\u7F6E\u6587\u4EF6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="application.yml"',children:"resilience4j:\n  circuitbreaker:\n    instances:\n      product-service:\n        sliding-window-size: 20\n        failure-rate-threshold: 50\n        wait-duration-in-open-state: 30s\n        permitted-number-of-calls-in-half-open-state: 3\n        automatic-transition-from-open-to-half-open-enabled: true\n        record-exceptions:\n          - java.lang.RuntimeException\n          - java.io.IOException\n        ignore-exceptions:\n          - java.lang.IllegalArgumentException\n        sliding-window-type: COUNT_BASED\n        minimum-number-of-calls: 10\n        slow-call-rate-threshold: 100\n        slow-call-duration-threshold: 2s\n        \n      order-service:\n        sliding-window-size: 10\n        failure-rate-threshold: 30\n        wait-duration-in-open-state: 60s\n        permitted-number-of-calls-in-half-open-state: 2\n        record-exceptions:\n          - java.lang.RuntimeException\n        sliding-window-type: TIME_BASED\n        minimum-number-of-calls: 5\n        slow-call-rate-threshold: 50\n        slow-call-duration-threshold: 1s\n        \n      payment-service:\n        sliding-window-size: 5\n        failure-rate-threshold: 20\n        wait-duration-in-open-state: 120s\n        permitted-number-of-calls-in-half-open-state: 1\n        record-exceptions:\n          - java.lang.RuntimeException\n        sliding-window-type: COUNT_BASED\n        minimum-number-of-calls: 3\n        slow-call-rate-threshold: 30\n        slow-call-duration-threshold: 500ms\n  \n  ratelimiter:\n    instances:\n      product-service:\n        limit-for-period: 10\n        limit-refresh-period: 1s\n        timeout-duration: 5s\n        register-health-indicator: true\n        \n      order-service:\n        limit-for-period: 5\n        limit-refresh-period: 1s\n        timeout-duration: 10s\n        register-health-indicator: true\n        \n      payment-service:\n        limit-for-period: 2\n        limit-refresh-period: 1s\n        timeout-duration: 15s\n        register-health-indicator: true\n  \n  bulkhead:\n    instances:\n      product-service:\n        max-concurrent-calls: 20\n        max-wait-duration: 5s\n        register-health-indicator: true\n        \n      order-service:\n        max-concurrent-calls: 10\n        max-wait-duration: 10s\n        register-health-indicator: true\n        \n      payment-service:\n        max-concurrent-calls: 5\n        max-wait-duration: 15s\n        register-health-indicator: true\n  \n  retry:\n    instances:\n      product-service:\n        max-attempts: 3\n        wait-duration: 1s\n        enable-exponential-backoff: true\n        exponential-backoff-multiplier: 2\n        retry-exceptions:\n          - java.lang.RuntimeException\n          - java.io.IOException\n        ignore-exceptions:\n          - java.lang.IllegalArgumentException\n        \n      order-service:\n        max-attempts: 2\n        wait-duration: 2s\n        enable-exponential-backoff: true\n        exponential-backoff-multiplier: 1.5\n        retry-exceptions:\n          - java.lang.RuntimeException\n        \n      payment-service:\n        max-attempts: 1\n        wait-duration: 5s\n        enable-exponential-backoff: false\n        retry-exceptions:\n          - java.lang.RuntimeException\n  \n  timelimiter:\n    instances:\n      product-service:\n        timeout-duration: 5s\n        cancel-running-future: true\n        \n      order-service:\n        timeout-duration: 10s\n        cancel-running-future: true\n        \n      payment-service:\n        timeout-duration: 15s\n        cancel-running-future: true\n\n# \u76D1\u63A7\u914D\u7F6E\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: health,metrics,circuitbreakers,ratelimiters,bulkheads,retries\n  endpoint:\n    health:\n      show-details: always\n  metrics:\n    export:\n      prometheus:\n        enabled: true\n"})}),"\n",(0,t.jsx)(n.h4,{id:"\u914D\u7F6E\u7C7B",children:"\u914D\u7F6E\u7C7B"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="Resilience4j\u914D\u7F6E\u7C7B"',children:'@Configuration\npublic class Resilience4jConfiguration {\n    \n    // \u7194\u65AD\u5668\u914D\u7F6E\n    @Bean\n    public Customizer<Resilience4JCircuitBreakerFactory> defaultCustomizer() {\n        return factory -> factory.configureDefault(id -> new CircuitBreakerConfig.Builder()\n            .slidingWindowSize(10)\n            .failureRateThreshold(50)\n            .waitDurationInOpenState(Duration.ofSeconds(10))\n            .permittedNumberOfCallsInHalfOpenState(5)\n            .recordExceptions(RuntimeException.class, IOException.class)\n            .ignoreExceptions(IllegalArgumentException.class)\n            .slidingWindowType(CircuitBreakerConfig.SlidingWindowType.COUNT_BASED)\n            .minimumNumberOfCalls(5)\n            .slowCallRateThreshold(100)\n            .slowCallDurationThreshold(Duration.ofSeconds(2))\n            .build());\n    }\n    \n    // \u9650\u6D41\u5668\u914D\u7F6E\n    @Bean\n    public Customizer<Resilience4JRateLimiterFactory> rateLimiterCustomizer() {\n        return factory -> factory.configureDefault(id -> RateLimiterConfig.custom()\n            .limitForPeriod(10)\n            .limitRefreshPeriod(Duration.ofSeconds(1))\n            .timeoutDuration(Duration.ofSeconds(5))\n            .build());\n    }\n    \n    // \u8231\u58C1\u9694\u79BB\u914D\u7F6E\n    @Bean\n    public Customizer<Resilience4JBulkheadFactory> bulkheadCustomizer() {\n        return factory -> factory.configureDefault(id -> BulkheadConfig.custom()\n            .maxConcurrentCalls(20)\n            .maxWaitDuration(Duration.ofSeconds(5))\n            .build());\n    }\n    \n    // \u91CD\u8BD5\u914D\u7F6E\n    @Bean\n    public Customizer<Resilience4JRetryFactory> retryCustomizer() {\n        return factory -> factory.configureDefault(id -> RetryConfig.custom()\n            .maxAttempts(3)\n            .waitDuration(Duration.ofSeconds(1))\n            .enableExponentialBackoff()\n            .exponentialBackoffMultiplier(2)\n            .retryExceptions(RuntimeException.class, IOException.class)\n            .ignoreExceptions(IllegalArgumentException.class)\n            .build());\n    }\n    \n    // \u8D85\u65F6\u63A7\u5236\u914D\u7F6E\n    @Bean\n    public Customizer<Resilience4JTimeLimiterFactory> timeLimiterCustomizer() {\n        return factory -> factory.configureDefault(id -> TimeLimiterConfig.custom()\n            .timeoutDuration(Duration.ofSeconds(5))\n            .cancelRunningFuture(true)\n            .build());\n    }\n    \n    // \u4E8B\u4EF6\u76D1\u542C\u5668\n    @Bean\n    public CircuitBreakerRegistryCustomizer circuitBreakerRegistryCustomizer() {\n        return registry -> {\n            registry.getEventPublisher()\n                .onEntryAdded(entryAddedEvent -> {\n                    CircuitBreaker addedCircuitBreaker = entryAddedEvent.getAddedEntry();\n                    addedCircuitBreaker.getEventPublisher()\n                        .onStateTransition(event -> {\n                            log.info("Circuit breaker {} state changed from {} to {}",\n                                addedCircuitBreaker.getName(),\n                                event.getStateTransition().getFromState(),\n                                event.getStateTransition().getToState());\n                        })\n                        .onFailureRateExceeded(event -> {\n                            log.warn("Circuit breaker {} failure rate exceeded: {}%",\n                                addedCircuitBreaker.getName(),\n                                event.getFailureRate());\n                        })\n                        .onSlowCallRateExceeded(event -> {\n                            log.warn("Circuit breaker {} slow call rate exceeded: {}%",\n                                addedCircuitBreaker.getName(),\n                                event.getSlowCallRate());\n                        });\n                });\n        };\n    }\n}\n'})}),"\n",(0,t.jsx)(n.admonition,{title:"Resilience4j\u6700\u4F73\u5B9E\u8DF5",type:"tip",children:(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u5408\u7406\u914D\u7F6E"}),"\uFF1A\u6839\u636E\u670D\u52A1\u7279\u70B9\u8BBE\u7F6E\u5408\u9002\u7684\u9608\u503C\u548C\u8D85\u65F6\u65F6\u95F4"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u76D1\u63A7\u544A\u8B66"}),"\uFF1A\u5EFA\u7ACB\u5B8C\u5584\u7684\u76D1\u63A7\u4F53\u7CFB\uFF0C\u53CA\u65F6\u53D1\u73B0\u548C\u5904\u7406\u95EE\u9898"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u964D\u7EA7\u7B56\u7565"}),"\uFF1A\u4E3A\u6BCF\u4E2A\u670D\u52A1\u8BBE\u8BA1\u5408\u9002\u7684\u964D\u7EA7\u7B56\u7565"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u6D4B\u8BD5\u9A8C\u8BC1"}),"\uFF1A\u901A\u8FC7\u538B\u529B\u6D4B\u8BD5\u9A8C\u8BC1\u914D\u7F6E\u7684\u6709\u6548\u6027"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u6587\u6863\u7EF4\u62A4"}),"\uFF1A\u7EF4\u62A4\u5B8C\u6574\u7684\u914D\u7F6E\u6587\u6863\uFF0C\u4FBF\u4E8E\u56E2\u961F\u534F\u4F5C"]}),"\n"]})}),"\n",(0,t.jsx)(n.h2,{id:"3-\u76D1\u63A7\u89C2\u6D4B\u4E0E\u6700\u4F73\u5B9E\u8DF5",children:"3. \u76D1\u63A7\u89C2\u6D4B\u4E0E\u6700\u4F73\u5B9E\u8DF5"}),"\n",(0,t.jsx)(n.h3,{id:"31-\u76D1\u63A7\u89C2\u6D4B\u4F53\u7CFB",children:"3.1 \u76D1\u63A7\u89C2\u6D4B\u4F53\u7CFB"}),"\n",(0,t.jsx)(n.h4,{id:"\u76D1\u63A7\u6307\u6807\u6536\u96C6",children:"\u76D1\u63A7\u6307\u6807\u6536\u96C6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="\u76D1\u63A7\u6307\u6807\u6536\u96C6\u793A\u4F8B"',children:'public class MonitoringAndObservability {\n    \n    // \u7194\u65AD\u5668\u76D1\u63A7\u6307\u6807\n    @Component\n    public class CircuitBreakerMetrics {\n        \n        private final MeterRegistry meterRegistry;\n        private final Counter totalCalls;\n        private final Counter successfulCalls;\n        private final Counter failedCalls;\n        private final Counter notPermittedCalls;\n        private final Timer callDuration;\n        private final Gauge failureRate;\n        private final Gauge slowCallRate;\n        \n        public CircuitBreakerMetrics(MeterRegistry meterRegistry) {\n            this.meterRegistry = meterRegistry;\n            this.totalCalls = Counter.builder("circuitbreaker.calls.total")\n                .description("Total number of calls")\n                .register(meterRegistry);\n            this.successfulCalls = Counter.builder("circuitbreaker.calls.successful")\n                .description("Number of successful calls")\n                .register(meterRegistry);\n            this.failedCalls = Counter.builder("circuitbreaker.calls.failed")\n                .description("Number of failed calls")\n                .register(meterRegistry);\n            this.notPermittedCalls = Counter.builder("circuitbreaker.calls.not_permitted")\n                .description("Number of calls not permitted")\n                .register(meterRegistry);\n            this.callDuration = Timer.builder("circuitbreaker.calls.duration")\n                .description("Call duration")\n                .register(meterRegistry);\n            this.failureRate = Gauge.builder("circuitbreaker.failure_rate")\n                .description("Failure rate percentage")\n                .register(meterRegistry, this, CircuitBreakerMetrics::getFailureRate);\n            this.slowCallRate = Gauge.builder("circuitbreaker.slow_call_rate")\n                .description("Slow call rate percentage")\n                .register(meterRegistry, this, CircuitBreakerMetrics::getSlowCallRate);\n        }\n        \n        public void recordCall(String serviceName, boolean success, long duration, boolean permitted) {\n            totalCalls.increment(Tags.of("service", serviceName));\n            \n            if (permitted) {\n                if (success) {\n                    successfulCalls.increment(Tags.of("service", serviceName));\n                } else {\n                    failedCalls.increment(Tags.of("service", serviceName));\n                }\n                callDuration.record(duration, TimeUnit.MILLISECONDS, Tags.of("service", serviceName));\n            } else {\n                notPermittedCalls.increment(Tags.of("service", serviceName));\n            }\n        }\n        \n        private double getFailureRate() {\n            // \u8BA1\u7B97\u5931\u8D25\u7387\n            return 0.0; // \u5B9E\u9645\u5B9E\u73B0\u4E2D\u9700\u8981\u8BA1\u7B97\n        }\n        \n        private double getSlowCallRate() {\n            // \u8BA1\u7B97\u6162\u8C03\u7528\u7387\n            return 0.0; // \u5B9E\u9645\u5B9E\u73B0\u4E2D\u9700\u8981\u8BA1\u7B97\n        }\n    }\n    \n    // \u9650\u6D41\u5668\u76D1\u63A7\u6307\u6807\n    @Component\n    public class RateLimiterMetrics {\n        \n        private final MeterRegistry meterRegistry;\n        private final Counter permittedCalls;\n        private final Counter refusedCalls;\n        private final Timer waitDuration;\n        \n        public RateLimiterMetrics(MeterRegistry meterRegistry) {\n            this.meterRegistry = meterRegistry;\n            this.permittedCalls = Counter.builder("ratelimiter.calls.permitted")\n                .description("Number of permitted calls")\n                .register(meterRegistry);\n            this.refusedCalls = Counter.builder("ratelimiter.calls.refused")\n                .description("Number of refused calls")\n                .register(meterRegistry);\n            this.waitDuration = Timer.builder("ratelimiter.wait.duration")\n                .description("Wait duration for permission")\n                .register(meterRegistry);\n        }\n        \n        public void recordCall(String serviceName, boolean permitted, long waitTime) {\n            if (permitted) {\n                permittedCalls.increment(Tags.of("service", serviceName));\n            } else {\n                refusedCalls.increment(Tags.of("service", serviceName));\n            }\n            waitDuration.record(waitTime, TimeUnit.MILLISECONDS, Tags.of("service", serviceName));\n        }\n    }\n    \n    // \u8231\u58C1\u9694\u79BB\u76D1\u63A7\u6307\u6807\n    @Component\n    public class BulkheadMetrics {\n        \n        private final MeterRegistry meterRegistry;\n        private final Counter permittedCalls;\n        private final Counter rejectedCalls;\n        private final Timer callDuration;\n        private final Gauge availableConcurrentCalls;\n        \n        public BulkheadMetrics(MeterRegistry meterRegistry) {\n            this.meterRegistry = meterRegistry;\n            this.permittedCalls = Counter.builder("bulkhead.calls.permitted")\n                .description("Number of permitted calls")\n                .register(meterRegistry);\n            this.rejectedCalls = Counter.builder("bulkhead.calls.rejected")\n                .description("Number of rejected calls")\n                .register(meterRegistry);\n            this.callDuration = Timer.builder("bulkhead.calls.duration")\n                .description("Call duration")\n                .register(meterRegistry);\n            this.availableConcurrentCalls = Gauge.builder("bulkhead.available_concurrent_calls")\n                .description("Available concurrent calls")\n                .register(meterRegistry, this, BulkheadMetrics::getAvailableConcurrentCalls);\n        }\n        \n        public void recordCall(String serviceName, boolean permitted, long duration) {\n            if (permitted) {\n                permittedCalls.increment(Tags.of("service", serviceName));\n                callDuration.record(duration, TimeUnit.MILLISECONDS, Tags.of("service", serviceName));\n            } else {\n                rejectedCalls.increment(Tags.of("service", serviceName));\n            }\n        }\n        \n        private double getAvailableConcurrentCalls() {\n            // \u83B7\u53D6\u53EF\u7528\u5E76\u53D1\u8C03\u7528\u6570\n            return 0.0; // \u5B9E\u9645\u5B9E\u73B0\u4E2D\u9700\u8981\u8BA1\u7B97\n        }\n    }\n    \n    // \u91CD\u8BD5\u76D1\u63A7\u6307\u6807\n    @Component\n    public class RetryMetrics {\n        \n        private final MeterRegistry meterRegistry;\n        private final Counter totalCalls;\n        private final Counter successfulCalls;\n        private final Counter failedCalls;\n        private final Counter retryAttempts;\n        private final Timer callDuration;\n        \n        public RetryMetrics(MeterRegistry meterRegistry) {\n            this.meterRegistry = meterRegistry;\n            this.totalCalls = Counter.builder("retry.calls.total")\n                .description("Total number of calls")\n                .register(meterRegistry);\n            this.successfulCalls = Counter.builder("retry.calls.successful")\n                .description("Number of successful calls")\n                .register(meterRegistry);\n            this.failedCalls = Counter.builder("retry.calls.failed")\n                .description("Number of failed calls")\n                .register(meterRegistry);\n            this.retryAttempts = Counter.builder("retry.attempts")\n                .description("Number of retry attempts")\n                .register(meterRegistry);\n            this.callDuration = Timer.builder("retry.calls.duration")\n                .description("Call duration")\n                .register(meterRegistry);\n        }\n        \n        public void recordCall(String serviceName, boolean success, int attempts, long duration) {\n            totalCalls.increment(Tags.of("service", serviceName));\n            \n            if (success) {\n                successfulCalls.increment(Tags.of("service", serviceName));\n            } else {\n                failedCalls.increment(Tags.of("service", serviceName));\n            }\n            \n            if (attempts > 1) {\n                retryAttempts.increment(Tags.of("service", serviceName), attempts - 1);\n            }\n            \n            callDuration.record(duration, TimeUnit.MILLISECONDS, Tags.of("service", serviceName));\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"prometheus\u76D1\u63A7\u914D\u7F6E",children:"Prometheus\u76D1\u63A7\u914D\u7F6E"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="Prometheus\u76D1\u63A7\u914D\u7F6E"',children:"# prometheus.yml\nglobal:\n  scrape_interval: 15s\n  evaluation_interval: 15s\n\nscrape_configs:\n  - job_name: 'resilience4j-metrics'\n    static_configs:\n      - targets: ['localhost:8080']\n    metrics_path: '/actuator/prometheus'\n    scrape_interval: 5s\n\n# \u544A\u8B66\u89C4\u5219\nrule_files:\n  - 'resilience4j-alerts.yml'\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="resilience4j-alerts.yml"',children:'groups:\n  - name: resilience4j\n    rules:\n      - alert: CircuitBreakerOpen\n        expr: circuitbreaker_state == 1\n        for: 1m\n        labels:\n          severity: critical\n        annotations:\n          summary: "Circuit breaker is open"\n          description: "Circuit breaker for service {{ $labels.service }} is open"\n\n      - alert: HighFailureRate\n        expr: circuitbreaker_failure_rate > 50\n        for: 2m\n        labels:\n          severity: warning\n        annotations:\n          summary: "High failure rate detected"\n          description: "Failure rate for service {{ $labels.service }} is {{ $value }}%"\n\n      - alert: HighSlowCallRate\n        expr: circuitbreaker_slow_call_rate > 30\n        for: 2m\n        labels:\n          severity: warning\n        annotations:\n          summary: "High slow call rate detected"\n          description: "Slow call rate for service {{ $labels.service }} is {{ $value }}%"\n\n      - alert: RateLimiterRefused\n        expr: rate(ratelimiter_calls_refused_total[5m]) > 10\n        for: 1m\n        labels:\n          severity: warning\n        annotations:\n          summary: "Rate limiter refusing calls"\n          description: "Rate limiter for service {{ $labels.service }} is refusing calls"\n\n      - alert: BulkheadRejected\n        expr: rate(bulkhead_calls_rejected_total[5m]) > 5\n        for: 1m\n        labels:\n          severity: warning\n        annotations:\n          summary: "Bulkhead rejecting calls"\n          description: "Bulkhead for service {{ $labels.service }} is rejecting calls"\n\n      - alert: HighRetryAttempts\n        expr: rate(retry_attempts_total[5m]) > 20\n        for: 2m\n        labels:\n          severity: warning\n        annotations:\n          summary: "High retry attempts detected"\n          description: "Retry attempts for service {{ $labels.service }} is high"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"32-\u6700\u4F73\u5B9E\u8DF5\u4E0E\u8BBE\u8BA1\u6A21\u5F0F",children:"3.2 \u6700\u4F73\u5B9E\u8DF5\u4E0E\u8BBE\u8BA1\u6A21\u5F0F"}),"\n",(0,t.jsx)(n.h4,{id:"\u964D\u7EA7\u7B56\u7565\u8BBE\u8BA1",children:"\u964D\u7EA7\u7B56\u7565\u8BBE\u8BA1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="\u964D\u7EA7\u7B56\u7565\u8BBE\u8BA1\u793A\u4F8B"',children:'public class FallbackStrategies {\n    \n    // \u9759\u6001\u964D\u7EA7\uFF1A\u8FD4\u56DE\u9884\u5B9A\u4E49\u7684\u9ED8\u8BA4\u503C\n    public class StaticFallback {\n        \n        @CircuitBreaker(name = "user-service", fallbackMethod = "getUserFallback")\n        public User getUser(String id) {\n            return userService.getUser(id);\n        }\n        \n        public User getUserFallback(String id, Throwable ex) {\n            // \u8FD4\u56DE\u9759\u6001\u9ED8\u8BA4\u7528\u6237\n            return new User(id, "Default User", "default@example.com");\n        }\n    }\n    \n    // \u7F13\u5B58\u964D\u7EA7\uFF1A\u4ECE\u7F13\u5B58\u4E2D\u83B7\u53D6\u6570\u636E\n    public class CacheFallback {\n        \n        private final Cache<String, User> userCache;\n        \n        public CacheFallback() {\n            this.userCache = Caffeine.newBuilder()\n                .maximumSize(1000)\n                .expireAfterWrite(Duration.ofMinutes(30))\n                .build();\n        }\n        \n        @CircuitBreaker(name = "user-service", fallbackMethod = "getUserFromCache")\n        public User getUser(String id) {\n            User user = userService.getUser(id);\n            // \u66F4\u65B0\u7F13\u5B58\n            userCache.put(id, user);\n            return user;\n        }\n        \n        public User getUserFromCache(String id, Throwable ex) {\n            // \u4ECE\u7F13\u5B58\u4E2D\u83B7\u53D6\u7528\u6237\n            User cachedUser = userCache.getIfPresent(id);\n            if (cachedUser != null) {\n                return cachedUser;\n            }\n            // \u7F13\u5B58\u4E2D\u6CA1\u6709\uFF0C\u8FD4\u56DE\u9ED8\u8BA4\u7528\u6237\n            return new User(id, "Cached User", "cached@example.com");\n        }\n    }\n    \n    // \u5F02\u6B65\u964D\u7EA7\uFF1A\u5F02\u6B65\u83B7\u53D6\u6570\u636E\n    public class AsyncFallback {\n        \n        @CircuitBreaker(name = "user-service", fallbackMethod = "getUserAsyncFallback")\n        @TimeLimiter(name = "user-service")\n        public CompletableFuture<User> getUserAsync(String id) {\n            return CompletableFuture.supplyAsync(() -> userService.getUser(id));\n        }\n        \n        public CompletableFuture<User> getUserAsyncFallback(String id, Throwable ex) {\n            return CompletableFuture.supplyAsync(() -> {\n                // \u5F02\u6B65\u83B7\u53D6\u5907\u7528\u6570\u636E\n                return getBackupUserData(id);\n            });\n        }\n        \n        private User getBackupUserData(String id) {\n            // \u4ECE\u5907\u7528\u6570\u636E\u6E90\u83B7\u53D6\u7528\u6237\u4FE1\u606F\n            return new User(id, "Backup User", "backup@example.com");\n        }\n    }\n    \n    // \u7EC4\u5408\u964D\u7EA7\uFF1A\u591A\u79CD\u964D\u7EA7\u7B56\u7565\u7EC4\u5408\n    public class CompositeFallback {\n        \n        private final Cache<String, User> userCache;\n        private final UserService backupUserService;\n        \n        public CompositeFallback() {\n            this.userCache = Caffeine.newBuilder()\n                .maximumSize(1000)\n                .expireAfterWrite(Duration.ofMinutes(30))\n                .build();\n            this.backupUserService = new BackupUserService();\n        }\n        \n        @CircuitBreaker(name = "user-service", fallbackMethod = "getUserCompositeFallback")\n        public User getUser(String id) {\n            User user = userService.getUser(id);\n            userCache.put(id, user);\n            return user;\n        }\n        \n        public User getUserCompositeFallback(String id, Throwable ex) {\n            // \u7B56\u75651\uFF1A\u4ECE\u7F13\u5B58\u83B7\u53D6\n            User cachedUser = userCache.getIfPresent(id);\n            if (cachedUser != null) {\n                return cachedUser;\n            }\n            \n            // \u7B56\u75652\uFF1A\u4ECE\u5907\u7528\u670D\u52A1\u83B7\u53D6\n            try {\n                User backupUser = backupUserService.getUser(id);\n                if (backupUser != null) {\n                    return backupUser;\n                }\n            } catch (Exception e) {\n                log.warn("Backup service also failed for user: {}", id, e);\n            }\n            \n            // \u7B56\u75653\uFF1A\u8FD4\u56DE\u9759\u6001\u9ED8\u8BA4\u503C\n            return new User(id, "Default User", "default@example.com");\n        }\n    }\n    \n    // \u667A\u80FD\u964D\u7EA7\uFF1A\u6839\u636E\u5F02\u5E38\u7C7B\u578B\u9009\u62E9\u4E0D\u540C\u7684\u964D\u7EA7\u7B56\u7565\n    public class IntelligentFallback {\n        \n        @CircuitBreaker(name = "user-service", fallbackMethod = "getUserIntelligentFallback")\n        public User getUser(String id) {\n            return userService.getUser(id);\n        }\n        \n        public User getUserIntelligentFallback(String id, Throwable ex) {\n            if (ex instanceof TimeoutException) {\n                // \u8D85\u65F6\u5F02\u5E38\uFF0C\u4ECE\u7F13\u5B58\u83B7\u53D6\n                return getUserFromCache(id);\n            } else if (ex instanceof ServiceUnavailableException) {\n                // \u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u4ECE\u5907\u7528\u670D\u52A1\u83B7\u53D6\n                return getUserFromBackup(id);\n            } else if (ex instanceof ValidationException) {\n                // \u9A8C\u8BC1\u5F02\u5E38\uFF0C\u8FD4\u56DE\u9ED8\u8BA4\u503C\n                return getDefaultUser(id);\n            } else {\n                // \u5176\u4ED6\u5F02\u5E38\uFF0C\u8FD4\u56DE\u9759\u6001\u9ED8\u8BA4\u503C\n                return new User(id, "Fallback User", "fallback@example.com");\n            }\n        }\n        \n        private User getUserFromCache(String id) {\n            // \u4ECE\u7F13\u5B58\u83B7\u53D6\u7528\u6237\n            return new User(id, "Cached User", "cached@example.com");\n        }\n        \n        private User getUserFromBackup(String id) {\n            // \u4ECE\u5907\u7528\u670D\u52A1\u83B7\u53D6\u7528\u6237\n            return new User(id, "Backup User", "backup@example.com");\n        }\n        \n        private User getDefaultUser(String id) {\n            // \u8FD4\u56DE\u9ED8\u8BA4\u7528\u6237\n            return new User(id, "Default User", "default@example.com");\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"\u914D\u7F6E\u6700\u4F73\u5B9E\u8DF5",children:"\u914D\u7F6E\u6700\u4F73\u5B9E\u8DF5"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="\u914D\u7F6E\u6700\u4F73\u5B9E\u8DF5\u793A\u4F8B"',children:"public class ConfigurationBestPractices {\n    \n    // \u670D\u52A1\u7EA7\u522B\u914D\u7F6E\n    public class ServiceLevelConfiguration {\n        \n        // \u7528\u6237\u670D\u52A1\u914D\u7F6E\uFF1A\u5BF9\u53EF\u7528\u6027\u8981\u6C42\u9AD8\n        public CircuitBreakerConfig getUserServiceConfig() {\n            return CircuitBreakerConfig.custom()\n                .slidingWindowSize(20)                    // \u8F83\u5927\u7684\u7A97\u53E3\uFF0C\u66F4\u7A33\u5B9A\n                .failureRateThreshold(30.0f)              // \u8F83\u4F4E\u7684\u5931\u8D25\u7387\u9608\u503C\n                .waitDurationInOpenState(Duration.ofSeconds(30))  // \u8F83\u77ED\u7684\u6062\u590D\u65F6\u95F4\n                .permittedNumberOfCallsInHalfOpenState(5) // \u8F83\u591A\u7684\u8BD5\u63A2\u8C03\u7528\n                .recordExceptions(RuntimeException.class, IOException.class)\n                .ignoreExceptions(IllegalArgumentException.class)\n                .slidingWindowType(CircuitBreakerConfig.SlidingWindowType.COUNT_BASED)\n                .minimumNumberOfCalls(10)                 // \u6700\u5C0F\u8C03\u7528\u6570\n                .slowCallRateThreshold(50)                // \u6162\u8C03\u7528\u7387\u9608\u503C\n                .slowCallDurationThreshold(Duration.ofSeconds(1)) // \u6162\u8C03\u7528\u65F6\u95F4\u9608\u503C\n                .build();\n        }\n        \n        // \u8BA2\u5355\u670D\u52A1\u914D\u7F6E\uFF1A\u5BF9\u4E00\u81F4\u6027\u8981\u6C42\u9AD8\n        public CircuitBreakerConfig getOrderServiceConfig() {\n            return CircuitBreakerConfig.custom()\n                .slidingWindowSize(10)                    // \u8F83\u5C0F\u7684\u7A97\u53E3\uFF0C\u66F4\u654F\u611F\n                .failureRateThreshold(20.0f)              // \u66F4\u4F4E\u7684\u5931\u8D25\u7387\u9608\u503C\n                .waitDurationInOpenState(Duration.ofSeconds(60))  // \u8F83\u957F\u7684\u6062\u590D\u65F6\u95F4\n                .permittedNumberOfCallsInHalfOpenState(2) // \u8F83\u5C11\u7684\u8BD5\u63A2\u8C03\u7528\n                .recordExceptions(RuntimeException.class)\n                .slidingWindowType(CircuitBreakerConfig.SlidingWindowType.TIME_BASED)\n                .minimumNumberOfCalls(5)                  // \u6700\u5C0F\u8C03\u7528\u6570\n                .slowCallRateThreshold(30)                // \u6162\u8C03\u7528\u7387\u9608\u503C\n                .slowCallDurationThreshold(Duration.ofSeconds(2)) // \u6162\u8C03\u7528\u65F6\u95F4\u9608\u503C\n                .build();\n        }\n        \n        // \u652F\u4ED8\u670D\u52A1\u914D\u7F6E\uFF1A\u5BF9\u5B89\u5168\u6027\u8981\u6C42\u9AD8\n        public CircuitBreakerConfig getPaymentServiceConfig() {\n            return CircuitBreakerConfig.custom()\n                .slidingWindowSize(5)                     // \u6700\u5C0F\u7684\u7A97\u53E3\uFF0C\u6700\u654F\u611F\n                .failureRateThreshold(10.0f)              // \u6700\u4F4E\u7684\u5931\u8D25\u7387\u9608\u503C\n                .waitDurationInOpenState(Duration.ofSeconds(120)) // \u6700\u957F\u7684\u6062\u590D\u65F6\u95F4\n                .permittedNumberOfCallsInHalfOpenState(1) // \u6700\u5C11\u7684\u8BD5\u63A2\u8C03\u7528\n                .recordExceptions(RuntimeException.class)\n                .slidingWindowType(CircuitBreakerConfig.SlidingWindowType.COUNT_BASED)\n                .minimumNumberOfCalls(3)                  // \u6700\u5C0F\u8C03\u7528\u6570\n                .slowCallRateThreshold(20)                // \u6162\u8C03\u7528\u7387\u9608\u503C\n                .slowCallDurationThreshold(Duration.ofSeconds(500, ChronoUnit.MILLIS)) // \u6162\u8C03\u7528\u65F6\u95F4\u9608\u503C\n                .build();\n        }\n    }\n    \n    // \u73AF\u5883\u7EA7\u522B\u914D\u7F6E\n    public class EnvironmentLevelConfiguration {\n        \n        // \u5F00\u53D1\u73AF\u5883\u914D\u7F6E\uFF1A\u5BBD\u677E\u7684\u914D\u7F6E\n        public CircuitBreakerConfig getDevelopmentConfig() {\n            return CircuitBreakerConfig.custom()\n                .slidingWindowSize(5)\n                .failureRateThreshold(80.0f)              // \u8F83\u9AD8\u7684\u5931\u8D25\u7387\u9608\u503C\n                .waitDurationInOpenState(Duration.ofSeconds(10))  // \u8F83\u77ED\u7684\u6062\u590D\u65F6\u95F4\n                .permittedNumberOfCallsInHalfOpenState(3)\n                .recordExceptions(RuntimeException.class)\n                .slidingWindowType(CircuitBreakerConfig.SlidingWindowType.COUNT_BASED)\n                .minimumNumberOfCalls(3)\n                .build();\n        }\n        \n        // \u6D4B\u8BD5\u73AF\u5883\u914D\u7F6E\uFF1A\u4E2D\u7B49\u4E25\u683C\u5EA6\n        public CircuitBreakerConfig getTestConfig() {\n            return CircuitBreakerConfig.custom()\n                .slidingWindowSize(10)\n                .failureRateThreshold(50.0f)              // \u4E2D\u7B49\u7684\u5931\u8D25\u7387\u9608\u503C\n                .waitDurationInOpenState(Duration.ofSeconds(30))  // \u4E2D\u7B49\u7684\u6062\u590D\u65F6\u95F4\n                .permittedNumberOfCallsInHalfOpenState(3)\n                .recordExceptions(RuntimeException.class)\n                .slidingWindowType(CircuitBreakerConfig.SlidingWindowType.COUNT_BASED)\n                .minimumNumberOfCalls(5)\n                .build();\n        }\n        \n        // \u751F\u4EA7\u73AF\u5883\u914D\u7F6E\uFF1A\u4E25\u683C\u7684\u914D\u7F6E\n        public CircuitBreakerConfig getProductionConfig() {\n            return CircuitBreakerConfig.custom()\n                .slidingWindowSize(20)\n                .failureRateThreshold(30.0f)              // \u8F83\u4F4E\u7684\u5931\u8D25\u7387\u9608\u503C\n                .waitDurationInOpenState(Duration.ofSeconds(60))  // \u8F83\u957F\u7684\u6062\u590D\u65F6\u95F4\n                .permittedNumberOfCallsInHalfOpenState(2)\n                .recordExceptions(RuntimeException.class, IOException.class)\n                .slidingWindowType(CircuitBreakerConfig.SlidingWindowType.TIME_BASED)\n                .minimumNumberOfCalls(10)\n                .slowCallRateThreshold(50)\n                .slowCallDurationThreshold(Duration.ofSeconds(1))\n                .build();\n        }\n    }\n    \n    // \u52A8\u6001\u914D\u7F6E\n    public class DynamicConfiguration {\n        \n        private final CircuitBreakerRegistry circuitBreakerRegistry;\n        \n        public DynamicConfiguration(CircuitBreakerRegistry circuitBreakerRegistry) {\n            this.circuitBreakerRegistry = circuitBreakerRegistry;\n        }\n        \n        // \u52A8\u6001\u66F4\u65B0\u7194\u65AD\u5668\u914D\u7F6E\n        public void updateCircuitBreakerConfig(String name, CircuitBreakerConfig config) {\n            CircuitBreaker circuitBreaker = circuitBreakerRegistry.circuitBreaker(name);\n            circuitBreaker.updateConfiguration(config);\n        }\n        \n        // \u6839\u636E\u8D1F\u8F7D\u52A8\u6001\u8C03\u6574\u914D\u7F6E\n        public void adjustConfigByLoad(String serviceName, double currentLoad) {\n            CircuitBreaker circuitBreaker = circuitBreakerRegistry.circuitBreaker(serviceName);\n            CircuitBreakerConfig currentConfig = circuitBreaker.getCircuitBreakerConfig();\n            \n            CircuitBreakerConfig newConfig;\n            if (currentLoad > 0.8) {\n                // \u9AD8\u8D1F\u8F7D\uFF0C\u4F7F\u7528\u66F4\u4E25\u683C\u7684\u914D\u7F6E\n                newConfig = CircuitBreakerConfig.custom()\n                    .slidingWindowSize(currentConfig.getSlidingWindowSize())\n                    .failureRateThreshold(currentConfig.getFailureRateThreshold() * 0.8) // \u964D\u4F4E\u5931\u8D25\u7387\u9608\u503C\n                    .waitDurationInOpenState(currentConfig.getWaitDurationInOpenState().multipliedBy(2)) // \u589E\u52A0\u6062\u590D\u65F6\u95F4\n                    .permittedNumberOfCallsInHalfOpenState(Math.max(1, currentConfig.getPermittedNumberOfCallsInHalfOpenState() - 1)) // \u51CF\u5C11\u8BD5\u63A2\u8C03\u7528\n                    .build();\n            } else if (currentLoad < 0.3) {\n                // \u4F4E\u8D1F\u8F7D\uFF0C\u4F7F\u7528\u66F4\u5BBD\u677E\u7684\u914D\u7F6E\n                newConfig = CircuitBreakerConfig.custom()\n                    .slidingWindowSize(currentConfig.getSlidingWindowSize())\n                    .failureRateThreshold(currentConfig.getFailureRateThreshold() * 1.2) // \u63D0\u9AD8\u5931\u8D25\u7387\u9608\u503C\n                    .waitDurationInOpenState(currentConfig.getWaitDurationInOpenState().dividedBy(2)) // \u51CF\u5C11\u6062\u590D\u65F6\u95F4\n                    .permittedNumberOfCallsInHalfOpenState(currentConfig.getPermittedNumberOfCallsInHalfOpenState() + 1) // \u589E\u52A0\u8BD5\u63A2\u8C03\u7528\n                    .build();\n            } else {\n                // \u6B63\u5E38\u8D1F\u8F7D\uFF0C\u4FDD\u6301\u5F53\u524D\u914D\u7F6E\n                return;\n            }\n            \n            updateCircuitBreakerConfig(serviceName, newConfig);\n        }\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"33-\u5E38\u89C1\u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848",children:"3.3 \u5E38\u89C1\u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848"}),"\n",(0,t.jsx)(n.h4,{id:"\u95EE\u9898\u8BCA\u65AD\u4E0E\u89E3\u51B3",children:"\u95EE\u9898\u8BCA\u65AD\u4E0E\u89E3\u51B3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="\u95EE\u9898\u8BCA\u65AD\u4E0E\u89E3\u51B3\u65B9\u6848"',children:'public class TroubleshootingGuide {\n    \n    // \u95EE\u98981\uFF1A\u7194\u65AD\u5668\u9891\u7E41\u5F00\u542F\n    public class FrequentCircuitBreakerOpen {\n        \n        /*\n         * \u95EE\u9898\u63CF\u8FF0\uFF1A\u7194\u65AD\u5668\u9891\u7E41\u5728\u5F00\u542F\u548C\u5173\u95ED\u72B6\u6001\u4E4B\u95F4\u5207\u6362\n         * \u53EF\u80FD\u539F\u56E0\uFF1A\n         * 1. \u5931\u8D25\u7387\u9608\u503C\u8BBE\u7F6E\u8FC7\u4F4E\n         * 2. \u6ED1\u52A8\u7A97\u53E3\u5927\u5C0F\u8BBE\u7F6E\u8FC7\u5C0F\n         * 3. \u6700\u5C0F\u8C03\u7528\u6570\u8BBE\u7F6E\u8FC7\u5C0F\n         * 4. \u4E0B\u6E38\u670D\u52A1\u786E\u5B9E\u5B58\u5728\u95EE\u9898\n         */\n        \n        public CircuitBreakerConfig fixFrequentOpen() {\n            return CircuitBreakerConfig.custom()\n                .slidingWindowSize(50)                    // \u589E\u52A0\u6ED1\u52A8\u7A97\u53E3\u5927\u5C0F\n                .failureRateThreshold(70.0f)              // \u63D0\u9AD8\u5931\u8D25\u7387\u9608\u503C\n                .waitDurationInOpenState(Duration.ofSeconds(120)) // \u589E\u52A0\u6062\u590D\u65F6\u95F4\n                .permittedNumberOfCallsInHalfOpenState(5) // \u589E\u52A0\u8BD5\u63A2\u8C03\u7528\u6570\n                .minimumNumberOfCalls(20)                 // \u589E\u52A0\u6700\u5C0F\u8C03\u7528\u6570\n                .slidingWindowType(CircuitBreakerConfig.SlidingWindowType.TIME_BASED) // \u4F7F\u7528\u65F6\u95F4\u7A97\u53E3\n                .build();\n        }\n    }\n    \n    // \u95EE\u98982\uFF1A\u7194\u65AD\u5668\u6062\u590D\u8FC7\u6162\n    public class SlowCircuitBreakerRecovery {\n        \n        /*\n         * \u95EE\u9898\u63CF\u8FF0\uFF1A\u7194\u65AD\u5668\u5F00\u542F\u540E\u6062\u590D\u65F6\u95F4\u8FC7\u957F\n         * \u53EF\u80FD\u539F\u56E0\uFF1A\n         * 1. \u6062\u590D\u65F6\u95F4\u8BBE\u7F6E\u8FC7\u957F\n         * 2. \u8BD5\u63A2\u8C03\u7528\u6570\u8BBE\u7F6E\u8FC7\u5C11\n         * 3. \u4E0B\u6E38\u670D\u52A1\u6062\u590D\u8F83\u6162\n         */\n        \n        public CircuitBreakerConfig fixSlowRecovery() {\n            return CircuitBreakerConfig.custom()\n                .slidingWindowSize(20)\n                .failureRateThreshold(50.0f)\n                .waitDurationInOpenState(Duration.ofSeconds(30))  // \u51CF\u5C11\u6062\u590D\u65F6\u95F4\n                .permittedNumberOfCallsInHalfOpenState(10)       // \u589E\u52A0\u8BD5\u63A2\u8C03\u7528\u6570\n                .automaticTransitionFromOpenToHalfOpenEnabled(true) // \u542F\u7528\u81EA\u52A8\u8F6C\u6362\n                .build();\n        }\n    }\n    \n    // \u95EE\u98983\uFF1A\u8BEF\u89E6\u53D1\u7194\u65AD\u5668\n    public class FalsePositiveCircuitBreaker {\n        \n        /*\n         * \u95EE\u9898\u63CF\u8FF0\uFF1A\u7194\u65AD\u5668\u5728\u670D\u52A1\u6B63\u5E38\u65F6\u88AB\u8BEF\u89E6\u53D1\n         * \u53EF\u80FD\u539F\u56E0\uFF1A\n         * 1. \u5F02\u5E38\u7C7B\u578B\u914D\u7F6E\u4E0D\u5F53\n         * 2. \u6162\u8C03\u7528\u9608\u503C\u8BBE\u7F6E\u8FC7\u4F4E\n         * 3. \u7F51\u7EDC\u6296\u52A8\u5BFC\u81F4\u4E34\u65F6\u6545\u969C\n         */\n        \n        public CircuitBreakerConfig fixFalsePositive() {\n            return CircuitBreakerConfig.custom()\n                .slidingWindowSize(30)\n                .failureRateThreshold(50.0f)\n                .waitDurationInOpenState(Duration.ofSeconds(60))\n                .permittedNumberOfCallsInHalfOpenState(5)\n                .recordExceptions(RuntimeException.class)        // \u53EA\u8BB0\u5F55\u8FD0\u884C\u65F6\u5F02\u5E38\n                .ignoreExceptions(IllegalArgumentException.class, // \u5FFD\u7565\u53C2\u6570\u5F02\u5E38\n                                 ValidationException.class)      // \u5FFD\u7565\u9A8C\u8BC1\u5F02\u5E38\n                .slowCallRateThreshold(100)                     // \u63D0\u9AD8\u6162\u8C03\u7528\u7387\u9608\u503C\n                .slowCallDurationThreshold(Duration.ofSeconds(3)) // \u63D0\u9AD8\u6162\u8C03\u7528\u65F6\u95F4\u9608\u503C\n                .build();\n        }\n    }\n    \n    // \u95EE\u98984\uFF1A\u964D\u7EA7\u7B56\u7565\u4E0D\u5F53\n    public class InappropriateFallbackStrategy {\n        \n        /*\n         * \u95EE\u9898\u63CF\u8FF0\uFF1A\u964D\u7EA7\u7B56\u7565\u5BFC\u81F4\u7528\u6237\u4F53\u9A8C\u5DEE\u6216\u4E1A\u52A1\u903B\u8F91\u9519\u8BEF\n         * \u53EF\u80FD\u539F\u56E0\uFF1A\n         * 1. \u964D\u7EA7\u6570\u636E\u4E0D\u51C6\u786E\n         * 2. \u964D\u7EA7\u903B\u8F91\u8FC7\u4E8E\u7B80\u5355\n         * 3. \u6CA1\u6709\u8003\u8651\u4E1A\u52A1\u573A\u666F\n         */\n        \n        public class ImprovedFallbackStrategy {\n            \n            @CircuitBreaker(name = "user-service", fallbackMethod = "getUserWithContext")\n            public User getUser(String id, String context) {\n                return userService.getUser(id);\n            }\n            \n            public User getUserWithContext(String id, String context, Throwable ex) {\n                // \u6839\u636E\u4E0A\u4E0B\u6587\u9009\u62E9\u4E0D\u540C\u7684\u964D\u7EA7\u7B56\u7565\n                if ("critical".equals(context)) {\n                    // \u5173\u952E\u4E1A\u52A1\uFF0C\u5C1D\u8BD5\u4ECE\u5907\u7528\u670D\u52A1\u83B7\u53D6\n                    return getUserFromBackupService(id);\n                } else if ("normal".equals(context)) {\n                    // \u666E\u901A\u4E1A\u52A1\uFF0C\u4ECE\u7F13\u5B58\u83B7\u53D6\n                    return getUserFromCache(id);\n                } else {\n                    // \u975E\u5173\u952E\u4E1A\u52A1\uFF0C\u8FD4\u56DE\u9ED8\u8BA4\u503C\n                    return getDefaultUser(id);\n                }\n            }\n            \n            private User getUserFromBackupService(String id) {\n                try {\n                    return backupUserService.getUser(id);\n                } catch (Exception e) {\n                    log.warn("Backup service also failed for user: {}", id, e);\n                    return getDefaultUser(id);\n                }\n            }\n            \n            private User getUserFromCache(String id) {\n                User cachedUser = userCache.getIfPresent(id);\n                return cachedUser != null ? cachedUser : getDefaultUser(id);\n            }\n            \n            private User getDefaultUser(String id) {\n                return new User(id, "Default User", "default@example.com");\n            }\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.admonition,{title:"\u7194\u65AD\u5668\u4F7F\u7528\u6CE8\u610F\u4E8B\u9879",type:"caution",children:(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u5408\u7406\u914D\u7F6E"}),"\uFF1A\u6839\u636E\u670D\u52A1\u7279\u70B9\u548C\u4E1A\u52A1\u9700\u6C42\u8BBE\u7F6E\u5408\u9002\u7684\u53C2\u6570"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u76D1\u63A7\u544A\u8B66"}),"\uFF1A\u5EFA\u7ACB\u5B8C\u5584\u7684\u76D1\u63A7\u4F53\u7CFB\uFF0C\u53CA\u65F6\u53D1\u73B0\u548C\u5904\u7406\u95EE\u9898"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u964D\u7EA7\u7B56\u7565"}),"\uFF1A\u8BBE\u8BA1\u5408\u9002\u7684\u964D\u7EA7\u7B56\u7565\uFF0C\u4FDD\u8BC1\u7CFB\u7EDF\u53EF\u7528\u6027"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u6D4B\u8BD5\u9A8C\u8BC1"}),"\uFF1A\u901A\u8FC7\u538B\u529B\u6D4B\u8BD5\u9A8C\u8BC1\u914D\u7F6E\u7684\u6709\u6548\u6027"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u6587\u6863\u7EF4\u62A4"}),"\uFF1A\u7EF4\u62A4\u5B8C\u6574\u7684\u914D\u7F6E\u6587\u6863\uFF0C\u4FBF\u4E8E\u56E2\u961F\u534F\u4F5C"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u5B9A\u671F\u8BC4\u4F30"}),"\uFF1A\u5B9A\u671F\u8BC4\u4F30\u548C\u8C03\u6574\u914D\u7F6E\u53C2\u6570"]}),"\n"]})}),"\n",(0,t.jsx)(n.h2,{id:"4-\u9762\u8BD5\u9898\u7CBE\u9009",children:"4. \u9762\u8BD5\u9898\u7CBE\u9009"}),"\n",(0,t.jsx)(n.h3,{id:"41-\u57FA\u7840\u6982\u5FF5\u9898",children:"4.1 \u57FA\u7840\u6982\u5FF5\u9898"}),"\n",(0,t.jsx)(n.h4,{id:"q1-\u4EC0\u4E48\u662F\u7194\u65AD\u5668\u6A21\u5F0F\u5B83\u7684\u6838\u5FC3\u601D\u60F3\u662F\u4EC0\u4E48",children:"Q1: \u4EC0\u4E48\u662F\u7194\u65AD\u5668\u6A21\u5F0F\uFF1F\u5B83\u7684\u6838\u5FC3\u601D\u60F3\u662F\u4EC0\u4E48\uFF1F"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7B54"}),": \u7194\u65AD\u5668\u6A21\u5F0F\u662F\u4E00\u79CD\u5BB9\u9519\u8BBE\u8BA1\u6A21\u5F0F\uFF0C\u7528\u4E8E\u9632\u6B62\u7EA7\u8054\u6545\u969C\u3002\u5176\u6838\u5FC3\u601D\u60F3\u5305\u62EC\uFF1A"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u76D1\u63A7\u72B6\u6001"}),"\uFF1A\u6301\u7EED\u76D1\u63A7\u4F9D\u8D56\u670D\u52A1\u7684\u8C03\u7528\u7ED3\u679C"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u5FEB\u901F\u5931\u8D25"}),"\uFF1A\u5F53\u670D\u52A1\u5F02\u5E38\u65F6\uFF0C\u5FEB\u901F\u5931\u8D25\u800C\u4E0D\u662F\u7B49\u5F85\u8D85\u65F6"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u81EA\u52A8\u6062\u590D"}),"\uFF1A\u5F53\u670D\u52A1\u6062\u590D\u65F6\uFF0C\u81EA\u52A8\u6062\u590D\u6B63\u5E38\u8C03\u7528"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u964D\u7EA7\u4FDD\u62A4"}),"\uFF1A\u63D0\u4F9B\u964D\u7EA7\u7B56\u7565\uFF0C\u4FDD\u8BC1\u7CFB\u7EDF\u53EF\u7528\u6027"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u6838\u5FC3\u7EC4\u4EF6"}),"\uFF1A"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"CLOSED\u72B6\u6001"}),"\uFF1A\u6B63\u5E38\u72B6\u6001\uFF0C\u6240\u6709\u8BF7\u6C42\u90FD\u4F1A\u6B63\u5E38\u5904\u7406"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"OPEN\u72B6\u6001"}),"\uFF1A\u4FDD\u62A4\u72B6\u6001\uFF0C\u6240\u6709\u8BF7\u6C42\u90FD\u4F1A\u5FEB\u901F\u5931\u8D25"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"HALF_OPEN\u72B6\u6001"}),"\uFF1A\u8BD5\u63A2\u72B6\u6001\uFF0C\u5141\u8BB8\u5C11\u91CF\u8BF7\u6C42\u901A\u8FC7"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"q2-\u7194\u65AD\u5668\u7684\u4E09\u79CD\u72B6\u6001\u662F\u5982\u4F55\u8F6C\u6362\u7684",children:"Q2: \u7194\u65AD\u5668\u7684\u4E09\u79CD\u72B6\u6001\u662F\u5982\u4F55\u8F6C\u6362\u7684\uFF1F"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7B54"}),": \u7194\u65AD\u5668\u72B6\u6001\u8F6C\u6362\u89C4\u5219\u5982\u4E0B\uFF1A"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"CLOSED \u2192 OPEN: \u5931\u8D25\u6B21\u6570\u8FBE\u5230\u9608\u503C\nOPEN \u2192 HALF_OPEN: \u7ECF\u8FC7\u6062\u590D\u65F6\u95F4\u540E\u81EA\u52A8\u8F6C\u6362\nHALF_OPEN \u2192 CLOSED: \u6210\u529F\u6B21\u6570\u8FBE\u5230\u9608\u503C\nHALF_OPEN \u2192 OPEN: \u4EFB\u4F55\u4E00\u6B21\u5931\u8D25\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u8BE6\u7EC6\u8F6C\u6362\u6761\u4EF6"}),"\uFF1A"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"CLOSED \u2192 OPEN"}),"\uFF1A\u5728\u6ED1\u52A8\u7A97\u53E3\u5185\uFF0C\u5931\u8D25\u7387\u8D85\u8FC7\u9608\u503C"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"OPEN \u2192 HALF_OPEN"}),"\uFF1A\u7ECF\u8FC7",(0,t.jsx)(n.code,{children:"waitDurationInOpenState"}),"\u65F6\u95F4\u540E"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"HALF_OPEN \u2192 CLOSED"}),"\uFF1A\u5728",(0,t.jsx)(n.code,{children:"permittedNumberOfCallsInHalfOpenState"}),"\u6B21\u8C03\u7528\u4E2D\uFF0C\u6210\u529F\u6B21\u6570\u8FBE\u5230\u9608\u503C"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"HALF_OPEN \u2192 OPEN"}),"\uFF1A\u5728\u8BD5\u63A2\u671F\u95F4\u4EFB\u4F55\u4E00\u6B21\u8C03\u7528\u5931\u8D25"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"q3-resilience4j\u4E0Ehystrix\u7684\u533A\u522B\u662F\u4EC0\u4E48",children:"Q3: Resilience4j\u4E0EHystrix\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7B54"}),": \u4E3B\u8981\u533A\u522B\u5982\u4E0B\uFF1A"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Resilience4j"}),"\uFF1A"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u57FA\u4E8EJava 8\u548C\u51FD\u6570\u5F0F\u7F16\u7A0B\u8BBE\u8BA1"}),"\n",(0,t.jsx)(n.li,{children:"\u8F7B\u91CF\u7EA7\uFF0C\u65E0\u5916\u90E8\u4F9D\u8D56"}),"\n",(0,t.jsx)(n.li,{children:"\u652F\u6301\u591A\u79CD\u5BB9\u9519\u6A21\u5F0F\uFF08\u7194\u65AD\u5668\u3001\u9650\u6D41\u5668\u3001\u8231\u58C1\u9694\u79BB\u3001\u91CD\u8BD5\u3001\u8D85\u65F6\uFF09"}),"\n",(0,t.jsx)(n.li,{children:"\u63D0\u4F9B\u4E30\u5BCC\u7684\u76D1\u63A7\u6307\u6807"}),"\n",(0,t.jsx)(n.li,{children:"\u6D3B\u8DC3\u7EF4\u62A4\uFF0C\u6301\u7EED\u66F4\u65B0"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Hystrix"}),"\uFF1A"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u57FA\u4E8ERxJava\u8BBE\u8BA1"}),"\n",(0,t.jsx)(n.li,{children:"\u8F83\u91CD\uFF0C\u6709\u5916\u90E8\u4F9D\u8D56"}),"\n",(0,t.jsx)(n.li,{children:"\u4E3B\u8981\u5173\u6CE8\u7194\u65AD\u5668\u6A21\u5F0F"}),"\n",(0,t.jsx)(n.li,{children:"\u76D1\u63A7\u529F\u80FD\u76F8\u5BF9\u7B80\u5355"}),"\n",(0,t.jsx)(n.li,{children:"\u5DF2\u8FDB\u5165\u7EF4\u62A4\u6A21\u5F0F\uFF0C\u4E0D\u518D\u79EF\u6781\u5F00\u53D1"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"42-\u5B9E\u8DF5\u9898",children:"4.2 \u5B9E\u8DF5\u9898"}),"\n",(0,t.jsx)(n.h4,{id:"q4-\u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u5408\u9002\u7684\u964D\u7EA7\u7B56\u7565",children:"Q4: \u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u5408\u9002\u7684\u964D\u7EA7\u7B56\u7565\uFF1F"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7B54"}),": \u964D\u7EA7\u7B56\u7565\u8BBE\u8BA1\u9700\u8981\u8003\u8651\u4EE5\u4E0B\u51E0\u4E2A\u65B9\u9762\uFF1A"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u9759\u6001\u964D\u7EA7"}),"\uFF1A\u8FD4\u56DE\u9884\u5B9A\u4E49\u7684\u9ED8\u8BA4\u503C"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'public User getUserFallback(String id, Throwable ex) {\n    return new User(id, "Default User", "default@example.com");\n}\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u7F13\u5B58\u964D\u7EA7"}),"\uFF1A\u4ECE\u7F13\u5B58\u4E2D\u83B7\u53D6\u6570\u636E"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"public User getUserFromCache(String id, Throwable ex) {\n    User cachedUser = userCache.getIfPresent(id);\n    return cachedUser != null ? cachedUser : getDefaultUser(id);\n}\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u5907\u7528\u670D\u52A1\u964D\u7EA7"}),"\uFF1A\u4ECE\u5907\u7528\u670D\u52A1\u83B7\u53D6\u6570\u636E"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"public User getUserFromBackup(String id, Throwable ex) {\n    try {\n        return backupUserService.getUser(id);\n    } catch (Exception e) {\n        return getDefaultUser(id);\n    }\n}\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u667A\u80FD\u964D\u7EA7"}),"\uFF1A\u6839\u636E\u5F02\u5E38\u7C7B\u578B\u9009\u62E9\u4E0D\u540C\u7B56\u7565"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"public User getUserIntelligentFallback(String id, Throwable ex) {\n    if (ex instanceof TimeoutException) {\n        return getUserFromCache(id);\n    } else if (ex instanceof ServiceUnavailableException) {\n        return getUserFromBackup(id);\n    } else {\n        return getDefaultUser(id);\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"q5-\u5982\u4F55\u914D\u7F6E\u7194\u65AD\u5668\u53C2\u6570",children:"Q5: \u5982\u4F55\u914D\u7F6E\u7194\u65AD\u5668\u53C2\u6570\uFF1F"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7B54"}),": \u7194\u65AD\u5668\u53C2\u6570\u914D\u7F6E\u9700\u8981\u8003\u8651\u670D\u52A1\u7279\u70B9\uFF1A"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"// \u7528\u6237\u670D\u52A1\uFF1A\u5BF9\u53EF\u7528\u6027\u8981\u6C42\u9AD8\nCircuitBreakerConfig userServiceConfig = CircuitBreakerConfig.custom()\n    .slidingWindowSize(20)                    // \u8F83\u5927\u7684\u7A97\u53E3\uFF0C\u66F4\u7A33\u5B9A\n    .failureRateThreshold(30.0f)              // \u8F83\u4F4E\u7684\u5931\u8D25\u7387\u9608\u503C\n    .waitDurationInOpenState(Duration.ofSeconds(30))  // \u8F83\u77ED\u7684\u6062\u590D\u65F6\u95F4\n    .permittedNumberOfCallsInHalfOpenState(5) // \u8F83\u591A\u7684\u8BD5\u63A2\u8C03\u7528\n    .build();\n\n// \u652F\u4ED8\u670D\u52A1\uFF1A\u5BF9\u5B89\u5168\u6027\u8981\u6C42\u9AD8\nCircuitBreakerConfig paymentServiceConfig = CircuitBreakerConfig.custom()\n    .slidingWindowSize(5)                     // \u8F83\u5C0F\u7684\u7A97\u53E3\uFF0C\u66F4\u654F\u611F\n    .failureRateThreshold(10.0f)              // \u8F83\u4F4E\u7684\u5931\u8D25\u7387\u9608\u503C\n    .waitDurationInOpenState(Duration.ofSeconds(120)) // \u8F83\u957F\u7684\u6062\u590D\u65F6\u95F4\n    .permittedNumberOfCallsInHalfOpenState(1) // \u8F83\u5C11\u7684\u8BD5\u63A2\u8C03\u7528\n    .build();\n"})}),"\n",(0,t.jsx)(n.h3,{id:"43-\u6027\u80FD\u4F18\u5316\u9898",children:"4.3 \u6027\u80FD\u4F18\u5316\u9898"}),"\n",(0,t.jsx)(n.h4,{id:"q6-\u5982\u4F55\u4F18\u5316\u7194\u65AD\u5668\u7684\u6027\u80FD",children:"Q6: \u5982\u4F55\u4F18\u5316\u7194\u65AD\u5668\u7684\u6027\u80FD\uFF1F"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7B54"}),": \u7194\u65AD\u5668\u6027\u80FD\u4F18\u5316\u53EF\u4EE5\u4ECE\u4EE5\u4E0B\u51E0\u4E2A\u65B9\u9762\u8003\u8651\uFF1A"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u5408\u7406\u914D\u7F6E\u53C2\u6570"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"CircuitBreakerConfig optimizedConfig = CircuitBreakerConfig.custom()\n    .slidingWindowSize(50)                    // \u589E\u52A0\u7A97\u53E3\u5927\u5C0F\uFF0C\u51CF\u5C11\u72B6\u6001\u5207\u6362\n    .failureRateThreshold(50.0f)              // \u8BBE\u7F6E\u5408\u7406\u7684\u5931\u8D25\u7387\u9608\u503C\n    .waitDurationInOpenState(Duration.ofSeconds(60))  // \u8BBE\u7F6E\u5408\u7406\u7684\u6062\u590D\u65F6\u95F4\n    .permittedNumberOfCallsInHalfOpenState(3) // \u8BBE\u7F6E\u5408\u7406\u7684\u8BD5\u63A2\u8C03\u7528\u6570\n    .slidingWindowType(CircuitBreakerConfig.SlidingWindowType.TIME_BASED) // \u4F7F\u7528\u65F6\u95F4\u7A97\u53E3\n    .build();\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u4F7F\u7528\u7F13\u5B58\u964D\u7EA7"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@CircuitBreaker(name = "user-service", fallbackMethod = "getUserFromCache")\npublic User getUser(String id) {\n    User user = userService.getUser(id);\n    userCache.put(id, user); // \u66F4\u65B0\u7F13\u5B58\n    return user;\n}\n\npublic User getUserFromCache(String id, Throwable ex) {\n    return userCache.getIfPresent(id);\n}\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u5F02\u6B65\u5904\u7406"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@CircuitBreaker(name = "user-service", fallbackMethod = "getUserAsyncFallback")\n@TimeLimiter(name = "user-service")\npublic CompletableFuture<User> getUserAsync(String id) {\n    return CompletableFuture.supplyAsync(() -> userService.getUser(id));\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"q7-\u5982\u4F55\u5904\u7406\u7194\u65AD\u5668\u7684\u8BEF\u89E6\u53D1\u95EE\u9898",children:"Q7: \u5982\u4F55\u5904\u7406\u7194\u65AD\u5668\u7684\u8BEF\u89E6\u53D1\u95EE\u9898\uFF1F"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7B54"}),": \u8BEF\u89E6\u53D1\u95EE\u9898\u53EF\u4EE5\u901A\u8FC7\u4EE5\u4E0B\u65B9\u5F0F\u89E3\u51B3\uFF1A"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u8C03\u6574\u914D\u7F6E\u53C2\u6570"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"CircuitBreakerConfig antiFalsePositiveConfig = CircuitBreakerConfig.custom()\n    .slidingWindowSize(30)                    // \u589E\u52A0\u7A97\u53E3\u5927\u5C0F\n    .failureRateThreshold(70.0f)              // \u63D0\u9AD8\u5931\u8D25\u7387\u9608\u503C\n    .minimumNumberOfCalls(20)                 // \u589E\u52A0\u6700\u5C0F\u8C03\u7528\u6570\n    .recordExceptions(RuntimeException.class) // \u53EA\u8BB0\u5F55\u7279\u5B9A\u5F02\u5E38\n    .ignoreExceptions(IllegalArgumentException.class) // \u5FFD\u7565\u53C2\u6570\u5F02\u5E38\n    .slowCallRateThreshold(100)               // \u63D0\u9AD8\u6162\u8C03\u7528\u7387\u9608\u503C\n    .slowCallDurationThreshold(Duration.ofSeconds(3)) // \u63D0\u9AD8\u6162\u8C03\u7528\u65F6\u95F4\u9608\u503C\n    .build();\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u4F7F\u7528\u91CD\u8BD5\u673A\u5236"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Retry(name = "user-service", fallbackMethod = "getUserFallback")\n@CircuitBreaker(name = "user-service", fallbackMethod = "getUserFallback")\npublic User getUser(String id) {\n    return userService.getUser(id);\n}\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u76D1\u63A7\u548C\u544A\u8B66"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Bean\npublic CircuitBreakerRegistryCustomizer circuitBreakerRegistryCustomizer() {\n    return registry -> {\n        registry.getEventPublisher()\n            .onEntryAdded(entryAddedEvent -> {\n                CircuitBreaker circuitBreaker = entryAddedEvent.getAddedEntry();\n                circuitBreaker.getEventPublisher()\n                    .onStateTransition(event -> {\n                        log.warn("Circuit breaker {} state changed from {} to {}",\n                            circuitBreaker.getName(),\n                            event.getStateTransition().getFromState(),\n                            event.getStateTransition().getToState());\n                    });\n            });\n    };\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"44-\u67B6\u6784\u8BBE\u8BA1\u9898",children:"4.4 \u67B6\u6784\u8BBE\u8BA1\u9898"}),"\n",(0,t.jsx)(n.h4,{id:"q8-\u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u9AD8\u53EF\u7528\u7684\u7194\u65AD\u5668\u7CFB\u7EDF",children:"Q8: \u5982\u4F55\u8BBE\u8BA1\u4E00\u4E2A\u9AD8\u53EF\u7528\u7684\u7194\u65AD\u5668\u7CFB\u7EDF\uFF1F"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7B54"}),": \u9AD8\u53EF\u7528\u7194\u65AD\u5668\u7CFB\u7EDF\u8BBE\u8BA1\u5305\u62EC\u4EE5\u4E0B\u51E0\u4E2A\u65B9\u9762\uFF1A"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u591A\u7EA7\u7194\u65AD\u5668"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'public class MultiLevelCircuitBreaker {\n    \n    @CircuitBreaker(name = "user-service", fallbackMethod = "getUserFromCache")\n    public User getUser(String id) {\n        return userService.getUser(id);\n    }\n    \n    @CircuitBreaker(name = "cache-service", fallbackMethod = "getUserFromBackup")\n    public User getUserFromCache(String id, Throwable ex) {\n        return cacheService.getUser(id);\n    }\n    \n    @CircuitBreaker(name = "backup-service", fallbackMethod = "getDefaultUser")\n    public User getUserFromBackup(String id, Throwable ex) {\n        return backupService.getUser(id);\n    }\n    \n    public User getDefaultUser(String id, Throwable ex) {\n        return new User(id, "Default User", "default@example.com");\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u5206\u5E03\u5F0F\u7194\u65AD\u5668"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Component\npublic class DistributedCircuitBreaker {\n    \n    private final RedisTemplate<String, String> redisTemplate;\n    \n    public boolean isCircuitBreakerOpen(String serviceName) {\n        String key = "circuitbreaker:" + serviceName + ":state";\n        String state = redisTemplate.opsForValue().get(key);\n        return "OPEN".equals(state);\n    }\n    \n    public void setCircuitBreakerState(String serviceName, String state) {\n        String key = "circuitbreaker:" + serviceName + ":state";\n        redisTemplate.opsForValue().set(key, state, Duration.ofMinutes(10));\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u52A8\u6001\u914D\u7F6E"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Component\npublic class DynamicCircuitBreakerConfig {\n    \n    private final CircuitBreakerRegistry circuitBreakerRegistry;\n    \n    public void updateConfig(String serviceName, CircuitBreakerConfig config) {\n        CircuitBreaker circuitBreaker = circuitBreakerRegistry.circuitBreaker(serviceName);\n        circuitBreaker.updateConfiguration(config);\n    }\n    \n    public void adjustConfigByLoad(String serviceName, double currentLoad) {\n        // \u6839\u636E\u8D1F\u8F7D\u52A8\u6001\u8C03\u6574\u914D\u7F6E\n        if (currentLoad > 0.8) {\n            // \u9AD8\u8D1F\u8F7D\uFF0C\u4F7F\u7528\u66F4\u4E25\u683C\u7684\u914D\u7F6E\n            updateConfig(serviceName, getStrictConfig());\n        } else if (currentLoad < 0.3) {\n            // \u4F4E\u8D1F\u8F7D\uFF0C\u4F7F\u7528\u66F4\u5BBD\u677E\u7684\u914D\u7F6E\n            updateConfig(serviceName, getLooseConfig());\n        }\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"q9-\u7194\u65AD\u5668\u4E0E\u9650\u6D41\u5668\u7684\u533A\u522B\u662F\u4EC0\u4E48",children:"Q9: \u7194\u65AD\u5668\u4E0E\u9650\u6D41\u5668\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7B54"}),": \u4E3B\u8981\u533A\u522B\u5982\u4E0B\uFF1A"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7194\u65AD\u5668\uFF08Circuit Breaker\uFF09"}),"\uFF1A"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u76EE\u7684"}),"\uFF1A\u9632\u6B62\u7EA7\u8054\u6545\u969C\uFF0C\u4FDD\u62A4\u7CFB\u7EDF\u514D\u53D7\u6545\u969C\u670D\u52A1\u5F71\u54CD"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u89E6\u53D1\u6761\u4EF6"}),"\uFF1A\u57FA\u4E8E\u5931\u8D25\u7387\u3001\u54CD\u5E94\u65F6\u95F4\u7B49\u6307\u6807"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u72B6\u6001"}),"\uFF1A\u6709CLOSED\u3001OPEN\u3001HALF_OPEN\u4E09\u79CD\u72B6\u6001"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u6062\u590D\u673A\u5236"}),"\uFF1A\u81EA\u52A8\u6062\u590D\uFF0C\u652F\u6301\u8BD5\u63A2\u6027\u8C03\u7528"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u9002\u7528\u573A\u666F"}),"\uFF1A\u4FDD\u62A4\u7CFB\u7EDF\u514D\u53D7\u6545\u969C\u670D\u52A1\u5F71\u54CD"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u9650\u6D41\u5668\uFF08Rate Limiter\uFF09"}),"\uFF1A"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u76EE\u7684"}),"\uFF1A\u63A7\u5236\u8BF7\u6C42\u901F\u7387\uFF0C\u9632\u6B62\u7CFB\u7EDF\u8FC7\u8F7D"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u89E6\u53D1\u6761\u4EF6"}),"\uFF1A\u57FA\u4E8E\u8BF7\u6C42\u6570\u91CF\u3001\u65F6\u95F4\u7A97\u53E3"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u72B6\u6001"}),"\uFF1A\u53EA\u6709\u5141\u8BB8/\u62D2\u7EDD\u4E24\u79CD\u72B6\u6001"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u6062\u590D\u673A\u5236"}),"\uFF1A\u57FA\u4E8E\u65F6\u95F4\u7A97\u53E3\u81EA\u52A8\u6062\u590D"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u9002\u7528\u573A\u666F"}),"\uFF1A\u9632\u6B62\u7CFB\u7EDF\u8FC7\u8F7D\uFF0C\u4FDD\u62A4\u4E0B\u6E38\u670D\u52A1"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7EC4\u5408\u4F7F\u7528"}),"\uFF1A"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@CircuitBreaker(name = "user-service", fallbackMethod = "getUserFallback")\n@RateLimiter(name = "user-service")\n@Bulkhead(name = "user-service")\npublic User getUser(String id) {\n    return userService.getUser(id);\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"45-\u76D1\u63A7\u8FD0\u7EF4\u9898",children:"4.5 \u76D1\u63A7\u8FD0\u7EF4\u9898"}),"\n",(0,t.jsx)(n.h4,{id:"q10-\u5982\u4F55\u76D1\u63A7\u7194\u65AD\u5668\u7684\u5065\u5EB7\u72B6\u51B5",children:"Q10: \u5982\u4F55\u76D1\u63A7\u7194\u65AD\u5668\u7684\u5065\u5EB7\u72B6\u51B5\uFF1F"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u7B54"}),": \u7194\u65AD\u5668\u76D1\u63A7\u53EF\u4EE5\u4ECE\u4EE5\u4E0B\u51E0\u4E2A\u65B9\u9762\u8FDB\u884C\uFF1A"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u5173\u952E\u6307\u6807\u76D1\u63A7"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Component\npublic class CircuitBreakerHealthCheck {\n    \n    private final CircuitBreakerRegistry circuitBreakerRegistry;\n    private final MeterRegistry meterRegistry;\n    \n    public Health checkCircuitBreakerHealth() {\n        Map<String, Object> details = new HashMap<>();\n        \n        for (CircuitBreaker circuitBreaker : circuitBreakerRegistry.getAllCircuitBreakers()) {\n            CircuitBreaker.Metrics metrics = circuitBreaker.getMetrics();\n            details.put(circuitBreaker.getName() + ".state", circuitBreaker.getState());\n            details.put(circuitBreaker.getName() + ".failureRate", metrics.getFailureRate());\n            details.put(circuitBreaker.getName() + ".slowCallRate", metrics.getSlowCallRate());\n        }\n        \n        boolean isHealthy = details.values().stream()\n            .noneMatch(value -> "OPEN".equals(value) || \n                              (value instanceof Number && ((Number) value).doubleValue() > 50));\n        \n        return isHealthy ? Health.up().withDetails(details).build() \n                        : Health.down().withDetails(details).build();\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u544A\u8B66\u89C4\u5219\u914D\u7F6E"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'# prometheus\u544A\u8B66\u89C4\u5219\ngroups:\n  - name: circuitbreaker\n    rules:\n      - alert: CircuitBreakerOpen\n        expr: circuitbreaker_state == 1\n        for: 1m\n        labels:\n          severity: critical\n        annotations:\n          summary: "Circuit breaker is open"\n          description: "Circuit breaker for service {{ $labels.service }} is open"\n\n      - alert: HighFailureRate\n        expr: circuitbreaker_failure_rate > 50\n        for: 2m\n        labels:\n          severity: warning\n        annotations:\n          summary: "High failure rate detected"\n          description: "Failure rate for service {{ $labels.service }} is {{ $value }}%"\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u65E5\u5FD7\u76D1\u63A7"}),"\uFF1A"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Component\npublic class CircuitBreakerLoggingFilter {\n    \n    private static final Logger logger = LoggerFactory.getLogger(CircuitBreakerLoggingFilter.class);\n    \n    @EventListener\n    public void onCircuitBreakerEvent(CircuitBreakerOnStateTransitionEvent event) {\n        logger.warn("Circuit breaker {} state changed from {} to {}",\n            event.getCircuitBreakerName(),\n            event.getStateTransition().getFromState(),\n            event.getStateTransition().getToState());\n    }\n    \n    @EventListener\n    public void onFailureRateExceeded(CircuitBreakerOnFailureRateExceededEvent event) {\n        logger.error("Circuit breaker {} failure rate exceeded: {}%",\n            event.getCircuitBreakerName(),\n            event.getFailureRate());\n    }\n}\n'})}),"\n",(0,t.jsx)(n.admonition,{title:"\u7194\u65AD\u5668\u5B66\u4E60\u8981\u70B9",type:"info",children:(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u7406\u89E3\u539F\u7406"}),"\uFF1A\u638C\u63E1\u7194\u65AD\u5668\u7684\u6838\u5FC3\u601D\u60F3\u548C\u72B6\u6001\u8F6C\u6362\u673A\u5236"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u638C\u63E1\u914D\u7F6E"}),"\uFF1A\u719F\u6089\u5404\u79CD\u914D\u7F6E\u53C2\u6570\u7684\u542B\u4E49\u548C\u5F71\u54CD"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u5B9E\u8DF5\u5E94\u7528"}),"\uFF1A\u901A\u8FC7\u5B9E\u9645\u9879\u76EE\u7EC3\u4E60\u7194\u65AD\u5668\u7684\u4F7F\u7528"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u76D1\u63A7\u8FD0\u7EF4"}),"\uFF1A\u5B66\u4F1A\u7194\u65AD\u5668\u7684\u76D1\u63A7\u548C\u8FD0\u7EF4\u7BA1\u7406"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u6027\u80FD\u4F18\u5316"}),"\uFF1A\u4E86\u89E3\u7194\u65AD\u5668\u6027\u80FD\u4F18\u5316\u7684\u65B9\u6CD5"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"\u6700\u4F73\u5B9E\u8DF5"}),"\uFF1A\u638C\u63E1\u7194\u65AD\u5668\u7684\u6700\u4F73\u5B9E\u8DF5\u548C\u8BBE\u8BA1\u6A21\u5F0F"]}),"\n"]})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.p,{children:"\u901A\u8FC7\u672C\u7AE0\u7684\u5B66\u4E60\uFF0C\u4F60\u5E94\u8BE5\u5DF2\u7ECF\u6DF1\u5165\u7406\u89E3\u4E86\u7194\u65AD\u5668\u6A21\u5F0F\u7684\u6838\u5FC3\u6982\u5FF5\u3001\u5B9E\u73B0\u65B9\u6848\u548C\u6700\u4F73\u5B9E\u8DF5\u3002\u7194\u65AD\u5668\u662F\u5FAE\u670D\u52A1\u67B6\u6784\u4E2D\u7684\u91CD\u8981\u5BB9\u9519\u673A\u5236\uFF0C\u5408\u7406\u4F7F\u7528\u7194\u65AD\u5668\u53EF\u4EE5\u663E\u8457\u63D0\u9AD8\u7CFB\u7EDF\u7684\u53EF\u7528\u6027\u548C\u7A33\u5B9A\u6027\u3002\u5728\u5B9E\u9645\u9879\u76EE\u4E2D\uFF0C\u8981\u6839\u636E\u4E1A\u52A1\u9700\u6C42\u9009\u62E9\u5408\u9002\u7684\u7194\u65AD\u5668\u65B9\u6848\uFF0C\u5E76\u6CE8\u91CD\u76D1\u63A7\u8FD0\u7EF4\u548C\u6027\u80FD\u4F18\u5316\u3002"})]})}function d(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},28453:function(e,n,r){r.d(n,{R:()=>l,x:()=>s});var i=r(96540);let t={},a=i.createContext(t);function l(e){let n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);