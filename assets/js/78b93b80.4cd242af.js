"use strict";(self.webpackChunkfullstack_dev_blog=self.webpackChunkfullstack_dev_blog||[]).push([["80471"],{94283:function(e,n,r){r.r(n),r.d(n,{metadata:()=>s,default:()=>x,frontMatter:()=>d,contentTitle:()=>o,toc:()=>u,assets:()=>p});var s=JSON.parse('{"id":"backend/database-orm/mybatis","title":"MyBatis\u6846\u67B6\u8BE6\u89E3","description":"\u6DF1\u5165\u7406\u89E3MyBatis\u6838\u5FC3\u539F\u7406\u3001\u6620\u5C04\u914D\u7F6E\u4E0E\u9AD8\u7EA7\u7279\u6027\u5E94\u7528","source":"@site/docs/backend/database-orm/mybatis.mdx","sourceDirName":"backend/database-orm","slug":"/backend/database-orm/mybatis","permalink":"/docs/backend/database-orm/mybatis","draft":false,"unlisted":false,"editUrl":"https://github.com/MasterLiu93/blog-web/tree/main/docs/backend/database-orm/mybatis.mdx","tags":[{"inline":true,"label":"MyBatis","permalink":"/docs/tags/my-batis"},{"inline":true,"label":"ORM\u6846\u67B6","permalink":"/docs/tags/orm\u6846\u67B6"},{"inline":true,"label":"SQL\u6620\u5C04","permalink":"/docs/tags/sql\u6620\u5C04"},{"inline":true,"label":"\u6301\u4E45\u5C42","permalink":"/docs/tags/\u6301\u4E45\u5C42"},{"inline":true,"label":"Java","permalink":"/docs/tags/java"}],"version":"current","lastUpdatedBy":"Laby","lastUpdatedAt":1754870400000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"MyBatis\u6846\u67B6\u8BE6\u89E3","description":"\u6DF1\u5165\u7406\u89E3MyBatis\u6838\u5FC3\u539F\u7406\u3001\u6620\u5C04\u914D\u7F6E\u4E0E\u9AD8\u7EA7\u7279\u6027\u5E94\u7528","authors":["Laby"],"tags":["MyBatis","ORM\u6846\u67B6","SQL\u6620\u5C04","\u6301\u4E45\u5C42","Java"],"last_update":{"date":"2025-08-11T00:00:00.000Z","author":"Laby"}},"sidebar":"tutorialSidebar","previous":{"title":"MongoDB\u8BE6\u89E3","permalink":"/docs/backend/database-orm/mongodb"},"next":{"title":"MyBatis-Plus\u6846\u67B6\u8BE6\u89E3","permalink":"/docs/backend/database-orm/mybatis-plus"}}'),l=r(74848),t=r(28453),i=r(78010),a=r(57250),c=r(25591);let d={sidebar_position:3,title:"MyBatis\u6846\u67B6\u8BE6\u89E3",description:"\u6DF1\u5165\u7406\u89E3MyBatis\u6838\u5FC3\u539F\u7406\u3001\u6620\u5C04\u914D\u7F6E\u4E0E\u9AD8\u7EA7\u7279\u6027\u5E94\u7528",authors:["Laby"],tags:["MyBatis","ORM\u6846\u67B6","SQL\u6620\u5C04","\u6301\u4E45\u5C42","Java"],last_update:{date:new Date("2025-08-11T00:00:00.000Z"),author:"Laby"}},o="MyBatis\u6846\u67B6\u8BE6\u89E3",p={},u=[{value:"1. MyBatis\u6838\u5FC3\u539F\u7406\u4E0E\u67B6\u6784",id:"1-mybatis\u6838\u5FC3\u539F\u7406\u4E0E\u67B6\u6784",level:2},{value:"1.1 MyBatis\u5DE5\u4F5C\u539F\u7406",id:"11-mybatis\u5DE5\u4F5C\u539F\u7406",level:3},{value:"1.2 \u6838\u5FC3\u7EC4\u4EF6\u5256\u6790",id:"12-\u6838\u5FC3\u7EC4\u4EF6\u5256\u6790",level:3},{value:"1.3 \u6267\u884C\u6D41\u7A0B\u8BE6\u89E3",id:"13-\u6267\u884C\u6D41\u7A0B\u8BE6\u89E3",level:3},{value:"2. \u914D\u7F6E\u4F53\u7CFB\u8BE6\u89E3",id:"2-\u914D\u7F6E\u4F53\u7CFB\u8BE6\u89E3",level:2},{value:"2.1 \u5168\u5C40\u914D\u7F6E\u6587\u4EF6",id:"21-\u5168\u5C40\u914D\u7F6E\u6587\u4EF6",level:3},{value:"2.2 \u73AF\u5883\u4E0E\u6570\u636E\u6E90\u914D\u7F6E",id:"22-\u73AF\u5883\u4E0E\u6570\u636E\u6E90\u914D\u7F6E",level:3},{value:"2.3 \u7C7B\u578B\u5904\u7406\u5668\u4E0E\u522B\u540D",id:"23-\u7C7B\u578B\u5904\u7406\u5668\u4E0E\u522B\u540D",level:3},{value:"2.4 \u63D2\u4EF6\u4E0E\u65E5\u5FD7\u914D\u7F6E",id:"24-\u63D2\u4EF6\u4E0E\u65E5\u5FD7\u914D\u7F6E",level:3},{value:"3. \u6620\u5C04\u6587\u4EF6\u4E0ESQL\u6784\u5EFA",id:"3-\u6620\u5C04\u6587\u4EF6\u4E0Esql\u6784\u5EFA",level:2},{value:"3.1 XML\u6620\u5C04\u6587\u4EF6\u8BE6\u89E3",id:"31-xml\u6620\u5C04\u6587\u4EF6\u8BE6\u89E3",level:3},{value:"3.2 \u6CE8\u89E3\u6620\u5C04\u65B9\u5F0F",id:"32-\u6CE8\u89E3\u6620\u5C04\u65B9\u5F0F",level:3},{value:"3.3 \u4E24\u79CD\u6620\u5C04\u65B9\u5F0F\u5BF9\u6BD4",id:"33-\u4E24\u79CD\u6620\u5C04\u65B9\u5F0F\u5BF9\u6BD4",level:3},{value:"3.4 SQL\u6784\u5EFA\u5668\u4F7F\u7528",id:"34-sql\u6784\u5EFA\u5668\u4F7F\u7528",level:3},{value:"4. \u52A8\u6001SQL\u4E0E\u590D\u6742\u67E5\u8BE2",id:"4-\u52A8\u6001sql\u4E0E\u590D\u6742\u67E5\u8BE2",level:2},{value:"4.1 \u6761\u4EF6\u67E5\u8BE2\u6784\u5EFA",id:"41-\u6761\u4EF6\u67E5\u8BE2\u6784\u5EFA",level:3},{value:"4.2 \u5FAA\u73AF\u4E0E\u6279\u91CF\u64CD\u4F5C",id:"42-\u5FAA\u73AF\u4E0E\u6279\u91CF\u64CD\u4F5C",level:3},{value:"4.3 \u52A8\u6001\u8868\u540D\u4E0E\u5217\u540D",id:"43-\u52A8\u6001\u8868\u540D\u4E0E\u5217\u540D",level:3},{value:"4.4 \u591A\u6570\u636E\u5E93\u652F\u6301",id:"44-\u591A\u6570\u636E\u5E93\u652F\u6301",level:3},{value:"5. \u7ED3\u679C\u6620\u5C04\u4E0E\u5173\u8054\u67E5\u8BE2",id:"5-\u7ED3\u679C\u6620\u5C04\u4E0E\u5173\u8054\u67E5\u8BE2",level:2},{value:"5.1 \u57FA\u7840\u7ED3\u679C\u6620\u5C04",id:"51-\u57FA\u7840\u7ED3\u679C\u6620\u5C04",level:3},{value:"resultMap\u5C5E\u6027\u8BE6\u89E3",id:"resultmap\u5C5E\u6027\u8BE6\u89E3",level:4},{value:"\u7C7B\u578B\u8F6C\u6362",id:"\u7C7B\u578B\u8F6C\u6362",level:4},{value:"5.2 \u4E00\u5BF9\u4E00\u5173\u8054\u67E5\u8BE2",id:"52-\u4E00\u5BF9\u4E00\u5173\u8054\u67E5\u8BE2",level:3},{value:"5.3 \u4E00\u5BF9\u591A\u5173\u8054\u67E5\u8BE2",id:"53-\u4E00\u5BF9\u591A\u5173\u8054\u67E5\u8BE2",level:3},{value:"5.4 \u9274\u522B\u5668\u6620\u5C04",id:"54-\u9274\u522B\u5668\u6620\u5C04",level:3},{value:"6. \u7F13\u5B58\u673A\u5236\u4E0E\u6027\u80FD\u4F18\u5316",id:"6-\u7F13\u5B58\u673A\u5236\u4E0E\u6027\u80FD\u4F18\u5316",level:2},{value:"6.1 \u4E00\u7EA7\u7F13\u5B58\u673A\u5236",id:"61-\u4E00\u7EA7\u7F13\u5B58\u673A\u5236",level:3},{value:"6.2 \u4E8C\u7EA7\u7F13\u5B58\u914D\u7F6E",id:"62-\u4E8C\u7EA7\u7F13\u5B58\u914D\u7F6E",level:3},{value:"6.3 \u81EA\u5B9A\u4E49\u7F13\u5B58\u5B9E\u73B0",id:"63-\u81EA\u5B9A\u4E49\u7F13\u5B58\u5B9E\u73B0",level:3},{value:"6.4 \u6027\u80FD\u4F18\u5316\u7B56\u7565",id:"64-\u6027\u80FD\u4F18\u5316\u7B56\u7565",level:3},{value:"7. \u63D2\u4EF6\u5F00\u53D1\u4E0E\u5B9A\u5236\u6269\u5C55",id:"7-\u63D2\u4EF6\u5F00\u53D1\u4E0E\u5B9A\u5236\u6269\u5C55",level:2},{value:"7.1 \u63D2\u4EF6\u673A\u5236\u539F\u7406",id:"71-\u63D2\u4EF6\u673A\u5236\u539F\u7406",level:3},{value:"7.2 \u81EA\u5B9A\u4E49\u63D2\u4EF6\u5F00\u53D1",id:"72-\u81EA\u5B9A\u4E49\u63D2\u4EF6\u5F00\u53D1",level:3},{value:"7.3 \u5206\u9875\u63D2\u4EF6\u5B9E\u73B0",id:"73-\u5206\u9875\u63D2\u4EF6\u5B9E\u73B0",level:3},{value:"7.4 \u6027\u80FD\u76D1\u63A7\u63D2\u4EF6",id:"74-\u6027\u80FD\u76D1\u63A7\u63D2\u4EF6",level:3},{value:"8. MyBatis\u5B9E\u6218\u5E94\u7528\u573A\u666F",id:"8-mybatis\u5B9E\u6218\u5E94\u7528\u573A\u666F",level:2},{value:"8.1 \u591A\u8868\u590D\u6742\u67E5\u8BE2",id:"81-\u591A\u8868\u590D\u6742\u67E5\u8BE2",level:3},{value:"8.2 \u5B58\u50A8\u8FC7\u7A0B\u8C03\u7528",id:"82-\u5B58\u50A8\u8FC7\u7A0B\u8C03\u7528",level:3},{value:"8.3 \u6279\u91CF\u6570\u636E\u5904\u7406",id:"83-\u6279\u91CF\u6570\u636E\u5904\u7406",level:3},{value:"8.4 \u52A8\u6001\u6743\u9650SQL",id:"84-\u52A8\u6001\u6743\u9650sql",level:3},{value:"9. \u603B\u7ED3\u4E0E\u6700\u4F73\u5B9E\u8DF5",id:"9-\u603B\u7ED3\u4E0E\u6700\u4F73\u5B9E\u8DF5",level:2},{value:"9.1 MyBatis\u4F7F\u7528\u89C4\u8303",id:"91-mybatis\u4F7F\u7528\u89C4\u8303",level:3},{value:"9.2 \u5E38\u89C1\u95EE\u9898\u89E3\u51B3\u65B9\u6848",id:"92-\u5E38\u89C1\u95EE\u9898\u89E3\u51B3\u65B9\u6848",level:3},{value:"9.3 MyBatis\u6280\u672F\u6808\u6269\u5C55",id:"93-mybatis\u6280\u672F\u6808\u6269\u5C55",level:3},{value:"10. \u9762\u8BD5\u9898\u7CBE\u9009",id:"10-\u9762\u8BD5\u9898\u7CBE\u9009",level:2},{value:"10.1 \u57FA\u7840\u539F\u7406\u9762\u8BD5\u9898",id:"101-\u57FA\u7840\u539F\u7406\u9762\u8BD5\u9898",level:3},{value:"10.2 \u914D\u7F6E\u4E0E\u6620\u5C04\u9762\u8BD5\u9898",id:"102-\u914D\u7F6E\u4E0E\u6620\u5C04\u9762\u8BD5\u9898",level:3},{value:"10.3 \u7F13\u5B58\u4E0E\u6027\u80FD\u9762\u8BD5\u9898",id:"103-\u7F13\u5B58\u4E0E\u6027\u80FD\u9762\u8BD5\u9898",level:3},{value:"10.4 \u63D2\u4EF6\u4E0E\u6269\u5C55\u9762\u8BD5\u9898",id:"104-\u63D2\u4EF6\u4E0E\u6269\u5C55\u9762\u8BD5\u9898",level:3}];function h(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"mybatis\u6846\u67B6\u8BE6\u89E3",children:"MyBatis\u6846\u67B6\u8BE6\u89E3"})}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u662F\u4E00\u6B3E\u4F18\u79C0\u7684\u6301\u4E45\u5C42\u6846\u67B6\uFF0C\u652F\u6301\u81EA\u5B9A\u4E49SQL\u3001\u5B58\u50A8\u8FC7\u7A0B\u4EE5\u53CA\u9AD8\u7EA7\u6620\u5C04\u3002MyBatis\u907F\u514D\u4E86\u51E0\u4E4E\u6240\u6709\u7684JDBC\u4EE3\u7801\u548C\u624B\u52A8\u8BBE\u7F6E\u53C2\u6570\u4EE5\u53CA\u83B7\u53D6\u7ED3\u679C\u96C6\uFF0C\u901A\u8FC7\u7B80\u5355\u7684XML\u914D\u7F6E\u6216\u6CE8\u89E3\uFF0C\u5C06\u63A5\u53E3\u4E0ESQL\u8BED\u53E5\u8FDB\u884C\u6620\u5C04\uFF0C\u4E13\u6CE8\u4E8ESQL\u672C\u8EAB\uFF0C\u8D4B\u4E88\u5F00\u53D1\u8005\u66F4\u591A\u7684\u63A7\u5236\u6743\u548C\u7075\u6D3B\u6027\u3002"}),"\n",(0,l.jsxs)(n.admonition,{title:"\u6838\u5FC3\u4EF7\u503C",type:"tip",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"MyBatis = \u7075\u6D3BSQL + \u7B80\u5316JDBC + \u4F18\u96C5\u6620\u5C04 + \u52A8\u6001\u67E5\u8BE2"})}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u{1F680} ",(0,l.jsx)(n.strong,{children:"\u534A\u81EA\u52A8ORM"}),"\uFF1A\u624B\u5199SQL\uFF0C\u81EA\u52A8\u6620\u5C04\u7ED3\u679C\u96C6\uFF0C\u63A7\u5236\u4E0E\u7075\u6D3B\u5E76\u5B58"]}),"\n",(0,l.jsxs)(n.li,{children:["\u{1F3AF} ",(0,l.jsx)(n.strong,{children:"\u52A8\u6001SQL"}),"\uFF1A\u5F3A\u5927\u7684\u6761\u4EF6\u5224\u65AD\u3001\u5FAA\u73AF\u3001\u5206\u652F\u80FD\u529B\uFF0C\u751F\u6210\u590D\u6742\u67E5\u8BE2"]}),"\n",(0,l.jsxs)(n.li,{children:["\u{1F4A1} ",(0,l.jsx)(n.strong,{children:"\u4F18\u96C5\u8BBE\u8BA1"}),"\uFF1A\u63A5\u53E3\u4E0E\u5B9E\u73B0\u5206\u79BB\uFF0C\u4EC5\u9700\u5B9A\u4E49\u63A5\u53E3\uFF0C\u65E0\u9700\u5B9E\u73B0\u7C7B"]}),"\n",(0,l.jsxs)(n.li,{children:["\u{1F527} ",(0,l.jsx)(n.strong,{children:"\u53EF\u63D2\u62D4\u67B6\u6784"}),"\uFF1A\u63D2\u4EF6\u673A\u5236\u652F\u6301\u81EA\u5B9A\u4E49\u62E6\u622A\u548C\u5904\u7406\uFF0C\u6613\u4E8E\u6269\u5C55"]}),"\n",(0,l.jsxs)(n.li,{children:["\u{1F6E1}\uFE0F ",(0,l.jsx)(n.strong,{children:"\u7F13\u5B58\u652F\u6301"}),"\uFF1A\u4E00\u7EA7\u7F13\u5B58\u4E0E\u4E8C\u7EA7\u7F13\u5B58\uFF0C\u63D0\u5347\u67E5\u8BE2\u6027\u80FD"]}),"\n"]})]}),"\n",(0,l.jsx)(n.h2,{id:"1-mybatis\u6838\u5FC3\u539F\u7406\u4E0E\u67B6\u6784",children:"1. MyBatis\u6838\u5FC3\u539F\u7406\u4E0E\u67B6\u6784"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u662F\u4E00\u4E2A\u4F18\u79C0\u7684\u6301\u4E45\u5C42\u6846\u67B6\uFF0C\u5176\u6838\u5FC3\u8BBE\u8BA1\u7406\u5FF5\u662F\u5C06SQL\u4E0E\u4EE3\u7801\u5206\u79BB\uFF0C\u540C\u65F6\u63D0\u4F9B\u7B80\u5355\u800C\u5F3A\u5927\u7684\u6620\u5C04\u673A\u5236\u3002\u7406\u89E3MyBatis\u7684\u67B6\u6784\u548C\u539F\u7406\u5BF9\u4E8E\u6B63\u786E\u9AD8\u6548\u5730\u4F7F\u7528\u5B83\u81F3\u5173\u91CD\u8981\u3002"}),"\n",(0,l.jsx)(n.mermaid,{value:"graph TD\n    A[\u5E94\u7528\u7A0B\u5E8F] --\x3e B[SqlSessionFactoryBuilder]\n    B -- \u8BFB\u53D6\u914D\u7F6E --\x3e C[Configuration XML]\n    B -- \u6784\u5EFA --\x3e D[SqlSessionFactory]\n    D -- \u521B\u5EFA --\x3e E[SqlSession]\n    E -- \u6267\u884C --\x3e F[Executor]\n    F -- \u521B\u5EFA/\u4F7F\u7528 --\x3e G[StatementHandler]\n    G -- \u8BBE\u7F6E\u53C2\u6570 --\x3e H[ParameterHandler]\n    G -- \u6267\u884CSQL --\x3e I[\u6570\u636E\u5E93]\n    I -- \u8FD4\u56DE\u7ED3\u679C --\x3e J[ResultSetHandler]\n    J -- \u6620\u5C04\u7ED3\u679C --\x3e E\n    E -- \u8FD4\u56DE\u6570\u636E --\x3e A"}),"\n",(0,l.jsx)(n.h3,{id:"11-mybatis\u5DE5\u4F5C\u539F\u7406",children:"1.1 MyBatis\u5DE5\u4F5C\u539F\u7406"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u7684\u5DE5\u4F5C\u6D41\u7A0B\u53EF\u4EE5\u6982\u62EC\u4E3A\u4EE5\u4E0B\u51E0\u4E2A\u5173\u952E\u6B65\u9AA4\uFF1A"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"build",label:"\u6784\u5EFA\u9636\u6BB5",children:[(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="SqlSessionFactory\u6784\u5EFA\u8FC7\u7A0B"',children:'// 1. \u521B\u5EFASqlSessionFactoryBuilder\u5BF9\u8C61\nSqlSessionFactoryBuilder builder = new SqlSessionFactoryBuilder();\n\n// 2. \u52A0\u8F7Dmybatis-config.xml\u914D\u7F6E\u6587\u4EF6\nInputStream inputStream = Resources.getResourceAsStream("mybatis-config.xml");\n\n// 3. \u6784\u5EFASqlSessionFactory\u5BF9\u8C61\nSqlSessionFactory factory = builder.build(inputStream);\n'})}),(0,l.jsx)(n.p,{children:"\u5728\u6784\u5EFA\u9636\u6BB5\uFF0CMyBatis\u4F1A\u5B8C\u6210\u4EE5\u4E0B\u5DE5\u4F5C\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u89E3\u6790\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u6807\u7B7E"}),"\n",(0,l.jsx)(n.li,{children:"\u521B\u5EFAConfiguration\u5BF9\u8C61"}),"\n",(0,l.jsx)(n.li,{children:"\u52A0\u8F7D\u6620\u5C04\u6587\u4EF6\u548C\u6CE8\u89E3\u914D\u7F6E"}),"\n",(0,l.jsx)(n.li,{children:"\u521D\u59CB\u5316\u5185\u7F6E\u7EC4\u4EF6"}),"\n",(0,l.jsx)(n.li,{children:"\u521B\u5EFASqlSessionFactory\u5B9E\u4F8B"}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"runtime",label:"\u8FD0\u884C\u9636\u6BB5",children:[(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="SqlSession\u4F7F\u7528\u8FC7\u7A0B"',children:"// 1. \u83B7\u53D6SqlSession\ntry (SqlSession session = factory.openSession()) {\n    // 2. \u83B7\u53D6Mapper\u63A5\u53E3\n    UserMapper mapper = session.getMapper(UserMapper.class);\n    \n    // 3. \u6267\u884CSQL\n    User user = mapper.getUserById(1);\n    \n    // 4. \u63D0\u4EA4\u4E8B\u52A1\n    session.commit();\n}\n"})}),(0,l.jsx)(n.p,{children:"\u5728\u8FD0\u884C\u9636\u6BB5\uFF0CMyBatis\u4F1A\u5B8C\u6210\u4EE5\u4E0B\u5DE5\u4F5C\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u521B\u5EFASqlSession\u5B9E\u4F8B"}),"\n",(0,l.jsx)(n.li,{children:"\u521B\u5EFAExecutor\u6267\u884C\u5668"}),"\n",(0,l.jsx)(n.li,{children:"\u521B\u5EFAStatementHandler\u5904\u7406SQL\u8BED\u53E5"}),"\n",(0,l.jsx)(n.li,{children:"\u53C2\u6570\u6620\u5C04\u548C\u8BBE\u7F6E"}),"\n",(0,l.jsx)(n.li,{children:"\u6267\u884CSQL\u5E76\u83B7\u53D6\u7ED3\u679C"}),"\n",(0,l.jsx)(n.li,{children:"\u7ED3\u679C\u96C6\u6620\u5C04\u8F6C\u6362"}),"\n",(0,l.jsx)(n.li,{children:"\u8FD4\u56DE\u4E1A\u52A1\u5BF9\u8C61"}),"\n"]})]})]}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u901A\u8FC7\u52A8\u6001\u4EE3\u7406\u6280\u672F\u5B9E\u73B0\u4E86\u53EA\u9700\u5B9A\u4E49\u63A5\u53E3\u800C\u65E0\u9700\u7F16\u5199\u5B9E\u73B0\u7C7B\u7684\u4FBF\u5229\u7279\u6027\u3002\u5F53\u6211\u4EEC\u8C03\u7528Mapper\u63A5\u53E3\u65B9\u6CD5\u65F6\uFF0CMyBatis\u4F1A\u62E6\u622A\u8BE5\u8C03\u7528\uFF0C\u627E\u5230\u5BF9\u5E94\u7684SQL\u8BED\u53E5\u5E76\u6267\u884C\uFF0C\u7136\u540E\u5C06\u7ED3\u679C\u6620\u5C04\u4E3A\u6307\u5B9A\u7684\u5BF9\u8C61\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"12-\u6838\u5FC3\u7EC4\u4EF6\u5256\u6790",children:"1.2 \u6838\u5FC3\u7EC4\u4EF6\u5256\u6790"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u7684\u6838\u5FC3\u7EC4\u4EF6\u6784\u6210\u4E86\u5176\u5B8C\u6574\u7684\u529F\u80FD\u4F53\u7CFB\uFF0C\u6BCF\u4E2A\u7EC4\u4EF6\u8D1F\u8D23\u7279\u5B9A\u7684\u529F\u80FD\uFF1A"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u6838\u5FC3\u7EC4\u4EF6"}),(0,l.jsx)(n.th,{children:"\u4E3B\u8981\u529F\u80FD"}),(0,l.jsx)(n.th,{children:"\u751F\u547D\u5468\u671F"}),(0,l.jsx)(n.th,{children:"\u5173\u952E\u7279\u6027"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Configuration"})}),(0,l.jsx)(n.td,{children:"\u5168\u5C40\u914D\u7F6E\u4FE1\u606F"}),(0,l.jsx)(n.td,{children:"\u5168\u5C40\u552F\u4E00"}),(0,l.jsx)(n.td,{children:"\u5305\u542B\u6240\u6709\u914D\u7F6E\u548C\u6620\u5C04\u4FE1\u606F"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"SqlSessionFactory"})}),(0,l.jsx)(n.td,{children:"\u521B\u5EFASqlSession"}),(0,l.jsx)(n.td,{children:"\u5168\u5C40\u552F\u4E00"}),(0,l.jsx)(n.td,{children:"\u7EBF\u7A0B\u5B89\u5168\uFF0C\u53EF\u91CD\u7528"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"SqlSession"})}),(0,l.jsx)(n.td,{children:"\u63D0\u4F9BSQL\u6267\u884C\u65B9\u6CD5"}),(0,l.jsx)(n.td,{children:"\u8BF7\u6C42\u7EA7\u522B"}),(0,l.jsx)(n.td,{children:"\u975E\u7EBF\u7A0B\u5B89\u5168\uFF0C\u77ED\u6682"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Executor"})}),(0,l.jsx)(n.td,{children:"\u6267\u884C\u5668"}),(0,l.jsx)(n.td,{children:"\u8BF7\u6C42\u7EA7\u522B"}),(0,l.jsx)(n.td,{children:"\u7EF4\u62A4\u7F13\u5B58\uFF0C\u6267\u884CSQL"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"StatementHandler"})}),(0,l.jsx)(n.td,{children:"\u5904\u7406SQL\u8BED\u53E5"}),(0,l.jsx)(n.td,{children:"\u65B9\u6CD5\u7EA7\u522B"}),(0,l.jsx)(n.td,{children:"\u521B\u5EFAStatement\u5BF9\u8C61"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"ParameterHandler"})}),(0,l.jsx)(n.td,{children:"\u5904\u7406SQL\u53C2\u6570"}),(0,l.jsx)(n.td,{children:"\u65B9\u6CD5\u7EA7\u522B"}),(0,l.jsx)(n.td,{children:"\u8BBE\u7F6E\u9884\u7F16\u8BD1\u53C2\u6570"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"ResultSetHandler"})}),(0,l.jsx)(n.td,{children:"\u5904\u7406\u7ED3\u679C\u96C6\u6620\u5C04"}),(0,l.jsx)(n.td,{children:"\u65B9\u6CD5\u7EA7\u522B"}),(0,l.jsx)(n.td,{children:"\u5C06\u7ED3\u679C\u96C6\u8F6C\u4E3A\u5BF9\u8C61"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"TypeHandler"})}),(0,l.jsx)(n.td,{children:"\u7C7B\u578B\u8F6C\u6362"}),(0,l.jsx)(n.td,{children:"\u5168\u5C40\u53EF\u7528"}),(0,l.jsx)(n.td,{children:"Java\u4E0EJDBC\u7C7B\u578B\u8F6C\u6362"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"MappedStatement"})}),(0,l.jsx)(n.td,{children:"\u6620\u5C04\u8BED\u53E5"}),(0,l.jsx)(n.td,{children:"\u5168\u5C40\u53EF\u7528"}),(0,l.jsx)(n.td,{children:"\u5C01\u88C5SQL\u548C\u6620\u5C04\u4FE1\u606F"})]})]})]}),"\n",(0,l.jsx)(n.admonition,{title:"\u7EC4\u4EF6\u5173\u7CFB\u8981\u70B9",type:"tip",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"SqlSessionFactory"}),"\uFF1A\u5355\u4F8B\u6A21\u5F0F\uFF0C\u5E94\u7528\u7EA7\u751F\u547D\u5468\u671F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"SqlSession"}),"\uFF1A\u975E\u7EBF\u7A0B\u5B89\u5168\uFF0C\u9700\u8981\u5728\u65B9\u6CD5\u4F5C\u7528\u57DF\u5185\u4F7F\u7528"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Mapper"}),"\uFF1A\u7531SqlSession\u521B\u5EFA\u7684\u4EE3\u7406\u5BF9\u8C61\uFF0C\u4F9D\u8D56\u4E8ESqlSession\u751F\u547D\u5468\u671F"]}),"\n"]})}),"\n",(0,l.jsx)(n.h3,{id:"13-\u6267\u884C\u6D41\u7A0B\u8BE6\u89E3",children:"1.3 \u6267\u884C\u6D41\u7A0B\u8BE6\u89E3"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u7684\u6267\u884C\u6D41\u7A0B\u53EF\u4EE5\u8BE6\u7EC6\u5206\u89E3\u4E3A\u4EE5\u4E0B\u6B65\u9AA4\uFF1A"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u521D\u59CB\u5316\u9636\u6BB5"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u89E3\u6790\u914D\u7F6E\u6587\u4EF6\u521B\u5EFAConfiguration\u5BF9\u8C61"}),"\n",(0,l.jsx)(n.li,{children:"\u52A0\u8F7DMapper\u6620\u5C04\u6587\u4EF6\u6216\u6CE8\u89E3"}),"\n",(0,l.jsx)(n.li,{children:"\u89E3\u6790SQL\u8BED\u53E5\u521B\u5EFAMappedStatement\u5BF9\u8C61"}),"\n",(0,l.jsx)(n.li,{children:"\u6784\u5EFASqlSessionFactory\u5B9E\u4F8B"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u6267\u884C\u9636\u6BB5"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u901A\u8FC7SqlSessionFactory\u521B\u5EFASqlSession"}),"\n",(0,l.jsx)(n.li,{children:"\u901A\u8FC7SqlSession\u83B7\u53D6Mapper\u4EE3\u7406\u5BF9\u8C61"}),"\n",(0,l.jsx)(n.li,{children:"\u8C03\u7528Mapper\u65B9\u6CD5\u6267\u884CSQL"}),"\n",(0,l.jsx)(n.li,{children:"SqlSession\u5C06\u8BF7\u6C42\u8F6C\u4EA4\u7ED9Executor\u6267\u884C\u5668"}),"\n",(0,l.jsx)(n.li,{children:"Executor\u8C03\u7528StatementHandler\u5904\u7406SQL\u8BED\u53E5"}),"\n",(0,l.jsx)(n.li,{children:"ParameterHandler\u8BBE\u7F6E\u53C2\u6570"}),"\n",(0,l.jsx)(n.li,{children:"\u6267\u884CSQL\u8BED\u53E5"}),"\n",(0,l.jsx)(n.li,{children:"ResultSetHandler\u5C06\u7ED3\u679C\u96C6\u8F6C\u6362\u4E3A\u5BF9\u8C61"}),"\n",(0,l.jsx)(n.li,{children:"\u8FD4\u56DE\u6267\u884C\u7ED3\u679C\u7ED9\u8C03\u7528\u8005"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(c.A,{language:"java",title:"\u5B8C\u6574\u6267\u884C\u6D41\u7A0B\u793A\u4F8B",children:`// 1. \u{8BFB}\u{53D6}MyBatis\u{914D}\u{7F6E}\u{6587}\u{4EF6}
String resource = "mybatis-config.xml";
InputStream inputStream = Resources.getResourceAsStream(resource);

// 2. \u{6784}\u{5EFA}SqlSessionFactory
SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

// 3. \u{83B7}\u{53D6}SqlSession
try (SqlSession sqlSession = sqlSessionFactory.openSession()) {
  // 4. \u{83B7}\u{53D6}Mapper\u{4EE3}\u{7406}\u{5BF9}\u{8C61}
  UserMapper mapper = sqlSession.getMapper(UserMapper.class);
  
  // 5. \u{6267}\u{884C}SQL
  User user = mapper.getUserById(1);
  
  // 6. \u{5904}\u{7406}\u{7ED3}\u{679C}
  System.out.println(user);
  
  // 7. \u{63D0}\u{4EA4}\u{4E8B}\u{52A1}
  sqlSession.commit();
}`}),"\n",(0,l.jsxs)(n.p,{children:["\u5F53\u8C03\u7528",(0,l.jsx)(n.code,{children:"mapper.getUserById(1)"}),"\u65F6\uFF0CMyBatis\u5185\u90E8\u4F1A\uFF1A"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u901A\u8FC7\u52A8\u6001\u4EE3\u7406\u62E6\u622A\u8BE5\u65B9\u6CD5\u8C03\u7528"}),"\n",(0,l.jsx)(n.li,{children:"\u6839\u636E\u65B9\u6CD5\u7B7E\u540D\u627E\u5230\u5BF9\u5E94\u7684MappedStatement"}),"\n",(0,l.jsx)(n.li,{children:"\u521B\u5EFASqlSource\u751F\u6210SQL\u8BED\u53E5"}),"\n",(0,l.jsx)(n.li,{children:"\u8BBE\u7F6E\u53C2\u6570\u5E76\u6267\u884CSQL"}),"\n",(0,l.jsx)(n.li,{children:"\u5C06\u7ED3\u679C\u96C6\u6620\u5C04\u4E3AUser\u5BF9\u8C61"}),"\n",(0,l.jsx)(n.li,{children:"\u8FD4\u56DE\u7ED3\u679C\u7ED9\u8C03\u7528\u8005"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"2-\u914D\u7F6E\u4F53\u7CFB\u8BE6\u89E3",children:"2. \u914D\u7F6E\u4F53\u7CFB\u8BE6\u89E3"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u7684\u914D\u7F6E\u4F53\u7CFB\u662F\u5176\u7075\u6D3B\u6027\u548C\u53EF\u6269\u5C55\u6027\u7684\u5173\u952E\u3002\u5168\u5C40\u914D\u7F6E\u6587\u4EF6\u662FMyBatis\u914D\u7F6E\u7684\u5165\u53E3\uFF0C\u5305\u542B\u4E86\u591A\u79CD\u914D\u7F6E\u5143\u7D20\uFF0C\u53EF\u4EE5\u6839\u636E\u4E0D\u540C\u73AF\u5883\u548C\u9700\u6C42\u8FDB\u884C\u5B9A\u5236\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"21-\u5168\u5C40\u914D\u7F6E\u6587\u4EF6",children:"2.1 \u5168\u5C40\u914D\u7F6E\u6587\u4EF6"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u5168\u5C40\u914D\u7F6E\u6587\u4EF6\uFF08\u901A\u5E38\u547D\u540D\u4E3Amybatis-config.xml\uFF09\u7ED3\u6784\u6E05\u6670\uFF0C\u5404\u5143\u7D20\u6709\u4E25\u683C\u7684\u987A\u5E8F\u8981\u6C42\uFF1A"}),"\n",(0,l.jsx)(n.mermaid,{value:"graph TD\n    A[configuration] --\x3e B[properties]\n    A --\x3e C[settings]\n    A --\x3e D[typeAliases]\n    A --\x3e E[typeHandlers]\n    A --\x3e F[objectFactory]\n    A --\x3e G[plugins]\n    A --\x3e H[environments]\n    H --\x3e I[environment]\n    I --\x3e J[transactionManager]\n    I --\x3e K[dataSource]\n    A --\x3e L[databaseIdProvider]\n    A --\x3e M[mappers]"}),"\n",(0,l.jsx)(c.A,{language:"xml",title:"mybatis-config.xml\u5B8C\u6574\u793A\u4F8B",children:`<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE configuration
PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-config.dtd">
<configuration>
<!-- \u{5F15}\u{5165}\u{5916}\u{90E8}\u{5C5E}\u{6027}\u{6587}\u{4EF6} -->
<properties resource="db.properties">
  <property name="username" value="dev_user"/>
  <property name="password" value="dev_password"/>
</properties>

<!-- \u{5168}\u{5C40}\u{8BBE}\u{7F6E} -->
<settings>
  <setting name="cacheEnabled" value="true"/>
  <setting name="lazyLoadingEnabled" value="true"/>
  <setting name="mapUnderscoreToCamelCase" value="true"/>
</settings>

<!-- \u{7C7B}\u{578B}\u{522B}\u{540D} -->
<typeAliases>
  <package name="com.example.model"/>
</typeAliases>

<!-- \u{7C7B}\u{578B}\u{5904}\u{7406}\u{5668} -->
<typeHandlers>
  <typeHandler handler="com.example.handler.JsonTypeHandler"/>
</typeHandlers>

<!-- \u{63D2}\u{4EF6} -->
<plugins>
  <plugin interceptor="com.example.plugin.PageInterceptor">
    <property name="dialect" value="mysql"/>
  </plugin>
</plugins>

<!-- \u{73AF}\u{5883}\u{914D}\u{7F6E} -->
<environments default="development">
  <environment id="development">
            <transactionManager type="JDBC"/>
      <dataSource type="POOLED">
        <property name="driver" value="com.mysql.cj.jdbc.Driver"/>
        <property name="url" value="jdbc:mysql://localhost:3306/mydb"/>
        <property name="username" value="root"/>
        <property name="password" value="password"/>
    </dataSource>
  </environment>
</environments>

<!-- \u{6570}\u{636E}\u{5E93}\u{5382}\u{5546}\u{6807}\u{8BC6} -->
<databaseIdProvider type="DB_VENDOR">
  <property name="MySQL" value="mysql"/>
  <property name="Oracle" value="oracle"/>
  <property name="SQL Server" value="sqlserver"/>
</databaseIdProvider>

<!-- \u{6620}\u{5C04}\u{5668} -->
<mappers>
  <mapper resource="com/example/mapper/UserMapper.xml"/>
  <package name="com.example.mapper"/>
</mappers>
</configuration>`}),"\n",(0,l.jsx)(n.admonition,{title:"\u6CE8\u610F",type:"warning",children:(0,l.jsx)(n.p,{children:"\u914D\u7F6E\u5143\u7D20\u5FC5\u987B\u6309\u7167\u4E0A\u8FF0\u987A\u5E8F\u5B9A\u4E49\uFF0C\u5426\u5219MyBatis\u4F1A\u629B\u51FA\u5F02\u5E38\uFF01"})}),"\n",(0,l.jsx)(n.h3,{id:"22-\u73AF\u5883\u4E0E\u6570\u636E\u6E90\u914D\u7F6E",children:"2.2 \u73AF\u5883\u4E0E\u6570\u636E\u6E90\u914D\u7F6E"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u652F\u6301\u591A\u73AF\u5883\u914D\u7F6E\uFF0C\u53EF\u4EE5\u4E3A\u4E0D\u540C\u7684\u5F00\u53D1\u9636\u6BB5\uFF08\u5F00\u53D1\u3001\u6D4B\u8BD5\u3001\u751F\u4EA7\uFF09\u914D\u7F6E\u4E0D\u540C\u7684\u6570\u636E\u6E90\u548C\u4E8B\u52A1\u7BA1\u7406\u5668\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsx)(a.A,{value:"environments",label:"\u73AF\u5883\u914D\u7F6E",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u591A\u73AF\u5883\u914D\u7F6E"',children:'<environments default="development">\n  \x3c!-- \u5F00\u53D1\u73AF\u5883 --\x3e\n  <environment id="development">\n    <transactionManager type="JDBC"/>\n    <dataSource type="POOLED">\n      <property name="driver" value="com.mysql.cj.jdbc.Driver"/>\n      <property name="url" value="jdbc:mysql://localhost:3306/dev_db"/>\n      <property name="username" value="dev_user"/>\n      <property name="password" value="dev_password"/>\n    </dataSource>\n  </environment>\n  \n  \x3c!-- \u6D4B\u8BD5\u73AF\u5883 --\x3e\n  <environment id="test">\n    <transactionManager type="JDBC"/>\n    <dataSource type="POOLED">\n      <property name="driver" value="com.mysql.cj.jdbc.Driver"/>\n      <property name="url" value="jdbc:mysql://test-server:3306/test_db"/>\n      <property name="username" value="test_user"/>\n      <property name="password" value="test_password"/>\n    </dataSource>\n  </environment>\n  \n  \x3c!-- \u751F\u4EA7\u73AF\u5883 --\x3e\n  <environment id="production">\n    <transactionManager type="MANAGED"/>\n    <dataSource type="JNDI">\n      <property name="data_source" value="java:comp/env/jdbc/ProductionDB"/>\n    </dataSource>\n  </environment>\n</environments>\n'})})}),(0,l.jsxs)(a.A,{value:"transaction",label:"\u4E8B\u52A1\u7BA1\u7406\u5668",children:[(0,l.jsx)(n.p,{children:"MyBatis\u652F\u6301\u4E24\u79CD\u7C7B\u578B\u7684\u4E8B\u52A1\u7BA1\u7406\u5668\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"JDBC"}),"\uFF1A\u76F4\u63A5\u4F7F\u7528JDBC\u7684\u4E8B\u52A1\u7BA1\u7406\u673A\u5236\uFF0C\u4F9D\u8D56\u4E8E\u6570\u636E\u5E93\u8FDE\u63A5\u7684commit\u548Crollback"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<transactionManager type="JDBC"/>\n'})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"MANAGED"}),"\uFF1A\u5C06\u4E8B\u52A1\u7BA1\u7406\u4EA4\u7ED9\u5BB9\u5668\uFF08\u5982Spring\u6216JEE\u5BB9\u5668\uFF09"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<transactionManager type="MANAGED">\n  <property name="closeConnection" value="false"/>\n</transactionManager>\n'})})]}),(0,l.jsxs)(a.A,{value:"datasource",label:"\u6570\u636E\u6E90\u914D\u7F6E",children:[(0,l.jsx)(n.p,{children:"MyBatis\u5185\u7F6E\u4E86\u4E09\u79CD\u6570\u636E\u6E90\u7C7B\u578B\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"UNPOOLED"}),"\uFF1A\u4E0D\u4F7F\u7528\u8FDE\u63A5\u6C60\uFF0C\u6BCF\u6B21\u8BF7\u6C42\u65F6\u6253\u5F00\u548C\u5173\u95ED\u8FDE\u63A5"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<dataSource type="UNPOOLED">\n  <property name="driver" value="com.mysql.cj.jdbc.Driver"/>\n  <property name="url" value="jdbc:mysql://localhost:3306/mydb"/>\n  <property name="username" value="root"/>\n  <property name="password" value="password"/>\n</dataSource>\n'})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"POOLED"}),"\uFF1A\u4F7F\u7528MyBatis\u5185\u7F6E\u7684\u7B80\u5355\u6570\u636E\u5E93\u8FDE\u63A5\u6C60"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<dataSource type="POOLED">\n  <property name="driver" value="com.mysql.cj.jdbc.Driver"/>\n  <property name="url" value="jdbc:mysql://localhost:3306/mydb"/>\n  <property name="username" value="root"/>\n  <property name="password" value="password"/>\n  <property name="poolMaximumActiveConnections" value="10"/>\n  <property name="poolMaximumIdleConnections" value="5"/>\n</dataSource>\n'})}),(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"JNDI"}),"\uFF1A\u901A\u8FC7JNDI\u67E5\u627E\u6570\u636E\u6E90\uFF0C\u4E3B\u8981\u7528\u4E8E\u5E94\u7528\u670D\u52A1\u5668\u73AF\u5883"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<dataSource type="JNDI">\n  <property name="data_source" value="java:comp/env/jdbc/MyDataSource"/>\n</dataSource>\n'})})]})]}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u5B9E\u9645\u9879\u76EE\u4E2D\uFF0C\u53EF\u4EE5\u901A\u8FC7\u5728\u6784\u5EFASqlSessionFactory\u65F6\u6307\u5B9A\u73AF\u5883ID\u6765\u9009\u62E9\u4F7F\u7528\u54EA\u4E2A\u73AF\u5883\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'String resource = "mybatis-config.xml";\nInputStream inputStream = Resources.getResourceAsStream(resource);\n// \u4F7F\u7528production\u73AF\u5883\nSqlSessionFactory factory = new SqlSessionFactoryBuilder().build(inputStream, "production");\n'})}),"\n",(0,l.jsx)(n.h3,{id:"23-\u7C7B\u578B\u5904\u7406\u5668\u4E0E\u522B\u540D",children:"2.3 \u7C7B\u578B\u5904\u7406\u5668\u4E0E\u522B\u540D"}),"\n",(0,l.jsx)(n.p,{children:"\u7C7B\u578B\u522B\u540D\u548C\u7C7B\u578B\u5904\u7406\u5668\u662FMyBatis\u7B80\u5316\u4EE3\u7801\u548C\u6269\u5C55\u7C7B\u578B\u8F6C\u6362\u80FD\u529B\u7684\u4E24\u4E2A\u91CD\u8981\u673A\u5236\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"aliases",label:"\u7C7B\u578B\u522B\u540D",children:[(0,l.jsx)(n.p,{children:"\u7C7B\u578B\u522B\u540D\u4E3AJava\u7C7B\u578B\u8BBE\u7F6E\u4E00\u4E2A\u7B80\u77ED\u7684\u540D\u5B57\uFF0C\u51CF\u5C11\u5197\u957F\u7C7B\u540D\u7684\u91CD\u590D\u8F93\u5165\u3002"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u7C7B\u578B\u522B\u540D\u914D\u7F6E"',children:'<typeAliases>\n  \x3c!-- \u5355\u4E2A\u522B\u540D\u5B9A\u4E49 --\x3e\n  <typeAlias alias="User" type="com.example.model.User"/>\n  \n  \x3c!-- \u6279\u91CF\u5B9A\u4E49\u5305\u4E0B\u6240\u6709\u7C7B\u7684\u522B\u540D --\x3e\n  <package name="com.example.model"/>\n</typeAliases>\n'})}),(0,l.jsx)(n.p,{children:"MyBatis\u5185\u7F6E\u4E86\u5E38\u89C1Java\u7C7B\u578B\u7684\u522B\u540D\uFF1A"}),(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u522B\u540D"}),(0,l.jsx)(n.th,{children:"\u6620\u5C04\u7684\u7C7B\u578B"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"string"}),(0,l.jsx)(n.td,{children:"String"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"long"}),(0,l.jsx)(n.td,{children:"Long"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"int"}),(0,l.jsx)(n.td,{children:"Integer"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"boolean"}),(0,l.jsx)(n.td,{children:"Boolean"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"date"}),(0,l.jsx)(n.td,{children:"Date"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"decimal"}),(0,l.jsx)(n.td,{children:"BigDecimal"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"map"}),(0,l.jsx)(n.td,{children:"Map"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"list"}),(0,l.jsx)(n.td,{children:"List"})]})]})]})]}),(0,l.jsxs)(a.A,{value:"handlers",label:"\u7C7B\u578B\u5904\u7406\u5668",children:[(0,l.jsx)(n.p,{children:"\u7C7B\u578B\u5904\u7406\u5668\u7528\u4E8EJava\u7C7B\u578B\u4E0EJDBC\u7C7B\u578B\u4E4B\u95F4\u7684\u8F6C\u6362\uFF0CMyBatis\u5185\u7F6E\u4E86\u5E38\u89C1\u7C7B\u578B\u7684\u5904\u7406\u5668\uFF0C\u4E5F\u652F\u6301\u81EA\u5B9A\u4E49\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u7C7B\u578B\u5904\u7406\u5668\u914D\u7F6E"',children:'<typeHandlers>\n  \x3c!-- \u6CE8\u518C\u5355\u4E2A\u7C7B\u578B\u5904\u7406\u5668 --\x3e\n  <typeHandler handler="com.example.handler.JsonTypeHandler" javaType="Object" jdbcType="VARCHAR"/>\n  \n  \x3c!-- \u6CE8\u518C\u5305\u4E2D\u6240\u6709\u7C7B\u578B\u5904\u7406\u5668 --\x3e\n  <package name="com.example.handler"/>\n</typeHandlers>\n'})}),(0,l.jsx)(n.p,{children:"\u81EA\u5B9A\u4E49\u7C7B\u578B\u5904\u7406\u5668\u793A\u4F8B\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u81EA\u5B9A\u4E49JSON\u7C7B\u578B\u5904\u7406\u5668"',children:'public class JsonTypeHandler<T> extends BaseTypeHandler<T> {\n    private Class<T> clazz;\n    private ObjectMapper objectMapper = new ObjectMapper();\n    \n    public JsonTypeHandler(Class<T> clazz) {\n        this.clazz = clazz;\n    }\n    \n    @Override\n    public void setNonNullParameter(PreparedStatement ps, int i, T parameter, JdbcType jdbcType) throws SQLException {\n        try {\n            ps.setString(i, objectMapper.writeValueAsString(parameter));\n        } catch (JsonProcessingException e) {\n            throw new SQLException("Error converting JSON", e);\n        }\n    }\n    \n    @Override\n    public T getNullableResult(ResultSet rs, String columnName) throws SQLException {\n        return parseJson(rs.getString(columnName));\n    }\n    \n    @Override\n    public T getNullableResult(ResultSet rs, int columnIndex) throws SQLException {\n        return parseJson(rs.getString(columnIndex));\n    }\n    \n    @Override\n    public T getNullableResult(CallableStatement cs, int columnIndex) throws SQLException {\n        return parseJson(cs.getString(columnIndex));\n    }\n    \n    private T parseJson(String json) throws SQLException {\n        if (json == null) return null;\n        try {\n            return objectMapper.readValue(json, clazz);\n        } catch (IOException e) {\n            throw new SQLException("Error parsing JSON", e);\n        }\n    }\n}\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"24-\u63D2\u4EF6\u4E0E\u65E5\u5FD7\u914D\u7F6E",children:"2.4 \u63D2\u4EF6\u4E0E\u65E5\u5FD7\u914D\u7F6E"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u63D0\u4F9B\u4E86\u5F3A\u5927\u7684\u63D2\u4EF6\u673A\u5236\u548C\u7075\u6D3B\u7684\u65E5\u5FD7\u914D\u7F6E\uFF0C\u53EF\u4EE5\u6269\u5C55\u6838\u5FC3\u529F\u80FD\u5E76\u76D1\u63A7SQL\u6267\u884C\u60C5\u51B5\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"plugins",label:"\u63D2\u4EF6\u914D\u7F6E",children:[(0,l.jsx)(n.p,{children:"MyBatis\u63D2\u4EF6\u662F\u901A\u8FC7\u62E6\u622A\u5668\u6A21\u5F0F\u5B9E\u73B0\u7684\uFF0C\u53EF\u4EE5\u62E6\u622A\u6838\u5FC3\u7EC4\u4EF6\u7684\u65B9\u6CD5\u8C03\u7528\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u63D2\u4EF6\u914D\u7F6E"',children:'<plugins>\n  \x3c!-- \u5206\u9875\u63D2\u4EF6 --\x3e\n  <plugin interceptor="com.github.pagehelper.PageInterceptor">\n    <property name="helperDialect" value="mysql"/>\n    <property name="reasonable" value="true"/>\n  </plugin>\n  \n  \x3c!-- SQL\u6027\u80FD\u76D1\u63A7\u63D2\u4EF6 --\x3e\n  <plugin interceptor="com.example.plugin.SqlPerformanceInterceptor">\n    <property name="slowSqlThreshold" value="1000"/>\n  </plugin>\n</plugins>\n'})}),(0,l.jsx)(n.p,{children:"\u81EA\u5B9A\u4E49\u63D2\u4EF6\u9700\u8981\u5B9E\u73B0Interceptor\u63A5\u53E3\uFF0C\u5E76\u901A\u8FC7@Intercepts\u6CE8\u89E3\u6307\u5B9A\u62E6\u622A\u70B9\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="SQL\u6267\u884C\u65F6\u95F4\u76D1\u63A7\u63D2\u4EF6"',children:'@Intercepts({\n    @Signature(type = Executor.class, method = "update", args = {MappedStatement.class, Object.class}),\n    @Signature(type = Executor.class, method = "query", args = {MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class})\n})\npublic class SqlPerformanceInterceptor implements Interceptor {\n    private long slowSqlThreshold;\n    \n    @Override\n    public Object intercept(Invocation invocation) throws Throwable {\n        MappedStatement ms = (MappedStatement) invocation.getArgs()[0];\n        Object parameter = invocation.getArgs()[1];\n        \n        BoundSql boundSql = ms.getBoundSql(parameter);\n        String sql = boundSql.getSql();\n        \n        long start = System.currentTimeMillis();\n        Object result = invocation.proceed();\n        long end = System.currentTimeMillis();\n        long time = end - start;\n        \n        if (time > slowSqlThreshold) {\n            String logMsg = String.format("Slow SQL: %s, Time: %dms", sql, time);\n            System.err.println(logMsg);\n        }\n        \n        return result;\n    }\n    \n    @Override\n    public Object plugin(Object target) {\n        return Plugin.wrap(target, this);\n    }\n    \n    @Override\n    public void setProperties(Properties properties) {\n        this.slowSqlThreshold = Long.parseLong(properties.getProperty("slowSqlThreshold", "1000"));\n    }\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"logging",label:"\u65E5\u5FD7\u914D\u7F6E",children:[(0,l.jsx)(n.p,{children:"MyBatis\u652F\u6301\u591A\u79CD\u65E5\u5FD7\u6846\u67B6\uFF0C\u6309\u7167\u67E5\u627E\u987A\u5E8F\u6392\u5217\uFF1ASLF4J \u2192 Log4j2 \u2192 Log4j \u2192 JDK logging"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u65E5\u5FD7\u914D\u7F6E"',children:'<settings>\n  \x3c!-- \u6307\u5B9A\u65E5\u5FD7\u5B9E\u73B0 --\x3e\n  <setting name="logImpl" value="SLF4J"/>\n  \n  \x3c!-- \u65E5\u5FD7\u524D\u7F00 --\x3e\n  <setting name="logPrefix" value="MyBatis"/>\n</settings>\n'})}),(0,l.jsx)(n.p,{children:"\u9488\u5BF9\u7279\u5B9AMapper\u6216\u8BED\u53E5\u7684\u8BE6\u7EC6\u65E5\u5FD7\u914D\u7F6E\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u65E5\u5FD7\u7EA7\u522B\u914D\u7F6E (log4j2.xml)"',children:'<Loggers>\n  \x3c!-- \u4E3A\u7279\u5B9AMapper\u8BBE\u7F6E\u65E5\u5FD7\u7EA7\u522B --\x3e\n  <Logger name="com.example.mapper.UserMapper" level="TRACE"/>\n  \n  \x3c!-- \u4E3A\u6240\u6709MyBatis SQL\u65E5\u5FD7\u8BBE\u7F6E\u7EA7\u522B --\x3e\n  <Logger name="org.apache.ibatis" level="DEBUG"/>\n</Loggers>\n'})}),(0,l.jsx)(n.p,{children:"\u901A\u8FC7\u8BBE\u7F6E\u65E5\u5FD7\u7EA7\u522B\u4E3ATRACE\uFF0C\u53EF\u4EE5\u770B\u5230\u4EE5\u4E0B\u8BE6\u7EC6\u4FE1\u606F\uFF1A"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"SQL\u8BED\u53E5"}),"\n",(0,l.jsx)(n.li,{children:"\u53C2\u6570\u503C"}),"\n",(0,l.jsx)(n.li,{children:"\u8FD4\u56DE\u7ED3\u679C"}),"\n",(0,l.jsx)(n.li,{children:"\u6027\u80FD\u7EDF\u8BA1"}),"\n"]})]})]}),"\n",(0,l.jsx)(n.admonition,{title:"\u914D\u7F6E\u6700\u4F73\u5B9E\u8DF5",type:"tip",children:(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5C5E\u6027\u5916\u90E8\u5316"}),"\uFF1A\u4F7F\u7528properties\u6587\u4EF6\u5B58\u50A8\u6570\u636E\u5E93\u8FDE\u63A5\u4FE1\u606F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7075\u6D3B\u73AF\u5883\u914D\u7F6E"}),"\uFF1A\u4E3A\u4E0D\u540C\u73AF\u5883\uFF08\u5F00\u53D1\u3001\u6D4B\u8BD5\u3001\u751F\u4EA7\uFF09\u914D\u7F6E\u4E0D\u540C\u6570\u636E\u6E90"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u542F\u7528\u9A7C\u5CF0\u547D\u540D\u6620\u5C04"}),"\uFF1A\u8BBE\u7F6EmapUnderscoreToCamelCase\u4E3Atrue"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5408\u7406\u4F7F\u7528\u7F13\u5B58"}),"\uFF1A\u6839\u636E\u4E1A\u52A1\u9700\u6C42\u914D\u7F6E\u4E8C\u7EA7\u7F13\u5B58"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u9002\u5F53\u7684\u65E5\u5FD7\u7EA7\u522B"}),"\uFF1A\u5F00\u53D1\u73AF\u5883\u4F7F\u7528DEBUG\u7EA7\u522B\uFF0C\u751F\u4EA7\u73AF\u5883\u4F7F\u7528INFO\u7EA7\u522B"]}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"3-\u6620\u5C04\u6587\u4EF6\u4E0Esql\u6784\u5EFA",children:"3. \u6620\u5C04\u6587\u4EF6\u4E0ESQL\u6784\u5EFA"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u7684\u6838\u5FC3\u529F\u80FD\u662F\u5C06SQL\u8BED\u53E5\u4E0EJava\u65B9\u6CD5\u5173\u8054\u8D77\u6765\uFF0C\u63D0\u4F9B\u4E86XML\u548C\u6CE8\u89E3\u4E24\u79CD\u65B9\u5F0F\u6765\u5B9A\u4E49SQL\u6620\u5C04\u5173\u7CFB\u3002\u8FD9\u79CD\u5206\u79BB\u5F0F\u8BBE\u8BA1\u4F7F\u5F97SQL\u8BED\u53E5\u548CJava\u4EE3\u7801\u80FD\u591F\u72EC\u7ACB\u7BA1\u7406\u548C\u4F18\u5316\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"31-xml\u6620\u5C04\u6587\u4EF6\u8BE6\u89E3",children:"3.1 XML\u6620\u5C04\u6587\u4EF6\u8BE6\u89E3"}),"\n",(0,l.jsx)(n.p,{children:"XML\u6620\u5C04\u6587\u4EF6\u662FMyBatis\u4E2D\u5B9A\u4E49SQL\u8BED\u53E5\u7684\u4E3B\u8981\u65B9\u5F0F\uFF0C\u63D0\u4F9B\u4E86\u4E30\u5BCC\u7684\u914D\u7F6E\u9009\u9879\u548C\u7075\u6D3B\u7684\u8868\u8FBE\u80FD\u529B\u3002"}),"\n",(0,l.jsx)(n.mermaid,{value:"graph TD\n    A[mapper] --\x3e B[cache]\n    A --\x3e C[cache-ref]\n    A --\x3e D[resultMap]\n    D --\x3e D1[id]\n    D --\x3e D2[result]\n    D --\x3e D3[association]\n    D --\x3e D4[collection]\n    A --\x3e E[sql]\n    A --\x3e F[insert]\n    A --\x3e G[update]\n    A --\x3e H[delete]\n    A --\x3e I[select]\n    I --\x3e I1[\u53C2\u6570\u6620\u5C04]\n    I --\x3e I2[\u7ED3\u679C\u6620\u5C04]\n    I --\x3e I3[\u7F13\u5B58\u63A7\u5236]"}),"\n",(0,l.jsx)(c.A,{language:"xml",title:"\u5B8C\u6574\u7684XML\u6620\u5C04\u6587\u4EF6\u793A\u4F8B",children:`<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.UserMapper">
<!-- \u{7F13}\u{5B58}\u{914D}\u{7F6E} -->
<cache
  eviction="LRU"
  flushInterval="60000"
  size="512"
  readOnly="false"/>

<!-- \u{53EF}\u{91CD}\u{7528}SQL\u{7247}\u{6BB5} -->
<sql id="Base_Column_List">
  id, username, email, phone, create_time, update_time
</sql>

<!-- \u{7ED3}\u{679C}\u{6620}\u{5C04} -->
<resultMap id="UserResultMap" type="com.example.model.User">
  <id property="id" column="id" />
  <result property="username" column="username" />
  <result property="email" column="email" />
  <result property="phone" column="phone" />
  <result property="createTime" column="create_time" />
  <result property="updateTime" column="update_time" />
  <!-- \u{4E00}\u{5BF9}\u{4E00}\u{5173}\u{8054} -->
  <association property="profile" javaType="com.example.model.UserProfile">
    <id property="id" column="profile_id" />
    <result property="address" column="address" />
    <result property="avatar" column="avatar" />
  </association>
  <!-- \u{4E00}\u{5BF9}\u{591A}\u{5173}\u{8054} -->
  <collection property="orders" ofType="com.example.model.Order">
    <id property="id" column="order_id" />
    <result property="orderNo" column="order_no" />
    <result property="amount" column="amount" />
  </collection>
</resultMap>

<!-- \u{67E5}\u{8BE2}\u{8BED}\u{53E5} -->
<select id="getUserById" resultMap="UserResultMap" parameterType="long">
  SELECT 
    u.*, 
    p.id as profile_id, 
    p.address, 
    p.avatar
  FROM user u
  LEFT JOIN user_profile p ON u.id = p.user_id
  WHERE u.id = #{id}
</select>

<!-- \u{63D2}\u{5165}\u{8BED}\u{53E5} -->
<insert id="insertUser" parameterType="com.example.model.User" useGeneratedKeys="true" keyProperty="id">
  INSERT INTO user (username, email, phone, create_time)
  VALUES (#{username}, #{email}, #{phone}, #{createTime})
</insert>

<!-- \u{66F4}\u{65B0}\u{8BED}\u{53E5} -->
<update id="updateUser" parameterType="com.example.model.User">
  UPDATE user
  SET username = #{username},
      email = #{email},
      phone = #{phone},
      update_time = #{updateTime}
  WHERE id = #{id}
</update>

<!-- \u{5220}\u{9664}\u{8BED}\u{53E5} -->
<delete id="deleteUser" parameterType="long">
  DELETE FROM user WHERE id = #{id}
</delete>
</mapper>`}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"select",label:"\u67E5\u8BE2\u8BED\u53E5",children:[(0,l.jsx)(n.p,{children:"\u67E5\u8BE2\u8BED\u53E5\u662F\u6700\u5E38\u7528\u7684SQL\u64CD\u4F5C\uFF0CMyBatis\u63D0\u4F9B\u4E86\u4E30\u5BCC\u7684\u914D\u7F6E\u9009\u9879\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u67E5\u8BE2\u8BED\u53E5\u8BE6\u89E3"',children:'<select \n    id="findUserByCondition"          \x3c!-- \u552F\u4E00\u6807\u8BC6\uFF0C\u5BF9\u5E94Mapper\u63A5\u53E3\u65B9\u6CD5\u540D --\x3e\n    parameterType="map"               \x3c!-- \u53C2\u6570\u7C7B\u578B --\x3e\n    resultType="User"                 \x3c!-- \u7ED3\u679C\u7C7B\u578B --\x3e\n    resultMap="UserResultMap"         \x3c!-- \u7ED3\u679C\u6620\u5C04\u5F15\u7528 --\x3e\n    flushCache="false"                \x3c!-- \u662F\u5426\u5237\u65B0\u7F13\u5B58 --\x3e\n    useCache="true"                   \x3c!-- \u662F\u5426\u4F7F\u7528\u7F13\u5B58 --\x3e\n    timeout="10000"                   \x3c!-- \u8D85\u65F6\u65F6\u95F4(\u6BEB\u79D2) --\x3e\n    fetchSize="100"                   \x3c!-- \u7ED3\u679C\u96C6\u5927\u5C0F --\x3e\n    statementType="PREPARED"          \x3c!-- \u8BED\u53E5\u7C7B\u578B(STATEMENT/PREPARED/CALLABLE) --\x3e\n    resultSetType="FORWARD_ONLY">     \x3c!-- \u7ED3\u679C\u96C6\u7C7B\u578B --\x3e\n  SELECT \n    <include refid="Base_Column_List"/>\n  FROM user\n  <where>\n    <if test="username != null">\n      username LIKE CONCAT(\'%\', #{username}, \'%\')\n    </if>\n    <if test="email != null">\n      AND email = #{email}\n    </if>\n    <if test="startTime != null">\n      AND create_time >= #{startTime}\n    </if>\n  </where>\n  ORDER BY create_time DESC\n  LIMIT #{offset}, #{limit}\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"insert",label:"\u63D2\u5165\u8BED\u53E5",children:[(0,l.jsx)(n.p,{children:"\u63D2\u5165\u8BED\u53E5\u7528\u4E8E\u5411\u6570\u636E\u5E93\u6DFB\u52A0\u8BB0\u5F55\uFF0C\u652F\u6301\u81EA\u52A8\u751F\u6210\u4E3B\u952E\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u63D2\u5165\u8BED\u53E5\u8BE6\u89E3"',children:'<insert \n    id="insertUser"                   \x3c!-- \u552F\u4E00\u6807\u8BC6 --\x3e\n    parameterType="User"              \x3c!-- \u53C2\u6570\u7C7B\u578B --\x3e\n    flushCache="true"                 \x3c!-- \u662F\u5426\u5237\u65B0\u7F13\u5B58 --\x3e\n    timeout="20000"                   \x3c!-- \u8D85\u65F6\u65F6\u95F4(\u6BEB\u79D2) --\x3e\n    useGeneratedKeys="true"           \x3c!-- \u662F\u5426\u4F7F\u7528\u81EA\u52A8\u751F\u6210\u7684\u4E3B\u952E --\x3e\n    keyProperty="id"                  \x3c!-- \u81EA\u52A8\u751F\u6210\u7684\u4E3B\u952E\u8D4B\u503C\u7ED9\u53C2\u6570\u5BF9\u8C61\u7684\u5C5E\u6027 --\x3e\n    keyColumn="id">                   \x3c!-- \u81EA\u52A8\u751F\u6210\u4E3B\u952E\u7684\u5217\u540D --\x3e\n  INSERT INTO user (\n    username, \n    email, \n    password,\n    status,\n    create_time\n  ) VALUES (\n    #{username},\n    #{email},\n    #{password},\n    #{status},\n    #{createTime}\n  )\n</insert>\n\n\x3c!-- \u6279\u91CF\u63D2\u5165 --\x3e\n<insert id="batchInsertUsers" parameterType="list">\n  INSERT INTO user (username, email, password, status, create_time)\n  VALUES \n  <foreach collection="list" item="user" separator=",">\n    (#{user.username}, #{user.email}, #{user.password}, #{user.status}, #{user.createTime})\n  </foreach>\n</insert>\n'})})]}),(0,l.jsxs)(a.A,{value:"update",label:"\u66F4\u65B0\u8BED\u53E5",children:[(0,l.jsx)(n.p,{children:"\u66F4\u65B0\u8BED\u53E5\u7528\u4E8E\u4FEE\u6539\u6570\u636E\u5E93\u8BB0\u5F55\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u66F4\u65B0\u8BED\u53E5\u8BE6\u89E3"',children:'<update \n    id="updateUser"                   \x3c!-- \u552F\u4E00\u6807\u8BC6 --\x3e\n    parameterType="User"              \x3c!-- \u53C2\u6570\u7C7B\u578B --\x3e\n    flushCache="true"                 \x3c!-- \u662F\u5426\u5237\u65B0\u7F13\u5B58 --\x3e\n    timeout="20000">                  \x3c!-- \u8D85\u65F6\u65F6\u95F4(\u6BEB\u79D2) --\x3e\n  UPDATE user\n  <set>\n    <if test="username != null">username = #{username},</if>\n    <if test="email != null">email = #{email},</if>\n    <if test="password != null">password = #{password},</if>\n    <if test="status != null">status = #{status},</if>\n    update_time = #{updateTime}\n  </set>\n  WHERE id = #{id}\n</update>\n\n\x3c!-- \u6279\u91CF\u66F4\u65B0 --\x3e\n<update id="batchUpdateStatus" parameterType="map">\n  UPDATE user\n  SET status = #{status}\n  WHERE id IN \n  <foreach collection="ids" item="id" open="(" separator="," close=")">\n    #{id}\n  </foreach>\n</update>\n'})})]}),(0,l.jsxs)(a.A,{value:"delete",label:"\u5220\u9664\u8BED\u53E5",children:[(0,l.jsx)(n.p,{children:"\u5220\u9664\u8BED\u53E5\u7528\u4E8E\u5220\u9664\u6570\u636E\u5E93\u8BB0\u5F55\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u5220\u9664\u8BED\u53E5\u8BE6\u89E3"',children:'<delete \n    id="deleteUser"                   \x3c!-- \u552F\u4E00\u6807\u8BC6 --\x3e\n    parameterType="long"              \x3c!-- \u53C2\u6570\u7C7B\u578B --\x3e\n    flushCache="true"                 \x3c!-- \u662F\u5426\u5237\u65B0\u7F13\u5B58 --\x3e\n    timeout="20000">                  \x3c!-- \u8D85\u65F6\u65F6\u95F4(\u6BEB\u79D2) --\x3e\n  DELETE FROM user\n  WHERE id = #{id}\n</delete>\n\n\x3c!-- \u6279\u91CF\u5220\u9664 --\x3e\n<delete id="batchDeleteUsers" parameterType="list">\n  DELETE FROM user\n  WHERE id IN\n  <foreach collection="list" item="id" open="(" separator="," close=")">\n    #{id}\n  </foreach>\n</delete>\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"32-\u6CE8\u89E3\u6620\u5C04\u65B9\u5F0F",children:"3.2 \u6CE8\u89E3\u6620\u5C04\u65B9\u5F0F"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u652F\u6301\u4F7F\u7528Java\u6CE8\u89E3\u6765\u5B9A\u4E49SQL\u6620\u5C04\uFF0C\u9002\u5408\u4E8E\u7B80\u5355\u7684SQL\u8BED\u53E5\uFF0C\u4E0D\u9700\u8981XML\u6587\u4EF6\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u6CE8\u89E3\u6620\u5C04\u793A\u4F8B"',children:'public interface UserMapper {\n    \n    @Select("SELECT * FROM user WHERE id = #{id}")\n    User getUserById(Long id);\n    \n    @Insert("INSERT INTO user (username, email, phone, create_time) " +\n           "VALUES (#{username}, #{email}, #{phone}, #{createTime})")\n    @Options(useGeneratedKeys = true, keyProperty = "id")\n    int insertUser(User user);\n    \n    @Update("UPDATE user SET username = #{username}, email = #{email}, " +\n           "phone = #{phone}, update_time = #{updateTime} WHERE id = #{id}")\n    int updateUser(User user);\n    \n    @Delete("DELETE FROM user WHERE id = #{id}")\n    int deleteUser(Long id);\n    \n    // \u7ED3\u679C\u6620\u5C04\n    @Select("SELECT * FROM user WHERE id = #{id}")\n    @Results(id = "userResultMap", value = {\n        @Result(property = "id", column = "id", id = true),\n        @Result(property = "username", column = "username"),\n        @Result(property = "email", column = "email"),\n        @Result(property = "createTime", column = "create_time"),\n        @Result(property = "updateTime", column = "update_time")\n    })\n    User getUserWithMapping(Long id);\n    \n    // \u4E00\u5BF9\u4E00\u5173\u8054\n    @Select("SELECT u.*, p.id as profile_id, p.address, p.avatar FROM user u " +\n           "LEFT JOIN user_profile p ON u.id = p.user_id WHERE u.id = #{id}")\n    @Results({\n        @Result(property = "id", column = "id", id = true),\n        @Result(property = "username", column = "username"),\n        @Result(property = "email", column = "email"),\n        @Result(property = "profile", javaType = UserProfile.class, \n                column = "id", one = @One(select = "getProfileByUserId"))\n    })\n    User getUserWithProfile(Long id);\n    \n    @Select("SELECT * FROM user_profile WHERE user_id = #{userId}")\n    UserProfile getProfileByUserId(Long userId);\n    \n    // \u4E00\u5BF9\u591A\u5173\u8054\n    @Select("SELECT * FROM user WHERE id = #{id}")\n    @Results({\n        @Result(property = "id", column = "id", id = true),\n        @Result(property = "username", column = "username"),\n        @Result(property = "orders", javaType = List.class, \n                column = "id", many = @Many(select = "getOrdersByUserId"))\n    })\n    User getUserWithOrders(Long id);\n    \n    @Select("SELECT * FROM orders WHERE user_id = #{userId}")\n    List<Order> getOrdersByUserId(Long userId);\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"33-\u4E24\u79CD\u6620\u5C04\u65B9\u5F0F\u5BF9\u6BD4",children:"3.3 \u4E24\u79CD\u6620\u5C04\u65B9\u5F0F\u5BF9\u6BD4"}),"\n",(0,l.jsx)(n.p,{children:"XML\u6620\u5C04\u548C\u6CE8\u89E3\u6620\u5C04\u5404\u6709\u4F18\u7F3A\u70B9\uFF0C\u9009\u62E9\u5408\u9002\u7684\u65B9\u5F0F\u53D6\u51B3\u4E8E\u9879\u76EE\u9700\u6C42\u548C\u56E2\u961F\u504F\u597D\u3002"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u7279\u6027"}),(0,l.jsx)(n.th,{children:"XML\u6620\u5C04"}),(0,l.jsx)(n.th,{children:"\u6CE8\u89E3\u6620\u5C04"}),(0,l.jsx)(n.th,{children:"\u8BF4\u660E"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u53EF\u8BFB\u6027"})}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50\u2B50\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"XML\u66F4\u9002\u5408\u5927\u578B\u590D\u6742SQL"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u7EF4\u62A4\u6027"})}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"XML\u5206\u79BBSQL\u4E0E\u4EE3\u7801\uFF0C\u66F4\u6613\u7EF4\u62A4"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u52A8\u6001SQL"})}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50\u2B50\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"XML\u5BF9\u52A8\u6001SQL\u652F\u6301\u66F4\u5168\u9762"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u590D\u6742\u6620\u5C04"})}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50\u2B50\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"XML\u9002\u5408\u590D\u6742\u7ED3\u679C\u6620\u5C04"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u5F00\u53D1\u6548\u7387"})}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50\u2B50\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"\u6CE8\u89E3\u7B80\u5355\u5FEB\u6377"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"SQL\u91CD\u7528"})}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50\u2B50\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"XML\u53EF\u63D0\u53D6\u516C\u5171SQL\u7247\u6BB5"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u7F16\u8BD1\u65F6\u68C0\u67E5"})}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"\u2B50\u2B50\u2B50\u2B50"}),(0,l.jsx)(n.td,{children:"\u6CE8\u89E3\u53EF\u5728\u7F16\u8BD1\u65F6\u68C0\u67E5"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u9002\u7528\u573A\u666F"})}),(0,l.jsx)(n.td,{children:"\u590D\u6742SQL\uFF0C\u591A\u8868\u5173\u8054"}),(0,l.jsx)(n.td,{children:"\u7B80\u5355CRUD\uFF0C\u5355\u8868\u64CD\u4F5C"}),(0,l.jsx)(n.td,{children:"-"})]})]})]}),"\n",(0,l.jsx)(n.admonition,{title:"\u6700\u4F73\u5B9E\u8DF5\u5EFA\u8BAE",type:"tip",children:(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6DF7\u5408\u4F7F\u7528"}),"\uFF1A\u6839\u636ESQL\u590D\u6742\u5EA6\u9009\u62E9\u5408\u9002\u7684\u65B9\u5F0F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7B80\u5355\u64CD\u4F5C"}),"\uFF1A\u5355\u8868\u7684CRUD\u64CD\u4F5C\u4F7F\u7528\u6CE8\u89E3"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u590D\u6742\u67E5\u8BE2"}),"\uFF1A\u591A\u8868\u5173\u8054\u3001\u52A8\u6001\u6761\u4EF6\u4F7F\u7528XML"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u56E2\u961F\u7EDF\u4E00"}),"\uFF1A\u9879\u76EE\u4E2D\u4FDD\u6301\u4E00\u81F4\u7684\u98CE\u683C\uFF0C\u907F\u514D\u6DF7\u4E71"]}),"\n"]})}),"\n",(0,l.jsx)(n.h3,{id:"34-sql\u6784\u5EFA\u5668\u4F7F\u7528",children:"3.4 SQL\u6784\u5EFA\u5668\u4F7F\u7528"}),"\n",(0,l.jsx)(n.p,{children:"\u5BF9\u4E8E\u4E2D\u7B49\u590D\u6742\u5EA6\u7684SQL\uFF0CMyBatis\u63D0\u4F9B\u4E86SQL\u6784\u5EFA\u5668API\uFF0C\u53EF\u4EE5\u901A\u8FC7Java\u4EE3\u7801\u52A8\u6001\u6784\u5EFASQL\u8BED\u53E5\uFF0C\u6BD4XML\u66F4\u7075\u6D3B\uFF0C\u6BD4\u6CE8\u89E3\u66F4\u5F3A\u5927\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="SQL\u6784\u5EFA\u5668\u793A\u4F8B"',children:'public interface UserMapper {\n    \n    @SelectProvider(type = UserSqlProvider.class, method = "findByCondition")\n    List<User> findByCondition(UserQuery query);\n    \n    @InsertProvider(type = UserSqlProvider.class, method = "insert")\n    @Options(useGeneratedKeys = true, keyProperty = "id")\n    int insert(User user);\n    \n    @UpdateProvider(type = UserSqlProvider.class, method = "update")\n    int update(User user);\n    \n    @DeleteProvider(type = UserSqlProvider.class, method = "deleteById")\n    int deleteById(Long id);\n}\n\nclass UserSqlProvider {\n    \n    public String findByCondition(UserQuery query) {\n        return new SQL() {{\n            SELECT("id, username, email, phone, status, create_time, update_time");\n            FROM("user");\n            \n            if (query.getUsername() != null) {\n                WHERE("username LIKE CONCAT(\'%\', #{username}, \'%\')");\n            }\n            \n            if (query.getStatus() != null) {\n                WHERE("status = #{status}");\n            }\n            \n            if (query.getStartTime() != null) {\n                WHERE("create_time >= #{startTime}");\n            }\n            \n            if (query.getEndTime() != null) {\n                WHERE("create_time <= #{endTime}");\n            }\n            \n            ORDER_BY("create_time DESC");\n        }}.toString();\n    }\n    \n    public String insert(User user) {\n        return new SQL() {{\n            INSERT_INTO("user");\n            VALUES("username", "#{username}");\n            VALUES("email", "#{email}");\n            VALUES("phone", "#{phone}");\n            VALUES("password", "#{password}");\n            VALUES("status", "#{status}");\n            VALUES("create_time", "#{createTime}");\n        }}.toString();\n    }\n    \n    public String update(User user) {\n        return new SQL() {{\n            UPDATE("user");\n            \n            if (user.getUsername() != null) {\n                SET("username = #{username}");\n            }\n            \n            if (user.getEmail() != null) {\n                SET("email = #{email}");\n            }\n            \n            if (user.getPhone() != null) {\n                SET("phone = #{phone}");\n            }\n            \n            if (user.getStatus() != null) {\n                SET("status = #{status}");\n            }\n            \n            SET("update_time = #{updateTime}");\n            WHERE("id = #{id}");\n        }}.toString();\n    }\n    \n    public String deleteById(Long id) {\n        return new SQL() {{\n            DELETE_FROM("user");\n            WHERE("id = #{id}");\n        }}.toString();\n    }\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"SQL\u6784\u5EFA\u5668API\u7684\u4E3B\u8981\u4F18\u52BF\uFF1A"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7C7B\u578B\u5B89\u5168"}),"\uFF1A\u4F7F\u7528Java\u4EE3\u7801\u6784\u5EFASQL\uFF0C\u53EF\u4EE5\u5728\u7F16\u8BD1\u65F6\u68C0\u67E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4EE3\u7801\u91CD\u7528"}),"\uFF1A\u53EF\u4EE5\u5C01\u88C5\u5E38\u7528\u7684SQL\u7247\u6BB5\u4E3A\u65B9\u6CD5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7075\u6D3B\u52A8\u6001"}),"\uFF1A\u6BD4\u6CE8\u89E3\u66F4\u7075\u6D3B\uFF0C\u6BD4XML\u66F4\u76F4\u89C2"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6613\u4E8E\u8C03\u8BD5"}),"\uFF1A\u53EF\u4EE5\u5728\u6784\u5EFA\u8FC7\u7A0B\u4E2D\u6DFB\u52A0\u65E5\u5FD7\u6216\u65AD\u70B9"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"SQL\u6784\u5EFA\u5668\u7684\u65B9\u6CD5\u5217\u8868\uFF1A"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"SELECT(String)"}),": \u6DFB\u52A0\u5217\u5230SELECT\u5B50\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"SELECT_DISTINCT(String)"}),": \u6DFB\u52A0DISTINCT\u5217\u5230SELECT\u5B50\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"FROM(String)"}),": \u6DFB\u52A0\u8868\u5230FROM\u5B50\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"JOIN(String)"}),": \u6DFB\u52A0JOIN\u5B50\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"INNER_JOIN(String)"}),": \u6DFB\u52A0INNER JOIN\u5B50\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"LEFT_OUTER_JOIN(String)"}),": \u6DFB\u52A0LEFT OUTER JOIN\u5B50\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"RIGHT_OUTER_JOIN(String)"}),": \u6DFB\u52A0RIGHT OUTER JOIN\u5B50\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"WHERE(String)"}),": \u6DFB\u52A0WHERE\u6761\u4EF6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"OR()"}),": \u6DFB\u52A0OR\u8FDE\u63A5\u7B26"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"AND()"}),": \u6DFB\u52A0AND\u8FDE\u63A5\u7B26"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"GROUP_BY(String)"}),": \u6DFB\u52A0GROUP BY\u5B50\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"HAVING(String)"}),": \u6DFB\u52A0HAVING\u6761\u4EF6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ORDER_BY(String)"}),": \u6DFB\u52A0ORDER BY\u5B50\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"INSERT_INTO(String)"}),": \u8BBE\u7F6EINSERT\u76EE\u6807\u8868"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"VALUES(String, String)"}),": \u6DFB\u52A0INSERT\u503C"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"UPDATE(String)"}),": \u8BBE\u7F6EUPDATE\u76EE\u6807\u8868"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"SET(String)"}),": \u6DFB\u52A0SET\u5B50\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"DELETE_FROM(String)"}),": \u8BBE\u7F6EDELETE\u76EE\u6807\u8868"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"4-\u52A8\u6001sql\u4E0E\u590D\u6742\u67E5\u8BE2",children:"4. \u52A8\u6001SQL\u4E0E\u590D\u6742\u67E5\u8BE2"}),"\n",(0,l.jsx)(n.p,{children:"\u52A8\u6001SQL\u662FMyBatis\u6700\u5F3A\u5927\u7684\u7279\u6027\u4E4B\u4E00\uFF0C\u5141\u8BB8\u6839\u636E\u53C2\u6570\u6761\u4EF6\u52A8\u6001\u751F\u6210\u4E0D\u540C\u7684SQL\u8BED\u53E5\uFF0C\u6781\u5927\u5730\u7B80\u5316\u4E86\u590D\u6742\u67E5\u8BE2\u7684\u6784\u5EFA\u8FC7\u7A0B\u3002"}),"\n",(0,l.jsx)(n.mermaid,{value:"graph LR\n    A[\u52A8\u6001SQL\u6807\u7B7E] --\x3e B[if]\n    A --\x3e C[choose/when/otherwise]\n    A --\x3e D[where]\n    A --\x3e E[set]\n    A --\x3e F[trim]\n    A --\x3e G[foreach]\n    A --\x3e H[bind]"}),"\n",(0,l.jsx)(n.h3,{id:"41-\u6761\u4EF6\u67E5\u8BE2\u6784\u5EFA",children:"4.1 \u6761\u4EF6\u67E5\u8BE2\u6784\u5EFA"}),"\n",(0,l.jsx)(n.p,{children:"\u6761\u4EF6\u67E5\u8BE2\u662F\u6700\u5E38\u89C1\u7684\u52A8\u6001SQL\u573A\u666F\uFF0CMyBatis\u63D0\u4F9B\u4E86\u591A\u79CD\u6807\u7B7E\u6765\u5904\u7406\u6761\u4EF6\u903B\u8F91\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"if",label:"if\u6807\u7B7E",children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"if"}),"\u6807\u7B7E\u662F\u6700\u57FA\u672C\u7684\u6761\u4EF6\u6807\u7B7E\uFF0C\u6839\u636E\u6D4B\u8BD5\u6761\u4EF6\u51B3\u5B9A\u662F\u5426\u5305\u542B\u6807\u7B7E\u4F53\u5185\u7684SQL\u7247\u6BB5\uFF1A"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="if\u6807\u7B7E\u793A\u4F8B"',children:'<select id="findUsers" resultType="User">\n  SELECT * FROM user\n  WHERE 1=1\n  <if test="username != null and username != \'\'">\n    AND username LIKE CONCAT(\'%\', #{username}, \'%\')\n  </if>\n  <if test="status != null">\n    AND status = #{status}\n  </if>\n  <if test="startDate != null">\n    AND create_time >= #{startDate}\n  </if>\n  <if test="endDate != null">\n    AND create_time <= #{endDate}\n  </if>\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"where",label:"where\u6807\u7B7E",children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"where"}),"\u6807\u7B7E\u4F1A\u667A\u80FD\u5904\u7406\u6761\u4EF6\u8BED\u53E5\uFF0C\u81EA\u52A8\u6DFB\u52A0WHERE\u5173\u952E\u5B57\uFF0C\u5E76\u53BB\u9664\u591A\u4F59\u7684AND/OR\u524D\u7F00\uFF1A"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="where\u6807\u7B7E\u793A\u4F8B"',children:'<select id="findUsers" resultType="User">\n  SELECT * FROM user\n  <where>\n    <if test="username != null and username != \'\'">\n      username LIKE CONCAT(\'%\', #{username}, \'%\')\n    </if>\n    <if test="status != null">\n      AND status = #{status}\n    </if>\n    <if test="startDate != null">\n      AND create_time >= #{startDate}\n    </if>\n    <if test="endDate != null">\n      AND create_time <= #{endDate}\n    </if>\n  </where>\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"choose",label:"choose\u6807\u7B7E",children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"choose"}),"\u6807\u7B7E\u7C7B\u4F3C\u4E8EJava\u4E2D\u7684switch\u8BED\u53E5\uFF0C\u63D0\u4F9B\u591A\u4E2A\u6761\u4EF6\u4E2D\u9009\u62E9\u4E00\u4E2A\u7684\u80FD\u529B\uFF1A"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="choose\u6807\u7B7E\u793A\u4F8B"',children:'<select id="findUsersBySort" resultType="User">\n  SELECT * FROM user\n  <where>\n    <if test="status != null">\n      status = #{status}\n    </if>\n  </where>\n  <choose>\n    <when test="sortBy == \'username\'">\n      ORDER BY username\n    </when>\n    <when test="sortBy == \'createTime\'">\n      ORDER BY create_time\n    </when>\n    <otherwise>\n      ORDER BY id\n    </otherwise>\n  </choose>\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"trim",label:"trim\u6807\u7B7E",children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"trim"}),"\u6807\u7B7E\u63D0\u4F9B\u4E86\u66F4\u7075\u6D3B\u7684\u524D\u7F00/\u540E\u7F00\u5904\u7406\u80FD\u529B\uFF1A"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="trim\u6807\u7B7E\u793A\u4F8B"',children:'<select id="findUsers" resultType="User">\n  SELECT * FROM user\n  <trim prefix="WHERE" prefixOverrides="AND|OR">\n    <if test="username != null and username != \'\'">\n      AND username LIKE CONCAT(\'%\', #{username}, \'%\')\n    </if>\n    <if test="status != null">\n      AND status = #{status}\n    </if>\n  </trim>\n</select>\n'})})]})]}),"\n",(0,l.jsx)(n.p,{children:"OGNL\u8868\u8FBE\u5F0F\u662FMyBatis\u52A8\u6001SQL\u7684\u6838\u5FC3\uFF0C\u7528\u4E8E\u6761\u4EF6\u6D4B\u8BD5\u548C\u53C2\u6570\u8BBF\u95EE\uFF1A"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"OGNL\u8868\u8FBE\u5F0F"}),(0,l.jsx)(n.th,{children:"\u63CF\u8FF0"}),(0,l.jsx)(n.th,{children:"\u793A\u4F8B"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5C5E\u6027\u8BBF\u95EE"}),(0,l.jsx)(n.td,{children:"\u8BBF\u95EEJavaBean\u5C5E\u6027"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"username != null"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5D4C\u5957\u5C5E\u6027"}),(0,l.jsx)(n.td,{children:"\u8BBF\u95EE\u5D4C\u5957\u5C5E\u6027"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"user.address.city == 'Beijing'"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u96C6\u5408\u8BBF\u95EE"}),(0,l.jsx)(n.td,{children:"\u8BBF\u95EEList/Map\u5143\u7D20"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"users[0].name == 'admin'"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u65B9\u6CD5\u8C03\u7528"}),(0,l.jsx)(n.td,{children:"\u8C03\u7528\u5BF9\u8C61\u65B9\u6CD5"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"username.length() > 5"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u9759\u6001\u65B9\u6CD5"}),(0,l.jsx)(n.td,{children:"\u8C03\u7528\u9759\u6001\u65B9\u6CD5"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"@java.lang.Math@max(id1, id2)"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u903B\u8F91\u8FD0\u7B97\u7B26"}),(0,l.jsx)(n.td,{children:"\u903B\u8F91\u7EC4\u5408"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"age > 18 and age < 60"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u4E09\u5143\u8FD0\u7B97\u7B26"}),(0,l.jsx)(n.td,{children:"\u6761\u4EF6\u9009\u62E9"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"isVip ? price*0.8 : price"})})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"42-\u5FAA\u73AF\u4E0E\u6279\u91CF\u64CD\u4F5C",children:"4.2 \u5FAA\u73AF\u4E0E\u6279\u91CF\u64CD\u4F5C"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"foreach"}),"\u6807\u7B7E\u662F\u5904\u7406\u96C6\u5408\u53C2\u6570\u7684\u5F3A\u5927\u5DE5\u5177\uFF0C\u9002\u7528\u4E8EIN\u6761\u4EF6\u3001\u6279\u91CF\u63D2\u5165\u7B49\u573A\u666F\u3002"]}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsx)(a.A,{value:"in",label:"IN\u6761\u4EF6\u67E5\u8BE2",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="IN\u6761\u4EF6\u67E5\u8BE2"',children:'<select id="findUsersByIds" resultType="User">\n  SELECT * FROM user\n  WHERE id IN\n  <foreach collection="list" item="id" open="(" separator="," close=")">\n    #{id}\n  </foreach>\n</select>\n'})})}),(0,l.jsx)(a.A,{value:"batch-insert",label:"\u6279\u91CF\u63D2\u5165",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u6279\u91CF\u63D2\u5165"',children:'<insert id="batchInsert" parameterType="list">\n  INSERT INTO user (username, email, status, create_time)\n  VALUES\n  <foreach collection="list" item="user" separator=",">\n    (#{user.username}, #{user.email}, #{user.status}, #{user.createTime})\n  </foreach>\n</insert>\n'})})}),(0,l.jsx)(a.A,{value:"batch-update",label:"\u6279\u91CF\u66F4\u65B0",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u6279\u91CF\u66F4\u65B0"',children:'<update id="batchUpdate" parameterType="list">\n  <foreach collection="list" item="item" separator=";">\n    UPDATE user\n    <set>\n      username = #{item.username},\n      email = #{item.email},\n      update_time = #{item.updateTime}\n    </set>\n    WHERE id = #{item.id}\n  </foreach>\n</update>\n'})})}),(0,l.jsx)(a.A,{value:"complex-param",label:"\u590D\u6742\u53C2\u6570\u5904\u7406",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u590D\u6742\u53C2\u6570\u5904\u7406"',children:'<select id="findUsersByFilter" resultType="User">\n  SELECT * FROM user\n  <where>\n    <if test="filter.nameList != null and filter.nameList.size() > 0">\n      username IN\n      <foreach collection="filter.nameList" item="name" open="(" separator="," close=")">\n        #{name}\n      </foreach>\n    </if>\n    <if test="filter.statusMap != null and filter.statusMap.size() > 0">\n      AND\n      <foreach collection="filter.statusMap" index="key" item="value" open="(" separator="OR" close=")">\n        (${key} = #{value})\n      </foreach>\n    </if>\n  </where>\n</select>\n'})})})]}),"\n",(0,l.jsx)(n.p,{children:"foreach\u6807\u7B7E\u7684\u5C5E\u6027\u89E3\u6790\uFF1A"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"collection"}),": \u8981\u8FED\u4EE3\u7684\u96C6\u5408\u540D\u79F0\uFF08list\u3001array\u3001map\u7B49\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"item"}),": \u5F53\u524D\u8FED\u4EE3\u7684\u5143\u7D20"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"index"}),": \u5F53\u524D\u8FED\u4EE3\u7684\u7D22\u5F15\uFF08List\uFF09\u6216\u952E\uFF08Map\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"open"}),": \u62FC\u63A5\u5F00\u59CB\u7684\u5B57\u7B26\u4E32"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"close"}),": \u62FC\u63A5\u7ED3\u675F\u7684\u5B57\u7B26\u4E32"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"separator"}),": \u5143\u7D20\u4E4B\u95F4\u7684\u5206\u9694\u7B26"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"43-\u52A8\u6001\u8868\u540D\u4E0E\u5217\u540D",children:"4.3 \u52A8\u6001\u8868\u540D\u4E0E\u5217\u540D"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u67D0\u4E9B\u573A\u666F\u4E0B\uFF0C\u9700\u8981\u52A8\u6001\u6307\u5B9A\u8868\u540D\u6216\u5217\u540D\uFF0CMyBatis\u4E5F\u63D0\u4F9B\u4E86\u76F8\u5E94\u7684\u89E3\u51B3\u65B9\u6848\u3002"}),"\n",(0,l.jsx)(n.admonition,{title:"\u6CE8\u610F",type:"warning",children:(0,l.jsxs)(n.p,{children:["\u52A8\u6001\u8868\u540D\u548C\u5217\u540D\u4F7F\u7528",(0,l.jsx)(n.code,{children:"${}"}),"\u8BED\u6CD5\uFF0C\u4F1A\u6709SQL\u6CE8\u5165\u98CE\u9669\uFF0C\u5FC5\u987B\u786E\u4FDD\u53C2\u6570\u6765\u6E90\u5B89\u5168\u53EF\u63A7\uFF01"]})}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"table",label:"\u52A8\u6001\u8868\u540D",children:[(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u52A8\u6001\u8868\u540D"',children:'<select id="selectFromTable" resultType="map">\n  SELECT * FROM ${tableName} WHERE id = #{id}\n</select>\n'})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'// \u4F7F\u7528\u793A\u4F8B\nMap<String, Object> data = mapper.selectFromTable("user_20230101", 1001);\n'})})]}),(0,l.jsxs)(a.A,{value:"column",label:"\u52A8\u6001\u5217\u540D",children:[(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u52A8\u6001\u5217\u540D"',children:'<select id="getUserSortedBy" resultType="User">\n  SELECT * FROM user ORDER BY ${columnName} ${order}\n</select>\n'})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'// \u4F7F\u7528\u793A\u4F8B - \u5FC5\u987B\u786E\u4FDD\u53C2\u6570\u503C\u5B89\u5168\nList<User> users = mapper.getUserSortedBy("create_time", "DESC");\n'})})]}),(0,l.jsxs)(a.A,{value:"safe-approach",label:"\u5B89\u5168\u5904\u7406\u65B9\u5F0F",children:[(0,l.jsx)(n.p,{children:"\u5BF9\u4E8E\u52A8\u6001\u8868\u540D\u548C\u5217\u540D\uFF0C\u5EFA\u8BAE\u4F7F\u7528\u767D\u540D\u5355\u65B9\u5F0F\u4FDD\u8BC1\u5B89\u5168\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5B89\u5168\u5904\u7406\u793A\u4F8B"',children:'public List<User> getUserSortedBy(String columnName, String order) {\n    // \u5217\u540D\u767D\u540D\u5355\n    Set<String> allowedColumns = new HashSet<>(Arrays.asList(\n        "id", "username", "email", "create_time", "update_time"));\n        \n    // \u6392\u5E8F\u65B9\u5F0F\u767D\u540D\u5355\n    Set<String> allowedOrders = new HashSet<>(Arrays.asList("ASC", "DESC"));\n    \n    // \u5B89\u5168\u68C0\u67E5\n    if (!allowedColumns.contains(columnName)) {\n        columnName = "id"; // \u9ED8\u8BA4\u503C\n    }\n    \n    if (!allowedOrders.contains(order.toUpperCase())) {\n        order = "ASC"; // \u9ED8\u8BA4\u503C\n    }\n    \n    return mapper.getUserSortedBy(columnName, order);\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"advanced-scenarios",label:"\u9AD8\u7EA7\u573A\u666F",children:[(0,l.jsx)(n.p,{children:"\u5BF9\u4E8E\u66F4\u590D\u6742\u7684\u52A8\u6001SQL\u9700\u6C42\uFF0C\u53EF\u4EE5\u4F7F\u7528SQL\u6784\u5EFA\u5668\u6216\u81EA\u5B9A\u4E49SQL\u63D0\u4F9B\u8005\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u9AD8\u7EA7\u52A8\u6001SQL"',children:'@SelectProvider(type = DynamicQueryProvider.class, method = "buildQuery")\n<T> List<T> executeCustomQuery(@Param("table") String table, \n                             @Param("columns") String[] columns,\n                             @Param("conditions") Map<String, Object> conditions,\n                             @Param("resultType") Class<T> resultType);\n\npublic class DynamicQueryProvider {\n    public String buildQuery(@Param("table") String table, \n                           @Param("columns") String[] columns,\n                           @Param("conditions") Map<String, Object> conditions) {\n        // \u5B89\u5168\u68C0\u67E5\n        validateTable(table);\n        validateColumns(columns);\n        \n        SQL sql = new SQL();\n        \n        // \u6784\u5EFA\u67E5\u8BE2\u5217\n        if (columns != null && columns.length > 0) {\n            for (String column : columns) {\n                sql.SELECT(column);\n            }\n        } else {\n            sql.SELECT("*");\n        }\n        \n        // \u6DFB\u52A0\u8868\u540D\n        sql.FROM(table);\n        \n        // \u6DFB\u52A0\u6761\u4EF6\n        if (conditions != null && !conditions.isEmpty()) {\n            for (Map.Entry<String, Object> entry : conditions.entrySet()) {\n                if (entry.getValue() != null) {\n                    sql.WHERE(entry.getKey() + " = #{conditions." + entry.getKey() + "}");\n                }\n            }\n        }\n        \n        return sql.toString();\n    }\n    \n    private void validateTable(String table) {\n        // \u8868\u540D\u767D\u540D\u5355\u68C0\u67E5\n        Set<String> allowedTables = new HashSet<>(Arrays.asList(\n            "user", "order", "product", "category"));\n        if (!allowedTables.contains(table)) {\n            throw new IllegalArgumentException("Invalid table name: " + table);\n        }\n    }\n    \n    private void validateColumns(String[] columns) {\n        // \u5217\u540D\u767D\u540D\u5355\u68C0\u67E5\n        if (columns == null) return;\n        \n        Set<String> allowedColumns = new HashSet<>(Arrays.asList(\n            "id", "name", "price", "create_time", "update_time"));\n        for (String column : columns) {\n            if (!allowedColumns.contains(column)) {\n                throw new IllegalArgumentException("Invalid column name: " + column);\n            }\n        }\n    }\n}\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"44-\u591A\u6570\u636E\u5E93\u652F\u6301",children:"4.4 \u591A\u6570\u636E\u5E93\u652F\u6301"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u63D0\u4F9B\u4E86DatabaseIdProvider\u673A\u5236\uFF0C\u53EF\u4EE5\u6839\u636E\u4E0D\u540C\u6570\u636E\u5E93\u7C7B\u578B\u9009\u62E9\u4E0D\u540C\u7684SQL\u8BED\u53E5\uFF0C\u5B9E\u73B0\u8DE8\u6570\u636E\u5E93\u517C\u5BB9\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u9996\u5148\u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\u5B9A\u4E49\u6570\u636E\u5E93\u5382\u5546\u6807\u8BC6\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="mybatis-config.xml"',children:'<databaseIdProvider type="DB_VENDOR">\n  <property name="MySQL" value="mysql"/>\n  <property name="Oracle" value="oracle"/>\n  <property name="SQL Server" value="sqlserver"/>\n  <property name="PostgreSQL" value="postgresql"/>\n</databaseIdProvider>\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540E\u5728Mapper XML\u4E2D\u4F7F\u7528databaseId\u5C5E\u6027\u533A\u5206\u4E0D\u540C\u6570\u636E\u5E93\u7684SQL\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u591A\u6570\u636E\u5E93\u652F\u6301\u793A\u4F8B"',children:'\x3c!-- MySQL\u7248\u672C --\x3e\n<select id="findUsers" resultType="User" databaseId="mysql">\n  SELECT * FROM user\n  <where>\n    <if test="createDate != null">\n      AND DATE(create_time) = #{createDate}\n    </if>\n  </where>\n  LIMIT #{offset}, #{limit}\n</select>\n\n\x3c!-- Oracle\u7248\u672C --\x3e\n<select id="findUsers" resultType="User" databaseId="oracle">\n  SELECT * FROM \n  (\n    SELECT ROWNUM rn, u.* FROM user u\n    <where>\n      <if test="createDate != null">\n        AND TRUNC(create_time) = #{createDate}\n      </if>\n    </where>\n    WHERE ROWNUM &lt;= #{offset} + #{limit}\n  )\n  WHERE rn > #{offset}\n</select>\n\n\x3c!-- SQL Server\u7248\u672C --\x3e\n<select id="findUsers" resultType="User" databaseId="sqlserver">\n  SELECT * FROM user\n  <where>\n    <if test="createDate != null">\n      AND CONVERT(date, create_time) = #{createDate}\n    </if>\n  </where>\n  ORDER BY id\n  OFFSET #{offset} ROWS FETCH NEXT #{limit} ROWS ONLY\n</select>\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u9488\u5BF9\u4E0D\u540C\u6570\u636E\u5E93\u7684\u4E3B\u8981\u5DEE\u5F02\u5904\u7406\uFF1A"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u529F\u80FD"}),(0,l.jsx)(n.th,{children:"MySQL"}),(0,l.jsx)(n.th,{children:"Oracle"}),(0,l.jsx)(n.th,{children:"SQL Server"}),(0,l.jsx)(n.th,{children:"PostgreSQL"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u5206\u9875\u67E5\u8BE2"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"LIMIT offset, limit"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"ROWNUM"})," \u6216 ",(0,l.jsx)(n.code,{children:"ROW_NUMBER()"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"OFFSET-FETCH"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"LIMIT-OFFSET"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u65E5\u671F\u5904\u7406"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"DATE(field)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"TRUNC(field)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CONVERT(date, field)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"field::date"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u5B57\u7B26\u4E32\u8FDE\u63A5"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CONCAT()"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"||"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"+"})," \u6216 ",(0,l.jsx)(n.code,{children:"CONCAT()"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"||"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u81EA\u589E\u4E3B\u952E"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"AUTO_INCREMENT"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"SEQUENCE"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"IDENTITY"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"SERIAL"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u6279\u91CF\u63D2\u5165"})}),(0,l.jsx)(n.td,{children:"\u591A\u503C\u8BED\u6CD5"}),(0,l.jsx)(n.td,{children:"\u8054\u5408\u67E5\u8BE2"}),(0,l.jsx)(n.td,{children:"\u8868\u53D8\u91CF"}),(0,l.jsx)(n.td,{children:"\u591A\u503C\u8BED\u6CD5"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"NULL\u6392\u5E8F"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"IS NULL DESC"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"NULLS LAST"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CASE WHEN"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"NULLS LAST"})})]})]})]}),"\n",(0,l.jsx)(n.admonition,{title:"\u6570\u636E\u5E93\u517C\u5BB9\u6700\u4F73\u5B9E\u8DF5",type:"tip",children:(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u62BD\u8C61\u516C\u5171SQL"}),"\uFF1A\u5C06\u5171\u540C\u90E8\u5206\u63D0\u53D6\u4E3ASQL\u7247\u6BB5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6570\u636E\u5E93\u7248\u672C\u68C0\u6D4B"}),"\uFF1A\u6839\u636EdatabaseId\u9009\u62E9\u9002\u5F53\u7684SQL"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5C01\u88C5\u7279\u6B8A\u5904\u7406"}),"\uFF1A\u5C06\u6570\u636E\u5E93\u7279\u5B9A\u529F\u80FD\u5C01\u88C5\u5230\u8F85\u52A9\u65B9\u6CD5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5206\u9875\u63D2\u4EF6"}),"\uFF1A\u4F7F\u7528PageHelper\u7B49\u63D2\u4EF6\u7EDF\u4E00\u5206\u9875\u5904\u7406"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u65B9\u8A00\u914D\u7F6E"}),"\uFF1A\u901A\u8FC7\u914D\u7F6E\u6587\u4EF6\u7BA1\u7406\u4E0D\u540C\u6570\u636E\u5E93\u65B9\u8A00"]}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"5-\u7ED3\u679C\u6620\u5C04\u4E0E\u5173\u8054\u67E5\u8BE2",children:"5. \u7ED3\u679C\u6620\u5C04\u4E0E\u5173\u8054\u67E5\u8BE2"}),"\n",(0,l.jsx)(n.p,{children:"\u7ED3\u679C\u6620\u5C04\u662FMyBatis\u7684\u6838\u5FC3\u529F\u80FD\u4E4B\u4E00\uFF0C\u5B83\u8D1F\u8D23\u5C06\u67E5\u8BE2\u7ED3\u679C\u96C6\u8F6C\u6362\u4E3AJava\u5BF9\u8C61\uFF0C\u5904\u7406\u5C5E\u6027\u540D\u4E0E\u5217\u540D\u7684\u6620\u5C04\u5173\u7CFB\uFF0C\u4EE5\u53CA\u7BA1\u7406\u590D\u6742\u7684\u5173\u8054\u5BF9\u8C61\u6620\u5C04\u3002"}),"\n",(0,l.jsx)(n.mermaid,{value:"graph TD\n    A[ResultMap] --\x3e B[id\u5C5E\u6027\u6620\u5C04]\n    A --\x3e C[\u666E\u901A\u5C5E\u6027\u6620\u5C04]\n    A --\x3e D[\u5173\u8054\u5BF9\u8C61\u6620\u5C04]\n    A --\x3e E[\u96C6\u5408\u6620\u5C04]\n    A --\x3e F[\u9274\u522B\u5668\u6620\u5C04]\n    \n    D --\x3e D1[\u5D4C\u5957\u7ED3\u679C\u6620\u5C04]\n    D --\x3e D2[\u5D4C\u5957\u67E5\u8BE2]\n    \n    E --\x3e E1[\u5D4C\u5957\u7ED3\u679C\u6620\u5C04]\n    E --\x3e E2[\u5D4C\u5957\u67E5\u8BE2]\n    \n    F --\x3e F1[\u6761\u4EF6\u5224\u65AD]\n    F1 --\x3e F2[\u4E0D\u540C\u6620\u5C04\u7B56\u7565]"}),"\n",(0,l.jsx)(n.h3,{id:"51-\u57FA\u7840\u7ED3\u679C\u6620\u5C04",children:"5.1 \u57FA\u7840\u7ED3\u679C\u6620\u5C04"}),"\n",(0,l.jsx)(n.p,{children:"\u57FA\u7840\u7ED3\u679C\u6620\u5C04\u5904\u7406\u7B80\u5355\u7684\u5217\u540D\u5230\u5C5E\u6027\u540D\u7684\u6620\u5C04\uFF0CMyBatis\u63D0\u4F9B\u4E86\u81EA\u52A8\u6620\u5C04\u548C\u624B\u52A8\u914D\u7F6E\u4E24\u79CD\u65B9\u5F0F\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"auto",label:"\u81EA\u52A8\u6620\u5C04",children:[(0,l.jsx)(n.p,{children:"\u5F53Java\u5C5E\u6027\u540D\u4E0E\u6570\u636E\u5E93\u5217\u540D\u5339\u914D\u6216\u7B26\u5408\u9A7C\u5CF0\u547D\u540D\u8F6C\u6362\u89C4\u5219\u65F6\uFF0CMyBatis\u53EF\u4EE5\u81EA\u52A8\u6620\u5C04\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u81EA\u52A8\u6620\u5C04\u793A\u4F8B"',children:'\x3c!-- \u542F\u7528\u9A7C\u5CF0\u547D\u540D\u8F6C\u6362 (mybatis-config.xml) --\x3e\n<settings>\n  <setting name="mapUnderscoreToCamelCase" value="true"/>\n</settings>\n\n\x3c!-- \u4F7F\u7528\u81EA\u52A8\u6620\u5C04 --\x3e\n<select id="getUser" resultType="com.example.model.User">\n  SELECT \n    id,\n    username,\n    email,\n    phone,\n    create_time,  \x3c!-- \u4F1A\u81EA\u52A8\u6620\u5C04\u5230createTime\u5C5E\u6027 --\x3e\n    update_time   \x3c!-- \u4F1A\u81EA\u52A8\u6620\u5C04\u5230updateTime\u5C5E\u6027 --\x3e\n  FROM user\n  WHERE id = #{id}\n</select>\n'})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5BF9\u5E94\u5B9E\u4F53\u7C7B"',children:"public class User {\n    private Long id;\n    private String username;\n    private String email;\n    private String phone;\n    private Date createTime;  // \u5BF9\u5E94create_time\u5217\n    private Date updateTime;  // \u5BF9\u5E94update_time\u5217\n    \n    // getter\u548Csetter\n}\n"})})]}),(0,l.jsxs)(a.A,{value:"manual",label:"\u624B\u52A8\u6620\u5C04",children:[(0,l.jsx)(n.p,{children:"\u5F53\u5217\u540D\u4E0E\u5C5E\u6027\u540D\u4E0D\u5339\u914D\u6216\u9700\u8981\u7279\u6B8A\u5904\u7406\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528resultMap\u8FDB\u884C\u624B\u52A8\u6620\u5C04\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u624B\u52A8\u6620\u5C04\u793A\u4F8B"',children:'\x3c!-- \u5B9A\u4E49\u7ED3\u679C\u6620\u5C04 --\x3e\n<resultMap id="UserResultMap" type="com.example.model.User">\n  <id property="id" column="user_id" />  \x3c!-- \u4E3B\u952E\u6620\u5C04 --\x3e\n  <result property="username" column="user_name" />  \x3c!-- \u666E\u901A\u5C5E\u6027\u6620\u5C04 --\x3e\n  <result property="email" column="user_email" />\n  <result property="phoneNumber" column="phone" />\n  <result property="createTime" column="gmt_create" />\n  <result property="updateTime" column="gmt_modified" />\n</resultMap>\n\n\x3c!-- \u4F7F\u7528\u7ED3\u679C\u6620\u5C04 --\x3e\n<select id="getUser" resultMap="UserResultMap">\n  SELECT \n    user_id,\n    user_name,\n    user_email,\n    phone,\n    gmt_create,\n    gmt_modified\n  FROM t_user\n  WHERE user_id = #{id}\n</select>\n'})})]})]}),"\n",(0,l.jsx)(n.h4,{id:"resultmap\u5C5E\u6027\u8BE6\u89E3",children:"resultMap\u5C5E\u6027\u8BE6\u89E3"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u5C5E\u6027"}),(0,l.jsx)(n.th,{children:"\u63CF\u8FF0"}),(0,l.jsx)(n.th,{children:"\u7528\u6CD5\u793A\u4F8B"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"id"})}),(0,l.jsx)(n.td,{children:"\u4E3B\u952E\u6620\u5C04\uFF0C\u7528\u4E8E\u533A\u5206\u76F8\u540CID\u7684\u5BF9\u8C61"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'<id property="id" column="user_id"/>'})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"result"})}),(0,l.jsx)(n.td,{children:"\u666E\u901A\u5C5E\u6027\u6620\u5C04"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'<result property="username" column="user_name"/>'})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"constructor"})}),(0,l.jsx)(n.td,{children:"\u4F7F\u7528\u6784\u9020\u51FD\u6570\u6CE8\u5165\u5C5E\u6027"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"<constructor><idArg/><arg/></constructor>"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"association"})}),(0,l.jsx)(n.td,{children:"\u4E00\u5BF9\u4E00\u5173\u8054\u6620\u5C04"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'<association property="profile" javaType="UserProfile"/>'})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"collection"})}),(0,l.jsx)(n.td,{children:"\u4E00\u5BF9\u591A\u5173\u8054\u6620\u5C04"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'<collection property="orders" ofType="Order"/>'})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"discriminator"})}),(0,l.jsx)(n.td,{children:"\u9274\u522B\u5668\u6620\u5C04\uFF0C\u6839\u636E\u5217\u503C\u9009\u62E9\u6620\u5C04\u65B9\u5F0F"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'<discriminator javaType="int" column="type"/>'})})]})]})]}),"\n",(0,l.jsx)(n.h4,{id:"\u7C7B\u578B\u8F6C\u6362",children:"\u7C7B\u578B\u8F6C\u6362"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u4F1A\u81EA\u52A8\u5904\u7406Java\u7C7B\u578B\u4E0E\u6570\u636E\u5E93\u7C7B\u578B\u4E4B\u95F4\u7684\u8F6C\u6362\uFF0C\u4E5F\u53EF\u4EE5\u901A\u8FC7typeHandler\u6307\u5B9A\u81EA\u5B9A\u4E49\u7C7B\u578B\u5904\u7406\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u7C7B\u578B\u5904\u7406\u5668\u793A\u4F8B"',children:'<resultMap id="UserMap" type="User">\n  <id property="id" column="id"/>\n  <result property="createdAt" column="created_at" \n          typeHandler="com.example.handler.LocalDateTimeHandler"/>\n  <result property="status" column="status" \n          typeHandler="org.apache.ibatis.type.EnumOrdinalTypeHandler"/>\n  <result property="settings" column="settings" \n          typeHandler="com.example.handler.JsonTypeHandler"/>\n</resultMap>\n'})}),"\n",(0,l.jsx)(n.h3,{id:"52-\u4E00\u5BF9\u4E00\u5173\u8054\u67E5\u8BE2",children:"5.2 \u4E00\u5BF9\u4E00\u5173\u8054\u67E5\u8BE2"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u63D0\u4F9B\u4E86\u5F3A\u5927\u7684\u4E00\u5BF9\u4E00\u5173\u8054\u67E5\u8BE2\u80FD\u529B\uFF0C\u652F\u6301\u5D4C\u5957\u7ED3\u679C\u548C\u5D4C\u5957\u67E5\u8BE2\u4E24\u79CD\u65B9\u5F0F\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"nested-result",label:"\u5D4C\u5957\u7ED3\u679C\u6620\u5C04",children:[(0,l.jsx)(n.p,{children:"\u5D4C\u5957\u7ED3\u679C\u6620\u5C04\u901A\u8FC7\u4E00\u6B21SQL\u67E5\u8BE2\u83B7\u53D6\u4E3B\u5BF9\u8C61\u548C\u5173\u8054\u5BF9\u8C61\u7684\u6240\u6709\u6570\u636E\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u5D4C\u5957\u7ED3\u679C\u6620\u5C04\u793A\u4F8B"',children:'<resultMap id="UserWithProfileMap" type="User">\n  <id property="id" column="user_id"/>\n  <result property="username" column="username"/>\n  <result property="email" column="email"/>\n  \n  \x3c!-- \u5D4C\u5957\u7ED3\u679C\u6620\u5C04 - \u4E00\u5BF9\u4E00\u5173\u8054 --\x3e\n  <association property="profile" javaType="UserProfile">\n    <id property="id" column="profile_id"/>\n    <result property="address" column="address"/>\n    <result property="phone" column="phone"/>\n    <result property="avatar" column="avatar"/>\n  </association>\n</resultMap>\n\n<select id="getUserWithProfile" resultMap="UserWithProfileMap">\n  SELECT \n    u.id as user_id,\n    u.username,\n    u.email,\n    p.id as profile_id,\n    p.address,\n    p.phone,\n    p.avatar\n  FROM user u\n  LEFT JOIN user_profile p ON u.id = p.user_id\n  WHERE u.id = #{id}\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"nested-query",label:"\u5D4C\u5957\u67E5\u8BE2",children:[(0,l.jsx)(n.p,{children:"\u5D4C\u5957\u67E5\u8BE2\u901A\u8FC7\u6267\u884C\u989D\u5916\u7684SQL\u8BED\u53E5\u6765\u52A0\u8F7D\u5173\u8054\u5BF9\u8C61\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u5D4C\u5957\u67E5\u8BE2\u793A\u4F8B"',children:'<resultMap id="UserMap" type="User">\n  <id property="id" column="id"/>\n  <result property="username" column="username"/>\n  <result property="email" column="email"/>\n  \n  \x3c!-- \u5D4C\u5957\u67E5\u8BE2 - \u4E00\u5BF9\u4E00\u5173\u8054 --\x3e\n  <association property="profile" \n               column="id" \n               select="getProfileByUserId"\n               fetchType="lazy"/>\n</resultMap>\n\n<select id="getUser" resultMap="UserMap">\n  SELECT id, username, email FROM user WHERE id = #{id}\n</select>\n\n<select id="getProfileByUserId" resultType="UserProfile">\n  SELECT id, address, phone, avatar \n  FROM user_profile\n  WHERE user_id = #{userId}\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"composite-key",label:"\u590D\u5408\u4E3B\u952E\u5173\u8054",children:[(0,l.jsx)(n.p,{children:"\u5904\u7406\u590D\u5408\u4E3B\u952E\u5173\u8054\u7684\u60C5\u51B5\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u590D\u5408\u4E3B\u952E\u5173\u8054\u793A\u4F8B"',children:'<resultMap id="OrderResultMap" type="Order">\n  <id property="id" column="order_id"/>\n  <result property="orderNo" column="order_no"/>\n  <result property="createTime" column="create_time"/>\n  \n  \x3c!-- \u590D\u5408\u4E3B\u952E\u5173\u8054 --\x3e\n  <association property="shippingAddress" javaType="Address">\n    <id property="orderId" column="order_id"/>\n    <id property="type" column="address_type"/>\n    <result property="street" column="street"/>\n    <result property="city" column="city"/>\n    <result property="country" column="country"/>\n    <result property="zipCode" column="zip_code"/>\n  </association>\n</resultMap>\n\n<select id="getOrderWithAddress" resultMap="OrderResultMap">\n  SELECT\n    o.id as order_id,\n    o.order_no,\n    o.create_time,\n    a.type as address_type,\n    a.street,\n    a.city,\n    a.country,\n    a.zip_code\n  FROM orders o\n  LEFT JOIN address a ON o.id = a.order_id AND a.type = \'SHIPPING\'\n  WHERE o.id = #{id}\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"auto-mapping",label:"\u81EA\u52A8\u6620\u5C04\u7EC4\u5408",children:[(0,l.jsx)(n.p,{children:"\u7ED3\u5408\u81EA\u52A8\u6620\u5C04\u548C\u624B\u52A8\u6620\u5C04\u7684\u6DF7\u5408\u4F7F\u7528\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u81EA\u52A8\u6620\u5C04\u7EC4\u5408\u793A\u4F8B"',children:'<resultMap id="UserWithProfileMap" type="User" autoMapping="true">\n  <id property="id" column="id"/>\n  \x3c!-- \u5176\u4ED6User\u5C5E\u6027\u81EA\u52A8\u6620\u5C04 --\x3e\n  \n  <association property="profile" javaType="UserProfile" autoMapping="true">\n    <id property="id" column="profile_id"/>\n    \x3c!-- \u5176\u4ED6Profile\u5C5E\u6027\u81EA\u52A8\u6620\u5C04\uFF0C\u524D\u7F00\u76F8\u540C --\x3e\n  </association>\n</resultMap>\n\n<select id="getUserWithProfile" resultMap="UserWithProfileMap">\n  SELECT \n    u.id,\n    u.username,\n    u.email,\n    u.create_time,\n    p.id AS profile_id,\n    p.address AS profile_address,\n    p.phone AS profile_phone\n  FROM user u\n  LEFT JOIN user_profile p ON u.id = p.user_id\n  WHERE u.id = #{id}\n</select>\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"53-\u4E00\u5BF9\u591A\u5173\u8054\u67E5\u8BE2",children:"5.3 \u4E00\u5BF9\u591A\u5173\u8054\u67E5\u8BE2"}),"\n",(0,l.jsx)(n.p,{children:"\u4E00\u5BF9\u591A\u5173\u8054\u5904\u7406\u4E00\u4E2A\u5BF9\u8C61\u5173\u8054\u591A\u4E2A\u5B50\u5BF9\u8C61\u7684\u60C5\u51B5\uFF0C\u4F8B\u5982\u7528\u6237\u62E5\u6709\u591A\u4E2A\u8BA2\u5355\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"nested-result",label:"\u5D4C\u5957\u7ED3\u679C\u6620\u5C04",children:[(0,l.jsx)(n.p,{children:"\u5D4C\u5957\u7ED3\u679C\u6620\u5C04\u65B9\u5F0F\u52A0\u8F7D\u4E00\u5BF9\u591A\u5173\u8054\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u4E00\u5BF9\u591A\u5D4C\u5957\u7ED3\u679C\u6620\u5C04"',children:'<resultMap id="UserWithOrdersMap" type="User">\n  <id property="id" column="user_id"/>\n  <result property="username" column="username"/>\n  <result property="email" column="email"/>\n  \n  \x3c!-- \u4E00\u5BF9\u591A\u5173\u8054 --\x3e\n  <collection property="orders" ofType="Order">\n    <id property="id" column="order_id"/>\n    <result property="orderNo" column="order_no"/>\n    <result property="amount" column="amount"/>\n    <result property="createTime" column="order_create_time"/>\n    <result property="status" column="order_status"/>\n  </collection>\n</resultMap>\n\n<select id="getUserWithOrders" resultMap="UserWithOrdersMap">\n  SELECT \n    u.id as user_id,\n    u.username,\n    u.email,\n    o.id as order_id,\n    o.order_no,\n    o.amount,\n    o.create_time as order_create_time,\n    o.status as order_status\n  FROM user u\n  LEFT JOIN orders o ON u.id = o.user_id\n  WHERE u.id = #{id}\n  ORDER BY o.create_time DESC\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"nested-query",label:"\u5D4C\u5957\u67E5\u8BE2",children:[(0,l.jsx)(n.p,{children:"\u5D4C\u5957\u67E5\u8BE2\u65B9\u5F0F\u52A0\u8F7D\u4E00\u5BF9\u591A\u5173\u8054\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u4E00\u5BF9\u591A\u5D4C\u5957\u67E5\u8BE2"',children:'<resultMap id="UserMap" type="User">\n  <id property="id" column="id"/>\n  <result property="username" column="username"/>\n  <result property="email" column="email"/>\n  \n  \x3c!-- \u4E00\u5BF9\u591A\u5D4C\u5957\u67E5\u8BE2 --\x3e\n  <collection property="orders" \n              column="id" \n              select="getOrdersByUserId"\n              fetchType="lazy"/>\n</resultMap>\n\n<select id="getUser" resultMap="UserMap">\n  SELECT id, username, email FROM user WHERE id = #{id}\n</select>\n\n<select id="getOrdersByUserId" resultType="Order">\n  SELECT id, order_no, amount, create_time, status\n  FROM orders\n  WHERE user_id = #{userId}\n  ORDER BY create_time DESC\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"multi-level",label:"\u591A\u7EA7\u5D4C\u5957",children:[(0,l.jsx)(n.p,{children:"\u5904\u7406\u591A\u7EA7\u5D4C\u5957\u5173\u8054\u7684\u60C5\u51B5\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u591A\u7EA7\u5D4C\u5957\u5173\u8054"',children:'<resultMap id="UserWithOrdersAndItemsMap" type="User">\n  <id property="id" column="user_id"/>\n  <result property="username" column="username"/>\n  \n  \x3c!-- \u4E00\u7EA7\u5D4C\u5957\uFF1A\u7528\u6237\u7684\u8BA2\u5355 --\x3e\n  <collection property="orders" ofType="Order">\n    <id property="id" column="order_id"/>\n    <result property="orderNo" column="order_no"/>\n    <result property="amount" column="amount"/>\n    \n    \x3c!-- \u4E8C\u7EA7\u5D4C\u5957\uFF1A\u8BA2\u5355\u7684\u5546\u54C1\u9879 --\x3e\n    <collection property="items" ofType="OrderItem">\n      <id property="id" column="item_id"/>\n      <result property="productId" column="product_id"/>\n      <result property="quantity" column="quantity"/>\n      <result property="price" column="price"/>\n      \n      \x3c!-- \u4E09\u7EA7\u5D4C\u5957\uFF1A\u5546\u54C1\u4FE1\u606F --\x3e\n      <association property="product" javaType="Product">\n        <id property="id" column="product_id"/>\n        <result property="name" column="product_name"/>\n        <result property="image" column="product_image"/>\n      </association>\n    </collection>\n  </collection>\n</resultMap>\n\n<select id="getUserWithOrdersAndItems" resultMap="UserWithOrdersAndItemsMap">\n  SELECT \n    u.id as user_id,\n    u.username,\n    o.id as order_id,\n    o.order_no,\n    o.amount,\n    i.id as item_id,\n    i.product_id,\n    i.quantity,\n    i.price,\n    p.name as product_name,\n    p.image as product_image\n  FROM user u\n  LEFT JOIN orders o ON u.id = o.user_id\n  LEFT JOIN order_item i ON o.id = i.order_id\n  LEFT JOIN product p ON i.product_id = p.id\n  WHERE u.id = #{id}\n  ORDER BY o.create_time DESC, i.id ASC\n</select>\n'})})]})]}),"\n",(0,l.jsx)(n.admonition,{title:"\u6027\u80FD\u6CE8\u610F\u4E8B\u9879",type:"warning",children:(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"N+1\u95EE\u9898"}),"\uFF1A\u5D4C\u5957\u67E5\u8BE2\u53EF\u80FD\u5BFC\u81F4\u5927\u91CF\u989D\u5916\u67E5\u8BE2\uFF0C\u964D\u4F4E\u6027\u80FD"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5EF6\u8FDF\u52A0\u8F7D"}),'\uFF1A\u9002\u5F53\u4F7F\u7528fetchType="lazy"\u53EF\u4EE5\u6309\u9700\u52A0\u8F7D\u5173\u8054\u5BF9\u8C61']}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7ED3\u679C\u96C6\u8FC7\u5927"}),"\uFF1A\u590D\u6742\u5D4C\u5957\u7ED3\u679C\u6620\u5C04\u53EF\u80FD\u8FD4\u56DE\u5927\u91CF\u5197\u4F59\u6570\u636E"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5185\u5B58\u6D88\u8017"}),"\uFF1A\u591A\u7EA7\u5D4C\u5957\u6620\u5C04\u4F1A\u6D88\u8017\u66F4\u591A\u5185\u5B58\u8D44\u6E90"]}),"\n"]})}),"\n",(0,l.jsx)(n.h3,{id:"54-\u9274\u522B\u5668\u6620\u5C04",children:"5.4 \u9274\u522B\u5668\u6620\u5C04"}),"\n",(0,l.jsx)(n.p,{children:"\u9274\u522B\u5668\u6620\u5C04\u5141\u8BB8\u6839\u636E\u67D0\u5217\u7684\u503C\u6765\u51B3\u5B9A\u5982\u4F55\u6620\u5C04\u7ED3\u679C\u96C6\uFF0C\u7C7B\u4F3C\u4E8EJava\u4E2D\u7684switch\u8BED\u53E5\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"basic",label:"\u57FA\u7840\u7528\u6CD5",children:[(0,l.jsx)(n.p,{children:"\u6839\u636E\u7C7B\u578B\u5B57\u6BB5\u9009\u62E9\u4E0D\u540C\u7684\u6620\u5C04\u65B9\u5F0F\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u9274\u522B\u5668\u57FA\u7840\u7528\u6CD5"',children:'<resultMap id="VehicleResultMap" type="Vehicle">\n  <id property="id" column="id"/>\n  <result property="name" column="name"/>\n  <result property="price" column="price"/>\n  \n  \x3c!-- \u6839\u636Evehicle_type\u5217\u503C\u786E\u5B9A\u6620\u5C04\u65B9\u5F0F --\x3e\n  <discriminator javaType="int" column="vehicle_type">\n    <case value="1" resultType="Car">\n      <result property="engineType" column="engine_type"/>\n      <result property="doors" column="doors"/>\n    </case>\n    <case value="2" resultType="Motorcycle">\n      <result property="engineCapacity" column="engine_capacity"/>\n      <result property="hasSideCar" column="has_side_car"/>\n    </case>\n    <case value="3" resultType="Bicycle">\n      <result property="frameType" column="frame_type"/>\n      <result property="gears" column="gears"/>\n    </case>\n  </discriminator>\n</resultMap>\n\n<select id="getVehicleById" resultMap="VehicleResultMap">\n  SELECT \n    id, name, price, vehicle_type,\n    engine_type, doors, engine_capacity,\n    has_side_car, frame_type, gears\n  FROM vehicle\n  WHERE id = #{id}\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"nested-maps",label:"\u5D4C\u5957\u6620\u5C04",children:[(0,l.jsx)(n.p,{children:"\u9274\u522B\u5668\u7ED3\u5408\u5D4C\u5957\u6620\u5C04\u7684\u590D\u6742\u7528\u6CD5\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u9274\u522B\u5668\u5D4C\u5957\u6620\u5C04"',children:'<resultMap id="PaymentResultMap" type="Payment">\n  <id property="id" column="payment_id"/>\n  <result property="amount" column="amount"/>\n  <result property="paymentDate" column="payment_date"/>\n  \n  \x3c!-- \u6839\u636E\u652F\u4ED8\u65B9\u5F0F\u786E\u5B9A\u6620\u5C04\u65B9\u5F0F --\x3e\n  <discriminator javaType="string" column="payment_type">\n    <case value="CREDIT_CARD" resultMap="CreditCardPaymentMap"/>\n    <case value="PAYPAL" resultMap="PayPalPaymentMap"/>\n    <case value="BANK_TRANSFER" resultMap="BankTransferPaymentMap"/>\n    <case value="CASH" resultMap="CashPaymentMap"/>\n  </discriminator>\n</resultMap>\n\n\x3c!-- \u4FE1\u7528\u5361\u652F\u4ED8\u6620\u5C04 --\x3e\n<resultMap id="CreditCardPaymentMap" type="CreditCardPayment" extends="PaymentResultMap">\n  <result property="cardNumber" column="card_number"/>\n  <result property="expiryDate" column="expiry_date"/>\n  <result property="cardType" column="card_type"/>\n</resultMap>\n\n\x3c!-- PayPal\u652F\u4ED8\u6620\u5C04 --\x3e\n<resultMap id="PayPalPaymentMap" type="PayPalPayment" extends="PaymentResultMap">\n  <result property="emailAddress" column="email_address"/>\n  <result property="accountId" column="account_id"/>\n</resultMap>\n\n\x3c!-- \u94F6\u884C\u8F6C\u8D26\u6620\u5C04 --\x3e\n<resultMap id="BankTransferPaymentMap" type="BankTransferPayment" extends="PaymentResultMap">\n  <result property="bankName" column="bank_name"/>\n  <result property="accountNumber" column="account_number"/>\n  <result property="referenceNumber" column="reference_number"/>\n</resultMap>\n\n\x3c!-- \u73B0\u91D1\u652F\u4ED8\u6620\u5C04 --\x3e\n<resultMap id="CashPaymentMap" type="CashPayment" extends="PaymentResultMap">\n  <result property="receiptNumber" column="receipt_number"/>\n</resultMap>\n'})})]}),(0,l.jsxs)(a.A,{value:"custom-type",label:"\u81EA\u5B9A\u4E49\u7C7B\u578B\u6620\u5C04",children:[(0,l.jsx)(n.p,{children:"\u9274\u522B\u5668\u7ED3\u5408\u7C7B\u578B\u5904\u7406\u5668\u7684\u9AD8\u7EA7\u7528\u6CD5\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u81EA\u5B9A\u4E49\u7C7B\u578B\u6620\u5C04"',children:'<resultMap id="ProductResultMap" type="Product">\n  <id property="id" column="id"/>\n  <result property="name" column="name"/>\n  <result property="price" column="price"/>\n  <result property="categoryId" column="category_id"/>\n  \n  \x3c!-- \u6839\u636E\u4EA7\u54C1\u7C7B\u578B\u51B3\u5B9A\u5982\u4F55\u5904\u7406attributes\u5B57\u6BB5 --\x3e\n  <discriminator javaType="string" column="product_type">\n    <case value="ELECTRONIC" resultType="ElectronicProduct">\n      <result property="attributes" column="attributes" \n              typeHandler="com.example.handler.ElectronicAttributesHandler"/>\n    </case>\n    <case value="CLOTHING" resultType="ClothingProduct">\n      <result property="attributes" column="attributes" \n              typeHandler="com.example.handler.ClothingAttributesHandler"/>\n    </case>\n    <case value="FOOD" resultType="FoodProduct">\n      <result property="attributes" column="attributes" \n              typeHandler="com.example.handler.FoodAttributesHandler"/>\n      <result property="expiryDate" column="expiry_date"/>\n    </case>\n  </discriminator>\n</resultMap>\n'})})]})]}),"\n",(0,l.jsx)(n.p,{children:"\u9274\u522B\u5668\u6620\u5C04\u7684\u4E3B\u8981\u9002\u7528\u573A\u666F\uFF1A"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7EE7\u627F\u5173\u7CFB\u6620\u5C04"}),"\uFF1A\u5904\u7406\u4E0D\u540C\u5B50\u7C7B\u7684\u5DEE\u5F02\u5316\u5B57\u6BB5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u591A\u6001\u5BF9\u8C61\u5904\u7406"}),"\uFF1A\u6839\u636E\u7C7B\u578B\u5B57\u6BB5\u8FD4\u56DE\u4E0D\u540C\u7C7B\u578B\u7684\u5BF9\u8C61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6761\u4EF6\u5B57\u6BB5\u6620\u5C04"}),"\uFF1A\u6839\u636E\u72B6\u6001\u51B3\u5B9A\u5982\u4F55\u5904\u7406\u67D0\u4E9B\u5B57\u6BB5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u590D\u6742\u4E1A\u52A1\u903B\u8F91"}),"\uFF1A\u6839\u636E\u4E1A\u52A1\u89C4\u5219\u9009\u62E9\u4E0D\u540C\u7684\u6620\u5C04\u7B56\u7565"]}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{title:"\u7ED3\u679C\u6620\u5C04\u6700\u4F73\u5B9E\u8DF5",type:"tip",children:(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4F18\u5148\u4F7F\u7528\u81EA\u52A8\u6620\u5C04"}),"\uFF1A\u5F53\u5217\u540D\u7B26\u5408\u547D\u540D\u89C4\u5219\u65F6\uFF0C\u542F\u7528\u81EA\u52A8\u6620\u5C04"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7EC4\u5408\u4F7F\u7528\u7B56\u7565"}),"\uFF1A\u6839\u636E\u590D\u6742\u5EA6\u9009\u62E9\u5408\u9002\u7684\u6620\u5C04\u65B9\u5F0F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5EF6\u8FDF\u52A0\u8F7D"}),'\uFF1A\u4F7F\u7528fetchType="lazy"\u907F\u514D\u4E0D\u5FC5\u8981\u7684\u6570\u636E\u52A0\u8F7D']}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7ED3\u679C\u7F13\u5B58"}),"\uFF1A\u4E3A\u590D\u6742\u67E5\u8BE2\u542F\u7528\u7F13\u5B58\uFF0C\u63D0\u9AD8\u6027\u80FD"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u9884\u52A0\u8F7D\u5173\u8054"}),"\uFF1A\u5BF9\u4E8E\u7ECF\u5E38\u4E00\u8D77\u4F7F\u7528\u7684\u5173\u8054\u6570\u636E\uFF0C\u4F7F\u7528\u5D4C\u5957\u7ED3\u679C\u6620\u5C04"]}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"6-\u7F13\u5B58\u673A\u5236\u4E0E\u6027\u80FD\u4F18\u5316",children:"6. \u7F13\u5B58\u673A\u5236\u4E0E\u6027\u80FD\u4F18\u5316"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u63D0\u4F9B\u4E86\u5B8C\u5584\u7684\u7F13\u5B58\u673A\u5236\uFF0C\u901A\u8FC7\u5408\u7406\u4F7F\u7528\u7F13\u5B58\uFF0C\u53EF\u4EE5\u663E\u8457\u63D0\u5347\u67E5\u8BE2\u6027\u80FD\uFF0C\u51CF\u5C11\u6570\u636E\u5E93\u8BBF\u95EE\u6B21\u6570\u3002MyBatis\u7684\u7F13\u5B58\u5206\u4E3A\u4E00\u7EA7\u7F13\u5B58\u548C\u4E8C\u7EA7\u7F13\u5B58\u4E24\u4E2A\u5C42\u6B21\u3002"}),"\n",(0,l.jsx)(n.mermaid,{value:"graph TD\n    A[MyBatis\u7F13\u5B58\u4F53\u7CFB] --\x3e B[\u4E00\u7EA7\u7F13\u5B58]\n    A --\x3e C[\u4E8C\u7EA7\u7F13\u5B58]\n    \n    B --\x3e B1[SqlSession\u7EA7\u522B]\n    B --\x3e B2[\u9ED8\u8BA4\u542F\u7528]\n    B --\x3e B3[\u751F\u547D\u5468\u671F\u77ED]\n    \n    C --\x3e C1[Mapper\u7EA7\u522B]\n    C --\x3e C2[\u9700\u624B\u52A8\u542F\u7528]\n    C --\x3e C3[\u8DE8SqlSession]\n    C --\x3e C4[\u53EF\u81EA\u5B9A\u4E49\u5B9E\u73B0]"}),"\n",(0,l.jsx)(n.h3,{id:"61-\u4E00\u7EA7\u7F13\u5B58\u673A\u5236",children:"6.1 \u4E00\u7EA7\u7F13\u5B58\u673A\u5236"}),"\n",(0,l.jsx)(n.p,{children:"\u4E00\u7EA7\u7F13\u5B58\u662FSqlSession\u7EA7\u522B\u7684\u7F13\u5B58\uFF0C\u9ED8\u8BA4\u542F\u7528\uFF0C\u751F\u547D\u5468\u671F\u4EC5\u9650\u4E8E\u5355\u4E2ASqlSession\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"basic",label:"\u57FA\u672C\u539F\u7406",children:[(0,l.jsx)(n.p,{children:"\u4E00\u7EA7\u7F13\u5B58\u7684\u5DE5\u4F5C\u539F\u7406\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4F5C\u7528\u8303\u56F4"}),"\uFF1ASqlSession\u7EA7\u522B\uFF0C\u540C\u4E00\u4E2ASqlSession\u4E2D\u7684\u76F8\u540C\u67E5\u8BE2\u4F1A\u4F7F\u7528\u7F13\u5B58"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7F13\u5B58\u952E"}),"\uFF1A\u57FA\u4E8EStatement ID + SQL + \u53C2\u6570\u503C + RowBounds\u8BA1\u7B97"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u81EA\u52A8\u7BA1\u7406"}),"\uFF1A\u9ED8\u8BA4\u5F00\u542F\uFF0C\u65E0\u9700\u989D\u5916\u914D\u7F6E"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u751F\u547D\u5468\u671F"}),"\uFF1ASqlSession\u5173\u95ED\u540E\u7F13\u5B58\u5931\u6548"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u4E00\u7EA7\u7F13\u5B58\u793A\u4F8B"',children:"// \u83B7\u53D6SqlSession\ntry (SqlSession session = sqlSessionFactory.openSession()) {\n    UserMapper mapper = session.getMapper(UserMapper.class);\n    \n    // \u7B2C\u4E00\u6B21\u67E5\u8BE2\uFF0C\u8BBF\u95EE\u6570\u636E\u5E93\n    User user1 = mapper.getUserById(1001L);\n    \n    // \u7B2C\u4E8C\u6B21\u67E5\u8BE2\uFF0C\u4F7F\u7528\u4E00\u7EA7\u7F13\u5B58\n    User user2 = mapper.getUserById(1001L);\n    \n    // user1\u548Cuser2\u662F\u540C\u4E00\u4E2A\u5BF9\u8C61\u5F15\u7528\n    System.out.println(user1 == user2);  // true\n}\n"})})]}),(0,l.jsxs)(a.A,{value:"clear",label:"\u6E05\u9664\u7F13\u5B58",children:[(0,l.jsx)(n.p,{children:"\u4E00\u7EA7\u7F13\u5B58\u5728\u4EE5\u4E0B\u60C5\u51B5\u4F1A\u88AB\u6E05\u9664\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\u8C03\u7528",(0,l.jsx)(n.code,{children:"SqlSession.clearCache()"}),"\u65B9\u6CD5"]}),"\n",(0,l.jsx)(n.li,{children:"\u6267\u884CUPDATE\u3001INSERT\u3001DELETE\u7B49\u4FEE\u6539\u64CD\u4F5C"}),"\n",(0,l.jsxs)(n.li,{children:["\u8C03\u7528\u5E26\u6709",(0,l.jsx)(n.code,{children:"flushCache=true"}),"\u5C5E\u6027\u7684\u67E5\u8BE2"]}),"\n",(0,l.jsx)(n.li,{children:"SqlSession\u6267\u884C\u63D0\u4EA4\u6216\u56DE\u6EDA\u64CD\u4F5C"}),"\n",(0,l.jsx)(n.li,{children:"SqlSession\u5173\u95ED"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u6E05\u9664\u4E00\u7EA7\u7F13\u5B58"',children:"try (SqlSession session = sqlSessionFactory.openSession()) {\n    UserMapper mapper = session.getMapper(UserMapper.class);\n    \n    // \u7B2C\u4E00\u6B21\u67E5\u8BE2\n    User user1 = mapper.getUserById(1001L);\n    \n    // \u6E05\u9664\u4E00\u7EA7\u7F13\u5B58\n    session.clearCache();\n    \n    // \u7B2C\u4E8C\u6B21\u67E5\u8BE2\uFF0C\u4F1A\u518D\u6B21\u8BBF\u95EE\u6570\u636E\u5E93\n    User user2 = mapper.getUserById(1001L);\n    \n    // user1\u548Cuser2\u4E0D\u662F\u540C\u4E00\u4E2A\u5BF9\u8C61\n    System.out.println(user1 == user2);  // false\n}\n"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u67E5\u8BE2\u8BED\u53E5\u914D\u7F6E\u6E05\u9664\u7F13\u5B58"',children:'\x3c!-- flushCache=true\u4F1A\u6E05\u9664\u4E00\u7EA7\u7F13\u5B58\u548C\u4E8C\u7EA7\u7F13\u5B58 --\x3e\n<select id="getUserByEmail" resultType="User" flushCache="true">\n  SELECT * FROM user WHERE email = #{email}\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"config",label:"\u914D\u7F6E\u9009\u9879",children:[(0,l.jsx)(n.p,{children:"\u4E00\u7EA7\u7F13\u5B58\u7684\u914D\u7F6E\u9009\u9879\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="mybatis-config.xml"',children:'<settings>\n  \x3c!-- \u8BBE\u7F6E\u4E00\u7EA7\u7F13\u5B58\u7684\u4F5C\u7528\u8303\u56F4:\n       SESSION (\u9ED8\u8BA4): \u540C\u4E00\u4E2ASqlSession\u5185\u6709\u6548\n       STATEMENT: \u8BED\u53E5\u7EA7\u522B\uFF0C\u76F8\u5F53\u4E8E\u7981\u7528\u4E00\u7EA7\u7F13\u5B58\n  --\x3e\n  <setting name="localCacheScope" value="SESSION"/>\n</settings>\n'})}),(0,l.jsxs)(n.p,{children:["\u5F53",(0,l.jsx)(n.code,{children:"localCacheScope"}),"\u8BBE\u4E3A",(0,l.jsx)(n.code,{children:"STATEMENT"}),"\u65F6\uFF0C\u4E00\u7EA7\u7F13\u5B58\u4EC5\u5BF9\u5355\u4E2A\u8BED\u53E5\u6709\u6548\uFF0C\u6BCF\u6B21\u67E5\u8BE2\u5B8C\u6210\u540E\u90FD\u4F1A\u6E05\u7A7A\u7F13\u5B58\uFF0C\u76F8\u5F53\u4E8E\u7981\u7528\u4E86\u4E00\u7EA7\u7F13\u5B58\u3002"]})]}),(0,l.jsxs)(a.A,{value:"considerations",label:"\u4F7F\u7528\u8003\u91CF",children:[(0,l.jsx)(n.p,{children:"\u4E00\u7EA7\u7F13\u5B58\u4F7F\u7528\u6CE8\u610F\u4E8B\u9879\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u9002\u7528\u573A\u666F"}),"\uFF1A\u9002\u7528\u4E8E\u5355\u4E2A\u65B9\u6CD5\u5185\u591A\u6B21\u67E5\u8BE2\u76F8\u540C\u6570\u636E\u7684\u573A\u666F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4E8B\u52A1\u9694\u79BB"}),"\uFF1A\u4E00\u7EA7\u7F13\u5B58\u4E0D\u8DE8SqlSession\uFF0C\u4E0D\u4F1A\u6709\u6570\u636E\u4E00\u81F4\u6027\u95EE\u9898"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5BF9\u8C61\u4E00\u81F4\u6027"}),"\uFF1A\u540C\u4E00SqlSession\u5185\u76F8\u540C\u67E5\u8BE2\u8FD4\u56DE\u7684\u662F\u540C\u4E00\u4E2A\u5BF9\u8C61\u5F15\u7528"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6027\u80FD\u5F71\u54CD"}),"\uFF1A\u901A\u5E38\u6709\u52A9\u4E8E\u51CF\u5C11\u91CD\u590D\u67E5\u8BE2\uFF0C\u4F46\u5BF9\u6574\u4F53\u6027\u80FD\u5F71\u54CD\u6709\u9650"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5B89\u5168\u5173\u6CE8\u70B9"}),"\uFF1A\u5728\u5E76\u53D1\u73AF\u5883\u4E2D\uFF0C\u5982\u679C\u5171\u4EABSqlSession\u53EF\u80FD\u5BFC\u81F4\u6570\u636E\u6DF7\u4E71"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u4E00\u7EA7\u7F13\u5B58\u6CE8\u610F\u4E8B\u9879\u793A\u4F8B"',children:"// \u6B63\u786E\u4F7F\u7528\u65B9\u5F0F - \u6BCF\u4E2A\u7EBF\u7A0B\u72EC\u7ACB\u7684SqlSession\n@Service\npublic class UserService {\n    @Autowired\n    private SqlSessionFactory sqlSessionFactory;\n    \n    public User getUserById(Long id) {\n        try (SqlSession session = sqlSessionFactory.openSession()) {\n            UserMapper mapper = session.getMapper(UserMapper.class);\n            return mapper.getUserById(id);\n        }\n    }\n    \n    // \u5728\u540C\u4E00\u4E2A\u4E8B\u52A1\u4E2D\u4F7F\u7528\u4E00\u7EA7\u7F13\u5B58\n    public void processUserData(Long id) {\n        try (SqlSession session = sqlSessionFactory.openSession()) {\n            UserMapper mapper = session.getMapper(UserMapper.class);\n            \n            // \u7B2C\u4E00\u6B21\u67E5\u8BE2\n            User user = mapper.getUserById(id);\n            // \u5904\u7406\u7528\u6237\u6570\u636E...\n            \n            // \u7B2C\u4E8C\u6B21\u67E5\u8BE2\u5229\u7528\u4E00\u7EA7\u7F13\u5B58\n            User sameUser = mapper.getUserById(id);\n            // \u7EE7\u7EED\u5904\u7406...\n            \n            session.commit();\n        }\n    }\n}\n"})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"62-\u4E8C\u7EA7\u7F13\u5B58\u914D\u7F6E",children:"6.2 \u4E8C\u7EA7\u7F13\u5B58\u914D\u7F6E"}),"\n",(0,l.jsx)(n.p,{children:"\u4E8C\u7EA7\u7F13\u5B58\u662FMapper\u7EA7\u522B\u7684\u7F13\u5B58\uFF0C\u53EF\u4EE5\u8DE8\u8D8A\u591A\u4E2ASqlSession\u5171\u4EAB\uFF0C\u9700\u8981\u624B\u52A8\u542F\u7528\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"config",label:"\u57FA\u672C\u914D\u7F6E",children:[(0,l.jsx)(n.p,{children:"\u542F\u7528\u4E8C\u7EA7\u7F13\u5B58\u7684\u6B65\u9AA4\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u5168\u5C40\u914D\u7F6E\u6587\u4EF6\u4E2D\u542F\u7528\u7F13\u5B58"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="mybatis-config.xml"',children:'<settings>\n  <setting name="cacheEnabled" value="true"/>  \x3c!-- \u9ED8\u8BA4\u5C31\u662Ftrue --\x3e\n</settings>\n'})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"\u5728Mapper XML\u4E2D\u914D\u7F6E\u7F13\u5B58"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="UserMapper.xml"',children:'<mapper namespace="com.example.mapper.UserMapper">\n  \x3c!-- \u542F\u7528\u8BE5\u547D\u540D\u7A7A\u95F4\u7684\u4E8C\u7EA7\u7F13\u5B58 --\x3e\n  <cache \n    eviction="LRU"           \x3c!-- \u7F13\u5B58\u6DD8\u6C70\u7B56\u7565\uFF1ALRU/FIFO/SOFT/WEAK --\x3e\n    flushInterval="60000"    \x3c!-- \u5237\u65B0\u95F4\u9694(\u6BEB\u79D2)\uFF0C\u4E0D\u8BBE\u7F6E\u5219\u4E0D\u81EA\u52A8\u5237\u65B0 --\x3e\n    size="512"               \x3c!-- \u7F13\u5B58\u5BF9\u8C61\u6570\u91CF\u4E0A\u9650 --\x3e\n    readOnly="false"/>       \x3c!-- false\u5141\u8BB8\u4FEE\u6539\u5BF9\u8C61\uFF0C\u4F46\u9700\u8981\u53EF\u5E8F\u5217\u5316 --\x3e\n    \n  \x3c!-- \u6620\u5C04\u8BED\u53E5... --\x3e\n</mapper>\n'})}),(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:"\u786E\u4FDD\u5B9E\u4F53\u7C7B\u5B9E\u73B0Serializable\u63A5\u53E3"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u53EF\u5E8F\u5217\u5316\u5B9E\u4F53\u7C7B"',children:"public class User implements Serializable {\n    private static final long serialVersionUID = 1L;\n    \n    private Long id;\n    private String username;\n    // \u5176\u4ED6\u5C5E\u6027...\n}\n"})})]}),(0,l.jsxs)(a.A,{value:"control",label:"\u7F13\u5B58\u63A7\u5236",children:[(0,l.jsx)(n.p,{children:"\u63A7\u5236\u5355\u4E2A\u8BED\u53E5\u7684\u7F13\u5B58\u884C\u4E3A\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u7F13\u5B58\u63A7\u5236\u5C5E\u6027"',children:'\x3c!-- \u4F7F\u7528\u7F13\u5B58\uFF08\u9ED8\u8BA4\u503C\u4E3Atrue\uFF09 --\x3e\n<select id="getUserById" resultType="User" useCache="true">\n  SELECT * FROM user WHERE id = #{id}\n</select>\n\n\x3c!-- \u7981\u7528\u7F13\u5B58 --\x3e\n<select id="getUserForUpdate" resultType="User" useCache="false">\n  SELECT * FROM user WHERE id = #{id}\n</select>\n\n\x3c!-- \u6E05\u9664\u7F13\u5B58\uFF08\u9ED8\u8BA4\u5BF9\u4FEE\u6539\u64CD\u4F5C\u4E3Atrue\uFF0C\u67E5\u8BE2\u4E3Afalse\uFF09 --\x3e\n<select id="getUserByEmail" resultType="User" flushCache="true">\n  SELECT * FROM user WHERE email = #{email}\n</select>\n\n<update id="updateUser" flushCache="true">\n  UPDATE user SET username = #{username} WHERE id = #{id}\n</update>\n'})}),(0,l.jsxs)(n.p,{children:["\u4E8C\u7EA7\u7F13\u5B58\u7684\u4F5C\u7528\u8303\u56F4\u662Fnamespace\u7EA7\u522B\u7684\uFF0C\u5982\u679C\u8981\u5728\u591A\u4E2AMapper\u4E4B\u95F4\u5171\u4EAB\u7F13\u5B58\uFF0C\u53EF\u4EE5\u4F7F\u7528",(0,l.jsx)(n.code,{children:"<cache-ref>"}),"\uFF1A"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u7F13\u5B58\u5F15\u7528"',children:'<mapper namespace="com.example.mapper.OrderMapper">\n  \x3c!-- \u5F15\u7528UserMapper\u7684\u7F13\u5B58\u914D\u7F6E --\x3e\n  <cache-ref namespace="com.example.mapper.UserMapper"/>\n  \n  \x3c!-- \u6620\u5C04\u8BED\u53E5... --\x3e\n</mapper>\n'})})]}),(0,l.jsxs)(a.A,{value:"eviction",label:"\u6DD8\u6C70\u7B56\u7565",children:[(0,l.jsx)(n.p,{children:"MyBatis\u4E8C\u7EA7\u7F13\u5B58\u652F\u6301\u56DB\u79CD\u6DD8\u6C70\u7B56\u7565\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"LRU"})," (Least Recently Used)\uFF1A\u6700\u8FD1\u6700\u5C11\u4F7F\u7528\uFF0C\u79FB\u9664\u6700\u957F\u65F6\u95F4\u672A\u4F7F\u7528\u7684\u5BF9\u8C61\uFF0C\u9ED8\u8BA4\u503C"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"FIFO"})," (First In First Out)\uFF1A\u5148\u8FDB\u5148\u51FA\uFF0C\u6309\u5BF9\u8C61\u8FDB\u5165\u7F13\u5B58\u7684\u987A\u5E8F\u79FB\u9664"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"SOFT"}),"\uFF1A\u8F6F\u5F15\u7528\uFF0C\u57FA\u4E8E\u5783\u573E\u56DE\u6536\u5668\u7684\u72B6\u6001\u548C\u8F6F\u5F15\u7528\u89C4\u5219\u79FB\u9664\u5BF9\u8C61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"WEAK"}),"\uFF1A\u5F31\u5F15\u7528\uFF0C\u66F4\u79EF\u6781\u5730\u57FA\u4E8E\u5783\u573E\u56DE\u6536\u5668\u548C\u5F31\u5F15\u7528\u89C4\u5219\u79FB\u9664\u5BF9\u8C61"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u4E0D\u540C\u6DD8\u6C70\u7B56\u7565\u793A\u4F8B"',children:'\x3c!-- LRU\u6DD8\u6C70\u7B56\u7565 --\x3e\n<cache eviction="LRU" size="1024"/>\n\n\x3c!-- FIFO\u6DD8\u6C70\u7B56\u7565 --\x3e\n<cache eviction="FIFO" size="1024"/>\n\n\x3c!-- \u57FA\u4E8E\u8F6F\u5F15\u7528 - \u5185\u5B58\u4E0D\u8DB3\u65F6\u56DE\u6536 --\x3e\n<cache eviction="SOFT"/>\n\n\x3c!-- \u57FA\u4E8E\u5F31\u5F15\u7528 - \u4E0B\u6B21GC\u65F6\u7ACB\u5373\u56DE\u6536 --\x3e\n<cache eviction="WEAK"/>\n'})})]}),(0,l.jsxs)(a.A,{value:"annotations",label:"\u6CE8\u89E3\u914D\u7F6E",children:[(0,l.jsx)(n.p,{children:"\u4F7F\u7528\u6CE8\u89E3\u65B9\u5F0F\u914D\u7F6E\u4E8C\u7EA7\u7F13\u5B58\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u6CE8\u89E3\u914D\u7F6E\u7F13\u5B58"',children:'@CacheNamespace(\n    eviction = FifoCache.class,\n    flushInterval = 60000,\n    size = 512,\n    readWrite = false\n)\npublic interface UserMapper {\n    \n    @Select("SELECT * FROM user WHERE id = #{id}")\n    @Options(useCache = true)\n    User getUserById(Long id);\n    \n    @Update("UPDATE user SET username = #{username} WHERE id = #{id}")\n    @Options(flushCache = Options.FlushCachePolicy.TRUE)\n    int updateUser(User user);\n}\n\n// \u7F13\u5B58\u5F15\u7528\n@CacheNamespaceRef(UserMapper.class)\npublic interface OrderMapper {\n    // ...\n}\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"63-\u81EA\u5B9A\u4E49\u7F13\u5B58\u5B9E\u73B0",children:"6.3 \u81EA\u5B9A\u4E49\u7F13\u5B58\u5B9E\u73B0"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u652F\u6301\u81EA\u5B9A\u4E49\u7F13\u5B58\u5B9E\u73B0\uFF0C\u53EF\u4EE5\u96C6\u6210\u7B2C\u4E09\u65B9\u7F13\u5B58\uFF0C\u5982Redis\u3001Ehcache\u7B49\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"custom",label:"\u81EA\u5B9A\u4E49\u7F13\u5B58",children:[(0,l.jsxs)(n.p,{children:["\u81EA\u5B9A\u4E49\u7F13\u5B58\u9700\u8981\u5B9E\u73B0MyBatis\u7684",(0,l.jsx)(n.code,{children:"Cache"}),"\u63A5\u53E3\uFF1A"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u81EA\u5B9A\u4E49\u7F13\u5B58\u5B9E\u73B0"',children:"package com.example.cache;\n\nimport org.apache.ibatis.cache.Cache;\n\npublic class CustomCache implements Cache {\n    private final String id;\n    private final Map<Object, Object> cache = new ConcurrentHashMap<>();\n    \n    public CustomCache(String id) {\n        this.id = id;\n    }\n    \n    @Override\n    public String getId() {\n        return id;\n    }\n    \n    @Override\n    public void putObject(Object key, Object value) {\n        cache.put(key, value);\n    }\n    \n    @Override\n    public Object getObject(Object key) {\n        return cache.get(key);\n    }\n    \n    @Override\n    public Object removeObject(Object key) {\n        return cache.remove(key);\n    }\n    \n    @Override\n    public void clear() {\n        cache.clear();\n    }\n    \n    @Override\n    public int getSize() {\n        return cache.size();\n    }\n}\n"})}),(0,l.jsx)(n.p,{children:"\u5728Mapper\u4E2D\u4F7F\u7528\u81EA\u5B9A\u4E49\u7F13\u5B58\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u4F7F\u7528\u81EA\u5B9A\u4E49\u7F13\u5B58"',children:'<mapper namespace="com.example.mapper.UserMapper">\n  <cache type="com.example.cache.CustomCache">\n    <property name="cacheType" value="LRU"/>\n    <property name="maxSize" value="1000"/>\n  </cache>\n  \n  \x3c!-- \u6620\u5C04\u8BED\u53E5... --\x3e\n</mapper>\n'})})]}),(0,l.jsxs)(a.A,{value:"redis",label:"Redis\u7F13\u5B58\u96C6\u6210",children:[(0,l.jsx)(n.p,{children:"\u96C6\u6210Redis\u4F5C\u4E3AMyBatis\u7684\u4E8C\u7EA7\u7F13\u5B58\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u6DFB\u52A0\u4F9D\u8D56"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="pom.xml"',children:"<dependency>\n    <groupId>org.mybatis.caches</groupId>\n    <artifactId>mybatis-redis</artifactId>\n    <version>1.0.0-beta2</version>\n</dependency>\n"})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"\u914D\u7F6ERedis\u8FDE\u63A5\u5C5E\u6027"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-properties",metastring:'title="redis.properties"',children:"redis.host=localhost\nredis.port=6379\nredis.connectionTimeout=5000\nredis.password=\nredis.database=0\n"})}),(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:"\u5728Mapper\u4E2D\u4F7F\u7528Redis\u7F13\u5B58"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u4F7F\u7528Redis\u7F13\u5B58"',children:'<mapper namespace="com.example.mapper.UserMapper">\n  <cache type="org.mybatis.caches.redis.RedisCache">\n    <property name="timeToLive" value="3600000"/> \x3c!-- \u7F13\u5B58\u8FC7\u671F\u65F6\u95F4(\u6BEB\u79D2) --\x3e\n    <property name="configurationPropertiesFile" value="redis.properties"/>\n  </cache>\n  \n  \x3c!-- \u6620\u5C04\u8BED\u53E5... --\x3e\n</mapper>\n'})}),(0,l.jsxs)(n.ol,{start:"4",children:["\n",(0,l.jsx)(n.li,{children:"\u81EA\u5B9A\u4E49Redis\u7F13\u5B58\u5B9E\u73B0"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u81EA\u5B9A\u4E49Redis\u7F13\u5B58"',children:'public class CustomRedisCache implements Cache {\n    private final String id;\n    private static JedisPool jedisPool;\n    \n    // \u521D\u59CB\u5316Redis\u8FDE\u63A5\u6C60\n    static {\n        JedisPoolConfig config = new JedisPoolConfig();\n        config.setMaxTotal(100);\n        config.setMaxIdle(20);\n        jedisPool = new JedisPool(config, "localhost", 6379);\n    }\n    \n    public CustomRedisCache(String id) {\n        this.id = id;\n    }\n    \n    @Override\n    public String getId() {\n        return this.id;\n    }\n    \n    @Override\n    public void putObject(Object key, Object value) {\n        try (Jedis jedis = jedisPool.getResource()) {\n            jedis.set(serializeKey(key), SerializeUtil.serialize(value));\n            jedis.expire(serializeKey(key), 3600); // 1\u5C0F\u65F6\u8FC7\u671F\n        }\n    }\n    \n    @Override\n    public Object getObject(Object key) {\n        try (Jedis jedis = jedisPool.getResource()) {\n            byte[] value = jedis.get(serializeKey(key));\n            return value != null ? SerializeUtil.unserialize(value) : null;\n        }\n    }\n    \n    @Override\n    public Object removeObject(Object key) {\n        try (Jedis jedis = jedisPool.getResource()) {\n            return jedis.del(serializeKey(key));\n        }\n    }\n    \n    @Override\n    public void clear() {\n        try (Jedis jedis = jedisPool.getResource()) {\n            jedis.flushDB();\n        }\n    }\n    \n    @Override\n    public int getSize() {\n        try (Jedis jedis = jedisPool.getResource()) {\n            return jedis.dbSize().intValue();\n        }\n    }\n    \n    private byte[] serializeKey(Object key) {\n        if (key instanceof String) {\n            return (this.id + ":" + key).getBytes();\n        }\n        return (this.id + ":" + key.hashCode()).getBytes();\n    }\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"spring",label:"Spring\u96C6\u6210",children:[(0,l.jsx)(n.p,{children:"\u5728Spring\u73AF\u5883\u4E2D\u4F7F\u7528MyBatis\u7F13\u5B58\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="Spring MyBatis\u914D\u7F6E"',children:'@Configuration\n@MapperScan("com.example.mapper")\npublic class MyBatisConfig {\n    \n    @Bean\n    public SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception {\n        SqlSessionFactoryBean factoryBean = new SqlSessionFactoryBean();\n        factoryBean.setDataSource(dataSource);\n        \n        // \u8BBE\u7F6EMyBatis\u914D\u7F6E\n        org.apache.ibatis.session.Configuration configuration = new org.apache.ibatis.session.Configuration();\n        configuration.setCacheEnabled(true); // \u542F\u7528\u4E8C\u7EA7\u7F13\u5B58\n        configuration.setLocalCacheScope(LocalCacheScope.SESSION); // \u8BBE\u7F6E\u4E00\u7EA7\u7F13\u5B58\u4F5C\u7528\u57DF\n        factoryBean.setConfiguration(configuration);\n        \n        return factoryBean.getObject();\n    }\n    \n    // \u914D\u7F6E\u4E8B\u52A1\u7BA1\u7406\u5668\n    @Bean\n    public DataSourceTransactionManager transactionManager(DataSource dataSource) {\n        return new DataSourceTransactionManager(dataSource);\n    }\n}\n\n// Service\u5C42\u914D\u7F6E\n@Service\n@Transactional\npublic class UserService {\n    @Autowired\n    private UserMapper userMapper;\n    \n    // \u5728\u4E8B\u52A1\u4E2D\uFF0C\u540C\u4E00\u4E2ASqlSession\u4F1A\u88AB\u91CD\u7528\n    // \u4E00\u7EA7\u7F13\u5B58\u5728\u6574\u4E2A\u4E8B\u52A1\u4E2D\u6709\u6548\n    public User getUserById(Long id) {\n        return userMapper.getUserById(id);\n    }\n}\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"64-\u6027\u80FD\u4F18\u5316\u7B56\u7565",children:"6.4 \u6027\u80FD\u4F18\u5316\u7B56\u7565"}),"\n",(0,l.jsx)(n.p,{children:"\u9664\u4E86\u7F13\u5B58\uFF0CMyBatis\u8FD8\u6709\u591A\u79CD\u6027\u80FD\u4F18\u5316\u7B56\u7565\uFF0C\u53EF\u4EE5\u663E\u8457\u63D0\u9AD8\u7CFB\u7EDF\u6027\u80FD\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"strategies",label:"\u901A\u7528\u7B56\u7565",children:[(0,l.jsx)(n.p,{children:"\u5E38\u89C1\u7684MyBatis\u6027\u80FD\u4F18\u5316\u7B56\u7565\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"SQL\u4F18\u5316"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4EC5\u67E5\u8BE2\u5FC5\u8981\u7684\u5217\uFF0C\u907F\u514DSELECT *"}),"\n",(0,l.jsx)(n.li,{children:"\u5408\u7406\u4F7F\u7528\u7D22\u5F15"}),"\n",(0,l.jsx)(n.li,{children:"\u4F18\u5316JOIN\u64CD\u4F5C\u548C\u5B50\u67E5\u8BE2"}),"\n",(0,l.jsx)(n.li,{children:"\u5206\u9875\u67E5\u8BE2\u5927\u6570\u636E\u96C6"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u53C2\u6570\u5904\u7406"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u6279\u91CF\u64CD\u4F5C\u51CF\u5C11\u6570\u636E\u5E93\u4EA4\u4E92"}),"\n",(0,l.jsx)(n.li,{children:"\u5408\u7406\u8BBE\u7F6EPreparedStatement\u7684\u53C2\u6570"}),"\n",(0,l.jsx)(n.li,{children:"\u5BF9\u4E8EIN\u6761\u4EF6\uFF0C\u9650\u5236\u53C2\u6570\u6570\u91CF"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u7ED3\u679C\u6620\u5C04"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528ResultMap\u907F\u514D\u91CD\u590D\u5B9A\u4E49\u5217\u6620\u5C04"}),"\n",(0,l.jsx)(n.li,{children:"\u5408\u7406\u914D\u7F6E\u5EF6\u8FDF\u52A0\u8F7D"}),"\n",(0,l.jsx)(n.li,{children:"\u907F\u514D\u590D\u6742\u7684\u5D4C\u5957\u67E5\u8BE2"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u914D\u7F6E\u4F18\u5316"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u8FDE\u63A5\u6C60\u7BA1\u7406\u6570\u636E\u5E93\u8FDE\u63A5"}),"\n",(0,l.jsx)(n.li,{children:"\u4F18\u5316\u65E5\u5FD7\u914D\u7F6E\uFF0C\u751F\u4EA7\u73AF\u5883\u5173\u95ED\u8BE6\u7EC6\u65E5\u5FD7"}),"\n",(0,l.jsx)(n.li,{children:"\u9002\u5F53\u8BBE\u7F6E\u7F13\u5B58\u5927\u5C0F\u548C\u5237\u65B0\u95F4\u9694"}),"\n"]}),"\n"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="SQL\u4F18\u5316\u793A\u4F8B"',children:'\x3c!-- \u907F\u514DSELECT * --\x3e\n<select id="getUsers" resultType="User">\n  SELECT id, username, email FROM user\n  WHERE status = #{status}\n  LIMIT #{offset}, #{limit}\n</select>\n\n\x3c!-- \u4F7F\u7528\u6279\u91CF\u64CD\u4F5C --\x3e\n<insert id="batchInsert" parameterType="list">\n  INSERT INTO user (username, email, status)\n  VALUES\n  <foreach collection="list" item="user" separator=",">\n    (#{user.username}, #{user.email}, #{user.status})\n  </foreach>\n</insert>\n'})})]}),(0,l.jsxs)(a.A,{value:"lazy-loading",label:"\u5EF6\u8FDF\u52A0\u8F7D",children:[(0,l.jsx)(n.p,{children:"MyBatis\u7684\u5EF6\u8FDF\u52A0\u8F7D\u53EF\u4EE5\u663E\u8457\u63D0\u9AD8\u6027\u80FD\uFF0C\u7279\u522B\u662F\u5728\u5904\u7406\u590D\u6742\u5BF9\u8C61\u5173\u7CFB\u65F6\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u5EF6\u8FDF\u52A0\u8F7D\u914D\u7F6E"',children:'\x3c!-- \u5168\u5C40\u914D\u7F6E --\x3e\n<settings>\n  <setting name="lazyLoadingEnabled" value="true"/>\n  <setting name="aggressiveLazyLoading" value="false"/>\n  <setting name="lazyLoadTriggerMethods" value="equals,clone,hashCode"/>\n</settings>\n\n\x3c!-- \u7279\u5B9A\u5173\u8054\u7684\u5EF6\u8FDF\u52A0\u8F7D\u914D\u7F6E --\x3e\n<resultMap id="UserMap" type="User">\n  <id property="id" column="id"/>\n  <result property="username" column="username"/>\n  \n  \x3c!-- \u5EF6\u8FDF\u52A0\u8F7D\u7528\u6237\u8BA2\u5355 --\x3e\n  <collection property="orders" \n              select="getOrdersByUserId" \n              column="id" \n              fetchType="lazy"/>\n</resultMap>\n\n\x3c!-- \u8986\u76D6\u5168\u5C40\u914D\u7F6E\uFF0C\u4E0D\u4F7F\u7528\u5EF6\u8FDF\u52A0\u8F7D --\x3e\n<resultMap id="UserProfileMap" type="User">\n  <id property="id" column="id"/>\n  <association property="profile" \n               select="getProfileByUserId" \n               column="id" \n               fetchType="eager"/>\n</resultMap>\n'})})]}),(0,l.jsxs)(a.A,{value:"pagination",label:"\u5206\u9875\u4F18\u5316",children:[(0,l.jsx)(n.p,{children:"\u5904\u7406\u5927\u6570\u636E\u96C6\u65F6\uFF0C\u5206\u9875\u67E5\u8BE2\u662F\u91CD\u8981\u7684\u4F18\u5316\u624B\u6BB5\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528MyBatis\u5185\u7F6E\u7684RowBounds\uFF08\u5185\u5B58\u5206\u9875\uFF09"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="RowBounds\u5206\u9875"',children:'// \u4E0D\u5EFA\u8BAE\u7528\u4E8E\u5927\u6570\u636E\u91CF\u573A\u666F\npublic List<User> getUsersByPage(int offset, int limit) {\n    return sqlSession.selectList("getUserList", null, new RowBounds(offset, limit));\n}\n'})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u7269\u7406\u5206\u9875\uFF08\u63A8\u8350\uFF09"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="SQL\u5206\u9875\u67E5\u8BE2"',children:'<select id="getUsersByPage" resultType="User">\n  SELECT * FROM user\n  ORDER BY id\n  LIMIT #{offset}, #{limit}\n</select>\n'})}),(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528PageHelper\u63D2\u4EF6\uFF08\u63A8\u8350\uFF09"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="pom.xml\u4F9D\u8D56"',children:"<dependency>\n    <groupId>com.github.pagehelper</groupId>\n    <artifactId>pagehelper</artifactId>\n    <version>5.2.0</version>\n</dependency>\n"})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="PageHelper\u7528\u6CD5"',children:"// \u5728\u67E5\u8BE2\u524D\u8BBE\u7F6E\u5206\u9875\u53C2\u6570\nPageHelper.startPage(pageNum, pageSize);\nList<User> users = userMapper.getAllUsers();\n\n// \u83B7\u53D6\u5206\u9875\u4FE1\u606F\nPageInfo<User> pageInfo = new PageInfo<>(users);\n"})})]}),(0,l.jsxs)(a.A,{value:"batch",label:"\u6279\u91CF\u5904\u7406",children:[(0,l.jsx)(n.p,{children:"\u6279\u91CF\u64CD\u4F5C\u53EF\u4EE5\u663E\u8457\u63D0\u9AD8\u5927\u91CF\u6570\u636E\u5904\u7406\u7684\u6027\u80FD\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528foreach\u8FDB\u884C\u6279\u91CF\u63D2\u5165"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u6279\u91CF\u63D2\u5165"',children:'<insert id="batchInsert" parameterType="list">\n  INSERT INTO user (username, email, status)\n  VALUES\n  <foreach collection="list" item="user" separator=",">\n    (#{user.username}, #{user.email}, #{user.status})\n  </foreach>\n</insert>\n'})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528JDBC\u6279\u5904\u7406"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="JDBC\u6279\u5904\u7406"',children:'@Update({"<script>",\n         "UPDATE user",\n         "<set>",\n         "status = #{status}",\n         "</set>",\n         "WHERE id IN",\n         "<foreach collection=\'ids\' item=\'id\' open=\'(\' separator=\',\' close=\')\'>",\n         "#{id}",\n         "</foreach>",\n         "<\/script>"})\n@Options(useGeneratedKeys = false, flushCache = Options.FlushCachePolicy.TRUE, \n         statementType = StatementType.PREPARED)\nvoid batchUpdateUserStatus(@Param("ids") List<Long> ids, @Param("status") int status);\n\n// \u5728Spring\u914D\u7F6E\u4E2D\u542F\u7528\u6279\u5904\u7406\n@Bean\npublic SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception {\n    SqlSessionFactoryBean factoryBean = new SqlSessionFactoryBean();\n    factoryBean.setDataSource(dataSource);\n    \n    // \u5148\u6784\u5EFASqlSessionFactory\n    SqlSessionFactory factory = factoryBean.getObject();\n    // \u518D\u914D\u7F6EExecutorType\n    factory.getConfiguration().setDefaultExecutorType(ExecutorType.BATCH);\n    \n    return factory;\n}\n\n// \u4F7F\u7528\u6279\u5904\u7406\u6267\u884C\u5668\npublic void batchUpdateUsers(List<User> users) {\n    try (SqlSession sqlSession = sqlSessionFactory.openSession(ExecutorType.BATCH)) {\n        UserMapper mapper = sqlSession.getMapper(UserMapper.class);\n        \n        for (User user : users) {\n            mapper.updateUser(user);\n        }\n        \n        // \u6279\u91CF\u63D0\u4EA4\n        sqlSession.flushStatements();\n        sqlSession.commit();\n    }\n}\n'})})]})]}),"\n",(0,l.jsx)(n.admonition,{title:"\u6027\u80FD\u4F18\u5316\u6CE8\u610F\u4E8B\u9879",type:"warning",children:(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5408\u7406\u4F7F\u7528\u7F13\u5B58"}),"\uFF1A\u7F13\u5B58\u4E0D\u662F\u4E07\u80FD\u7684\uFF0C\u9700\u8981\u8003\u8651\u6570\u636E\u4E00\u81F4\u6027"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u907F\u514D\u8FC7\u5EA6\u4F18\u5316"}),"\uFF1A\u5148\u627E\u51FA\u771F\u6B63\u7684\u6027\u80FD\u74F6\u9888\uFF0C\u518D\u6709\u9488\u5BF9\u6027\u5730\u4F18\u5316"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u76D1\u63A7\u4E0E\u6D4B\u8BD5"}),"\uFF1A\u5F15\u5165\u6027\u80FD\u76D1\u63A7\uFF0C\u9A8C\u8BC1\u4F18\u5316\u6548\u679C"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5185\u5B58\u6D88\u8017"}),"\uFF1A\u7F13\u5B58\u4F1A\u589E\u52A0\u5185\u5B58\u4F7F\u7528\uFF0C\u9700\u8981\u5E73\u8861\u914D\u7F6E"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5B9A\u671F\u7EF4\u62A4"}),"\uFF1A\u6E05\u7406\u4E0D\u5FC5\u8981\u7684\u7F13\u5B58\uFF0C\u6267\u884C\u5FC5\u8981\u7684\u6570\u636E\u5E93\u4F18\u5316"]}),"\n"]})}),"\n",(0,l.jsx)(n.admonition,{title:"MyBatis\u6027\u80FD\u4F18\u5316\u6E05\u5355",type:"tip",children:(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4F7F\u7528\u4E8C\u7EA7\u7F13\u5B58"}),"\uFF1A\u4E3A\u9891\u7E41\u67E5\u8BE2\u4E14\u5F88\u5C11\u66F4\u65B0\u7684\u6570\u636E\u914D\u7F6E\u7F13\u5B58"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5EF6\u8FDF\u52A0\u8F7D"}),"\uFF1A\u53EA\u5728\u9700\u8981\u65F6\u52A0\u8F7D\u590D\u6742\u5173\u8054\u5BF9\u8C61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6279\u91CF\u64CD\u4F5C"}),"\uFF1A\u51CF\u5C11\u6570\u636E\u5E93\u5F80\u8FD4\u6B21\u6570"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5206\u9875\u67E5\u8BE2"}),"\uFF1A\u907F\u514D\u4E00\u6B21\u6027\u52A0\u8F7D\u5927\u91CF\u6570\u636E"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"SQL\u4F18\u5316"}),"\uFF1A\u7F16\u5199\u9AD8\u6548SQL\uFF0C\u5584\u7528\u7D22\u5F15"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7ED3\u679C\u96C6\u5904\u7406"}),"\uFF1A\u53EA\u67E5\u8BE2\u5FC5\u8981\u7684\u5B57\u6BB5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u8FDE\u63A5\u6C60\u914D\u7F6E"}),"\uFF1A\u4F18\u5316\u6570\u636E\u5E93\u8FDE\u63A5\u6C60\u53C2\u6570"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u907F\u514DN+1\u95EE\u9898"}),"\uFF1A\u4F7F\u7528\u5173\u8054\u67E5\u8BE2\u66FF\u4EE3\u591A\u6B21\u5355\u72EC\u67E5\u8BE2"]}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"7-\u63D2\u4EF6\u5F00\u53D1\u4E0E\u5B9A\u5236\u6269\u5C55",children:"7. \u63D2\u4EF6\u5F00\u53D1\u4E0E\u5B9A\u5236\u6269\u5C55"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u63D0\u4F9B\u4E86\u5F3A\u5927\u7684\u63D2\u4EF6\u673A\u5236\uFF0C\u53EF\u4EE5\u5728SQL\u6267\u884C\u7684\u5173\u952E\u8282\u70B9\u8FDB\u884C\u62E6\u622A\u5E76\u6DFB\u52A0\u81EA\u5B9A\u4E49\u884C\u4E3A\u3002\u63D2\u4EF6\u673A\u5236\u662FMyBatis\u7075\u6D3B\u6027\u548C\u53EF\u6269\u5C55\u6027\u7684\u91CD\u8981\u4F53\u73B0\u3002"}),"\n",(0,l.jsx)(n.mermaid,{value:"graph TD\n    A[MyBatis\u63D2\u4EF6\u673A\u5236] --\x3e B[\u62E6\u622A\u70B9]\n    B --\x3e B1[Executor]\n    B --\x3e B2[ParameterHandler]\n    B --\x3e B3[ResultSetHandler]\n    B --\x3e B4[StatementHandler]\n    \n    A --\x3e C[\u62E6\u622A\u65B9\u6CD5]\n    C --\x3e C1[update\u65B9\u6CD5]\n    C --\x3e C2[query\u65B9\u6CD5]\n    C --\x3e C3[flushStatements\u65B9\u6CD5]\n    C --\x3e C4[commit/rollback\u65B9\u6CD5]\n    C --\x3e C5[getParameterObject\u65B9\u6CD5]\n    C --\x3e C6[setParameters\u65B9\u6CD5]\n    C --\x3e C7[prepare\u65B9\u6CD5]\n    C --\x3e C8[handleResultSets\u65B9\u6CD5]\n    \n    A --\x3e D[\u8D23\u4EFB\u94FE\u6A21\u5F0F]\n    D --\x3e D1[\u591A\u63D2\u4EF6\u987A\u5E8F\u6267\u884C]\n    D --\x3e D2[\u5C42\u5C42\u4EE3\u7406\u5BF9\u8C61]"}),"\n",(0,l.jsx)(n.h3,{id:"71-\u63D2\u4EF6\u673A\u5236\u539F\u7406",children:"7.1 \u63D2\u4EF6\u673A\u5236\u539F\u7406"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u63D2\u4EF6\u57FA\u4E8E\u52A8\u6001\u4EE3\u7406\u548C\u8D23\u4EFB\u94FE\u6A21\u5F0F\u8BBE\u8BA1\uFF0C\u901A\u8FC7\u62E6\u622A\u6838\u5FC3\u7EC4\u4EF6\u7684\u65B9\u6CD5\u8C03\u7528\u5B9E\u73B0\u529F\u80FD\u6269\u5C55\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"intercept-points",label:"\u62E6\u622A\u70B9",children:[(0,l.jsx)(n.p,{children:"MyBatis\u63D0\u4F9B\u4E86\u56DB\u4E2A\u62E6\u622A\u70B9\uFF0C\u5BF9\u5E94\u6838\u5FC3\u7EC4\u4EF6\u7684\u4E0D\u540C\u5904\u7406\u9636\u6BB5\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Executor"}),"\uFF1A\u8D1F\u8D23\u6267\u884CSQL\u7684\u6838\u5FC3\u7EC4\u4EF6\uFF0C\u5305\u62EC\u521B\u5EFAStatement\u3001\u53C2\u6570\u8BBE\u7F6E\u3001\u6267\u884CSQL\u3001\u5904\u7406\u7ED3\u679C\u7B49"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"update"}),": \u6267\u884C\u63D2\u5165/\u66F4\u65B0/\u5220\u9664\u64CD\u4F5C"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"query"}),": \u6267\u884C\u67E5\u8BE2\u64CD\u4F5C"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"flushStatements"}),": \u5237\u65B0\u8BED\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"commit"}),": \u63D0\u4EA4\u4E8B\u52A1"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"rollback"}),": \u56DE\u6EDA\u4E8B\u52A1"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"getTransaction"}),": \u83B7\u53D6\u4E8B\u52A1"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"close"}),": \u5173\u95EDexecutor"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"isClosed"}),": \u68C0\u67E5executor\u662F\u5426\u5173\u95ED"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"StatementHandler"}),"\uFF1A\u8D1F\u8D23\u5904\u7406JDBC Statement\u7684\u7EC4\u4EF6"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"prepare"}),": \u51C6\u5907Statement"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"parameterize"}),": \u8BBE\u7F6E\u53C2\u6570"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"batch"}),": \u6279\u5904\u7406"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"update"}),": \u6267\u884C\u66F4\u65B0"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"query"}),": \u6267\u884C\u67E5\u8BE2"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"ParameterHandler"}),"\uFF1A\u8D1F\u8D23\u5904\u7406SQL\u53C2\u6570\u7684\u7EC4\u4EF6"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"getParameterObject"}),": \u83B7\u53D6\u53C2\u6570\u5BF9\u8C61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"setParameters"}),": \u8BBE\u7F6E\u53C2\u6570"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"ResultSetHandler"}),"\uFF1A\u8D1F\u8D23\u5904\u7406\u67E5\u8BE2\u7ED3\u679C\u96C6\u7684\u7EC4\u4EF6"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"handleResultSets"}),": \u5904\u7406\u7ED3\u679C\u96C6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"handleOutputParameters"}),": \u5904\u7406\u8F93\u51FA\u53C2\u6570"]}),"\n"]}),"\n"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u62E6\u622A\u70B9\u6CE8\u89E3\u793A\u4F8B"',children:'@Intercepts({\n    // \u62E6\u622AExecutor\u7684update\u65B9\u6CD5\n    @Signature(\n        type = Executor.class,\n        method = "update",\n        args = {MappedStatement.class, Object.class}\n    ),\n    // \u62E6\u622AExecutor\u7684query\u65B9\u6CD5\n    @Signature(\n        type = Executor.class,\n        method = "query",\n        args = {MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class}\n    ),\n    // \u62E6\u622AStatementHandler\u7684prepare\u65B9\u6CD5\n    @Signature(\n        type = StatementHandler.class,\n        method = "prepare",\n        args = {Connection.class, Integer.class}\n    )\n})\npublic class ExamplePlugin implements Interceptor {\n    // \u5B9E\u73B0\u62E6\u622A\u903B\u8F91...\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"proxy-mechanism",label:"\u4EE3\u7406\u673A\u5236",children:[(0,l.jsx)(n.p,{children:"MyBatis\u63D2\u4EF6\u4F7F\u7528JDK\u52A8\u6001\u4EE3\u7406\u5B9E\u73B0\u65B9\u6CD5\u62E6\u622A\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u63D2\u4EF6\u6CE8\u518C"}),"\uFF1A\u5728MyBatis\u521D\u59CB\u5316\u65F6\uFF0C\u901A\u8FC7",(0,l.jsx)(n.code,{children:"InterceptorChain"}),"\u6CE8\u518C\u6240\u6709\u63D2\u4EF6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u521B\u5EFA\u4EE3\u7406"}),"\uFF1A\u4E3A\u6BCF\u4E2A\u76EE\u6807\u5BF9\u8C61\u521B\u5EFA\u4EE3\u7406\uFF0C\u4EE3\u7406\u4F1A\u62E6\u622A\u7279\u5B9A\u65B9\u6CD5\u8C03\u7528"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u8D23\u4EFB\u94FE\u6267\u884C"}),"\uFF1A\u6309\u7167\u63D2\u4EF6\u6CE8\u518C\u987A\u5E8F\u4F9D\u6B21\u6267\u884C\u62E6\u622A\u5668\u94FE\u4E2D\u7684\u63D2\u4EF6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u53C2\u6570\u8BBF\u95EE"}),"\uFF1A\u901A\u8FC7",(0,l.jsx)(n.code,{children:"Invocation"}),"\u5BF9\u8C61\u8BBF\u95EE\u88AB\u62E6\u622A\u65B9\u6CD5\u7684\u53C2\u6570\u548C\u76EE\u6807\u5BF9\u8C61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u63A7\u5236\u6D41\u7A0B"}),"\uFF1A\u63D2\u4EF6\u53EF\u4EE5\u4FEE\u6539\u53C2\u6570\u3001\u6267\u884C\u989D\u5916\u903B\u8F91\u3001\u4FEE\u6539\u8FD4\u56DE\u7ED3\u679C\uFF0C\u751A\u81F3\u4E0D\u6267\u884C\u539F\u65B9\u6CD5"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u63D2\u4EF6\u6267\u884C\u6D41\u7A0B"',children:"// \u521D\u59CB\u5316\u63D2\u4EF6\u94FE\nInterceptorChain interceptorChain = new InterceptorChain();\ninterceptorChain.addInterceptor(new LoggingPlugin());\ninterceptorChain.addInterceptor(new PaginationPlugin());\ninterceptorChain.addInterceptor(new PerformancePlugin());\n\n// \u521B\u5EFA\u4EE3\u7406\u5BF9\u8C61\nExecutor target = new SimpleExecutor();\nExecutor proxy = (Executor) interceptorChain.pluginAll(target);\n\n// \u6267\u884C\u65B9\u6CD5\u65F6\uFF0C\u4F1A\u89E6\u53D1\u63D2\u4EF6\u94FE\n// 3. PerformancePlugin.intercept()\n//   2. PaginationPlugin.intercept()\n//     1. LoggingPlugin.intercept()\n//       target.query() // \u539F\u65B9\u6CD5\u6267\u884C\n//     1. \u8FD4\u56DE\u7ED3\u679C\n//   2. \u8FD4\u56DE\u7ED3\u679C\n// 3. \u8FD4\u56DE\u7ED3\u679C\nproxy.query(...);\n"})})]}),(0,l.jsxs)(a.A,{value:"plugin-annotation",label:"\u63D2\u4EF6\u6CE8\u89E3",children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"@Intercepts"}),"\u548C",(0,l.jsx)(n.code,{children:"@Signature"}),"\u6CE8\u89E3\u7528\u4E8E\u58F0\u660E\u62E6\u622A\u70B9\uFF1A"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u63D2\u4EF6\u6CE8\u89E3\u8BE6\u89E3"',children:"@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\npublic @interface Intercepts {\n  Signature[] value();\n}\n\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target({})\npublic @interface Signature {\n  Class<?> type();  // \u62E6\u622A\u7684\u63A5\u53E3\u7C7B\u578B\n  String method();  // \u62E6\u622A\u7684\u65B9\u6CD5\u540D\n  Class<?>[] args();  // \u62E6\u622A\u7684\u65B9\u6CD5\u53C2\u6570\u7C7B\u578B\n}\n"})}),(0,l.jsx)(n.p,{children:"\u62E6\u622A\u70B9\u7684\u5B8C\u6574\u5339\u914D\u89C4\u5219\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\u88AB\u62E6\u622A\u5BF9\u8C61\u5FC5\u987B\u662F",(0,l.jsx)(n.code,{children:"@Signature.type"}),"\u6307\u5B9A\u7684\u7C7B\u578B"]}),"\n",(0,l.jsxs)(n.li,{children:["\u88AB\u62E6\u622A\u65B9\u6CD5\u5FC5\u987B\u662F",(0,l.jsx)(n.code,{children:"@Signature.method"}),"\u6307\u5B9A\u7684\u65B9\u6CD5\u540D"]}),"\n",(0,l.jsxs)(n.li,{children:["\u88AB\u62E6\u622A\u65B9\u6CD5\u7684\u53C2\u6570\u5FC5\u987B\u4E0E",(0,l.jsx)(n.code,{children:"@Signature.args"}),"\u6307\u5B9A\u7684\u53C2\u6570\u7C7B\u578B\u5217\u8868\u4E00\u81F4"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"plugin-loading",label:"\u63D2\u4EF6\u52A0\u8F7D",children:[(0,l.jsx)(n.p,{children:"MyBatis\u52A0\u8F7D\u548C\u521D\u59CB\u5316\u63D2\u4EF6\u7684\u8FC7\u7A0B\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u914D\u7F6E\u89E3\u6790"}),"\uFF1A\u89E3\u6790",(0,l.jsx)(n.code,{children:"mybatis-config.xml"}),"\u4E2D\u7684",(0,l.jsx)(n.code,{children:"plugins"}),"\u8282\u70B9"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5B9E\u4F8B\u5316\u63D2\u4EF6"}),"\uFF1A\u6839\u636E\u914D\u7F6E\u521B\u5EFA\u63D2\u4EF6\u5B9E\u4F8B\uFF0C\u5E76\u8BBE\u7F6E\u5C5E\u6027"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6CE8\u518C\u63D2\u4EF6"}),"\uFF1A\u5C06\u63D2\u4EF6\u6DFB\u52A0\u5230",(0,l.jsx)(n.code,{children:"InterceptorChain"}),"\u4E2D"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5305\u88C5\u76EE\u6807\u5BF9\u8C61"}),"\uFF1A\u5728\u521B\u5EFA\u6838\u5FC3\u7EC4\u4EF6\u65F6\uFF0C\u901A\u8FC7",(0,l.jsx)(n.code,{children:"InterceptorChain.pluginAll()"}),"\u65B9\u6CD5\u5305\u88C5\u76EE\u6807\u5BF9\u8C61"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u63D2\u4EF6\u914D\u7F6E"',children:'<plugins>\n  <plugin interceptor="com.example.plugin.LoggingPlugin">\n    <property name="level" value="DEBUG"/>\n  </plugin>\n  <plugin interceptor="com.example.plugin.PaginationPlugin">\n    <property name="dialect" value="mysql"/>\n  </plugin>\n</plugins>\n'})}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u63D2\u4EF6\u52A0\u8F7D\u8FC7\u7A0B"',children:'// 1. \u914D\u7F6E\u89E3\u6790\nList<InterceptorConfig> interceptorConfigs = parseConfig(root.evalNode("plugins"));\n\n// 2. \u5B9E\u4F8B\u5316\u63D2\u4EF6\nfor (InterceptorConfig config : interceptorConfigs) {\n    Interceptor interceptor = (Interceptor) resolveClass(config.getInterceptorClass()).newInstance();\n    interceptor.setProperties(config.getProperties());\n    \n    // 3. \u6CE8\u518C\u63D2\u4EF6\n    configuration.addInterceptor(interceptor);\n}\n\n// 4. \u5305\u88C5\u76EE\u6807\u5BF9\u8C61\uFF08\u793A\u4F8B\uFF1A\u521B\u5EFAExecutor\uFF09\npublic Executor newExecutor(Transaction transaction, ExecutorType executorType) {\n    Executor executor;\n    if (ExecutorType.BATCH == executorType) {\n        executor = new BatchExecutor(this, transaction);\n    } else if (ExecutorType.REUSE == executorType) {\n        executor = new ReuseExecutor(this, transaction);\n    } else {\n        executor = new SimpleExecutor(this, transaction);\n    }\n    \n    // \u5305\u88C5Executor\n    return (Executor) interceptorChain.pluginAll(executor);\n}\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"72-\u81EA\u5B9A\u4E49\u63D2\u4EF6\u5F00\u53D1",children:"7.2 \u81EA\u5B9A\u4E49\u63D2\u4EF6\u5F00\u53D1"}),"\n",(0,l.jsxs)(n.p,{children:["\u5F00\u53D1MyBatis\u63D2\u4EF6\u9700\u8981\u5B9E\u73B0",(0,l.jsx)(n.code,{children:"Interceptor"}),"\u63A5\u53E3\uFF0C\u901A\u8FC7\u62E6\u622A\u70B9\u8FDB\u884C\u529F\u80FD\u6269\u5C55\u3002\u4EE5\u4E0B\u662F\u5E38\u89C1\u7684\u63D2\u4EF6\u5F00\u53D1\u573A\u666F\u3002"]}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"basic",label:"\u63D2\u4EF6\u57FA\u672C\u7ED3\u6784",children:[(0,l.jsx)(n.p,{children:"\u5B9E\u73B0\u4E00\u4E2AMyBatis\u63D2\u4EF6\u9700\u8981\u5B8C\u6210\u4EE5\u4E0B\u6B65\u9AA4\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\u5B9E\u73B0",(0,l.jsx)(n.code,{children:"org.apache.ibatis.plugin.Interceptor"}),"\u63A5\u53E3"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4F7F\u7528",(0,l.jsx)(n.code,{children:"@Intercepts"}),"\u548C",(0,l.jsx)(n.code,{children:"@Signature"}),"\u6CE8\u89E3\u5B9A\u4E49\u62E6\u622A\u70B9"]}),"\n",(0,l.jsxs)(n.li,{children:["\u5728",(0,l.jsx)(n.code,{children:"intercept()"}),"\u65B9\u6CD5\u4E2D\u5B9E\u73B0\u62E6\u622A\u903B\u8F91"]}),"\n",(0,l.jsxs)(n.li,{children:["\u5728",(0,l.jsx)(n.code,{children:"plugin()"}),"\u65B9\u6CD5\u4E2D\u5305\u88C5\u76EE\u6807\u5BF9\u8C61"]}),"\n",(0,l.jsxs)(n.li,{children:["\u5B9E\u73B0",(0,l.jsx)(n.code,{children:"setProperties()"}),"\u65B9\u6CD5\u5904\u7406\u63D2\u4EF6\u914D\u7F6E\u5C5E\u6027"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u63D2\u4EF6\u57FA\u672C\u7ED3\u6784"',children:'@Intercepts({\n    @Signature(\n        type = Executor.class,\n        method = "update",\n        args = {MappedStatement.class, Object.class}\n    )\n})\npublic class ExamplePlugin implements Interceptor {\n    \n    private Properties properties = new Properties();\n    \n    @Override\n    public Object intercept(Invocation invocation) throws Throwable {\n        // \u5728\u65B9\u6CD5\u6267\u884C\u524D\u6DFB\u52A0\u903B\u8F91\n        Object target = invocation.getTarget(); // \u76EE\u6807\u5BF9\u8C61\n        Method method = invocation.getMethod(); // \u88AB\u62E6\u622A\u7684\u65B9\u6CD5\n        Object[] args = invocation.getArgs();   // \u65B9\u6CD5\u53C2\u6570\n        \n        // \u6267\u884C\u539F\u65B9\u6CD5\n        Object result = invocation.proceed();\n        \n        // \u5728\u65B9\u6CD5\u6267\u884C\u540E\u6DFB\u52A0\u903B\u8F91\n        \n        return result;\n    }\n    \n    @Override\n    public Object plugin(Object target) {\n        // \u5305\u88C5\u76EE\u6807\u5BF9\u8C61\u4E3A\u4EE3\u7406\u5BF9\u8C61\n        return Plugin.wrap(target, this);\n    }\n    \n    @Override\n    public void setProperties(Properties properties) {\n        // \u8BBE\u7F6E\u63D2\u4EF6\u5C5E\u6027\n        this.properties = properties;\n    }\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"sql-logger",label:"SQL\u65E5\u5FD7\u63D2\u4EF6",children:[(0,l.jsx)(n.p,{children:"\u5B9E\u73B0\u4E00\u4E2ASQL\u65E5\u5FD7\u8BB0\u5F55\u63D2\u4EF6\uFF0C\u8BB0\u5F55SQL\u6267\u884C\u65F6\u95F4\u548C\u53C2\u6570\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="SQL\u65E5\u5FD7\u63D2\u4EF6"',children:'@Intercepts({\n    @Signature(\n        type = StatementHandler.class,\n        method = "query",\n        args = {Statement.class, ResultHandler.class}\n    ),\n    @Signature(\n        type = StatementHandler.class,\n        method = "update",\n        args = {Statement.class}\n    )\n})\npublic class SqlLoggerPlugin implements Interceptor {\n    \n    private static final Logger logger = LoggerFactory.getLogger(SqlLoggerPlugin.class);\n    private boolean showSql = true;\n    private boolean showParams = true;\n    private boolean showTime = true;\n    \n    @Override\n    public Object intercept(Invocation invocation) throws Throwable {\n        StatementHandler handler = (StatementHandler) invocation.getTarget();\n        long startTime = System.currentTimeMillis();\n        \n        try {\n            // \u6267\u884CSQL\n            Object result = invocation.proceed();\n            \n            // \u8BB0\u5F55\u65E5\u5FD7\n            if (showSql || showParams || showTime) {\n                BoundSql boundSql = handler.getBoundSql();\n                String sql = boundSql.getSql().replaceAll("\\\\s+", " ");\n                Object parameterObject = boundSql.getParameterObject();\n                long elapsed = System.currentTimeMillis() - startTime;\n                \n                StringBuilder logBuilder = new StringBuilder();\n                if (showSql) {\n                    logBuilder.append("SQL: ").append(sql);\n                }\n                \n                if (showParams) {\n                    logBuilder.append("\\nParameters: ").append(parameterObject);\n                }\n                \n                if (showTime) {\n                    logBuilder.append("\\nExecution Time: ").append(elapsed).append("ms");\n                }\n                \n                logger.debug(logBuilder.toString());\n            }\n            \n            return result;\n        } catch (Throwable e) {\n            long elapsed = System.currentTimeMillis() - startTime;\n            logger.error("SQL execution error, Time: {}ms", elapsed, e);\n            throw e;\n        }\n    }\n    \n    @Override\n    public Object plugin(Object target) {\n        return Plugin.wrap(target, this);\n    }\n    \n    @Override\n    public void setProperties(Properties properties) {\n        this.showSql = Boolean.parseBoolean(properties.getProperty("showSql", "true"));\n        this.showParams = Boolean.parseBoolean(properties.getProperty("showParams", "true"));\n        this.showTime = Boolean.parseBoolean(properties.getProperty("showTime", "true"));\n    }\n}\n'})}),(0,l.jsx)(n.p,{children:"\u914D\u7F6ESQL\u65E5\u5FD7\u63D2\u4EF6\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u63D2\u4EF6\u914D\u7F6E"',children:'<plugin interceptor="com.example.plugin.SqlLoggerPlugin">\n  <property name="showSql" value="true"/>\n  <property name="showParams" value="true"/>\n  <property name="showTime" value="true"/>\n</plugin>\n'})})]}),(0,l.jsxs)(a.A,{value:"param-encrypt",label:"\u53C2\u6570\u52A0\u5BC6\u63D2\u4EF6",children:[(0,l.jsx)(n.p,{children:"\u5B9E\u73B0\u4E00\u4E2A\u53C2\u6570\u52A0\u5BC6\u63D2\u4EF6\uFF0C\u81EA\u52A8\u5BF9\u6307\u5B9A\u53C2\u6570\u8FDB\u884C\u52A0\u5BC6\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u53C2\u6570\u52A0\u5BC6\u63D2\u4EF6"',children:'@Intercepts({\n    @Signature(\n        type = ParameterHandler.class,\n        method = "setParameters",\n        args = {PreparedStatement.class}\n    )\n})\npublic class ParameterEncryptPlugin implements Interceptor {\n    \n    private Set<String> encryptFields = new HashSet<>();\n    private EncryptionService encryptionService;\n    \n    @Override\n    public Object intercept(Invocation invocation) throws Throwable {\n        ParameterHandler handler = (ParameterHandler) invocation.getTarget();\n        \n        // \u83B7\u53D6\u53C2\u6570\u5BF9\u8C61\n        Field parameterObjectField = handler.getClass().getDeclaredField("parameterObject");\n        parameterObjectField.setAccessible(true);\n        Object parameterObject = parameterObjectField.get(handler);\n        \n        // \u52A0\u5BC6\u53C2\u6570\n        if (parameterObject != null) {\n            if (parameterObject instanceof Map) {\n                // \u5904\u7406Map\u53C2\u6570\n                Map<String, Object> paramMap = (Map<String, Object>) parameterObject;\n                for (String field : encryptFields) {\n                    if (paramMap.containsKey(field) && paramMap.get(field) != null) {\n                        String value = paramMap.get(field).toString();\n                        paramMap.put(field, encryptionService.encrypt(value));\n                    }\n                }\n            } else {\n                // \u5904\u7406JavaBean\u53C2\u6570\n                for (String field : encryptFields) {\n                    try {\n                        PropertyDescriptor descriptor = new PropertyDescriptor(field, parameterObject.getClass());\n                        Method getter = descriptor.getReadMethod();\n                        Method setter = descriptor.getWriteMethod();\n                        \n                        if (getter != null && setter != null) {\n                            Object value = getter.invoke(parameterObject);\n                            if (value != null && value instanceof String) {\n                                setter.invoke(parameterObject, encryptionService.encrypt((String) value));\n                            }\n                        }\n                    } catch (Exception e) {\n                        // \u5FFD\u7565\u4E0D\u5B58\u5728\u7684\u5C5E\u6027\n                    }\n                }\n            }\n        }\n        \n        // \u6267\u884C\u539F\u65B9\u6CD5\n        return invocation.proceed();\n    }\n    \n    @Override\n    public Object plugin(Object target) {\n        return Plugin.wrap(target, this);\n    }\n    \n    @Override\n    public void setProperties(Properties properties) {\n        String fields = properties.getProperty("encryptFields", "");\n        for (String field : fields.split(",")) {\n            field = field.trim();\n            if (!field.isEmpty()) {\n                encryptFields.add(field);\n            }\n        }\n        \n        // \u5B9E\u9645\u9879\u76EE\u4E2D\u5E94\u4F7F\u7528\u4F9D\u8D56\u6CE8\u5165\n        encryptionService = new AESEncryptionService();\n    }\n}\n\n// \u52A0\u5BC6\u670D\u52A1\u63A5\u53E3\u548C\u5B9E\u73B0\ninterface EncryptionService {\n    String encrypt(String data);\n    String decrypt(String encryptedData);\n}\n\nclass AESEncryptionService implements EncryptionService {\n    private static final String KEY = "1234567890abcdef";\n    \n    @Override\n    public String encrypt(String data) {\n        // AES\u52A0\u5BC6\u5B9E\u73B0...\n        return "ENCRYPTED:" + data;\n    }\n    \n    @Override\n    public String decrypt(String encryptedData) {\n        // AES\u89E3\u5BC6\u5B9E\u73B0...\n        return encryptedData.substring("ENCRYPTED:".length());\n    }\n}\n'})}),(0,l.jsx)(n.p,{children:"\u914D\u7F6E\u53C2\u6570\u52A0\u5BC6\u63D2\u4EF6\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u63D2\u4EF6\u914D\u7F6E"',children:'<plugin interceptor="com.example.plugin.ParameterEncryptPlugin">\n  <property name="encryptFields" value="password,creditCard,idNumber"/>\n</plugin>\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"73-\u5206\u9875\u63D2\u4EF6\u5B9E\u73B0",children:"7.3 \u5206\u9875\u63D2\u4EF6\u5B9E\u73B0"}),"\n",(0,l.jsx)(n.p,{children:"\u5206\u9875\u662F\u5E94\u7528\u4E2D\u5E38\u89C1\u7684\u9700\u6C42\uFF0C\u901A\u8FC7\u63D2\u4EF6\u673A\u5236\u53EF\u4EE5\u5B9E\u73B0\u7EDF\u4E00\u7684\u5206\u9875\u529F\u80FD\uFF0C\u907F\u514D\u624B\u52A8\u7F16\u5199\u5206\u9875\u4EE3\u7801\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"custom",label:"\u81EA\u5B9A\u4E49\u5206\u9875\u63D2\u4EF6",children:[(0,l.jsx)(n.p,{children:"\u5B9E\u73B0\u4E00\u4E2A\u57FA\u7840\u7684\u5206\u9875\u63D2\u4EF6\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u81EA\u5B9A\u4E49\u5206\u9875\u63D2\u4EF6"',children:'@Intercepts({\n    @Signature(\n        type = Executor.class,\n        method = "query",\n        args = {MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class}\n    )\n})\npublic class PaginationPlugin implements Interceptor {\n    \n    private String databaseType;\n    \n    @Override\n    public Object intercept(Invocation invocation) throws Throwable {\n        Object[] args = invocation.getArgs();\n        MappedStatement ms = (MappedStatement) args[0];\n        Object parameterObject = args[1];\n        RowBounds rowBounds = (RowBounds) args[2];\n        \n        // \u5224\u65AD\u662F\u5426\u9700\u8981\u5206\u9875\n        if (rowBounds == null || rowBounds == RowBounds.DEFAULT) {\n            // \u4E0D\u9700\u8981\u5206\u9875\uFF0C\u6267\u884C\u539F\u65B9\u6CD5\n            return invocation.proceed();\n        }\n        \n        // \u83B7\u53D6\u539F\u59CBSQL\n        BoundSql boundSql = ms.getBoundSql(parameterObject);\n        String sql = boundSql.getSql().trim();\n        \n        // \u6784\u5EFA\u5206\u9875SQL\n        String pageSql = buildPageSql(sql, rowBounds);\n        \n        // \u521B\u5EFA\u65B0\u7684BoundSql\n        BoundSql newBoundSql = copyBoundSql(ms, boundSql, pageSql);\n        \n        // \u521B\u5EFA\u65B0\u7684MappedStatement\n        MappedStatement newMs = copyMappedStatement(ms, newBoundSql);\n        \n        // \u6E05\u9664RowBounds\uFF0C\u907F\u514DMyBatis\u5185\u5B58\u5206\u9875\n        args[0] = newMs;\n        args[2] = RowBounds.DEFAULT;\n        \n        // \u6267\u884C\u5206\u9875\u67E5\u8BE2\n        return invocation.proceed();\n    }\n    \n    /**\n     * \u6839\u636E\u6570\u636E\u5E93\u7C7B\u578B\u6784\u5EFA\u5206\u9875SQL\n     */\n    private String buildPageSql(String sql, RowBounds rowBounds) {\n        int offset = rowBounds.getOffset();\n        int limit = rowBounds.getLimit();\n        \n        StringBuilder pageSql = new StringBuilder(sql.length() + 100);\n        \n        if ("mysql".equalsIgnoreCase(databaseType)) {\n            pageSql.append(sql)\n                   .append(" LIMIT ")\n                   .append(offset)\n                   .append(", ")\n                   .append(limit);\n        } else if ("oracle".equalsIgnoreCase(databaseType)) {\n            pageSql.append("SELECT * FROM ( ")\n                   .append("SELECT TMP.*, ROWNUM ROW_ID FROM ( ")\n                   .append(sql)\n                   .append(" ) TMP WHERE ROWNUM <= ")\n                   .append(offset + limit)\n                   .append(" ) WHERE ROW_ID > ")\n                   .append(offset);\n        } else if ("sqlserver".equalsIgnoreCase(databaseType)) {\n            // SQL Server 2012+\n            pageSql.append(sql)\n                   .append(" OFFSET ")\n                   .append(offset)\n                   .append(" ROWS FETCH NEXT ")\n                   .append(limit)\n                   .append(" ROWS ONLY");\n        } else {\n            // \u9ED8\u8BA4\u4F7F\u7528MySQL\u8BED\u6CD5\n            pageSql.append(sql)\n                   .append(" LIMIT ")\n                   .append(offset)\n                   .append(", ")\n                   .append(limit);\n        }\n        \n        return pageSql.toString();\n    }\n    \n    /**\n     * \u521B\u5EFA\u65B0\u7684BoundSql\n     */\n    private BoundSql copyBoundSql(MappedStatement ms, BoundSql boundSql, String sql) {\n        // \u590D\u5236BoundSql\u7684\u5B9E\u73B0...\n        // \u5B9E\u9645\u4EE3\u7801\u9700\u8981\u590D\u5236boundSql\u7684\u6240\u6709\u5C5E\u6027\u548C\u53C2\u6570\u6620\u5C04\n        \n        return new BoundSql(\n            ms.getConfiguration(),\n            sql,\n            boundSql.getParameterMappings(),\n            boundSql.getParameterObject()\n        );\n    }\n    \n    /**\n     * \u521B\u5EFA\u65B0\u7684MappedStatement\n     */\n    private MappedStatement copyMappedStatement(MappedStatement ms, BoundSql boundSql) {\n        // \u590D\u5236MappedStatement\u7684\u5B9E\u73B0...\n        // \u5B9E\u9645\u4EE3\u7801\u9700\u8981\u4F7F\u7528MappedStatement.Builder\u6765\u6784\u5EFA\u65B0\u7684MappedStatement\n        \n        return new MappedStatement.Builder(\n            ms.getConfiguration(),\n            ms.getId(),\n            new StaticSqlSource(ms.getConfiguration(), boundSql.getSql(), boundSql.getParameterMappings()),\n            ms.getSqlCommandType()\n        ).cache(ms.getCache())\n         .fetchSize(ms.getFetchSize())\n         .flushCacheRequired(ms.isFlushCacheRequired())\n         .useCache(ms.isUseCache())\n         .resultMaps(ms.getResultMaps())\n         .resultSetType(ms.getResultSetType())\n         .statementType(ms.getStatementType())\n         .timeout(ms.getTimeout())\n         .parameterMap(ms.getParameterMap())\n         .build();\n    }\n    \n    @Override\n    public Object plugin(Object target) {\n        return Plugin.wrap(target, this);\n    }\n    \n    @Override\n    public void setProperties(Properties properties) {\n        this.databaseType = properties.getProperty("databaseType", "mysql");\n    }\n}\n'})}),(0,l.jsx)(n.p,{children:"\u914D\u7F6E\u5206\u9875\u63D2\u4EF6\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u63D2\u4EF6\u914D\u7F6E"',children:'<plugin interceptor="com.example.plugin.PaginationPlugin">\n  <property name="databaseType" value="mysql"/>\n</plugin>\n'})}),(0,l.jsx)(n.p,{children:"\u4F7F\u7528\u5206\u9875\u63D2\u4EF6\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5206\u9875\u67E5\u8BE2"',children:'// \u521B\u5EFA\u5206\u9875\u53C2\u6570\uFF08offset, limit\uFF09\nRowBounds rowBounds = new RowBounds(20, 10); // \u4ECE\u7B2C21\u6761\u5F00\u59CB\uFF0C\u83B7\u53D610\u6761\n\n// \u6267\u884C\u5206\u9875\u67E5\u8BE2\nList<User> users = sqlSession.selectList("getUserList", parameter, rowBounds);\n'})})]}),(0,l.jsxs)(a.A,{value:"pagehelper",label:"PageHelper\u63D2\u4EF6",children:[(0,l.jsx)(n.p,{children:"PageHelper\u662FMyBatis\u6700\u6D41\u884C\u7684\u5206\u9875\u63D2\u4EF6\uFF0C\u63D0\u4F9B\u4E86\u66F4\u52A0\u7B80\u4FBF\u7684\u5206\u9875API\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u6DFB\u52A0PageHelper\u4F9D\u8D56"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="pom.xml"',children:"<dependency>\n    <groupId>com.github.pagehelper</groupId>\n    <artifactId>pagehelper</artifactId>\n    <version>5.2.0</version>\n</dependency>\n"})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"\u914D\u7F6EPageHelper\u63D2\u4EF6"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="mybatis-config.xml"',children:'<plugins>\n  <plugin interceptor="com.github.pagehelper.PageInterceptor">\n    <property name="helperDialect" value="mysql"/>\n    <property name="reasonable" value="true"/>\n    <property name="supportMethodsArguments" value="true"/>\n  </plugin>\n</plugins>\n'})}),(0,l.jsx)(n.p,{children:"\u6216\u8005\u5728Spring Boot\u4E2D\u914D\u7F6E\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="MyBatisConfig.java"',children:'@Configuration\npublic class MyBatisConfig {\n    @Bean\n    public PageInterceptor pageInterceptor() {\n        PageInterceptor pageInterceptor = new PageInterceptor();\n        Properties properties = new Properties();\n        properties.setProperty("helperDialect", "mysql");\n        properties.setProperty("reasonable", "true");\n        properties.setProperty("supportMethodsArguments", "true");\n        pageInterceptor.setProperties(properties);\n        return pageInterceptor;\n    }\n}\n'})}),(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528PageHelper\u8FDB\u884C\u5206\u9875"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5206\u9875\u67E5\u8BE2"',children:'// \u65B9\u5F0F1\uFF1A\u4F7F\u7528PageHelper.startPage\u5F00\u59CB\u5206\u9875\nPageHelper.startPage(1, 10);  // \u7B2C1\u9875\uFF0C\u6BCF\u987510\u6761\nList<User> users = userMapper.getAllUsers();\n\n// \u83B7\u53D6\u5206\u9875\u4FE1\u606F\nPageInfo<User> pageInfo = new PageInfo<>(users);\nSystem.out.println("\u603B\u8BB0\u5F55\u6570: " + pageInfo.getTotal());\nSystem.out.println("\u603B\u9875\u6570: " + pageInfo.getPages());\nSystem.out.println("\u5F53\u524D\u9875: " + pageInfo.getPageNum());\nSystem.out.println("\u6BCF\u9875\u8BB0\u5F55\u6570: " + pageInfo.getPageSize());\n\n// \u65B9\u5F0F2\uFF1A\u4F7F\u7528PageHelper.offsetPage\u6307\u5B9A\u504F\u79FB\u91CF\u548C\u9650\u5236\u6570\nPageHelper.offsetPage(20, 10);  // \u504F\u79FB20\u6761\uFF0C\u9650\u523610\u6761\nList<User> users = userMapper.getAllUsers();\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"74-\u6027\u80FD\u76D1\u63A7\u63D2\u4EF6",children:"7.4 \u6027\u80FD\u76D1\u63A7\u63D2\u4EF6"}),"\n",(0,l.jsx)(n.p,{children:"\u901A\u8FC7\u63D2\u4EF6\u673A\u5236\u53EF\u4EE5\u5B9E\u73B0SQL\u6027\u80FD\u76D1\u63A7\u548C\u7EDF\u8BA1\u529F\u80FD\uFF0C\u5E2E\u52A9\u8BC6\u522B\u548C\u4F18\u5316\u6162\u67E5\u8BE2\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"sql-stats",label:"SQL\u6027\u80FD\u76D1\u63A7",children:[(0,l.jsx)(n.p,{children:"\u5B9E\u73B0\u4E00\u4E2A\u76D1\u63A7SQL\u6267\u884C\u65F6\u95F4\u7684\u63D2\u4EF6\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="SQL\u6027\u80FD\u76D1\u63A7\u63D2\u4EF6"',children:'@Intercepts({\n    @Signature(\n        type = Executor.class,\n        method = "update",\n        args = {MappedStatement.class, Object.class}\n    ),\n    @Signature(\n        type = Executor.class,\n        method = "query",\n        args = {MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class}\n    )\n})\npublic class SqlPerformancePlugin implements Interceptor {\n    \n    private static final Logger logger = LoggerFactory.getLogger(SqlPerformancePlugin.class);\n    private long slowSqlThreshold = 1000; // \u6162\u67E5\u8BE2\u9608\u503C\uFF0C\u5355\u4F4D\u6BEB\u79D2\n    \n    // \u8BB0\u5F55SQL\u6267\u884C\u7EDF\u8BA1\u4FE1\u606F\n    private final ConcurrentHashMap<String, SqlStats> sqlStatsMap = new ConcurrentHashMap<>();\n    \n    @Override\n    public Object intercept(Invocation invocation) throws Throwable {\n        MappedStatement ms = (MappedStatement) invocation.getArgs()[0];\n        Object parameter = invocation.getArgs()[1];\n        \n        String sqlId = ms.getId();\n        BoundSql boundSql = ms.getBoundSql(parameter);\n        String sql = boundSql.getSql();\n        \n        long startTime = System.currentTimeMillis();\n        Object result = null;\n        boolean success = false;\n        \n        try {\n            // \u6267\u884CSQL\n            result = invocation.proceed();\n            success = true;\n            return result;\n        } catch (Throwable e) {\n            throw e;\n        } finally {\n            long endTime = System.currentTimeMillis();\n            long costTime = endTime - startTime;\n            \n            // \u66F4\u65B0\u7EDF\u8BA1\u4FE1\u606F\n            updateStats(sqlId, costTime, success);\n            \n            // \u8BB0\u5F55\u6162\u67E5\u8BE2\n            if (costTime > slowSqlThreshold) {\n                logger.warn("Slow SQL detected: {} ms, SQL ID: {}, SQL: {}", costTime, sqlId, getSqlWithParams(boundSql));\n            }\n        }\n    }\n    \n    private void updateStats(String sqlId, long costTime, boolean success) {\n        SqlStats stats = sqlStatsMap.computeIfAbsent(sqlId, k -> new SqlStats());\n        \n        stats.incrementCount();\n        stats.addExecutionTime(costTime);\n        \n        if (costTime > stats.getMaxTime()) {\n            stats.setMaxTime(costTime);\n        }\n        \n        if (costTime < stats.getMinTime() || stats.getMinTime() == 0) {\n            stats.setMinTime(costTime);\n        }\n        \n        if (!success) {\n            stats.incrementErrorCount();\n        }\n    }\n    \n    private String getSqlWithParams(BoundSql boundSql) {\n        // \u83B7\u53D6SQL\u8BED\u53E5\u548C\u53C2\u6570\u7684\u5B9E\u73B0\n        // \u5B9E\u9645\u4EE3\u7801\u9700\u8981\u89E3\u6790\u53C2\u6570\u6620\u5C04\u548C\u53C2\u6570\u5BF9\u8C61\n        \n        return boundSql.getSql();\n    }\n    \n    /**\n     * \u83B7\u53D6SQL\u7EDF\u8BA1\u4FE1\u606F\n     */\n    public Map<String, SqlStats> getSqlStats() {\n        return new HashMap<>(sqlStatsMap);\n    }\n    \n    /**\n     * \u91CD\u7F6E\u7EDF\u8BA1\u4FE1\u606F\n     */\n    public void resetStats() {\n        sqlStatsMap.clear();\n    }\n    \n    @Override\n    public Object plugin(Object target) {\n        return Plugin.wrap(target, this);\n    }\n    \n    @Override\n    public void setProperties(Properties properties) {\n        String threshold = properties.getProperty("slowSqlThreshold");\n        if (threshold != null) {\n            this.slowSqlThreshold = Long.parseLong(threshold);\n        }\n    }\n    \n    /**\n     * SQL\u7EDF\u8BA1\u4FE1\u606F\u7C7B\n     */\n    public static class SqlStats {\n        private final AtomicLong count = new AtomicLong(0);\n        private final AtomicLong totalTime = new AtomicLong(0);\n        private final AtomicLong errorCount = new AtomicLong(0);\n        private volatile long minTime = 0;\n        private volatile long maxTime = 0;\n        \n        public void incrementCount() {\n            count.incrementAndGet();\n        }\n        \n        public void addExecutionTime(long time) {\n            totalTime.addAndGet(time);\n        }\n        \n        public void incrementErrorCount() {\n            errorCount.incrementAndGet();\n        }\n        \n        public long getCount() {\n            return count.get();\n        }\n        \n        public long getTotalTime() {\n            return totalTime.get();\n        }\n        \n        public long getErrorCount() {\n            return errorCount.get();\n        }\n        \n        public double getAverageTime() {\n            long countVal = count.get();\n            return countVal == 0 ? 0 : (double) totalTime.get() / countVal;\n        }\n        \n        public long getMinTime() {\n            return minTime;\n        }\n        \n        public void setMinTime(long minTime) {\n            this.minTime = minTime;\n        }\n        \n        public long getMaxTime() {\n            return maxTime;\n        }\n        \n        public void setMaxTime(long maxTime) {\n            this.maxTime = maxTime;\n        }\n    }\n}\n'})}),(0,l.jsx)(n.p,{children:"\u914D\u7F6E\u6027\u80FD\u76D1\u63A7\u63D2\u4EF6\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u63D2\u4EF6\u914D\u7F6E"',children:'<plugin interceptor="com.example.plugin.SqlPerformancePlugin">\n  <property name="slowSqlThreshold" value="1000"/>\n</plugin>\n'})}),(0,l.jsx)(n.p,{children:"\u4F7F\u7528\u76D1\u63A7\u63D2\u4EF6\u6536\u96C6\u7684\u7EDF\u8BA1\u4FE1\u606F\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u83B7\u53D6\u6027\u80FD\u7EDF\u8BA1\u6570\u636E"',children:'@RestController\n@RequestMapping("/admin/monitoring")\npublic class MonitoringController {\n    \n    @Autowired\n    private SqlPerformancePlugin sqlPerformancePlugin;\n    \n    @GetMapping("/sql-stats")\n    public Map<String, SqlStats> getSqlStats() {\n        return sqlPerformancePlugin.getSqlStats();\n    }\n    \n    @PostMapping("/reset-stats")\n    public ResponseEntity<Void> resetStats() {\n        sqlPerformancePlugin.resetStats();\n        return ResponseEntity.ok().build();\n    }\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"p6spy",label:"P6Spy\u96C6\u6210",children:[(0,l.jsx)(n.p,{children:"P6Spy\u662F\u4E00\u4E2ASQL\u76D1\u63A7\u6846\u67B6\uFF0C\u53EF\u4EE5\u4E0EMyBatis\u7ED3\u5408\u4F7F\u7528\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u6DFB\u52A0P6Spy\u4F9D\u8D56"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="pom.xml"',children:"<dependency>\n    <groupId>p6spy</groupId>\n    <artifactId>p6spy</artifactId>\n    <version>3.9.1</version>\n</dependency>\n"})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"\u914D\u7F6EP6Spy\u6570\u636E\u6E90"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u6570\u636E\u6E90\u914D\u7F6E"',children:'@Configuration\npublic class DataSourceConfig {\n    \n    @Bean\n    @Primary\n    public DataSource dataSource() {\n        // \u539F\u59CB\u6570\u636E\u6E90\n        HikariDataSource dataSource = new HikariDataSource();\n        dataSource.setJdbcUrl("jdbc:mysql://localhost:3306/mydb");\n        dataSource.setUsername("root");\n        dataSource.setPassword("password");\n        \n        // \u5305\u88C5\u4E3AP6Spy\u6570\u636E\u6E90\n        return new P6DataSource(dataSource);\n    }\n}\n'})}),(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:"\u914D\u7F6EP6Spy (spy.properties)"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-properties",metastring:'title="spy.properties"',children:"# \u4F7F\u7528\u81EA\u5B9A\u4E49\u7684\u65E5\u5FD7\u683C\u5F0F\nappender=com.p6spy.engine.spy.appender.Slf4JLogger\nlogMessageFormat=com.p6spy.engine.spy.appender.CustomLineFormat\ncustomLogMessageFormat=%(currentTime)|%(executionTime)|%(category)|%(sqlSingleLine)\n\n# \u8BBE\u7F6E\u6267\u884C\u65F6\u95F4\u8BB0\u5F55\u9608\u503C\uFF08\u6BEB\u79D2\uFF09\nexecutionThreshold=1000\n\n# \u8BBE\u7F6E\u65E5\u671F\u683C\u5F0F\ndateformat=yyyy-MM-dd HH:mm:ss\n\n# \u542F\u7528/\u7981\u7528\u6A21\u5757\nexcludecategories=info,debug,result,resultset\n\n# \u6392\u9664\u7279\u5B9ASQL\u8BED\u53E5\nexclude=SELECT NOW()\n"})}),(0,l.jsxs)(n.ol,{start:"4",children:["\n",(0,l.jsx)(n.li,{children:"\u81EA\u5B9A\u4E49P6Spy\u76D1\u542C\u5668"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u81EA\u5B9A\u4E49P6Spy\u4E8B\u4EF6\u76D1\u542C\u5668"',children:'public class CustomP6SpyListener extends JdbcEventListener {\n    \n    private static final Logger logger = LoggerFactory.getLogger(CustomP6SpyListener.class);\n    private ThreadLocal<Long> startTimeThreadLocal = new ThreadLocal<>();\n    \n    @Override\n    public void onBeforeAnyExecute(StatementInformation statementInformation) {\n        startTimeThreadLocal.set(System.currentTimeMillis());\n    }\n    \n    @Override\n    public void onAfterAnyExecute(StatementInformation statementInformation, long timeElapsedNanos, SQLException e) {\n        Long startTime = startTimeThreadLocal.get();\n        if (startTime != null) {\n            long executionTime = System.currentTimeMillis() - startTime;\n            startTimeThreadLocal.remove();\n            \n            if (executionTime > 1000) {  // \u5927\u4E8E1\u79D2\u7684\u67E5\u8BE2\n                String sql = statementInformation.getSqlWithValues();\n                logger.warn("Slow SQL detected: {} ms, SQL: {}", executionTime, sql);\n            }\n        }\n    }\n}\n'})}),(0,l.jsxs)(n.ol,{start:"5",children:["\n",(0,l.jsx)(n.li,{children:"\u6CE8\u518C\u81EA\u5B9A\u4E49\u76D1\u542C\u5668"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="P6Spy\u76D1\u542C\u5668\u6CE8\u518C"',children:"@PostConstruct\npublic void initP6Spy() {\n    P6SpyOptions.getActiveInstance().setJdbcEventListenerFactory(() -> new CustomP6SpyListener());\n}\n"})})]})]}),"\n",(0,l.jsx)(n.admonition,{title:"\u63D2\u4EF6\u5F00\u53D1\u6700\u4F73\u5B9E\u8DF5",type:"tip",children:(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4E13\u6CE8\u5355\u4E00\u529F\u80FD"}),"\uFF1A\u6BCF\u4E2A\u63D2\u4EF6\u53EA\u505A\u4E00\u4EF6\u4E8B\uFF0C\u4FBF\u4E8E\u7EF4\u62A4\u548C\u7EC4\u5408"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6027\u80FD\u8003\u8651"}),"\uFF1A\u63D2\u4EF6\u4F1A\u5F71\u54CDSQL\u6267\u884C\u6027\u80FD\uFF0C\u5E94\u5C3D\u91CF\u51CF\u5C11\u5F00\u9500"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5F02\u5E38\u5904\u7406"}),"\uFF1A\u786E\u4FDD\u5728\u5F02\u5E38\u60C5\u51B5\u4E0B\u6B63\u786E\u4F20\u9012\u5F02\u5E38\uFF0C\u4E0D\u5E72\u6270\u6B63\u5E38\u6D41\u7A0B"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7EBF\u7A0B\u5B89\u5168"}),"\uFF1A\u591A\u7EBF\u7A0B\u73AF\u5883\u4E0B\u63D2\u4EF6\u9700\u8981\u6CE8\u610F\u7EBF\u7A0B\u5B89\u5168"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u63D2\u4EF6\u987A\u5E8F"}),"\uFF1A\u591A\u4E2A\u63D2\u4EF6\u540C\u65F6\u4F7F\u7528\u65F6\uFF0C\u6CE8\u610F\u914D\u7F6E\u987A\u5E8F\uFF08\u5148\u914D\u7F6E\u7684\u540E\u6267\u884C\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u53EF\u914D\u7F6E\u6027"}),"\uFF1A\u63D0\u4F9B\u8DB3\u591F\u7684\u914D\u7F6E\u9009\u9879\uFF0C\u9002\u5E94\u4E0D\u540C\u573A\u666F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4F18\u5148\u4F7F\u7528\u73B0\u6210\u63D2\u4EF6"}),"\uFF1A\u5BF9\u4E8E\u5E38\u89C1\u529F\u80FD\uFF0C\u4F18\u5148\u4F7F\u7528\u6210\u719F\u7684\u793E\u533A\u63D2\u4EF6"]}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"8-mybatis\u5B9E\u6218\u5E94\u7528\u573A\u666F",children:"8. MyBatis\u5B9E\u6218\u5E94\u7528\u573A\u666F"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u5728\u5B9E\u9645\u9879\u76EE\u4E2D\u6709\u7740\u5E7F\u6CDB\u7684\u5E94\u7528\uFF0C\u4ECE\u7B80\u5355\u7684CRUD\u64CD\u4F5C\u5230\u590D\u6742\u7684\u591A\u8868\u67E5\u8BE2\u3001\u5B58\u50A8\u8FC7\u7A0B\u8C03\u7528\u3001\u6279\u91CF\u5904\u7406\u7B49\u573A\u666F\u90FD\u80FD\u5F88\u597D\u5730\u652F\u6301\u3002\u672C\u8282\u5C06\u5C55\u793AMyBatis\u5728\u5404\u79CD\u5B9E\u6218\u573A\u666F\u4E2D\u7684\u5E94\u7528\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"81-\u591A\u8868\u590D\u6742\u67E5\u8BE2",children:"8.1 \u591A\u8868\u590D\u6742\u67E5\u8BE2"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u5B9E\u9645\u4E1A\u52A1\u4E2D\uFF0C\u7ECF\u5E38\u9700\u8981\u8FDB\u884C\u591A\u8868\u5173\u8054\u67E5\u8BE2\uFF0CMyBatis\u63D0\u4F9B\u4E86\u591A\u79CD\u65B9\u5F0F\u5904\u7406\u590D\u6742\u67E5\u8BE2\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"joins",label:"\u591A\u8868JOIN\u67E5\u8BE2",children:[(0,l.jsx)(n.p,{children:"\u4F7F\u7528JOIN\u8FDB\u884C\u591A\u8868\u5173\u8054\u67E5\u8BE2\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u591A\u8868JOIN\u67E5\u8BE2"',children:'<select id="getOrderDetails" resultMap="OrderDetailMap">\n  SELECT \n    o.id AS order_id,\n    o.order_no,\n    o.create_time,\n    o.status,\n    o.total_amount,\n    u.id AS user_id,\n    u.username,\n    u.email,\n    p.id AS product_id,\n    p.name AS product_name,\n    p.price,\n    oi.quantity,\n    oi.subtotal\n  FROM orders o\n  LEFT JOIN user u ON o.user_id = u.id\n  LEFT JOIN order_item oi ON o.id = oi.order_id\n  LEFT JOIN product p ON oi.product_id = p.id\n  WHERE o.id = #{orderId}\n</select>\n\n<resultMap id="OrderDetailMap" type="OrderDetail">\n  <id property="orderId" column="order_id"/>\n  <result property="orderNo" column="order_no"/>\n  <result property="createTime" column="create_time"/>\n  <result property="status" column="status"/>\n  <result property="totalAmount" column="total_amount"/>\n  \n  <association property="user" javaType="User">\n    <id property="id" column="user_id"/>\n    <result property="username" column="username"/>\n    <result property="email" column="email"/>\n  </association>\n  \n  <collection property="items" ofType="OrderItemDetail">\n    <id property="productId" column="product_id"/>\n    <result property="productName" column="product_name"/>\n    <result property="price" column="price"/>\n    <result property="quantity" column="quantity"/>\n    <result property="subtotal" column="subtotal"/>\n  </collection>\n</resultMap>\n'})})]}),(0,l.jsxs)(a.A,{value:"sub-queries",label:"\u5B50\u67E5\u8BE2",children:[(0,l.jsx)(n.p,{children:"\u4F7F\u7528\u5B50\u67E5\u8BE2\u5904\u7406\u590D\u6742\u67E5\u8BE2\u9700\u6C42\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u5B50\u67E5\u8BE2\u793A\u4F8B"',children:'<select id="getHighValueCustomers" resultType="User">\n  SELECT u.* FROM user u\n  WHERE u.id IN (\n    SELECT DISTINCT o.user_id\n    FROM orders o\n    WHERE o.total_amount > #{minAmount}\n    AND o.create_time BETWEEN #{startDate} AND #{endDate}\n    GROUP BY o.user_id\n    HAVING SUM(o.total_amount) > #{totalSpending}\n  )\n  ORDER BY u.created_time DESC\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"nested",label:"\u5D4C\u5957\u67E5\u8BE2",children:[(0,l.jsx)(n.p,{children:"\u4F7F\u7528\u5D4C\u5957\u67E5\u8BE2\u5206\u6B65\u83B7\u53D6\u5173\u8054\u6570\u636E\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u5D4C\u5957\u67E5\u8BE2\u793A\u4F8B"',children:'\x3c!-- \u83B7\u53D6\u8BA2\u5355\u4E3B\u4FE1\u606F --\x3e\n<select id="getOrderById" resultMap="OrderMap">\n  SELECT id, order_no, user_id, status, total_amount, create_time\n  FROM orders\n  WHERE id = #{id}\n</select>\n\n<resultMap id="OrderMap" type="Order">\n  <id property="id" column="id"/>\n  <result property="orderNo" column="order_no"/>\n  <result property="status" column="status"/>\n  <result property="totalAmount" column="total_amount"/>\n  <result property="createTime" column="create_time"/>\n  \n  \x3c!-- \u5173\u8054\u7528\u6237\u4FE1\u606F --\x3e\n  <association property="user" column="user_id"\n               select="getUserById" fetchType="eager"/>\n  \n  \x3c!-- \u5173\u8054\u8BA2\u5355\u9879 --\x3e\n  <collection property="items" column="id"\n              select="getOrderItemsByOrderId" fetchType="lazy"/>\n</resultMap>\n\n\x3c!-- \u83B7\u53D6\u7528\u6237\u4FE1\u606F --\x3e\n<select id="getUserById" resultType="User">\n  SELECT id, username, email, phone\n  FROM user\n  WHERE id = #{userId}\n</select>\n\n\x3c!-- \u83B7\u53D6\u8BA2\u5355\u9879 --\x3e\n<select id="getOrderItemsByOrderId" resultMap="OrderItemMap">\n  SELECT \n    oi.id, oi.order_id, oi.product_id, \n    oi.quantity, oi.price, oi.subtotal,\n    p.name as product_name, p.image as product_image\n  FROM order_item oi\n  LEFT JOIN product p ON oi.product_id = p.id\n  WHERE oi.order_id = #{orderId}\n</select>\n\n<resultMap id="OrderItemMap" type="OrderItem">\n  <id property="id" column="id"/>\n  <result property="orderId" column="order_id"/>\n  <result property="productId" column="product_id"/>\n  <result property="quantity" column="quantity"/>\n  <result property="price" column="price"/>\n  <result property="subtotal" column="subtotal"/>\n  \n  <association property="product" javaType="Product">\n    <id property="id" column="product_id"/>\n    <result property="name" column="product_name"/>\n    <result property="image" column="product_image"/>\n  </association>\n</resultMap>\n'})})]}),(0,l.jsxs)(a.A,{value:"complex",label:"\u590D\u6742\u6761\u4EF6\u67E5\u8BE2",children:[(0,l.jsx)(n.p,{children:"\u5B9E\u73B0\u5305\u542B\u591A\u6761\u4EF6\u3001\u5206\u7EC4\u3001\u6392\u5E8F\u3001\u805A\u5408\u7B49\u590D\u6742\u67E5\u8BE2\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u590D\u6742\u6761\u4EF6\u67E5\u8BE2"',children:'<select id="searchProducts" resultType="ProductVO">\n  SELECT \n    p.id, \n    p.name, \n    p.price,\n    p.stock,\n    c.name as category_name,\n    b.name as brand_name,\n    ROUND(AVG(r.rating), 1) as avg_rating,\n    COUNT(r.id) as review_count\n  FROM product p\n  LEFT JOIN category c ON p.category_id = c.id\n  LEFT JOIN brand b ON p.brand_id = b.id\n  LEFT JOIN review r ON p.id = r.product_id\n  <where>\n    <if test="keyword != null and keyword != \'\'">\n      AND (\n        p.name LIKE CONCAT(\'%\', #{keyword}, \'%\')\n        OR p.description LIKE CONCAT(\'%\', #{keyword}, \'%\')\n      )\n    </if>\n    <if test="categoryIds != null and categoryIds.size() > 0">\n      AND p.category_id IN\n      <foreach collection="categoryIds" item="catId" open="(" separator="," close=")">\n        #{catId}\n      </foreach>\n    </if>\n    <if test="brandIds != null and brandIds.size() > 0">\n      AND p.brand_id IN\n      <foreach collection="brandIds" item="brandId" open="(" separator="," close=")">\n        #{brandId}\n      </foreach>\n    </if>\n    <if test="minPrice != null">\n      AND p.price >= #{minPrice}\n    </if>\n    <if test="maxPrice != null">\n      AND p.price <= #{maxPrice}\n    </if>\n    <if test="inStock != null and inStock == true">\n      AND p.stock > 0\n    </if>\n    <if test="minRating != null">\n      HAVING AVG(r.rating) >= #{minRating}\n    </if>\n  </where>\n  GROUP BY p.id, p.name, p.price, p.stock, c.name, b.name\n  <choose>\n    <when test="sortBy == \'price\' and sortDir == \'asc\'">\n      ORDER BY p.price ASC\n    </when>\n    <when test="sortBy == \'price\' and sortDir == \'desc\'">\n      ORDER BY p.price DESC\n    </when>\n    <when test="sortBy == \'rating\'">\n      ORDER BY avg_rating DESC, review_count DESC\n    </when>\n    <when test="sortBy == \'newest\'">\n      ORDER BY p.create_time DESC\n    </when>\n    <otherwise>\n      ORDER BY \n      CASE WHEN p.is_featured = 1 THEN 0 ELSE 1 END,\n      p.sort_order\n    </otherwise>\n  </choose>\n  LIMIT #{offset}, #{limit}\n</select>\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"82-\u5B58\u50A8\u8FC7\u7A0B\u8C03\u7528",children:"8.2 \u5B58\u50A8\u8FC7\u7A0B\u8C03\u7528"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u652F\u6301\u8C03\u7528\u6570\u636E\u5E93\u5B58\u50A8\u8FC7\u7A0B\uFF0C\u4E3A\u7279\u5B9A\u573A\u666F\u63D0\u4F9B\u9AD8\u6548\u7684\u5904\u7406\u80FD\u529B\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"basic",label:"\u57FA\u672C\u8C03\u7528",children:[(0,l.jsx)(n.p,{children:"\u8C03\u7528\u4E0D\u5E26\u53C2\u6570\u7684\u7B80\u5355\u5B58\u50A8\u8FC7\u7A0B\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u7B80\u5355\u5B58\u50A8\u8FC7\u7A0B\u8C03\u7528"',children:'<select id="callGetSystemDate" statementType="CALLABLE" resultType="Date">\n  {call get_system_date()}\n</select>\n'})}),(0,l.jsx)(n.p,{children:"\u8C03\u7528\u5E26\u8F93\u5165\u53C2\u6570\u7684\u5B58\u50A8\u8FC7\u7A0B\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u5E26\u8F93\u5165\u53C2\u6570\u7684\u5B58\u50A8\u8FC7\u7A0B"',children:'<select id="getUserOrders" parameterType="int" statementType="CALLABLE" resultMap="OrderMap">\n  {call get_user_orders(#{userId,jdbcType=INTEGER})}\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"in-out",label:"\u8F93\u5165\u8F93\u51FA\u53C2\u6570",children:[(0,l.jsx)(n.p,{children:"\u8C03\u7528\u5E26\u8F93\u5165\u8F93\u51FA\u53C2\u6570\u7684\u5B58\u50A8\u8FC7\u7A0B\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u5E26\u8F93\u5165\u8F93\u51FA\u53C2\u6570\u7684\u5B58\u50A8\u8FC7\u7A0B"',children:'<parameterMap id="processOrderParam" type="map">\n  <parameter property="orderId" mode="IN" jdbcType="INTEGER"/>\n  <parameter property="status" mode="IN" jdbcType="VARCHAR"/>\n  <parameter property="result" mode="OUT" jdbcType="INTEGER"/>\n  <parameter property="message" mode="OUT" jdbcType="VARCHAR"/>\n</parameterMap>\n\n<update id="processOrder" parameterMap="processOrderParam" statementType="CALLABLE">\n  {call process_order(?, ?, ?, ?)}\n</update>\n'})}),(0,l.jsx)(n.p,{children:"Java\u4EE3\u7801\u8C03\u7528\u5E26\u8F93\u51FA\u53C2\u6570\u7684\u5B58\u50A8\u8FC7\u7A0B\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u8C03\u7528\u5E26\u8F93\u51FA\u53C2\u6570\u7684\u5B58\u50A8\u8FC7\u7A0B"',children:'public String processOrder(Long orderId, String status) {\n    Map<String, Object> params = new HashMap<>();\n    params.put("orderId", orderId);\n    params.put("status", status);\n    params.put("result", null);  // \u8F93\u51FA\u53C2\u6570\n    params.put("message", null); // \u8F93\u51FA\u53C2\u6570\n    \n    orderMapper.processOrder(params);\n    \n    Integer result = (Integer) params.get("result");\n    String message = (String) params.get("message");\n    \n    if (result == 1) {\n        return "\u5904\u7406\u6210\u529F: " + message;\n    } else {\n        return "\u5904\u7406\u5931\u8D25: " + message;\n    }\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"cursor",label:"\u6E38\u6807\u7ED3\u679C",children:[(0,l.jsx)(n.p,{children:"\u5904\u7406\u8FD4\u56DE\u6E38\u6807\u7684\u5B58\u50A8\u8FC7\u7A0B\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u8FD4\u56DE\u6E38\u6807\u7684\u5B58\u50A8\u8FC7\u7A0B"',children:'<resultMap id="ProductMap" type="Product">\n  <id property="id" column="id"/>\n  <result property="name" column="name"/>\n  <result property="price" column="price"/>\n  <result property="stock" column="stock"/>\n</resultMap>\n\n<parameterMap id="categoryProductsParam" type="map">\n  <parameter property="categoryId" mode="IN" jdbcType="INTEGER"/>\n  <parameter property="productCursor" mode="OUT" jdbcType="CURSOR" resultMap="ProductMap"/>\n</parameterMap>\n\n<select id="getCategoryProducts" parameterMap="categoryProductsParam" statementType="CALLABLE">\n  {call get_category_products(?, ?)}\n</select>\n'})}),(0,l.jsx)(n.p,{children:"Java\u4EE3\u7801\u5904\u7406\u6E38\u6807\u7ED3\u679C\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5904\u7406\u6E38\u6807\u7ED3\u679C"',children:'public List<Product> getCategoryProducts(Integer categoryId) {\n    Map<String, Object> params = new HashMap<>();\n    params.put("categoryId", categoryId);\n    params.put("productCursor", null); // \u8F93\u51FA\u53C2\u6570-\u6E38\u6807\n    \n    orderMapper.getCategoryProducts(params);\n    \n    // \u5904\u7406\u6E38\u6807\u7ED3\u679C\n    List<Product> products = new ArrayList<>();\n    try (Cursor<Product> cursor = (Cursor<Product>) params.get("productCursor")) {\n        cursor.forEach(products::add);\n    }\n    \n    return products;\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"batch",label:"\u6279\u5904\u7406\u5B58\u50A8\u8FC7\u7A0B",children:[(0,l.jsx)(n.p,{children:"\u4F7F\u7528\u6279\u5904\u7406\u65B9\u5F0F\u8C03\u7528\u5B58\u50A8\u8FC7\u7A0B\u5904\u7406\u5927\u91CF\u6570\u636E\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u6279\u5904\u7406\u5B58\u50A8\u8FC7\u7A0B"',children:'@Transactional\npublic void batchProcessOrders(List<Order> orders) {\n    try (SqlSession sqlSession = sqlSessionFactory.openSession(ExecutorType.BATCH)) {\n        OrderMapper mapper = sqlSession.getMapper(OrderMapper.class);\n        \n        for (Order order : orders) {\n            Map<String, Object> params = new HashMap<>();\n            params.put("orderId", order.getId());\n            params.put("status", order.getStatus());\n            params.put("result", null);\n            params.put("message", null);\n            \n            mapper.processOrder(params);\n        }\n        \n        // \u63D0\u4EA4\u6279\u5904\u7406\n        sqlSession.flushStatements();\n        sqlSession.commit();\n    }\n}\n'})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"83-\u6279\u91CF\u6570\u636E\u5904\u7406",children:"8.3 \u6279\u91CF\u6570\u636E\u5904\u7406"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u5904\u7406\u5927\u91CF\u6570\u636E\u65F6\uFF0C\u6279\u91CF\u64CD\u4F5C\u53EF\u4EE5\u663E\u8457\u63D0\u9AD8\u6027\u80FD\uFF0C\u51CF\u5C11\u6570\u636E\u5E93\u4EA4\u4E92\u6B21\u6570\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"batch-insert",label:"\u6279\u91CF\u63D2\u5165",children:[(0,l.jsxs)(n.p,{children:["\u4F7F\u7528",(0,l.jsx)(n.code,{children:"foreach"}),"\u5B9E\u73B0\u6279\u91CF\u63D2\u5165\uFF1A"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u6279\u91CF\u63D2\u5165"',children:'<insert id="batchInsertUsers" parameterType="list">\n  INSERT INTO user (username, email, password, status, create_time)\n  VALUES\n  <foreach collection="list" item="user" separator=",">\n    (\n      #{user.username},\n      #{user.email},\n      #{user.password},\n      #{user.status},\n      #{user.createTime}\n    )\n  </foreach>\n</insert>\n'})})]}),(0,l.jsxs)(a.A,{value:"batch-update",label:"\u6279\u91CF\u66F4\u65B0",children:[(0,l.jsx)(n.p,{children:"\u6279\u91CF\u66F4\u65B0\u6709\u4E24\u79CD\u5E38\u89C1\u65B9\u5F0F\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4F7F\u7528",(0,l.jsx)(n.code,{children:"case when"}),"\u8BED\u6CD5\uFF1A"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u6279\u91CF\u66F4\u65B0-CASE WHEN\u65B9\u5F0F"',children:'<update id="batchUpdateUserStatus" parameterType="map">\n  UPDATE user\n  SET status = \n  <foreach collection="userStatusList" item="item" open="CASE id" close="END">\n    WHEN #{item.userId} THEN #{item.status}\n  </foreach>\n  WHERE id IN\n  <foreach collection="userStatusList" item="item" open="(" separator="," close=")">\n    #{item.userId}\n  </foreach>\n</update>\n'})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u591A\u8BED\u53E5\u6267\u884C\uFF1A"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u6279\u91CF\u66F4\u65B0-\u591A\u8BED\u53E5\u65B9\u5F0F"',children:'<update id="batchUpdateUsers" parameterType="list">\n  <foreach collection="list" item="user" separator=";">\n    UPDATE user\n    <set>\n      <if test="user.username != null">username = #{user.username},</if>\n      <if test="user.email != null">email = #{user.email},</if>\n      <if test="user.status != null">status = #{user.status},</if>\n      update_time = #{user.updateTime}\n    </set>\n    WHERE id = #{user.id}\n  </foreach>\n</update>\n'})}),(0,l.jsx)(n.p,{children:"\u6CE8\u610F\uFF1A\u591A\u8BED\u53E5\u6267\u884C\u9700\u8981\u5728JDBC\u8FDE\u63A5URL\u4E2D\u542F\u7528\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"jdbc:mysql://localhost:3306/mydb?allowMultiQueries=true\n"})})]}),(0,l.jsxs)(a.A,{value:"batch-executor",label:"\u6279\u5904\u7406\u6267\u884C\u5668",children:[(0,l.jsx)(n.p,{children:"\u4F7F\u7528MyBatis\u7684\u6279\u5904\u7406\u6267\u884C\u5668\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u6279\u5904\u7406\u6267\u884C\u5668"',children:"@Service\npublic class UserService {\n    \n    @Autowired\n    private SqlSessionFactory sqlSessionFactory;\n    \n    @Transactional\n    public void batchUpdateUsers(List<User> users) {\n        try (SqlSession sqlSession = sqlSessionFactory.openSession(ExecutorType.BATCH)) {\n            UserMapper mapper = sqlSession.getMapper(UserMapper.class);\n            \n            for (int i = 0; i < users.size(); i++) {\n                mapper.updateUser(users.get(i));\n                \n                // \u6BCF500\u6761\u63D0\u4EA4\u4E00\u6B21\uFF0C\u907F\u514D\u6279\u91CF\u8FC7\u5927\n                if (i > 0 && i % 500 == 0) {\n                    sqlSession.flushStatements();\n                }\n            }\n            \n            // \u6700\u540E\u63D0\u4EA4\u5269\u4F59\u7684\n            sqlSession.flushStatements();\n        }\n    }\n}\n"})})]}),(0,l.jsxs)(a.A,{value:"optimize",label:"\u6279\u91CF\u5904\u7406\u4F18\u5316",children:[(0,l.jsx)(n.p,{children:"\u6279\u91CF\u5904\u7406\u7684\u51E0\u79CD\u4F18\u5316\u7B56\u7565\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u5206\u6279\u5904\u7406\u5927\u91CF\u6570\u636E\uFF1A"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u5206\u6279\u5904\u7406"',children:"public void processMassiveData(List<User> allUsers) {\n    int batchSize = 1000;\n    int totalUsers = allUsers.size();\n    \n    for (int i = 0; i < totalUsers; i += batchSize) {\n        int endIndex = Math.min(i + batchSize, totalUsers);\n        List<User> userBatch = allUsers.subList(i, endIndex);\n        \n        // \u5904\u7406\u5F53\u524D\u6279\u6B21\n        batchUpdateUsers(userBatch);\n        \n        // \u6E05\u7406\u8D44\u6E90\uFF0C\u907F\u514D\u5185\u5B58\u6EA2\u51FA\n        System.gc();\n    }\n}\n"})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u591A\u7EBF\u7A0B\u5E76\u884C\u5904\u7406\uFF1A"}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u591A\u7EBF\u7A0B\u6279\u91CF\u5904\u7406"',children:"public void parallelProcessData(List<User> allUsers) {\n    int batchSize = 1000;\n    int totalUsers = allUsers.size();\n    int processors = Runtime.getRuntime().availableProcessors();\n    \n    // \u521B\u5EFA\u7EBF\u7A0B\u6C60\n    ExecutorService executorService = Executors.newFixedThreadPool(processors);\n    CountDownLatch latch = new CountDownLatch(totalUsers / batchSize + (totalUsers % batchSize > 0 ? 1 : 0));\n    \n    for (int i = 0; i < totalUsers; i += batchSize) {\n        int startIndex = i;\n        int endIndex = Math.min(i + batchSize, totalUsers);\n        \n        executorService.submit(() -> {\n            try {\n                List<User> userBatch = allUsers.subList(startIndex, endIndex);\n                batchUpdateUsers(userBatch);\n            } finally {\n                latch.countDown();\n            }\n        });\n    }\n    \n    try {\n        latch.await(); // \u7B49\u5F85\u6240\u6709\u6279\u6B21\u5904\u7406\u5B8C\u6210\n    } catch (InterruptedException e) {\n        Thread.currentThread().interrupt();\n    } finally {\n        executorService.shutdown();\n    }\n}\n"})})]})]}),"\n",(0,l.jsx)(n.h3,{id:"84-\u52A8\u6001\u6743\u9650sql",children:"8.4 \u52A8\u6001\u6743\u9650SQL"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u4F01\u4E1A\u5E94\u7528\u4E2D\uFF0C\u6570\u636E\u6743\u9650\u63A7\u5236\u662F\u4E00\u4E2A\u5E38\u89C1\u9700\u6C42\uFF0CMyBatis\u7684\u52A8\u6001SQL\u7279\u6027\u53EF\u4EE5\u5F88\u597D\u5730\u5B9E\u73B0\u57FA\u4E8E\u7528\u6237\u89D2\u8272\u548C\u6743\u9650\u7684\u52A8\u6001\u67E5\u8BE2\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"dept-permission",label:"\u90E8\u95E8\u6570\u636E\u6743\u9650",children:[(0,l.jsx)(n.p,{children:"\u5B9E\u73B0\u57FA\u4E8E\u7528\u6237\u90E8\u95E8\u7684\u6570\u636E\u6743\u9650\u63A7\u5236\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u90E8\u95E8\u6570\u636E\u6743\u9650SQL"',children:'<select id="getUserList" resultType="User">\n  SELECT u.* FROM sys_user u\n  LEFT JOIN sys_dept d ON u.dept_id = d.id\n  <where>\n    \x3c!-- \u6839\u636E\u7528\u6237\u6743\u9650\u7C7B\u578B\u52A8\u6001\u751F\u6210SQL --\x3e\n    <choose>\n      \x3c!-- \u5168\u90E8\u6570\u636E\u6743\u9650 --\x3e\n      <when test="user.dataScope == \'ALL\'">\n      </when>\n      \n      \x3c!-- \u672C\u90E8\u95E8\u53CA\u4EE5\u4E0B\u6570\u636E\u6743\u9650 --\x3e\n      <when test="user.dataScope == \'DEPT_AND_CHILD\'">\n        AND (d.id = #{user.deptId} OR d.parent_ids LIKE CONCAT(\'%,\', #{user.deptId}, \',%\'))\n      </when>\n      \n      \x3c!-- \u672C\u90E8\u95E8\u6570\u636E\u6743\u9650 --\x3e\n      <when test="user.dataScope == \'DEPT\'">\n        AND d.id = #{user.deptId}\n      </when>\n      \n      \x3c!-- \u4EC5\u4E2A\u4EBA\u6570\u636E\u6743\u9650 --\x3e\n      <when test="user.dataScope == \'SELF\'">\n        AND u.create_by = #{user.userId}\n      </when>\n      \n      \x3c!-- \u81EA\u5B9A\u4E49\u6570\u636E\u6743\u9650 --\x3e\n      <when test="user.dataScope == \'CUSTOM\' and user.deptIds != null and user.deptIds.size() > 0">\n        AND d.id IN\n        <foreach collection="user.deptIds" item="deptId" open="(" separator="," close=")">\n          #{deptId}\n        </foreach>\n      </when>\n      \n      \x3c!-- \u9ED8\u8BA4\u65E0\u6743\u9650 --\x3e\n      <otherwise>\n        AND 1=2\n      </otherwise>\n    </choose>\n    \n    \x3c!-- \u5176\u4ED6\u67E5\u8BE2\u6761\u4EF6 --\x3e\n    <if test="username != null and username != \'\'">\n      AND u.username LIKE CONCAT(\'%\', #{username}, \'%\')\n    </if>\n    <if test="status != null">\n      AND u.status = #{status}\n    </if>\n  </where>\n  ORDER BY u.create_time DESC\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"interceptor",label:"\u6743\u9650\u62E6\u622A\u5668",children:[(0,l.jsx)(n.p,{children:"\u4F7F\u7528MyBatis\u63D2\u4EF6\u5B9E\u73B0\u81EA\u52A8\u5316\u7684\u6743\u9650\u63A7\u5236\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u6743\u9650\u62E6\u622A\u5668"',children:'@Intercepts({\n    @Signature(\n        type = StatementHandler.class,\n        method = "prepare",\n        args = {Connection.class, Integer.class}\n    )\n})\npublic class DataPermissionInterceptor implements Interceptor {\n    \n    @Override\n    public Object intercept(Invocation invocation) throws Throwable {\n        StatementHandler handler = (StatementHandler) invocation.getTarget();\n        MetaObject metaObject = SystemMetaObject.forObject(handler);\n        \n        // \u83B7\u53D6SQL\u4FE1\u606F\n        MappedStatement mappedStatement = (MappedStatement) metaObject.getValue("delegate.mappedStatement");\n        String id = mappedStatement.getId();\n        \n        // \u5224\u65AD\u662F\u5426\u9700\u8981\u8FDB\u884C\u6570\u636E\u6743\u9650\u63A7\u5236\n        if (!isDataPermissionEnabled(id)) {\n            return invocation.proceed();\n        }\n        \n        // \u83B7\u53D6\u5F53\u524D\u7528\u6237\u6743\u9650\u4FE1\u606F\n        LoginUser loginUser = getLoginUser();\n        if (loginUser == null) {\n            return invocation.proceed();\n        }\n        \n        // \u83B7\u53D6\u539F\u59CBSQL\n        BoundSql boundSql = handler.getBoundSql();\n        String originalSql = boundSql.getSql();\n        \n        // \u6784\u5EFA\u6570\u636E\u6743\u9650SQL\n        String permissionSql = buildPermissionSql(originalSql, loginUser);\n        \n        // \u66FF\u6362\u539F\u59CBSQL\n        metaObject.setValue("delegate.boundSql.sql", permissionSql);\n        \n        return invocation.proceed();\n    }\n    \n    /**\n     * \u6784\u5EFA\u6570\u636E\u6743\u9650SQL\n     */\n    private String buildPermissionSql(String originalSql, LoginUser loginUser) {\n        // \u89E3\u6790SQL\uFF0C\u627E\u5230\u9002\u5408\u6CE8\u5165\u6743\u9650\u6761\u4EF6\u7684\u4F4D\u7F6E\n        \n        // \u6839\u636E\u7528\u6237\u6743\u9650\u7C7B\u578B\u6784\u5EFA\u4E0D\u540C\u7684\u6743\u9650\u6761\u4EF6\n        StringBuilder permissionBuilder = new StringBuilder();\n        \n        if ("ALL".equals(loginUser.getDataScope())) {\n            // \u5168\u90E8\u6570\u636E\u6743\u9650\uFF0C\u4E0D\u505A\u5904\u7406\n            return originalSql;\n        } else if ("DEPT_AND_CHILD".equals(loginUser.getDataScope())) {\n            // \u672C\u90E8\u95E8\u53CA\u4EE5\u4E0B\u6570\u636E\u6743\u9650\n            permissionBuilder.append(" AND (d.id = \'")\n                            .append(loginUser.getDeptId())\n                            .append("\' OR d.parent_ids LIKE \'%,")\n                            .append(loginUser.getDeptId())\n                            .append(",%\')");\n        } else if ("DEPT".equals(loginUser.getDataScope())) {\n            // \u672C\u90E8\u95E8\u6570\u636E\u6743\u9650\n            permissionBuilder.append(" AND d.id = \'")\n                            .append(loginUser.getDeptId())\n                            .append("\'");\n        } else if ("SELF".equals(loginUser.getDataScope())) {\n            // \u4EC5\u4E2A\u4EBA\u6570\u636E\u6743\u9650\n            permissionBuilder.append(" AND u.create_by = \'")\n                            .append(loginUser.getUserId())\n                            .append("\'");\n        } else if ("CUSTOM".equals(loginUser.getDataScope()) && \n                   loginUser.getDeptIds() != null && !loginUser.getDeptIds().isEmpty()) {\n            // \u81EA\u5B9A\u4E49\u6570\u636E\u6743\u9650\n            permissionBuilder.append(" AND d.id IN (");\n            for (int i = 0; i < loginUser.getDeptIds().size(); i++) {\n                if (i > 0) {\n                    permissionBuilder.append(",");\n                }\n                permissionBuilder.append("\'").append(loginUser.getDeptIds().get(i)).append("\'");\n            }\n            permissionBuilder.append(")");\n        } else {\n            // \u9ED8\u8BA4\u65E0\u6743\u9650\n            permissionBuilder.append(" AND 1=2");\n        }\n        \n        // \u6CE8\u5165\u6743\u9650\u6761\u4EF6\u5230SQL\n        int whereIndex = originalSql.toUpperCase().indexOf(" WHERE ");\n        if (whereIndex > 0) {\n            // SQL\u4E2D\u5DF2\u6709WHERE\u5B50\u53E5\n            return originalSql.substring(0, whereIndex + 7) + \n                   "(" + originalSql.substring(whereIndex + 7) + ")" + \n                   permissionBuilder.toString();\n        } else {\n            // SQL\u4E2D\u6CA1\u6709WHERE\u5B50\u53E5\n            int orderByIndex = originalSql.toUpperCase().indexOf(" ORDER BY ");\n            if (orderByIndex > 0) {\n                return originalSql.substring(0, orderByIndex) + \n                       " WHERE " + permissionBuilder.toString().substring(5) + \n                       originalSql.substring(orderByIndex);\n            } else {\n                return originalSql + " WHERE " + permissionBuilder.toString().substring(5);\n            }\n        }\n    }\n    \n    /**\n     * \u5224\u65AD\u662F\u5426\u542F\u7528\u6570\u636E\u6743\u9650\n     */\n    private boolean isDataPermissionEnabled(String statementId) {\n        // \u53EF\u4EE5\u901A\u8FC7\u6CE8\u89E3\u6216\u914D\u7F6E\u5224\u65AD\u662F\u5426\u9700\u8981\u6570\u636E\u6743\u9650\u63A7\u5236\n        return statementId.contains("getUserList") || \n               statementId.contains("getEmployeeList") ||\n               statementId.contains("getOrderList");\n    }\n    \n    /**\n     * \u83B7\u53D6\u5F53\u524D\u767B\u5F55\u7528\u6237\n     */\n    private LoginUser getLoginUser() {\n        // \u4ECESpring Security\u6216ThreadLocal\u4E2D\u83B7\u53D6\u5F53\u524D\u7528\u6237\u4FE1\u606F\n        return SecurityUtils.getLoginUser();\n    }\n    \n    @Override\n    public Object plugin(Object target) {\n        return Plugin.wrap(target, this);\n    }\n    \n    @Override\n    public void setProperties(Properties properties) {\n    }\n}\n'})})]}),(0,l.jsxs)(a.A,{value:"role-based",label:"\u89D2\u8272\u6743\u9650\u63A7\u5236",children:[(0,l.jsx)(n.p,{children:"\u57FA\u4E8E\u7528\u6237\u89D2\u8272\u7684\u52A8\u6001SQL\u6743\u9650\u63A7\u5236\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u57FA\u4E8E\u89D2\u8272\u7684\u52A8\u6001SQL"',children:'<select id="getMenuList" resultType="Menu">\n  SELECT\n    m.id, m.parent_id, m.name, m.path, m.component, m.visible, m.status\n  FROM\n    sys_menu m\n  LEFT JOIN\n    sys_role_menu rm ON m.id = rm.menu_id\n  <where>\n    \x3c!-- \u7BA1\u7406\u5458\u663E\u793A\u6240\u6709\u83DC\u5355 --\x3e\n    <if test="user.roles.contains(\'ROLE_ADMIN\')">\n      AND m.status = 0\n    </if>\n    \x3c!-- \u975E\u7BA1\u7406\u5458\u53EA\u663E\u793A\u6709\u6743\u9650\u7684\u83DC\u5355 --\x3e\n    <if test="!user.roles.contains(\'ROLE_ADMIN\')">\n      AND rm.role_id IN\n      <foreach collection="user.roleIds" item="roleId" open="(" separator="," close=")">\n        #{roleId}\n      </foreach>\n      AND m.status = 0\n    </if>\n  </where>\n  ORDER BY m.parent_id, m.order_num\n</select>\n'})})]}),(0,l.jsxs)(a.A,{value:"field-permission",label:"\u5B57\u6BB5\u7EA7\u6743\u9650",children:[(0,l.jsx)(n.p,{children:"\u5B9E\u73B0\u5B57\u6BB5\u7EA7\u7684\u6743\u9650\u63A7\u5236\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",metastring:'title="\u5B57\u6BB5\u7EA7\u6743\u9650\u63A7\u5236"',children:'<select id="getUserInfo" resultType="map">\n  SELECT \n    u.id,\n    u.username,\n    u.email,\n    \x3c!-- \u6839\u636E\u6743\u9650\u63A7\u5236\u654F\u611F\u5B57\u6BB5\u663E\u793A --\x3e\n    <if test="hasPermission(\'user:view:phone\')">\n      u.phone,\n    </if>\n    <if test="hasPermission(\'user:view:idcard\')">\n      u.id_card,\n    </if>\n    <if test="hasPermission(\'user:view:salary\')">\n      u.salary,\n    </if>\n    u.status,\n    u.create_time\n  FROM\n    sys_user u\n  WHERE\n    u.id = #{userId}\n</select>\n'})}),(0,l.jsx)(n.p,{children:"\u81EA\u5B9A\u4E49\u6743\u9650\u5224\u65AD\u65B9\u6CD5\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",metastring:'title="\u81EA\u5B9A\u4E49\u6743\u9650\u5224\u65AD\u65B9\u6CD5"',children:'@Component\npublic class SecurityFunction {\n    \n    @Autowired\n    private PermissionService permissionService;\n    \n    /**\n     * \u5224\u65AD\u5F53\u524D\u7528\u6237\u662F\u5426\u62E5\u6709\u6307\u5B9A\u6743\u9650\n     */\n    public boolean hasPermission(String permission) {\n        return permissionService.hasPermission(permission);\n    }\n}\n\n// \u6CE8\u518C\u81EA\u5B9A\u4E49\u65B9\u6CD5\u5230MyBatis\u914D\u7F6E\n@Configuration\npublic class MyBatisConfig {\n    \n    @Autowired\n    private SecurityFunction securityFunction;\n    \n    @PostConstruct\n    public void init() {\n        // \u5C06\u6743\u9650\u5224\u65AD\u65B9\u6CD5\u6CE8\u518C\u4E3AMyBatis\u7684\u65B9\u6CD5\u5F15\u7528\n        Configuration configuration = sqlSessionFactory.getConfiguration();\n        configuration.getTypeHandlerRegistry()\n            .setDefaultEnumTypeHandler(EnumOrdinalTypeHandler.class);\n        \n        // \u6CE8\u518C\u81EA\u5B9A\u4E49\u65B9\u6CD5\n        configuration.getLanguageRegistry()\n            .getDefaultDriverConfig()\n            .getLanguageDriver()\n            .createParameterHandler(null, null, null)\n            .setParameter(null, "hasPermission", \n                (key, val) -> securityFunction.hasPermission(String.valueOf(val)));\n    }\n}\n'})})]})]}),"\n",(0,l.jsx)(n.h2,{id:"9-\u603B\u7ED3\u4E0E\u6700\u4F73\u5B9E\u8DF5",children:"9. \u603B\u7ED3\u4E0E\u6700\u4F73\u5B9E\u8DF5"}),"\n",(0,l.jsx)(n.p,{children:"\u7ECF\u8FC7\u524D\u9762\u7AE0\u8282\u7684\u5B66\u4E60\uFF0C\u6211\u4EEC\u5DF2\u7ECF\u5168\u9762\u4E86\u89E3\u4E86MyBatis\u7684\u5404\u4E2A\u65B9\u9762\u3002\u5728\u5B9E\u9645\u9879\u76EE\u4E2D\uFF0C\u4E3A\u4E86\u66F4\u597D\u5730\u4F7F\u7528MyBatis\uFF0C\u9700\u8981\u9075\u5FAA\u4E00\u4E9B\u6700\u4F73\u5B9E\u8DF5\u548C\u89C4\u8303\uFF0C\u4EE5\u786E\u4FDD\u4EE3\u7801\u8D28\u91CF\u548C\u7CFB\u7EDF\u6027\u80FD\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"91-mybatis\u4F7F\u7528\u89C4\u8303",children:"9.1 MyBatis\u4F7F\u7528\u89C4\u8303"}),"\n",(0,l.jsx)(n.p,{children:"\u5236\u5B9A\u5408\u7406\u7684MyBatis\u4F7F\u7528\u89C4\u8303\u53EF\u4EE5\u63D0\u9AD8\u4EE3\u7801\u8D28\u91CF\u3001\u53EF\u7EF4\u62A4\u6027\u548C\u6027\u80FD\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"naming",label:"\u547D\u540D\u89C4\u8303",children:[(0,l.jsx)(n.p,{children:"\u826F\u597D\u7684\u547D\u540D\u89C4\u8303\u6709\u52A9\u4E8E\u63D0\u9AD8\u4EE3\u7801\u53EF\u8BFB\u6027\u548C\u53EF\u7EF4\u62A4\u6027\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u547D\u540D\u7A7A\u95F4(namespace)"}),"\uFF1A\u4F7F\u7528\u5B8C\u6574\u7684\u5305\u540D+\u7C7B\u540D\uFF0C\u4FDD\u6301\u4E0EMapper\u63A5\u53E3\u4E00\u81F4"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<mapper namespace="com.example.mapper.UserMapper">\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"SQL\u8BED\u53E5ID"}),"\uFF1A\u4F7F\u7528\u6709\u610F\u4E49\u7684\u540D\u79F0\uFF0C\u52A8\u8BCD+\u540D\u8BCD\u5F62\u5F0F\uFF0C\u4E0EMapper\u63A5\u53E3\u65B9\u6CD5\u540D\u4E00\u81F4"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<select id="getUserById">...</select>\n<insert id="insertUser">...</insert>\n<update id="updateUserStatus">...</update>\n<delete id="deleteUserBatch">...</delete>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u53C2\u6570\u540D\u79F0"}),"\uFF1A\u4F7F\u7528\u6709\u610F\u4E49\u7684\u53C2\u6570\u540D\uFF0C\u4E0E\u4E1A\u52A1\u5B9E\u4F53\u5C5E\u6027\u540D\u4FDD\u6301\u4E00\u81F4"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:"#{userId}, #{userName}, #{startTime}, #{endTime}\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u7ED3\u679C\u6620\u5C04ID"}),"\uFF1A\u4F7F\u7528Entity\u540D+Result/Map\u540E\u7F00"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<resultMap id="UserResultMap" type="User">...</resultMap>\n<resultMap id="OrderDetailMap" type="OrderDetail">...</resultMap>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"SQL\u7247\u6BB5ID"}),"\uFF1A\u4F7F\u7528\u529F\u80FD\u63CF\u8FF0+Fragment/Column/Where\u540E\u7F00"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<sql id="BaseColumnList">...</sql>\n<sql id="CommonWhereFragment">...</sql>\n'})}),"\n"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"code-structure",label:"\u4EE3\u7801\u7EC4\u7EC7",children:[(0,l.jsx)(n.p,{children:"\u826F\u597D\u7684\u4EE3\u7801\u7EC4\u7EC7\u7ED3\u6784\u6709\u52A9\u4E8E\u9879\u76EE\u7BA1\u7406\u548C\u56E2\u961F\u534F\u4F5C\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u63A5\u53E3\u4E0E\u5B9E\u73B0\u5206\u79BB"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Mapper\u63A5\u53E3\uFF1A",(0,l.jsx)(n.code,{children:"src/main/java/com/example/mapper/"})]}),"\n",(0,l.jsxs)(n.li,{children:["XML\u6620\u5C04\u6587\u4EF6\uFF1A",(0,l.jsx)(n.code,{children:"src/main/resources/mapper/"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u6A21\u5757\u5316\u7EC4\u7EC7"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6309\u4E1A\u52A1\u6A21\u5757\u7EC4\u7EC7Mapper\u6587\u4EF6"}),"\n",(0,l.jsx)(n.li,{children:"\u5927\u578B\u9879\u76EE\u53EF\u4EE5\u6309\u5B50\u6A21\u5757\u8FDB\u4E00\u6B65\u62C6\u5206"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u516C\u5171SQL\u63D0\u53D6"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u63D0\u53D6\u516C\u5171\u5217\u540D\u5217\u8868\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<sql id="Base_Column_List">id, name, email, phone, status, create_time, update_time</sql>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u63D0\u53D6\u516C\u5171WHERE\u6761\u4EF6\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<sql id="Common_Where_Clause">\n  <where>\n    <if test="status != null">AND status = #{status}</if>\n    <if test="startDate != null">AND create_time >= #{startDate}</if>\n  </where>\n</sql>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u5728SQL\u8BED\u53E5\u4E2D\u5F15\u7528\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<select id="selectUsers" resultMap="UserResultMap">\n  SELECT <include refid="Base_Column_List" />\n  FROM user\n  <include refid="Common_Where_Clause" />\n</select>\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5408\u7406\u62C6\u5206\u6587\u4EF6"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5355\u8868\u64CD\u4F5C\u4E00\u4E2AMapper\u6587\u4EF6"}),"\n",(0,l.jsx)(n.li,{children:"\u590D\u6742\u67E5\u8BE2\u53EF\u4EE5\u5355\u72EC\u521B\u5EFAMapper\u6587\u4EF6"}),"\n",(0,l.jsx)(n.li,{children:"\u907F\u514D\u8FC7\u5927\u7684XML\u6587\u4EF6\uFF0C\u5EFA\u8BAE\u4E0D\u8D85\u8FC71000\u884C"}),"\n"]}),"\n"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"sql-practices",label:"SQL\u7F16\u5199\u89C4\u8303",children:[(0,l.jsx)(n.p,{children:"\u4F18\u8D28\u7684SQL\u7F16\u5199\u89C4\u8303\u53EF\u4EE5\u63D0\u9AD8\u53EF\u8BFB\u6027\u548C\u6027\u80FD\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"SQL\u683C\u5F0F\u5316"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5173\u952E\u5B57\u5927\u5199\uFF08SELECT, FROM, WHERE, AND\u7B49\uFF09"}),"\n",(0,l.jsx)(n.li,{children:"\u5408\u7406\u4F7F\u7528\u7F29\u8FDB\u548C\u6362\u884C"}),"\n",(0,l.jsx)(n.li,{children:"\u5B50\u53E5\u5206\u884C\u7F16\u5199\uFF0C\u589E\u5F3A\u53EF\u8BFB\u6027"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<select id="getOrderSummary" resultType="OrderSummary">\n  SELECT\n    o.id,\n    o.order_no,\n    o.create_time,\n    SUM(oi.price * oi.quantity) AS total_amount,\n    COUNT(oi.id) AS item_count\n  FROM\n    orders o\n  LEFT JOIN\n    order_item oi ON o.id = oi.order_id\n  WHERE\n    o.status = #{status}\n    AND o.create_time BETWEEN #{startDate} AND #{endDate}\n  GROUP BY\n    o.id, o.order_no, o.create_time\n  ORDER BY\n    o.create_time DESC\n</select>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"SQL\u4F18\u5316\u539F\u5219"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u53EA\u67E5\u8BE2\u5FC5\u8981\u7684\u5217\uFF0C\u907F\u514D",(0,l.jsx)(n.code,{children:"SELECT *"})]}),"\n",(0,l.jsx)(n.li,{children:"\u5408\u7406\u4F7F\u7528\u7D22\u5F15"}),"\n",(0,l.jsx)(n.li,{children:"\u907F\u514D\u5728WHERE\u5B50\u53E5\u4E2D\u5BF9\u5B57\u6BB5\u8FDB\u884C\u51FD\u6570\u64CD\u4F5C"}),"\n",(0,l.jsx)(n.li,{children:"\u5408\u7406\u4F7F\u7528JOIN\uFF0C\u907F\u514D\u8FC7\u591A\u8868\u5173\u8054"}),"\n",(0,l.jsx)(n.li,{children:"\u9002\u5F53\u6DFB\u52A0SQL\u6CE8\u91CA\uFF0C\u8BF4\u660E\u590D\u6742\u67E5\u8BE2\u7684\u76EE\u7684"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u52A8\u6001SQL\u7F16\u5199"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4F18\u5148\u4F7F\u7528",(0,l.jsx)(n.code,{children:"<where>"}),"\u800C\u975E",(0,l.jsx)(n.code,{children:"WHERE 1=1"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u5408\u7406\u4F7F\u7528",(0,l.jsx)(n.code,{children:"<choose>"}),", ",(0,l.jsx)(n.code,{children:"<when>"}),", ",(0,l.jsx)(n.code,{children:"<otherwise>"}),"\u5904\u7406\u4E92\u65A5\u6761\u4EF6"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4F7F\u7528",(0,l.jsx)(n.code,{children:"<set>"}),"\u66FF\u4EE3\u624B\u52A8\u62FC\u63A5SET\u5B50\u53E5\u548C\u9017\u53F7"]}),"\n",(0,l.jsxs)(n.li,{children:["\u6279\u91CF\u64CD\u4F5C\u4F7F\u7528",(0,l.jsx)(n.code,{children:"<foreach>"}),"\u6807\u7B7E"]}),"\n"]}),"\n"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"security",label:"\u5B89\u5168\u89C4\u8303",children:[(0,l.jsx)(n.p,{children:"\u5B89\u5168\u89C4\u8303\u53EF\u4EE5\u9632\u6B62SQL\u6CE8\u5165\u548C\u6570\u636E\u6CC4\u9732\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u9632\u6B62SQL\u6CE8\u5165"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4F7F\u7528",(0,l.jsx)(n.code,{children:"#{}"}),"\u53C2\u6570\u7ED1\u5B9A\uFF0C\u907F\u514D",(0,l.jsx)(n.code,{children:"${}"}),"\u62FC\u63A5\uFF08\u9664\u975E\u5FC5\u8981\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:["\u5FC5\u987B\u4F7F\u7528",(0,l.jsx)(n.code,{children:"${}"}),"\u65F6\uFF08\u5982\u8868\u540D\u3001\u5217\u540D\uFF09\uFF0C\u8FDB\u884C\u4E25\u683C\u6821\u9A8C\u6216\u767D\u540D\u5355\u8FC7\u6EE4"]}),"\n",(0,l.jsx)(n.li,{children:"\u654F\u611F\u64CD\u4F5C\u6DFB\u52A0\u6743\u9650\u9A8C\u8BC1"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u5B89\u5168\u7684\u5199\u6CD5 --\x3e\n<select id="getUserByUsername" resultType="User">\n  SELECT * FROM user WHERE username = #{username}\n</select>\n\n\x3c!-- \u4E0D\u5B89\u5168\u7684\u5199\u6CD5\uFF0C\u53EF\u80FD\u5BFC\u81F4SQL\u6CE8\u5165 --\x3e\n<select id="getUserByUsername" resultType="User">\n  SELECT * FROM user WHERE username = \'${username}\'\n</select>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u654F\u611F\u6570\u636E\u5904\u7406"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u654F\u611F\u4FE1\u606F\uFF08\u5BC6\u7801\u3001\u8BC1\u4EF6\u53F7\u7B49\uFF09\u4E0D\u76F4\u63A5\u8FD4\u56DE"}),"\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u52A0\u5BC6/\u8131\u654F\u5904\u7406\u654F\u611F\u6570\u636E"}),"\n",(0,l.jsx)(n.li,{children:"\u65E5\u5FD7\u4E2D\u907F\u514D\u6253\u5370\u654F\u611F\u4FE1\u606F"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u6743\u9650\u63A7\u5236"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5B9E\u73B0\u6570\u636E\u884C\u7EA7\u6743\u9650"}),"\n",(0,l.jsx)(n.li,{children:"\u5B57\u6BB5\u7EA7\u522B\u6743\u9650\u63A7\u5236"}),"\n",(0,l.jsx)(n.li,{children:"\u64CD\u4F5C\u6743\u9650\u9A8C\u8BC1"}),"\n"]}),"\n"]}),"\n"]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"92-\u5E38\u89C1\u95EE\u9898\u89E3\u51B3\u65B9\u6848",children:"9.2 \u5E38\u89C1\u95EE\u9898\u89E3\u51B3\u65B9\u6848"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u4F7F\u7528MyBatis\u8FC7\u7A0B\u4E2D\uFF0C\u7ECF\u5E38\u4F1A\u9047\u5230\u4E00\u4E9B\u5E38\u89C1\u95EE\u9898\uFF0C\u8FD9\u91CC\u63D0\u4F9B\u4E00\u4E9B\u89E3\u51B3\u65B9\u6848\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"n-plus-1",label:"#1 \u95EE\u9898",children:[(0,l.jsx)(n.p,{children:"N+1\u67E5\u8BE2\u95EE\u9898\u662FMyBatis\u4E2D\u6700\u5E38\u89C1\u7684\u6027\u80FD\u95EE\u9898\u4E4B\u4E00\uFF1A"}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u95EE\u9898\u63CF\u8FF0"}),"\uFF1A\u5F53\u67E5\u8BE2\u4E00\u4E2A\u5217\u8868\u6570\u636E\uFF0C\u7136\u540E\u904D\u5386\u5217\u8868\u67E5\u8BE2\u5173\u8054\u6570\u636E\u65F6\uFF0C\u4F1A\u4EA7\u751FN+1\u6B21\u67E5\u8BE2\u3002"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"// \u4EA7\u751FN+1\u67E5\u8BE2\u7684\u4EE3\u7801\nList<User> users = userMapper.getAllUsers(); // 1\u6B21\u67E5\u8BE2\nfor (User user : users) {\n    List<Order> orders = orderMapper.getOrdersByUserId(user.getId()); // N\u6B21\u67E5\u8BE2\n    user.setOrders(orders);\n}\n"})}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),"\uFF1A"]}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4F7F\u7528\u5D4C\u5957\u7ED3\u679C\u6620\u5C04"}),"\uFF08\u63A8\u8350\uFF09"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<select id="getUsersWithOrders" resultMap="UserWithOrdersMap">\n  SELECT u.*, o.* FROM user u LEFT JOIN orders o ON u.id = o.user_id\n</select>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4F7F\u7528\u5EF6\u8FDF\u52A0\u8F7D"}),"\uFF08\u9002\u7528\u4E8E\u5173\u8054\u6570\u636E\u4F7F\u7528\u7387\u4F4E\u7684\u573A\u666F\uFF09"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u914D\u7F6E\u542F\u7528\u5EF6\u8FDF\u52A0\u8F7D --\x3e\n<setting name="lazyLoadingEnabled" value="true"/>\n<setting name="aggressiveLazyLoading" value="false"/>\n\n<resultMap id="userMap" type="User">\n  <id property="id" column="id"/>\n  <result property="name" column="name"/>\n  <collection property="orders" select="getOrdersByUserId" column="id" fetchType="lazy"/>\n</resultMap>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u4F7F\u7528\u6279\u91CF\u67E5\u8BE2"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"// \u5148\u83B7\u53D6\u7528\u6237\u5217\u8868\nList<User> users = userMapper.getAllUsers();\n\n// \u63D0\u53D6\u6240\u6709\u7528\u6237ID\nList<Long> userIds = users.stream().map(User::getId).collect(Collectors.toList());\n\n// \u6279\u91CF\u67E5\u8BE2\u8BA2\u5355\nMap<Long, List<Order>> orderMap = orderMapper.getOrdersByUserIds(userIds).stream()\n    .collect(Collectors.groupingBy(Order::getUserId));\n\n// \u8BBE\u7F6E\u8BA2\u5355\u6570\u636E\nusers.forEach(user -> user.setOrders(orderMap.getOrDefault(user.getId(), Collections.emptyList())));\n"})}),"\n"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"type-handling",label:"\u7C7B\u578B\u5904\u7406",children:[(0,l.jsx)(n.p,{children:"\u5904\u7406Java\u7C7B\u578B\u4E0E\u6570\u636E\u5E93\u7C7B\u578B\u7684\u6620\u5C04\u95EE\u9898\uFF1A"}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u95EE\u9898\u63CF\u8FF0"}),"\uFF1A\u7279\u6B8A\u7C7B\u578B\uFF08\u5982\u679A\u4E3E\u3001JSON\u3001\u65E5\u671F\u65F6\u95F4\u7B49\uFF09\u5728Java\u4E0E\u6570\u636E\u5E93\u4E4B\u95F4\u7684\u8F6C\u6362\u3002"]}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),"\uFF1A"]}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u679A\u4E3E\u7C7B\u578B\u5904\u7406"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'// \u679A\u4E3E\u5B9A\u4E49\npublic enum UserStatus {\n    ACTIVE(1, "\u6D3B\u8DC3"),\n    INACTIVE(0, "\u975E\u6D3B\u8DC3"),\n    LOCKED(-1, "\u9501\u5B9A");\n    \n    private final int value;\n    private final String desc;\n    \n    UserStatus(int value, String desc) {\n        this.value = value;\n        this.desc = desc;\n    }\n    \n    public int getValue() {\n        return value;\n    }\n    \n    public String getDesc() {\n        return desc;\n    }\n    \n    public static UserStatus fromValue(int value) {\n        for (UserStatus status : values()) {\n            if (status.value == value) {\n                return status;\n            }\n        }\n        throw new IllegalArgumentException("Invalid status value: " + value);\n    }\n}\n\n// \u81EA\u5B9A\u4E49TypeHandler\npublic class UserStatusTypeHandler extends BaseTypeHandler<UserStatus> {\n    @Override\n    public void setNonNullParameter(PreparedStatement ps, int i, UserStatus parameter, JdbcType jdbcType) throws SQLException {\n        ps.setInt(i, parameter.getValue());\n    }\n    \n    @Override\n    public UserStatus getNullableResult(ResultSet rs, String columnName) throws SQLException {\n        int value = rs.getInt(columnName);\n        return rs.wasNull() ? null : UserStatus.fromValue(value);\n    }\n    \n    @Override\n    public UserStatus getNullableResult(ResultSet rs, int columnIndex) throws SQLException {\n        int value = rs.getInt(columnIndex);\n        return rs.wasNull() ? null : UserStatus.fromValue(value);\n    }\n    \n    @Override\n    public UserStatus getNullableResult(CallableStatement cs, int columnIndex) throws SQLException {\n        int value = cs.getInt(columnIndex);\n        return cs.wasNull() ? null : UserStatus.fromValue(value);\n    }\n}\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"JSON\u7C7B\u578B\u5904\u7406"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'public class JsonTypeHandler<T> extends BaseTypeHandler<T> {\n    private final Class<T> clazz;\n    private static final ObjectMapper MAPPER = new ObjectMapper();\n    \n    public JsonTypeHandler(Class<T> clazz) {\n        this.clazz = clazz;\n    }\n    \n    @Override\n    public void setNonNullParameter(PreparedStatement ps, int i, T parameter, JdbcType jdbcType) throws SQLException {\n        try {\n            ps.setString(i, MAPPER.writeValueAsString(parameter));\n        } catch (JsonProcessingException e) {\n            throw new SQLException("Error converting object to JSON", e);\n        }\n    }\n    \n    @Override\n    public T getNullableResult(ResultSet rs, String columnName) throws SQLException {\n        return parseJSON(rs.getString(columnName));\n    }\n    \n    @Override\n    public T getNullableResult(ResultSet rs, int columnIndex) throws SQLException {\n        return parseJSON(rs.getString(columnIndex));\n    }\n    \n    @Override\n    public T getNullableResult(CallableStatement cs, int columnIndex) throws SQLException {\n        return parseJSON(cs.getString(columnIndex));\n    }\n    \n    private T parseJSON(String json) throws SQLException {\n        if (json == null) return null;\n        try {\n            return MAPPER.readValue(json, clazz);\n        } catch (IOException e) {\n            throw new SQLException("Error parsing JSON", e);\n        }\n    }\n}\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"LocalDateTime\u7C7B\u578B\u5904\u7406"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"public class LocalDateTimeTypeHandler extends BaseTypeHandler<LocalDateTime> {\n    @Override\n    public void setNonNullParameter(PreparedStatement ps, int i, LocalDateTime parameter, JdbcType jdbcType) throws SQLException {\n        ps.setTimestamp(i, Timestamp.valueOf(parameter));\n    }\n    \n    @Override\n    public LocalDateTime getNullableResult(ResultSet rs, String columnName) throws SQLException {\n        Timestamp timestamp = rs.getTimestamp(columnName);\n        return timestamp != null ? timestamp.toLocalDateTime() : null;\n    }\n    \n    @Override\n    public LocalDateTime getNullableResult(ResultSet rs, int columnIndex) throws SQLException {\n        Timestamp timestamp = rs.getTimestamp(columnIndex);\n        return timestamp != null ? timestamp.toLocalDateTime() : null;\n    }\n    \n    @Override\n    public LocalDateTime getNullableResult(CallableStatement cs, int columnIndex) throws SQLException {\n        Timestamp timestamp = cs.getTimestamp(columnIndex);\n        return timestamp != null ? timestamp.toLocalDateTime() : null;\n    }\n}\n"})}),"\n"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"performance",label:"\u6027\u80FD\u4F18\u5316",children:[(0,l.jsx)(n.p,{children:"\u89E3\u51B3MyBatis\u5E38\u89C1\u6027\u80FD\u95EE\u9898\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4E00\u7EA7\u7F13\u5B58\u95EE\u9898"}),"\uFF1A\u4E00\u7EA7\u7F13\u5B58\u53EF\u80FD\u5BFC\u81F4\u810F\u8BFB"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u8C03\u6574\u7F13\u5B58\u7EA7\u522B\u4E3ASTATEMENT","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<setting name="localCacheScope" value="STATEMENT"/>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u624B\u52A8\u6E05\u9664\u7F13\u5B58","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"sqlSession.clearCache();\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4E8C\u7EA7\u7F13\u5B58\u95EE\u9898"}),"\uFF1A\u4E8C\u7EA7\u7F13\u5B58\u53EF\u80FD\u5BFC\u81F4\u6570\u636E\u4E00\u81F4\u6027\u95EE\u9898"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u5408\u7406\u8BBE\u7F6E\u5237\u65B0\u95F4\u9694","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<cache flushInterval="60000"/>\n'})}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u9488\u5BF9\u5199\u64CD\u4F5C\u9891\u7E41\u7684\u8868\u7981\u7528\u4E8C\u7EA7\u7F13\u5B58"}),"\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u81EA\u5B9A\u4E49\u7F13\u5B58\uFF08\u5982Redis\uFF09\u66FF\u4EE3\u9ED8\u8BA4\u4E8C\u7EA7\u7F13\u5B58"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5927\u6570\u636E\u91CF\u5206\u9875\u95EE\u9898"}),"\uFF1A\u666E\u901ALIMIT\u5206\u9875\u5728\u6570\u636E\u91CF\u5927\u65F6\u6027\u80FD\u4E0B\u964D"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4F7F\u7528\u4E3B\u952E\u5206\u9875","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<select id="getPagedUsers">\n  SELECT * FROM user\n  WHERE id > #{lastId}\n  ORDER BY id ASC\n  LIMIT #{pageSize}\n</select>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4F7F\u7528\u8986\u76D6\u7D22\u5F15","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<select id="getPagedUserIds">\n  SELECT id FROM user\n  WHERE status = #{status}\n  ORDER BY create_time DESC\n  LIMIT #{offset}, #{limit}\n</select>\n\n<select id="getUsersByIds">\n  SELECT * FROM user\n  WHERE id IN\n  <foreach collection="ids" item="id" open="(" close=")" separator=",">\n    #{id}\n  </foreach>\n</select>\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u590D\u6742\u6761\u4EF6\u67E5\u8BE2\u4F18\u5316"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u5B50\u67E5\u8BE2\u4EE3\u66FF\u591A\u8868JOIN"}),"\n",(0,l.jsx)(n.li,{children:"\u5408\u7406\u4F7F\u7528\u7D22\u5F15"}),"\n",(0,l.jsx)(n.li,{children:"\u67E5\u8BE2\u6761\u4EF6\u63D0\u524D\u8FC7\u6EE4\uFF0C\u51CF\u5C11JOIN\u8868\u7684\u6570\u636E\u91CF"}),"\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528EXISTS\u4EE3\u66FFIN\u9002\u7528\u4E8E\u5916\u8868\u5C0F\u5185\u8868\u5927\u7684\u60C5\u51B5"}),"\n"]}),"\n"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"spring-integration",label:"Spring\u96C6\u6210\u95EE\u9898",children:[(0,l.jsx)(n.p,{children:"\u89E3\u51B3\u4E0ESpring\u96C6\u6210\u65F6\u7684\u5E38\u89C1\u95EE\u9898\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u4E8B\u52A1\u7BA1\u7406\u95EE\u9898"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u95EE\u9898"}),"\uFF1A\u4E8B\u52A1\u672A\u751F\u6548\u6216\u51FA\u73B0\u5F02\u5E38\u56DE\u6EDA\u4E0D\u5B8C\u6574"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u786E\u4FDD\u4F7F\u7528\u6B63\u786E\u7684\u4E8B\u52A1\u7BA1\u7406\u5668","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"@Bean\npublic PlatformTransactionManager transactionManager(DataSource dataSource) {\n    return new DataSourceTransactionManager(dataSource);\n}\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u8BBE\u7F6E\u6B63\u786E\u7684\u4E8B\u52A1\u4F20\u64AD\u7279\u6027","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"@Transactional(propagation = Propagation.REQUIRED, rollbackFor = Exception.class)\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u907F\u514D\u81EA\u8C03\u7528\u5BFC\u81F4\u4E8B\u52A1\u5931\u6548","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"// \u9519\u8BEF\u65B9\u5F0F - \u4E8B\u52A1\u4E0D\u4F1A\u751F\u6548\n@Service\npublic class UserService {\n    public void createUser() {\n        // \u4EE3\u7801...\n        this.updateRelatedData(); // \u8C03\u7528\u540C\u7C7B\u4E2D\u7684@Transactional\u65B9\u6CD5\n    }\n    \n    @Transactional\n    public void updateRelatedData() {\n        // \u4E8B\u52A1\u4E0D\u4F1A\u751F\u6548\n    }\n}\n\n// \u6B63\u786E\u65B9\u5F0F\n@Service\npublic class UserService {\n    @Autowired\n    private UserService self; // \u6CE8\u5165\u81EA\u8EAB\u4EE3\u7406\n    \n    public void createUser() {\n        // \u4EE3\u7801...\n        self.updateRelatedData(); // \u901A\u8FC7\u4EE3\u7406\u8C03\u7528\n    }\n    \n    @Transactional\n    public void updateRelatedData() {\n        // \u4E8B\u52A1\u751F\u6548\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u591A\u6570\u636E\u6E90\u914D\u7F6E\u95EE\u9898"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u89E3\u51B3\u65B9\u6848"}),"\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Configuration\npublic class DataSourceConfig {\n    \n    @Bean\n    @ConfigurationProperties("spring.datasource.primary")\n    public DataSourceProperties primaryDataSourceProperties() {\n        return new DataSourceProperties();\n    }\n    \n    @Bean\n    @ConfigurationProperties("spring.datasource.secondary")\n    public DataSourceProperties secondaryDataSourceProperties() {\n        return new DataSourceProperties();\n    }\n    \n    @Bean\n    @Primary\n    public DataSource primaryDataSource() {\n        return primaryDataSourceProperties().initializeDataSourceBuilder().build();\n    }\n    \n    @Bean\n    public DataSource secondaryDataSource() {\n        return secondaryDataSourceProperties().initializeDataSourceBuilder().build();\n    }\n    \n    @Bean\n    @Primary\n    public SqlSessionFactory primarySqlSessionFactory() throws Exception {\n        SqlSessionFactoryBean factoryBean = new SqlSessionFactoryBean();\n        factoryBean.setDataSource(primaryDataSource());\n        factoryBean.setMapperLocations(new PathMatchingResourcePatternResolver()\n            .getResources("classpath:mapper/primary/**/*.xml"));\n        return factoryBean.getObject();\n    }\n    \n    @Bean\n    public SqlSessionFactory secondarySqlSessionFactory() throws Exception {\n        SqlSessionFactoryBean factoryBean = new SqlSessionFactoryBean();\n        factoryBean.setDataSource(secondaryDataSource());\n        factoryBean.setMapperLocations(new PathMatchingResourcePatternResolver()\n            .getResources("classpath:mapper/secondary/**/*.xml"));\n        return factoryBean.getObject();\n    }\n    \n    @Bean\n    @Primary\n    public SqlSessionTemplate primarySqlSessionTemplate() throws Exception {\n        return new SqlSessionTemplate(primarySqlSessionFactory());\n    }\n    \n    @Bean\n    public SqlSessionTemplate secondarySqlSessionTemplate() throws Exception {\n        return new SqlSessionTemplate(secondarySqlSessionFactory());\n    }\n}\n\n@Configuration\n@MapperScan(basePackages = "com.example.mapper.primary", sqlSessionTemplateRef = "primarySqlSessionTemplate")\npublic class PrimaryDbConfig {\n}\n\n@Configuration\n@MapperScan(basePackages = "com.example.mapper.secondary", sqlSessionTemplateRef = "secondarySqlSessionTemplate")\npublic class SecondaryDbConfig {\n}\n'})}),"\n"]}),"\n"]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"93-mybatis\u6280\u672F\u6808\u6269\u5C55",children:"9.3 MyBatis\u6280\u672F\u6808\u6269\u5C55"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u751F\u6001\u7CFB\u7EDF\u975E\u5E38\u4E30\u5BCC\uFF0C\u6709\u591A\u79CD\u6269\u5C55\u548C\u5DE5\u5177\u53EF\u4EE5\u7B80\u5316\u5F00\u53D1\uFF0C\u63D0\u9AD8\u6548\u7387\u3002"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"mybatis-plus",label:"MyBatis-Plus",children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://baomidou.com/",children:"MyBatis-Plus"}),"\u662F\u57FA\u4E8EMyBatis\u7684\u589E\u5F3A\u5DE5\u5177\uFF0C\u7B80\u5316\u4E86\u5F00\u53D1\uFF0C\u63D0\u4F9B\u4E86\u66F4\u591A\u5F3A\u5927\u7684\u529F\u80FD\u3002"]}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4E3B\u8981\u7279\u6027"}),"\uFF1A"]}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u901A\u7528CRUD"}),"\uFF1A\u65E0\u9700\u7F16\u5199SQL\u5373\u53EF\u5B9E\u73B0\u57FA\u672CCRUD\u64CD\u4F5C"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"@Mapper\npublic interface UserMapper extends BaseMapper<User> {\n    // \u5DF2\u5185\u7F6E\u901A\u7528CRUD\u65B9\u6CD5\n    // insert, deleteById, updateById, selectById, selectList\u7B49\n}\n\n// \u4F7F\u7528\u793A\u4F8B\nuserMapper.insert(user);\nuserMapper.selectById(1);\nuserMapper.deleteById(1);\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u6761\u4EF6\u6784\u9020\u5668"}),"\uFF1A\u5F3A\u5927\u7684\u67E5\u8BE2\u6761\u4EF6\u6784\u9020"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'// \u67E5\u8BE2\u6761\u4EF6\u6784\u9020\nLambdaQueryWrapper<User> queryWrapper = new LambdaQueryWrapper<>();\nqueryWrapper\n    .eq(User::getStatus, 1)\n    .like(User::getUsername, "\u5F20")\n    .between(User::getCreateTime, startDate, endDate)\n    .orderByDesc(User::getCreateTime);\n\nList<User> users = userMapper.selectList(queryWrapper);\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5206\u9875\u63D2\u4EF6"}),"\uFF1A\u7B80\u5316\u5206\u9875\u67E5\u8BE2"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"// \u914D\u7F6E\n@Bean\npublic MybatisPlusInterceptor mybatisPlusInterceptor() {\n    MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();\n    interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL));\n    return interceptor;\n}\n\n// \u4F7F\u7528\nPage<User> page = new Page<>(1, 10);\nPage<User> resultPage = userMapper.selectPage(page, queryWrapper);\n\n// \u83B7\u53D6\u5206\u9875\u4FE1\u606F\nlong total = resultPage.getTotal();\nlong pages = resultPage.getPages();\nList<User> records = resultPage.getRecords();\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u81EA\u52A8\u586B\u5145"}),"\uFF1A\u81EA\u52A8\u5904\u7406\u521B\u5EFA\u65F6\u95F4\u3001\u66F4\u65B0\u65F6\u95F4\u7B49\u5B57\u6BB5"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@TableField(fill = FieldFill.INSERT)\nprivate LocalDateTime createTime;\n\n@TableField(fill = FieldFill.INSERT_UPDATE)\nprivate LocalDateTime updateTime;\n\n// \u5143\u6570\u636E\u5904\u7406\u5668\n@Component\npublic class MyMetaObjectHandler implements MetaObjectHandler {\n    @Override\n    public void insertFill(MetaObject metaObject) {\n        this.strictInsertFill(metaObject, "createTime", LocalDateTime.class, LocalDateTime.now());\n        this.strictInsertFill(metaObject, "updateTime", LocalDateTime.class, LocalDateTime.now());\n    }\n    \n    @Override\n    public void updateFill(MetaObject metaObject) {\n        this.strictUpdateFill(metaObject, "updateTime", LocalDateTime.class, LocalDateTime.now());\n    }\n}\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4EE3\u7801\u751F\u6210\u5668"}),"\uFF1A\u5FEB\u901F\u751F\u6210Entity\u3001Mapper\u3001Service\u3001Controller"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"// \u4EE3\u7801\u751F\u6210\u793A\u4F8B\nAutoGenerator generator = new AutoGenerator();\n\n// \u6570\u636E\u6E90\u914D\u7F6E\ngenerator.setDataSource(dataSourceConfig);\n\n// \u5168\u5C40\u914D\u7F6E\ngenerator.setGlobalConfig(globalConfig);\n\n// \u5305\u914D\u7F6E\ngenerator.setPackageInfo(packageConfig);\n\n// \u7B56\u7565\u914D\u7F6E\ngenerator.setStrategy(strategyConfig);\n\n// \u6267\u884C\ngenerator.execute();\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4E50\u89C2\u9501\u63D2\u4EF6"}),"\uFF1A\u652F\u6301\u4E50\u89C2\u9501\u673A\u5236"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"@Version\nprivate Integer version;\n\n// \u914D\u7F6E\u4E50\u89C2\u9501\u63D2\u4EF6\n@Bean\npublic MybatisPlusInterceptor mybatisPlusInterceptor() {\n    MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();\n    interceptor.addInnerInterceptor(new OptimisticLockerInnerInterceptor());\n    return interceptor;\n}\n"})}),"\n"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"tk-mapper",label:"\u901A\u7528Mapper",children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://github.com/abel533/Mapper",children:"\u901A\u7528Mapper"}),"\u662F\u4E00\u4E2AMyBatis\u7684\u589E\u5F3A\u5DE5\u5177\uFF0C\u63D0\u4F9B\u901A\u7528\u7684CRUD\u64CD\u4F5C\u3002"]}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4E3B\u8981\u7279\u6027"}),"\uFF1A"]}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u57FA\u7840CRUD"}),"\uFF1A\u63D0\u4F9B\u901A\u7528\u7684CRUD\u64CD\u4F5C"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"@Mapper\npublic interface UserMapper extends tk.mybatis.mapper.common.Mapper<User> {\n    // \u5DF2\u5185\u7F6E\u901A\u7528\u65B9\u6CD5\n}\n\n// \u4F7F\u7528\nuserMapper.insert(user);\nuserMapper.selectByPrimaryKey(1);\nuserMapper.updateByPrimaryKey(user);\nuserMapper.delete(user);\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u6761\u4EF6\u67E5\u8BE2"}),"\uFF1AExample\u67E5\u8BE2\u6761\u4EF6"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'Example example = new Example(User.class);\nexample.createCriteria()\n    .andEqualTo("status", 1)\n    .andLike("username", "%\u5F20%")\n    .andBetween("createTime", startDate, endDate);\n\nexample.orderBy("createTime").desc();\n\nList<User> users = userMapper.selectByExample(example);\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u7279\u6B8A\u64CD\u4F5C"}),"\uFF1A\u63D0\u4F9B\u591A\u79CD\u7279\u6B8A\u64CD\u4F5C\u63A5\u53E3"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'// \u7EC4\u5408\u63A5\u53E3\npublic interface UserMapper extends \n    Mapper<User>,               // \u57FA\u7840CRUD\n    IdsMapper<User>,            // \u6839\u636E\u4E3B\u952E\u6279\u91CF\u64CD\u4F5C\n    ConditionMapper<User>,      // \u6761\u4EF6\u67E5\u8BE2\n    ExampleMapper<User>,        // Example\u67E5\u8BE2\n    RowBoundsMapper<User> {     // \u5206\u9875\u67E5\u8BE2\n}\n\n// \u6279\u91CF\u64CD\u4F5C\nList<Integer> ids = Arrays.asList(1, 2, 3);\nuserMapper.deleteByIds(StringUtils.join(ids, ","));\n\n// \u6761\u4EF6\u67E5\u8BE2\nUser condition = new User();\ncondition.setStatus(1);\nList<User> users = userMapper.selectByCondition(condition);\n'})}),"\n"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"pagehelper",label:"PageHelper",children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://github.com/pagehelper/Mybatis-PageHelper",children:"PageHelper"}),"\u662FMyBatis\u7684\u5206\u9875\u63D2\u4EF6\uFF0C\u7B80\u5316\u5206\u9875\u67E5\u8BE2\u64CD\u4F5C\u3002"]}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4E3B\u8981\u7279\u6027"}),"\uFF1A"]}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u7B80\u5355\u914D\u7F6E"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Configuration\npublic class MybatisConfig {\n    @Bean\n    public PageInterceptor pageInterceptor() {\n        PageInterceptor pageInterceptor = new PageInterceptor();\n        Properties properties = new Properties();\n        properties.setProperty("reasonable", "true");\n        properties.setProperty("helperDialect", "mysql");\n        pageInterceptor.setProperties(properties);\n        return pageInterceptor;\n    }\n}\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5F00\u59CB\u5206\u9875"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"// \u65B9\u6CD5\u4E00\uFF1A\u4F7F\u7528PageHelper.startPage\nPageHelper.startPage(pageNum, pageSize);\nList<User> users = userMapper.selectUsers(condition);\n\n// \u65B9\u6CD5\u4E8C\uFF1A\u4F7F\u7528PageHelper.offsetPage\nPageHelper.offsetPage(offset, limit);\nList<User> users = userMapper.selectUsers(condition);\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u83B7\u53D6\u5206\u9875\u4FE1\u606F"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"// \u65B9\u6CD5\u4E00\uFF1A\u4F7F\u7528PageInfo\u5305\u88C5\nPageInfo<User> pageInfo = new PageInfo<>(users);\n\n// \u83B7\u53D6\u5206\u9875\u4FE1\u606F\nlong total = pageInfo.getTotal();\nint pages = pageInfo.getPages();\nList<User> list = pageInfo.getList();\n\n// \u65B9\u6CD5\u4E8C\uFF1A\u4F7F\u7528Page\u5BF9\u8C61\nPage<User> page = (Page<User>) users;\nlong total = page.getTotal();\nint pages = page.getPages();\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u6392\u5E8F"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'// \u5206\u9875\u5E76\u6392\u5E8F\nPageHelper.startPage(pageNum, pageSize, "create_time desc");\n\n// \u6216\u8005\nPageHelper.startPage(pageNum, pageSize);\nPageHelper.orderBy("create_time desc");\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5408\u7406\u5316"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"// \u8BBE\u7F6Ereasonable\u4E3Atrue\uFF0C\u5F53\u9875\u6570\u8D85\u8FC7\u603B\u9875\u6570\u65F6\uFF0C\u81EA\u52A8\u67E5\u8BE2\u6700\u540E\u4E00\u9875\nPageHelper.startPage(pageNum, pageSize, true);\n"})}),"\n"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"dynamic-datasource",label:"\u52A8\u6001\u6570\u636E\u6E90",children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://github.com/baomidou/dynamic-datasource-spring-boot-starter",children:"dynamic-datasource"}),"\u662F\u4E00\u4E2A\u652F\u6301\u591A\u6570\u636E\u6E90\u52A8\u6001\u5207\u6362\u7684\u7EC4\u4EF6\u3002"]}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4E3B\u8981\u7279\u6027"}),"\uFF1A"]}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u914D\u7F6E\u591A\u6570\u636E\u6E90"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yml",children:"spring:\n  datasource:\n    dynamic:\n      primary: master\n      strict: false\n      datasource:\n        master:\n          url: jdbc:mysql://localhost:3306/master\n          username: root\n          password: root\n          driver-class-name: com.mysql.cj.jdbc.Driver\n        slave_1:\n          url: jdbc:mysql://localhost:3307/slave\n          username: root\n          password: root\n          driver-class-name: com.mysql.cj.jdbc.Driver\n        slave_2:\n          url: jdbc:mysql://localhost:3308/slave\n          username: root\n          password: root\n          driver-class-name: com.mysql.cj.jdbc.Driver\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u4F7F\u7528\u6CE8\u89E3\u5207\u6362\u6570\u636E\u6E90"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@DS("slave_1")\n@Service\npublic class UserServiceImpl implements UserService {\n    @Autowired\n    private UserMapper userMapper;\n    \n    @Override\n    public List<User> listUsers() {\n        return userMapper.selectList(null);\n    }\n    \n    @DS("slave_2")\n    @Override\n    public User getUserById(Long id) {\n        return userMapper.selectById(id);\n    }\n    \n    @DS("master")\n    @Override\n    public boolean updateUser(User user) {\n        return userMapper.updateById(user) > 0;\n    }\n}\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5206\u7EC4\u7B56\u7565"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'// \u914D\u7F6E\n@Bean\npublic DynamicDataSourceProvider dynamicDataSourceProvider() {\n    Map<String, DataSourceProperty> dataSourcePropertiesMap = new HashMap<>();\n    // \u4E3B\u5E93\n    dataSourcePropertiesMap.put("master", masterDataSourceProperty());\n    // \u4ECE\u5E93\u7EC4\n    dataSourcePropertiesMap.put("slave_1", slave1DataSourceProperty());\n    dataSourcePropertiesMap.put("slave_2", slave2DataSourceProperty());\n    return new YmlDynamicDataSourceProvider(dataSourcePropertiesMap);\n}\n\n@Bean\npublic DynamicDataSourceStrategy loadBalanceDynamicDataSourceStrategy() {\n    return new LoadBalanceDynamicDataSourceStrategy();\n}\n\n// \u4F7F\u7528\n@DS("slave") // slave\u7EC4\uFF0C\u4F1A\u81EA\u52A8\u5728slave_1\u548Cslave_2\u4E2D\u8D1F\u8F7D\u5747\u8861\npublic List<User> listUsers() {\n    return userMapper.selectList(null);\n}\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u4E8B\u52A1\u652F\u6301"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@DS("master")\n@Transactional\npublic void createUser(User user) {\n    userMapper.insert(user);\n    // \u5728\u540C\u4E00\u4E2A\u4E8B\u52A1\u4E2D\uFF0C\u6570\u636E\u6E90\u4FDD\u6301\u4E00\u81F4\n    userRoleMapper.insertUserRole(user.getId(), roleId);\n}\n'})}),"\n"]}),"\n"]})]})]}),"\n",(0,l.jsx)(n.admonition,{title:"MyBatis\u6700\u4F73\u5B9E\u8DF5\u603B\u7ED3",type:"tip",children:(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u547D\u540D\u89C4\u8303"}),"\uFF1A\u4FDD\u6301SQL ID\u4E0EMapper\u63A5\u53E3\u65B9\u6CD5\u540D\u4E00\u81F4\uFF0C\u4F7F\u7528\u6709\u610F\u4E49\u7684\u547D\u540D"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6A21\u5757\u5316"}),"\uFF1A\u6309\u4E1A\u52A1\u6A21\u5757\u7EC4\u7EC7\u4EE3\u7801\uFF0C\u63D0\u53D6\u516C\u5171SQL\u7247\u6BB5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"SQL\u4F18\u5316"}),"\uFF1A\u53EA\u67E5\u8BE2\u5FC5\u8981\u7684\u5217\uFF0C\u5408\u7406\u4F7F\u7528\u7D22\u5F15\uFF0C\u907F\u514D\u8FC7\u591AJOIN"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5B89\u5168\u9632\u62A4"}),"\uFF1A\u4F7F\u7528\u53C2\u6570\u7ED1\u5B9A\u9632\u6B62SQL\u6CE8\u5165\uFF0C\u654F\u611F\u6570\u636E\u52A0\u5BC6\u5904\u7406"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6027\u80FD\u4F18\u5316"}),"\uFF1A\u5408\u7406\u4F7F\u7528\u7F13\u5B58\uFF0C\u907F\u514DN+1\u67E5\u8BE2\uFF0C\u6279\u91CF\u5904\u7406\u5927\u91CF\u6570\u636E"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u96C6\u6210\u6269\u5C55"}),"\uFF1A\u6839\u636E\u9700\u6C42\u9009\u62E9\u5408\u9002\u7684MyBatis\u6269\u5C55\u5DE5\u5177"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u9762\u5411\u63A5\u53E3"}),"\uFF1A\u9075\u5FAA\u9762\u5411\u63A5\u53E3\u7F16\u7A0B\u539F\u5219\uFF0C\u964D\u4F4E\u4EE3\u7801\u8026\u5408\u5EA6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5355\u4E00\u804C\u8D23"}),"\uFF1A\u6BCF\u4E2AMapper\u63A5\u53E3\u4E13\u6CE8\u4E8E\u5355\u4E00\u5B9E\u4F53\u7684\u64CD\u4F5C"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6D4B\u8BD5\u8986\u76D6"}),"\uFF1A\u7F16\u5199\u5355\u5143\u6D4B\u8BD5\uFF0C\u786E\u4FDDSQL\u8BED\u53E5\u6B63\u786E"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7248\u672C\u7BA1\u7406"}),"\uFF1A\u4F7F\u7528\u6570\u636E\u5E93\u7248\u672C\u7BA1\u7406\u5DE5\u5177\uFF08\u5982Flyway\u3001Liquibase\uFF09\u7BA1\u7406\u6570\u636E\u5E93\u53D8\u66F4"]}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"10-\u9762\u8BD5\u9898\u7CBE\u9009",children:"10. \u9762\u8BD5\u9898\u7CBE\u9009"}),"\n",(0,l.jsx)(n.p,{children:"MyBatis\u662FJava\u9762\u8BD5\u4E2D\u5E38\u89C1\u7684\u6301\u4E45\u5C42\u6846\u67B6\u8BDD\u9898\uFF0C\u4EE5\u4E0B\u662F\u4E00\u4E9B\u5E38\u89C1\u9762\u8BD5\u9898\u53CA\u5176\u8BE6\u7EC6\u89E3\u7B54\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"101-\u57FA\u7840\u539F\u7406\u9762\u8BD5\u9898",children:"10.1 \u57FA\u7840\u539F\u7406\u9762\u8BD5\u9898"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"principle",label:"\u6838\u5FC3\u539F\u7406",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u7684\u6838\u5FC3\u5DE5\u4F5C\u539F\u7406\u662F\u4EC0\u4E48\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: MyBatis\u7684\u6838\u5FC3\u5DE5\u4F5C\u539F\u7406\u53EF\u4EE5\u6982\u62EC\u4E3A\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u914D\u7F6E\u89E3\u6790\u9636\u6BB5"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u8BFB\u53D6XML\u914D\u7F6E\u6587\u4EF6\u6216\u6CE8\u89E3\u914D\u7F6E"}),"\n",(0,l.jsx)(n.li,{children:"\u521B\u5EFAConfiguration\u5BF9\u8C61\uFF0C\u5305\u542B\u6240\u6709\u914D\u7F6E\u4FE1\u606F"}),"\n",(0,l.jsx)(n.li,{children:"\u89E3\u6790\u6620\u5C04\u6587\u4EF6\uFF0C\u521B\u5EFAMappedStatement\u5BF9\u8C61"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u521D\u59CB\u5316\u9636\u6BB5"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u521B\u5EFASqlSessionFactory\u5B9E\u4F8B"}),"\n",(0,l.jsx)(n.li,{children:"\u6CE8\u518C\u6240\u6709Mapper\u63A5\u53E3"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u6267\u884C\u9636\u6BB5"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u901A\u8FC7SqlSessionFactory\u521B\u5EFASqlSession"}),"\n",(0,l.jsx)(n.li,{children:"\u901A\u8FC7\u52A8\u6001\u4EE3\u7406\u521B\u5EFAMapper\u63A5\u53E3\u5B9E\u73B0\u7C7B"}),"\n",(0,l.jsx)(n.li,{children:"\u6267\u884CSQL\uFF0C\u6620\u5C04\u7ED3\u679C"}),"\n"]}),"\n"]}),"\n"]}),(0,l.jsx)(n.p,{children:"\u8FD9\u4E2A\u8FC7\u7A0B\u7684\u6838\u5FC3\u662F\u901A\u8FC7\u52A8\u6001\u4EE3\u7406\u5C06\u63A5\u53E3\u65B9\u6CD5\u8C03\u7528\u8F6C\u6362\u4E3ASQL\u6267\u884C\uFF0C\u518D\u5C06\u7ED3\u679C\u96C6\u6620\u5C04\u4E3AJava\u5BF9\u8C61\u3002"}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: SqlSession\u548CSqlSessionFactory\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F"})}),(0,l.jsx)(n.p,{children:"A:"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"SqlSessionFactory"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u8D1F\u8D23\u521B\u5EFASqlSession\u5B9E\u4F8B"}),"\n",(0,l.jsx)(n.li,{children:"\u7EBF\u7A0B\u5B89\u5168\uFF0C\u53EF\u4F9B\u591A\u4E2A\u7EBF\u7A0B\u5171\u4EAB"}),"\n",(0,l.jsx)(n.li,{children:"\u5168\u5C40\u552F\u4E00\uFF0C\u5E94\u7528\u7EA7\u751F\u547D\u5468\u671F"}),"\n",(0,l.jsx)(n.li,{children:"\u7C7B\u4F3C\u4E8E\u6570\u636E\u5E93\u8FDE\u63A5\u6C60\uFF0C\u662F\u4E00\u4E2A\u91CD\u91CF\u7EA7\u5BF9\u8C61"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"SqlSession"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u63D0\u4F9B\u6267\u884CSQL\u7684API"}),"\n",(0,l.jsx)(n.li,{children:"\u975E\u7EBF\u7A0B\u5B89\u5168\uFF0C\u4E0D\u80FD\u5728\u591A\u7EBF\u7A0B\u4E2D\u5171\u4EAB"}),"\n",(0,l.jsx)(n.li,{children:"\u4F1A\u8BDD\u7EA7\u751F\u547D\u5468\u671F\uFF0C\u4F7F\u7528\u540E\u9700\u5173\u95ED"}),"\n",(0,l.jsx)(n.li,{children:"\u7C7B\u4F3C\u4E8E\u6570\u636E\u5E93\u8FDE\u63A5\uFF0C\u662F\u4E00\u4E2A\u8F7B\u91CF\u7EA7\u5BF9\u8C61"}),"\n"]}),"\n"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u7684\u5DE5\u4F5C\u6D41\u7A0B\u662F\u600E\u6837\u7684\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: MyBatis\u5B8C\u6574\u5DE5\u4F5C\u6D41\u7A0B\u5982\u4E0B\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u8BFB\u53D6\u914D\u7F6E\u6587\u4EF6\uFF0C\u521B\u5EFASqlSessionFactoryBuilder\u5BF9\u8C61"}),"\n",(0,l.jsx)(n.li,{children:"SqlSessionFactoryBuilder\u89E3\u6790\u914D\u7F6E\uFF0C\u521B\u5EFASqlSessionFactory\u5BF9\u8C61"}),"\n",(0,l.jsx)(n.li,{children:"\u4ECESqlSessionFactory\u83B7\u53D6SqlSession"}),"\n",(0,l.jsx)(n.li,{children:"\u901A\u8FC7SqlSession\u83B7\u53D6Mapper\u63A5\u53E3\u7684\u4EE3\u7406\u5B9E\u73B0"}),"\n",(0,l.jsx)(n.li,{children:"\u901A\u8FC7Mapper\u63A5\u53E3\u8C03\u7528\u65B9\u6CD5"}),"\n",(0,l.jsx)(n.li,{children:"SqlSession\u5C06\u8BF7\u6C42\u8F6C\u53D1\u7ED9Executor"}),"\n",(0,l.jsx)(n.li,{children:"Executor\u901A\u8FC7StatementHandler\u521B\u5EFAStatement\u5BF9\u8C61"}),"\n",(0,l.jsx)(n.li,{children:"ParameterHandler\u8BBE\u7F6E\u53C2\u6570"}),"\n",(0,l.jsx)(n.li,{children:"Statement\u6267\u884CSQL"}),"\n",(0,l.jsx)(n.li,{children:"ResultSetHandler\u5904\u7406\u7ED3\u679C\u96C6\uFF0C\u8F6C\u6362\u4E3AJava\u5BF9\u8C61"}),"\n",(0,l.jsx)(n.li,{children:"\u8FD4\u56DE\u7ED3\u679C\uFF0C\u5173\u95EDSqlSession"}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"comparison",label:"\u6846\u67B6\u5BF9\u6BD4",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u4E0EHibernate\u6709\u4EC0\u4E48\u533A\u522B\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: MyBatis\u548CHibernate\u7684\u4E3B\u8981\u533A\u522B\uFF1A"}),(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u7279\u6027"}),(0,l.jsx)(n.th,{children:"MyBatis"}),(0,l.jsx)(n.th,{children:"Hibernate"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u7EA7\u522B"})}),(0,l.jsx)(n.td,{children:"\u534A\u81EA\u52A8ORM"}),(0,l.jsx)(n.td,{children:"\u5168\u81EA\u52A8ORM"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"SQL\u63A7\u5236"})}),(0,l.jsx)(n.td,{children:"\u624B\u5199SQL\uFF0C\u7075\u6D3B\u6027\u9AD8"}),(0,l.jsx)(n.td,{children:"\u81EA\u52A8\u751F\u6210SQL\uFF0C\u63A7\u5236\u6027\u4F4E"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u5B66\u4E60\u66F2\u7EBF"})}),(0,l.jsx)(n.td,{children:"\u8F83\u4F4E\uFF0C\u63A5\u8FD1JDBC"}),(0,l.jsx)(n.td,{children:"\u8F83\u9AD8\uFF0C\u6982\u5FF5\u8F83\u591A"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u6027\u80FD"})}),(0,l.jsx)(n.td,{children:"\u8F83\u9AD8\uFF08\u76F4\u63A5SQL\u4F18\u5316\uFF09"}),(0,l.jsx)(n.td,{children:"\u8F83\u4F4E\uFF08\u81EA\u52A8\u751F\u6210SQL\uFF09"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u5F00\u53D1\u6548\u7387"})}),(0,l.jsx)(n.td,{children:"\u9700\u7F16\u5199SQL\uFF0C\u6548\u7387\u8F83\u4F4E"}),(0,l.jsx)(n.td,{children:"\u65E0\u9700\u7F16\u5199SQL\uFF0C\u6548\u7387\u9AD8"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u9002\u7528\u573A\u666F"})}),(0,l.jsx)(n.td,{children:"\u590D\u6742SQL\u67E5\u8BE2\uFF0C\u6027\u80FD\u8981\u6C42\u9AD8"}),(0,l.jsx)(n.td,{children:"\u7B80\u5355CRUD\uFF0C\u5FEB\u901F\u5F00\u53D1"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u6620\u5C04\u590D\u6742\u5EA6"})}),(0,l.jsx)(n.td,{children:"\u7075\u6D3B\uFF0C\u652F\u6301\u590D\u6742\u6620\u5C04"}),(0,l.jsx)(n.td,{children:"\u5B8C\u5584\uFF0C\u652F\u6301\u590D\u6742\u5173\u8054"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"\u7F13\u5B58\u673A\u5236"})}),(0,l.jsx)(n.td,{children:"\u7B80\u5355\u7684\u4E00\u4E8C\u7EA7\u7F13\u5B58"}),(0,l.jsx)(n.td,{children:"\u590D\u6742\u7684\u591A\u7EA7\u7F13\u5B58"})]})]})]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u76F8\u6BD4JDBC\u6709\u4EC0\u4E48\u4F18\u52BF\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: MyBatis\u76F8\u6BD4JDBC\u7684\u4F18\u52BF\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4EE3\u7801\u91CF\u51CF\u5C11"}),"\uFF1A\u65E0\u9700\u624B\u52A8\u7BA1\u7406\u8FDE\u63A5\u3001\u8BBE\u7F6E\u53C2\u6570\u3001\u5904\u7406\u7ED3\u679C\u96C6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u53C2\u6570\u6620\u5C04"}),"\uFF1A\u81EA\u52A8\u5C06Java\u5BF9\u8C61\u6620\u5C04\u4E3ASQL\u53C2\u6570"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7ED3\u679C\u6620\u5C04"}),"\uFF1A\u81EA\u52A8\u5C06\u7ED3\u679C\u96C6\u6620\u5C04\u4E3AJava\u5BF9\u8C61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"SQL\u5206\u79BB"}),"\uFF1ASQL\u4E0E\u4EE3\u7801\u5206\u79BB\uFF0C\u4FBF\u4E8E\u7EF4\u62A4"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u52A8\u6001SQL"}),"\uFF1A\u652F\u6301\u6761\u4EF6\u5224\u65AD\u3001\u5FAA\u73AF\u7B49\u52A8\u6001SQL\u6784\u5EFA"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7F13\u5B58\u673A\u5236"}),"\uFF1A\u5185\u7F6E\u4E00\u4E8C\u7EA7\u7F13\u5B58\uFF0C\u63D0\u5347\u6027\u80FD"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4E8B\u52A1\u7BA1\u7406"}),"\uFF1A\u7B80\u5316\u4E8B\u52A1\u7BA1\u7406"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u63D2\u4EF6\u673A\u5236"}),"\uFF1A\u652F\u6301\u63D2\u4EF6\u6269\u5C55"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u65E5\u5FD7\u652F\u6301"}),"\uFF1A\u8BE6\u7EC6\u7684\u65E5\u5FD7\u8BB0\u5F55"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u548CJPA\u5404\u6709\u4EC0\u4E48\u4F18\u7F3A\u70B9\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: MyBatis\u548CJPA\u7684\u4F18\u7F3A\u70B9\uFF1A"}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"MyBatis\u4F18\u70B9"}),"\uFF1A"]}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"SQL\u63A7\u5236\u7075\u6D3B\uFF0C\u53EF\u4F18\u5316\u590D\u6742\u67E5\u8BE2"}),"\n",(0,l.jsx)(n.li,{children:"\u5B66\u4E60\u6210\u672C\u4F4E\uFF0C\u63A5\u8FD1\u539F\u751FSQL"}),"\n",(0,l.jsx)(n.li,{children:"\u6027\u80FD\u53EF\u63A7\uFF0C\u4FBF\u4E8E\u8C03\u4F18"}),"\n",(0,l.jsx)(n.li,{children:"\u9002\u5408\u590D\u6742\u4E1A\u52A1\u548C\u62A5\u8868\u67E5\u8BE2"}),"\n"]}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"MyBatis\u7F3A\u70B9"}),"\uFF1A"]}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u9700\u8981\u624B\u5199SQL\uFF0C\u5F00\u53D1\u6548\u7387\u4F4E"}),"\n",(0,l.jsx)(n.li,{children:"\u6570\u636E\u5E93\u79FB\u690D\u6027\u8F83\u5DEE"}),"\n",(0,l.jsx)(n.li,{children:"\u5BF9\u8C61\u5173\u7CFB\u6620\u5C04\u529F\u80FD\u7B80\u5355"}),"\n"]}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"JPA\u4F18\u70B9"}),"\uFF1A"]}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u65E0\u9700\u7F16\u5199SQL\uFF0C\u63D0\u9AD8\u5F00\u53D1\u6548\u7387"}),"\n",(0,l.jsx)(n.li,{children:"\u6570\u636E\u5E93\u65E0\u5173\u6027\u597D\uFF0C\u4FBF\u4E8E\u5207\u6362\u6570\u636E\u5E93"}),"\n",(0,l.jsx)(n.li,{children:"\u4E30\u5BCC\u7684\u5BF9\u8C61\u5173\u7CFB\u6620\u5C04"}),"\n",(0,l.jsx)(n.li,{children:"\u6807\u51C6\u5316\u89C4\u8303\uFF0C\u5B66\u4E60\u4E00\u6B21\u53EF\u7528\u591A\u5904"}),"\n"]}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"JPA\u7F3A\u70B9"}),"\uFF1A"]}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u590D\u6742\u67E5\u8BE2\u96BE\u4EE5\u4F18\u5316"}),"\n",(0,l.jsx)(n.li,{children:"\u5B66\u4E60\u66F2\u7EBF\u9661\u5CED"}),"\n",(0,l.jsx)(n.li,{children:"\u5BF9\u6570\u636E\u5E93\u7279\u6027\u652F\u6301\u6709\u9650"}),"\n",(0,l.jsx)(n.li,{children:"\u6027\u80FD\u8C03\u4F18\u56F0\u96BE"}),"\n"]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"102-\u914D\u7F6E\u4E0E\u6620\u5C04\u9762\u8BD5\u9898",children:"10.2 \u914D\u7F6E\u4E0E\u6620\u5C04\u9762\u8BD5\u9898"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"config",label:"\u914D\u7F6E\u95EE\u9898",children:[(0,l.jsx)(n.p,{children:(0,l.jsxs)(n.strong,{children:["Q: #","\u548C$","\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F"]})}),(0,l.jsx)(n.p,{children:"A: \u8FD9\u4E24\u79CD\u7B26\u53F7\u7528\u4E8ESQL\u53C2\u6570\u4F20\u9012\uFF0C\u4F46\u6709\u672C\u8D28\u533A\u522B\uFF1A"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"#"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u53C2\u6570\u5360\u4F4D\u7B26\uFF0C\u4F7F\u7528PreparedStatement"}),"\n",(0,l.jsx)(n.li,{children:"\u4F1A\u81EA\u52A8\u6DFB\u52A0\u5F15\u53F7\uFF08\u5982\u5B57\u7B26\u4E32\uFF09"}),"\n",(0,l.jsx)(n.li,{children:"\u9632\u6B62SQL\u6CE8\u5165"}),"\n",(0,l.jsx)(n.li,{children:"\u652F\u6301\u7C7B\u578B\u8F6C\u6362"}),"\n",(0,l.jsxs)(n.li,{children:["\u4F8B\uFF1A",(0,l.jsx)(n.code,{children:"WHERE id = #{id}"})," \u2192 ",(0,l.jsx)(n.code,{children:"WHERE id = ?"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"$"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6587\u672C\u66FF\u6362\uFF0C\u76F4\u63A5\u62FC\u63A5SQL"}),"\n",(0,l.jsx)(n.li,{children:"\u4E0D\u4F1A\u6DFB\u52A0\u5F15\u53F7"}),"\n",(0,l.jsx)(n.li,{children:"\u5B58\u5728SQL\u6CE8\u5165\u98CE\u9669"}),"\n",(0,l.jsx)(n.li,{children:"\u4E0D\u652F\u6301\u7C7B\u578B\u8F6C\u6362"}),"\n",(0,l.jsxs)(n.li,{children:["\u4F8B\uFF1A",(0,l.jsx)(n.code,{children:"ORDER BY ${column}"})," \u2192 ",(0,l.jsx)(n.code,{children:"ORDER BY column_name"})]}),"\n"]}),"\n"]}),"\n"]}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4F55\u65F6\u4F7F\u7528$"}),"\uFF1A"]}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u52A8\u6001\u8868\u540D\uFF1A",(0,l.jsx)(n.code,{children:"FROM ${tableName}"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u52A8\u6001\u5217\u540D\uFF1A",(0,l.jsx)(n.code,{children:"ORDER BY ${columnName}"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u52A8\u6001SQL\u7247\u6BB5\uFF1A",(0,l.jsx)(n.code,{children:"${sqlFragment}"})]}),"\n"]}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5B89\u5168\u5EFA\u8BAE"}),"\uFF1A\u5C3D\u91CF\u4F7F\u7528#","\uFF0C\u5FC5\u987B\u4F7F\u7528$","\u65F6\u8981\u8FDB\u884C\u4E25\u683C\u53C2\u6570\u6821\u9A8C\u3002"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u7684\u914D\u7F6E\u6587\u4EF6\u4E2D\u6709\u54EA\u4E9B\u91CD\u8981\u5143\u7D20\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: MyBatis\u914D\u7F6E\u6587\u4EF6\u7684\u91CD\u8981\u5143\u7D20\uFF08\u6309\u987A\u5E8F\uFF09\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"properties"}),"\uFF1A\u5B9A\u4E49\u53EF\u91CD\u7528\u7684\u5C5E\u6027"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"settings"}),"\uFF1A\u4FEE\u6539MyBatis\u884C\u4E3A\u7684\u91CD\u8981\u8BBE\u7F6E"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"typeAliases"}),"\uFF1A\u4E3AJava\u7C7B\u578B\u8BBE\u7F6E\u522B\u540D"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"typeHandlers"}),"\uFF1A\u7C7B\u578B\u5904\u7406\u5668\uFF0C\u5904\u7406Java\u4E0EJDBC\u7C7B\u578B\u8F6C\u6362"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"objectFactory"}),"\uFF1A\u521B\u5EFA\u7ED3\u679C\u5BF9\u8C61\u7684\u5DE5\u5382"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"plugins"}),"\uFF1A\u63D2\u4EF6\u62E6\u622A\u5668"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"environments"}),"\uFF1A\u73AF\u5883\u914D\u7F6E","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"environment\uFF1A\u7279\u5B9A\u73AF\u5883\u914D\u7F6E"}),"\n",(0,l.jsx)(n.li,{children:"transactionManager\uFF1A\u4E8B\u52A1\u7BA1\u7406\u5668\u914D\u7F6E"}),"\n",(0,l.jsx)(n.li,{children:"dataSource\uFF1A\u6570\u636E\u6E90\u914D\u7F6E"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"databaseIdProvider"}),"\uFF1A\u6570\u636E\u5E93\u5382\u5546\u6807\u8BC6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"mappers"}),"\uFF1A\u6620\u5C04\u5668\u914D\u7F6E"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u7684\u5E38\u7528\u8BBE\u7F6E\u6709\u54EA\u4E9B\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: \u5E38\u7528\u8BBE\u7F6E\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"cacheEnabled"}),"\uFF1A\u662F\u5426\u542F\u7528\u7F13\u5B58\uFF08\u9ED8\u8BA4true\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"lazyLoadingEnabled"}),"\uFF1A\u662F\u5426\u5F00\u542F\u5EF6\u8FDF\u52A0\u8F7D\uFF08\u9ED8\u8BA4false\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"aggressiveLazyLoading"}),"\uFF1A\u662F\u5426\u79EF\u6781\u52A0\u8F7D\u5BF9\u8C61\u6240\u6709\u5C5E\u6027\uFF08\u9ED8\u8BA4false\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"multipleResultSetsEnabled"}),"\uFF1A\u662F\u5426\u5141\u8BB8\u5355\u4E00\u8BED\u53E5\u8FD4\u56DE\u591A\u7ED3\u679C\u96C6\uFF08\u9ED8\u8BA4true\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"useColumnLabel"}),"\uFF1A\u4F7F\u7528\u5217\u6807\u7B7E\u4EE3\u66FF\u5217\u540D\uFF08\u9ED8\u8BA4true\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"useGeneratedKeys"}),"\uFF1A\u4F7F\u7528JDBC\u7684getGeneratedKeys\uFF08\u9ED8\u8BA4false\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"autoMappingBehavior"}),"\uFF1A\u81EA\u52A8\u6620\u5C04\u7ED3\u679C\u96C6\uFF08NONE/PARTIAL/FULL\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"defaultExecutorType"}),"\uFF1A\u9ED8\u8BA4\u6267\u884C\u5668\u7C7B\u578B\uFF08SIMPLE/REUSE/BATCH\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"mapUnderscoreToCamelCase"}),"\uFF1A\u4E0B\u5212\u7EBF\u8F6C\u9A7C\u5CF0\u547D\u540D\uFF08\u9ED8\u8BA4false\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"localCacheScope"}),"\uFF1A\u672C\u5730\u7F13\u5B58\u4F5C\u7528\u57DF\uFF08SESSION/STATEMENT\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"jdbcTypeForNull"}),"\uFF1ANULL\u503C\u7684JDBC\u7C7B\u578B\uFF08\u9ED8\u8BA4OTHER\uFF09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"logImpl"}),"\uFF1A\u6307\u5B9A\u65E5\u5FD7\u5B9E\u73B0\uFF08SLF4J/LOG4J/LOG4J2\u7B49\uFF09"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"mapping",label:"\u6620\u5C04\u95EE\u9898",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u6620\u5C04\u6587\u4EF6\u4E2D\u5E38\u7528\u5143\u7D20\u6709\u54EA\u4E9B\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: \u5E38\u7528\u5143\u7D20\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"resultMap"}),"\uFF1A\u7ED3\u679C\u6620\u5C04\u5B9A\u4E49"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"sql"}),"\uFF1A\u53EF\u91CD\u7528\u7684SQL\u7247\u6BB5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"insert"}),"\uFF1A\u63D2\u5165\u8BED\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"update"}),"\uFF1A\u66F4\u65B0\u8BED\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"delete"}),"\uFF1A\u5220\u9664\u8BED\u53E5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"select"}),"\uFF1A\u67E5\u8BE2\u8BED\u53E5"]}),"\n"]}),(0,l.jsx)(n.p,{children:"\u6BCF\u79CD\u5143\u7D20\u90FD\u6709\u4E30\u5BCC\u7684\u5C5E\u6027\u548C\u5B50\u5143\u7D20\uFF0C\u4F8B\u5982\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<select id="getUser" \n        parameterType="int" \n        resultType="User" \n        flushCache="false" \n        useCache="true" \n        timeout="10000" \n        fetchSize="256" \n        statementType="PREPARED">\n  SELECT * FROM user WHERE id = #{id}\n</select>\n'})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: resultType\u548CresultMap\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: \u4E24\u8005\u90FD\u7528\u4E8E\u6307\u5B9A\u67E5\u8BE2\u7ED3\u679C\u7684\u6620\u5C04\u65B9\u5F0F\uFF1A"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"resultType"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6307\u5B9A\u8FD4\u56DE\u7ED3\u679C\u7684Java\u7C7B\u578B"}),"\n",(0,l.jsx)(n.li,{children:"\u8981\u6C42\u5217\u540D\u548C\u5C5E\u6027\u540D\u76F8\u540C\uFF08\u6216\u914D\u7F6E\u9A7C\u5CF0\u6620\u5C04\uFF09"}),"\n",(0,l.jsx)(n.li,{children:"\u7B80\u5355\u6620\u5C04\u7684\u9996\u9009\u65B9\u5F0F"}),"\n",(0,l.jsxs)(n.li,{children:["\u4F8B\uFF1A",(0,l.jsx)(n.code,{children:'resultType="com.example.User"'})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"resultMap"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u81EA\u5B9A\u4E49\u7ED3\u679C\u6620\u5C04\u89C4\u5219"}),"\n",(0,l.jsx)(n.li,{children:"\u5904\u7406\u5217\u540D\u548C\u5C5E\u6027\u540D\u4E0D\u5339\u914D\u60C5\u51B5"}),"\n",(0,l.jsx)(n.li,{children:"\u5904\u7406\u590D\u6742\u5173\u8054\u5173\u7CFB\uFF08\u4E00\u5BF9\u4E00\u3001\u4E00\u5BF9\u591A\u7B49\uFF09"}),"\n",(0,l.jsxs)(n.li,{children:["\u4F8B\uFF1A",(0,l.jsx)(n.code,{children:'resultMap="UserResultMap"'})]}),"\n"]}),"\n"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u5982\u4F55\u5B9E\u73B0\u4E00\u5BF9\u4E00\u548C\u4E00\u5BF9\u591A\u5173\u8054\u67E5\u8BE2\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: MyBatis\u63D0\u4F9B\u4E86\u4E24\u79CD\u5B9E\u73B0\u5173\u8054\u67E5\u8BE2\u7684\u65B9\u5F0F\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5D4C\u5957\u7ED3\u679C\u6620\u5C04"}),"\uFF08\u5355\u6B21\u67E5\u8BE2\uFF09\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u4E00\u5BF9\u4E00\u5173\u8054 --\x3e\n<resultMap id="userWithProfile" type="User">\n  <id property="id" column="id"/>\n  <result property="username" column="username"/>\n  <association property="profile" javaType="Profile">\n    <id property="id" column="profile_id"/>\n    <result property="address" column="address"/>\n  </association>\n</resultMap>\n\n\x3c!-- \u4E00\u5BF9\u591A\u5173\u8054 --\x3e\n<resultMap id="userWithOrders" type="User">\n  <id property="id" column="id"/>\n  <result property="username" column="username"/>\n  <collection property="orders" ofType="Order">\n    <id property="id" column="order_id"/>\n    <result property="amount" column="amount"/>\n  </collection>\n</resultMap>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5D4C\u5957\u67E5\u8BE2"}),"\uFF08\u591A\u6B21\u67E5\u8BE2\uFF09\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u4E00\u5BF9\u4E00\u5173\u8054 --\x3e\n<resultMap id="userWithProfile" type="User">\n  <id property="id" column="id"/>\n  <result property="username" column="username"/>\n  <association property="profile" \n               column="id" \n               select="getProfileByUserId"/>\n</resultMap>\n\n\x3c!-- \u4E00\u5BF9\u591A\u5173\u8054 --\x3e\n<resultMap id="userWithOrders" type="User">\n  <id property="id" column="id"/>\n  <result property="username" column="username"/>\n  <collection property="orders" \n              column="id" \n              select="getOrdersByUserId"/>\n</resultMap>\n'})}),"\n"]}),"\n"]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"103-\u7F13\u5B58\u4E0E\u6027\u80FD\u9762\u8BD5\u9898",children:"10.3 \u7F13\u5B58\u4E0E\u6027\u80FD\u9762\u8BD5\u9898"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"cache",label:"\u7F13\u5B58\u95EE\u9898",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u7684\u7F13\u5B58\u673A\u5236\u662F\u600E\u6837\u7684\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: MyBatis\u6709\u4E24\u7EA7\u7F13\u5B58\u673A\u5236\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4E00\u7EA7\u7F13\u5B58"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"SqlSession\u7EA7\u522B\u7684\u7F13\u5B58"}),"\n",(0,l.jsx)(n.li,{children:"\u9ED8\u8BA4\u5F00\u542F\uFF0C\u65E0\u6CD5\u5173\u95ED"}),"\n",(0,l.jsx)(n.li,{children:"\u4F5C\u7528\u8303\u56F4\uFF1A\u540C\u4E00SqlSession\u5185"}),"\n",(0,l.jsx)(n.li,{children:"\u751F\u547D\u5468\u671F\uFF1ASqlSession\u5173\u95ED\u65F6\u7ED3\u675F"}),"\n",(0,l.jsxs)(n.li,{children:["\u6E05\u9664\u6761\u4EF6\uFF1A","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6267\u884CUPDATE\u3001INSERT\u3001DELETE\u64CD\u4F5C"}),"\n",(0,l.jsx)(n.li,{children:"\u8C03\u7528clearCache()\u65B9\u6CD5"}),"\n",(0,l.jsx)(n.li,{children:"\u8C03\u7528close()\u65B9\u6CD5"}),"\n",(0,l.jsx)(n.li,{children:"\u4E8B\u52A1\u63D0\u4EA4\u6216\u56DE\u6EDA\u64CD\u4F5C"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4E8C\u7EA7\u7F13\u5B58"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Mapper\u7EA7\u522B\u7684\u7F13\u5B58\uFF08namespace\uFF09"}),"\n",(0,l.jsx)(n.li,{children:"\u9ED8\u8BA4\u5173\u95ED\uFF0C\u9700\u624B\u52A8\u914D\u7F6E"}),"\n",(0,l.jsx)(n.li,{children:"\u4F5C\u7528\u8303\u56F4\uFF1A\u540C\u4E00namespace\u5185\u7684\u6240\u6709SqlSession\u5171\u4EAB"}),"\n",(0,l.jsx)(n.li,{children:"\u751F\u547D\u5468\u671F\uFF1A\u5E94\u7528\u8FD0\u884C\u671F\u95F4"}),"\n",(0,l.jsxs)(n.li,{children:["\u542F\u7528\u65B9\u5F0F\uFF1A","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u5168\u5C40\u914D\u7F6E --\x3e\n<setting name="cacheEnabled" value="true"/>\n\n\x3c!-- Mapper\u914D\u7F6E --\x3e\n<cache \n  eviction="LRU" \n  flushInterval="60000" \n  size="512" \n  readOnly="false"/>\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: \u4EC0\u4E48\u60C5\u51B5\u4E0B\u4E0D\u5E94\u4F7F\u7528\u4E8C\u7EA7\u7F13\u5B58\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: \u4EE5\u4E0B\u60C5\u51B5\u4E0D\u9002\u5408\u4F7F\u7528\u4E8C\u7EA7\u7F13\u5B58\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u5199\u64CD\u4F5C\u9891\u7E41\u7684\u573A\u666F"}),"\n",(0,l.jsx)(n.li,{children:"\u591A\u8868\u5173\u8054\u67E5\u8BE2\uFF08\u53EF\u80FD\u5BFC\u81F4\u810F\u6570\u636E\uFF09"}),"\n",(0,l.jsx)(n.li,{children:"\u5206\u5E03\u5F0F\u7CFB\u7EDF\uFF08\u7F13\u5B58\u4E0D\u4E00\u81F4\uFF09"}),"\n",(0,l.jsx)(n.li,{children:"\u9700\u8981\u5B9E\u65F6\u6570\u636E\u7684\u573A\u666F"}),"\n",(0,l.jsx)(n.li,{children:"\u5BF9\u6570\u636E\u4E00\u81F4\u6027\u8981\u6C42\u9AD8\u7684\u4E1A\u52A1"}),"\n",(0,l.jsx)(n.li,{children:"\u8868\u4E4B\u95F4\u5B58\u5728\u590D\u6742\u5173\u8054\u5173\u7CFB"}),"\n"]}),(0,l.jsx)(n.p,{children:"\u5728\u8FD9\u4E9B\u60C5\u51B5\u4E0B\uFF0C\u5EFA\u8BAE\u4F7F\u7528Redis\u7B49\u5916\u90E8\u7F13\u5B58\u4EE3\u66FFMyBatis\u5185\u7F6E\u7684\u4E8C\u7EA7\u7F13\u5B58\u3002"}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u7684\u4E00\u7EA7\u7F13\u5B58\u4E3A\u4EC0\u4E48\u4F1A\u51FA\u73B0\u810F\u8BFB\uFF1F\u5982\u4F55\u907F\u514D\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: \u4E00\u7EA7\u7F13\u5B58\u53EF\u80FD\u5BFC\u81F4\u810F\u8BFB\u7684\u539F\u56E0\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u540C\u4E00SqlSession\u5185\uFF0C\u4E24\u6B21\u67E5\u8BE2\u4E4B\u95F4\u6570\u636E\u88AB\u5176\u4ED6\u4F1A\u8BDD\u4FEE\u6539"}),"\n",(0,l.jsx)(n.li,{children:"\u7F13\u5B58\u4E2D\u7684\u5BF9\u8C61\u88AB\u7A0B\u5E8F\u4FEE\u6539\uFF0C\u4F46\u672A\u540C\u6B65\u5230\u6570\u636E\u5E93"}),"\n"]}),(0,l.jsx)(n.p,{children:"\u907F\u514D\u4E00\u7EA7\u7F13\u5B58\u810F\u8BFB\u7684\u65B9\u6CD5\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\u8C03\u6574\u7F13\u5B58\u7EA7\u522B\u4E3ASTATEMENT\uFF1A","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<setting name="localCacheScope" value="STATEMENT"/>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u5173\u952E\u67E5\u8BE2\u524D\u6E05\u7A7A\u7F13\u5B58\uFF1A","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"sqlSession.clearCache();\n"})}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u907F\u514D\u5171\u4EABSqlSession"}),"\n",(0,l.jsxs)(n.li,{children:['\u654F\u611F\u67E5\u8BE2\u4F7F\u7528flushCache="true"\uFF1A',"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<select id="getUser" flushCache="true">\n  SELECT * FROM user WHERE id = #{id}\n</select>\n'})}),"\n"]}),"\n"]})]}),(0,l.jsxs)(a.A,{value:"performance",label:"\u6027\u80FD\u95EE\u9898",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: \u5982\u4F55\u4F18\u5316MyBatis\u7684\u6027\u80FD\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: MyBatis\u6027\u80FD\u4F18\u5316\u7B56\u7565\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5408\u7406\u4F7F\u7528\u7F13\u5B58"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u914D\u7F6E\u4E8C\u7EA7\u7F13\u5B58"}),"\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u81EA\u5B9A\u4E49\u7F13\u5B58\u5982Redis"}),"\n",(0,l.jsx)(n.li,{children:"\u907F\u514D\u9891\u7E41\u5237\u65B0\u7F13\u5B58"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"SQL\u4F18\u5316"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u53EA\u67E5\u8BE2\u5FC5\u8981\u7684\u5217"}),"\n",(0,l.jsx)(n.li,{children:"\u6DFB\u52A0\u5408\u9002\u7684\u7D22\u5F15"}),"\n",(0,l.jsx)(n.li,{children:"\u907F\u514DSELECT *"}),"\n",(0,l.jsx)(n.li,{children:"\u5206\u9875\u67E5\u8BE2\u5927\u6570\u636E\u96C6"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5EF6\u8FDF\u52A0\u8F7D"}),"\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<setting name="lazyLoadingEnabled" value="true"/>\n<setting name="aggressiveLazyLoading" value="false"/>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u6279\u91CF\u64CD\u4F5C"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4F7F\u7528\u6279\u5904\u7406\u6267\u884C\u5668","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"SqlSession session = sqlSessionFactory.openSession(ExecutorType.BATCH);\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4F7F\u7528\u6279\u91CF\u63D2\u5165","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<insert id="batchInsert">\n  INSERT INTO table (col1, col2) VALUES \n  <foreach collection="list" item="item" separator=",">\n    (#{item.col1}, #{item.col2})\n  </foreach>\n</insert>\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u7ED3\u679C\u96C6\u5904\u7406"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u9650\u5236\u7ED3\u679C\u96C6\u5927\u5C0F"}),"\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u6D41\u5F0F\u67E5\u8BE2\u5904\u7406\u5927\u7ED3\u679C\u96C6"}),"\n",(0,l.jsx)(n.li,{children:"\u5408\u7406\u8BBE\u7F6EfetchSize"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u907F\u514DN+1\u95EE\u9898"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528\u5D4C\u5957\u7ED3\u679C\u6620\u5C04\u4EE3\u66FF\u5D4C\u5957\u67E5\u8BE2"}),"\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528JOIN\u4EE3\u66FF\u591A\u6B21\u5355\u72EC\u67E5\u8BE2"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4F7F\u7528\u63D2\u4EF6"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5206\u9875\u63D2\u4EF6\u5982PageHelper"}),"\n",(0,l.jsx)(n.li,{children:"\u6027\u80FD\u76D1\u63A7\u63D2\u4EF6"}),"\n"]}),"\n"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: \u4EC0\u4E48\u662FMyBatis\u4E2D\u7684N+1\u95EE\u9898\uFF1F\u5982\u4F55\u89E3\u51B3\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: N+1\u95EE\u9898\u662F\u6307\uFF1A"}),(0,l.jsx)(n.p,{children:"\u67E5\u8BE2N\u6761\u4E3B\u8BB0\u5F55\uFF0C\u7136\u540E\u9488\u5BF9\u6BCF\u6761\u4E3B\u8BB0\u5F55\u518D\u67E5\u8BE2\u5173\u8054\u8BB0\u5F55\uFF0C\u603B\u5171\u4EA7\u751FN+1\u6B21\u67E5\u8BE2\u3002"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"// N+1\u95EE\u9898\u793A\u4F8B\nList<User> users = userMapper.getAllUsers(); // 1\u6B21\u67E5\u8BE2\nfor (User user : users) {\n    List<Order> orders = orderMapper.getOrdersByUserId(user.getId()); // N\u6B21\u67E5\u8BE2\n    user.setOrders(orders);\n}\n"})}),(0,l.jsx)(n.p,{children:"\u89E3\u51B3N+1\u95EE\u9898\u7684\u65B9\u6CD5\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u4F7F\u7528\u5D4C\u5957\u7ED3\u679C\u6620\u5C04"}),"\uFF08\u63A8\u8350\uFF09\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<select id="getUsersWithOrders" resultMap="userOrderMap">\n  SELECT u.*, o.*\n  FROM user u\n  LEFT JOIN orders o ON u.id = o.user_id\n</select>\n\n<resultMap id="userOrderMap" type="User">\n  <id property="id" column="id"/>\n  <result property="name" column="name"/>\n  <collection property="orders" ofType="Order">\n    <id property="id" column="order_id"/>\n    <result property="amount" column="amount"/>\n  </collection>\n</resultMap>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5EF6\u8FDF\u52A0\u8F7D"}),"\uFF08\u9002\u7528\u4E8E\u5173\u8054\u6570\u636E\u4F7F\u7528\u7387\u4F4E\u7684\u573A\u666F\uFF09\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<setting name="lazyLoadingEnabled" value="true"/>\n<setting name="aggressiveLazyLoading" value="false"/>\n\n<resultMap id="userMap" type="User">\n  <id property="id" column="id"/>\n  <result property="name" column="name"/>\n  <collection property="orders" \n              select="getOrdersByUserId" \n              column="id" \n              fetchType="lazy"/>\n</resultMap>\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u6279\u91CF\u67E5\u8BE2"}),"\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"// \u5148\u83B7\u53D6\u7528\u6237\u5217\u8868\nList<User> users = userMapper.getAllUsers();\n\n// \u63D0\u53D6\u6240\u6709\u7528\u6237ID\nList<Long> userIds = users.stream()\n                         .map(User::getId)\n                         .collect(Collectors.toList());\n\n// \u4E00\u6B21\u67E5\u8BE2\u6240\u6709\u8BA2\u5355\nList<Order> allOrders = orderMapper.getOrdersByUserIds(userIds);\n\n// \u6309\u7528\u6237ID\u5206\u7EC4\nMap<Long, List<Order>> orderMap = allOrders.stream()\n                                         .collect(Collectors.groupingBy(Order::getUserId));\n\n// \u8BBE\u7F6E\u8BA2\u5355\u5230\u7528\u6237\u5BF9\u8C61\nusers.forEach(user -> user.setOrders(\n    orderMap.getOrDefault(user.getId(), Collections.emptyList())\n));\n"})}),"\n"]}),"\n"]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"104-\u63D2\u4EF6\u4E0E\u6269\u5C55\u9762\u8BD5\u9898",children:"10.4 \u63D2\u4EF6\u4E0E\u6269\u5C55\u9762\u8BD5\u9898"}),"\n",(0,l.jsxs)(i.A,{children:[(0,l.jsxs)(a.A,{value:"plugin",label:"\u63D2\u4EF6\u673A\u5236",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: MyBatis\u7684\u63D2\u4EF6\u673A\u5236\u662F\u5982\u4F55\u5DE5\u4F5C\u7684\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: MyBatis\u63D2\u4EF6\u673A\u5236\u57FA\u4E8E\u62E6\u622A\u5668\u6A21\u5F0F\u548C\u8D23\u4EFB\u94FE\u6A21\u5F0F\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u539F\u7406"}),"\uFF1A\u4F7F\u7528JDK\u52A8\u6001\u4EE3\u7406\uFF0C\u5728\u56DB\u5927\u6838\u5FC3\u5BF9\u8C61\u7684\u65B9\u6CD5\u8C03\u7528\u524D\u540E\u8FDB\u884C\u62E6\u622A"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u62E6\u622A\u70B9"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Executor\uFF1A\u6267\u884C\u5668\uFF0C\u8D1F\u8D23SQL\u6267\u884C"}),"\n",(0,l.jsx)(n.li,{children:"ParameterHandler\uFF1A\u53C2\u6570\u5904\u7406\u5668"}),"\n",(0,l.jsx)(n.li,{children:"ResultSetHandler\uFF1A\u7ED3\u679C\u96C6\u5904\u7406\u5668"}),"\n",(0,l.jsx)(n.li,{children:"StatementHandler\uFF1A\u8BED\u53E5\u5904\u7406\u5668"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5B9E\u73B0\u6B65\u9AA4"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5B9E\u73B0Interceptor\u63A5\u53E3"}),"\n",(0,l.jsx)(n.li,{children:"\u4F7F\u7528@Intercepts\u548C@Signature\u6CE8\u89E3\u5B9A\u4E49\u62E6\u622A\u70B9"}),"\n",(0,l.jsx)(n.li,{children:"\u5B9E\u73B0intercept\u65B9\u6CD5\u5904\u7406\u62E6\u622A\u903B\u8F91"}),"\n",(0,l.jsx)(n.li,{children:"\u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\u6CE8\u518C\u63D2\u4EF6"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u5DE5\u4F5C\u6D41\u7A0B"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5728MyBatis\u521D\u59CB\u5316\u65F6\uFF0C\u89E3\u6790\u63D2\u4EF6\u914D\u7F6E"}),"\n",(0,l.jsx)(n.li,{children:"\u521B\u5EFA\u62E6\u622A\u5668\u94FEInterceptorChain"}),"\n",(0,l.jsx)(n.li,{children:"\u5F53\u521B\u5EFA\u56DB\u5927\u6838\u5FC3\u5BF9\u8C61\u65F6\uFF0C\u8C03\u7528InterceptorChain.pluginAll()\u5305\u88C5\u5BF9\u8C61"}),"\n",(0,l.jsx)(n.li,{children:"\u6267\u884C\u76EE\u6807\u65B9\u6CD5\u65F6\uFF0C\u6309\u63D2\u4EF6\u6CE8\u518C\u987A\u5E8F\u9006\u5E8F\u6267\u884C\u62E6\u622A\u5668"}),"\n"]}),"\n"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: \u5982\u4F55\u5F00\u53D1\u4E00\u4E2A\u81EA\u5B9A\u4E49MyBatis\u63D2\u4EF6\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: \u5F00\u53D1\u81EA\u5B9A\u4E49\u63D2\u4EF6\u7684\u6B65\u9AA4\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5B9A\u4E49\u63D2\u4EF6\u7C7B"}),"\uFF1A"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Intercepts({\n    @Signature(\n        type = Executor.class,\n        method = "update",\n        args = {MappedStatement.class, Object.class}\n    ),\n    @Signature(\n        type = Executor.class,\n        method = "query",\n        args = {MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class}\n    )\n})\npublic class ExamplePlugin implements Interceptor {\n    \n    private Properties properties;\n    \n    @Override\n    public Object intercept(Invocation invocation) throws Throwable {\n        // \u6267\u884C\u524D\u5904\u7406\n        Object target = invocation.getTarget(); // \u88AB\u4EE3\u7406\u5BF9\u8C61\n        Method method = invocation.getMethod(); // \u88AB\u62E6\u622A\u65B9\u6CD5\n        Object[] args = invocation.getArgs();   // \u65B9\u6CD5\u53C2\u6570\n        \n        // \u6267\u884C\u539F\u65B9\u6CD5\n        Object result = invocation.proceed();\n        \n        // \u6267\u884C\u540E\u5904\u7406\n        \n        return result;\n    }\n    \n    @Override\n    public Object plugin(Object target) {\n        // \u5305\u88C5\u76EE\u6807\u5BF9\u8C61\n        return Plugin.wrap(target, this);\n    }\n    \n    @Override\n    public void setProperties(Properties properties) {\n        // \u8BBE\u7F6E\u63D2\u4EF6\u5C5E\u6027\n        this.properties = properties;\n    }\n}\n'})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6CE8\u518C\u63D2\u4EF6"}),"\uFF1A"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<plugins>\n  <plugin interceptor="com.example.plugin.ExamplePlugin">\n    <property name="someProperty" value="100"/>\n  </plugin>\n</plugins>\n'})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: \u4E3A\u4EC0\u4E48MyBatis\u7684\u63D2\u4EF6\u53EA\u80FD\u62E6\u622A\u8FD9\u56DB\u79CD\u63A5\u53E3\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: MyBatis\u53EA\u5141\u8BB8\u62E6\u622A\u8FD9\u56DB\u4E2A\u63A5\u53E3\u662F\u57FA\u4E8E\u4EE5\u4E0B\u8003\u8651\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u67B6\u6784\u8BBE\u8BA1"}),"\uFF1A\u8FD9\u56DB\u4E2A\u63A5\u53E3\u662FMyBatis\u6267\u884CSQL\u7684\u6838\u5FC3\u7EC4\u4EF6\uFF0C\u8986\u76D6\u4E86SQL\u6267\u884C\u7684\u5B8C\u6574\u751F\u547D\u5468\u671F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5B89\u5168\u6027"}),"\uFF1A\u9650\u5236\u62E6\u622A\u70B9\u51CF\u5C11\u5BF9\u6838\u5FC3\u529F\u80FD\u7684\u5E72\u6270"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u53EF\u63A7\u6027"}),"\uFF1A\u907F\u514D\u8FC7\u5EA6\u7684\u6269\u5C55\u5BFC\u81F4\u6846\u67B6\u884C\u4E3A\u4E0D\u53EF\u9884\u6D4B"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6027\u80FD\u8003\u8651"}),"\uFF1A\u51CF\u5C11\u4EE3\u7406\u5C42\u7EA7\uFF0C\u964D\u4F4E\u6027\u80FD\u5F00\u9500"]}),"\n"]}),(0,l.jsx)(n.p,{children:"\u8FD9\u56DB\u4E2A\u63A5\u53E3\u8DB3\u4EE5\u6EE1\u8DB3\u5927\u591A\u6570\u6269\u5C55\u9700\u6C42\uFF1A"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Executor\uFF1A\u6574\u4F53SQL\u6267\u884C\u8FC7\u7A0B\uFF08\u7F13\u5B58\u3001\u4E8B\u52A1\u7B49\uFF09"}),"\n",(0,l.jsx)(n.li,{children:"StatementHandler\uFF1ASQL\u8BED\u53E5\u5904\u7406\uFF08\u9884\u5904\u7406\u3001\u6267\u884C\uFF09"}),"\n",(0,l.jsx)(n.li,{children:"ParameterHandler\uFF1A\u53C2\u6570\u8BBE\u7F6E\uFF08\u7C7B\u578B\u8F6C\u6362\u3001\u53C2\u6570\u6620\u5C04\uFF09"}),"\n",(0,l.jsx)(n.li,{children:"ResultSetHandler\uFF1A\u7ED3\u679C\u96C6\u5904\u7406\uFF08\u7ED3\u679C\u6620\u5C04\u3001\u5BF9\u8C61\u521B\u5EFA\uFF09"}),"\n"]}),(0,l.jsx)(n.p,{children:"\u5982\u9700\u66F4\u6DF1\u5C42\u6B21\u7684\u5B9A\u5236\uFF0C\u53EF\u4EE5\u901A\u8FC7\u7EE7\u627F\u6216\u4FEE\u6539MyBatis\u6E90\u7801\u5B9E\u73B0\u3002"})]}),(0,l.jsxs)(a.A,{value:"extensions",label:"\u5E38\u7528\u6269\u5C55",children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: \u5E38\u7528\u7684MyBatis\u6269\u5C55\u6709\u54EA\u4E9B\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: \u5E38\u7528\u7684MyBatis\u6269\u5C55\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"MyBatis-Plus"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u589E\u5F3A\u7684CRUD\u64CD\u4F5C"}),"\n",(0,l.jsx)(n.li,{children:"\u6761\u4EF6\u6784\u9020\u5668"}),"\n",(0,l.jsx)(n.li,{children:"\u5206\u9875\u63D2\u4EF6"}),"\n",(0,l.jsx)(n.li,{children:"\u4EE3\u7801\u751F\u6210\u5668"}),"\n",(0,l.jsx)(n.li,{children:"\u4E50\u89C2\u9501\u63D2\u4EF6"}),"\n",(0,l.jsx)(n.li,{children:"\u5B57\u6BB5\u81EA\u52A8\u586B\u5145"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"PageHelper"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5F3A\u5927\u7684\u5206\u9875\u63D2\u4EF6"}),"\n",(0,l.jsx)(n.li,{children:"\u591A\u6570\u636E\u5E93\u652F\u6301"}),"\n",(0,l.jsx)(n.li,{children:"\u7B80\u5355\u7684API"}),"\n",(0,l.jsx)(n.li,{children:"\u7075\u6D3B\u7684\u5206\u9875\u53C2\u6570"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u901A\u7528Mapper"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u901A\u7528\u7684CRUD\u65B9\u6CD5"}),"\n",(0,l.jsx)(n.li,{children:"Example\u67E5\u8BE2\u6761\u4EF6"}),"\n",(0,l.jsx)(n.li,{children:"\u6279\u91CF\u64CD\u4F5C\u652F\u6301"}),"\n",(0,l.jsx)(n.li,{children:"\u7075\u6D3B\u7684\u6761\u4EF6\u67E5\u8BE2"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"MyBatis-Spring"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u96C6\u6210Spring\u4E8B\u52A1\u7BA1\u7406"}),"\n",(0,l.jsx)(n.li,{children:"\u81EA\u52A8Mapper\u626B\u63CF"}),"\n",(0,l.jsx)(n.li,{children:"SqlSession\u7BA1\u7406"}),"\n",(0,l.jsx)(n.li,{children:"\u4F9D\u8D56\u6CE8\u5165\u652F\u6301"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"MyBatis-Dynamic-SQL"}),"\uFF1A"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7C7B\u578B\u5B89\u5168\u7684SQL\u6784\u5EFA"}),"\n",(0,l.jsx)(n.li,{children:"\u52A8\u6001\u6761\u4EF6\u652F\u6301"}),"\n",(0,l.jsx)(n.li,{children:"\u907F\u514D\u786C\u7F16\u7801SQL"}),"\n"]}),"\n"]}),"\n"]}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: \u5206\u9875\u63D2\u4EF6PageHelper\u7684\u5DE5\u4F5C\u539F\u7406\u662F\u4EC0\u4E48\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: PageHelper\u5206\u9875\u63D2\u4EF6\u7684\u5DE5\u4F5C\u539F\u7406\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u62E6\u622A\u6267\u884C\u5668"}),"\uFF1A\u62E6\u622AExecutor\u7684query\u65B9\u6CD5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u83B7\u53D6\u5206\u9875\u53C2\u6570"}),"\uFF1A\u4ECEThreadLocal\u4E2D\u83B7\u53D6Page\u5BF9\u8C61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u89E3\u6790\u539FSQL"}),"\uFF1A\u4F7F\u7528JSqlParser\u89E3\u6790SQL"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6784\u9020\u5206\u9875SQL"}),"\uFF1A\u6839\u636E\u6570\u636E\u5E93\u7C7B\u578B\u6DFB\u52A0\u5206\u9875\u8BED\u6CD5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6267\u884C\u5206\u9875\u67E5\u8BE2"}),"\uFF1A\u5148\u6267\u884Ccount\u67E5\u8BE2\u83B7\u53D6\u603B\u6570\uFF0C\u518D\u6267\u884C\u5206\u9875\u67E5\u8BE2"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u8BBE\u7F6E\u5206\u9875\u7ED3\u679C"}),"\uFF1A\u5C06\u5206\u9875\u4FE1\u606F\u8BBE\u7F6E\u5230Page\u5BF9\u8C61"]}),"\n"]}),(0,l.jsx)(n.p,{children:"\u5DE5\u4F5C\u6D41\u7A0B\u793A\u610F\uFF1A"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"\u8C03\u7528PageHelper.startPage() \u2192 \u521B\u5EFAPage\u5BF9\u8C61\u5E76\u5B58\u5165ThreadLocal \u2192\n\u6267\u884C\u67E5\u8BE2\u65B9\u6CD5 \u2192 \u63D2\u4EF6\u62E6\u622A \u2192 \u6784\u5EFA\u5206\u9875SQL \u2192 \n\u6267\u884Ccount\u67E5\u8BE2 \u2192 \u6267\u884C\u5206\u9875\u67E5\u8BE2 \u2192 \u8FD4\u56DE\u7ED3\u679C \u2192\n\u6E05\u9664ThreadLocal\n"})}),(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Q: \u5982\u4F55\u5B9E\u73B0\u81EA\u5B9A\u4E49\u7684\u7ED3\u679C\u96C6\u5904\u7406\uFF1F"})}),(0,l.jsx)(n.p,{children:"A: \u81EA\u5B9A\u4E49\u7ED3\u679C\u96C6\u5904\u7406\u6709\u4EE5\u4E0B\u65B9\u5F0F\uFF1A"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u81EA\u5B9A\u4E49TypeHandler"}),"\uFF1A"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'public class JsonTypeHandler<T> extends BaseTypeHandler<T> {\n    private Class<T> clazz;\n    private ObjectMapper objectMapper = new ObjectMapper();\n    \n    public JsonTypeHandler(Class<T> clazz) {\n        this.clazz = clazz;\n    }\n    \n    @Override\n    public void setNonNullParameter(PreparedStatement ps, int i, T parameter, JdbcType jdbcType) throws SQLException {\n        // \u5B9E\u73B0\u53C2\u6570\u8BBE\u7F6E\u903B\u8F91\n    }\n    \n    @Override\n    public T getNullableResult(ResultSet rs, String columnName) throws SQLException {\n        // \u5B9E\u73B0\u7ED3\u679C\u83B7\u53D6\u903B\u8F91\n    }\n    \n    // \u5176\u4ED6\u65B9\u6CD5\u5B9E\u73B0...\n}\n\n// \u6CE8\u518CTypeHandler\n<typeHandlers>\n  <typeHandler handler="com.example.JsonTypeHandler" javaType="com.example.Config" jdbcType="VARCHAR"/>\n</typeHandlers>\n'})}),(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u81EA\u5B9A\u4E49ResultHandler"}),"\uFF1A"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'public class CustomResultHandler implements ResultHandler<User> {\n    private List<User> users = new ArrayList<>();\n    \n    @Override\n    public void handleResult(ResultContext<? extends User> resultContext) {\n        User user = resultContext.getResultObject();\n        // \u81EA\u5B9A\u4E49\u5904\u7406\u903B\u8F91\n        users.add(user);\n        \n        // \u53EF\u4EE5\u63D0\u524D\u505C\u6B62\u7ED3\u679C\u96C6\u5904\u7406\n        if (users.size() >= 100) {\n            resultContext.stop();\n        }\n    }\n    \n    public List<User> getUsers() {\n        return users;\n    }\n}\n\n// \u4F7F\u7528\u81EA\u5B9A\u4E49ResultHandler\nCustomResultHandler handler = new CustomResultHandler();\nsqlSession.select("getUserList", params, handler);\nList<User> users = handler.getUsers();\n'})}),(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u62E6\u622AResultSetHandler"}),"\uFF1A"]}),"\n"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Intercepts({\n    @Signature(\n        type = ResultSetHandler.class,\n        method = "handleResultSets",\n        args = {Statement.class}\n    )\n})\npublic class ResultSetInterceptor implements Interceptor {\n    @Override\n    public Object intercept(Invocation invocation) throws Throwable {\n        // \u62E6\u622A\u7ED3\u679C\u96C6\u5904\u7406\u8FC7\u7A0B\n        Statement stmt = (Statement) invocation.getArgs()[0];\n        \n        // \u6267\u884C\u539F\u65B9\u6CD5\n        Object result = invocation.proceed();\n        \n        // \u5904\u7406\u7ED3\u679C\n        if (result instanceof List) {\n            List<?> list = (List<?>) result;\n            // \u5BF9\u7ED3\u679C\u8FDB\u884C\u540E\u5904\u7406\n        }\n        \n        return result;\n    }\n    \n    // \u5176\u4ED6\u65B9\u6CD5\u5B9E\u73B0...\n}\n'})})]})]}),"\n",(0,l.jsx)(n.admonition,{title:"\u9762\u8BD5\u6280\u5DE7",type:"tip",children:(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7406\u89E3\u539F\u7406"}),"\uFF1A\u6DF1\u5165\u7406\u89E3MyBatis\u7684\u6838\u5FC3\u539F\u7406\u548C\u6267\u884C\u6D41\u7A0B"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5BF9\u6BD4\u6846\u67B6"}),"\uFF1A\u4E86\u89E3MyBatis\u4E0E\u5176\u4ED6ORM\u6846\u67B6\u7684\u533A\u522B\u548C\u9002\u7528\u573A\u666F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6027\u80FD\u4F18\u5316"}),"\uFF1A\u638C\u63E1\u5E38\u89C1\u7684\u6027\u80FD\u95EE\u9898\u548C\u4F18\u5316\u65B9\u6CD5"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5B9E\u8DF5\u6848\u4F8B"}),"\uFF1A\u51C6\u5907\u5B9E\u9645\u9879\u76EE\u4E2D\u7684\u4F7F\u7528\u6848\u4F8B\u548C\u95EE\u9898\u89E3\u51B3\u65B9\u6848"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6E90\u7801\u5206\u6790"}),"\uFF1A\u5BF9\u5173\u952E\u7EC4\u4EF6\u7684\u6E90\u7801\u6709\u57FA\u672C\u4E86\u89E3"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6269\u5C55\u673A\u5236"}),"\uFF1A\u719F\u6089\u63D2\u4EF6\u673A\u5236\u548C\u5E38\u7528\u6269\u5C55"]}),"\n"]})})]})}function x(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},57250:function(e,n,r){r.d(n,{A:()=>t});var s=r(74848);r(96540);var l=r(34164);function t({children:e,hidden:n,className:r}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,l.A)("tabItem_Ymn6",r),hidden:n,children:e})}},78010:function(e,n,r){r.d(n,{A:()=>S});var s=r(74848),l=r(96540),t=r(34164),i=r(88287),a=r(28584),c=r(56347),d=r(99989),o=r(96629),p=r(80618),u=r(41367);function h(e){return l.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,l.isValidElement)(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function x({value:e,tabValues:n}){return n.some(n=>n.value===e)}var j=r(19863);function m({className:e,block:n,selectedValue:r,selectValue:l,tabValues:i}){let c=[],{blockElementScrollPositionUntilNextRender:d}=(0,a.a_)(),o=e=>{let n=e.currentTarget,s=i[c.indexOf(n)].value;s!==r&&(d(n),l(s))},p=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{let r=c.indexOf(e.currentTarget)+1;n=c[r]??c[0];break}case"ArrowLeft":{let r=c.indexOf(e.currentTarget)-1;n=c[r]??c[c.length-1]}}n?.focus()};return(0,s.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:i.map(({value:e,label:n,attributes:l})=>(0,s.jsx)("li",{role:"tab",tabIndex:r===e?0:-1,"aria-selected":r===e,ref:e=>{c.push(e)},onKeyDown:p,onClick:o,...l,className:(0,t.A)("tabs__item","tabItem_LNqP",l?.className,{"tabs__item--active":r===e}),children:n??e},e))})}function g({lazy:e,children:n,selectedValue:r}){let i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){let e=i.find(e=>e.props.value===r);return e?(0,l.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,s.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,l.cloneElement)(e,{key:n,hidden:e.props.value!==r}))})}function y(e){let n=function(e){let n,{defaultValue:r,queryString:s=!1,groupId:t}=e,i=function(e){let{values:n,children:r}=e;return(0,l.useMemo)(()=>{let e=n??h(r).map(({props:{value:e,label:n,attributes:r,default:s}})=>({value:e,label:n,attributes:r,default:s})),s=(0,p.XI)(e,(e,n)=>e.value===n.value);if(s.length>0)throw Error(`Docusaurus error: Duplicate values "${s.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`);return e},[n,r])}(e),[a,j]=(0,l.useState)(()=>(function({defaultValue:e,tabValues:n}){if(0===n.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!x({value:e,tabValues:n}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}let r=n.find(e=>e.default)??n[0];if(!r)throw Error("Unexpected error: 0 tabValues");return r.value})({defaultValue:r,tabValues:i})),[m,g]=function({queryString:e=!1,groupId:n}){let r=(0,c.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,o.aZ)(s),(0,l.useCallback)(e=>{if(!s)return;let n=new URLSearchParams(r.location.search);n.set(s,e),r.replace({...r.location,search:n.toString()})},[s,r])]}({queryString:s,groupId:t}),[y,S]=function({groupId:e}){let n=e?`docusaurus.tab.${e}`:null,[r,s]=(0,u.Dv)(n);return[r,(0,l.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:t}),v=x({value:n=m??y,tabValues:i})?n:null;return(0,d.A)(()=>{v&&j(v)},[v]),{selectedValue:a,selectValue:(0,l.useCallback)(e=>{if(!x({value:e,tabValues:i}))throw Error(`Can't select invalid tab value=${e}`);j(e),g(e),S(e)},[g,S,i]),tabValues:i}}(e);return(0,s.jsxs)("div",{className:(0,t.A)(i.G.tabs.container,"tabs-container","tabList__CuJ"),children:[(0,s.jsx)(m,{...n,...e}),(0,s.jsx)(g,{...n,...e})]})}function S(e){let n=(0,j.A)();return(0,s.jsx)(y,{...e,children:h(e.children)},String(n))}},67810:function(e,n,r){r.d(n,{A:()=>t});var s=r(83941),l=r(61022);function t(){let{prism:e}=(0,l.p)(),{colorMode:n}=(0,s.G)(),r=e.theme,t=e.darkTheme||r;return"dark"===n?t:r}},25591:function(e,n,r){r.d(n,{A:()=>h});var s=r(74848),l=r(96540),t=r(34164),i=r(71765),a=r(33436),c=r(61022),d=r(67810);let o="codeDot_PWGG",p="langIcon_gX7_",u="copyButtonIcon_f_OW",h=function({children:e,className:n,metastring:r,title:h}){let x,j,[m,g]=(0,l.useState)(!1),[y,S]=(0,l.useState)(!1),v=(0,l.useRef)(null),b=(0,l.useRef)(null),M=(0,l.useRef)(null),{prism:E}=(0,c.p)(),f=(0,d.A)();(0,l.useEffect)(()=>{S(!0)},[]),(0,l.useEffect)(()=>{let e;if(!M.current)return;let n=document.createElement("canvas"),r=document.createElement("div");r.className="matrixContainer_iCb4",r.appendChild(n),M.current.prepend(r);let s=n.getContext("2d"),l=()=>{let e=M.current.getBoundingClientRect();n.width=e.width,n.height=e.height};l(),window.addEventListener("resize",l);let t=()=>"dark"===document.documentElement.getAttribute("data-theme"),i=()=>{let e=(t(),15),r=Math.floor(n.width/e);return{fontSize:e,columns:r}},{fontSize:a,columns:c}=i(),d=[];for(let e=0;e<c;e++)d[e]=Math.floor(Math.random()*n.height/a);let o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789labylabylaby",p=()=>{let r=c;if({fontSize:a,columns:c}=i(),c!==r)for(let e=0;e<c;e++)e<r||(d[e]=Math.floor(Math.random()*n.height/a));t()?s.fillStyle="rgba(0, 0, 0, 0.05)":s.fillStyle="rgba(255, 255, 255, 0.05)",s.fillRect(0,0,n.width,n.height),t()?s.fillStyle="#0F0":s.fillStyle="rgba(0, 80, 0, 0.8)",s.font=`${a}px 'Courier New', monospace`,s.textBaseline="top";for(let e=0;e<d.length;e++){let r=o[Math.floor(Math.random()*o.length)];s.fillText(r,e*a,d[e]*a),d[e]*a>n.height&&Math.random()>.975&&(d[e]=0),Math.random()>.6&&d[e]++}e=setTimeout(()=>requestAnimationFrame(p),70)};p();let u=new MutationObserver(e=>{e.forEach(e=>{"data-theme"===e.attributeName&&s.clearRect(0,0,n.width,n.height)})});return u.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{u.disconnect(),window.removeEventListener("resize",l),clearTimeout(e),cancelAnimationFrame(e)}},[y]);let T=n&&(/language-(\w+)/.exec(n)||["","text"])[1],L=h||(r&&r.match(/title="([^"]+)"/))?.[1]||"";return(0,s.jsxs)("div",{className:(0,t.A)("codeBlockContainer_X7hc",T&&`language-${T}`),ref:b,children:[(0,s.jsxs)("div",{className:"codeBlockHeader_viex",children:[(0,s.jsxs)("div",{className:"codeBlockControls_mxj2",children:[(0,s.jsx)("span",{className:(0,t.A)(o,"codeDotRed_ANoD")}),(0,s.jsx)("span",{className:(0,t.A)(o,"codeDotYellow_HH1J")}),(0,s.jsx)("span",{className:(0,t.A)(o,"codeDotGreen_RM6U")})]}),L&&(0,s.jsx)("div",{className:"codeBlockTitle_B2tn",children:L}),(0,s.jsxs)("div",{className:"codeBlockMeta_lRk3",children:[T&&(0,s.jsxs)("div",{className:"codeBlockLanguage_Vqu6",children:[(x={javascript:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",className:p,children:(0,s.jsx)("path",{fill:"currentColor",d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM243.8 381.4c0 43.6-25.6 63.5-62.9 63.5-33.7 0-53.2-17.4-63.2-38.5l34.3-20.7c6.6 11.7 12.6 21.6 27.1 21.6 13.8 0 22.6-5.4 22.6-26.5V237.7h42.1v143.7zm99.6 63.5c-39.1 0-64.4-18.6-76.7-43l34.3-19.8c9 14.7 20.8 25.6 41.5 25.6 17.4 0 28.6-8.7 28.6-20.8 0-14.4-11.4-19.5-30.7-28l-10.5-4.5c-30.4-12.9-50.5-29.2-50.5-63.5 0-31.6 24.1-55.6 61.6-55.6 26.8 0 46 9.3 59.8 33.7L368 290c-7.2-12.9-15-18-27.1-18-12.3 0-20.1 7.8-20.1 18 0 12.6 7.8 17.7 25.9 25.6l10.5 4.5c35.8 15.3 55.9 31 55.9 66.2 0 37.8-29.8 58.6-69.7 58.6z"})}),jsx:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",className:p,children:(0,s.jsx)("path",{fill:"currentColor",d:"M418.2 177.2c-5.4-1.8-10.8-3.5-16.2-5.1.9-3.7 1.7-7.4 2.5-11.1 12.3-59.6 4.2-107.5-23.1-123.3-26.3-15.1-69.2.6-112.6 38.4-4.3 3.7-8.5 7.6-12.5 11.5-2.7-2.6-5.5-5.2-8.3-7.7-45.5-40.4-91.1-57.4-118.4-41.5-26.2 15.2-34 60.3-23 116.7 1.1 5.6 2.3 11.1 3.7 16.7-6.4 1.8-12.7 3.8-18.6 5.9C38.3 196.2 0 225.4 0 255.6c0 31.2 40.8 62.5 96.3 81.5 4.5 1.5 9 3 13.6 4.3-1.5 6-2.8 11.9-4 18-10.5 55.5-2.3 99.5 23.9 114.6 27 15.6 72.4-.4 116.6-39.1 3.5-3.1 7-6.3 10.5-9.7 4.4 4.3 9 8.4 13.6 12.4 42.8 36.8 85.1 51.7 111.2 36.6 27-15.6 35.8-62.9 24.4-120.5-.9-4.4-1.9-8.9-3-13.5 3.2-.9 6.3-1.9 9.4-2.9 57.7-19.1 99.5-50 99.5-81.7 0-30.3-39.4-59.7-93.8-78.4zM282.9 92.3c37.2-32.4 71.9-45.1 87.7-36 16.9 9.7 23.4 48.9 12.8 100.4-.7 3.4-1.4 6.7-2.3 10-22.2-5-44.7-8.6-67.3-10.6-13-18.6-27.2-36.4-42.6-53.1 3.9-3.7 7.7-7.2 11.7-10.7zM167.2 307.5c5.1 8.7 10.3 17.4 15.8 25.9-15.6-1.7-31.1-4.2-46.4-7.5 4.4-14.4 9.9-29.3 16.3-44.5 4.6 8.8 9.3 17.5 14.3 26.1zm-30.3-120.3c14.4-3.2 29.7-5.8 45.6-7.8-5.3 8.3-10.5 16.8-15.4 25.4-4.9 8.5-9.7 17.2-14.2 26-6.3-14.9-11.6-29.5-16-43.6zm27.4 68.9c6.6-13.8 13.8-27.3 21.4-40.6s15.8-26.2 24.4-38.9c15-1.1 30.3-1.7 45.9-1.7s31 .6 45.9 1.7c8.5 12.6 16.6 25.5 24.3 38.7s14.9 26.7 21.7 40.4c-6.7 13.8-13.9 27.4-21.6 40.8-7.6 13.3-15.7 26.2-24.2 39-14.9 1.1-30.4 1.6-46.1 1.6s-30.9-.5-45.6-1.4c-8.7-12.7-16.9-25.7-24.6-39s-14.8-26.8-21.5-40.6zm180.6 51.2c5.1-8.8 9.9-17.7 14.6-26.7 6.4 14.5 12 29.2 16.9 44.3-15.5 3.5-31.2 6.2-47 8 5.4-8.4 10.5-17 15.5-25.6zm14.4-76.5c-4.7-8.8-9.5-17.6-14.5-26.2-4.9-8.5-10-16.9-15.3-25.2 16.1 2 31.5 4.7 45.9 8-4.6 14.8-10 29.2-16.1 43.4zM256.2 118.3c10.5 11.4 20.4 23.4 29.6 35.8-19.8-.9-39.7-.9-59.5 0 9.8-12.9 19.9-24.9 29.9-35.8zM140.2 57c16.8-9.8 54.1 4.2 93.4 39 2.5 2.2 5 4.6 7.6 7-15.5 16.7-29.8 34.5-42.9 53.1-22.6 2-45 5.5-67.2 10.4-1.3-5.1-2.4-10.3-3.5-15.5-9.4-48.4-3.2-84.9 12.6-94zm-24.5 263.6c-4.2-1.2-8.3-2.5-12.4-3.9-21.3-6.7-45.5-17.3-63-31.2-10.1-7-16.9-17.8-18.8-29.9 0-18.3 31.6-41.7 77.2-57.6 5.7-2 11.5-3.8 17.3-5.5 6.8 21.7 15 43 24.5 63.6-9.6 20.9-17.9 42.5-24.8 64.5zm116.6 98c-16.5 15.1-35.6 27.1-56.4 35.3-11.1 5.3-23.9 5.8-35.3 1.3-15.9-9.2-22.5-44.5-13.5-92 1.1-5.6 2.3-11.2 3.7-16.7 22.4 4.8 45 8.1 67.9 9.8 13.2 18.7 27.7 36.6 43.2 53.4-3.2 3.1-6.4 6.1-9.6 8.9zm24.5-24.3c-10.2-11-20.4-23.2-30.3-36.3 9.6.4 19.5.6 29.5.6 10.3 0 20.4-.2 30.4-.7-9.2 12.7-19.1 24.8-29.6 36.4zm130.7 30c-.9 12.2-6.9 23.6-16.5 31.3-15.9 9.2-49.8-2.8-86.4-34.2-4.2-3.6-8.4-7.5-12.7-11.5 15.3-16.9 29.4-34.8 42.2-53.6 22.9-1.9 45.7-5.4 68.2-10.5 1 4.1 1.9 8.2 2.7 12.2 4.9 21.6 5.7 44.1 2.5 66.3zm18.2-107.5c-2.8.9-5.6 1.8-8.5 2.6-7-21.8-15.6-43.1-25.5-63.8 9.6-20.4 17.7-41.4 24.5-62.9 5.2 1.5 10.2 3.1 15 4.7 46.6 16 79.3 39.8 79.3 58 0 19.6-34.9 44.9-84.8 61.4zm-149.7-15c25.3 0 45.8-20.5 45.8-45.8s-20.5-45.8-45.8-45.8c-25.3 0-45.8 20.5-45.8 45.8s20.5 45.8 45.8 45.8z"})}),typescript:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",className:p,children:[(0,s.jsx)("path",{fill:"currentColor",d:"M233.277 177.622h-82.44v156.756h32.967v-58.743h49.472c39.168 0 71.15-26.284 71.15-49.006.001-22.729-31.981-49.007-71.15-49.007zm-3.533 66.293H183.71v-33.496h46.034c17.392 0 31.407 7.41 31.407 16.747.001 9.341-14.014 16.75-31.407 16.75zm212.408-66.293v32.965h-33.403v123.79h-32.973v-123.79h-33.405v-32.966h99.781z"}),(0,s.jsx)("path",{fill:"currentColor",d:"M512 256.001c0 141.395-114.606 255.996-255.996 255.996C114.606 511.997 0 397.396 0 256.001 0 114.606 114.606 0 256.004 0 397.394 0 512 114.606 512 256.001z",opacity:".1"})]}),css:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",className:p,children:(0,s.jsx)("path",{fill:"currentColor",d:"M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"})}),html:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",className:p,children:(0,s.jsx)("path",{fill:"currentColor",d:"M0 32l34.9 395.8L191.5 480l157.6-52.2L384 32H0zm308.2 127.9H124.4l4.1 49.4h175.6l-13.6 148.4-97.9 27v.3h-1.1l-98.7-27.3-6-75.8h47.7L138 320l53.5 14.5 53.7-14.5 6-62.2H84.3L71.5 112.2h241.1l-4.4 47.7z"})}),java:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",className:p,children:(0,s.jsx)("path",{fill:"currentColor",d:"M277.74 312.9c9.8-6.7 23.4-12.5 23.4-12.5s-38.7 7-77.2 10.2c-47.1 3.9-97.7 4.7-123.1 1.3-60.1-8 33-30.1 33-30.1s-36.1-2.4-80.6 19c-52.5 25.4 130 37 224.5 12.1zm-85.4-32.1c-19-42.7-83.1-80.2 0-145.8C296 45.2 242.8 8.1 242.8 8.1s12.7 50.9-23.5 79.4c-60.3 47.5-78.2-12.6-78.2-12.6-117.2 68.1 38.4 69.6 51.3 93.4 22.9 41.5-40.2 104.8-80.4 93.7-9-2.5 5.2 9.6 19.5 19.4 20.8 14.3 76.1 20.5 116.2-2.8 31.3-18.1-11.7-53.8-23.5-70.7zM381 261.1c-15.6-5.9-37.8-6.6-37.8-6.6s9.4-28.4-37.3-42.3c-94.4-28.3-189 11.5-189 11.5s52.9 47.3 138.2 35c16.6-2.4 51-13.1 51-13.1s-23.8 6.1-32.7 12.1c-223.1 62.2-75.6-7.5-75.6-7.5s19 10.7 50.9 12.8c116.2 8.1 117.1-35.9 132.3-2.9zM239 64.7c-56.6 19.6-49.4 42.6-49.4 42.6 49.3-32 121.4-22.3 121.4-22.3s-23.1-10.1-72 -20.3zm-99.6 23.6c27.8-15.7 49.9-8 49.9-8s-28.6-15.9-60.4-7.6c-21.1 5.6-14.8 23.7-14.8 23.7s5-9.4 25.3-8.1zm146.4 44.6c-39.4 13-43.6 61.5-43.6 61.5s75-36.4 43.6-61.5z"})}),python:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",className:p,children:(0,s.jsx)("path",{fill:"currentColor",d:"M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"})}),bash:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",className:p,children:(0,s.jsx)("path",{fill:"currentColor",d:"M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"})}),json:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",className:p,children:(0,s.jsx)("path",{fill:"currentColor",d:"M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"})}),yaml:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",className:p,children:(0,s.jsx)("path",{fill:"currentColor",d:"M0 32l34.9 395.8L192 480l157.1-52.2L384 32H0zm313.1 80l-4.8 47.3L193 208.6l-.3.1h111.5l-12.8 146.6-98.2 28.7-98.8-29.2-6.4-73.9h48.9l3.2 38.3 52.6 13.3 54.7-15.4 3.7-61.6-166.3-.5v-.1l-.2.1-3.6-46.3L193.1 162l6.5-2.7H76.7L70.9 112h242.2z"})}),markdown:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 208 128",className:p,children:[(0,s.jsx)("rect",{width:"198",height:"118",x:"5",y:"5",ry:"10",stroke:"currentColor",strokeWidth:"10",fill:"none"}),(0,s.jsx)("path",{d:"M30 98V30h20l20 25 20-25h20v68H90V59L70 84 50 59v39zm125 0l-30-33h20V30h20v35h20z",fill:"currentColor"})]}),sql:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",className:p,children:(0,s.jsx)("path",{fill:"currentColor",d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"})})},j=(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",className:p,children:(0,s.jsx)("path",{fill:"currentColor",d:"M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"})}),x["string"==typeof T&&T?T.toLowerCase():""]||j),(0,s.jsx)("span",{children:T})]}),(0,s.jsx)("button",{ref:v,type:"button","aria-label":"\u590D\u5236\u4EE3\u7801",className:"copyButton_H_xL",onClick:()=>{if(b.current){let e=b.current.textContent;(0,a.A)(e),g(!0),setTimeout(()=>{g(!1)},2e3)}},children:m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",className:u,children:(0,s.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})}),(0,s.jsx)("span",{children:"\u5DF2\u590D\u5236"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",className:u,children:(0,s.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),(0,s.jsx)("span",{children:"\u590D\u5236"})]})})]})]}),(0,s.jsx)("div",{className:"codeBlockContent_vqWU",ref:M,children:(0,s.jsx)(i.f4,{code:e.trim(),language:T||"text",theme:f,children:({className:e,style:n,tokens:r,getLineProps:l,getTokenProps:i})=>(0,s.jsx)("pre",{className:(0,t.A)(e,"codeBlock_wPnj"),style:n,children:(0,s.jsx)("code",{className:"codeBlockLines_fQUY",children:r.map((e,n)=>{1===e.length&&"\n"===e[0].content&&(e[0].content="");let{key:r,...a}=l({line:e,key:n});return(0,s.jsxs)("div",{...a,className:(0,t.A)(a.className,"codeLine_fSta"),children:[(0,s.jsx)("span",{className:"codeLineNumber_x9bH",children:n+1}),(0,s.jsx)("span",{className:"codeLineContent_HA3z",children:e.map((e,n)=>{let{key:r,...l}=i({token:e,key:n});return(0,s.jsx)("span",{...l},r||n)})})]},r||n)})})})})})]})}},28453:function(e,n,r){r.d(n,{R:()=>i,x:()=>a});var s=r(96540);let l={},t=s.createContext(l);function i(e){let n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),s.createElement(t.Provider,{value:n},e.children)}},33436:function(e,n,r){r.d(n,{A:()=>s});function s(e,{target:n=document.body}={}){if("string"!=typeof e)throw TypeError(`Expected parameter \`text\` to be a \`string\`, got \`${typeof e}\`.`);let r=document.createElement("textarea"),l=document.activeElement;r.value=e,r.setAttribute("readonly",""),r.style.all="unset",r.style.contain="strict",r.style.position="absolute",r.style.left="-9999px",r.style.width="2em",r.style.height="2em",r.style.padding="0",r.style.border="none",r.style.outline="none",r.style.boxShadow="none",r.style.background="transparent",r.style.fontSize="12pt",r.style.whiteSpace="pre";let t=document.getSelection(),i=t.rangeCount>0&&t.getRangeAt(0);n.append(r),r.select(),r.selectionStart=0,r.selectionEnd=e.length;let a=!1;try{a=document.execCommand("copy")}catch{}return r.remove(),i&&(t.removeAllRanges(),t.addRange(i)),l&&l.focus(),a}}}]);